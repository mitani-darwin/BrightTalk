<div class="container mt-4">
  <div class="row justify-content-center">
    <div class="col-md-8">
      <div class="card">
        <div class="card-header d-flex justify-content-between align-items-center">
          <h4 class="mb-0">
            <i class="fas fa-fingerprint me-2"></i>パスキー管理
          </h4>
          <%= link_to "新しいパスキーを追加", new_user_passkey_path, class: "btn btn-primary" %>
        </div>
        
        <div class="card-body">
          <% if @passkeys.any? %>
            <p class="text-muted mb-4">
              現在登録されているパスキー: <strong><%= @passkeys.count %></strong> 個
            </p>

            <% @passkeys.each do |passkey| %>
              <div class="card mb-3">
                <div class="card-body">
                  <div class="row align-items-center">
                    <div class="col-md-8">
                      <h6 class="card-title mb-1">
                        <i class="fas fa-key me-2"></i><%= passkey.label %>
                      </h6>
                      <p class="text-muted mb-1">
                        <small>
                          登録日: <%= passkey.created_at.strftime("%Y年%m月%d日 %H:%M") %>
                        </small>
                      </p>
                      <% if passkey.last_used_at %>
                        <p class="text-muted mb-0">
                          <small>
                            最終使用: <%= time_ago_in_words(passkey.last_used_at) %>前
                          </small>
                        </p>
                      <% else %>
                        <p class="text-muted mb-0">
                          <small>未使用</small>
                        </p>
                      <% end %>
                    </div>
                    <div class="col-md-4 text-end">
                      <%= link_to destroy_user_passkey_path(passkey),
                                  method: :delete,
                                  confirm: "本当にこのパスキーを削除しますか？",
                                  class: "btn btn-outline-danger btn-sm" do %>
                        <i class="fas fa-trash me-1"></i>削除
                      <% end %>
                    </div>
                  </div>
                </div>
              </div>
            <% end %>
          <% else %>
            <div class="text-center py-5">
              <i class="fas fa-fingerprint fa-4x text-muted mb-3"></i>
              <h5>パスキーが登録されていません</h5>
              <p class="text-muted">
                パスキーを登録すると、パスワード不要で安全にログインできます。
              </p>
              <%= link_to "パスキーを登録", new_user_passkey_path, class: "btn btn-primary" %>
            </div>
          <% end %>
        </div>

        <div class="card-footer">
          <%= link_to "アカウント設定に戻る", user_account_path, class: "btn btn-outline-secondary" %>
        </div>
      </div>
    </div>
  </div>
</div>