
<div class="container mt-4">
  <div class="row justify-content-center">
    <div class="col-md-8">
      <div class="card">
        <div class="card-header">
          <h4><i class="fas fa-fingerprint me-2"></i>パスキー認証詳細</h4>
        </div>
        <div class="card-body">
          <!-- 認証情報の詳細 -->
          <div class="row mb-3">
            <div class="col-sm-3">
              <strong>認証名:</strong>
            </div>
            <div class="col-sm-9">
              <i class="fas fa-fingerprint me-2"></i>
              <%= @webauthn_credential.name %>
            </div>
          </div>

          <div class="row mb-3">
            <div class="col-sm-3">
              <strong>登録日時:</strong>
            </div>
            <div class="col-sm-9">
              <%= @webauthn_credential.created_at.strftime('%Y年%m月%d日 %H時%M分') %>
            </div>
          </div>

          <div class="row mb-3">
            <div class="col-sm-3">
              <strong>最終使用日時:</strong>
            </div>
            <div class="col-sm-9">
              <% if @webauthn_credential.last_used_at %>
                <%= @webauthn_credential.last_used_at.strftime('%Y年%m月%d日 %H時%M分') %>
              <% else %>
                <span class="text-muted">未使用</span>
              <% end %>
            </div>
          </div>

          <div class="row mb-3">
            <div class="col-sm-3">
              <strong>使用回数:</strong>
            </div>
            <div class="col-sm-9">
              <%= @webauthn_credential.sign_count %>回
            </div>
          </div>

          <!-- 警告メッセージ -->
          <div class="alert alert-warning">
            <h6><i class="fas fa-exclamation-triangle me-2"></i>注意事項</h6>
            <ul class="mb-0">
              <li>この認証を削除すると、この方法でのログインができなくなります</li>
              <li>他の認証方法またはパスワードでログインできることを確認してから削除してください</li>
              <li>削除した認証は復元できません</li>
            </ul>
          </div>

          <!-- アクションボタン -->
          <div class="d-flex gap-2 justify-content-between">
            <a href="<%= webauthn_credentials_path %>" class="btn btn-outline-secondary">
              <i class="fas fa-arrow-left me-2"></i>認証管理に戻る
            </a>

            <div>
              <%= button_to webauthn_credential_path(@webauthn_credential),
                            method: :delete,
                            form: {
                              "data-turbo-confirm": "「#{@webauthn_credential.name}」を削除してもよろしいですか？\n\n削除後はこの方法でログインできなくなります。"
                            },
                            class: "btn btn-danger" do %>
                <i class="fas fa-trash me-2"></i>この認証を削除
              <% end %>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>