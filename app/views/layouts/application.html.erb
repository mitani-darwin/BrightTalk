<!DOCTYPE html>
<html>
<head>
  <title>BrightTalk</title>
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <%= csrf_meta_tags %>
  <%= csp_meta_tag %>
  <meta name="csp-nonce" content="<%= content_security_policy_nonce %>">
  <%= favicon_link_tag '/favicon.ico' %>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js" nonce="<%= content_security_policy_nonce %>"></script>

  <!-- Tailwind CSS 4.1 (CDN) -->
  <script nonce="<%= content_security_policy_nonce %>" src="https://cdn.tailwindcss.com?plugins=forms,typography&version=4.1.0"></script>
  <script nonce="<%= content_security_policy_nonce %>">
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            brand: {
              50: '#edf5ff',
              100: '#d7e7ff',
              200: '#b2ceff',
              300: '#7fabff',
              400: '#4a82ff',
              500: '#2563eb',
              600: '#1d4ed8',
              700: '#1e3a8a',
              800: '#172554',
              900: '#0b1433'
            }
          },
          boxShadow: {
            card: '0 10px 30px rgba(15, 23, 42, 0.12)',
            soft: '0 8px 20px rgba(15, 23, 42, 0.08)'
          }
        }
      }
    }
  </script>
  <style nonce="<%= content_security_policy_nonce %>" type="text/tailwindcss">
    @layer base {
      body {
        @apply bg-slate-50 text-slate-900;
      }
    }
    @layer components {
      .btn {
        @apply inline-flex items-center justify-center gap-2 rounded-lg border border-transparent px-4 py-2 text-sm font-semibold transition hover:-translate-y-0.5 hover:shadow-soft focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-brand-400 focus-visible:ring-offset-2;
      }
      .btn-primary {
        @apply bg-brand-600 text-white hover:bg-brand-500;
      }
      .btn-secondary {
        @apply bg-white text-slate-800 border border-slate-300 hover:bg-slate-50;
      }
      .btn-danger {
        @apply bg-red-600 text-white hover:bg-red-500;
      }
      .btn-outline-primary {
        @apply border border-brand-500 bg-transparent text-brand-600 hover:bg-brand-50;
      }
      .btn-outline-secondary {
        @apply border border-slate-300 bg-white text-slate-700 hover:bg-slate-50;
      }
      .btn-outline-danger {
        @apply border border-rose-500 bg-white text-rose-600 hover:bg-rose-50;
      }
      .btn-sm { @apply px-3 py-2 text-xs; }
      .btn-lg { @apply px-5 py-3 text-base; }
      .btn-link {
        @apply text-brand-600 hover:text-brand-500;
      }
      .badge {
        @apply inline-flex items-center gap-1 rounded-full px-3 py-1 text-xs font-semibold;
      }
      .badge-primary { @apply bg-brand-50 text-brand-700; }
      .badge-secondary { @apply bg-slate-100 text-slate-700; }
      .card {
        @apply rounded-2xl bg-white shadow-card ring-1 ring-slate-100;
      }
      .card-section {
        @apply border-b border-slate-100 last:border-b-0;
      }
      .input {
        @apply block w-full rounded-lg border border-slate-200 bg-white px-3 py-2 text-sm shadow-sm focus:border-brand-400 focus:ring-2 focus:ring-brand-200;
      }
      .form-control { @apply input; }
      .form-select { @apply input; }
      .label {
        @apply text-sm font-semibold text-slate-700;
      }
      .nav-link {
        @apply text-sm font-semibold text-slate-200 transition hover:text-white;
      }
      .nav-link--primary {
        @apply inline-flex items-center gap-2 rounded-xl bg-white/10 px-4 py-2 text-sm font-semibold text-white hover:bg-white/20;
      }
      .pill {
        @apply inline-flex items-center gap-2 rounded-full bg-slate-100 px-3 py-1 text-xs font-semibold text-slate-700;
      }
      .text-muted { @apply text-slate-500; }
      .bg-primary { @apply bg-brand-600 text-white; }
      .bg-secondary { @apply bg-slate-200 text-slate-800; }
      .bg-info { @apply bg-sky-500 text-white; }
      .bg-warning { @apply bg-amber-400 text-white; }
      .bg-danger { @apply bg-rose-600 text-white; }
      .toast-container { @apply fixed top-4 left-1/2 -translate-x-1/2 z-[1060] space-y-2; }
      .toast { @apply flex items-center gap-2 rounded-xl px-4 py-3 text-sm font-semibold shadow-soft; }
    }
    @layer utilities {
      .glass {
        @apply bg-white/80 backdrop-blur supports-[backdrop-filter]:bg-white/75;
      }
    }
  </style>

  <!-- Google Analytics (GA4) -->
  <% if Rails.env.production? && ENV['GOOGLE_ANALYTICS_ID'].present? %>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=<%= ENV['GOOGLE_ANALYTICS_ID'] %>"></script>
    <script nonce="<%= content_security_policy_nonce %>">
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', '<%= ENV['GOOGLE_ANALYTICS_ID'] %>');
    </script>
  <% end %>

  <!-- Icons -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" crossorigin="anonymous" referrerpolicy="no-referrer"/>

  <!-- Vite client (dev only) and application entry -->
  <%= vite_client_tag if Rails.env.development? %>
  <%= vite_javascript_tag 'application' %>

</head>

<body class="min-h-screen bg-slate-50 text-slate-900 antialiased flex flex-col">
<%= render 'shared/navigation' %>

<main class="flex-1 w-full max-w-screen-xl mx-auto px-4 sm:px-6 lg:px-10 py-8">
  <%= render 'shared/flash_messages' %>
  <%= yield %>
</main>
<%= render 'shared/footer' %>
</body>
</html>
