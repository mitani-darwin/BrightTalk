<div class="row">
  <div class="col-12">
    <%= form_with model: post, multipart: true, class: "needs-validation",
                  novalidate: true, local: false, data: { turbo: false } do |form| %>
      
      <!-- 自動保存済み投稿IDを保持する隠しフィールド -->
      <input type="hidden" name="post_id" id="post_id" value="<%= post.persisted? ? post.slug : '' %>">
      
      <!-- エラーメッセージ表示 -->
      <%= render 'form_errors', post: post %>

      <div class="row" id="formContainer" style="min-height: calc(100vh - 140px);">
        <!-- サイドバー（左側） -->
        <div class="col-md-4" style="height: 100%;">
          <%= render 'form_sidebar', form: form, post: post %>
        </div>

        <!-- メインコンテンツ（右側） -->
        <div class="col-md-8 d-flex flex-column" style="height: 100%;">
          <%= render 'form_main_content', form: form, post: post %>
        </div>
      </div>
    <% end %>
  </div>
</div>

<!-- 自動保存ステータス -->
<%= render 'auto_save_status' %>

<!-- 更新進捗モーダル -->
<%= render 'upload_progress_modal' %>

<!-- JavaScript -->
<%= render 'form_javascript' %>