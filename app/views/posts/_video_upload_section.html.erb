<%= form.label :videos, "動画", class: "form-label" %>

<!-- 既存の動画を表示（編集時のみ） -->
<% if post.persisted? && post.videos.attached? %>
  <div class="mb-3">
    <small class="text-muted d-block mb-2">現在アップロード済みの動画:</small>
    <div class="row g-2">
      <% post.videos.each_with_index do |video, index| %>
        <div class="col-6 col-md-4" id="video-card-<%= video.id %>">
          <div class="card">
            <div class="card-body p-2 text-center">
              <i class="fas fa-video fa-3x text-muted mb-2"></i>
              <small class="text-muted d-block"><%= video.filename %></small>
              <div class="d-flex gap-1 mt-1">
                <button type="button" class="btn btn-outline-primary btn-sm flex-fill insert-existing-video"
                        data-filename="<%= video.filename %>"
                        data-url="attachment:<%= video.filename %>">
                  <i class="fas fa-plus"></i> 挿入
                </button>
                <button type="button" class="btn btn-outline-danger btn-sm delete-video-btn"
                        data-post-id="<%= post.id %>"
                        data-attachment-id="<%= video.id %>"
                        data-filename="<%= video.filename %>">
                  <i class="fas fa-trash"></i>
                </button>
              </div>
            </div>
          </div>
        </div>
      <% end %>
    </div>
    <small class="text-info d-block mt-2">
      <i class="fas fa-info-circle"></i>
      既存の動画は自動的に保持されます。新しい動画を追加する場合のみ下のファイル選択を使用してください。
    </small>
  </div>
<% end %>

<%= form.file_field :videos, accept: "video/*", direct_upload: true,
                    class: "form-control", id: "videoInput" %>
<div class="form-text">
  動画は1つのみ選択できます（MP4, WebM など）。選択すると、内容欄のカーソル位置に動画のプレースホルダを自動で挿入します（プレビューは表示しません）。
</div>