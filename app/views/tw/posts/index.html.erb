<div class="space-y-10">
  <header class="flex flex-col gap-4 md:flex-row md:items-end md:justify-between">
    <div class="space-y-2">
      <h1 class="text-3xl font-semibold leading-tight tracking-tight text-slate-900">記事一覧</h1>
      <p class="text-base leading-7 text-slate-600">最新の記事を読みやすいレイアウトでお届けします。</p>
    </div>
    <div class="w-full md:w-auto">
      <%= form_with url: posts_path, method: :get, scope: nil, class: "flex w-full items-center gap-2" do |f| %>
        <%= f.text_field :q,
                         value: params[:q],
                         placeholder: "記事を検索",
                         class: "h-11 w-full rounded-xl border border-slate-200 bg-white px-4 text-base text-slate-700 shadow-sm focus:border-brand-400 focus:ring-2 focus:ring-brand-200 md:w-72" %>
        <%= f.submit "検索", class: "h-11 rounded-xl bg-brand-600 px-4 text-sm font-semibold text-white shadow-sm transition hover:bg-brand-500 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-brand-400 focus-visible:ring-offset-2" %>
      <% end %>
    </div>
  </header>

  <div class="grid gap-8 lg:grid-cols-[minmax(0,1fr)_18rem]">
    <section class="space-y-6">
      <% if @posts.any? %>
        <div class="grid gap-6 sm:grid-cols-2 xl:grid-cols-3">
          <% @posts.each do |post| %>
            <%= render "posts/post_card", post: post %>
          <% end %>
        </div>
      <% else %>
        <%= render "shared/empty_state" %>
      <% end %>

      <div class="flex justify-center pt-4">
        <%= render "shared/pagination", collection: @posts %>
      </div>
    </section>

    <aside class="hidden lg:block">
      <div class="sticky top-24 space-y-6">
        <div class="rounded-2xl border border-slate-200 bg-white p-5 shadow-sm">
          <h2 class="text-sm font-semibold uppercase tracking-widest text-slate-500">カテゴリー</h2>
          <div class="mt-4 space-y-2 text-sm">
            <% if defined?(Category) && Category.exists? %>
              <% Category.order(:name).limit(8).each do |category| %>
                <%= link_to category.full_name, posts_path(category_id: category.id), class: "block rounded-lg px-3 py-2 text-slate-700 transition hover:bg-slate-50 hover:text-slate-900" %>
              <% end %>
            <% else %>
              <p class="text-slate-500">カテゴリーはまだありません。</p>
            <% end %>
          </div>
        </div>

        <div class="rounded-2xl border border-slate-200 bg-white p-5 shadow-sm">
          <h2 class="text-sm font-semibold uppercase tracking-widest text-slate-500">人気タグ</h2>
          <div class="mt-4 flex flex-wrap gap-2">
            <% if defined?(Tag) && Tag.exists? %>
              <% Tag.order(:name).limit(10).each do |tag| %>
                <%= link_to "##{tag.name}", posts_path(tag: tag.name), class: "inline-flex items-center rounded-full border border-slate-200 px-3 py-1 text-xs font-semibold text-slate-600 transition hover:border-slate-300 hover:bg-slate-50" %>
              <% end %>
            <% else %>
              <span class="text-sm text-slate-500">タグはまだありません。</span>
            <% end %>
          </div>
        </div>
      </div>
    </aside>
  </div>
</div>
