<div class="container mt-4">
  <div class="row">
    <div class="col-md-8">
      <div class="card">
        <div class="card-header">
          <h4><i class="fas fa-fingerprint me-2"></i>パスキー認証管理</h4>
        </div>
        <div class="card-body">
          <% if current_user.passkeys.any? %>
            <p class="mb-3">登録されたパスキー認証デバイス:</p>

            <% current_user.passkeys.each do |passkey| %>
              <div class="card mb-3">
                <div class="card-body">
                  <div class="row align-items-center">
                    <div class="col">
                      <h6 class="card-title mb-1">
                        <i class="fas fa-key me-2"></i><%= passkey.label %>
                      </h6>
                      <small class="text-muted">
                        登録日時: <%= passkey.created_at.strftime('%Y年%m月%d日 %H:%M') %>
                        <% if passkey.last_used_at %>
                          | 最終使用: <%= passkey.last_used_at.strftime('%Y年%m月%d日 %H:%M') %>
                        <% end %>
                      </small>
                    </div>
                    <div class="col-auto">
                      <%= link_to user_passkey_path(passkey),
                                  method: :delete,
                                  data: {
                                    confirm: "「#{passkey.label}」を削除してもよろしいですか？",
                                    turbo: false
                                  },
                                  class: "btn btn-outline-danger btn-sm" do %>
                        <i class="fas fa-trash"></i> 削除
                      <% end %>
                    </div>
                  </div>
                </div>
              </div>
            <% end %>

            <div class="d-grid gap-2 mt-4">
              <%= link_to new_user_passkey_path, class: "btn btn-primary" do %>
                <i class="fas fa-plus me-2"></i>新しいパスキーを追加
              <% end %>
            </div>
          <% else %>
            <div class="text-center py-5">
              <i class="fas fa-fingerprint fa-4x text-muted mb-3"></i>
              <h5>パスキー認証が未設定です</h5>
              <p class="text-muted">
                パスキー認証を設定すると、Touch ID、Face ID、またはセキュリティキーを使用して<br>
                パスワードなしで安全にログインできます。
              </p>
              <div class="d-grid gap-2 col-md-6 mx-auto mt-4">
                <%= link_to new_user_passkey_path, class: "btn btn-primary btn-lg" do %>
                  <i class="fas fa-fingerprint me-2"></i>パスキー認証を設定
                <% end %>
              </div>
            </div>
          <% end %>
        </div>
      </div>
    </div>

    <div class="col-md-4">
      <div class="card">
        <div class="card-header">
          <h6><i class="fas fa-info-circle me-2"></i>パスキー認証について</h6>
        </div>
        <div class="card-body">
          <ul class="list-unstyled">
            <li class="mb-2">
              <i class="fas fa-shield-alt text-success me-2"></i>
              より安全なログイン
            </li>
            <li class="mb-2">
              <i class="fas fa-clock text-info me-2"></i>
              高速なアクセス
            </li>
            <li class="mb-2">
              <i class="fas fa-mobile-alt text-primary me-2"></i>
              生体認証対応
            </li>
            <li class="mb-2">
              <i class="fas fa-key text-warning me-2"></i>
              セキュリティキー対応
            </li>
          </ul>

          <hr>

          <h6>サポートデバイス:</h6>
          <ul class="small text-muted">
            <li>iPhone (Face ID / Touch ID)</li>
            <li>Android (指紋認証)</li>
            <li>Mac (Touch ID)</li>
            <li>Windows Hello対応PC</li>
            <li>セキュリティキー (FIDO2)</li>
          </ul>
        </div>
      </div>

      <div class="mt-3">
        <%= link_to user_account_path, class: "btn btn-outline-secondary w-100" do %>
          <i class="fas fa-arrow-left me-2"></i>アカウント設定に戻る
        <% end %>
      </div>
    </div>
  </div>
</div>