const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/new-DbwhxP13.js","assets/passkey-dcje0AiI.js"])))=>i.map(i=>d[i]);
import{s as $A,a as BA}from"./passkey-dcje0AiI.js";const NA="modulepreload",FA=function(r){return"/vite/"+r},PO={},UA=function(e,t,i){let s=Promise.resolve();if(t&&t.length>0){let l=function(u){return Promise.all(u.map(c=>Promise.resolve(c).then(h=>({status:"fulfilled",value:h}),h=>({status:"rejected",reason:h}))))};document.getElementsByTagName("link");const a=document.querySelector("meta[property=csp-nonce]"),o=a?.nonce||a?.getAttribute("nonce");s=l(t.map(u=>{if(u=FA(u),u in PO)return;PO[u]=!0;const c=u.endsWith(".css"),h=c?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${u}"]${h}`))return;const f=document.createElement("link");if(f.rel=c?"stylesheet":NA,c||(f.as="script"),f.crossOrigin="",f.href=u,o&&f.setAttribute("nonce",o),document.head.appendChild(f),c)return new Promise((m,S)=>{f.addEventListener("load",m),f.addEventListener("error",()=>S(new Error(`Unable to preload CSS for ${u}`)))})}))}function n(a){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=a,window.dispatchEvent(o),!o.defaultPrevented)throw a}return s.then(a=>{for(const o of a||[])o.status==="rejected"&&n(o.reason);return e().catch(n)})};class qA{constructor(e,t,i){this.eventTarget=e,this.eventName=t,this.eventOptions=i,this.unorderedBindings=new Set}connect(){this.eventTarget.addEventListener(this.eventName,this,this.eventOptions)}disconnect(){this.eventTarget.removeEventListener(this.eventName,this,this.eventOptions)}bindingConnected(e){this.unorderedBindings.add(e)}bindingDisconnected(e){this.unorderedBindings.delete(e)}handleEvent(e){const t=VA(e);for(const i of this.bindings){if(t.immediatePropagationStopped)break;i.handleEvent(t)}}hasBindings(){return this.unorderedBindings.size>0}get bindings(){return Array.from(this.unorderedBindings).sort((e,t)=>{const i=e.index,s=t.index;return i<s?-1:i>s?1:0})}}function VA(r){if("immediatePropagationStopped"in r)return r;{const{stopImmediatePropagation:e}=r;return Object.assign(r,{immediatePropagationStopped:!1,stopImmediatePropagation(){this.immediatePropagationStopped=!0,e.call(this)}})}}class XA{constructor(e){this.application=e,this.eventListenerMaps=new Map,this.started=!1}start(){this.started||(this.started=!0,this.eventListeners.forEach(e=>e.connect()))}stop(){this.started&&(this.started=!1,this.eventListeners.forEach(e=>e.disconnect()))}get eventListeners(){return Array.from(this.eventListenerMaps.values()).reduce((e,t)=>e.concat(Array.from(t.values())),[])}bindingConnected(e){this.fetchEventListenerForBinding(e).bindingConnected(e)}bindingDisconnected(e,t=!1){this.fetchEventListenerForBinding(e).bindingDisconnected(e),t&&this.clearEventListenersForBinding(e)}handleError(e,t,i={}){this.application.handleError(e,`Error ${t}`,i)}clearEventListenersForBinding(e){const t=this.fetchEventListenerForBinding(e);t.hasBindings()||(t.disconnect(),this.removeMappedEventListenerFor(e))}removeMappedEventListenerFor(e){const{eventTarget:t,eventName:i,eventOptions:s}=e,n=this.fetchEventListenerMapForEventTarget(t),a=this.cacheKey(i,s);n.delete(a),n.size==0&&this.eventListenerMaps.delete(t)}fetchEventListenerForBinding(e){const{eventTarget:t,eventName:i,eventOptions:s}=e;return this.fetchEventListener(t,i,s)}fetchEventListener(e,t,i){const s=this.fetchEventListenerMapForEventTarget(e),n=this.cacheKey(t,i);let a=s.get(n);return a||(a=this.createEventListener(e,t,i),s.set(n,a)),a}createEventListener(e,t,i){const s=new qA(e,t,i);return this.started&&s.connect(),s}fetchEventListenerMapForEventTarget(e){let t=this.eventListenerMaps.get(e);return t||(t=new Map,this.eventListenerMaps.set(e,t)),t}cacheKey(e,t){const i=[e];return Object.keys(t).sort().forEach(s=>{i.push(`${t[s]?"":"!"}${s}`)}),i.join(":")}}const jA={stop({event:r,value:e}){return e&&r.stopPropagation(),!0},prevent({event:r,value:e}){return e&&r.preventDefault(),!0},self({event:r,value:e,element:t}){return e?t===r.target:!0}},zA=/^(?:(?:([^.]+?)\+)?(.+?)(?:\.(.+?))?(?:@(window|document))?->)?(.+?)(?:#([^:]+?))(?::(.+))?$/;function ZA(r){const t=r.trim().match(zA)||[];let i=t[2],s=t[3];return s&&!["keydown","keyup","keypress"].includes(i)&&(i+=`.${s}`,s=""),{eventTarget:WA(t[4]),eventName:i,eventOptions:t[7]?HA(t[7]):{},identifier:t[5],methodName:t[6],keyFilter:t[1]||s}}function WA(r){if(r=="window")return window;if(r=="document")return document}function HA(r){return r.split(":").reduce((e,t)=>Object.assign(e,{[t.replace(/^!/,"")]:!/^!/.test(t)}),{})}function YA(r){if(r==window)return"window";if(r==document)return"document"}function zm(r){return r.replace(/(?:[_-])([a-z0-9])/g,(e,t)=>t.toUpperCase())}function lp(r){return zm(r.replace(/--/g,"-").replace(/__/g,"_"))}function ql(r){return r.charAt(0).toUpperCase()+r.slice(1)}function a1(r){return r.replace(/([A-Z])/g,(e,t)=>`-${t.toLowerCase()}`)}function GA(r){return r.match(/[^\s]+/g)||[]}function DO(r){return r!=null}function up(r,e){return Object.prototype.hasOwnProperty.call(r,e)}const MO=["meta","ctrl","alt","shift"];class KA{constructor(e,t,i,s){this.element=e,this.index=t,this.eventTarget=i.eventTarget||e,this.eventName=i.eventName||JA(e)||Mu("missing event name"),this.eventOptions=i.eventOptions||{},this.identifier=i.identifier||Mu("missing identifier"),this.methodName=i.methodName||Mu("missing method name"),this.keyFilter=i.keyFilter||"",this.schema=s}static forToken(e,t){return new this(e.element,e.index,ZA(e.content),t)}toString(){const e=this.keyFilter?`.${this.keyFilter}`:"",t=this.eventTargetName?`@${this.eventTargetName}`:"";return`${this.eventName}${e}${t}->${this.identifier}#${this.methodName}`}shouldIgnoreKeyboardEvent(e){if(!this.keyFilter)return!1;const t=this.keyFilter.split("+");if(this.keyFilterDissatisfied(e,t))return!0;const i=t.filter(s=>!MO.includes(s))[0];return i?(up(this.keyMappings,i)||Mu(`contains unknown key filter: ${this.keyFilter}`),this.keyMappings[i].toLowerCase()!==e.key.toLowerCase()):!1}shouldIgnoreMouseEvent(e){if(!this.keyFilter)return!1;const t=[this.keyFilter];return!!this.keyFilterDissatisfied(e,t)}get params(){const e={},t=new RegExp(`^data-${this.identifier}-(.+)-param$`,"i");for(const{name:i,value:s}of Array.from(this.element.attributes)){const n=i.match(t),a=n&&n[1];a&&(e[zm(a)]=eP(s))}return e}get eventTargetName(){return YA(this.eventTarget)}get keyMappings(){return this.schema.keyMappings}keyFilterDissatisfied(e,t){const[i,s,n,a]=MO.map(o=>t.includes(o));return e.metaKey!==i||e.ctrlKey!==s||e.altKey!==n||e.shiftKey!==a}}const IO={a:()=>"click",button:()=>"click",form:()=>"submit",details:()=>"toggle",input:r=>r.getAttribute("type")=="submit"?"click":"input",select:()=>"change",textarea:()=>"input"};function JA(r){const e=r.tagName.toLowerCase();if(e in IO)return IO[e](r)}function Mu(r){throw new Error(r)}function eP(r){try{return JSON.parse(r)}catch{return r}}class tP{constructor(e,t){this.context=e,this.action=t}get index(){return this.action.index}get eventTarget(){return this.action.eventTarget}get eventOptions(){return this.action.eventOptions}get identifier(){return this.context.identifier}handleEvent(e){const t=this.prepareActionEvent(e);this.willBeInvokedByEvent(e)&&this.applyEventModifiers(t)&&this.invokeWithEvent(t)}get eventName(){return this.action.eventName}get method(){const e=this.controller[this.methodName];if(typeof e=="function")return e;throw new Error(`Action "${this.action}" references undefined method "${this.methodName}"`)}applyEventModifiers(e){const{element:t}=this.action,{actionDescriptorFilters:i}=this.context.application,{controller:s}=this.context;let n=!0;for(const[a,o]of Object.entries(this.eventOptions))if(a in i){const l=i[a];n=n&&l({name:a,value:o,event:e,element:t,controller:s})}else continue;return n}prepareActionEvent(e){return Object.assign(e,{params:this.action.params})}invokeWithEvent(e){const{target:t,currentTarget:i}=e;try{this.method.call(this.controller,e),this.context.logDebugActivity(this.methodName,{event:e,target:t,currentTarget:i,action:this.methodName})}catch(s){const{identifier:n,controller:a,element:o,index:l}=this,u={identifier:n,controller:a,element:o,index:l,event:e};this.context.handleError(s,`invoking action "${this.action}"`,u)}}willBeInvokedByEvent(e){const t=e.target;return e instanceof KeyboardEvent&&this.action.shouldIgnoreKeyboardEvent(e)||e instanceof MouseEvent&&this.action.shouldIgnoreMouseEvent(e)?!1:this.element===t?!0:t instanceof Element&&this.element.contains(t)?this.scope.containsElement(t):this.scope.containsElement(this.action.element)}get controller(){return this.context.controller}get methodName(){return this.action.methodName}get element(){return this.scope.element}get scope(){return this.context.scope}}class o1{constructor(e,t){this.mutationObserverInit={attributes:!0,childList:!0,subtree:!0},this.element=e,this.started=!1,this.delegate=t,this.elements=new Set,this.mutationObserver=new MutationObserver(i=>this.processMutations(i))}start(){this.started||(this.started=!0,this.mutationObserver.observe(this.element,this.mutationObserverInit),this.refresh())}pause(e){this.started&&(this.mutationObserver.disconnect(),this.started=!1),e(),this.started||(this.mutationObserver.observe(this.element,this.mutationObserverInit),this.started=!0)}stop(){this.started&&(this.mutationObserver.takeRecords(),this.mutationObserver.disconnect(),this.started=!1)}refresh(){if(this.started){const e=new Set(this.matchElementsInTree());for(const t of Array.from(this.elements))e.has(t)||this.removeElement(t);for(const t of Array.from(e))this.addElement(t)}}processMutations(e){if(this.started)for(const t of e)this.processMutation(t)}processMutation(e){e.type=="attributes"?this.processAttributeChange(e.target,e.attributeName):e.type=="childList"&&(this.processRemovedNodes(e.removedNodes),this.processAddedNodes(e.addedNodes))}processAttributeChange(e,t){this.elements.has(e)?this.delegate.elementAttributeChanged&&this.matchElement(e)?this.delegate.elementAttributeChanged(e,t):this.removeElement(e):this.matchElement(e)&&this.addElement(e)}processRemovedNodes(e){for(const t of Array.from(e)){const i=this.elementFromNode(t);i&&this.processTree(i,this.removeElement)}}processAddedNodes(e){for(const t of Array.from(e)){const i=this.elementFromNode(t);i&&this.elementIsActive(i)&&this.processTree(i,this.addElement)}}matchElement(e){return this.delegate.matchElement(e)}matchElementsInTree(e=this.element){return this.delegate.matchElementsInTree(e)}processTree(e,t){for(const i of this.matchElementsInTree(e))t.call(this,i)}elementFromNode(e){if(e.nodeType==Node.ELEMENT_NODE)return e}elementIsActive(e){return e.isConnected!=this.element.isConnected?!1:this.element.contains(e)}addElement(e){this.elements.has(e)||this.elementIsActive(e)&&(this.elements.add(e),this.delegate.elementMatched&&this.delegate.elementMatched(e))}removeElement(e){this.elements.has(e)&&(this.elements.delete(e),this.delegate.elementUnmatched&&this.delegate.elementUnmatched(e))}}class l1{constructor(e,t,i){this.attributeName=t,this.delegate=i,this.elementObserver=new o1(e,this)}get element(){return this.elementObserver.element}get selector(){return`[${this.attributeName}]`}start(){this.elementObserver.start()}pause(e){this.elementObserver.pause(e)}stop(){this.elementObserver.stop()}refresh(){this.elementObserver.refresh()}get started(){return this.elementObserver.started}matchElement(e){return e.hasAttribute(this.attributeName)}matchElementsInTree(e){const t=this.matchElement(e)?[e]:[],i=Array.from(e.querySelectorAll(this.selector));return t.concat(i)}elementMatched(e){this.delegate.elementMatchedAttribute&&this.delegate.elementMatchedAttribute(e,this.attributeName)}elementUnmatched(e){this.delegate.elementUnmatchedAttribute&&this.delegate.elementUnmatchedAttribute(e,this.attributeName)}elementAttributeChanged(e,t){this.delegate.elementAttributeValueChanged&&this.attributeName==t&&this.delegate.elementAttributeValueChanged(e,t)}}function iP(r,e,t){u1(r,e).add(t)}function rP(r,e,t){u1(r,e).delete(t),sP(r,e)}function u1(r,e){let t=r.get(e);return t||(t=new Set,r.set(e,t)),t}function sP(r,e){const t=r.get(e);t!=null&&t.size==0&&r.delete(e)}class _n{constructor(){this.valuesByKey=new Map}get keys(){return Array.from(this.valuesByKey.keys())}get values(){return Array.from(this.valuesByKey.values()).reduce((t,i)=>t.concat(Array.from(i)),[])}get size(){return Array.from(this.valuesByKey.values()).reduce((t,i)=>t+i.size,0)}add(e,t){iP(this.valuesByKey,e,t)}delete(e,t){rP(this.valuesByKey,e,t)}has(e,t){const i=this.valuesByKey.get(e);return i!=null&&i.has(t)}hasKey(e){return this.valuesByKey.has(e)}hasValue(e){return Array.from(this.valuesByKey.values()).some(i=>i.has(e))}getValuesForKey(e){const t=this.valuesByKey.get(e);return t?Array.from(t):[]}getKeysForValue(e){return Array.from(this.valuesByKey).filter(([t,i])=>i.has(e)).map(([t,i])=>t)}}class nP{constructor(e,t,i,s){this._selector=t,this.details=s,this.elementObserver=new o1(e,this),this.delegate=i,this.matchesByElement=new _n}get started(){return this.elementObserver.started}get selector(){return this._selector}set selector(e){this._selector=e,this.refresh()}start(){this.elementObserver.start()}pause(e){this.elementObserver.pause(e)}stop(){this.elementObserver.stop()}refresh(){this.elementObserver.refresh()}get element(){return this.elementObserver.element}matchElement(e){const{selector:t}=this;if(t){const i=e.matches(t);return this.delegate.selectorMatchElement?i&&this.delegate.selectorMatchElement(e,this.details):i}else return!1}matchElementsInTree(e){const{selector:t}=this;if(t){const i=this.matchElement(e)?[e]:[],s=Array.from(e.querySelectorAll(t)).filter(n=>this.matchElement(n));return i.concat(s)}else return[]}elementMatched(e){const{selector:t}=this;t&&this.selectorMatched(e,t)}elementUnmatched(e){const t=this.matchesByElement.getKeysForValue(e);for(const i of t)this.selectorUnmatched(e,i)}elementAttributeChanged(e,t){const{selector:i}=this;if(i){const s=this.matchElement(e),n=this.matchesByElement.has(i,e);s&&!n?this.selectorMatched(e,i):!s&&n&&this.selectorUnmatched(e,i)}}selectorMatched(e,t){this.delegate.selectorMatched(e,t,this.details),this.matchesByElement.add(t,e)}selectorUnmatched(e,t){this.delegate.selectorUnmatched(e,t,this.details),this.matchesByElement.delete(t,e)}}class aP{constructor(e,t){this.element=e,this.delegate=t,this.started=!1,this.stringMap=new Map,this.mutationObserver=new MutationObserver(i=>this.processMutations(i))}start(){this.started||(this.started=!0,this.mutationObserver.observe(this.element,{attributes:!0,attributeOldValue:!0}),this.refresh())}stop(){this.started&&(this.mutationObserver.takeRecords(),this.mutationObserver.disconnect(),this.started=!1)}refresh(){if(this.started)for(const e of this.knownAttributeNames)this.refreshAttribute(e,null)}processMutations(e){if(this.started)for(const t of e)this.processMutation(t)}processMutation(e){const t=e.attributeName;t&&this.refreshAttribute(t,e.oldValue)}refreshAttribute(e,t){const i=this.delegate.getStringMapKeyForAttribute(e);if(i!=null){this.stringMap.has(e)||this.stringMapKeyAdded(i,e);const s=this.element.getAttribute(e);if(this.stringMap.get(e)!=s&&this.stringMapValueChanged(s,i,t),s==null){const n=this.stringMap.get(e);this.stringMap.delete(e),n&&this.stringMapKeyRemoved(i,e,n)}else this.stringMap.set(e,s)}}stringMapKeyAdded(e,t){this.delegate.stringMapKeyAdded&&this.delegate.stringMapKeyAdded(e,t)}stringMapValueChanged(e,t,i){this.delegate.stringMapValueChanged&&this.delegate.stringMapValueChanged(e,t,i)}stringMapKeyRemoved(e,t,i){this.delegate.stringMapKeyRemoved&&this.delegate.stringMapKeyRemoved(e,t,i)}get knownAttributeNames(){return Array.from(new Set(this.currentAttributeNames.concat(this.recordedAttributeNames)))}get currentAttributeNames(){return Array.from(this.element.attributes).map(e=>e.name)}get recordedAttributeNames(){return Array.from(this.stringMap.keys())}}class c1{constructor(e,t,i){this.attributeObserver=new l1(e,t,this),this.delegate=i,this.tokensByElement=new _n}get started(){return this.attributeObserver.started}start(){this.attributeObserver.start()}pause(e){this.attributeObserver.pause(e)}stop(){this.attributeObserver.stop()}refresh(){this.attributeObserver.refresh()}get element(){return this.attributeObserver.element}get attributeName(){return this.attributeObserver.attributeName}elementMatchedAttribute(e){this.tokensMatched(this.readTokensForElement(e))}elementAttributeValueChanged(e){const[t,i]=this.refreshTokensForElement(e);this.tokensUnmatched(t),this.tokensMatched(i)}elementUnmatchedAttribute(e){this.tokensUnmatched(this.tokensByElement.getValuesForKey(e))}tokensMatched(e){e.forEach(t=>this.tokenMatched(t))}tokensUnmatched(e){e.forEach(t=>this.tokenUnmatched(t))}tokenMatched(e){this.delegate.tokenMatched(e),this.tokensByElement.add(e.element,e)}tokenUnmatched(e){this.delegate.tokenUnmatched(e),this.tokensByElement.delete(e.element,e)}refreshTokensForElement(e){const t=this.tokensByElement.getValuesForKey(e),i=this.readTokensForElement(e),s=lP(t,i).findIndex(([n,a])=>!uP(n,a));return s==-1?[[],[]]:[t.slice(s),i.slice(s)]}readTokensForElement(e){const t=this.attributeName,i=e.getAttribute(t)||"";return oP(i,e,t)}}function oP(r,e,t){return r.trim().split(/\s+/).filter(i=>i.length).map((i,s)=>({element:e,attributeName:t,content:i,index:s}))}function lP(r,e){const t=Math.max(r.length,e.length);return Array.from({length:t},(i,s)=>[r[s],e[s]])}function uP(r,e){return r&&e&&r.index==e.index&&r.content==e.content}class h1{constructor(e,t,i){this.tokenListObserver=new c1(e,t,this),this.delegate=i,this.parseResultsByToken=new WeakMap,this.valuesByTokenByElement=new WeakMap}get started(){return this.tokenListObserver.started}start(){this.tokenListObserver.start()}stop(){this.tokenListObserver.stop()}refresh(){this.tokenListObserver.refresh()}get element(){return this.tokenListObserver.element}get attributeName(){return this.tokenListObserver.attributeName}tokenMatched(e){const{element:t}=e,{value:i}=this.fetchParseResultForToken(e);i&&(this.fetchValuesByTokenForElement(t).set(e,i),this.delegate.elementMatchedValue(t,i))}tokenUnmatched(e){const{element:t}=e,{value:i}=this.fetchParseResultForToken(e);i&&(this.fetchValuesByTokenForElement(t).delete(e),this.delegate.elementUnmatchedValue(t,i))}fetchParseResultForToken(e){let t=this.parseResultsByToken.get(e);return t||(t=this.parseToken(e),this.parseResultsByToken.set(e,t)),t}fetchValuesByTokenForElement(e){let t=this.valuesByTokenByElement.get(e);return t||(t=new Map,this.valuesByTokenByElement.set(e,t)),t}parseToken(e){try{return{value:this.delegate.parseValueForToken(e)}}catch(t){return{error:t}}}}class cP{constructor(e,t){this.context=e,this.delegate=t,this.bindingsByAction=new Map}start(){this.valueListObserver||(this.valueListObserver=new h1(this.element,this.actionAttribute,this),this.valueListObserver.start())}stop(){this.valueListObserver&&(this.valueListObserver.stop(),delete this.valueListObserver,this.disconnectAllActions())}get element(){return this.context.element}get identifier(){return this.context.identifier}get actionAttribute(){return this.schema.actionAttribute}get schema(){return this.context.schema}get bindings(){return Array.from(this.bindingsByAction.values())}connectAction(e){const t=new tP(this.context,e);this.bindingsByAction.set(e,t),this.delegate.bindingConnected(t)}disconnectAction(e){const t=this.bindingsByAction.get(e);t&&(this.bindingsByAction.delete(e),this.delegate.bindingDisconnected(t))}disconnectAllActions(){this.bindings.forEach(e=>this.delegate.bindingDisconnected(e,!0)),this.bindingsByAction.clear()}parseValueForToken(e){const t=KA.forToken(e,this.schema);if(t.identifier==this.identifier)return t}elementMatchedValue(e,t){this.connectAction(t)}elementUnmatchedValue(e,t){this.disconnectAction(t)}}class hP{constructor(e,t){this.context=e,this.receiver=t,this.stringMapObserver=new aP(this.element,this),this.valueDescriptorMap=this.controller.valueDescriptorMap}start(){this.stringMapObserver.start(),this.invokeChangedCallbacksForDefaultValues()}stop(){this.stringMapObserver.stop()}get element(){return this.context.element}get controller(){return this.context.controller}getStringMapKeyForAttribute(e){if(e in this.valueDescriptorMap)return this.valueDescriptorMap[e].name}stringMapKeyAdded(e,t){const i=this.valueDescriptorMap[t];this.hasValue(e)||this.invokeChangedCallback(e,i.writer(this.receiver[e]),i.writer(i.defaultValue))}stringMapValueChanged(e,t,i){const s=this.valueDescriptorNameMap[t];e!==null&&(i===null&&(i=s.writer(s.defaultValue)),this.invokeChangedCallback(t,e,i))}stringMapKeyRemoved(e,t,i){const s=this.valueDescriptorNameMap[e];this.hasValue(e)?this.invokeChangedCallback(e,s.writer(this.receiver[e]),i):this.invokeChangedCallback(e,s.writer(s.defaultValue),i)}invokeChangedCallbacksForDefaultValues(){for(const{key:e,name:t,defaultValue:i,writer:s}of this.valueDescriptors)i!=null&&!this.controller.data.has(e)&&this.invokeChangedCallback(t,s(i),void 0)}invokeChangedCallback(e,t,i){const s=`${e}Changed`,n=this.receiver[s];if(typeof n=="function"){const a=this.valueDescriptorNameMap[e];try{const o=a.reader(t);let l=i;i&&(l=a.reader(i)),n.call(this.receiver,o,l)}catch(o){throw o instanceof TypeError&&(o.message=`Stimulus Value "${this.context.identifier}.${a.name}" - ${o.message}`),o}}}get valueDescriptors(){const{valueDescriptorMap:e}=this;return Object.keys(e).map(t=>e[t])}get valueDescriptorNameMap(){const e={};return Object.keys(this.valueDescriptorMap).forEach(t=>{const i=this.valueDescriptorMap[t];e[i.name]=i}),e}hasValue(e){const t=this.valueDescriptorNameMap[e],i=`has${ql(t.name)}`;return this.receiver[i]}}class dP{constructor(e,t){this.context=e,this.delegate=t,this.targetsByName=new _n}start(){this.tokenListObserver||(this.tokenListObserver=new c1(this.element,this.attributeName,this),this.tokenListObserver.start())}stop(){this.tokenListObserver&&(this.disconnectAllTargets(),this.tokenListObserver.stop(),delete this.tokenListObserver)}tokenMatched({element:e,content:t}){this.scope.containsElement(e)&&this.connectTarget(e,t)}tokenUnmatched({element:e,content:t}){this.disconnectTarget(e,t)}connectTarget(e,t){var i;this.targetsByName.has(t,e)||(this.targetsByName.add(t,e),(i=this.tokenListObserver)===null||i===void 0||i.pause(()=>this.delegate.targetConnected(e,t)))}disconnectTarget(e,t){var i;this.targetsByName.has(t,e)&&(this.targetsByName.delete(t,e),(i=this.tokenListObserver)===null||i===void 0||i.pause(()=>this.delegate.targetDisconnected(e,t)))}disconnectAllTargets(){for(const e of this.targetsByName.keys)for(const t of this.targetsByName.getValuesForKey(e))this.disconnectTarget(t,e)}get attributeName(){return`data-${this.context.identifier}-target`}get element(){return this.context.element}get scope(){return this.context.scope}}function Vl(r,e){const t=d1(r);return Array.from(t.reduce((i,s)=>(pP(s,e).forEach(n=>i.add(n)),i),new Set))}function fP(r,e){return d1(r).reduce((i,s)=>(i.push(...mP(s,e)),i),[])}function d1(r){const e=[];for(;r;)e.push(r),r=Object.getPrototypeOf(r);return e.reverse()}function pP(r,e){const t=r[e];return Array.isArray(t)?t:[]}function mP(r,e){const t=r[e];return t?Object.keys(t).map(i=>[i,t[i]]):[]}class gP{constructor(e,t){this.started=!1,this.context=e,this.delegate=t,this.outletsByName=new _n,this.outletElementsByName=new _n,this.selectorObserverMap=new Map,this.attributeObserverMap=new Map}start(){this.started||(this.outletDefinitions.forEach(e=>{this.setupSelectorObserverForOutlet(e),this.setupAttributeObserverForOutlet(e)}),this.started=!0,this.dependentContexts.forEach(e=>e.refresh()))}refresh(){this.selectorObserverMap.forEach(e=>e.refresh()),this.attributeObserverMap.forEach(e=>e.refresh())}stop(){this.started&&(this.started=!1,this.disconnectAllOutlets(),this.stopSelectorObservers(),this.stopAttributeObservers())}stopSelectorObservers(){this.selectorObserverMap.size>0&&(this.selectorObserverMap.forEach(e=>e.stop()),this.selectorObserverMap.clear())}stopAttributeObservers(){this.attributeObserverMap.size>0&&(this.attributeObserverMap.forEach(e=>e.stop()),this.attributeObserverMap.clear())}selectorMatched(e,t,{outletName:i}){const s=this.getOutlet(e,i);s&&this.connectOutlet(s,e,i)}selectorUnmatched(e,t,{outletName:i}){const s=this.getOutletFromMap(e,i);s&&this.disconnectOutlet(s,e,i)}selectorMatchElement(e,{outletName:t}){const i=this.selector(t),s=this.hasOutlet(e,t),n=e.matches(`[${this.schema.controllerAttribute}~=${t}]`);return i?s&&n&&e.matches(i):!1}elementMatchedAttribute(e,t){const i=this.getOutletNameFromOutletAttributeName(t);i&&this.updateSelectorObserverForOutlet(i)}elementAttributeValueChanged(e,t){const i=this.getOutletNameFromOutletAttributeName(t);i&&this.updateSelectorObserverForOutlet(i)}elementUnmatchedAttribute(e,t){const i=this.getOutletNameFromOutletAttributeName(t);i&&this.updateSelectorObserverForOutlet(i)}connectOutlet(e,t,i){var s;this.outletElementsByName.has(i,t)||(this.outletsByName.add(i,e),this.outletElementsByName.add(i,t),(s=this.selectorObserverMap.get(i))===null||s===void 0||s.pause(()=>this.delegate.outletConnected(e,t,i)))}disconnectOutlet(e,t,i){var s;this.outletElementsByName.has(i,t)&&(this.outletsByName.delete(i,e),this.outletElementsByName.delete(i,t),(s=this.selectorObserverMap.get(i))===null||s===void 0||s.pause(()=>this.delegate.outletDisconnected(e,t,i)))}disconnectAllOutlets(){for(const e of this.outletElementsByName.keys)for(const t of this.outletElementsByName.getValuesForKey(e))for(const i of this.outletsByName.getValuesForKey(e))this.disconnectOutlet(i,t,e)}updateSelectorObserverForOutlet(e){const t=this.selectorObserverMap.get(e);t&&(t.selector=this.selector(e))}setupSelectorObserverForOutlet(e){const t=this.selector(e),i=new nP(document.body,t,this,{outletName:e});this.selectorObserverMap.set(e,i),i.start()}setupAttributeObserverForOutlet(e){const t=this.attributeNameForOutletName(e),i=new l1(this.scope.element,t,this);this.attributeObserverMap.set(e,i),i.start()}selector(e){return this.scope.outlets.getSelectorForOutletName(e)}attributeNameForOutletName(e){return this.scope.schema.outletAttributeForScope(this.identifier,e)}getOutletNameFromOutletAttributeName(e){return this.outletDefinitions.find(t=>this.attributeNameForOutletName(t)===e)}get outletDependencies(){const e=new _n;return this.router.modules.forEach(t=>{const i=t.definition.controllerConstructor;Vl(i,"outlets").forEach(n=>e.add(n,t.identifier))}),e}get outletDefinitions(){return this.outletDependencies.getKeysForValue(this.identifier)}get dependentControllerIdentifiers(){return this.outletDependencies.getValuesForKey(this.identifier)}get dependentContexts(){const e=this.dependentControllerIdentifiers;return this.router.contexts.filter(t=>e.includes(t.identifier))}hasOutlet(e,t){return!!this.getOutlet(e,t)||!!this.getOutletFromMap(e,t)}getOutlet(e,t){return this.application.getControllerForElementAndIdentifier(e,t)}getOutletFromMap(e,t){return this.outletsByName.getValuesForKey(t).find(i=>i.element===e)}get scope(){return this.context.scope}get schema(){return this.context.schema}get identifier(){return this.context.identifier}get application(){return this.context.application}get router(){return this.application.router}}let OP=class{constructor(e,t){this.logDebugActivity=(i,s={})=>{const{identifier:n,controller:a,element:o}=this;s=Object.assign({identifier:n,controller:a,element:o},s),this.application.logDebugActivity(this.identifier,i,s)},this.module=e,this.scope=t,this.controller=new e.controllerConstructor(this),this.bindingObserver=new cP(this,this.dispatcher),this.valueObserver=new hP(this,this.controller),this.targetObserver=new dP(this,this),this.outletObserver=new gP(this,this);try{this.controller.initialize(),this.logDebugActivity("initialize")}catch(i){this.handleError(i,"initializing controller")}}connect(){this.bindingObserver.start(),this.valueObserver.start(),this.targetObserver.start(),this.outletObserver.start();try{this.controller.connect(),this.logDebugActivity("connect")}catch(e){this.handleError(e,"connecting controller")}}refresh(){this.outletObserver.refresh()}disconnect(){try{this.controller.disconnect(),this.logDebugActivity("disconnect")}catch(e){this.handleError(e,"disconnecting controller")}this.outletObserver.stop(),this.targetObserver.stop(),this.valueObserver.stop(),this.bindingObserver.stop()}get application(){return this.module.application}get identifier(){return this.module.identifier}get schema(){return this.application.schema}get dispatcher(){return this.application.dispatcher}get element(){return this.scope.element}get parentElement(){return this.element.parentElement}handleError(e,t,i={}){const{identifier:s,controller:n,element:a}=this;i=Object.assign({identifier:s,controller:n,element:a},i),this.application.handleError(e,`Error ${t}`,i)}targetConnected(e,t){this.invokeControllerMethod(`${t}TargetConnected`,e)}targetDisconnected(e,t){this.invokeControllerMethod(`${t}TargetDisconnected`,e)}outletConnected(e,t,i){this.invokeControllerMethod(`${lp(i)}OutletConnected`,e,t)}outletDisconnected(e,t,i){this.invokeControllerMethod(`${lp(i)}OutletDisconnected`,e,t)}invokeControllerMethod(e,...t){const i=this.controller;typeof i[e]=="function"&&i[e](...t)}};function yP(r){return bP(r,vP(r))}function bP(r,e){const t=xP(r),i=SP(r.prototype,e);return Object.defineProperties(t.prototype,i),t}function vP(r){return Vl(r,"blessings").reduce((t,i)=>{const s=i(r);for(const n in s){const a=t[n]||{};t[n]=Object.assign(a,s[n])}return t},{})}function SP(r,e){return _P(e).reduce((t,i)=>{const s=TP(r,e,i);return s&&Object.assign(t,{[i]:s}),t},{})}function TP(r,e,t){const i=Object.getOwnPropertyDescriptor(r,t);if(!(i&&"value"in i)){const n=Object.getOwnPropertyDescriptor(e,t).value;return i&&(n.get=i.get||n.get,n.set=i.set||n.set),n}}const _P=typeof Object.getOwnPropertySymbols=="function"?r=>[...Object.getOwnPropertyNames(r),...Object.getOwnPropertySymbols(r)]:Object.getOwnPropertyNames,xP=(()=>{function r(t){function i(){return Reflect.construct(t,arguments,new.target)}return i.prototype=Object.create(t.prototype,{constructor:{value:i}}),Reflect.setPrototypeOf(i,t),i}function e(){const i=r(function(){this.a.call(this)});return i.prototype.a=function(){},new i}try{return e(),r}catch{return i=>class extends i{}}})();function wP(r){return{identifier:r.identifier,controllerConstructor:yP(r.controllerConstructor)}}class CP{constructor(e,t){this.application=e,this.definition=wP(t),this.contextsByScope=new WeakMap,this.connectedContexts=new Set}get identifier(){return this.definition.identifier}get controllerConstructor(){return this.definition.controllerConstructor}get contexts(){return Array.from(this.connectedContexts)}connectContextForScope(e){const t=this.fetchContextForScope(e);this.connectedContexts.add(t),t.connect()}disconnectContextForScope(e){const t=this.contextsByScope.get(e);t&&(this.connectedContexts.delete(t),t.disconnect())}fetchContextForScope(e){let t=this.contextsByScope.get(e);return t||(t=new OP(this,e),this.contextsByScope.set(e,t)),t}}class kP{constructor(e){this.scope=e}has(e){return this.data.has(this.getDataKey(e))}get(e){return this.getAll(e)[0]}getAll(e){const t=this.data.get(this.getDataKey(e))||"";return GA(t)}getAttributeName(e){return this.data.getAttributeNameForKey(this.getDataKey(e))}getDataKey(e){return`${e}-class`}get data(){return this.scope.data}}class EP{constructor(e){this.scope=e}get element(){return this.scope.element}get identifier(){return this.scope.identifier}get(e){const t=this.getAttributeNameForKey(e);return this.element.getAttribute(t)}set(e,t){const i=this.getAttributeNameForKey(e);return this.element.setAttribute(i,t),this.get(e)}has(e){const t=this.getAttributeNameForKey(e);return this.element.hasAttribute(t)}delete(e){if(this.has(e)){const t=this.getAttributeNameForKey(e);return this.element.removeAttribute(t),!0}else return!1}getAttributeNameForKey(e){return`data-${this.identifier}-${a1(e)}`}}class AP{constructor(e){this.warnedKeysByObject=new WeakMap,this.logger=e}warn(e,t,i){let s=this.warnedKeysByObject.get(e);s||(s=new Set,this.warnedKeysByObject.set(e,s)),s.has(t)||(s.add(t),this.logger.warn(i,e))}}function cp(r,e){return`[${r}~="${e}"]`}class PP{constructor(e){this.scope=e}get element(){return this.scope.element}get identifier(){return this.scope.identifier}get schema(){return this.scope.schema}has(e){return this.find(e)!=null}find(...e){return e.reduce((t,i)=>t||this.findTarget(i)||this.findLegacyTarget(i),void 0)}findAll(...e){return e.reduce((t,i)=>[...t,...this.findAllTargets(i),...this.findAllLegacyTargets(i)],[])}findTarget(e){const t=this.getSelectorForTargetName(e);return this.scope.findElement(t)}findAllTargets(e){const t=this.getSelectorForTargetName(e);return this.scope.findAllElements(t)}getSelectorForTargetName(e){const t=this.schema.targetAttributeForScope(this.identifier);return cp(t,e)}findLegacyTarget(e){const t=this.getLegacySelectorForTargetName(e);return this.deprecate(this.scope.findElement(t),e)}findAllLegacyTargets(e){const t=this.getLegacySelectorForTargetName(e);return this.scope.findAllElements(t).map(i=>this.deprecate(i,e))}getLegacySelectorForTargetName(e){const t=`${this.identifier}.${e}`;return cp(this.schema.targetAttribute,t)}deprecate(e,t){if(e){const{identifier:i}=this,s=this.schema.targetAttribute,n=this.schema.targetAttributeForScope(i);this.guide.warn(e,`target:${t}`,`Please replace ${s}="${i}.${t}" with ${n}="${t}". The ${s} attribute is deprecated and will be removed in a future version of Stimulus.`)}return e}get guide(){return this.scope.guide}}class DP{constructor(e,t){this.scope=e,this.controllerElement=t}get element(){return this.scope.element}get identifier(){return this.scope.identifier}get schema(){return this.scope.schema}has(e){return this.find(e)!=null}find(...e){return e.reduce((t,i)=>t||this.findOutlet(i),void 0)}findAll(...e){return e.reduce((t,i)=>[...t,...this.findAllOutlets(i)],[])}getSelectorForOutletName(e){const t=this.schema.outletAttributeForScope(this.identifier,e);return this.controllerElement.getAttribute(t)}findOutlet(e){const t=this.getSelectorForOutletName(e);if(t)return this.findElement(t,e)}findAllOutlets(e){const t=this.getSelectorForOutletName(e);return t?this.findAllElements(t,e):[]}findElement(e,t){return this.scope.queryElements(e).filter(s=>this.matchesElement(s,e,t))[0]}findAllElements(e,t){return this.scope.queryElements(e).filter(s=>this.matchesElement(s,e,t))}matchesElement(e,t,i){const s=e.getAttribute(this.scope.schema.controllerAttribute)||"";return e.matches(t)&&s.split(" ").includes(i)}}class Zm{constructor(e,t,i,s){this.targets=new PP(this),this.classes=new kP(this),this.data=new EP(this),this.containsElement=n=>n.closest(this.controllerSelector)===this.element,this.schema=e,this.element=t,this.identifier=i,this.guide=new AP(s),this.outlets=new DP(this.documentScope,t)}findElement(e){return this.element.matches(e)?this.element:this.queryElements(e).find(this.containsElement)}findAllElements(e){return[...this.element.matches(e)?[this.element]:[],...this.queryElements(e).filter(this.containsElement)]}queryElements(e){return Array.from(this.element.querySelectorAll(e))}get controllerSelector(){return cp(this.schema.controllerAttribute,this.identifier)}get isDocumentScope(){return this.element===document.documentElement}get documentScope(){return this.isDocumentScope?this:new Zm(this.schema,document.documentElement,this.identifier,this.guide.logger)}}class MP{constructor(e,t,i){this.element=e,this.schema=t,this.delegate=i,this.valueListObserver=new h1(this.element,this.controllerAttribute,this),this.scopesByIdentifierByElement=new WeakMap,this.scopeReferenceCounts=new WeakMap}start(){this.valueListObserver.start()}stop(){this.valueListObserver.stop()}get controllerAttribute(){return this.schema.controllerAttribute}parseValueForToken(e){const{element:t,content:i}=e;return this.parseValueForElementAndIdentifier(t,i)}parseValueForElementAndIdentifier(e,t){const i=this.fetchScopesByIdentifierForElement(e);let s=i.get(t);return s||(s=this.delegate.createScopeForElementAndIdentifier(e,t),i.set(t,s)),s}elementMatchedValue(e,t){const i=(this.scopeReferenceCounts.get(t)||0)+1;this.scopeReferenceCounts.set(t,i),i==1&&this.delegate.scopeConnected(t)}elementUnmatchedValue(e,t){const i=this.scopeReferenceCounts.get(t);i&&(this.scopeReferenceCounts.set(t,i-1),i==1&&this.delegate.scopeDisconnected(t))}fetchScopesByIdentifierForElement(e){let t=this.scopesByIdentifierByElement.get(e);return t||(t=new Map,this.scopesByIdentifierByElement.set(e,t)),t}}class IP{constructor(e){this.application=e,this.scopeObserver=new MP(this.element,this.schema,this),this.scopesByIdentifier=new _n,this.modulesByIdentifier=new Map}get element(){return this.application.element}get schema(){return this.application.schema}get logger(){return this.application.logger}get controllerAttribute(){return this.schema.controllerAttribute}get modules(){return Array.from(this.modulesByIdentifier.values())}get contexts(){return this.modules.reduce((e,t)=>e.concat(t.contexts),[])}start(){this.scopeObserver.start()}stop(){this.scopeObserver.stop()}loadDefinition(e){this.unloadIdentifier(e.identifier);const t=new CP(this.application,e);this.connectModule(t);const i=e.controllerConstructor.afterLoad;i&&i.call(e.controllerConstructor,e.identifier,this.application)}unloadIdentifier(e){const t=this.modulesByIdentifier.get(e);t&&this.disconnectModule(t)}getContextForElementAndIdentifier(e,t){const i=this.modulesByIdentifier.get(t);if(i)return i.contexts.find(s=>s.element==e)}proposeToConnectScopeForElementAndIdentifier(e,t){const i=this.scopeObserver.parseValueForElementAndIdentifier(e,t);i?this.scopeObserver.elementMatchedValue(i.element,i):console.error(`Couldn't find or create scope for identifier: "${t}" and element:`,e)}handleError(e,t,i){this.application.handleError(e,t,i)}createScopeForElementAndIdentifier(e,t){return new Zm(this.schema,e,t,this.logger)}scopeConnected(e){this.scopesByIdentifier.add(e.identifier,e);const t=this.modulesByIdentifier.get(e.identifier);t&&t.connectContextForScope(e)}scopeDisconnected(e){this.scopesByIdentifier.delete(e.identifier,e);const t=this.modulesByIdentifier.get(e.identifier);t&&t.disconnectContextForScope(e)}connectModule(e){this.modulesByIdentifier.set(e.identifier,e),this.scopesByIdentifier.getValuesForKey(e.identifier).forEach(i=>e.connectContextForScope(i))}disconnectModule(e){this.modulesByIdentifier.delete(e.identifier),this.scopesByIdentifier.getValuesForKey(e.identifier).forEach(i=>e.disconnectContextForScope(i))}}const RP={controllerAttribute:"data-controller",actionAttribute:"data-action",targetAttribute:"data-target",targetAttributeForScope:r=>`data-${r}-target`,outletAttributeForScope:(r,e)=>`data-${r}-${e}-outlet`,keyMappings:Object.assign(Object.assign({enter:"Enter",tab:"Tab",esc:"Escape",space:" ",up:"ArrowUp",down:"ArrowDown",left:"ArrowLeft",right:"ArrowRight",home:"Home",end:"End",page_up:"PageUp",page_down:"PageDown"},RO("abcdefghijklmnopqrstuvwxyz".split("").map(r=>[r,r]))),RO("0123456789".split("").map(r=>[r,r])))};function RO(r){return r.reduce((e,[t,i])=>Object.assign(Object.assign({},e),{[t]:i}),{})}class LP{constructor(e=document.documentElement,t=RP){this.logger=console,this.debug=!1,this.logDebugActivity=(i,s,n={})=>{this.debug&&this.logFormattedMessage(i,s,n)},this.element=e,this.schema=t,this.dispatcher=new XA(this),this.router=new IP(this),this.actionDescriptorFilters=Object.assign({},jA)}static start(e,t){const i=new this(e,t);return i.start(),i}async start(){await QP(),this.logDebugActivity("application","starting"),this.dispatcher.start(),this.router.start(),this.logDebugActivity("application","start")}stop(){this.logDebugActivity("application","stopping"),this.dispatcher.stop(),this.router.stop(),this.logDebugActivity("application","stop")}register(e,t){this.load({identifier:e,controllerConstructor:t})}registerActionOption(e,t){this.actionDescriptorFilters[e]=t}load(e,...t){(Array.isArray(e)?e:[e,...t]).forEach(s=>{s.controllerConstructor.shouldLoad&&this.router.loadDefinition(s)})}unload(e,...t){(Array.isArray(e)?e:[e,...t]).forEach(s=>this.router.unloadIdentifier(s))}get controllers(){return this.router.contexts.map(e=>e.controller)}getControllerForElementAndIdentifier(e,t){const i=this.router.getContextForElementAndIdentifier(e,t);return i?i.controller:null}handleError(e,t,i){var s;this.logger.error(`%s

%o

%o`,t,e,i),(s=window.onerror)===null||s===void 0||s.call(window,t,"",0,0,e)}logFormattedMessage(e,t,i={}){i=Object.assign({application:this},i),this.logger.groupCollapsed(`${e} #${t}`),this.logger.log("details:",Object.assign({},i)),this.logger.groupEnd()}}function QP(){return new Promise(r=>{document.readyState=="loading"?document.addEventListener("DOMContentLoaded",()=>r()):r()})}function $P(r){return Vl(r,"classes").reduce((t,i)=>Object.assign(t,BP(i)),{})}function BP(r){return{[`${r}Class`]:{get(){const{classes:e}=this;if(e.has(r))return e.get(r);{const t=e.getAttributeName(r);throw new Error(`Missing attribute "${t}"`)}}},[`${r}Classes`]:{get(){return this.classes.getAll(r)}},[`has${ql(r)}Class`]:{get(){return this.classes.has(r)}}}}function NP(r){return Vl(r,"outlets").reduce((t,i)=>Object.assign(t,FP(i)),{})}function LO(r,e,t){return r.application.getControllerForElementAndIdentifier(e,t)}function QO(r,e,t){let i=LO(r,e,t);if(i||(r.application.router.proposeToConnectScopeForElementAndIdentifier(e,t),i=LO(r,e,t),i))return i}function FP(r){const e=lp(r);return{[`${e}Outlet`]:{get(){const t=this.outlets.find(r),i=this.outlets.getSelectorForOutletName(r);if(t){const s=QO(this,t,r);if(s)return s;throw new Error(`The provided outlet element is missing an outlet controller "${r}" instance for host controller "${this.identifier}"`)}throw new Error(`Missing outlet element "${r}" for host controller "${this.identifier}". Stimulus couldn't find a matching outlet element using selector "${i}".`)}},[`${e}Outlets`]:{get(){const t=this.outlets.findAll(r);return t.length>0?t.map(i=>{const s=QO(this,i,r);if(s)return s;console.warn(`The provided outlet element is missing an outlet controller "${r}" instance for host controller "${this.identifier}"`,i)}).filter(i=>i):[]}},[`${e}OutletElement`]:{get(){const t=this.outlets.find(r),i=this.outlets.getSelectorForOutletName(r);if(t)return t;throw new Error(`Missing outlet element "${r}" for host controller "${this.identifier}". Stimulus couldn't find a matching outlet element using selector "${i}".`)}},[`${e}OutletElements`]:{get(){return this.outlets.findAll(r)}},[`has${ql(e)}Outlet`]:{get(){return this.outlets.has(r)}}}}function UP(r){return Vl(r,"targets").reduce((t,i)=>Object.assign(t,qP(i)),{})}function qP(r){return{[`${r}Target`]:{get(){const e=this.targets.find(r);if(e)return e;throw new Error(`Missing target element "${r}" for "${this.identifier}" controller`)}},[`${r}Targets`]:{get(){return this.targets.findAll(r)}},[`has${ql(r)}Target`]:{get(){return this.targets.has(r)}}}}function VP(r){const e=fP(r,"values"),t={valueDescriptorMap:{get(){return e.reduce((i,s)=>{const n=f1(s,this.identifier),a=this.data.getAttributeNameForKey(n.key);return Object.assign(i,{[a]:n})},{})}}};return e.reduce((i,s)=>Object.assign(i,XP(s)),t)}function XP(r,e){const t=f1(r,e),{key:i,name:s,reader:n,writer:a}=t;return{[s]:{get(){const o=this.data.get(i);return o!==null?n(o):t.defaultValue},set(o){o===void 0?this.data.delete(i):this.data.set(i,a(o))}},[`has${ql(s)}`]:{get(){return this.data.has(i)||t.hasCustomDefaultValue}}}}function f1([r,e],t){return WP({controller:t,token:r,typeDefinition:e})}function Dc(r){switch(r){case Array:return"array";case Boolean:return"boolean";case Number:return"number";case Object:return"object";case String:return"string"}}function cl(r){switch(typeof r){case"boolean":return"boolean";case"number":return"number";case"string":return"string"}if(Array.isArray(r))return"array";if(Object.prototype.toString.call(r)==="[object Object]")return"object"}function jP(r){const{controller:e,token:t,typeObject:i}=r,s=DO(i.type),n=DO(i.default),a=s&&n,o=s&&!n,l=!s&&n,u=Dc(i.type),c=cl(r.typeObject.default);if(o)return u;if(l)return c;if(u!==c){const h=e?`${e}.${t}`:t;throw new Error(`The specified default value for the Stimulus Value "${h}" must match the defined type "${u}". The provided default value of "${i.default}" is of type "${c}".`)}if(a)return u}function zP(r){const{controller:e,token:t,typeDefinition:i}=r,n=jP({controller:e,token:t,typeObject:i}),a=cl(i),o=Dc(i),l=n||a||o;if(l)return l;const u=e?`${e}.${i}`:t;throw new Error(`Unknown value type "${u}" for "${t}" value`)}function ZP(r){const e=Dc(r);if(e)return $O[e];const t=up(r,"default"),i=up(r,"type"),s=r;if(t)return s.default;if(i){const{type:n}=s,a=Dc(n);if(a)return $O[a]}return r}function WP(r){const{token:e,typeDefinition:t}=r,i=`${a1(e)}-value`,s=zP(r);return{type:s,key:i,name:zm(i),get defaultValue(){return ZP(t)},get hasCustomDefaultValue(){return cl(t)!==void 0},reader:HP[s],writer:BO[s]||BO.default}}const $O={get array(){return[]},boolean:!1,number:0,get object(){return{}},string:""},HP={array(r){const e=JSON.parse(r);if(!Array.isArray(e))throw new TypeError(`expected value of type "array" but instead got value "${r}" of type "${cl(e)}"`);return e},boolean(r){return!(r=="0"||String(r).toLowerCase()=="false")},number(r){return Number(r.replace(/_/g,""))},object(r){const e=JSON.parse(r);if(e===null||typeof e!="object"||Array.isArray(e))throw new TypeError(`expected value of type "object" but instead got value "${r}" of type "${cl(e)}"`);return e},string(r){return r}},BO={default:YP,array:NO,object:NO};function NO(r){return JSON.stringify(r)}function YP(r){return`${r}`}class Nn{constructor(e){this.context=e}static get shouldLoad(){return!0}static afterLoad(e,t){}get application(){return this.context.application}get scope(){return this.context.scope}get element(){return this.scope.element}get identifier(){return this.scope.identifier}get targets(){return this.scope.targets}get outlets(){return this.scope.outlets}get classes(){return this.scope.classes}get data(){return this.scope.data}initialize(){}connect(){}disconnect(){}dispatch(e,{target:t=this.element,detail:i={},prefix:s=this.identifier,bubbles:n=!0,cancelable:a=!0}={}){const o=s?`${s}:${e}`:e,l=new CustomEvent(o,{detail:i,bubbles:n,cancelable:a});return t.dispatchEvent(l),l}}Nn.blessings=[$P,UP,VP,NP];Nn.targets=[];Nn.outlets=[];Nn.values={};/*!
Turbo 8.0.17
Copyright © 2025 37signals LLC
 */(function(r){if(typeof r.requestSubmit=="function")return;r.requestSubmit=function(i){i?(e(i,this),i.click()):(i=document.createElement("input"),i.type="submit",i.hidden=!0,this.appendChild(i),i.click(),this.removeChild(i))};function e(i,s){i instanceof HTMLElement||t(TypeError,"parameter 1 is not of type 'HTMLElement'"),i.type=="submit"||t(TypeError,"The specified element is not a submit button"),i.form==s||t(DOMException,"The specified element is not owned by this form element","NotFoundError")}function t(i,s,n){throw new i("Failed to execute 'requestSubmit' on 'HTMLFormElement': "+s+".",n)}})(HTMLFormElement.prototype);const p1=new WeakMap;function GP(r){const e=r instanceof Element?r:r instanceof Node?r.parentElement:null,t=e?e.closest("input, button"):null;return t?.type=="submit"?t:null}function KP(r){const e=GP(r.target);e&&e.form&&p1.set(e.form,e)}(function(){if("submitter"in Event.prototype)return;let r=window.Event.prototype;if("SubmitEvent"in window){const e=window.SubmitEvent.prototype;if(/Apple Computer/.test(navigator.vendor)&&!("submitter"in e))r=e;else return}addEventListener("click",KP,!0),Object.defineProperty(r,"submitter",{get(){if(this.type=="submit"&&this.target instanceof HTMLFormElement)return p1.get(this.target)}})})();const ea={eager:"eager",lazy:"lazy"};class gr extends HTMLElement{static delegateConstructor=void 0;loaded=Promise.resolve();static get observedAttributes(){return["disabled","loading","src"]}constructor(){super(),this.delegate=new gr.delegateConstructor(this)}connectedCallback(){this.delegate.connect()}disconnectedCallback(){this.delegate.disconnect()}reload(){return this.delegate.sourceURLReloaded()}attributeChangedCallback(e){e=="loading"?this.delegate.loadingStyleChanged():e=="src"?this.delegate.sourceURLChanged():e=="disabled"&&this.delegate.disabledChanged()}get src(){return this.getAttribute("src")}set src(e){e?this.setAttribute("src",e):this.removeAttribute("src")}get refresh(){return this.getAttribute("refresh")}set refresh(e){e?this.setAttribute("refresh",e):this.removeAttribute("refresh")}get shouldReloadWithMorph(){return this.src&&this.refresh==="morph"}get loading(){return JP(this.getAttribute("loading")||"")}set loading(e){e?this.setAttribute("loading",e):this.removeAttribute("loading")}get disabled(){return this.hasAttribute("disabled")}set disabled(e){e?this.setAttribute("disabled",""):this.removeAttribute("disabled")}get autoscroll(){return this.hasAttribute("autoscroll")}set autoscroll(e){e?this.setAttribute("autoscroll",""):this.removeAttribute("autoscroll")}get complete(){return!this.delegate.isLoading}get isActive(){return this.ownerDocument===document&&!this.isPreview}get isPreview(){return this.ownerDocument?.documentElement?.hasAttribute("data-turbo-preview")}}function JP(r){switch(r.toLowerCase()){case"lazy":return ea.lazy;default:return ea.eager}}const eD={enabled:!0,progressBarDelay:500,unvisitableExtensions:new Set([".7z",".aac",".apk",".avi",".bmp",".bz2",".css",".csv",".deb",".dmg",".doc",".docx",".exe",".gif",".gz",".heic",".heif",".ico",".iso",".jpeg",".jpg",".js",".json",".m4a",".mkv",".mov",".mp3",".mp4",".mpeg",".mpg",".msi",".ogg",".ogv",".pdf",".pkg",".png",".ppt",".pptx",".rar",".rtf",".svg",".tar",".tif",".tiff",".txt",".wav",".webm",".webp",".wma",".wmv",".xls",".xlsx",".xml",".zip"])};function hl(r){if(r.getAttribute("data-turbo-eval")=="false")return r;{const e=document.createElement("script"),t=v1();return t&&(e.nonce=t),e.textContent=r.textContent,e.async=!1,tD(e,r),e}}function tD(r,e){for(const{name:t,value:i}of e.attributes)r.setAttribute(t,i)}function iD(r){const e=document.createElement("template");return e.innerHTML=r,e.content}function bt(r,{target:e,cancelable:t,detail:i}={}){const s=new CustomEvent(r,{cancelable:t,bubbles:!0,composed:!0,detail:i});return e&&e.isConnected?e.dispatchEvent(s):document.documentElement.dispatchEvent(s),s}function FO(r){r.preventDefault(),r.stopImmediatePropagation()}function Zo(){return document.visibilityState==="hidden"?g1():m1()}function m1(){return new Promise(r=>requestAnimationFrame(()=>r()))}function g1(){return new Promise(r=>setTimeout(()=>r(),0))}function rD(){return Promise.resolve()}function O1(r=""){return new DOMParser().parseFromString(r,"text/html")}function y1(r,...e){const t=sD(r,e).replace(/^\n/,"").split(`
`),i=t[0].match(/^\s+/),s=i?i[0].length:0;return t.map(n=>n.slice(s)).join(`
`)}function sD(r,e){return r.reduce((t,i,s)=>{const n=e[s]==null?"":e[s];return t+i+n},"")}function js(){return Array.from({length:36}).map((r,e)=>e==8||e==13||e==18||e==23?"-":e==14?"4":e==19?(Math.floor(Math.random()*4)+8).toString(16):Math.floor(Math.random()*15).toString(16)).join("")}function Mc(r,...e){for(const t of e.map(i=>i?.getAttribute(r)))if(typeof t=="string")return t;return null}function nD(r,...e){return e.some(t=>t&&t.hasAttribute(r))}function Ic(...r){for(const e of r)e.localName=="turbo-frame"&&e.setAttribute("busy",""),e.setAttribute("aria-busy","true")}function Rc(...r){for(const e of r)e.localName=="turbo-frame"&&e.removeAttribute("busy"),e.removeAttribute("aria-busy")}function aD(r,e=2e3){return new Promise(t=>{const i=()=>{r.removeEventListener("error",i),r.removeEventListener("load",i),t()};r.addEventListener("load",i,{once:!0}),r.addEventListener("error",i,{once:!0}),setTimeout(t,e)})}function b1(r){switch(r){case"replace":return history.replaceState;case"advance":case"restore":return history.pushState}}function oD(r){return r=="advance"||r=="replace"||r=="restore"}function xn(...r){const e=Mc("data-turbo-action",...r);return oD(e)?e:null}function Wm(r){return document.querySelector(`meta[name="${r}"]`)}function Lc(r){const e=Wm(r);return e&&e.content}function v1(){const r=Wm("csp-nonce");if(r){const{nonce:e,content:t}=r;return e==""?t:e}}function lD(r,e){let t=Wm(r);return t||(t=document.createElement("meta"),t.setAttribute("name",r),document.head.appendChild(t)),t.setAttribute("content",e),t}function la(r,e){if(r instanceof Element)return r.closest(e)||la(r.assignedSlot||r.getRootNode()?.host,e)}function Hm(r){return!!r&&r.closest("[inert], :disabled, [hidden], details:not([open]), dialog:not([open])")==null&&typeof r.focus=="function"}function S1(r){return Array.from(r.querySelectorAll("[autofocus]")).find(Hm)}async function uD(r,e){const t=e();r(),await m1();const i=e();return[t,i]}function T1(r){if(r==="_blank")return!1;if(r){for(const e of document.getElementsByName(r))if(e instanceof HTMLIFrameElement)return!1;return!0}else return!0}function _1(r){const e=la(r,"a[href], a[xlink\\:href]");return!e||e.hasAttribute("download")||e.hasAttribute("target")&&e.target!=="_self"?null:e}function x1(r){return Gt(r.getAttribute("href")||"")}function cD(r,e){let t=null;return(...i)=>{const s=()=>r.apply(this,i);clearTimeout(t),t=setTimeout(s,e)}}const hD={"aria-disabled":{beforeSubmit:r=>{r.setAttribute("aria-disabled","true"),r.addEventListener("click",FO)},afterSubmit:r=>{r.removeAttribute("aria-disabled"),r.removeEventListener("click",FO)}},disabled:{beforeSubmit:r=>r.disabled=!0,afterSubmit:r=>r.disabled=!1}};let dD=class{#e=null;constructor(e){Object.assign(this,e)}get submitter(){return this.#e}set submitter(e){this.#e=hD[e]||e}};const fD=new dD({mode:"on",submitter:"disabled"}),Ft={drive:eD,forms:fD};function Gt(r){return new URL(r.toString(),document.baseURI)}function wn(r){let e;if(r.hash)return r.hash.slice(1);if(e=r.href.match(/#(.*)$/))return e[1]}function Ym(r,e){const t=e?.getAttribute("formaction")||r.getAttribute("action")||r.action;return Gt(t)}function pD(r){return(OD(r).match(/\.[^.]*$/)||[])[0]||""}function mD(r,e){const t=UO(e.origin+e.pathname);return UO(r.href)===t||r.href.startsWith(t)}function Ns(r,e){return mD(r,e)&&!Ft.drive.unvisitableExtensions.has(pD(r))}function hp(r){const e=wn(r);return e!=null?r.href.slice(0,-(e.length+1)):r.href}function Iu(r){return hp(r)}function w1(r,e){return Gt(r).href==Gt(e).href}function gD(r){return r.pathname.split("/").slice(1)}function OD(r){return gD(r).slice(-1)[0]}function UO(r){return r.endsWith("/")?r:r+"/"}class Gm{constructor(e){this.response=e}get succeeded(){return this.response.ok}get failed(){return!this.succeeded}get clientError(){return this.statusCode>=400&&this.statusCode<=499}get serverError(){return this.statusCode>=500&&this.statusCode<=599}get redirected(){return this.response.redirected}get location(){return Gt(this.response.url)}get isHTML(){return this.contentType&&this.contentType.match(/^(?:text\/([^\s;,]+\b)?html|application\/xhtml\+xml)\b/)}get statusCode(){return this.response.status}get contentType(){return this.header("Content-Type")}get responseText(){return this.response.clone().text()}get responseHTML(){return this.isHTML?this.response.clone().text():Promise.resolve(void 0)}header(e){return this.response.headers.get(e)}}class yD extends Set{constructor(e){super(),this.maxSize=e}add(e){if(this.size>=this.maxSize){const i=this.values().next().value;this.delete(i)}super.add(e)}}const C1=new yD(20);function k1(r,e={}){const t=new Headers(e.headers||{}),i=js();return C1.add(i),t.append("X-Turbo-Request-Id",i),window.fetch(r,{...e,headers:t})}function Km(r){switch(r.toLowerCase()){case"get":return Yi.get;case"post":return Yi.post;case"put":return Yi.put;case"patch":return Yi.patch;case"delete":return Yi.delete}}const Yi={get:"get",post:"post",put:"put",patch:"patch",delete:"delete"};function bD(r){switch(r.toLowerCase()){case fn.multipart:return fn.multipart;case fn.plain:return fn.plain;default:return fn.urlEncoded}}const fn={urlEncoded:"application/x-www-form-urlencoded",multipart:"multipart/form-data",plain:"text/plain"};class Xl{abortController=new AbortController;#e=e=>{};constructor(e,t,i,s=new URLSearchParams,n=null,a=fn.urlEncoded){const[o,l]=qO(Gt(i),t,s,a);this.delegate=e,this.url=o,this.target=n,this.fetchOptions={credentials:"same-origin",redirect:"follow",method:t.toUpperCase(),headers:{...this.defaultHeaders},body:l,signal:this.abortSignal,referrer:this.delegate.referrer?.href},this.enctype=a}get method(){return this.fetchOptions.method}set method(e){const t=this.isSafe?this.url.searchParams:this.fetchOptions.body||new FormData,i=Km(e)||Yi.get;this.url.search="";const[s,n]=qO(this.url,i,t,this.enctype);this.url=s,this.fetchOptions.body=n,this.fetchOptions.method=i.toUpperCase()}get headers(){return this.fetchOptions.headers}set headers(e){this.fetchOptions.headers=e}get body(){return this.isSafe?this.url.searchParams:this.fetchOptions.body}set body(e){this.fetchOptions.body=e}get location(){return this.url}get params(){return this.url.searchParams}get entries(){return this.body?Array.from(this.body.entries()):[]}cancel(){this.abortController.abort()}async perform(){const{fetchOptions:e}=this;this.delegate.prepareRequest(this);const t=await this.#t(e);try{this.delegate.requestStarted(this),t.detail.fetchRequest?this.response=t.detail.fetchRequest.response:this.response=k1(this.url.href,e);const i=await this.response;return await this.receive(i)}catch(i){if(i.name!=="AbortError")throw this.#i(i)&&this.delegate.requestErrored(this,i),i}finally{this.delegate.requestFinished(this)}}async receive(e){const t=new Gm(e);return bt("turbo:before-fetch-response",{cancelable:!0,detail:{fetchResponse:t},target:this.target}).defaultPrevented?this.delegate.requestPreventedHandlingResponse(this,t):t.succeeded?this.delegate.requestSucceededWithResponse(this,t):this.delegate.requestFailedWithResponse(this,t),t}get defaultHeaders(){return{Accept:"text/html, application/xhtml+xml"}}get isSafe(){return Jm(this.method)}get abortSignal(){return this.abortController.signal}acceptResponseType(e){this.headers.Accept=[e,this.headers.Accept].join(", ")}async#t(e){const t=new Promise(s=>this.#e=s),i=bt("turbo:before-fetch-request",{cancelable:!0,detail:{fetchOptions:e,url:this.url,resume:this.#e},target:this.target});return this.url=i.detail.url,i.defaultPrevented&&await t,i}#i(e){return!bt("turbo:fetch-request-error",{target:this.target,cancelable:!0,detail:{request:this,error:e}}).defaultPrevented}}function Jm(r){return Km(r)==Yi.get}function qO(r,e,t,i){const s=Array.from(t).length>0?new URLSearchParams(E1(t)):r.searchParams;return Jm(e)?[vD(r,s),null]:i==fn.urlEncoded?[r,s]:[r,t]}function E1(r){const e=[];for(const[t,i]of r)i instanceof File||e.push([t,i]);return e}function vD(r,e){const t=new URLSearchParams(E1(e));return r.search=t.toString(),r}class SD{started=!1;constructor(e,t){this.delegate=e,this.element=t,this.intersectionObserver=new IntersectionObserver(this.intersect)}start(){this.started||(this.started=!0,this.intersectionObserver.observe(this.element))}stop(){this.started&&(this.started=!1,this.intersectionObserver.unobserve(this.element))}intersect=e=>{e.slice(-1)[0]?.isIntersecting&&this.delegate.elementAppearedInViewport(this.element)}}class Wa{static contentType="text/vnd.turbo-stream.html";static wrap(e){return typeof e=="string"?new this(iD(e)):e}constructor(e){this.fragment=TD(e)}}function TD(r){for(const e of r.querySelectorAll("turbo-stream")){const t=document.importNode(e,!0);for(const i of t.templateElement.content.querySelectorAll("script"))i.replaceWith(hl(i));e.replaceWith(t)}return r}const _D=100;class xD{#e=null;#t=null;get(e){if(this.#t&&this.#t.url===e&&this.#t.expire>Date.now())return this.#t.request}setLater(e,t,i){this.clear(),this.#e=setTimeout(()=>{t.perform(),this.set(e,t,i),this.#e=null},_D)}set(e,t,i){this.#t={url:e,request:t,expire:new Date(new Date().getTime()+i)}}clear(){this.#e&&clearTimeout(this.#e),this.#t=null}}const wD=10*1e3,ta=new xD,Zn={initialized:"initialized",requesting:"requesting",waiting:"waiting",receiving:"receiving",stopping:"stopping",stopped:"stopped"};class Rh{state=Zn.initialized;static confirmMethod(e){return Promise.resolve(confirm(e))}constructor(e,t,i,s=!1){const n=DD(t,i),a=PD(AD(t,i),n),o=CD(t,i),l=MD(t,i);this.delegate=e,this.formElement=t,this.submitter=i,this.fetchRequest=new Xl(this,n,a,o,t,l),this.mustRedirect=s}get method(){return this.fetchRequest.method}set method(e){this.fetchRequest.method=e}get action(){return this.fetchRequest.url.toString()}set action(e){this.fetchRequest.url=Gt(e)}get body(){return this.fetchRequest.body}get enctype(){return this.fetchRequest.enctype}get isSafe(){return this.fetchRequest.isSafe}get location(){return this.fetchRequest.url}async start(){const{initialized:e,requesting:t}=Zn,i=Mc("data-turbo-confirm",this.submitter,this.formElement);if(!(typeof i=="string"&&!await(typeof Ft.forms.confirm=="function"?Ft.forms.confirm:Rh.confirmMethod)(i,this.formElement,this.submitter))&&this.state==e)return this.state=t,this.fetchRequest.perform()}stop(){const{stopping:e,stopped:t}=Zn;if(this.state!=e&&this.state!=t)return this.state=e,this.fetchRequest.cancel(),!0}prepareRequest(e){if(!e.isSafe){const t=kD(Lc("csrf-param"))||Lc("csrf-token");t&&(e.headers["X-CSRF-Token"]=t)}this.requestAcceptsTurboStreamResponse(e)&&e.acceptResponseType(Wa.contentType)}requestStarted(e){this.state=Zn.waiting,this.submitter&&Ft.forms.submitter.beforeSubmit(this.submitter),this.setSubmitsWith(),Ic(this.formElement),bt("turbo:submit-start",{target:this.formElement,detail:{formSubmission:this}}),this.delegate.formSubmissionStarted(this)}requestPreventedHandlingResponse(e,t){ta.clear(),this.result={success:t.succeeded,fetchResponse:t}}requestSucceededWithResponse(e,t){if(t.clientError||t.serverError){this.delegate.formSubmissionFailedWithResponse(this,t);return}if(ta.clear(),this.requestMustRedirect(e)&&ED(t)){const i=new Error("Form responses must redirect to another location");this.delegate.formSubmissionErrored(this,i)}else this.state=Zn.receiving,this.result={success:!0,fetchResponse:t},this.delegate.formSubmissionSucceededWithResponse(this,t)}requestFailedWithResponse(e,t){this.result={success:!1,fetchResponse:t},this.delegate.formSubmissionFailedWithResponse(this,t)}requestErrored(e,t){this.result={success:!1,error:t},this.delegate.formSubmissionErrored(this,t)}requestFinished(e){this.state=Zn.stopped,this.submitter&&Ft.forms.submitter.afterSubmit(this.submitter),this.resetSubmitterText(),Rc(this.formElement),bt("turbo:submit-end",{target:this.formElement,detail:{formSubmission:this,...this.result}}),this.delegate.formSubmissionFinished(this)}setSubmitsWith(){if(!(!this.submitter||!this.submitsWith)){if(this.submitter.matches("button"))this.originalSubmitText=this.submitter.innerHTML,this.submitter.innerHTML=this.submitsWith;else if(this.submitter.matches("input")){const e=this.submitter;this.originalSubmitText=e.value,e.value=this.submitsWith}}}resetSubmitterText(){if(!(!this.submitter||!this.originalSubmitText)){if(this.submitter.matches("button"))this.submitter.innerHTML=this.originalSubmitText;else if(this.submitter.matches("input")){const e=this.submitter;e.value=this.originalSubmitText}}}requestMustRedirect(e){return!e.isSafe&&this.mustRedirect}requestAcceptsTurboStreamResponse(e){return!e.isSafe||nD("data-turbo-stream",this.submitter,this.formElement)}get submitsWith(){return this.submitter?.getAttribute("data-turbo-submits-with")}}function CD(r,e){const t=new FormData(r),i=e?.getAttribute("name"),s=e?.getAttribute("value");return i&&t.append(i,s||""),t}function kD(r){if(r!=null){const t=(document.cookie?document.cookie.split("; "):[]).find(i=>i.startsWith(r));if(t){const i=t.split("=").slice(1).join("=");return i?decodeURIComponent(i):void 0}}}function ED(r){return r.statusCode==200&&!r.redirected}function AD(r,e){const t=typeof r.action=="string"?r.action:null;return e?.hasAttribute("formaction")?e.getAttribute("formaction")||"":r.getAttribute("action")||t||""}function PD(r,e){const t=Gt(r);return Jm(e)&&(t.search=""),t}function DD(r,e){const t=e?.getAttribute("formmethod")||r.getAttribute("method")||"";return Km(t.toLowerCase())||Yi.get}function MD(r,e){return bD(e?.getAttribute("formenctype")||r.enctype)}class Lh{constructor(e){this.element=e}get activeElement(){return this.element.ownerDocument.activeElement}get children(){return[...this.element.children]}hasAnchor(e){return this.getElementForAnchor(e)!=null}getElementForAnchor(e){return e?this.element.querySelector(`[id='${e}'], a[name='${e}']`):null}get isConnected(){return this.element.isConnected}get firstAutofocusableElement(){return S1(this.element)}get permanentElements(){return P1(this.element)}getPermanentElementById(e){return A1(this.element,e)}getPermanentElementMapForSnapshot(e){const t={};for(const i of this.permanentElements){const{id:s}=i,n=e.getPermanentElementById(s);n&&(t[s]=[i,n])}return t}}function A1(r,e){return r.querySelector(`#${e}[data-turbo-permanent]`)}function P1(r){return r.querySelectorAll("[id][data-turbo-permanent]")}class eg{started=!1;constructor(e,t){this.delegate=e,this.eventTarget=t}start(){this.started||(this.eventTarget.addEventListener("submit",this.submitCaptured,!0),this.started=!0)}stop(){this.started&&(this.eventTarget.removeEventListener("submit",this.submitCaptured,!0),this.started=!1)}submitCaptured=()=>{this.eventTarget.removeEventListener("submit",this.submitBubbled,!1),this.eventTarget.addEventListener("submit",this.submitBubbled,!1)};submitBubbled=e=>{if(!e.defaultPrevented){const t=e.target instanceof HTMLFormElement?e.target:void 0,i=e.submitter||void 0;t&&ID(t,i)&&RD(t,i)&&this.delegate.willSubmitForm(t,i)&&(e.preventDefault(),e.stopImmediatePropagation(),this.delegate.formSubmitted(t,i))}}}function ID(r,e){return(e?.getAttribute("formmethod")||r.getAttribute("method"))!="dialog"}function RD(r,e){const t=e?.getAttribute("formtarget")||r.getAttribute("target");return T1(t)}class D1{#e=e=>{};#t=e=>{};constructor(e,t){this.delegate=e,this.element=t}scrollToAnchor(e){const t=this.snapshot.getElementForAnchor(e);t?(this.focusElement(t),this.scrollToElement(t)):this.scrollToPosition({x:0,y:0})}scrollToAnchorFromLocation(e){this.scrollToAnchor(wn(e))}scrollToElement(e){e.scrollIntoView()}focusElement(e){e instanceof HTMLElement&&(e.hasAttribute("tabindex")?e.focus():(e.setAttribute("tabindex","-1"),e.focus(),e.removeAttribute("tabindex")))}scrollToPosition({x:e,y:t}){this.scrollRoot.scrollTo(e,t)}scrollToTop(){this.scrollToPosition({x:0,y:0})}get scrollRoot(){return window}async render(e){const{isPreview:t,shouldRender:i,willRender:s,newSnapshot:n}=e,a=s;if(i)try{this.renderPromise=new Promise(c=>this.#e=c),this.renderer=e,await this.prepareToRenderSnapshot(e);const o=new Promise(c=>this.#t=c),l={resume:this.#t,render:this.renderer.renderElement,renderMethod:this.renderer.renderMethod};this.delegate.allowsImmediateRender(n,l)||await o,await this.renderSnapshot(e),this.delegate.viewRenderedSnapshot(n,t,this.renderer.renderMethod),this.delegate.preloadOnLoadLinksForView(this.element),this.finishRenderingSnapshot(e)}finally{delete this.renderer,this.#e(void 0),delete this.renderPromise}else a&&this.invalidate(e.reloadReason)}invalidate(e){this.delegate.viewInvalidated(e)}async prepareToRenderSnapshot(e){this.markAsPreview(e.isPreview),await e.prepareToRender()}markAsPreview(e){e?this.element.setAttribute("data-turbo-preview",""):this.element.removeAttribute("data-turbo-preview")}markVisitDirection(e){this.element.setAttribute("data-turbo-visit-direction",e)}unmarkVisitDirection(){this.element.removeAttribute("data-turbo-visit-direction")}async renderSnapshot(e){await e.render()}finishRenderingSnapshot(e){e.finishRendering()}}class LD extends D1{missing(){this.element.innerHTML='<strong class="turbo-frame-error">Content missing</strong>'}get snapshot(){return new Lh(this.element)}}class M1{constructor(e,t){this.delegate=e,this.element=t}start(){this.element.addEventListener("click",this.clickBubbled),document.addEventListener("turbo:click",this.linkClicked),document.addEventListener("turbo:before-visit",this.willVisit)}stop(){this.element.removeEventListener("click",this.clickBubbled),document.removeEventListener("turbo:click",this.linkClicked),document.removeEventListener("turbo:before-visit",this.willVisit)}clickBubbled=e=>{this.clickEventIsSignificant(e)?this.clickEvent=e:delete this.clickEvent};linkClicked=e=>{this.clickEvent&&this.clickEventIsSignificant(e)&&this.delegate.shouldInterceptLinkClick(e.target,e.detail.url,e.detail.originalEvent)&&(this.clickEvent.preventDefault(),e.preventDefault(),this.delegate.linkClickIntercepted(e.target,e.detail.url,e.detail.originalEvent)),delete this.clickEvent};willVisit=e=>{delete this.clickEvent};clickEventIsSignificant(e){const t=e.composed?e.target?.parentElement:e.target,i=_1(t)||t;return i instanceof Element&&i.closest("turbo-frame, html")==this.element}}class I1{started=!1;constructor(e,t){this.delegate=e,this.eventTarget=t}start(){this.started||(this.eventTarget.addEventListener("click",this.clickCaptured,!0),this.started=!0)}stop(){this.started&&(this.eventTarget.removeEventListener("click",this.clickCaptured,!0),this.started=!1)}clickCaptured=()=>{this.eventTarget.removeEventListener("click",this.clickBubbled,!1),this.eventTarget.addEventListener("click",this.clickBubbled,!1)};clickBubbled=e=>{if(e instanceof MouseEvent&&this.clickEventIsSignificant(e)){const t=e.composedPath&&e.composedPath()[0]||e.target,i=_1(t);if(i&&T1(i.target)){const s=x1(i);this.delegate.willFollowLinkToLocation(i,s,e)&&(e.preventDefault(),this.delegate.followedLinkToLocation(i,s))}}};clickEventIsSignificant(e){return!(e.target&&e.target.isContentEditable||e.defaultPrevented||e.which>1||e.altKey||e.ctrlKey||e.metaKey||e.shiftKey)}}class R1{constructor(e,t){this.delegate=e,this.linkInterceptor=new I1(this,t)}start(){this.linkInterceptor.start()}stop(){this.linkInterceptor.stop()}canPrefetchRequestToLocation(e,t){return!1}prefetchAndCacheRequestToLocation(e,t){}willFollowLinkToLocation(e,t,i){return this.delegate.willSubmitFormLinkToLocation(e,t,i)&&(e.hasAttribute("data-turbo-method")||e.hasAttribute("data-turbo-stream"))}followedLinkToLocation(e,t){const i=document.createElement("form"),s="hidden";for(const[h,f]of t.searchParams)i.append(Object.assign(document.createElement("input"),{type:s,name:h,value:f}));const n=Object.assign(t,{search:""});i.setAttribute("data-turbo","true"),i.setAttribute("action",n.href),i.setAttribute("hidden","");const a=e.getAttribute("data-turbo-method");a&&i.setAttribute("method",a);const o=e.getAttribute("data-turbo-frame");o&&i.setAttribute("data-turbo-frame",o);const l=xn(e);l&&i.setAttribute("data-turbo-action",l);const u=e.getAttribute("data-turbo-confirm");u&&i.setAttribute("data-turbo-confirm",u),e.hasAttribute("data-turbo-stream")&&i.setAttribute("data-turbo-stream",""),this.delegate.submittedFormLinkToLocation(e,t,i),document.body.appendChild(i),i.addEventListener("turbo:submit-end",()=>i.remove(),{once:!0}),requestAnimationFrame(()=>i.requestSubmit())}}class L1{static async preservingPermanentElements(e,t,i){const s=new this(e,t);s.enter(),await i(),s.leave()}constructor(e,t){this.delegate=e,this.permanentElementMap=t}enter(){for(const e in this.permanentElementMap){const[t,i]=this.permanentElementMap[e];this.delegate.enteringBardo(t,i),this.replaceNewPermanentElementWithPlaceholder(i)}}leave(){for(const e in this.permanentElementMap){const[t]=this.permanentElementMap[e];this.replaceCurrentPermanentElementWithClone(t),this.replacePlaceholderWithPermanentElement(t),this.delegate.leavingBardo(t)}}replaceNewPermanentElementWithPlaceholder(e){const t=QD(e);e.replaceWith(t)}replaceCurrentPermanentElementWithClone(e){const t=e.cloneNode(!0);e.replaceWith(t)}replacePlaceholderWithPermanentElement(e){this.getPlaceholderById(e.id)?.replaceWith(e)}getPlaceholderById(e){return this.placeholders.find(t=>t.content==e)}get placeholders(){return[...document.querySelectorAll("meta[name=turbo-permanent-placeholder][content]")]}}function QD(r){const e=document.createElement("meta");return e.setAttribute("name","turbo-permanent-placeholder"),e.setAttribute("content",r.id),e}class tg{#e=null;static renderElement(e,t){}constructor(e,t,i,s=!0){this.currentSnapshot=e,this.newSnapshot=t,this.isPreview=i,this.willRender=s,this.renderElement=this.constructor.renderElement,this.promise=new Promise((n,a)=>this.resolvingFunctions={resolve:n,reject:a})}get shouldRender(){return!0}get shouldAutofocus(){return!0}get reloadReason(){}prepareToRender(){}render(){}finishRendering(){this.resolvingFunctions&&(this.resolvingFunctions.resolve(),delete this.resolvingFunctions)}async preservingPermanentElements(e){await L1.preservingPermanentElements(this,this.permanentElementMap,e)}focusFirstAutofocusableElement(){if(this.shouldAutofocus){const e=this.connectedSnapshot.firstAutofocusableElement;e&&e.focus()}}enteringBardo(e){this.#e||e.contains(this.currentSnapshot.activeElement)&&(this.#e=this.currentSnapshot.activeElement)}leavingBardo(e){e.contains(this.#e)&&this.#e instanceof HTMLElement&&(this.#e.focus(),this.#e=null)}get connectedSnapshot(){return this.newSnapshot.isConnected?this.newSnapshot:this.currentSnapshot}get currentElement(){return this.currentSnapshot.element}get newElement(){return this.newSnapshot.element}get permanentElementMap(){return this.currentSnapshot.getPermanentElementMapForSnapshot(this.newSnapshot)}get renderMethod(){return"replace"}}class ig extends tg{static renderElement(e,t){const i=document.createRange();i.selectNodeContents(e),i.deleteContents();const s=t,n=s.ownerDocument?.createRange();n&&(n.selectNodeContents(s),e.appendChild(n.extractContents()))}constructor(e,t,i,s,n,a=!0){super(t,i,s,n,a),this.delegate=e}get shouldRender(){return!0}async render(){await Zo(),this.preservingPermanentElements(()=>{this.loadFrameElement()}),this.scrollFrameIntoView(),await Zo(),this.focusFirstAutofocusableElement(),await Zo(),this.activateScriptElements()}loadFrameElement(){this.delegate.willRenderFrame(this.currentElement,this.newElement),this.renderElement(this.currentElement,this.newElement)}scrollFrameIntoView(){if(this.currentElement.autoscroll||this.newElement.autoscroll){const e=this.currentElement.firstElementChild,t=$D(this.currentElement.getAttribute("data-autoscroll-block"),"end"),i=BD(this.currentElement.getAttribute("data-autoscroll-behavior"),"auto");if(e)return e.scrollIntoView({block:t,behavior:i}),!0}return!1}activateScriptElements(){for(const e of this.newScriptElements){const t=hl(e);e.replaceWith(t)}}get newScriptElements(){return this.currentElement.querySelectorAll("script")}}function $D(r,e){return r=="end"||r=="start"||r=="center"||r=="nearest"?r:e}function BD(r,e){return r=="auto"||r=="smooth"?r:e}var ND=(function(){const r=()=>{},e={morphStyle:"outerHTML",callbacks:{beforeNodeAdded:r,afterNodeAdded:r,beforeNodeMorphed:r,afterNodeMorphed:r,beforeNodeRemoved:r,afterNodeRemoved:r,beforeAttributeUpdated:r},head:{style:"merge",shouldPreserve:f=>f.getAttribute("im-preserve")==="true",shouldReAppend:f=>f.getAttribute("im-re-append")==="true",shouldRemove:r,afterHeadMorphed:r},restoreFocus:!0};function t(f,m,S={}){f=c(f);const y=h(m),E=u(f,y,S),C=s(E,()=>o(E,f,y,_=>_.morphStyle==="innerHTML"?(n(_,f,y),Array.from(f.childNodes)):i(_,f,y)));return E.pantry.remove(),C}function i(f,m,S){const y=h(m);let E=Array.from(y.childNodes);const C=E.indexOf(m),_=E.length-(C+1);return n(f,y,S,m,m.nextSibling),E=Array.from(y.childNodes),E.slice(C,E.length-_)}function s(f,m){if(!f.config.restoreFocus)return m();let S=document.activeElement;if(!(S instanceof HTMLInputElement||S instanceof HTMLTextAreaElement))return m();const{id:y,selectionStart:E,selectionEnd:C}=S,_=m();return y&&y!==document.activeElement?.id&&(S=f.target.querySelector(`#${y}`),S?.focus()),S&&!S.selectionEnd&&C&&S.setSelectionRange(E,C),_}const n=(function(){function f(T,w,A,I=null,N=null){w instanceof HTMLTemplateElement&&A instanceof HTMLTemplateElement&&(w=w.content,A=A.content),I||=w.firstChild;for(const P of A.childNodes){if(I&&I!=N){const X=S(T,P,I,N);if(X){X!==I&&E(T,I,X),a(X,P,T),I=X.nextSibling;continue}}if(P instanceof Element&&T.persistentIds.has(P.id)){const X=C(w,P.id,I,T);a(X,P,T),I=X.nextSibling;continue}const R=m(w,P,I,T);R&&(I=R.nextSibling)}for(;I&&I!=N;){const P=I;I=I.nextSibling,y(T,P)}}function m(T,w,A,I){if(I.callbacks.beforeNodeAdded(w)===!1)return null;if(I.idMap.has(w)){const N=document.createElement(w.tagName);return T.insertBefore(N,A),a(N,w,I),I.callbacks.afterNodeAdded(N),N}else{const N=document.importNode(w,!0);return T.insertBefore(N,A),I.callbacks.afterNodeAdded(N),N}}const S=(function(){function T(I,N,P,R){let X=null,j=N.nextSibling,Z=0,Y=P;for(;Y&&Y!=R;){if(A(Y,N)){if(w(I,Y,N))return Y;X===null&&(I.idMap.has(Y)||(X=Y))}if(X===null&&j&&A(Y,j)&&(Z++,j=j.nextSibling,Z>=2&&(X=void 0)),Y.contains(document.activeElement))break;Y=Y.nextSibling}return X||null}function w(I,N,P){let R=I.idMap.get(N),X=I.idMap.get(P);if(!X||!R)return!1;for(const j of R)if(X.has(j))return!0;return!1}function A(I,N){const P=I,R=N;return P.nodeType===R.nodeType&&P.tagName===R.tagName&&(!P.id||P.id===R.id)}return T})();function y(T,w){if(T.idMap.has(w))v(T.pantry,w,null);else{if(T.callbacks.beforeNodeRemoved(w)===!1)return;w.parentNode?.removeChild(w),T.callbacks.afterNodeRemoved(w)}}function E(T,w,A){let I=w;for(;I&&I!==A;){let N=I;I=I.nextSibling,y(T,N)}return I}function C(T,w,A,I){const N=I.target.querySelector(`#${w}`)||I.pantry.querySelector(`#${w}`);return _(N,I),v(T,N,A),N}function _(T,w){const A=T.id;for(;T=T.parentNode;){let I=w.idMap.get(T);I&&(I.delete(A),I.size||w.idMap.delete(T))}}function v(T,w,A){if(T.moveBefore)try{T.moveBefore(w,A)}catch{T.insertBefore(w,A)}else T.insertBefore(w,A)}return f})(),a=(function(){function f(_,v,T){return T.ignoreActive&&_===document.activeElement?null:(T.callbacks.beforeNodeMorphed(_,v)===!1||(_ instanceof HTMLHeadElement&&T.head.ignore||(_ instanceof HTMLHeadElement&&T.head.style!=="morph"?l(_,v,T):(m(_,v,T),C(_,T)||n(T,_,v))),T.callbacks.afterNodeMorphed(_,v)),_)}function m(_,v,T){let w=v.nodeType;if(w===1){const A=_,I=v,N=A.attributes,P=I.attributes;for(const R of P)E(R.name,A,"update",T)||A.getAttribute(R.name)!==R.value&&A.setAttribute(R.name,R.value);for(let R=N.length-1;0<=R;R--){const X=N[R];if(X&&!I.hasAttribute(X.name)){if(E(X.name,A,"remove",T))continue;A.removeAttribute(X.name)}}C(A,T)||S(A,I,T)}(w===8||w===3)&&_.nodeValue!==v.nodeValue&&(_.nodeValue=v.nodeValue)}function S(_,v,T){if(_ instanceof HTMLInputElement&&v instanceof HTMLInputElement&&v.type!=="file"){let w=v.value,A=_.value;y(_,v,"checked",T),y(_,v,"disabled",T),v.hasAttribute("value")?A!==w&&(E("value",_,"update",T)||(_.setAttribute("value",w),_.value=w)):E("value",_,"remove",T)||(_.value="",_.removeAttribute("value"))}else if(_ instanceof HTMLOptionElement&&v instanceof HTMLOptionElement)y(_,v,"selected",T);else if(_ instanceof HTMLTextAreaElement&&v instanceof HTMLTextAreaElement){let w=v.value,A=_.value;if(E("value",_,"update",T))return;w!==A&&(_.value=w),_.firstChild&&_.firstChild.nodeValue!==w&&(_.firstChild.nodeValue=w)}}function y(_,v,T,w){const A=v[T],I=_[T];if(A!==I){const N=E(T,_,"update",w);N||(_[T]=v[T]),A?N||_.setAttribute(T,""):E(T,_,"remove",w)||_.removeAttribute(T)}}function E(_,v,T,w){return _==="value"&&w.ignoreActiveValue&&v===document.activeElement?!0:w.callbacks.beforeAttributeUpdated(_,v,T)===!1}function C(_,v){return!!v.ignoreActiveValue&&_===document.activeElement&&_!==document.body}return f})();function o(f,m,S,y){if(f.head.block){const E=m.querySelector("head"),C=S.querySelector("head");if(E&&C){const _=l(E,C,f);return Promise.all(_).then(()=>{const v=Object.assign(f,{head:{block:!1,ignore:!0}});return y(v)})}}return y(f)}function l(f,m,S){let y=[],E=[],C=[],_=[],v=new Map;for(const w of m.children)v.set(w.outerHTML,w);for(const w of f.children){let A=v.has(w.outerHTML),I=S.head.shouldReAppend(w),N=S.head.shouldPreserve(w);A||N?I?E.push(w):(v.delete(w.outerHTML),C.push(w)):S.head.style==="append"?I&&(E.push(w),_.push(w)):S.head.shouldRemove(w)!==!1&&E.push(w)}_.push(...v.values());let T=[];for(const w of _){let A=document.createRange().createContextualFragment(w.outerHTML).firstChild;if(S.callbacks.beforeNodeAdded(A)!==!1){if("href"in A&&A.href||"src"in A&&A.src){let I,N=new Promise(function(P){I=P});A.addEventListener("load",function(){I()}),T.push(N)}f.appendChild(A),S.callbacks.afterNodeAdded(A),y.push(A)}}for(const w of E)S.callbacks.beforeNodeRemoved(w)!==!1&&(f.removeChild(w),S.callbacks.afterNodeRemoved(w));return S.head.afterHeadMorphed(f,{added:y,kept:C,removed:E}),T}const u=(function(){function f(v,T,w){const{persistentIds:A,idMap:I}=C(v,T),N=m(w),P=N.morphStyle||"outerHTML";if(!["innerHTML","outerHTML"].includes(P))throw`Do not understand how to morph style ${P}`;return{target:v,newContent:T,config:N,morphStyle:P,ignoreActive:N.ignoreActive,ignoreActiveValue:N.ignoreActiveValue,restoreFocus:N.restoreFocus,idMap:I,persistentIds:A,pantry:S(),callbacks:N.callbacks,head:N.head}}function m(v){let T=Object.assign({},e);return Object.assign(T,v),T.callbacks=Object.assign({},e.callbacks,v.callbacks),T.head=Object.assign({},e.head,v.head),T}function S(){const v=document.createElement("div");return v.hidden=!0,document.body.insertAdjacentElement("afterend",v),v}function y(v){let T=Array.from(v.querySelectorAll("[id]"));return v.id&&T.push(v),T}function E(v,T,w,A){for(const I of A)if(T.has(I.id)){let N=I;for(;N;){let P=v.get(N);if(P==null&&(P=new Set,v.set(N,P)),P.add(I.id),N===w)break;N=N.parentElement}}}function C(v,T){const w=y(v),A=y(T),I=_(w,A);let N=new Map;E(N,I,v,w);const P=T.__idiomorphRoot||T;return E(N,I,P,A),{persistentIds:I,idMap:N}}function _(v,T){let w=new Set,A=new Map;for(const{id:N,tagName:P}of v)A.has(N)?w.add(N):A.set(N,P);let I=new Set;for(const{id:N,tagName:P}of T)I.has(N)?w.add(N):A.get(N)===P&&I.add(N);for(const N of w)I.delete(N);return I}return f})(),{normalizeElement:c,normalizeParent:h}=(function(){const f=new WeakSet;function m(C){return C instanceof Document?C.documentElement:C}function S(C){if(C==null)return document.createElement("div");if(typeof C=="string")return S(E(C));if(f.has(C))return C;if(C instanceof Node){if(C.parentNode)return y(C);{const _=document.createElement("div");return _.append(C),_}}else{const _=document.createElement("div");for(const v of[...C])_.append(v);return _}}function y(C){return{childNodes:[C],querySelectorAll:_=>{const v=C.querySelectorAll(_);return C.matches(_)?[C,...v]:v},insertBefore:(_,v)=>C.parentNode.insertBefore(_,v),moveBefore:(_,v)=>C.parentNode.moveBefore(_,v),get __idiomorphRoot(){return C}}}function E(C){let _=new DOMParser,v=C.replace(/<svg(\s[^>]*>|>)([\s\S]*?)<\/svg>/gim,"");if(v.match(/<\/html>/)||v.match(/<\/head>/)||v.match(/<\/body>/)){let T=_.parseFromString(C,"text/html");if(v.match(/<\/html>/))return f.add(T),T;{let w=T.firstChild;return w&&f.add(w),w}}else{let w=_.parseFromString("<body><template>"+C+"</template></body>","text/html").body.querySelector("template").content;return f.add(w),w}}return{normalizeElement:m,normalizeParent:S}})();return{morph:t,defaults:e}})();function Qh(r,e,{callbacks:t,...i}={}){ND.morph(r,e,{...i,callbacks:new FD(t)})}function rg(r,e,t={}){Qh(r,e.childNodes,{...t,morphStyle:"innerHTML"})}function Q1(r,e){return r instanceof gr&&e instanceof Element&&e.nodeName==="TURBO-FRAME"&&r.shouldReloadWithMorph&&r.id===e.id&&(!e.getAttribute("src")||w1(r.src,e.getAttribute("src")))&&!r.closest("[data-turbo-permanent]")}function $1(r){return r.parentElement.closest("turbo-frame[src][refresh=morph]")}class FD{#e;constructor({beforeNodeMorphed:e}={}){this.#e=e||(()=>!0)}beforeNodeAdded=e=>!(e.id&&e.hasAttribute("data-turbo-permanent")&&document.getElementById(e.id));beforeNodeMorphed=(e,t)=>{if(e instanceof Element)return!e.hasAttribute("data-turbo-permanent")&&this.#e(e,t)?!bt("turbo:before-morph-element",{cancelable:!0,target:e,detail:{currentElement:e,newElement:t}}).defaultPrevented:!1};beforeAttributeUpdated=(e,t,i)=>!bt("turbo:before-morph-attribute",{cancelable:!0,target:t,detail:{attributeName:e,mutationType:i}}).defaultPrevented;beforeNodeRemoved=e=>this.beforeNodeMorphed(e);afterNodeMorphed=(e,t)=>{e instanceof Element&&bt("turbo:morph-element",{target:e,detail:{currentElement:e,newElement:t}})}}class B1 extends ig{static renderElement(e,t){bt("turbo:before-frame-morph",{target:e,detail:{currentElement:e,newElement:t}}),rg(e,t,{callbacks:{beforeNodeMorphed:(i,s)=>Q1(i,s)&&$1(i)===e?(i.reload(),!1):!0}})}async preservingPermanentElements(e){return await e()}}class Rs{static animationDuration=300;static get defaultCSS(){return y1`
      .turbo-progress-bar {
        position: fixed;
        display: block;
        top: 0;
        left: 0;
        height: 3px;
        background: #0076ff;
        z-index: 2147483647;
        transition:
          width ${Rs.animationDuration}ms ease-out,
          opacity ${Rs.animationDuration/2}ms ${Rs.animationDuration/2}ms ease-in;
        transform: translate3d(0, 0, 0);
      }
    `}hiding=!1;value=0;visible=!1;constructor(){this.stylesheetElement=this.createStylesheetElement(),this.progressElement=this.createProgressElement(),this.installStylesheetElement(),this.setValue(0)}show(){this.visible||(this.visible=!0,this.installProgressElement(),this.startTrickling())}hide(){this.visible&&!this.hiding&&(this.hiding=!0,this.fadeProgressElement(()=>{this.uninstallProgressElement(),this.stopTrickling(),this.visible=!1,this.hiding=!1}))}setValue(e){this.value=e,this.refresh()}installStylesheetElement(){document.head.insertBefore(this.stylesheetElement,document.head.firstChild)}installProgressElement(){this.progressElement.style.width="0",this.progressElement.style.opacity="1",document.documentElement.insertBefore(this.progressElement,document.body),this.refresh()}fadeProgressElement(e){this.progressElement.style.opacity="0",setTimeout(e,Rs.animationDuration*1.5)}uninstallProgressElement(){this.progressElement.parentNode&&document.documentElement.removeChild(this.progressElement)}startTrickling(){this.trickleInterval||(this.trickleInterval=window.setInterval(this.trickle,Rs.animationDuration))}stopTrickling(){window.clearInterval(this.trickleInterval),delete this.trickleInterval}trickle=()=>{this.setValue(this.value+Math.random()/100)};refresh(){requestAnimationFrame(()=>{this.progressElement.style.width=`${10+this.value*90}%`})}createStylesheetElement(){const e=document.createElement("style");e.type="text/css",e.textContent=Rs.defaultCSS;const t=v1();return t&&(e.nonce=t),e}createProgressElement(){const e=document.createElement("div");return e.className="turbo-progress-bar",e}}class UD extends Lh{detailsByOuterHTML=this.children.filter(e=>!jD(e)).map(e=>WD(e)).reduce((e,t)=>{const{outerHTML:i}=t,s=i in e?e[i]:{type:qD(t),tracked:VD(t),elements:[]};return{...e,[i]:{...s,elements:[...s.elements,t]}}},{});get trackedElementSignature(){return Object.keys(this.detailsByOuterHTML).filter(e=>this.detailsByOuterHTML[e].tracked).join("")}getScriptElementsNotInSnapshot(e){return this.getElementsMatchingTypeNotInSnapshot("script",e)}getStylesheetElementsNotInSnapshot(e){return this.getElementsMatchingTypeNotInSnapshot("stylesheet",e)}getElementsMatchingTypeNotInSnapshot(e,t){return Object.keys(this.detailsByOuterHTML).filter(i=>!(i in t.detailsByOuterHTML)).map(i=>this.detailsByOuterHTML[i]).filter(({type:i})=>i==e).map(({elements:[i]})=>i)}get provisionalElements(){return Object.keys(this.detailsByOuterHTML).reduce((e,t)=>{const{type:i,tracked:s,elements:n}=this.detailsByOuterHTML[t];return i==null&&!s?[...e,...n]:n.length>1?[...e,...n.slice(1)]:e},[])}getMetaValue(e){const t=this.findMetaElementByName(e);return t?t.getAttribute("content"):null}findMetaElementByName(e){return Object.keys(this.detailsByOuterHTML).reduce((t,i)=>{const{elements:[s]}=this.detailsByOuterHTML[i];return ZD(s,e)?s:t},void 0|void 0)}}function qD(r){if(XD(r))return"script";if(zD(r))return"stylesheet"}function VD(r){return r.getAttribute("data-turbo-track")=="reload"}function XD(r){return r.localName=="script"}function jD(r){return r.localName=="noscript"}function zD(r){const e=r.localName;return e=="style"||e=="link"&&r.getAttribute("rel")=="stylesheet"}function ZD(r,e){return r.localName=="meta"&&r.getAttribute("name")==e}function WD(r){return r.hasAttribute("nonce")&&r.setAttribute("nonce",""),r}class pr extends Lh{static fromHTMLString(e=""){return this.fromDocument(O1(e))}static fromElement(e){return this.fromDocument(e.ownerDocument)}static fromDocument({documentElement:e,body:t,head:i}){return new this(e,t,new UD(i))}constructor(e,t,i){super(t),this.documentElement=e,this.headSnapshot=i}clone(){const e=this.element.cloneNode(!0),t=this.element.querySelectorAll("select"),i=e.querySelectorAll("select");for(const[s,n]of t.entries()){const a=i[s];for(const o of a.selectedOptions)o.selected=!1;for(const o of n.selectedOptions)a.options[o.index].selected=!0}for(const s of e.querySelectorAll('input[type="password"]'))s.value="";return new pr(this.documentElement,e,this.headSnapshot)}get lang(){return this.documentElement.getAttribute("lang")}get headElement(){return this.headSnapshot.element}get rootLocation(){const e=this.getSetting("root")??"/";return Gt(e)}get cacheControlValue(){return this.getSetting("cache-control")}get isPreviewable(){return this.cacheControlValue!="no-preview"}get isCacheable(){return this.cacheControlValue!="no-cache"}get isVisitable(){return this.getSetting("visit-control")!="reload"}get prefersViewTransitions(){return(this.getSetting("view-transition")==="true"||this.headSnapshot.getMetaValue("view-transition")==="same-origin")&&!window.matchMedia("(prefers-reduced-motion: reduce)").matches}get shouldMorphPage(){return this.getSetting("refresh-method")==="morph"}get shouldPreserveScrollPosition(){return this.getSetting("refresh-scroll")==="preserve"}getSetting(e){return this.headSnapshot.getMetaValue(`turbo-${e}`)}}class HD{#e=!1;#t=Promise.resolve();renderChange(e,t){return e&&this.viewTransitionsAvailable&&!this.#e?(this.#e=!0,this.#t=this.#t.then(async()=>{await document.startViewTransition(t).finished})):this.#t=this.#t.then(t),this.#t}get viewTransitionsAvailable(){return document.startViewTransition}}const YD={action:"advance",historyChanged:!1,visitCachedSnapshot:()=>{},willRender:!0,updateHistory:!0,shouldCacheSnapshot:!0,acceptsStreamResponse:!1},Ru={visitStart:"visitStart",requestStart:"requestStart",requestEnd:"requestEnd",visitEnd:"visitEnd"},os={initialized:"initialized",started:"started",canceled:"canceled",failed:"failed",completed:"completed"},ua={networkFailure:0,timeoutFailure:-1,contentTypeMismatch:-2},GD={advance:"forward",restore:"back",replace:"none"};class KD{identifier=js();timingMetrics={};followedRedirect=!1;historyChanged=!1;scrolled=!1;shouldCacheSnapshot=!0;acceptsStreamResponse=!1;snapshotCached=!1;state=os.initialized;viewTransitioner=new HD;constructor(e,t,i,s={}){this.delegate=e,this.location=t,this.restorationIdentifier=i||js();const{action:n,historyChanged:a,referrer:o,snapshot:l,snapshotHTML:u,response:c,visitCachedSnapshot:h,willRender:f,updateHistory:m,shouldCacheSnapshot:S,acceptsStreamResponse:y,direction:E}={...YD,...s};this.action=n,this.historyChanged=a,this.referrer=o,this.snapshot=l,this.snapshotHTML=u,this.response=c,this.isSamePage=this.delegate.locationWithActionIsSamePage(this.location,this.action),this.isPageRefresh=this.view.isPageRefresh(this),this.visitCachedSnapshot=h,this.willRender=f,this.updateHistory=m,this.scrolled=!f,this.shouldCacheSnapshot=S,this.acceptsStreamResponse=y,this.direction=E||GD[n]}get adapter(){return this.delegate.adapter}get view(){return this.delegate.view}get history(){return this.delegate.history}get restorationData(){return this.history.getRestorationDataForIdentifier(this.restorationIdentifier)}get silent(){return this.isSamePage}start(){this.state==os.initialized&&(this.recordTimingMetric(Ru.visitStart),this.state=os.started,this.adapter.visitStarted(this),this.delegate.visitStarted(this))}cancel(){this.state==os.started&&(this.request&&this.request.cancel(),this.cancelRender(),this.state=os.canceled)}complete(){this.state==os.started&&(this.recordTimingMetric(Ru.visitEnd),this.adapter.visitCompleted(this),this.state=os.completed,this.followRedirect(),this.followedRedirect||this.delegate.visitCompleted(this))}fail(){this.state==os.started&&(this.state=os.failed,this.adapter.visitFailed(this),this.delegate.visitCompleted(this))}changeHistory(){if(!this.historyChanged&&this.updateHistory){const e=this.location.href===this.referrer?.href?"replace":this.action,t=b1(e);this.history.update(t,this.location,this.restorationIdentifier),this.historyChanged=!0}}issueRequest(){this.hasPreloadedResponse()?this.simulateRequest():this.shouldIssueRequest()&&!this.request&&(this.request=new Xl(this,Yi.get,this.location),this.request.perform())}simulateRequest(){this.response&&(this.startRequest(),this.recordResponse(),this.finishRequest())}startRequest(){this.recordTimingMetric(Ru.requestStart),this.adapter.visitRequestStarted(this)}recordResponse(e=this.response){if(this.response=e,e){const{statusCode:t}=e;VO(t)?this.adapter.visitRequestCompleted(this):this.adapter.visitRequestFailedWithStatusCode(this,t)}}finishRequest(){this.recordTimingMetric(Ru.requestEnd),this.adapter.visitRequestFinished(this)}loadResponse(){if(this.response){const{statusCode:e,responseHTML:t}=this.response;this.render(async()=>{if(this.shouldCacheSnapshot&&this.cacheSnapshot(),this.view.renderPromise&&await this.view.renderPromise,VO(e)&&t!=null){const i=pr.fromHTMLString(t);await this.renderPageSnapshot(i,!1),this.adapter.visitRendered(this),this.complete()}else await this.view.renderError(pr.fromHTMLString(t),this),this.adapter.visitRendered(this),this.fail()})}}getCachedSnapshot(){const e=this.view.getCachedSnapshotForLocation(this.location)||this.getPreloadedSnapshot();if(e&&(!wn(this.location)||e.hasAnchor(wn(this.location)))&&(this.action=="restore"||e.isPreviewable))return e}getPreloadedSnapshot(){if(this.snapshotHTML)return pr.fromHTMLString(this.snapshotHTML)}hasCachedSnapshot(){return this.getCachedSnapshot()!=null}loadCachedSnapshot(){const e=this.getCachedSnapshot();if(e){const t=this.shouldIssueRequest();this.render(async()=>{this.cacheSnapshot(),this.isSamePage||this.isPageRefresh?this.adapter.visitRendered(this):(this.view.renderPromise&&await this.view.renderPromise,await this.renderPageSnapshot(e,t),this.adapter.visitRendered(this),t||this.complete())})}}followRedirect(){this.redirectedToLocation&&!this.followedRedirect&&this.response?.redirected&&(this.adapter.visitProposedToLocation(this.redirectedToLocation,{action:"replace",response:this.response,shouldCacheSnapshot:!1,willRender:!1}),this.followedRedirect=!0)}goToSamePageAnchor(){this.isSamePage&&this.render(async()=>{this.cacheSnapshot(),this.performScroll(),this.changeHistory(),this.adapter.visitRendered(this)})}prepareRequest(e){this.acceptsStreamResponse&&e.acceptResponseType(Wa.contentType)}requestStarted(){this.startRequest()}requestPreventedHandlingResponse(e,t){}async requestSucceededWithResponse(e,t){const i=await t.responseHTML,{redirected:s,statusCode:n}=t;i==null?this.recordResponse({statusCode:ua.contentTypeMismatch,redirected:s}):(this.redirectedToLocation=t.redirected?t.location:void 0,this.recordResponse({statusCode:n,responseHTML:i,redirected:s}))}async requestFailedWithResponse(e,t){const i=await t.responseHTML,{redirected:s,statusCode:n}=t;i==null?this.recordResponse({statusCode:ua.contentTypeMismatch,redirected:s}):this.recordResponse({statusCode:n,responseHTML:i,redirected:s})}requestErrored(e,t){this.recordResponse({statusCode:ua.networkFailure,redirected:!1})}requestFinished(){this.finishRequest()}performScroll(){!this.scrolled&&!this.view.forceReloaded&&!this.view.shouldPreserveScrollPosition(this)&&(this.action=="restore"?this.scrollToRestoredPosition()||this.scrollToAnchor()||this.view.scrollToTop():this.scrollToAnchor()||this.view.scrollToTop(),this.isSamePage&&this.delegate.visitScrolledToSamePageLocation(this.view.lastRenderedLocation,this.location),this.scrolled=!0)}scrollToRestoredPosition(){const{scrollPosition:e}=this.restorationData;if(e)return this.view.scrollToPosition(e),!0}scrollToAnchor(){const e=wn(this.location);if(e!=null)return this.view.scrollToAnchor(e),!0}recordTimingMetric(e){this.timingMetrics[e]=new Date().getTime()}getTimingMetrics(){return{...this.timingMetrics}}hasPreloadedResponse(){return typeof this.response=="object"}shouldIssueRequest(){return this.isSamePage?!1:this.action=="restore"?!this.hasCachedSnapshot():this.willRender}cacheSnapshot(){this.snapshotCached||(this.view.cacheSnapshot(this.snapshot).then(e=>e&&this.visitCachedSnapshot(e)),this.snapshotCached=!0)}async render(e){this.cancelRender(),await new Promise(t=>{this.frame=document.visibilityState==="hidden"?setTimeout(()=>t(),0):requestAnimationFrame(()=>t())}),await e(),delete this.frame}async renderPageSnapshot(e,t){await this.viewTransitioner.renderChange(this.view.shouldTransitionTo(e),async()=>{await this.view.renderPage(e,t,this.willRender,this),this.performScroll()})}cancelRender(){this.frame&&(cancelAnimationFrame(this.frame),delete this.frame)}}function VO(r){return r>=200&&r<300}class JD{progressBar=new Rs;constructor(e){this.session=e}visitProposedToLocation(e,t){Ns(e,this.navigator.rootLocation)?this.navigator.startVisit(e,t?.restorationIdentifier||js(),t):window.location.href=e.toString()}visitStarted(e){this.location=e.location,this.redirectedToLocation=null,e.loadCachedSnapshot(),e.issueRequest(),e.goToSamePageAnchor()}visitRequestStarted(e){this.progressBar.setValue(0),e.hasCachedSnapshot()||e.action!="restore"?this.showVisitProgressBarAfterDelay():this.showProgressBar()}visitRequestCompleted(e){e.loadResponse(),e.response.redirected&&(this.redirectedToLocation=e.redirectedToLocation)}visitRequestFailedWithStatusCode(e,t){switch(t){case ua.networkFailure:case ua.timeoutFailure:case ua.contentTypeMismatch:return this.reload({reason:"request_failed",context:{statusCode:t}});default:return e.loadResponse()}}visitRequestFinished(e){}visitCompleted(e){this.progressBar.setValue(1),this.hideVisitProgressBar()}pageInvalidated(e){this.reload(e)}visitFailed(e){this.progressBar.setValue(1),this.hideVisitProgressBar()}visitRendered(e){}linkPrefetchingIsEnabledForLocation(e){return!0}formSubmissionStarted(e){this.progressBar.setValue(0),this.showFormProgressBarAfterDelay()}formSubmissionFinished(e){this.progressBar.setValue(1),this.hideFormProgressBar()}showVisitProgressBarAfterDelay(){this.visitProgressBarTimeout=window.setTimeout(this.showProgressBar,this.session.progressBarDelay)}hideVisitProgressBar(){this.progressBar.hide(),this.visitProgressBarTimeout!=null&&(window.clearTimeout(this.visitProgressBarTimeout),delete this.visitProgressBarTimeout)}showFormProgressBarAfterDelay(){this.formProgressBarTimeout==null&&(this.formProgressBarTimeout=window.setTimeout(this.showProgressBar,this.session.progressBarDelay))}hideFormProgressBar(){this.progressBar.hide(),this.formProgressBarTimeout!=null&&(window.clearTimeout(this.formProgressBarTimeout),delete this.formProgressBarTimeout)}showProgressBar=()=>{this.progressBar.show()};reload(e){bt("turbo:reload",{detail:e}),window.location.href=(this.redirectedToLocation||this.location)?.toString()||window.location.href}get navigator(){return this.session.navigator}}class eM{selector="[data-turbo-temporary]";deprecatedSelector="[data-turbo-cache=false]";started=!1;start(){this.started||(this.started=!0,addEventListener("turbo:before-cache",this.removeTemporaryElements,!1))}stop(){this.started&&(this.started=!1,removeEventListener("turbo:before-cache",this.removeTemporaryElements,!1))}removeTemporaryElements=e=>{for(const t of this.temporaryElements)t.remove()};get temporaryElements(){return[...document.querySelectorAll(this.selector),...this.temporaryElementsWithDeprecation]}get temporaryElementsWithDeprecation(){const e=document.querySelectorAll(this.deprecatedSelector);return e.length&&console.warn(`The ${this.deprecatedSelector} selector is deprecated and will be removed in a future version. Use ${this.selector} instead.`),[...e]}}class tM{constructor(e,t){this.session=e,this.element=t,this.linkInterceptor=new M1(this,t),this.formSubmitObserver=new eg(this,t)}start(){this.linkInterceptor.start(),this.formSubmitObserver.start()}stop(){this.linkInterceptor.stop(),this.formSubmitObserver.stop()}shouldInterceptLinkClick(e,t,i){return this.#t(e)}linkClickIntercepted(e,t,i){const s=this.#i(e);s&&s.delegate.linkClickIntercepted(e,t,i)}willSubmitForm(e,t){return e.closest("turbo-frame")==null&&this.#e(e,t)&&this.#t(e,t)}formSubmitted(e,t){const i=this.#i(e,t);i&&i.delegate.formSubmitted(e,t)}#e(e,t){const i=Ym(e,t),s=this.element.ownerDocument.querySelector('meta[name="turbo-root"]'),n=Gt(s?.content??"/");return this.#t(e,t)&&Ns(i,n)}#t(e,t){if(e instanceof HTMLFormElement?this.session.submissionIsNavigatable(e,t):this.session.elementIsNavigatable(e)){const s=this.#i(e,t);return s?s!=e.closest("turbo-frame"):!1}else return!1}#i(e,t){const i=t?.getAttribute("data-turbo-frame")||e.getAttribute("data-turbo-frame");if(i&&i!="_top"){const s=this.element.querySelector(`#${i}:not([disabled])`);if(s instanceof gr)return s}}}class iM{location;restorationIdentifier=js();restorationData={};started=!1;pageLoaded=!1;currentIndex=0;constructor(e){this.delegate=e}start(){this.started||(addEventListener("popstate",this.onPopState,!1),addEventListener("load",this.onPageLoad,!1),this.currentIndex=history.state?.turbo?.restorationIndex||0,this.started=!0,this.replace(new URL(window.location.href)))}stop(){this.started&&(removeEventListener("popstate",this.onPopState,!1),removeEventListener("load",this.onPageLoad,!1),this.started=!1)}push(e,t){this.update(history.pushState,e,t)}replace(e,t){this.update(history.replaceState,e,t)}update(e,t,i=js()){e===history.pushState&&++this.currentIndex;const s={turbo:{restorationIdentifier:i,restorationIndex:this.currentIndex}};e.call(history,s,"",t.href),this.location=t,this.restorationIdentifier=i}getRestorationDataForIdentifier(e){return this.restorationData[e]||{}}updateRestorationData(e){const{restorationIdentifier:t}=this,i=this.restorationData[t];this.restorationData[t]={...i,...e}}assumeControlOfScrollRestoration(){this.previousScrollRestoration||(this.previousScrollRestoration=history.scrollRestoration??"auto",history.scrollRestoration="manual")}relinquishControlOfScrollRestoration(){this.previousScrollRestoration&&(history.scrollRestoration=this.previousScrollRestoration,delete this.previousScrollRestoration)}onPopState=e=>{if(this.shouldHandlePopState()){const{turbo:t}=e.state||{};if(t){this.location=new URL(window.location.href);const{restorationIdentifier:i,restorationIndex:s}=t;this.restorationIdentifier=i;const n=s>this.currentIndex?"forward":"back";this.delegate.historyPoppedToLocationWithRestorationIdentifierAndDirection(this.location,i,n),this.currentIndex=s}}};onPageLoad=async e=>{await rD(),this.pageLoaded=!0};shouldHandlePopState(){return this.pageIsLoaded()}pageIsLoaded(){return this.pageLoaded||document.readyState=="complete"}}class rM{started=!1;#e=null;constructor(e,t){this.delegate=e,this.eventTarget=t}start(){this.started||(this.eventTarget.readyState==="loading"?this.eventTarget.addEventListener("DOMContentLoaded",this.#t,{once:!0}):this.#t())}stop(){this.started&&(this.eventTarget.removeEventListener("mouseenter",this.#i,{capture:!0,passive:!0}),this.eventTarget.removeEventListener("mouseleave",this.#n,{capture:!0,passive:!0}),this.eventTarget.removeEventListener("turbo:before-fetch-request",this.#s,!0),this.started=!1)}#t=()=>{this.eventTarget.addEventListener("mouseenter",this.#i,{capture:!0,passive:!0}),this.eventTarget.addEventListener("mouseleave",this.#n,{capture:!0,passive:!0}),this.eventTarget.addEventListener("turbo:before-fetch-request",this.#s,!0),this.started=!0};#i=e=>{if(Lc("turbo-prefetch")==="false")return;const t=e.target;if(t.matches&&t.matches("a[href]:not([target^=_]):not([download])")&&this.#l(t)){const s=t,n=x1(s);if(this.delegate.canPrefetchRequestToLocation(s,n)){this.#e=s;const a=new Xl(this,Yi.get,n,new URLSearchParams,t);a.fetchOptions.priority="low",ta.setLater(n.toString(),a,this.#r)}}};#n=e=>{e.target===this.#e&&this.#a()};#a=()=>{ta.clear(),this.#e=null};#s=e=>{if(e.target.tagName!=="FORM"&&e.detail.fetchOptions.method==="GET"){const t=ta.get(e.detail.url.toString());t&&(e.detail.fetchRequest=t),ta.clear()}};prepareRequest(e){const t=e.target;e.headers["X-Sec-Purpose"]="prefetch";const i=t.closest("turbo-frame"),s=t.getAttribute("data-turbo-frame")||i?.getAttribute("target")||i?.id;s&&s!=="_top"&&(e.headers["Turbo-Frame"]=s)}requestSucceededWithResponse(){}requestStarted(e){}requestErrored(e){}requestFinished(e){}requestPreventedHandlingResponse(e,t){}requestFailedWithResponse(e,t){}get#r(){return Number(Lc("turbo-prefetch-cache-time"))||wD}#l(e){return!(!e.getAttribute("href")||sM(e)||nM(e)||aM(e)||oM(e)||uM(e))}}const sM=r=>r.origin!==document.location.origin||!["http:","https:"].includes(r.protocol)||r.hasAttribute("target"),nM=r=>r.pathname+r.search===document.location.pathname+document.location.search||r.href.startsWith("#"),aM=r=>{if(r.getAttribute("data-turbo-prefetch")==="false"||r.getAttribute("data-turbo")==="false")return!0;const e=la(r,"[data-turbo-prefetch]");return!!(e&&e.getAttribute("data-turbo-prefetch")==="false")},oM=r=>{const e=r.getAttribute("data-turbo-method");return!!(e&&e.toLowerCase()!=="get"||lM(r)||r.hasAttribute("data-turbo-confirm")||r.hasAttribute("data-turbo-stream"))},lM=r=>r.hasAttribute("data-remote")||r.hasAttribute("data-behavior")||r.hasAttribute("data-confirm")||r.hasAttribute("data-method"),uM=r=>bt("turbo:before-prefetch",{target:r,cancelable:!0}).defaultPrevented;class cM{constructor(e){this.delegate=e}proposeVisit(e,t={}){this.delegate.allowsVisitingLocationWithAction(e,t.action)&&this.delegate.visitProposedToLocation(e,t)}startVisit(e,t,i={}){this.stop(),this.currentVisit=new KD(this,Gt(e),t,{referrer:this.location,...i}),this.currentVisit.start()}submitForm(e,t){this.stop(),this.formSubmission=new Rh(this,e,t,!0),this.formSubmission.start()}stop(){this.formSubmission&&(this.formSubmission.stop(),delete this.formSubmission),this.currentVisit&&(this.currentVisit.cancel(),delete this.currentVisit)}get adapter(){return this.delegate.adapter}get view(){return this.delegate.view}get rootLocation(){return this.view.snapshot.rootLocation}get history(){return this.delegate.history}formSubmissionStarted(e){typeof this.adapter.formSubmissionStarted=="function"&&this.adapter.formSubmissionStarted(e)}async formSubmissionSucceededWithResponse(e,t){if(e==this.formSubmission){const i=await t.responseHTML;if(i){const s=e.isSafe;s||this.view.clearSnapshotCache();const{statusCode:n,redirected:a}=t,l={action:this.#e(e,t),shouldCacheSnapshot:s,response:{statusCode:n,responseHTML:i,redirected:a}};this.proposeVisit(t.location,l)}}}async formSubmissionFailedWithResponse(e,t){const i=await t.responseHTML;if(i){const s=pr.fromHTMLString(i);t.serverError?await this.view.renderError(s,this.currentVisit):await this.view.renderPage(s,!1,!0,this.currentVisit),s.shouldPreserveScrollPosition||this.view.scrollToTop(),this.view.clearSnapshotCache()}}formSubmissionErrored(e,t){console.error(t)}formSubmissionFinished(e){typeof this.adapter.formSubmissionFinished=="function"&&this.adapter.formSubmissionFinished(e)}linkPrefetchingIsEnabledForLocation(e){return typeof this.adapter.linkPrefetchingIsEnabledForLocation=="function"?this.adapter.linkPrefetchingIsEnabledForLocation(e):!0}visitStarted(e){this.delegate.visitStarted(e)}visitCompleted(e){this.delegate.visitCompleted(e),delete this.currentVisit}locationWithActionIsSamePage(e,t){const i=wn(e),s=wn(this.view.lastRenderedLocation),n=t==="restore"&&typeof i>"u";return t!=="replace"&&hp(e)===hp(this.view.lastRenderedLocation)&&(n||i!=null&&i!==s)}visitScrolledToSamePageLocation(e,t){this.delegate.visitScrolledToSamePageLocation(e,t)}get location(){return this.history.location}get restorationIdentifier(){return this.history.restorationIdentifier}#e(e,t){const{submitter:i,formElement:s}=e;return xn(i,s)||this.#t(t)}#t(e){return e.redirected&&e.location.href===this.location?.href?"replace":"advance"}}const an={initial:0,loading:1,interactive:2,complete:3};class hM{stage=an.initial;started=!1;constructor(e){this.delegate=e}start(){this.started||(this.stage==an.initial&&(this.stage=an.loading),document.addEventListener("readystatechange",this.interpretReadyState,!1),addEventListener("pagehide",this.pageWillUnload,!1),this.started=!0)}stop(){this.started&&(document.removeEventListener("readystatechange",this.interpretReadyState,!1),removeEventListener("pagehide",this.pageWillUnload,!1),this.started=!1)}interpretReadyState=()=>{const{readyState:e}=this;e=="interactive"?this.pageIsInteractive():e=="complete"&&this.pageIsComplete()};pageIsInteractive(){this.stage==an.loading&&(this.stage=an.interactive,this.delegate.pageBecameInteractive())}pageIsComplete(){this.pageIsInteractive(),this.stage==an.interactive&&(this.stage=an.complete,this.delegate.pageLoaded())}pageWillUnload=()=>{this.delegate.pageWillUnload()};get readyState(){return document.readyState}}class dM{started=!1;constructor(e){this.delegate=e}start(){this.started||(addEventListener("scroll",this.onScroll,!1),this.onScroll(),this.started=!0)}stop(){this.started&&(removeEventListener("scroll",this.onScroll,!1),this.started=!1)}onScroll=()=>{this.updatePosition({x:window.pageXOffset,y:window.pageYOffset})};updatePosition(e){this.delegate.scrollPositionChanged(e)}}class fM{render({fragment:e}){L1.preservingPermanentElements(this,pM(e),()=>{mM(e,()=>{gM(()=>{document.documentElement.appendChild(e)})})})}enteringBardo(e,t){t.replaceWith(e.cloneNode(!0))}leavingBardo(){}}function pM(r){const e=P1(document.documentElement),t={};for(const i of e){const{id:s}=i;for(const n of r.querySelectorAll("turbo-stream")){const a=A1(n.templateElement.content,s);a&&(t[s]=[i,a])}}return t}async function mM(r,e){const t=`turbo-stream-autofocus-${js()}`,i=r.querySelectorAll("turbo-stream"),s=OM(i);let n=null;if(s&&(s.id?n=s.id:n=t,s.id=n),e(),await Zo(),(document.activeElement==null||document.activeElement==document.body)&&n){const o=document.getElementById(n);Hm(o)&&o.focus(),o&&o.id==t&&o.removeAttribute("id")}}async function gM(r){const[e,t]=await uD(r,()=>document.activeElement),i=e&&e.id;if(i){const s=document.getElementById(i);Hm(s)&&s!=t&&s.focus()}}function OM(r){for(const e of r){const t=S1(e.templateElement.content);if(t)return t}return null}class yM{sources=new Set;#e=!1;constructor(e){this.delegate=e}start(){this.#e||(this.#e=!0,addEventListener("turbo:before-fetch-response",this.inspectFetchResponse,!1))}stop(){this.#e&&(this.#e=!1,removeEventListener("turbo:before-fetch-response",this.inspectFetchResponse,!1))}connectStreamSource(e){this.streamSourceIsConnected(e)||(this.sources.add(e),e.addEventListener("message",this.receiveMessageEvent,!1))}disconnectStreamSource(e){this.streamSourceIsConnected(e)&&(this.sources.delete(e),e.removeEventListener("message",this.receiveMessageEvent,!1))}streamSourceIsConnected(e){return this.sources.has(e)}inspectFetchResponse=e=>{const t=bM(e);t&&vM(t)&&(e.preventDefault(),this.receiveMessageResponse(t))};receiveMessageEvent=e=>{this.#e&&typeof e.data=="string"&&this.receiveMessageHTML(e.data)};async receiveMessageResponse(e){const t=await e.responseHTML;t&&this.receiveMessageHTML(t)}receiveMessageHTML(e){this.delegate.receivedMessageFromStream(Wa.wrap(e))}}function bM(r){const e=r.detail?.fetchResponse;if(e instanceof Gm)return e}function vM(r){return(r.contentType??"").startsWith(Wa.contentType)}class SM extends tg{static renderElement(e,t){const{documentElement:i,body:s}=document;i.replaceChild(t,s)}async render(){this.replaceHeadAndBody(),this.activateScriptElements()}replaceHeadAndBody(){const{documentElement:e,head:t}=document;e.replaceChild(this.newHead,t),this.renderElement(this.currentElement,this.newElement)}activateScriptElements(){for(const e of this.scriptElements){const t=e.parentNode;if(t){const i=hl(e);t.replaceChild(i,e)}}}get newHead(){return this.newSnapshot.headSnapshot.element}get scriptElements(){return document.documentElement.querySelectorAll("script")}}class sg extends tg{static renderElement(e,t){document.body&&t instanceof HTMLBodyElement?document.body.replaceWith(t):document.documentElement.appendChild(t)}get shouldRender(){return this.newSnapshot.isVisitable&&this.trackedElementsAreIdentical}get reloadReason(){if(!this.newSnapshot.isVisitable)return{reason:"turbo_visit_control_is_reload"};if(!this.trackedElementsAreIdentical)return{reason:"tracked_element_mismatch"}}async prepareToRender(){this.#e(),await this.mergeHead()}async render(){this.willRender&&await this.replaceBody()}finishRendering(){super.finishRendering(),this.isPreview||this.focusFirstAutofocusableElement()}get currentHeadSnapshot(){return this.currentSnapshot.headSnapshot}get newHeadSnapshot(){return this.newSnapshot.headSnapshot}get newElement(){return this.newSnapshot.element}#e(){const{documentElement:e}=this.currentSnapshot,{lang:t}=this.newSnapshot;t?e.setAttribute("lang",t):e.removeAttribute("lang")}async mergeHead(){const e=this.mergeProvisionalElements(),t=this.copyNewHeadStylesheetElements();this.copyNewHeadScriptElements(),await e,await t,this.willRender&&this.removeUnusedDynamicStylesheetElements()}async replaceBody(){await this.preservingPermanentElements(async()=>{this.activateNewBody(),await this.assignNewBody()})}get trackedElementsAreIdentical(){return this.currentHeadSnapshot.trackedElementSignature==this.newHeadSnapshot.trackedElementSignature}async copyNewHeadStylesheetElements(){const e=[];for(const t of this.newHeadStylesheetElements)e.push(aD(t)),document.head.appendChild(t);await Promise.all(e)}copyNewHeadScriptElements(){for(const e of this.newHeadScriptElements)document.head.appendChild(hl(e))}removeUnusedDynamicStylesheetElements(){for(const e of this.unusedDynamicStylesheetElements)document.head.removeChild(e)}async mergeProvisionalElements(){const e=[...this.newHeadProvisionalElements];for(const t of this.currentHeadProvisionalElements)this.isCurrentElementInElementList(t,e)||document.head.removeChild(t);for(const t of e)document.head.appendChild(t)}isCurrentElementInElementList(e,t){for(const[i,s]of t.entries()){if(e.tagName=="TITLE"){if(s.tagName!="TITLE")continue;if(e.innerHTML==s.innerHTML)return t.splice(i,1),!0}if(s.isEqualNode(e))return t.splice(i,1),!0}return!1}removeCurrentHeadProvisionalElements(){for(const e of this.currentHeadProvisionalElements)document.head.removeChild(e)}copyNewHeadProvisionalElements(){for(const e of this.newHeadProvisionalElements)document.head.appendChild(e)}activateNewBody(){document.adoptNode(this.newElement),this.activateNewBodyScriptElements()}activateNewBodyScriptElements(){for(const e of this.newBodyScriptElements){const t=hl(e);e.replaceWith(t)}}async assignNewBody(){await this.renderElement(this.currentElement,this.newElement)}get unusedDynamicStylesheetElements(){return this.oldHeadStylesheetElements.filter(e=>e.getAttribute("data-turbo-track")==="dynamic")}get oldHeadStylesheetElements(){return this.currentHeadSnapshot.getStylesheetElementsNotInSnapshot(this.newHeadSnapshot)}get newHeadStylesheetElements(){return this.newHeadSnapshot.getStylesheetElementsNotInSnapshot(this.currentHeadSnapshot)}get newHeadScriptElements(){return this.newHeadSnapshot.getScriptElementsNotInSnapshot(this.currentHeadSnapshot)}get currentHeadProvisionalElements(){return this.currentHeadSnapshot.provisionalElements}get newHeadProvisionalElements(){return this.newHeadSnapshot.provisionalElements}get newBodyScriptElements(){return this.newElement.querySelectorAll("script")}}class N1 extends sg{static renderElement(e,t){Qh(e,t,{callbacks:{beforeNodeMorphed:(i,s)=>Q1(i,s)&&!$1(i)?(i.reload(),!1):!0}}),bt("turbo:morph",{detail:{currentElement:e,newElement:t}})}async preservingPermanentElements(e){return await e()}get renderMethod(){return"morph"}get shouldAutofocus(){return!1}}class TM{keys=[];snapshots={};constructor(e){this.size=e}has(e){return Iu(e)in this.snapshots}get(e){if(this.has(e)){const t=this.read(e);return this.touch(e),t}}put(e,t){return this.write(e,t),this.touch(e),t}clear(){this.snapshots={}}read(e){return this.snapshots[Iu(e)]}write(e,t){this.snapshots[Iu(e)]=t}touch(e){const t=Iu(e),i=this.keys.indexOf(t);i>-1&&this.keys.splice(i,1),this.keys.unshift(t),this.trim()}trim(){for(const e of this.keys.splice(this.size))delete this.snapshots[e]}}class _M extends D1{snapshotCache=new TM(10);lastRenderedLocation=new URL(location.href);forceReloaded=!1;shouldTransitionTo(e){return this.snapshot.prefersViewTransitions&&e.prefersViewTransitions}renderPage(e,t=!1,i=!0,s){const a=this.isPageRefresh(s)&&this.snapshot.shouldMorphPage?N1:sg,o=new a(this.snapshot,e,t,i);return o.shouldRender?s?.changeHistory():this.forceReloaded=!0,this.render(o)}renderError(e,t){t?.changeHistory();const i=new SM(this.snapshot,e,!1);return this.render(i)}clearSnapshotCache(){this.snapshotCache.clear()}async cacheSnapshot(e=this.snapshot){if(e.isCacheable){this.delegate.viewWillCacheSnapshot();const{lastRenderedLocation:t}=this;await g1();const i=e.clone();return this.snapshotCache.put(t,i),i}}getCachedSnapshotForLocation(e){return this.snapshotCache.get(e)}isPageRefresh(e){return!e||this.lastRenderedLocation.pathname===e.location.pathname&&e.action==="replace"}shouldPreserveScrollPosition(e){return this.isPageRefresh(e)&&this.snapshot.shouldPreserveScrollPosition}get snapshot(){return pr.fromElement(this.element)}}class xM{selector="a[data-turbo-preload]";constructor(e,t){this.delegate=e,this.snapshotCache=t}start(){document.readyState==="loading"?document.addEventListener("DOMContentLoaded",this.#e):this.preloadOnLoadLinksForView(document.body)}stop(){document.removeEventListener("DOMContentLoaded",this.#e)}preloadOnLoadLinksForView(e){for(const t of e.querySelectorAll(this.selector))this.delegate.shouldPreloadLink(t)&&this.preloadURL(t)}async preloadURL(e){const t=new URL(e.href);if(this.snapshotCache.has(t))return;await new Xl(this,Yi.get,t,new URLSearchParams,e).perform()}prepareRequest(e){e.headers["X-Sec-Purpose"]="prefetch"}async requestSucceededWithResponse(e,t){try{const i=await t.responseHTML,s=pr.fromHTMLString(i);this.snapshotCache.put(e.url,s)}catch{}}requestStarted(e){}requestErrored(e){}requestFinished(e){}requestPreventedHandlingResponse(e,t){}requestFailedWithResponse(e,t){}#e=()=>{this.preloadOnLoadLinksForView(document.body)}}class wM{constructor(e){this.session=e}clear(){this.session.clearCache()}resetCacheControl(){this.#e("")}exemptPageFromCache(){this.#e("no-cache")}exemptPageFromPreview(){this.#e("no-preview")}#e(e){lD("turbo-cache-control",e)}}class CM{navigator=new cM(this);history=new iM(this);view=new _M(this,document.documentElement);adapter=new JD(this);pageObserver=new hM(this);cacheObserver=new eM;linkPrefetchObserver=new rM(this,document);linkClickObserver=new I1(this,window);formSubmitObserver=new eg(this,document);scrollObserver=new dM(this);streamObserver=new yM(this);formLinkClickObserver=new R1(this,document.documentElement);frameRedirector=new tM(this,document.documentElement);streamMessageRenderer=new fM;cache=new wM(this);enabled=!0;started=!1;#e=150;constructor(e){this.recentRequests=e,this.preloader=new xM(this,this.view.snapshotCache),this.debouncedRefresh=this.refresh,this.pageRefreshDebouncePeriod=this.pageRefreshDebouncePeriod}start(){this.started||(this.pageObserver.start(),this.cacheObserver.start(),this.linkPrefetchObserver.start(),this.formLinkClickObserver.start(),this.linkClickObserver.start(),this.formSubmitObserver.start(),this.scrollObserver.start(),this.streamObserver.start(),this.frameRedirector.start(),this.history.start(),this.preloader.start(),this.started=!0,this.enabled=!0)}disable(){this.enabled=!1}stop(){this.started&&(this.pageObserver.stop(),this.cacheObserver.stop(),this.linkPrefetchObserver.stop(),this.formLinkClickObserver.stop(),this.linkClickObserver.stop(),this.formSubmitObserver.stop(),this.scrollObserver.stop(),this.streamObserver.stop(),this.frameRedirector.stop(),this.history.stop(),this.preloader.stop(),this.started=!1)}registerAdapter(e){this.adapter=e}visit(e,t={}){const i=t.frame?document.getElementById(t.frame):null;if(i instanceof gr){const s=t.action||xn(i);i.delegate.proposeVisitIfNavigatedWithAction(i,s),i.src=e.toString()}else this.navigator.proposeVisit(Gt(e),t)}refresh(e,t){const i=t&&this.recentRequests.has(t),s=e===document.baseURI;!i&&!this.navigator.currentVisit&&s&&this.visit(e,{action:"replace",shouldCacheSnapshot:!1})}connectStreamSource(e){this.streamObserver.connectStreamSource(e)}disconnectStreamSource(e){this.streamObserver.disconnectStreamSource(e)}renderStreamMessage(e){this.streamMessageRenderer.render(Wa.wrap(e))}clearCache(){this.view.clearSnapshotCache()}setProgressBarDelay(e){console.warn("Please replace `session.setProgressBarDelay(delay)` with `session.progressBarDelay = delay`. The function is deprecated and will be removed in a future version of Turbo.`"),this.progressBarDelay=e}set progressBarDelay(e){Ft.drive.progressBarDelay=e}get progressBarDelay(){return Ft.drive.progressBarDelay}set drive(e){Ft.drive.enabled=e}get drive(){return Ft.drive.enabled}set formMode(e){Ft.forms.mode=e}get formMode(){return Ft.forms.mode}get location(){return this.history.location}get restorationIdentifier(){return this.history.restorationIdentifier}get pageRefreshDebouncePeriod(){return this.#e}set pageRefreshDebouncePeriod(e){this.refresh=cD(this.debouncedRefresh.bind(this),e),this.#e=e}shouldPreloadLink(e){const t=e.hasAttribute("data-turbo-method"),i=e.hasAttribute("data-turbo-stream"),s=e.getAttribute("data-turbo-frame"),n=s=="_top"?null:document.getElementById(s)||la(e,"turbo-frame:not([disabled])");if(t||i||n instanceof gr)return!1;{const a=new URL(e.href);return this.elementIsNavigatable(e)&&Ns(a,this.snapshot.rootLocation)}}historyPoppedToLocationWithRestorationIdentifierAndDirection(e,t,i){this.enabled?this.navigator.startVisit(e,t,{action:"restore",historyChanged:!0,direction:i}):this.adapter.pageInvalidated({reason:"turbo_disabled"})}scrollPositionChanged(e){this.history.updateRestorationData({scrollPosition:e})}willSubmitFormLinkToLocation(e,t){return this.elementIsNavigatable(e)&&Ns(t,this.snapshot.rootLocation)}submittedFormLinkToLocation(){}canPrefetchRequestToLocation(e,t){return this.elementIsNavigatable(e)&&Ns(t,this.snapshot.rootLocation)&&this.navigator.linkPrefetchingIsEnabledForLocation(t)}willFollowLinkToLocation(e,t,i){return this.elementIsNavigatable(e)&&Ns(t,this.snapshot.rootLocation)&&this.applicationAllowsFollowingLinkToLocation(e,t,i)}followedLinkToLocation(e,t){const i=this.getActionForLink(e),s=e.hasAttribute("data-turbo-stream");this.visit(t.href,{action:i,acceptsStreamResponse:s})}allowsVisitingLocationWithAction(e,t){return this.locationWithActionIsSamePage(e,t)||this.applicationAllowsVisitingLocation(e)}visitProposedToLocation(e,t){XO(e),this.adapter.visitProposedToLocation(e,t)}visitStarted(e){e.acceptsStreamResponse||(Ic(document.documentElement),this.view.markVisitDirection(e.direction)),XO(e.location),e.silent||this.notifyApplicationAfterVisitingLocation(e.location,e.action)}visitCompleted(e){this.view.unmarkVisitDirection(),Rc(document.documentElement),this.notifyApplicationAfterPageLoad(e.getTimingMetrics())}locationWithActionIsSamePage(e,t){return this.navigator.locationWithActionIsSamePage(e,t)}visitScrolledToSamePageLocation(e,t){this.notifyApplicationAfterVisitingSamePageLocation(e,t)}willSubmitForm(e,t){const i=Ym(e,t);return this.submissionIsNavigatable(e,t)&&Ns(Gt(i),this.snapshot.rootLocation)}formSubmitted(e,t){this.navigator.submitForm(e,t)}pageBecameInteractive(){this.view.lastRenderedLocation=this.location,this.notifyApplicationAfterPageLoad()}pageLoaded(){this.history.assumeControlOfScrollRestoration()}pageWillUnload(){this.history.relinquishControlOfScrollRestoration()}receivedMessageFromStream(e){this.renderStreamMessage(e)}viewWillCacheSnapshot(){this.navigator.currentVisit?.silent||this.notifyApplicationBeforeCachingSnapshot()}allowsImmediateRender({element:e},t){const i=this.notifyApplicationBeforeRender(e,t),{defaultPrevented:s,detail:{render:n}}=i;return this.view.renderer&&n&&(this.view.renderer.renderElement=n),!s}viewRenderedSnapshot(e,t,i){this.view.lastRenderedLocation=this.history.location,this.notifyApplicationAfterRender(i)}preloadOnLoadLinksForView(e){this.preloader.preloadOnLoadLinksForView(e)}viewInvalidated(e){this.adapter.pageInvalidated(e)}frameLoaded(e){this.notifyApplicationAfterFrameLoad(e)}frameRendered(e,t){this.notifyApplicationAfterFrameRender(e,t)}applicationAllowsFollowingLinkToLocation(e,t,i){return!this.notifyApplicationAfterClickingLinkToLocation(e,t,i).defaultPrevented}applicationAllowsVisitingLocation(e){return!this.notifyApplicationBeforeVisitingLocation(e).defaultPrevented}notifyApplicationAfterClickingLinkToLocation(e,t,i){return bt("turbo:click",{target:e,detail:{url:t.href,originalEvent:i},cancelable:!0})}notifyApplicationBeforeVisitingLocation(e){return bt("turbo:before-visit",{detail:{url:e.href},cancelable:!0})}notifyApplicationAfterVisitingLocation(e,t){return bt("turbo:visit",{detail:{url:e.href,action:t}})}notifyApplicationBeforeCachingSnapshot(){return bt("turbo:before-cache")}notifyApplicationBeforeRender(e,t){return bt("turbo:before-render",{detail:{newBody:e,...t},cancelable:!0})}notifyApplicationAfterRender(e){return bt("turbo:render",{detail:{renderMethod:e}})}notifyApplicationAfterPageLoad(e={}){return bt("turbo:load",{detail:{url:this.location.href,timing:e}})}notifyApplicationAfterVisitingSamePageLocation(e,t){dispatchEvent(new HashChangeEvent("hashchange",{oldURL:e.toString(),newURL:t.toString()}))}notifyApplicationAfterFrameLoad(e){return bt("turbo:frame-load",{target:e})}notifyApplicationAfterFrameRender(e,t){return bt("turbo:frame-render",{detail:{fetchResponse:e},target:t,cancelable:!0})}submissionIsNavigatable(e,t){if(Ft.forms.mode=="off")return!1;{const i=t?this.elementIsNavigatable(t):!0;return Ft.forms.mode=="optin"?i&&e.closest('[data-turbo="true"]')!=null:i&&this.elementIsNavigatable(e)}}elementIsNavigatable(e){const t=la(e,"[data-turbo]"),i=la(e,"turbo-frame");return Ft.drive.enabled||i?t?t.getAttribute("data-turbo")!="false":!0:t?t.getAttribute("data-turbo")=="true":!1}getActionForLink(e){return xn(e)||"advance"}get snapshot(){return this.view.snapshot}}function XO(r){Object.defineProperties(r,kM)}const kM={absoluteURL:{get(){return this.toString()}}},Ct=new CM(C1),{cache:EM,navigator:AM}=Ct;function F1(){Ct.start()}function PM(r){Ct.registerAdapter(r)}function DM(r,e){Ct.visit(r,e)}function U1(r){Ct.connectStreamSource(r)}function q1(r){Ct.disconnectStreamSource(r)}function MM(r){Ct.renderStreamMessage(r)}function IM(){console.warn("Please replace `Turbo.clearCache()` with `Turbo.cache.clear()`. The top-level function is deprecated and will be removed in a future version of Turbo.`"),Ct.clearCache()}function RM(r){console.warn("Please replace `Turbo.setProgressBarDelay(delay)` with `Turbo.config.drive.progressBarDelay = delay`. The top-level function is deprecated and will be removed in a future version of Turbo.`"),Ft.drive.progressBarDelay=r}function LM(r){console.warn("Please replace `Turbo.setConfirmMethod(confirmMethod)` with `Turbo.config.forms.confirm = confirmMethod`. The top-level function is deprecated and will be removed in a future version of Turbo.`"),Ft.forms.confirm=r}function QM(r){console.warn("Please replace `Turbo.setFormMode(mode)` with `Turbo.config.forms.mode = mode`. The top-level function is deprecated and will be removed in a future version of Turbo.`"),Ft.forms.mode=r}function $M(r,e){N1.renderElement(r,e)}function BM(r,e){B1.renderElement(r,e)}var NM=Object.freeze({__proto__:null,navigator:AM,session:Ct,cache:EM,PageRenderer:sg,PageSnapshot:pr,FrameRenderer:ig,fetch:k1,config:Ft,start:F1,registerAdapter:PM,visit:DM,connectStreamSource:U1,disconnectStreamSource:q1,renderStreamMessage:MM,clearCache:IM,setProgressBarDelay:RM,setConfirmMethod:LM,setFormMode:QM,morphBodyElements:$M,morphTurboFrameElements:BM,morphChildren:rg,morphElements:Qh});class FM extends Error{}class UM{fetchResponseLoaded=e=>Promise.resolve();#e=null;#t=()=>{};#i=!1;#n=!1;#a=new Set;#s=!1;action=null;constructor(e){this.element=e,this.view=new LD(this,this.element),this.appearanceObserver=new SD(this,this.element),this.formLinkClickObserver=new R1(this,this.element),this.linkInterceptor=new M1(this,this.element),this.restorationIdentifier=js(),this.formSubmitObserver=new eg(this,this.element)}connect(){this.#i||(this.#i=!0,this.loadingStyle==ea.lazy?this.appearanceObserver.start():this.#r(),this.formLinkClickObserver.start(),this.linkInterceptor.start(),this.formSubmitObserver.start())}disconnect(){this.#i&&(this.#i=!1,this.appearanceObserver.stop(),this.formLinkClickObserver.stop(),this.linkInterceptor.stop(),this.formSubmitObserver.stop())}disabledChanged(){this.loadingStyle==ea.eager&&this.#r()}sourceURLChanged(){this.#y("src")||(this.element.isConnected&&(this.complete=!1),(this.loadingStyle==ea.eager||this.#n)&&this.#r())}sourceURLReloaded(){const{refresh:e,src:t}=this.element;return this.#s=t&&e==="morph",this.element.removeAttribute("complete"),this.element.src=null,this.element.src=t,this.element.loaded}loadingStyleChanged(){this.loadingStyle==ea.lazy?this.appearanceObserver.start():(this.appearanceObserver.stop(),this.#r())}async#r(){this.enabled&&this.isActive&&!this.complete&&this.sourceURL&&(this.element.loaded=this.#h(Gt(this.sourceURL)),this.appearanceObserver.stop(),await this.element.loaded,this.#n=!0)}async loadResponse(e){(e.redirected||e.succeeded&&e.isHTML)&&(this.sourceURL=e.response.url);try{const t=await e.responseHTML;if(t){const i=O1(t);pr.fromDocument(i).isVisitable?await this.#l(e,i):await this.#f(e)}}finally{this.#s=!1,this.fetchResponseLoaded=()=>Promise.resolve()}}elementAppearedInViewport(e){this.proposeVisitIfNavigatedWithAction(e,xn(e)),this.#r()}willSubmitFormLinkToLocation(e){return this.#u(e)}submittedFormLinkToLocation(e,t,i){const s=this.#o(e);s&&i.setAttribute("data-turbo-frame",s.id)}shouldInterceptLinkClick(e,t,i){return this.#u(e)}linkClickIntercepted(e,t){this.#d(e,t)}willSubmitForm(e,t){return e.closest("turbo-frame")==this.element&&this.#u(e,t)}formSubmitted(e,t){this.formSubmission&&this.formSubmission.stop(),this.formSubmission=new Rh(this,e,t);const{fetchRequest:i}=this.formSubmission;this.prepareRequest(i),this.formSubmission.start()}prepareRequest(e){e.headers["Turbo-Frame"]=this.id,this.currentNavigationElement?.hasAttribute("data-turbo-stream")&&e.acceptResponseType(Wa.contentType)}requestStarted(e){Ic(this.element)}requestPreventedHandlingResponse(e,t){this.#t()}async requestSucceededWithResponse(e,t){await this.loadResponse(t),this.#t()}async requestFailedWithResponse(e,t){await this.loadResponse(t),this.#t()}requestErrored(e,t){console.error(t),this.#t()}requestFinished(e){Rc(this.element)}formSubmissionStarted({formElement:e}){Ic(e,this.#o(e))}formSubmissionSucceededWithResponse(e,t){const i=this.#o(e.formElement,e.submitter);i.delegate.proposeVisitIfNavigatedWithAction(i,xn(e.submitter,e.formElement,i)),i.delegate.loadResponse(t),e.isSafe||Ct.clearCache()}formSubmissionFailedWithResponse(e,t){this.element.delegate.loadResponse(t),Ct.clearCache()}formSubmissionErrored(e,t){console.error(t)}formSubmissionFinished({formElement:e}){Rc(e,this.#o(e))}allowsImmediateRender({element:e},t){const i=bt("turbo:before-frame-render",{target:this.element,detail:{newFrame:e,...t},cancelable:!0}),{defaultPrevented:s,detail:{render:n}}=i;return this.view.renderer&&n&&(this.view.renderer.renderElement=n),!s}viewRenderedSnapshot(e,t,i){}preloadOnLoadLinksForView(e){Ct.preloadOnLoadLinksForView(e)}viewInvalidated(){}willRenderFrame(e,t){this.previousFrameElement=e.cloneNode(!0)}visitCachedSnapshot=({element:e})=>{const t=e.querySelector("#"+this.element.id);t&&this.previousFrameElement&&t.replaceChildren(...this.previousFrameElement.children),delete this.previousFrameElement};async#l(e,t){const i=await this.extractForeignFrameElement(t.body),s=this.#s?B1:ig;if(i){const n=new Lh(i),a=new s(this,this.view.snapshot,n,!1,!1);this.view.renderPromise&&await this.view.renderPromise,this.changeHistory(),await this.view.render(a),this.complete=!0,Ct.frameRendered(e,this.element),Ct.frameLoaded(this.element),await this.fetchResponseLoaded(e)}else this.#p(e)&&this.#m(e)}async#h(e){const t=new Xl(this,Yi.get,e,new URLSearchParams,this.element);return this.#e?.cancel(),this.#e=t,new Promise(i=>{this.#t=()=>{this.#t=()=>{},this.#e=null,i()},t.perform()})}#d(e,t,i){const s=this.#o(e,i);s.delegate.proposeVisitIfNavigatedWithAction(s,xn(i,e,s)),this.#v(e,()=>{s.src=t})}proposeVisitIfNavigatedWithAction(e,t=null){if(this.action=t,this.action){const i=pr.fromElement(e).clone(),{visitCachedSnapshot:s}=e.delegate;e.delegate.fetchResponseLoaded=async n=>{if(e.src){const{statusCode:a,redirected:o}=n,l=await n.responseHTML,c={response:{statusCode:a,redirected:o,responseHTML:l},visitCachedSnapshot:s,willRender:!1,updateHistory:!1,restorationIdentifier:this.restorationIdentifier,snapshot:i};this.action&&(c.action=this.action),Ct.visit(e.src,c)}}}}changeHistory(){if(this.action){const e=b1(this.action);Ct.history.update(e,Gt(this.element.src||""),this.restorationIdentifier)}}async#f(e){console.warn(`The response (${e.statusCode}) from <turbo-frame id="${this.element.id}"> is performing a full page visit due to turbo-visit-control.`),await this.#c(e.response)}#p(e){this.element.setAttribute("complete","");const t=e.response,i=async(n,a)=>{n instanceof Response?this.#c(n):Ct.visit(n,a)};return!bt("turbo:frame-missing",{target:this.element,detail:{response:t,visit:i},cancelable:!0}).defaultPrevented}#m(e){this.view.missing(),this.#g(e)}#g(e){const t=`The response (${e.statusCode}) did not contain the expected <turbo-frame id="${this.element.id}"> and will be ignored. To perform a full page visit instead, set turbo-visit-control to reload.`;throw new FM(t)}async#c(e){const t=new Gm(e),i=await t.responseHTML,{location:s,redirected:n,statusCode:a}=t;return Ct.visit(s,{response:{redirected:n,statusCode:a,responseHTML:i}})}#o(e,t){const i=Mc("data-turbo-frame",t,e)||this.element.getAttribute("target");return jO(i)??this.element}async extractForeignFrameElement(e){let t;const i=CSS.escape(this.id);try{if(t=zO(e.querySelector(`turbo-frame#${i}`),this.sourceURL),t)return t;if(t=zO(e.querySelector(`turbo-frame[src][recurse~=${i}]`),this.sourceURL),t)return await t.loaded,await this.extractForeignFrameElement(t)}catch(s){return console.error(s),new gr}return null}#O(e,t){const i=Ym(e,t);return Ns(Gt(i),this.rootLocation)}#u(e,t){const i=Mc("data-turbo-frame",t,e)||this.element.getAttribute("target");if(e instanceof HTMLFormElement&&!this.#O(e,t)||!this.enabled||i=="_top")return!1;if(i){const s=jO(i);if(s)return!s.disabled}return!(!Ct.elementIsNavigatable(e)||t&&!Ct.elementIsNavigatable(t))}get id(){return this.element.id}get enabled(){return!this.element.disabled}get sourceURL(){if(this.element.src)return this.element.src}set sourceURL(e){this.#b("src",()=>{this.element.src=e??null})}get loadingStyle(){return this.element.loading}get isLoading(){return this.formSubmission!==void 0||this.#t()!==void 0}get complete(){return this.element.hasAttribute("complete")}set complete(e){e?this.element.setAttribute("complete",""):this.element.removeAttribute("complete")}get isActive(){return this.element.isActive&&this.#i}get rootLocation(){const t=this.element.ownerDocument.querySelector('meta[name="turbo-root"]')?.content??"/";return Gt(t)}#y(e){return this.#a.has(e)}#b(e,t){this.#a.add(e),t(),this.#a.delete(e)}#v(e,t){this.currentNavigationElement=e,t(),delete this.currentNavigationElement}}function jO(r){if(r!=null){const e=document.getElementById(r);if(e instanceof gr)return e}}function zO(r,e){if(r){const t=r.getAttribute("src");if(t!=null&&e!=null&&w1(t,e))throw new Error(`Matching <turbo-frame id="${r.id}"> element has a source URL which references itself`);if(r.ownerDocument!==document&&(r=document.importNode(r,!0)),r instanceof gr)return r.connectedCallback(),r.disconnectedCallback(),r}}const V1={after(){this.targetElements.forEach(r=>r.parentElement?.insertBefore(this.templateContent,r.nextSibling))},append(){this.removeDuplicateTargetChildren(),this.targetElements.forEach(r=>r.append(this.templateContent))},before(){this.targetElements.forEach(r=>r.parentElement?.insertBefore(this.templateContent,r))},prepend(){this.removeDuplicateTargetChildren(),this.targetElements.forEach(r=>r.prepend(this.templateContent))},remove(){this.targetElements.forEach(r=>r.remove())},replace(){const r=this.getAttribute("method");this.targetElements.forEach(e=>{r==="morph"?Qh(e,this.templateContent):e.replaceWith(this.templateContent)})},update(){const r=this.getAttribute("method");this.targetElements.forEach(e=>{r==="morph"?rg(e,this.templateContent):(e.innerHTML="",e.append(this.templateContent))})},refresh(){Ct.refresh(this.baseURI,this.requestId)}};class ng extends HTMLElement{static async renderElement(e){await e.performAction()}async connectedCallback(){try{await this.render()}catch(e){console.error(e)}finally{this.disconnect()}}async render(){return this.renderPromise??=(async()=>{const e=this.beforeRenderEvent;this.dispatchEvent(e)&&(await Zo(),await e.detail.render(this))})()}disconnect(){try{this.remove()}catch{}}removeDuplicateTargetChildren(){this.duplicateChildren.forEach(e=>e.remove())}get duplicateChildren(){const e=this.targetElements.flatMap(i=>[...i.children]).filter(i=>!!i.getAttribute("id")),t=[...this.templateContent?.children||[]].filter(i=>!!i.getAttribute("id")).map(i=>i.getAttribute("id"));return e.filter(i=>t.includes(i.getAttribute("id")))}get performAction(){if(this.action){const e=V1[this.action];if(e)return e;this.#e("unknown action")}this.#e("action attribute is missing")}get targetElements(){if(this.target)return this.targetElementsById;if(this.targets)return this.targetElementsByQuery;this.#e("target or targets attribute is missing")}get templateContent(){return this.templateElement.content.cloneNode(!0)}get templateElement(){if(this.firstElementChild===null){const e=this.ownerDocument.createElement("template");return this.appendChild(e),e}else if(this.firstElementChild instanceof HTMLTemplateElement)return this.firstElementChild;this.#e("first child element must be a <template> element")}get action(){return this.getAttribute("action")}get target(){return this.getAttribute("target")}get targets(){return this.getAttribute("targets")}get requestId(){return this.getAttribute("request-id")}#e(e){throw new Error(`${this.description}: ${e}`)}get description(){return(this.outerHTML.match(/<[^>]+>/)??[])[0]??"<turbo-stream>"}get beforeRenderEvent(){return new CustomEvent("turbo:before-stream-render",{bubbles:!0,cancelable:!0,detail:{newStream:this,render:ng.renderElement}})}get targetElementsById(){const e=this.ownerDocument?.getElementById(this.target);return e!==null?[e]:[]}get targetElementsByQuery(){const e=this.ownerDocument?.querySelectorAll(this.targets);return e.length!==0?Array.prototype.slice.call(e):[]}}class qM extends HTMLElement{streamSource=null;connectedCallback(){this.streamSource=this.src.match(/^ws{1,2}:/)?new WebSocket(this.src):new EventSource(this.src),U1(this.streamSource)}disconnectedCallback(){this.streamSource&&(this.streamSource.close(),q1(this.streamSource))}get src(){return this.getAttribute("src")||""}}gr.delegateConstructor=UM;customElements.get("turbo-frame")===void 0&&customElements.define("turbo-frame",gr);customElements.get("turbo-stream")===void 0&&customElements.define("turbo-stream",ng);customElements.get("turbo-stream-source")===void 0&&customElements.define("turbo-stream-source",qM);(()=>{let r=document.currentScript;if(r&&!r.hasAttribute("data-turbo-suppress-warning"))for(r=r.parentElement;r;){if(r==document.body)return console.warn(y1`
        You are loading Turbo from a <script> element inside the <body> element. This is probably not what you meant to do!

        Load your application’s JavaScript bundle inside the <head> element instead. <script> elements in <body> are evaluated with each page change.

        For more information, see: https://turbo.hotwired.dev/handbook/building#working-with-script-elements

        ——
        Suppress this warning by adding a "data-turbo-suppress-warning" attribute to: %s
      `,r.outerHTML);r=r.parentElement}})();window.Turbo={...NM,StreamActions:V1};F1();var X1={exports:{}};(function(r,e){(function(t){r.exports=t()})((function(t){var i=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];function s(C,_){var v=C[0],T=C[1],w=C[2],A=C[3];v+=(T&w|~T&A)+_[0]-680876936|0,v=(v<<7|v>>>25)+T|0,A+=(v&T|~v&w)+_[1]-389564586|0,A=(A<<12|A>>>20)+v|0,w+=(A&v|~A&T)+_[2]+606105819|0,w=(w<<17|w>>>15)+A|0,T+=(w&A|~w&v)+_[3]-1044525330|0,T=(T<<22|T>>>10)+w|0,v+=(T&w|~T&A)+_[4]-176418897|0,v=(v<<7|v>>>25)+T|0,A+=(v&T|~v&w)+_[5]+1200080426|0,A=(A<<12|A>>>20)+v|0,w+=(A&v|~A&T)+_[6]-1473231341|0,w=(w<<17|w>>>15)+A|0,T+=(w&A|~w&v)+_[7]-45705983|0,T=(T<<22|T>>>10)+w|0,v+=(T&w|~T&A)+_[8]+1770035416|0,v=(v<<7|v>>>25)+T|0,A+=(v&T|~v&w)+_[9]-1958414417|0,A=(A<<12|A>>>20)+v|0,w+=(A&v|~A&T)+_[10]-42063|0,w=(w<<17|w>>>15)+A|0,T+=(w&A|~w&v)+_[11]-1990404162|0,T=(T<<22|T>>>10)+w|0,v+=(T&w|~T&A)+_[12]+1804603682|0,v=(v<<7|v>>>25)+T|0,A+=(v&T|~v&w)+_[13]-40341101|0,A=(A<<12|A>>>20)+v|0,w+=(A&v|~A&T)+_[14]-1502002290|0,w=(w<<17|w>>>15)+A|0,T+=(w&A|~w&v)+_[15]+1236535329|0,T=(T<<22|T>>>10)+w|0,v+=(T&A|w&~A)+_[1]-165796510|0,v=(v<<5|v>>>27)+T|0,A+=(v&w|T&~w)+_[6]-1069501632|0,A=(A<<9|A>>>23)+v|0,w+=(A&T|v&~T)+_[11]+643717713|0,w=(w<<14|w>>>18)+A|0,T+=(w&v|A&~v)+_[0]-373897302|0,T=(T<<20|T>>>12)+w|0,v+=(T&A|w&~A)+_[5]-701558691|0,v=(v<<5|v>>>27)+T|0,A+=(v&w|T&~w)+_[10]+38016083|0,A=(A<<9|A>>>23)+v|0,w+=(A&T|v&~T)+_[15]-660478335|0,w=(w<<14|w>>>18)+A|0,T+=(w&v|A&~v)+_[4]-405537848|0,T=(T<<20|T>>>12)+w|0,v+=(T&A|w&~A)+_[9]+568446438|0,v=(v<<5|v>>>27)+T|0,A+=(v&w|T&~w)+_[14]-1019803690|0,A=(A<<9|A>>>23)+v|0,w+=(A&T|v&~T)+_[3]-187363961|0,w=(w<<14|w>>>18)+A|0,T+=(w&v|A&~v)+_[8]+1163531501|0,T=(T<<20|T>>>12)+w|0,v+=(T&A|w&~A)+_[13]-1444681467|0,v=(v<<5|v>>>27)+T|0,A+=(v&w|T&~w)+_[2]-51403784|0,A=(A<<9|A>>>23)+v|0,w+=(A&T|v&~T)+_[7]+1735328473|0,w=(w<<14|w>>>18)+A|0,T+=(w&v|A&~v)+_[12]-1926607734|0,T=(T<<20|T>>>12)+w|0,v+=(T^w^A)+_[5]-378558|0,v=(v<<4|v>>>28)+T|0,A+=(v^T^w)+_[8]-2022574463|0,A=(A<<11|A>>>21)+v|0,w+=(A^v^T)+_[11]+1839030562|0,w=(w<<16|w>>>16)+A|0,T+=(w^A^v)+_[14]-35309556|0,T=(T<<23|T>>>9)+w|0,v+=(T^w^A)+_[1]-1530992060|0,v=(v<<4|v>>>28)+T|0,A+=(v^T^w)+_[4]+1272893353|0,A=(A<<11|A>>>21)+v|0,w+=(A^v^T)+_[7]-155497632|0,w=(w<<16|w>>>16)+A|0,T+=(w^A^v)+_[10]-1094730640|0,T=(T<<23|T>>>9)+w|0,v+=(T^w^A)+_[13]+681279174|0,v=(v<<4|v>>>28)+T|0,A+=(v^T^w)+_[0]-358537222|0,A=(A<<11|A>>>21)+v|0,w+=(A^v^T)+_[3]-722521979|0,w=(w<<16|w>>>16)+A|0,T+=(w^A^v)+_[6]+76029189|0,T=(T<<23|T>>>9)+w|0,v+=(T^w^A)+_[9]-640364487|0,v=(v<<4|v>>>28)+T|0,A+=(v^T^w)+_[12]-421815835|0,A=(A<<11|A>>>21)+v|0,w+=(A^v^T)+_[15]+530742520|0,w=(w<<16|w>>>16)+A|0,T+=(w^A^v)+_[2]-995338651|0,T=(T<<23|T>>>9)+w|0,v+=(w^(T|~A))+_[0]-198630844|0,v=(v<<6|v>>>26)+T|0,A+=(T^(v|~w))+_[7]+1126891415|0,A=(A<<10|A>>>22)+v|0,w+=(v^(A|~T))+_[14]-1416354905|0,w=(w<<15|w>>>17)+A|0,T+=(A^(w|~v))+_[5]-57434055|0,T=(T<<21|T>>>11)+w|0,v+=(w^(T|~A))+_[12]+1700485571|0,v=(v<<6|v>>>26)+T|0,A+=(T^(v|~w))+_[3]-1894986606|0,A=(A<<10|A>>>22)+v|0,w+=(v^(A|~T))+_[10]-1051523|0,w=(w<<15|w>>>17)+A|0,T+=(A^(w|~v))+_[1]-2054922799|0,T=(T<<21|T>>>11)+w|0,v+=(w^(T|~A))+_[8]+1873313359|0,v=(v<<6|v>>>26)+T|0,A+=(T^(v|~w))+_[15]-30611744|0,A=(A<<10|A>>>22)+v|0,w+=(v^(A|~T))+_[6]-1560198380|0,w=(w<<15|w>>>17)+A|0,T+=(A^(w|~v))+_[13]+1309151649|0,T=(T<<21|T>>>11)+w|0,v+=(w^(T|~A))+_[4]-145523070|0,v=(v<<6|v>>>26)+T|0,A+=(T^(v|~w))+_[11]-1120210379|0,A=(A<<10|A>>>22)+v|0,w+=(v^(A|~T))+_[2]+718787259|0,w=(w<<15|w>>>17)+A|0,T+=(A^(w|~v))+_[9]-343485551|0,T=(T<<21|T>>>11)+w|0,C[0]=v+C[0]|0,C[1]=T+C[1]|0,C[2]=w+C[2]|0,C[3]=A+C[3]|0}function n(C){var _=[],v;for(v=0;v<64;v+=4)_[v>>2]=C.charCodeAt(v)+(C.charCodeAt(v+1)<<8)+(C.charCodeAt(v+2)<<16)+(C.charCodeAt(v+3)<<24);return _}function a(C){var _=[],v;for(v=0;v<64;v+=4)_[v>>2]=C[v]+(C[v+1]<<8)+(C[v+2]<<16)+(C[v+3]<<24);return _}function o(C){var _=C.length,v=[1732584193,-271733879,-1732584194,271733878],T,w,A,I,N,P;for(T=64;T<=_;T+=64)s(v,n(C.substring(T-64,T)));for(C=C.substring(T-64),w=C.length,A=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],T=0;T<w;T+=1)A[T>>2]|=C.charCodeAt(T)<<(T%4<<3);if(A[T>>2]|=128<<(T%4<<3),T>55)for(s(v,A),T=0;T<16;T+=1)A[T]=0;return I=_*8,I=I.toString(16).match(/(.*?)(.{0,8})$/),N=parseInt(I[2],16),P=parseInt(I[1],16)||0,A[14]=N,A[15]=P,s(v,A),v}function l(C){var _=C.length,v=[1732584193,-271733879,-1732584194,271733878],T,w,A,I,N,P;for(T=64;T<=_;T+=64)s(v,a(C.subarray(T-64,T)));for(C=T-64<_?C.subarray(T-64):new Uint8Array(0),w=C.length,A=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],T=0;T<w;T+=1)A[T>>2]|=C[T]<<(T%4<<3);if(A[T>>2]|=128<<(T%4<<3),T>55)for(s(v,A),T=0;T<16;T+=1)A[T]=0;return I=_*8,I=I.toString(16).match(/(.*?)(.{0,8})$/),N=parseInt(I[2],16),P=parseInt(I[1],16)||0,A[14]=N,A[15]=P,s(v,A),v}function u(C){var _="",v;for(v=0;v<4;v+=1)_+=i[C>>v*8+4&15]+i[C>>v*8&15];return _}function c(C){var _;for(_=0;_<C.length;_+=1)C[_]=u(C[_]);return C.join("")}c(o("hello")),typeof ArrayBuffer<"u"&&!ArrayBuffer.prototype.slice&&(function(){function C(_,v){return _=_|0||0,_<0?Math.max(_+v,0):Math.min(_,v)}ArrayBuffer.prototype.slice=function(_,v){var T=this.byteLength,w=C(_,T),A=T,I,N,P,R;return v!==t&&(A=C(v,T)),w>A?new ArrayBuffer(0):(I=A-w,N=new ArrayBuffer(I),P=new Uint8Array(N),R=new Uint8Array(this,w,I),P.set(R),N)}})();function h(C){return/[\u0080-\uFFFF]/.test(C)&&(C=unescape(encodeURIComponent(C))),C}function f(C,_){var v=C.length,T=new ArrayBuffer(v),w=new Uint8Array(T),A;for(A=0;A<v;A+=1)w[A]=C.charCodeAt(A);return _?w:T}function m(C){return String.fromCharCode.apply(null,new Uint8Array(C))}function S(C,_,v){var T=new Uint8Array(C.byteLength+_.byteLength);return T.set(new Uint8Array(C)),T.set(new Uint8Array(_),C.byteLength),T}function y(C){var _=[],v=C.length,T;for(T=0;T<v-1;T+=2)_.push(parseInt(C.substr(T,2),16));return String.fromCharCode.apply(String,_)}function E(){this.reset()}return E.prototype.append=function(C){return this.appendBinary(h(C)),this},E.prototype.appendBinary=function(C){this._buff+=C,this._length+=C.length;var _=this._buff.length,v;for(v=64;v<=_;v+=64)s(this._hash,n(this._buff.substring(v-64,v)));return this._buff=this._buff.substring(v-64),this},E.prototype.end=function(C){var _=this._buff,v=_.length,T,w=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],A;for(T=0;T<v;T+=1)w[T>>2]|=_.charCodeAt(T)<<(T%4<<3);return this._finish(w,v),A=c(this._hash),C&&(A=y(A)),this.reset(),A},E.prototype.reset=function(){return this._buff="",this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},E.prototype.getState=function(){return{buff:this._buff,length:this._length,hash:this._hash.slice()}},E.prototype.setState=function(C){return this._buff=C.buff,this._length=C.length,this._hash=C.hash,this},E.prototype.destroy=function(){delete this._hash,delete this._buff,delete this._length},E.prototype._finish=function(C,_){var v=_,T,w,A;if(C[v>>2]|=128<<(v%4<<3),v>55)for(s(this._hash,C),v=0;v<16;v+=1)C[v]=0;T=this._length*8,T=T.toString(16).match(/(.*?)(.{0,8})$/),w=parseInt(T[2],16),A=parseInt(T[1],16)||0,C[14]=w,C[15]=A,s(this._hash,C)},E.hash=function(C,_){return E.hashBinary(h(C),_)},E.hashBinary=function(C,_){var v=o(C),T=c(v);return _?y(T):T},E.ArrayBuffer=function(){this.reset()},E.ArrayBuffer.prototype.append=function(C){var _=S(this._buff.buffer,C),v=_.length,T;for(this._length+=C.byteLength,T=64;T<=v;T+=64)s(this._hash,a(_.subarray(T-64,T)));return this._buff=T-64<v?new Uint8Array(_.buffer.slice(T-64)):new Uint8Array(0),this},E.ArrayBuffer.prototype.end=function(C){var _=this._buff,v=_.length,T=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],w,A;for(w=0;w<v;w+=1)T[w>>2]|=_[w]<<(w%4<<3);return this._finish(T,v),A=c(this._hash),C&&(A=y(A)),this.reset(),A},E.ArrayBuffer.prototype.reset=function(){return this._buff=new Uint8Array(0),this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},E.ArrayBuffer.prototype.getState=function(){var C=E.prototype.getState.call(this);return C.buff=m(C.buff),C},E.ArrayBuffer.prototype.setState=function(C){return C.buff=f(C.buff,!0),E.prototype.setState.call(this,C)},E.ArrayBuffer.prototype.destroy=E.prototype.destroy,E.ArrayBuffer.prototype._finish=E.prototype._finish,E.ArrayBuffer.hash=function(C,_){var v=l(new Uint8Array(C)),T=c(v);return _?y(T):T},E}))})(X1);var VM=X1.exports;const XM=File.prototype.slice||File.prototype.mozSlice||File.prototype.webkitSlice;class ag{static create(e,t){new ag(e).create(t)}constructor(e){this.file=e,this.chunkSize=2097152,this.chunkCount=Math.ceil(this.file.size/this.chunkSize),this.chunkIndex=0}create(e){this.callback=e,this.md5Buffer=new VM.ArrayBuffer,this.fileReader=new FileReader,this.fileReader.addEventListener("load",(t=>this.fileReaderDidLoad(t))),this.fileReader.addEventListener("error",(t=>this.fileReaderDidError(t))),this.readNextChunk()}fileReaderDidLoad(e){if(this.md5Buffer.append(e.target.result),!this.readNextChunk()){const t=this.md5Buffer.end(!0),i=btoa(t);this.callback(null,i)}}fileReaderDidError(e){this.callback(`Error reading ${this.file.name}`)}readNextChunk(){if(this.chunkIndex<this.chunkCount||this.chunkIndex==0&&this.chunkCount==0){const e=this.chunkIndex*this.chunkSize,t=Math.min(e+this.chunkSize,this.file.size),i=XM.call(this.file,e,t);return this.fileReader.readAsArrayBuffer(i),this.chunkIndex++,!0}else return!1}}function jM(r){const e=j1(document.head,`meta[name="${r}"]`);if(e)return e.getAttribute("content")}function zM(r,e){typeof r=="string"&&(e=r,r=document);const t=r.querySelectorAll(e);return z1(t)}function j1(r,e){return typeof r=="string"&&(e=r,r=document),r.querySelector(e)}function og(r,e,t={}){const{disabled:i}=r,{bubbles:s,cancelable:n,detail:a}=t,o=document.createEvent("Event");o.initEvent(e,s||!0,n||!0),o.detail=a||{};try{r.disabled=!1,r.dispatchEvent(o)}finally{r.disabled=i}return o}function z1(r){return Array.isArray(r)?r:Array.from?Array.from(r):[].slice.call(r)}class ZM{constructor(e,t,i,s={}){this.file=e,this.attributes={filename:e.name,content_type:e.type||"application/octet-stream",byte_size:e.size,checksum:t},this.xhr=new XMLHttpRequest,this.xhr.open("POST",i,!0),this.xhr.responseType="json",this.xhr.setRequestHeader("Content-Type","application/json"),this.xhr.setRequestHeader("Accept","application/json"),this.xhr.setRequestHeader("X-Requested-With","XMLHttpRequest"),Object.keys(s).forEach((a=>{this.xhr.setRequestHeader(a,s[a])}));const n=jM("csrf-token");n!=null&&this.xhr.setRequestHeader("X-CSRF-Token",n),this.xhr.addEventListener("load",(a=>this.requestDidLoad(a))),this.xhr.addEventListener("error",(a=>this.requestDidError(a)))}get status(){return this.xhr.status}get response(){const{responseType:e,response:t}=this.xhr;return e=="json"?t:JSON.parse(t)}create(e){this.callback=e,this.xhr.send(JSON.stringify({blob:this.attributes}))}requestDidLoad(e){if(this.status>=200&&this.status<300){const{response:t}=this,{direct_upload:i}=t;delete t.direct_upload,this.attributes=t,this.directUploadData=i,this.callback(null,this.toJSON())}else this.requestDidError(e)}requestDidError(e){this.callback(`Error creating Blob for "${this.file.name}". Status: ${this.status}`)}toJSON(){const e={};for(const t in this.attributes)e[t]=this.attributes[t];return e}}class WM{constructor(e){this.blob=e,this.file=e.file;const{url:t,headers:i}=e.directUploadData;this.xhr=new XMLHttpRequest,this.xhr.open("PUT",t,!0),this.xhr.responseType="text";for(const s in i)this.xhr.setRequestHeader(s,i[s]);this.xhr.addEventListener("load",(s=>this.requestDidLoad(s))),this.xhr.addEventListener("error",(s=>this.requestDidError(s)))}create(e){this.callback=e,this.xhr.send(this.file.slice())}requestDidLoad(e){const{status:t,response:i}=this.xhr;t>=200&&t<300?this.callback(null,i):this.requestDidError(e)}requestDidError(e){this.callback(`Error storing "${this.file.name}". Status: ${this.xhr.status}`)}}let HM=0;class Z1{constructor(e,t,i,s={}){this.id=++HM,this.file=e,this.url=t,this.delegate=i,this.customHeaders=s}create(e){ag.create(this.file,((t,i)=>{if(t){e(t);return}const s=new ZM(this.file,i,this.url,this.customHeaders);ZO(this.delegate,"directUploadWillCreateBlobWithXHR",s.xhr),s.create((n=>{if(n)e(n);else{const a=new WM(s);ZO(this.delegate,"directUploadWillStoreFileWithXHR",a.xhr),a.create((o=>{o?e(o):e(null,s.toJSON())}))}}))}))}}function ZO(r,e,...t){if(r&&typeof r[e]=="function")return r[e](...t)}class W1{constructor(e,t){this.input=e,this.file=t,this.directUpload=new Z1(this.file,this.url,this),this.dispatch("initialize")}start(e){const t=document.createElement("input");t.type="hidden",t.name=this.input.name,this.input.insertAdjacentElement("beforebegin",t),this.dispatch("start"),this.directUpload.create(((i,s)=>{i?(t.parentNode.removeChild(t),this.dispatchError(i)):t.value=s.signed_id,this.dispatch("end"),e(i)}))}uploadRequestDidProgress(e){const t=e.loaded/e.total*100;t&&this.dispatch("progress",{progress:t})}get url(){return this.input.getAttribute("data-direct-upload-url")}dispatch(e,t={}){return t.file=this.file,t.id=this.directUpload.id,og(this.input,`direct-upload:${e}`,{detail:t})}dispatchError(e){this.dispatch("error",{error:e}).defaultPrevented||alert(e)}directUploadWillCreateBlobWithXHR(e){this.dispatch("before-blob-request",{xhr:e})}directUploadWillStoreFileWithXHR(e){this.dispatch("before-storage-request",{xhr:e}),e.upload.addEventListener("progress",(t=>this.uploadRequestDidProgress(t)))}}const YM="input[type=file][data-direct-upload-url]:not([disabled])";class H1{constructor(e){this.form=e,this.inputs=zM(e,YM).filter((t=>t.files.length))}start(e){const t=this.createDirectUploadControllers(),i=()=>{const s=t.shift();s?s.start((n=>{n?(e(n),this.dispatch("end")):i()})):(e(),this.dispatch("end"))};this.dispatch("start"),i()}createDirectUploadControllers(){const e=[];return this.inputs.forEach((t=>{z1(t.files).forEach((i=>{const s=new W1(t,i);e.push(s)}))})),e}dispatch(e,t={}){return og(this.form,`direct-uploads:${e}`,{detail:t})}}const Ld="data-direct-uploads-processing",dp=new WeakMap;let WO=!1;function lg(){WO||(WO=!0,document.addEventListener("click",GM,!0),document.addEventListener("submit",KM,!0),document.addEventListener("ajax:before",JM))}function GM(r){const e=r.target.closest("button, input");e&&e.type==="submit"&&e.form&&dp.set(e.form,e)}function KM(r){Y1(r)}function JM(r){r.target.tagName=="FORM"&&Y1(r)}function Y1(r){const e=r.target;if(e.hasAttribute(Ld)){r.preventDefault();return}const t=new H1(e),{inputs:i}=t;i.length&&(r.preventDefault(),e.setAttribute(Ld,""),i.forEach(tI),t.start((s=>{e.removeAttribute(Ld),s?i.forEach(iI):eI(e)})))}function eI(r){let e=dp.get(r)||j1(r,"input[type=submit], button[type=submit]");if(e){const{disabled:t}=e;e.disabled=!1,e.focus(),e.click(),e.disabled=t}else e=document.createElement("input"),e.type="submit",e.style.display="none",r.appendChild(e),e.click(),r.removeChild(e);dp.delete(r)}function tI(r){r.disabled=!0}function iI(r){r.disabled=!1}function rI(){window.ActiveStorage&&lg()}setTimeout(rI,1);const sI=Object.freeze(Object.defineProperty({__proto__:null,DirectUpload:Z1,DirectUploadController:W1,DirectUploadsController:H1,dispatchEvent:og,start:lg},Symbol.toStringTag,{value:"Module"}));var Qc=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function jl(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}function nI(r){if(Object.prototype.hasOwnProperty.call(r,"__esModule"))return r;var e=r.default;if(typeof e=="function"){var t=function i(){var s=!1;try{s=this instanceof i}catch{}return s?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(r).forEach(function(i){var s=Object.getOwnPropertyDescriptor(r,i);Object.defineProperty(t,i,s.get?s:{enumerable:!0,get:function(){return r[i]}})}),t}var Qd,HO;function $h(){if(HO)return Qd;HO=1;var r;return typeof window<"u"?r=window:typeof Qc<"u"?r=Qc:typeof self<"u"?r=self:r={},Qd=r,Qd}var aI=$h();const U=jl(aI),oI={},lI=Object.freeze(Object.defineProperty({__proto__:null,default:oI},Symbol.toStringTag,{value:"Module"})),uI=nI(lI);var $d,YO;function G1(){if(YO)return $d;YO=1;var r=typeof Qc<"u"?Qc:typeof window<"u"?window:{},e=uI,t;return typeof document<"u"?t=document:(t=r["__GLOBAL_DOCUMENT_CACHE@4"],t||(t=r["__GLOBAL_DOCUMENT_CACHE@4"]=e)),$d=t,$d}var cI=G1();const ue=jl(cI);var Lu={exports:{}},Bd={exports:{}},GO;function hI(){return GO||(GO=1,(function(r){function e(){return r.exports=e=Object.assign?Object.assign.bind():function(t){for(var i=1;i<arguments.length;i++){var s=arguments[i];for(var n in s)({}).hasOwnProperty.call(s,n)&&(t[n]=s[n])}return t},r.exports.__esModule=!0,r.exports.default=r.exports,e.apply(null,arguments)}r.exports=e,r.exports.__esModule=!0,r.exports.default=r.exports})(Bd)),Bd.exports}var Nd,KO;function dI(){if(KO)return Nd;KO=1,Nd=e;var r=Object.prototype.toString;function e(t){if(!t)return!1;var i=r.call(t);return i==="[object Function]"||typeof t=="function"&&i!=="[object RegExp]"||typeof window<"u"&&(t===window.setTimeout||t===window.alert||t===window.confirm||t===window.prompt)}return Nd}var Fd,JO;function fI(){if(JO)return Fd;JO=1;function r(s,n){var a=typeof Symbol<"u"&&s[Symbol.iterator]||s["@@iterator"];if(a)return(a=a.call(s)).next.bind(a);if(Array.isArray(s)||(a=e(s))||n){a&&(s=a);var o=0;return function(){return o>=s.length?{done:!0}:{done:!1,value:s[o++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function e(s,n){if(s){if(typeof s=="string")return t(s,n);var a=Object.prototype.toString.call(s).slice(8,-1);if(a==="Object"&&s.constructor&&(a=s.constructor.name),a==="Map"||a==="Set")return Array.from(s);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return t(s,n)}}function t(s,n){(n==null||n>s.length)&&(n=s.length);for(var a=0,o=new Array(n);a<n;a++)o[a]=s[a];return o}var i=(function(){function s(){this.typeToInterceptorsMap_=new Map,this.enabled_=!1}var n=s.prototype;return n.getIsEnabled=function(){return this.enabled_},n.enable=function(){this.enabled_=!0},n.disable=function(){this.enabled_=!1},n.reset=function(){this.typeToInterceptorsMap_=new Map,this.enabled_=!1},n.addInterceptor=function(o,l){this.typeToInterceptorsMap_.has(o)||this.typeToInterceptorsMap_.set(o,new Set);var u=this.typeToInterceptorsMap_.get(o);return u.has(l)?!1:(u.add(l),!0)},n.removeInterceptor=function(o,l){var u=this.typeToInterceptorsMap_.get(o);return u&&u.has(l)?(u.delete(l),!0):!1},n.clearInterceptorsByType=function(o){var l=this.typeToInterceptorsMap_.get(o);return l?(this.typeToInterceptorsMap_.delete(o),this.typeToInterceptorsMap_.set(o,new Set),!0):!1},n.clear=function(){return this.typeToInterceptorsMap_.size?(this.typeToInterceptorsMap_=new Map,!0):!1},n.getForType=function(o){return this.typeToInterceptorsMap_.get(o)||new Set},n.execute=function(o,l){for(var u=this.getForType(o),c=r(u),h;!(h=c()).done;){var f=h.value;try{l=f(l)}catch{}}return l},s})();return Fd=i,Fd}var Ud,ey;function pI(){if(ey)return Ud;ey=1;var r=(function(){function t(){this.maxAttempts_=1,this.delayFactor_=.1,this.fuzzFactor_=.1,this.initialDelay_=1e3,this.enabled_=!1}var i=t.prototype;return i.getIsEnabled=function(){return this.enabled_},i.enable=function(){this.enabled_=!0},i.disable=function(){this.enabled_=!1},i.reset=function(){this.maxAttempts_=1,this.delayFactor_=.1,this.fuzzFactor_=.1,this.initialDelay_=1e3,this.enabled_=!1},i.getMaxAttempts=function(){return this.maxAttempts_},i.setMaxAttempts=function(n){this.maxAttempts_=n},i.getDelayFactor=function(){return this.delayFactor_},i.setDelayFactor=function(n){this.delayFactor_=n},i.getFuzzFactor=function(){return this.fuzzFactor_},i.setFuzzFactor=function(n){this.fuzzFactor_=n},i.getInitialDelay=function(){return this.initialDelay_},i.setInitialDelay=function(n){this.initialDelay_=n},i.createRetry=function(n){var a=n===void 0?{}:n,o=a.maxAttempts,l=a.delayFactor,u=a.fuzzFactor,c=a.initialDelay;return new e({maxAttempts:o||this.maxAttempts_,delayFactor:l||this.delayFactor_,fuzzFactor:u||this.fuzzFactor_,initialDelay:c||this.initialDelay_})},t})(),e=(function(){function t(s){this.maxAttempts_=s.maxAttempts,this.delayFactor_=s.delayFactor,this.fuzzFactor_=s.fuzzFactor,this.currentDelay_=s.initialDelay,this.currentAttempt_=1}var i=t.prototype;return i.moveToNextAttempt=function(){this.currentAttempt_++;var n=this.currentDelay_*this.delayFactor_;this.currentDelay_=this.currentDelay_+n},i.shouldRetry=function(){return this.currentAttempt_<this.maxAttempts_},i.getCurrentDelay=function(){return this.currentDelay_},i.getCurrentMinPossibleDelay=function(){return(1-this.fuzzFactor_)*this.currentDelay_},i.getCurrentMaxPossibleDelay=function(){return(1+this.fuzzFactor_)*this.currentDelay_},i.getCurrentFuzzedDelay=function(){var n=this.getCurrentMinPossibleDelay(),a=this.getCurrentMaxPossibleDelay();return n+Math.random()*(a-n)},t})();return Ud=r,Ud}var qd,ty;function mI(){if(ty)return qd;ty=1;var r=$h(),e=function(s,n){return n===void 0&&(n=!1),function(a,o,l){if(a){s(a);return}if(o.statusCode>=400&&o.statusCode<=599){var u=l;if(n)if(r.TextDecoder){var c=t(o.headers&&o.headers["content-type"]);try{u=new TextDecoder(c).decode(l)}catch{}}else u=String.fromCharCode.apply(null,new Uint8Array(l));s({cause:u});return}s(null,l)}};function t(i){return i===void 0&&(i=""),i.toLowerCase().split(";").reduce(function(s,n){var a=n.split("="),o=a[0],l=a[1];return o.trim()==="charset"?l.trim():s},"utf-8")}return qd=e,qd}var iy;function gI(){if(iy)return Lu.exports;iy=1;var r=$h(),e=hI(),t=dI(),i=fI(),s=pI();u.httpHandler=mI(),u.requestInterceptorsStorage=new i,u.responseInterceptorsStorage=new i,u.retryManager=new s;/**
 * @license
 * slighly modified parse-headers 2.0.2 <https://github.com/kesla/parse-headers/>
 * Copyright (c) 2014 David Björklund
 * Available under the MIT license
 * <https://github.com/kesla/parse-headers/blob/master/LICENCE>
 */var n=function(S){var y={};return S&&S.trim().split(`
`).forEach(function(E){var C=E.indexOf(":"),_=E.slice(0,C).trim().toLowerCase(),v=E.slice(C+1).trim();typeof y[_]>"u"?y[_]=v:Array.isArray(y[_])?y[_].push(v):y[_]=[y[_],v]}),y};Lu.exports=u,Lu.exports.default=u,u.XMLHttpRequest=r.XMLHttpRequest||f,u.XDomainRequest="withCredentials"in new u.XMLHttpRequest?u.XMLHttpRequest:r.XDomainRequest,a(["get","put","post","patch","head","delete"],function(m){u[m==="delete"?"del":m]=function(S,y,E){return y=l(S,y,E),y.method=m.toUpperCase(),c(y)}});function a(m,S){for(var y=0;y<m.length;y++)S(m[y])}function o(m){for(var S in m)if(m.hasOwnProperty(S))return!1;return!0}function l(m,S,y){var E=m;return t(S)?(y=S,typeof m=="string"&&(E={uri:m})):E=e({},S,{uri:m}),E.callback=y,E}function u(m,S,y){return S=l(m,S,y),c(S)}function c(m){if(typeof m.callback>"u")throw new Error("callback argument missing");if(m.requestType&&u.requestInterceptorsStorage.getIsEnabled()){var S={uri:m.uri||m.url,headers:m.headers||{},body:m.body,metadata:m.metadata||{},retry:m.retry,timeout:m.timeout},y=u.requestInterceptorsStorage.execute(m.requestType,S);m.uri=y.uri,m.headers=y.headers,m.body=y.body,m.metadata=y.metadata,m.retry=y.retry,m.timeout=y.timeout}var E=!1,C=function(re,J,ne){E||(E=!0,m.callback(re,J,ne))};function _(){A.readyState===4&&!u.responseInterceptorsStorage.getIsEnabled()&&setTimeout(w,0)}function v(){var G=void 0;if(A.response?G=A.response:G=A.responseText||h(A),Y)try{G=JSON.parse(G)}catch{}return G}function T(G){if(clearTimeout(te),clearTimeout(m.retryTimeout),G instanceof Error||(G=new Error(""+(G||"Unknown XMLHttpRequest Error"))),G.statusCode=0,!N&&u.retryManager.getIsEnabled()&&m.retry&&m.retry.shouldRetry()){m.retryTimeout=setTimeout(function(){m.retry.moveToNextAttempt(),m.xhr=A,c(m)},m.retry.getCurrentFuzzedDelay());return}if(m.requestType&&u.responseInterceptorsStorage.getIsEnabled()){var re={headers:le.headers||{},body:le.body,responseUrl:A.responseURL,responseType:A.responseType},J=u.responseInterceptorsStorage.execute(m.requestType,re);le.body=J.body,le.headers=J.headers}return C(G,le)}function w(){if(!N){var G;clearTimeout(te),clearTimeout(m.retryTimeout),m.useXDR&&A.status===void 0?G=200:G=A.status===1223?204:A.status;var re=le,J=null;if(G!==0?(re={body:v(),statusCode:G,method:R,headers:{},url:P,rawRequest:A},A.getAllResponseHeaders&&(re.headers=n(A.getAllResponseHeaders()))):J=new Error("Internal XMLHttpRequest Error"),m.requestType&&u.responseInterceptorsStorage.getIsEnabled()){var ne={headers:re.headers||{},body:re.body,responseUrl:A.responseURL,responseType:A.responseType},ae=u.responseInterceptorsStorage.execute(m.requestType,ne);re.body=ae.body,re.headers=ae.headers}return C(J,re,re.body)}}var A=m.xhr||null;A||(m.cors||m.useXDR?A=new u.XDomainRequest:A=new u.XMLHttpRequest);var I,N,P=A.url=m.uri||m.url,R=A.method=m.method||"GET",X=m.body||m.data,j=A.headers=m.headers||{},Z=!!m.sync,Y=!1,te,le={body:void 0,headers:{},statusCode:0,method:R,url:P,rawRequest:A};if("json"in m&&m.json!==!1&&(Y=!0,j.accept||j.Accept||(j.Accept="application/json"),R!=="GET"&&R!=="HEAD"&&(j["content-type"]||j["Content-Type"]||(j["Content-Type"]="application/json"),X=JSON.stringify(m.json===!0?X:m.json))),A.onreadystatechange=_,A.onload=w,A.onerror=T,A.onprogress=function(){},A.onabort=function(){N=!0,clearTimeout(m.retryTimeout)},A.ontimeout=T,A.open(R,P,!Z,m.username,m.password),Z||(A.withCredentials=!!m.withCredentials),!Z&&m.timeout>0&&(te=setTimeout(function(){if(!N){N=!0,A.abort("timeout");var G=new Error("XMLHttpRequest timeout");G.code="ETIMEDOUT",T(G)}},m.timeout)),A.setRequestHeader)for(I in j)j.hasOwnProperty(I)&&A.setRequestHeader(I,j[I]);else if(m.headers&&!o(m.headers))throw new Error("Headers cannot be set on an XDomainRequest object");return"responseType"in m&&(A.responseType=m.responseType),"beforeSend"in m&&typeof m.beforeSend=="function"&&m.beforeSend(A),A.send(X||null),A}function h(m){try{if(m.responseType==="document")return m.responseXML;var S=m.responseXML&&m.responseXML.documentElement.nodeName==="parsererror";if(m.responseType===""&&!S)return m.responseXML}catch{}return null}function f(){}return Lu.exports}var OI=gI();const K1=jl(OI);var Vd={exports:{}},Xd,ry;function yI(){if(ry)return Xd;ry=1;var r=G1(),e=Object.create||(function(){function P(){}return function(R){if(arguments.length!==1)throw new Error("Object.create shim only accepts one parameter.");return P.prototype=R,new P}})();function t(P,R){this.name="ParsingError",this.code=P.code,this.message=R||P.message}t.prototype=e(Error.prototype),t.prototype.constructor=t,t.Errors={BadSignature:{code:0,message:"Malformed WebVTT signature."},BadTimeStamp:{code:1,message:"Malformed time stamp."}};function i(P){function R(j,Z,Y,te){return(j|0)*3600+(Z|0)*60+(Y|0)+(te|0)/1e3}var X=P.match(/^(\d+):(\d{1,2})(:\d{1,2})?\.(\d{3})/);return X?X[3]?R(X[1],X[2],X[3].replace(":",""),X[4]):X[1]>59?R(X[1],X[2],0,X[4]):R(0,X[1],X[2],X[4]):null}function s(){this.values=e(null)}s.prototype={set:function(P,R){!this.get(P)&&R!==""&&(this.values[P]=R)},get:function(P,R,X){return X?this.has(P)?this.values[P]:R[X]:this.has(P)?this.values[P]:R},has:function(P){return P in this.values},alt:function(P,R,X){for(var j=0;j<X.length;++j)if(R===X[j]){this.set(P,R);break}},integer:function(P,R){/^-?\d+$/.test(R)&&this.set(P,parseInt(R,10))},percent:function(P,R){return R.match(/^([\d]{1,3})(\.[\d]*)?%$/)&&(R=parseFloat(R),R>=0&&R<=100)?(this.set(P,R),!0):!1}};function n(P,R,X,j){var Z=j?P.split(j):[P];for(var Y in Z)if(typeof Z[Y]=="string"){var te=Z[Y].split(X);if(te.length===2){var le=te[0].trim(),G=te[1].trim();R(le,G)}}}function a(P,R,X){var j=P;function Z(){var le=i(P);if(le===null)throw new t(t.Errors.BadTimeStamp,"Malformed timestamp: "+j);return P=P.replace(/^[^\sa-zA-Z-]+/,""),le}function Y(le,G){var re=new s;n(le,function(J,ne){switch(J){case"region":for(var ae=X.length-1;ae>=0;ae--)if(X[ae].id===ne){re.set(J,X[ae].region);break}break;case"vertical":re.alt(J,ne,["rl","lr"]);break;case"line":var ve=ne.split(","),xe=ve[0];re.integer(J,xe),re.percent(J,xe)&&re.set("snapToLines",!1),re.alt(J,xe,["auto"]),ve.length===2&&re.alt("lineAlign",ve[1],["start","center","end"]);break;case"position":ve=ne.split(","),re.percent(J,ve[0]),ve.length===2&&re.alt("positionAlign",ve[1],["start","center","end"]);break;case"size":re.percent(J,ne);break;case"align":re.alt(J,ne,["start","center","end","left","right"]);break}},/:/,/\s/),G.region=re.get("region",null),G.vertical=re.get("vertical","");try{G.line=re.get("line","auto")}catch{}G.lineAlign=re.get("lineAlign","start"),G.snapToLines=re.get("snapToLines",!0),G.size=re.get("size",100);try{G.align=re.get("align","center")}catch{G.align=re.get("align","middle")}try{G.position=re.get("position","auto")}catch{G.position=re.get("position",{start:0,left:0,center:50,middle:50,end:100,right:100},G.align)}G.positionAlign=re.get("positionAlign",{start:"start",left:"start",center:"center",middle:"center",end:"end",right:"end"},G.align)}function te(){P=P.replace(/^\s+/,"")}if(te(),R.startTime=Z(),te(),P.substr(0,3)!=="-->")throw new t(t.Errors.BadTimeStamp,"Malformed time stamp (time stamps must be separated by '-->'): "+j);P=P.substr(3),te(),R.endTime=Z(),te(),Y(P,R)}var o=r.createElement&&r.createElement("textarea"),l={c:"span",i:"i",b:"b",u:"u",ruby:"ruby",rt:"rt",v:"span",lang:"span"},u={white:"rgba(255,255,255,1)",lime:"rgba(0,255,0,1)",cyan:"rgba(0,255,255,1)",red:"rgba(255,0,0,1)",yellow:"rgba(255,255,0,1)",magenta:"rgba(255,0,255,1)",blue:"rgba(0,0,255,1)",black:"rgba(0,0,0,1)"},c={v:"title",lang:"lang"},h={rt:"ruby"};function f(P,R){function X(){if(!R)return null;function xe(Se){return R=R.substr(Se.length),Se}var Pe=R.match(/^([^<]*)(<[^>]*>?)?/);return xe(Pe[1]?Pe[1]:Pe[2])}function j(xe){return o.innerHTML=xe,xe=o.textContent,o.textContent="",xe}function Z(xe,Pe){return!h[Pe.localName]||h[Pe.localName]===xe.localName}function Y(xe,Pe){var Se=l[xe];if(!Se)return null;var at=P.document.createElement(Se),ft=c[xe];return ft&&Pe&&(at[ft]=Pe.trim()),at}for(var te=P.document.createElement("div"),le=te,G,re=[];(G=X())!==null;){if(G[0]==="<"){if(G[1]==="/"){re.length&&re[re.length-1]===G.substr(2).replace(">","")&&(re.pop(),le=le.parentNode);continue}var J=i(G.substr(1,G.length-2)),ne;if(J){ne=P.document.createProcessingInstruction("timestamp",J),le.appendChild(ne);continue}var ae=G.match(/^<([^.\s/0-9>]+)(\.[^\s\\>]+)?([^>\\]+)?(\\?)>?$/);if(!ae||(ne=Y(ae[1],ae[3]),!ne)||!Z(le,ne))continue;if(ae[2]){var ve=ae[2].split(".");ve.forEach(function(xe){var Pe=/^bg_/.test(xe),Se=Pe?xe.slice(3):xe;if(u.hasOwnProperty(Se)){var at=Pe?"background-color":"color",ft=u[Se];ne.style[at]=ft}}),ne.className=ve.join(" ")}re.push(ae[1]),le.appendChild(ne),le=ne;continue}le.appendChild(P.document.createTextNode(j(G)))}return te}var m=[[1470,1470],[1472,1472],[1475,1475],[1478,1478],[1488,1514],[1520,1524],[1544,1544],[1547,1547],[1549,1549],[1563,1563],[1566,1610],[1645,1647],[1649,1749],[1765,1766],[1774,1775],[1786,1805],[1807,1808],[1810,1839],[1869,1957],[1969,1969],[1984,2026],[2036,2037],[2042,2042],[2048,2069],[2074,2074],[2084,2084],[2088,2088],[2096,2110],[2112,2136],[2142,2142],[2208,2208],[2210,2220],[8207,8207],[64285,64285],[64287,64296],[64298,64310],[64312,64316],[64318,64318],[64320,64321],[64323,64324],[64326,64449],[64467,64829],[64848,64911],[64914,64967],[65008,65020],[65136,65140],[65142,65276],[67584,67589],[67592,67592],[67594,67637],[67639,67640],[67644,67644],[67647,67669],[67671,67679],[67840,67867],[67872,67897],[67903,67903],[67968,68023],[68030,68031],[68096,68096],[68112,68115],[68117,68119],[68121,68147],[68160,68167],[68176,68184],[68192,68223],[68352,68405],[68416,68437],[68440,68466],[68472,68479],[68608,68680],[126464,126467],[126469,126495],[126497,126498],[126500,126500],[126503,126503],[126505,126514],[126516,126519],[126521,126521],[126523,126523],[126530,126530],[126535,126535],[126537,126537],[126539,126539],[126541,126543],[126545,126546],[126548,126548],[126551,126551],[126553,126553],[126555,126555],[126557,126557],[126559,126559],[126561,126562],[126564,126564],[126567,126570],[126572,126578],[126580,126583],[126585,126588],[126590,126590],[126592,126601],[126603,126619],[126625,126627],[126629,126633],[126635,126651],[1114109,1114109]];function S(P){for(var R=0;R<m.length;R++){var X=m[R];if(P>=X[0]&&P<=X[1])return!0}return!1}function y(P){var R=[],X="",j;if(!P||!P.childNodes)return"ltr";function Z(le,G){for(var re=G.childNodes.length-1;re>=0;re--)le.push(G.childNodes[re])}function Y(le){if(!le||!le.length)return null;var G=le.pop(),re=G.textContent||G.innerText;if(re){var J=re.match(/^.*(\n|\r)/);return J?(le.length=0,J[0]):re}if(G.tagName==="ruby")return Y(le);if(G.childNodes)return Z(le,G),Y(le)}for(Z(R,P);X=Y(R);)for(var te=0;te<X.length;te++)if(j=X.charCodeAt(te),S(j))return"rtl";return"ltr"}function E(P){if(typeof P.line=="number"&&(P.snapToLines||P.line>=0&&P.line<=100))return P.line;if(!P.track||!P.track.textTrackList||!P.track.textTrackList.mediaElement)return-1;for(var R=P.track,X=R.textTrackList,j=0,Z=0;Z<X.length&&X[Z]!==R;Z++)X[Z].mode==="showing"&&j++;return++j*-1}function C(){}C.prototype.applyStyles=function(P,R){R=R||this.div;for(var X in P)P.hasOwnProperty(X)&&(R.style[X]=P[X])},C.prototype.formatStyle=function(P,R){return P===0?0:P+R};function _(P,R,X){C.call(this),this.cue=R,this.cueDiv=f(P,R.text);var j={color:"rgba(255, 255, 255, 1)",backgroundColor:"rgba(0, 0, 0, 0.8)",position:"relative",left:0,right:0,top:0,bottom:0,display:"inline",writingMode:R.vertical===""?"horizontal-tb":R.vertical==="lr"?"vertical-lr":"vertical-rl",unicodeBidi:"plaintext"};this.applyStyles(j,this.cueDiv),this.div=P.document.createElement("div"),j={direction:y(this.cueDiv),writingMode:R.vertical===""?"horizontal-tb":R.vertical==="lr"?"vertical-lr":"vertical-rl",unicodeBidi:"plaintext",textAlign:R.align==="middle"?"center":R.align,font:X.font,whiteSpace:"pre-line",position:"absolute"},this.applyStyles(j),this.div.appendChild(this.cueDiv);var Z=0;switch(R.positionAlign){case"start":case"line-left":Z=R.position;break;case"center":Z=R.position-R.size/2;break;case"end":case"line-right":Z=R.position-R.size;break}R.vertical===""?this.applyStyles({left:this.formatStyle(Z,"%"),width:this.formatStyle(R.size,"%")}):this.applyStyles({top:this.formatStyle(Z,"%"),height:this.formatStyle(R.size,"%")}),this.move=function(Y){this.applyStyles({top:this.formatStyle(Y.top,"px"),bottom:this.formatStyle(Y.bottom,"px"),left:this.formatStyle(Y.left,"px"),right:this.formatStyle(Y.right,"px"),height:this.formatStyle(Y.height,"px"),width:this.formatStyle(Y.width,"px")})}}_.prototype=e(C.prototype),_.prototype.constructor=_;function v(P){var R,X,j,Z;if(P.div){X=P.div.offsetHeight,j=P.div.offsetWidth,Z=P.div.offsetTop;var Y=(Y=P.div.childNodes)&&(Y=Y[0])&&Y.getClientRects&&Y.getClientRects();P=P.div.getBoundingClientRect(),R=Y?Math.max(Y[0]&&Y[0].height||0,P.height/Y.length):0}this.left=P.left,this.right=P.right,this.top=P.top||Z,this.height=P.height||X,this.bottom=P.bottom||Z+(P.height||X),this.width=P.width||j,this.lineHeight=R!==void 0?R:P.lineHeight}v.prototype.move=function(P,R){switch(R=R!==void 0?R:this.lineHeight,P){case"+x":this.left+=R,this.right+=R;break;case"-x":this.left-=R,this.right-=R;break;case"+y":this.top+=R,this.bottom+=R;break;case"-y":this.top-=R,this.bottom-=R;break}},v.prototype.overlaps=function(P){return this.left<P.right&&this.right>P.left&&this.top<P.bottom&&this.bottom>P.top},v.prototype.overlapsAny=function(P){for(var R=0;R<P.length;R++)if(this.overlaps(P[R]))return!0;return!1},v.prototype.within=function(P){return this.top>=P.top&&this.bottom<=P.bottom&&this.left>=P.left&&this.right<=P.right},v.prototype.overlapsOppositeAxis=function(P,R){switch(R){case"+x":return this.left<P.left;case"-x":return this.right>P.right;case"+y":return this.top<P.top;case"-y":return this.bottom>P.bottom}},v.prototype.intersectPercentage=function(P){var R=Math.max(0,Math.min(this.right,P.right)-Math.max(this.left,P.left)),X=Math.max(0,Math.min(this.bottom,P.bottom)-Math.max(this.top,P.top)),j=R*X;return j/(this.height*this.width)},v.prototype.toCSSCompatValues=function(P){return{top:this.top-P.top,bottom:P.bottom-this.bottom,left:this.left-P.left,right:P.right-this.right,height:this.height,width:this.width}},v.getSimpleBoxPosition=function(P){var R=P.div?P.div.offsetHeight:P.tagName?P.offsetHeight:0,X=P.div?P.div.offsetWidth:P.tagName?P.offsetWidth:0,j=P.div?P.div.offsetTop:P.tagName?P.offsetTop:0;P=P.div?P.div.getBoundingClientRect():P.tagName?P.getBoundingClientRect():P;var Z={left:P.left,right:P.right,top:P.top||j,height:P.height||R,bottom:P.bottom||j+(P.height||R),width:P.width||X};return Z};function T(P,R,X,j){function Z(Se,at){for(var ft,Ge=new v(Se),_t=1,yi=0;yi<at.length;yi++){for(;Se.overlapsOppositeAxis(X,at[yi])||Se.within(X)&&Se.overlapsAny(j);)Se.move(at[yi]);if(Se.within(X))return Se;var Pt=Se.intersectPercentage(X);_t>Pt&&(ft=new v(Se),_t=Pt),Se=new v(Ge)}return ft||Ge}var Y=new v(R),te=R.cue,le=E(te),G=[];if(te.snapToLines){var re;switch(te.vertical){case"":G=["+y","-y"],re="height";break;case"rl":G=["+x","-x"],re="width";break;case"lr":G=["-x","+x"],re="width";break}var J=Y.lineHeight,ne=J*Math.round(le),ae=X[re]+J,ve=G[0];Math.abs(ne)>ae&&(ne=ne<0?-1:1,ne*=Math.ceil(ae/J)*J),le<0&&(ne+=te.vertical===""?X.height:X.width,G=G.reverse()),Y.move(ve,ne)}else{var xe=Y.lineHeight/X.height*100;switch(te.lineAlign){case"center":le-=xe/2;break;case"end":le-=xe;break}switch(te.vertical){case"":R.applyStyles({top:R.formatStyle(le,"%")});break;case"rl":R.applyStyles({left:R.formatStyle(le,"%")});break;case"lr":R.applyStyles({right:R.formatStyle(le,"%")});break}G=["+y","-x","+x","-y"],Y=new v(R)}var Pe=Z(Y,G);R.move(Pe.toCSSCompatValues(X))}function w(){}w.StringDecoder=function(){return{decode:function(P){if(!P)return"";if(typeof P!="string")throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(P))}}},w.convertCueToDOMTree=function(P,R){return!P||!R?null:f(P,R)};var A=.05,I="sans-serif",N="1.5%";return w.processCues=function(P,R,X){if(!P||!R||!X)return null;for(;X.firstChild;)X.removeChild(X.firstChild);var j=P.document.createElement("div");j.style.position="absolute",j.style.left="0",j.style.right="0",j.style.top="0",j.style.bottom="0",j.style.margin=N,X.appendChild(j);function Z(J){for(var ne=0;ne<J.length;ne++)if(J[ne].hasBeenReset||!J[ne].displayState)return!0;return!1}if(!Z(R)){for(var Y=0;Y<R.length;Y++)j.appendChild(R[Y].displayState);return}var te=[],le=v.getSimpleBoxPosition(j),G=Math.round(le.height*A*100)/100,re={font:G+"px "+I};(function(){for(var J,ne,ae=0;ae<R.length;ae++)ne=R[ae],J=new _(P,ne,re),j.appendChild(J.div),T(P,J,le,te),ne.displayState=J.div,te.push(v.getSimpleBoxPosition(J))})()},w.Parser=function(P,R,X){X||(X=R,R={}),R||(R={}),this.window=P,this.vttjs=R,this.state="INITIAL",this.buffer="",this.decoder=X||new TextDecoder("utf8"),this.regionList=[]},w.Parser.prototype={reportOrThrowError:function(P){if(P instanceof t)this.onparsingerror&&this.onparsingerror(P);else throw P},parse:function(P){var R=this;P&&(R.buffer+=R.decoder.decode(P,{stream:!0}));function X(){for(var J=R.buffer,ne=0;ne<J.length&&J[ne]!=="\r"&&J[ne]!==`
`;)++ne;var ae=J.substr(0,ne);return J[ne]==="\r"&&++ne,J[ne]===`
`&&++ne,R.buffer=J.substr(ne),ae}function j(J){var ne=new s;if(n(J,function(ve,xe){switch(ve){case"id":ne.set(ve,xe);break;case"width":ne.percent(ve,xe);break;case"lines":ne.integer(ve,xe);break;case"regionanchor":case"viewportanchor":var Pe=xe.split(",");if(Pe.length!==2)break;var Se=new s;if(Se.percent("x",Pe[0]),Se.percent("y",Pe[1]),!Se.has("x")||!Se.has("y"))break;ne.set(ve+"X",Se.get("x")),ne.set(ve+"Y",Se.get("y"));break;case"scroll":ne.alt(ve,xe,["up"]);break}},/=/,/\s/),ne.has("id")){var ae=new(R.vttjs.VTTRegion||R.window.VTTRegion);ae.width=ne.get("width",100),ae.lines=ne.get("lines",3),ae.regionAnchorX=ne.get("regionanchorX",0),ae.regionAnchorY=ne.get("regionanchorY",100),ae.viewportAnchorX=ne.get("viewportanchorX",0),ae.viewportAnchorY=ne.get("viewportanchorY",100),ae.scroll=ne.get("scroll",""),R.onregion&&R.onregion(ae),R.regionList.push({id:ne.get("id"),region:ae})}}function Z(J){var ne=new s;n(J,function(ae,ve){switch(ae){case"MPEGT":ne.integer(ae+"S",ve);break;case"LOCA":ne.set(ae+"L",i(ve));break}},/[^\d]:/,/,/),R.ontimestampmap&&R.ontimestampmap({MPEGTS:ne.get("MPEGTS"),LOCAL:ne.get("LOCAL")})}function Y(J){J.match(/X-TIMESTAMP-MAP/)?n(J,function(ne,ae){switch(ne){case"X-TIMESTAMP-MAP":Z(ae);break}},/=/):n(J,function(ne,ae){switch(ne){case"Region":j(ae);break}},/:/)}try{var te;if(R.state==="INITIAL"){if(!/\r\n|\n/.test(R.buffer))return this;te=X();var le=te.match(/^WEBVTT([ \t].*)?$/);if(!le||!le[0])throw new t(t.Errors.BadSignature);R.state="HEADER"}for(var G=!1;R.buffer;){if(!/\r\n|\n/.test(R.buffer))return this;switch(G?G=!1:te=X(),R.state){case"HEADER":/:/.test(te)?Y(te):te||(R.state="ID");continue;case"NOTE":te||(R.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(te)){R.state="NOTE";break}if(!te)continue;R.cue=new(R.vttjs.VTTCue||R.window.VTTCue)(0,0,"");try{R.cue.align="center"}catch{R.cue.align="middle"}if(R.state="CUE",te.indexOf("-->")===-1){R.cue.id=te;continue}case"CUE":try{a(te,R.cue,R.regionList)}catch(J){R.reportOrThrowError(J),R.cue=null,R.state="BADCUE";continue}R.state="CUETEXT";continue;case"CUETEXT":var re=te.indexOf("-->")!==-1;if(!te||re&&(G=!0)){R.oncue&&R.oncue(R.cue),R.cue=null,R.state="ID";continue}R.cue.text&&(R.cue.text+=`
`),R.cue.text+=te.replace(/\u2028/g,`
`).replace(/u2029/g,`
`);continue;case"BADCUE":te||(R.state="ID");continue}}}catch(J){R.reportOrThrowError(J),R.state==="CUETEXT"&&R.cue&&R.oncue&&R.oncue(R.cue),R.cue=null,R.state=R.state==="INITIAL"?"BADWEBVTT":"BADCUE"}return this},flush:function(){var P=this;try{if(P.buffer+=P.decoder.decode(),(P.cue||P.state==="HEADER")&&(P.buffer+=`

`,P.parse()),P.state==="INITIAL")throw new t(t.Errors.BadSignature)}catch(R){P.reportOrThrowError(R)}return P.onflush&&P.onflush(),this}},Xd=w,Xd}var jd,sy;function bI(){if(sy)return jd;sy=1;var r="auto",e={"":1,lr:1,rl:1},t={start:1,center:1,end:1,left:1,right:1,auto:1,"line-left":1,"line-right":1};function i(a){if(typeof a!="string")return!1;var o=e[a.toLowerCase()];return o?a.toLowerCase():!1}function s(a){if(typeof a!="string")return!1;var o=t[a.toLowerCase()];return o?a.toLowerCase():!1}function n(a,o,l){this.hasBeenReset=!1;var u="",c=!1,h=a,f=o,m=l,S=null,y="",E=!0,C="auto",_="start",v="auto",T="auto",w=100,A="center";Object.defineProperties(this,{id:{enumerable:!0,get:function(){return u},set:function(I){u=""+I}},pauseOnExit:{enumerable:!0,get:function(){return c},set:function(I){c=!!I}},startTime:{enumerable:!0,get:function(){return h},set:function(I){if(typeof I!="number")throw new TypeError("Start time must be set to a number.");h=I,this.hasBeenReset=!0}},endTime:{enumerable:!0,get:function(){return f},set:function(I){if(typeof I!="number")throw new TypeError("End time must be set to a number.");f=I,this.hasBeenReset=!0}},text:{enumerable:!0,get:function(){return m},set:function(I){m=""+I,this.hasBeenReset=!0}},region:{enumerable:!0,get:function(){return S},set:function(I){S=I,this.hasBeenReset=!0}},vertical:{enumerable:!0,get:function(){return y},set:function(I){var N=i(I);if(N===!1)throw new SyntaxError("Vertical: an invalid or illegal direction string was specified.");y=N,this.hasBeenReset=!0}},snapToLines:{enumerable:!0,get:function(){return E},set:function(I){E=!!I,this.hasBeenReset=!0}},line:{enumerable:!0,get:function(){return C},set:function(I){if(typeof I!="number"&&I!==r)throw new SyntaxError("Line: an invalid number or illegal string was specified.");C=I,this.hasBeenReset=!0}},lineAlign:{enumerable:!0,get:function(){return _},set:function(I){var N=s(I);N?(_=N,this.hasBeenReset=!0):console.warn("lineAlign: an invalid or illegal string was specified.")}},position:{enumerable:!0,get:function(){return v},set:function(I){if(I<0||I>100)throw new Error("Position must be between 0 and 100.");v=I,this.hasBeenReset=!0}},positionAlign:{enumerable:!0,get:function(){return T},set:function(I){var N=s(I);N?(T=N,this.hasBeenReset=!0):console.warn("positionAlign: an invalid or illegal string was specified.")}},size:{enumerable:!0,get:function(){return w},set:function(I){if(I<0||I>100)throw new Error("Size must be between 0 and 100.");w=I,this.hasBeenReset=!0}},align:{enumerable:!0,get:function(){return A},set:function(I){var N=s(I);if(!N)throw new SyntaxError("align: an invalid or illegal alignment string was specified.");A=N,this.hasBeenReset=!0}}}),this.displayState=void 0}return n.prototype.getCueAsHTML=function(){return WebVTT.convertCueToDOMTree(window,this.text)},jd=n,jd}var zd,ny;function vI(){if(ny)return zd;ny=1;var r={"":!0,up:!0};function e(s){if(typeof s!="string")return!1;var n=r[s.toLowerCase()];return n?s.toLowerCase():!1}function t(s){return typeof s=="number"&&s>=0&&s<=100}function i(){var s=100,n=3,a=0,o=100,l=0,u=100,c="";Object.defineProperties(this,{width:{enumerable:!0,get:function(){return s},set:function(h){if(!t(h))throw new Error("Width must be between 0 and 100.");s=h}},lines:{enumerable:!0,get:function(){return n},set:function(h){if(typeof h!="number")throw new TypeError("Lines must be set to a number.");n=h}},regionAnchorY:{enumerable:!0,get:function(){return o},set:function(h){if(!t(h))throw new Error("RegionAnchorX must be between 0 and 100.");o=h}},regionAnchorX:{enumerable:!0,get:function(){return a},set:function(h){if(!t(h))throw new Error("RegionAnchorY must be between 0 and 100.");a=h}},viewportAnchorY:{enumerable:!0,get:function(){return u},set:function(h){if(!t(h))throw new Error("ViewportAnchorY must be between 0 and 100.");u=h}},viewportAnchorX:{enumerable:!0,get:function(){return l},set:function(h){if(!t(h))throw new Error("ViewportAnchorX must be between 0 and 100.");l=h}},scroll:{enumerable:!0,get:function(){return c},set:function(h){var f=e(h);f===!1?console.warn("Scroll: an invalid or illegal string was specified."):c=f}}})}return zd=i,zd}var ay;function SI(){if(ay)return Vd.exports;ay=1;var r=$h(),e=Vd.exports={WebVTT:yI(),VTTCue:bI(),VTTRegion:vI()};r.vttjs=e,r.WebVTT=e.WebVTT;var t=e.VTTCue,i=e.VTTRegion,s=r.VTTCue,n=r.VTTRegion;return e.shim=function(){r.VTTCue=t,r.VTTRegion=i},e.restore=function(){r.VTTCue=s,r.VTTRegion=n},r.VTTCue||e.shim(),Vd.exports}var TI=SI();const oy=jl(TI);function At(){return At=Object.assign?Object.assign.bind():function(r){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var i in t)({}).hasOwnProperty.call(t,i)&&(r[i]=t[i])}return r},At.apply(null,arguments)}var ly="https://example.com",Bh=function(e,t){if(/^[a-z]+:/i.test(t))return t;/^data:/.test(e)&&(e=U.location&&U.location.href||"");var i=/^\/\//.test(e),s=!U.location&&!/\/\//i.test(e);e=new U.URL(e,U.location||ly);var n=new URL(t,e);return s?n.href.slice(ly.length):i?n.href.slice(n.protocol.length):n.href},ug=(function(){function r(){this.listeners={}}var e=r.prototype;return e.on=function(i,s){this.listeners[i]||(this.listeners[i]=[]),this.listeners[i].push(s)},e.off=function(i,s){if(!this.listeners[i])return!1;var n=this.listeners[i].indexOf(s);return this.listeners[i]=this.listeners[i].slice(0),this.listeners[i].splice(n,1),n>-1},e.trigger=function(i){var s=this.listeners[i];if(s)if(arguments.length===2)for(var n=s.length,a=0;a<n;++a)s[a].call(this,arguments[1]);else for(var o=Array.prototype.slice.call(arguments,1),l=s.length,u=0;u<l;++u)s[u].apply(this,o)},e.dispose=function(){this.listeners={}},e.pipe=function(i){this.on("data",function(s){i.push(s)})},r})(),_I=function(e){return U.atob?U.atob(e):Buffer.from(e,"base64").toString("binary")};function J1(r){for(var e=_I(r),t=new Uint8Array(e.length),i=0;i<e.length;i++)t[i]=e.charCodeAt(i);return t}/*! @name m3u8-parser @version 7.2.0 @license Apache-2.0 */class xI extends ug{constructor(){super(),this.buffer=""}push(e){let t;for(this.buffer+=e,t=this.buffer.indexOf(`
`);t>-1;t=this.buffer.indexOf(`
`))this.trigger("data",this.buffer.substring(0,t)),this.buffer=this.buffer.substring(t+1)}}const wI="	",Zd=function(r){const e=/([0-9.]*)?@?([0-9.]*)?/.exec(r||""),t={};return e[1]&&(t.length=parseInt(e[1],10)),e[2]&&(t.offset=parseInt(e[2],10)),t},CI=function(){const t="(?:"+"[^=]*"+")=(?:"+'"[^"]*"|[^,]*'+")";return new RegExp("(?:^|,)("+t+")")},ci=function(r){const e={};if(!r)return e;const t=r.split(CI());let i=t.length,s;for(;i--;)t[i]!==""&&(s=/([^=]*)=(.*)/.exec(t[i]).slice(1),s[0]=s[0].replace(/^\s+|\s+$/g,""),s[1]=s[1].replace(/^\s+|\s+$/g,""),s[1]=s[1].replace(/^['"](.*)['"]$/g,"$1"),e[s[0]]=s[1]);return e},uy=r=>{const e=r.split("x"),t={};return e[0]&&(t.width=parseInt(e[0],10)),e[1]&&(t.height=parseInt(e[1],10)),t};class kI extends ug{constructor(){super(),this.customParsers=[],this.tagMappers=[]}push(e){let t,i;if(e=e.trim(),e.length===0)return;if(e[0]!=="#"){this.trigger("data",{type:"uri",uri:e});return}this.tagMappers.reduce((n,a)=>{const o=a(e);return o===e?n:n.concat([o])},[e]).forEach(n=>{for(let a=0;a<this.customParsers.length;a++)if(this.customParsers[a].call(this,n))return;if(n.indexOf("#EXT")!==0){this.trigger("data",{type:"comment",text:n.slice(1)});return}if(n=n.replace("\r",""),t=/^#EXTM3U/.exec(n),t){this.trigger("data",{type:"tag",tagType:"m3u"});return}if(t=/^#EXTINF:([0-9\.]*)?,?(.*)?$/.exec(n),t){i={type:"tag",tagType:"inf"},t[1]&&(i.duration=parseFloat(t[1])),t[2]&&(i.title=t[2]),this.trigger("data",i);return}if(t=/^#EXT-X-TARGETDURATION:([0-9.]*)?/.exec(n),t){i={type:"tag",tagType:"targetduration"},t[1]&&(i.duration=parseInt(t[1],10)),this.trigger("data",i);return}if(t=/^#EXT-X-VERSION:([0-9.]*)?/.exec(n),t){i={type:"tag",tagType:"version"},t[1]&&(i.version=parseInt(t[1],10)),this.trigger("data",i);return}if(t=/^#EXT-X-MEDIA-SEQUENCE:(\-?[0-9.]*)?/.exec(n),t){i={type:"tag",tagType:"media-sequence"},t[1]&&(i.number=parseInt(t[1],10)),this.trigger("data",i);return}if(t=/^#EXT-X-DISCONTINUITY-SEQUENCE:(\-?[0-9.]*)?/.exec(n),t){i={type:"tag",tagType:"discontinuity-sequence"},t[1]&&(i.number=parseInt(t[1],10)),this.trigger("data",i);return}if(t=/^#EXT-X-PLAYLIST-TYPE:(.*)?$/.exec(n),t){i={type:"tag",tagType:"playlist-type"},t[1]&&(i.playlistType=t[1]),this.trigger("data",i);return}if(t=/^#EXT-X-BYTERANGE:(.*)?$/.exec(n),t){i=At(Zd(t[1]),{type:"tag",tagType:"byterange"}),this.trigger("data",i);return}if(t=/^#EXT-X-ALLOW-CACHE:(YES|NO)?/.exec(n),t){i={type:"tag",tagType:"allow-cache"},t[1]&&(i.allowed=!/NO/.test(t[1])),this.trigger("data",i);return}if(t=/^#EXT-X-MAP:(.*)$/.exec(n),t){if(i={type:"tag",tagType:"map"},t[1]){const a=ci(t[1]);a.URI&&(i.uri=a.URI),a.BYTERANGE&&(i.byterange=Zd(a.BYTERANGE))}this.trigger("data",i);return}if(t=/^#EXT-X-STREAM-INF:(.*)$/.exec(n),t){i={type:"tag",tagType:"stream-inf"},t[1]&&(i.attributes=ci(t[1]),i.attributes.RESOLUTION&&(i.attributes.RESOLUTION=uy(i.attributes.RESOLUTION)),i.attributes.BANDWIDTH&&(i.attributes.BANDWIDTH=parseInt(i.attributes.BANDWIDTH,10)),i.attributes["FRAME-RATE"]&&(i.attributes["FRAME-RATE"]=parseFloat(i.attributes["FRAME-RATE"])),i.attributes["PROGRAM-ID"]&&(i.attributes["PROGRAM-ID"]=parseInt(i.attributes["PROGRAM-ID"],10))),this.trigger("data",i);return}if(t=/^#EXT-X-MEDIA:(.*)$/.exec(n),t){i={type:"tag",tagType:"media"},t[1]&&(i.attributes=ci(t[1])),this.trigger("data",i);return}if(t=/^#EXT-X-ENDLIST/.exec(n),t){this.trigger("data",{type:"tag",tagType:"endlist"});return}if(t=/^#EXT-X-DISCONTINUITY/.exec(n),t){this.trigger("data",{type:"tag",tagType:"discontinuity"});return}if(t=/^#EXT-X-PROGRAM-DATE-TIME:(.*)$/.exec(n),t){i={type:"tag",tagType:"program-date-time"},t[1]&&(i.dateTimeString=t[1],i.dateTimeObject=new Date(t[1])),this.trigger("data",i);return}if(t=/^#EXT-X-KEY:(.*)$/.exec(n),t){i={type:"tag",tagType:"key"},t[1]&&(i.attributes=ci(t[1]),i.attributes.IV&&(i.attributes.IV.substring(0,2).toLowerCase()==="0x"&&(i.attributes.IV=i.attributes.IV.substring(2)),i.attributes.IV=i.attributes.IV.match(/.{8}/g),i.attributes.IV[0]=parseInt(i.attributes.IV[0],16),i.attributes.IV[1]=parseInt(i.attributes.IV[1],16),i.attributes.IV[2]=parseInt(i.attributes.IV[2],16),i.attributes.IV[3]=parseInt(i.attributes.IV[3],16),i.attributes.IV=new Uint32Array(i.attributes.IV))),this.trigger("data",i);return}if(t=/^#EXT-X-START:(.*)$/.exec(n),t){i={type:"tag",tagType:"start"},t[1]&&(i.attributes=ci(t[1]),i.attributes["TIME-OFFSET"]=parseFloat(i.attributes["TIME-OFFSET"]),i.attributes.PRECISE=/YES/.test(i.attributes.PRECISE)),this.trigger("data",i);return}if(t=/^#EXT-X-CUE-OUT-CONT:(.*)?$/.exec(n),t){i={type:"tag",tagType:"cue-out-cont"},t[1]?i.data=t[1]:i.data="",this.trigger("data",i);return}if(t=/^#EXT-X-CUE-OUT:(.*)?$/.exec(n),t){i={type:"tag",tagType:"cue-out"},t[1]?i.data=t[1]:i.data="",this.trigger("data",i);return}if(t=/^#EXT-X-CUE-IN:?(.*)?$/.exec(n),t){i={type:"tag",tagType:"cue-in"},t[1]?i.data=t[1]:i.data="",this.trigger("data",i);return}if(t=/^#EXT-X-SKIP:(.*)$/.exec(n),t&&t[1]){i={type:"tag",tagType:"skip"},i.attributes=ci(t[1]),i.attributes.hasOwnProperty("SKIPPED-SEGMENTS")&&(i.attributes["SKIPPED-SEGMENTS"]=parseInt(i.attributes["SKIPPED-SEGMENTS"],10)),i.attributes.hasOwnProperty("RECENTLY-REMOVED-DATERANGES")&&(i.attributes["RECENTLY-REMOVED-DATERANGES"]=i.attributes["RECENTLY-REMOVED-DATERANGES"].split(wI)),this.trigger("data",i);return}if(t=/^#EXT-X-PART:(.*)$/.exec(n),t&&t[1]){i={type:"tag",tagType:"part"},i.attributes=ci(t[1]),["DURATION"].forEach(function(a){i.attributes.hasOwnProperty(a)&&(i.attributes[a]=parseFloat(i.attributes[a]))}),["INDEPENDENT","GAP"].forEach(function(a){i.attributes.hasOwnProperty(a)&&(i.attributes[a]=/YES/.test(i.attributes[a]))}),i.attributes.hasOwnProperty("BYTERANGE")&&(i.attributes.byterange=Zd(i.attributes.BYTERANGE)),this.trigger("data",i);return}if(t=/^#EXT-X-SERVER-CONTROL:(.*)$/.exec(n),t&&t[1]){i={type:"tag",tagType:"server-control"},i.attributes=ci(t[1]),["CAN-SKIP-UNTIL","PART-HOLD-BACK","HOLD-BACK"].forEach(function(a){i.attributes.hasOwnProperty(a)&&(i.attributes[a]=parseFloat(i.attributes[a]))}),["CAN-SKIP-DATERANGES","CAN-BLOCK-RELOAD"].forEach(function(a){i.attributes.hasOwnProperty(a)&&(i.attributes[a]=/YES/.test(i.attributes[a]))}),this.trigger("data",i);return}if(t=/^#EXT-X-PART-INF:(.*)$/.exec(n),t&&t[1]){i={type:"tag",tagType:"part-inf"},i.attributes=ci(t[1]),["PART-TARGET"].forEach(function(a){i.attributes.hasOwnProperty(a)&&(i.attributes[a]=parseFloat(i.attributes[a]))}),this.trigger("data",i);return}if(t=/^#EXT-X-PRELOAD-HINT:(.*)$/.exec(n),t&&t[1]){i={type:"tag",tagType:"preload-hint"},i.attributes=ci(t[1]),["BYTERANGE-START","BYTERANGE-LENGTH"].forEach(function(a){if(i.attributes.hasOwnProperty(a)){i.attributes[a]=parseInt(i.attributes[a],10);const o=a==="BYTERANGE-LENGTH"?"length":"offset";i.attributes.byterange=i.attributes.byterange||{},i.attributes.byterange[o]=i.attributes[a],delete i.attributes[a]}}),this.trigger("data",i);return}if(t=/^#EXT-X-RENDITION-REPORT:(.*)$/.exec(n),t&&t[1]){i={type:"tag",tagType:"rendition-report"},i.attributes=ci(t[1]),["LAST-MSN","LAST-PART"].forEach(function(a){i.attributes.hasOwnProperty(a)&&(i.attributes[a]=parseInt(i.attributes[a],10))}),this.trigger("data",i);return}if(t=/^#EXT-X-DATERANGE:(.*)$/.exec(n),t&&t[1]){i={type:"tag",tagType:"daterange"},i.attributes=ci(t[1]),["ID","CLASS"].forEach(function(o){i.attributes.hasOwnProperty(o)&&(i.attributes[o]=String(i.attributes[o]))}),["START-DATE","END-DATE"].forEach(function(o){i.attributes.hasOwnProperty(o)&&(i.attributes[o]=new Date(i.attributes[o]))}),["DURATION","PLANNED-DURATION"].forEach(function(o){i.attributes.hasOwnProperty(o)&&(i.attributes[o]=parseFloat(i.attributes[o]))}),["END-ON-NEXT"].forEach(function(o){i.attributes.hasOwnProperty(o)&&(i.attributes[o]=/YES/i.test(i.attributes[o]))}),["SCTE35-CMD"," SCTE35-OUT","SCTE35-IN"].forEach(function(o){i.attributes.hasOwnProperty(o)&&(i.attributes[o]=i.attributes[o].toString(16))});const a=/^X-([A-Z]+-)+[A-Z]+$/;for(const o in i.attributes){if(!a.test(o))continue;const l=/[0-9A-Fa-f]{6}/g.test(i.attributes[o]),u=/^\d+(\.\d+)?$/.test(i.attributes[o]);i.attributes[o]=l?i.attributes[o].toString(16):u?parseFloat(i.attributes[o]):String(i.attributes[o])}this.trigger("data",i);return}if(t=/^#EXT-X-INDEPENDENT-SEGMENTS/.exec(n),t){this.trigger("data",{type:"tag",tagType:"independent-segments"});return}if(t=/^#EXT-X-I-FRAMES-ONLY/.exec(n),t){this.trigger("data",{type:"tag",tagType:"i-frames-only"});return}if(t=/^#EXT-X-CONTENT-STEERING:(.*)$/.exec(n),t){i={type:"tag",tagType:"content-steering"},i.attributes=ci(t[1]),this.trigger("data",i);return}if(t=/^#EXT-X-I-FRAME-STREAM-INF:(.*)$/.exec(n),t){i={type:"tag",tagType:"i-frame-playlist"},i.attributes=ci(t[1]),i.attributes.URI&&(i.uri=i.attributes.URI),i.attributes.BANDWIDTH&&(i.attributes.BANDWIDTH=parseInt(i.attributes.BANDWIDTH,10)),i.attributes.RESOLUTION&&(i.attributes.RESOLUTION=uy(i.attributes.RESOLUTION)),i.attributes["AVERAGE-BANDWIDTH"]&&(i.attributes["AVERAGE-BANDWIDTH"]=parseInt(i.attributes["AVERAGE-BANDWIDTH"],10)),i.attributes["FRAME-RATE"]&&(i.attributes["FRAME-RATE"]=parseFloat(i.attributes["FRAME-RATE"])),this.trigger("data",i);return}if(t=/^#EXT-X-DEFINE:(.*)$/.exec(n),t){i={type:"tag",tagType:"define"},i.attributes=ci(t[1]),this.trigger("data",i);return}this.trigger("data",{type:"tag",data:n.slice(4)})})}addParser({expression:e,customType:t,dataParser:i,segment:s}){typeof i!="function"&&(i=n=>n),this.customParsers.push(n=>{if(e.exec(n))return this.trigger("data",{type:"custom",data:i(n),customType:t,segment:s}),!0})}addTagMapper({expression:e,map:t}){const i=s=>e.test(s)?t(s):s;this.tagMappers.push(i)}}const EI=r=>r.toLowerCase().replace(/-(\w)/g,e=>e[1].toUpperCase()),Ps=function(r){const e={};return Object.keys(r).forEach(function(t){e[EI(t)]=r[t]}),e},Wd=function(r){const{serverControl:e,targetDuration:t,partTargetDuration:i}=r;if(!e)return;const s="#EXT-X-SERVER-CONTROL",n="holdBack",a="partHoldBack",o=t&&t*3,l=i&&i*2;t&&!e.hasOwnProperty(n)&&(e[n]=o,this.trigger("info",{message:`${s} defaulting HOLD-BACK to targetDuration * 3 (${o}).`})),o&&e[n]<o&&(this.trigger("warn",{message:`${s} clamping HOLD-BACK (${e[n]}) to targetDuration * 3 (${o})`}),e[n]=o),i&&!e.hasOwnProperty(a)&&(e[a]=i*3,this.trigger("info",{message:`${s} defaulting PART-HOLD-BACK to partTargetDuration * 3 (${e[a]}).`})),i&&e[a]<l&&(this.trigger("warn",{message:`${s} clamping PART-HOLD-BACK (${e[a]}) to partTargetDuration * 2 (${l}).`}),e[a]=l)};let AI=class extends ug{constructor(e={}){super(),this.lineStream=new xI,this.parseStream=new kI,this.lineStream.pipe(this.parseStream),this.mainDefinitions=e.mainDefinitions||{},this.params=new URL(e.uri,"https://a.com").searchParams,this.lastProgramDateTime=null;const t=this,i=[];let s={},n,a,o=!1;const l=function(){},u={AUDIO:{},VIDEO:{},"CLOSED-CAPTIONS":{},SUBTITLES:{}},c="urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed";let h=0;this.manifest={allowCache:!0,discontinuityStarts:[],dateRanges:[],iFramePlaylists:[],segments:[]};let f=0,m=0;const S={};this.on("end",()=>{s.uri||!s.parts&&!s.preloadHints||(!s.map&&n&&(s.map=n),!s.key&&a&&(s.key=a),!s.timeline&&typeof h=="number"&&(s.timeline=h),this.manifest.preloadSegment=s)}),this.parseStream.on("data",function(y){let E,C;if(t.manifest.definitions){for(const _ in t.manifest.definitions)if(y.uri&&(y.uri=y.uri.replace(`{$${_}}`,t.manifest.definitions[_])),y.attributes)for(const v in y.attributes)typeof y.attributes[v]=="string"&&(y.attributes[v]=y.attributes[v].replace(`{$${_}}`,t.manifest.definitions[_]))}({tag(){({version(){y.version&&(this.manifest.version=y.version)},"allow-cache"(){this.manifest.allowCache=y.allowed,"allowed"in y||(this.trigger("info",{message:"defaulting allowCache to YES"}),this.manifest.allowCache=!0)},byterange(){const _={};"length"in y&&(s.byterange=_,_.length=y.length,"offset"in y||(y.offset=f)),"offset"in y&&(s.byterange=_,_.offset=y.offset),f=_.offset+_.length},endlist(){this.manifest.endList=!0},inf(){"mediaSequence"in this.manifest||(this.manifest.mediaSequence=0,this.trigger("info",{message:"defaulting media sequence to zero"})),"discontinuitySequence"in this.manifest||(this.manifest.discontinuitySequence=0,this.trigger("info",{message:"defaulting discontinuity sequence to zero"})),y.title&&(s.title=y.title),y.duration>0&&(s.duration=y.duration),y.duration===0&&(s.duration=.01,this.trigger("info",{message:"updating zero segment duration to a small value"})),this.manifest.segments=i},key(){if(!y.attributes){this.trigger("warn",{message:"ignoring key declaration without attribute list"});return}if(y.attributes.METHOD==="NONE"){a=null;return}if(!y.attributes.URI){this.trigger("warn",{message:"ignoring key declaration without URI"});return}if(y.attributes.KEYFORMAT==="com.apple.streamingkeydelivery"){this.manifest.contentProtection=this.manifest.contentProtection||{},this.manifest.contentProtection["com.apple.fps.1_0"]={attributes:y.attributes};return}if(y.attributes.KEYFORMAT==="com.microsoft.playready"){this.manifest.contentProtection=this.manifest.contentProtection||{},this.manifest.contentProtection["com.microsoft.playready"]={uri:y.attributes.URI};return}if(y.attributes.KEYFORMAT===c){if(["SAMPLE-AES","SAMPLE-AES-CTR","SAMPLE-AES-CENC"].indexOf(y.attributes.METHOD)===-1){this.trigger("warn",{message:"invalid key method provided for Widevine"});return}if(y.attributes.METHOD==="SAMPLE-AES-CENC"&&this.trigger("warn",{message:"SAMPLE-AES-CENC is deprecated, please use SAMPLE-AES-CTR instead"}),y.attributes.URI.substring(0,23)!=="data:text/plain;base64,"){this.trigger("warn",{message:"invalid key URI provided for Widevine"});return}if(!(y.attributes.KEYID&&y.attributes.KEYID.substring(0,2)==="0x")){this.trigger("warn",{message:"invalid key ID provided for Widevine"});return}this.manifest.contentProtection=this.manifest.contentProtection||{},this.manifest.contentProtection["com.widevine.alpha"]={attributes:{schemeIdUri:y.attributes.KEYFORMAT,keyId:y.attributes.KEYID.substring(2)},pssh:J1(y.attributes.URI.split(",")[1])};return}y.attributes.METHOD||this.trigger("warn",{message:"defaulting key method to AES-128"}),a={method:y.attributes.METHOD||"AES-128",uri:y.attributes.URI},typeof y.attributes.IV<"u"&&(a.iv=y.attributes.IV)},"media-sequence"(){if(!isFinite(y.number)){this.trigger("warn",{message:"ignoring invalid media sequence: "+y.number});return}this.manifest.mediaSequence=y.number},"discontinuity-sequence"(){if(!isFinite(y.number)){this.trigger("warn",{message:"ignoring invalid discontinuity sequence: "+y.number});return}this.manifest.discontinuitySequence=y.number,h=y.number},"playlist-type"(){if(!/VOD|EVENT/.test(y.playlistType)){this.trigger("warn",{message:"ignoring unknown playlist type: "+y.playlist});return}this.manifest.playlistType=y.playlistType},map(){n={},y.uri&&(n.uri=y.uri),y.byterange&&(n.byterange=y.byterange),a&&(n.key=a)},"stream-inf"(){if(this.manifest.playlists=i,this.manifest.mediaGroups=this.manifest.mediaGroups||u,!y.attributes){this.trigger("warn",{message:"ignoring empty stream-inf attributes"});return}s.attributes||(s.attributes={}),At(s.attributes,y.attributes)},media(){if(this.manifest.mediaGroups=this.manifest.mediaGroups||u,!(y.attributes&&y.attributes.TYPE&&y.attributes["GROUP-ID"]&&y.attributes.NAME)){this.trigger("warn",{message:"ignoring incomplete or missing media group"});return}const _=this.manifest.mediaGroups[y.attributes.TYPE];_[y.attributes["GROUP-ID"]]=_[y.attributes["GROUP-ID"]]||{},E=_[y.attributes["GROUP-ID"]],C={default:/yes/i.test(y.attributes.DEFAULT)},C.default?C.autoselect=!0:C.autoselect=/yes/i.test(y.attributes.AUTOSELECT),y.attributes.LANGUAGE&&(C.language=y.attributes.LANGUAGE),y.attributes.URI&&(C.uri=y.attributes.URI),y.attributes["INSTREAM-ID"]&&(C.instreamId=y.attributes["INSTREAM-ID"]),y.attributes.CHARACTERISTICS&&(C.characteristics=y.attributes.CHARACTERISTICS),y.attributes.FORCED&&(C.forced=/yes/i.test(y.attributes.FORCED)),E[y.attributes.NAME]=C},discontinuity(){h+=1,s.discontinuity=!0,this.manifest.discontinuityStarts.push(i.length)},"program-date-time"(){typeof this.manifest.dateTimeString>"u"&&(this.manifest.dateTimeString=y.dateTimeString,this.manifest.dateTimeObject=y.dateTimeObject),s.dateTimeString=y.dateTimeString,s.dateTimeObject=y.dateTimeObject;const{lastProgramDateTime:_}=this;this.lastProgramDateTime=new Date(y.dateTimeString).getTime(),_===null&&this.manifest.segments.reduceRight((v,T)=>(T.programDateTime=v-T.duration*1e3,T.programDateTime),this.lastProgramDateTime)},targetduration(){if(!isFinite(y.duration)||y.duration<0){this.trigger("warn",{message:"ignoring invalid target duration: "+y.duration});return}this.manifest.targetDuration=y.duration,Wd.call(this,this.manifest)},start(){if(!y.attributes||isNaN(y.attributes["TIME-OFFSET"])){this.trigger("warn",{message:"ignoring start declaration without appropriate attribute list"});return}this.manifest.start={timeOffset:y.attributes["TIME-OFFSET"],precise:y.attributes.PRECISE}},"cue-out"(){s.cueOut=y.data},"cue-out-cont"(){s.cueOutCont=y.data},"cue-in"(){s.cueIn=y.data},skip(){this.manifest.skip=Ps(y.attributes),this.warnOnMissingAttributes_("#EXT-X-SKIP",y.attributes,["SKIPPED-SEGMENTS"])},part(){o=!0;const _=this.manifest.segments.length,v=Ps(y.attributes);s.parts=s.parts||[],s.parts.push(v),v.byterange&&(v.byterange.hasOwnProperty("offset")||(v.byterange.offset=m),m=v.byterange.offset+v.byterange.length);const T=s.parts.length-1;this.warnOnMissingAttributes_(`#EXT-X-PART #${T} for segment #${_}`,y.attributes,["URI","DURATION"]),this.manifest.renditionReports&&this.manifest.renditionReports.forEach((w,A)=>{w.hasOwnProperty("lastPart")||this.trigger("warn",{message:`#EXT-X-RENDITION-REPORT #${A} lacks required attribute(s): LAST-PART`})})},"server-control"(){const _=this.manifest.serverControl=Ps(y.attributes);_.hasOwnProperty("canBlockReload")||(_.canBlockReload=!1,this.trigger("info",{message:"#EXT-X-SERVER-CONTROL defaulting CAN-BLOCK-RELOAD to false"})),Wd.call(this,this.manifest),_.canSkipDateranges&&!_.hasOwnProperty("canSkipUntil")&&this.trigger("warn",{message:"#EXT-X-SERVER-CONTROL lacks required attribute CAN-SKIP-UNTIL which is required when CAN-SKIP-DATERANGES is set"})},"preload-hint"(){const _=this.manifest.segments.length,v=Ps(y.attributes),T=v.type&&v.type==="PART";s.preloadHints=s.preloadHints||[],s.preloadHints.push(v),v.byterange&&(v.byterange.hasOwnProperty("offset")||(v.byterange.offset=T?m:0,T&&(m=v.byterange.offset+v.byterange.length)));const w=s.preloadHints.length-1;if(this.warnOnMissingAttributes_(`#EXT-X-PRELOAD-HINT #${w} for segment #${_}`,y.attributes,["TYPE","URI"]),!!v.type)for(let A=0;A<s.preloadHints.length-1;A++){const I=s.preloadHints[A];I.type&&I.type===v.type&&this.trigger("warn",{message:`#EXT-X-PRELOAD-HINT #${w} for segment #${_} has the same TYPE ${v.type} as preload hint #${A}`})}},"rendition-report"(){const _=Ps(y.attributes);this.manifest.renditionReports=this.manifest.renditionReports||[],this.manifest.renditionReports.push(_);const v=this.manifest.renditionReports.length-1,T=["LAST-MSN","URI"];o&&T.push("LAST-PART"),this.warnOnMissingAttributes_(`#EXT-X-RENDITION-REPORT #${v}`,y.attributes,T)},"part-inf"(){this.manifest.partInf=Ps(y.attributes),this.warnOnMissingAttributes_("#EXT-X-PART-INF",y.attributes,["PART-TARGET"]),this.manifest.partInf.partTarget&&(this.manifest.partTargetDuration=this.manifest.partInf.partTarget),Wd.call(this,this.manifest)},daterange(){this.manifest.dateRanges.push(Ps(y.attributes));const _=this.manifest.dateRanges.length-1;this.warnOnMissingAttributes_(`#EXT-X-DATERANGE #${_}`,y.attributes,["ID","START-DATE"]);const v=this.manifest.dateRanges[_];v.endDate&&v.startDate&&new Date(v.endDate)<new Date(v.startDate)&&this.trigger("warn",{message:"EXT-X-DATERANGE END-DATE must be equal to or later than the value of the START-DATE"}),v.duration&&v.duration<0&&this.trigger("warn",{message:"EXT-X-DATERANGE DURATION must not be negative"}),v.plannedDuration&&v.plannedDuration<0&&this.trigger("warn",{message:"EXT-X-DATERANGE PLANNED-DURATION must not be negative"});const T=!!v.endOnNext;if(T&&!v.class&&this.trigger("warn",{message:"EXT-X-DATERANGE with an END-ON-NEXT=YES attribute must have a CLASS attribute"}),T&&(v.duration||v.endDate)&&this.trigger("warn",{message:"EXT-X-DATERANGE with an END-ON-NEXT=YES attribute must not contain DURATION or END-DATE attributes"}),v.duration&&v.endDate){const A=v.startDate.getTime()+v.duration*1e3;this.manifest.dateRanges[_].endDate=new Date(A)}if(!S[v.id])S[v.id]=v;else{for(const A in S[v.id])if(v[A]&&JSON.stringify(S[v.id][A])!==JSON.stringify(v[A])){this.trigger("warn",{message:"EXT-X-DATERANGE tags with the same ID in a playlist must have the same attributes values"});break}const w=this.manifest.dateRanges.findIndex(A=>A.id===v.id);this.manifest.dateRanges[w]=At(this.manifest.dateRanges[w],v),S[v.id]=At(S[v.id],v),this.manifest.dateRanges.pop()}},"independent-segments"(){this.manifest.independentSegments=!0},"i-frames-only"(){this.manifest.iFramesOnly=!0,this.requiredCompatibilityversion(this.manifest.version,4)},"content-steering"(){this.manifest.contentSteering=Ps(y.attributes),this.warnOnMissingAttributes_("#EXT-X-CONTENT-STEERING",y.attributes,["SERVER-URI"])},define(){this.manifest.definitions=this.manifest.definitions||{};const _=(v,T)=>{if(v in this.manifest.definitions){this.trigger("error",{message:`EXT-X-DEFINE: Duplicate name ${v}`});return}this.manifest.definitions[v]=T};if("QUERYPARAM"in y.attributes){if("NAME"in y.attributes||"IMPORT"in y.attributes){this.trigger("error",{message:"EXT-X-DEFINE: Invalid attributes"});return}const v=this.params.get(y.attributes.QUERYPARAM);if(!v){this.trigger("error",{message:`EXT-X-DEFINE: No query param ${y.attributes.QUERYPARAM}`});return}_(y.attributes.QUERYPARAM,decodeURIComponent(v));return}if("NAME"in y.attributes){if("IMPORT"in y.attributes){this.trigger("error",{message:"EXT-X-DEFINE: Invalid attributes"});return}if(!("VALUE"in y.attributes)||typeof y.attributes.VALUE!="string"){this.trigger("error",{message:`EXT-X-DEFINE: No value for ${y.attributes.NAME}`});return}_(y.attributes.NAME,y.attributes.VALUE);return}if("IMPORT"in y.attributes){if(!this.mainDefinitions[y.attributes.IMPORT]){this.trigger("error",{message:`EXT-X-DEFINE: No value ${y.attributes.IMPORT} to import, or IMPORT used on main playlist`});return}_(y.attributes.IMPORT,this.mainDefinitions[y.attributes.IMPORT]);return}this.trigger("error",{message:"EXT-X-DEFINE: No attribute"})},"i-frame-playlist"(){this.manifest.iFramePlaylists.push({attributes:y.attributes,uri:y.uri,timeline:h}),this.warnOnMissingAttributes_("#EXT-X-I-FRAME-STREAM-INF",y.attributes,["BANDWIDTH","URI"])}}[y.tagType]||l).call(t)},uri(){s.uri=y.uri,i.push(s),this.manifest.targetDuration&&!("duration"in s)&&(this.trigger("warn",{message:"defaulting segment duration to the target duration"}),s.duration=this.manifest.targetDuration),a&&(s.key=a),s.timeline=h,n&&(s.map=n),m=0,this.lastProgramDateTime!==null&&(s.programDateTime=this.lastProgramDateTime,this.lastProgramDateTime+=s.duration*1e3),s={}},comment(){},custom(){y.segment?(s.custom=s.custom||{},s.custom[y.customType]=y.data):(this.manifest.custom=this.manifest.custom||{},this.manifest.custom[y.customType]=y.data)}})[y.type].call(t)})}requiredCompatibilityversion(e,t){(e<t||!e)&&this.trigger("warn",{message:`manifest must be at least version ${t}`})}warnOnMissingAttributes_(e,t,i){const s=[];i.forEach(function(n){t.hasOwnProperty(n)||s.push(n)}),s.length&&this.trigger("warn",{message:`${e} lacks required attribute(s): ${s.join(", ")}`})}push(e){this.lineStream.push(e)}end(){this.lineStream.push(`
`),this.manifest.dateRanges.length&&this.lastProgramDateTime===null&&this.trigger("warn",{message:"A playlist with EXT-X-DATERANGE tag must contain atleast one EXT-X-PROGRAM-DATE-TIME tag"}),this.lastProgramDateTime=null,this.trigger("end")}addParser(e){this.parseStream.addParser(e)}addTagMapper(e){this.parseStream.addTagMapper(e)}};var Cn={mp4:/^(av0?1|avc0?[1234]|vp0?9|flac|opus|mp3|mp4a|mp4v|stpp.ttml.im1t)/,webm:/^(vp0?[89]|av0?1|opus|vorbis)/,ogg:/^(vp0?[89]|theora|flac|opus|vorbis)/,video:/^(av0?1|avc0?[1234]|vp0?[89]|hvc1|hev1|theora|mp4v)/,audio:/^(mp4a|flac|vorbis|opus|ac-[34]|ec-3|alac|mp3|speex|aac)/,text:/^(stpp.ttml.im1t)/,muxerVideo:/^(avc0?1)/,muxerAudio:/^(mp4a)/,muxerText:/a^/},PI=["video","audio","text"],cy=["Video","Audio","Text"],eT=function(e){return e&&e.replace(/avc1\.(\d+)\.(\d+)/i,function(t,i,s){var n=("00"+Number(i).toString(16)).slice(-2),a=("00"+Number(s).toString(16)).slice(-2);return"avc1."+n+"00"+a})},Ir=function(e){e===void 0&&(e="");var t=e.split(","),i=[];return t.forEach(function(s){s=s.trim();var n;PI.forEach(function(a){var o=Cn[a].exec(s.toLowerCase());if(!(!o||o.length<=1)){n=a;var l=s.substring(0,o[1].length),u=s.replace(l,"");i.push({type:l,details:u,mediaType:a})}}),n||i.push({type:s,details:"",mediaType:"unknown"})}),i},DI=function(e,t){if(!e.mediaGroups.AUDIO||!t)return null;var i=e.mediaGroups.AUDIO[t];if(!i)return null;for(var s in i){var n=i[s];if(n.default&&n.playlists)return Ir(n.playlists[0].attributes.CODECS)}return null},tT=function(e){return e===void 0&&(e=""),Cn.audio.test(e.trim().toLowerCase())},MI=function(e){return e===void 0&&(e=""),Cn.text.test(e.trim().toLowerCase())},ka=function(e){if(!(!e||typeof e!="string")){var t=e.toLowerCase().split(",").map(function(n){return eT(n.trim())}),i="video";t.length===1&&tT(t[0])?i="audio":t.length===1&&MI(t[0])&&(i="application");var s="mp4";return t.every(function(n){return Cn.mp4.test(n)})?s="mp4":t.every(function(n){return Cn.webm.test(n)})?s="webm":t.every(function(n){return Cn.ogg.test(n)})&&(s="ogg"),i+"/"+s+';codecs="'+e+'"'}},Wo=function(e,t){return e===void 0&&(e=""),t===void 0&&(t=!1),U.MediaSource&&U.MediaSource.isTypeSupported&&U.MediaSource.isTypeSupported(ka(e))||t&&U.ManagedMediaSource&&U.ManagedMediaSource.isTypeSupported&&U.ManagedMediaSource.isTypeSupported(ka(e))||!1},Hd=function(e){return e===void 0&&(e=""),e.toLowerCase().split(",").every(function(t){t=t.trim();for(var i=0;i<cy.length;i++){var s=cy[i];if(Cn["muxer"+s].test(t))return!0}return!1})},hy="mp4a.40.2",II="avc1.4d400d",RI=/^(audio|video|application)\/(x-|vnd\.apple\.)?mpegurl/i,LI=/^application\/dash\+xml/i,iT=function(e){return RI.test(e)?"hls":LI.test(e)?"dash":e==="application/vnd.videojs.vhs+json"?"vhs-json":null},QI=function(e){return e.toString(2).length},$I=function(e){return Math.ceil(QI(e)/8)},rT=function(e){return ArrayBuffer.isView==="function"?ArrayBuffer.isView(e):e&&e.buffer instanceof ArrayBuffer},BI=function(e){return rT(e)},ke=function(e){return e instanceof Uint8Array?e:(!Array.isArray(e)&&!BI(e)&&!(e instanceof ArrayBuffer)&&(typeof e!="number"||typeof e=="number"&&e!==e?e=0:e=[e]),new Uint8Array(e&&e.buffer||e,e&&e.byteOffset||0,e&&e.byteLength||0))},Wt=U.BigInt||Number,fp=[Wt("0x1"),Wt("0x100"),Wt("0x10000"),Wt("0x1000000"),Wt("0x100000000"),Wt("0x10000000000"),Wt("0x1000000000000"),Wt("0x100000000000000"),Wt("0x10000000000000000")];(function(){var r=new Uint16Array([65484]),e=new Uint8Array(r.buffer,r.byteOffset,r.byteLength);return e[0]===255?"big":e[0]===204?"little":"unknown"})();var NI=function(e,t){var i=t===void 0?{}:t,s=i.signed,n=s===void 0?!1:s,a=i.le,o=a===void 0?!1:a;e=ke(e);var l=o?"reduce":"reduceRight",u=e[l]?e[l]:Array.prototype[l],c=u.call(e,function(f,m,S){var y=o?S:Math.abs(S+1-e.length);return f+Wt(m)*fp[y]},Wt(0));if(n){var h=fp[e.length]/Wt(2)-Wt(1);c=Wt(c),c>h&&(c-=h,c-=h,c-=Wt(2))}return Number(c)},FI=function(e,t){var i={},s=i.le,n=s===void 0?!1:s;(typeof e!="bigint"&&typeof e!="number"||typeof e=="number"&&e!==e)&&(e=0),e=Wt(e);for(var a=$I(e),o=new Uint8Array(new ArrayBuffer(a)),l=0;l<a;l++){var u=n?l:Math.abs(l+1-o.length);o[u]=Number(e/fp[l]&Wt(255)),e<0&&(o[u]=Math.abs(~o[u]),o[u]-=l===0?1:2)}return o},sT=function(e,t){if(typeof e!="string"&&e&&typeof e.toString=="function"&&(e=e.toString()),typeof e!="string")return new Uint8Array;t||(e=unescape(encodeURIComponent(e)));for(var i=new Uint8Array(e.length),s=0;s<e.length;s++)i[s]=e.charCodeAt(s);return i},UI=function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];if(t=t.filter(function(o){return o&&(o.byteLength||o.length)&&typeof o!="string"}),t.length<=1)return ke(t[0]);var s=t.reduce(function(o,l,u){return o+(l.byteLength||l.length)},0),n=new Uint8Array(s),a=0;return t.forEach(function(o){o=ke(o),n.set(o,a),a+=o.byteLength}),n},pt=function(e,t,i){var s=i===void 0?{}:i,n=s.offset,a=n===void 0?0:n,o=s.mask,l=o===void 0?[]:o;e=ke(e),t=ke(t);var u=t.every?t.every:Array.prototype.every;return t.length&&e.length-a>=t.length&&u.call(t,function(c,h){var f=l[h]?l[h]&e[a+h]:e[a+h];return c===f})},qI=function(e,t,i){t.forEach(function(s){for(var n in e.mediaGroups[s])for(var a in e.mediaGroups[s][n]){var o=e.mediaGroups[s][n][a];i(o,s,n,a)}})},xo={},ls={},on={},dy;function Nh(){if(dy)return on;dy=1;function r(n,a,o){if(o===void 0&&(o=Array.prototype),n&&typeof o.find=="function")return o.find.call(n,a);for(var l=0;l<n.length;l++)if(Object.prototype.hasOwnProperty.call(n,l)){var u=n[l];if(a.call(void 0,u,l,n))return u}}function e(n,a){return a===void 0&&(a=Object),a&&typeof a.freeze=="function"?a.freeze(n):n}function t(n,a){if(n===null||typeof n!="object")throw new TypeError("target is not an object");for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(n[o]=a[o]);return n}var i=e({HTML:"text/html",isHTML:function(n){return n===i.HTML},XML_APPLICATION:"application/xml",XML_TEXT:"text/xml",XML_XHTML_APPLICATION:"application/xhtml+xml",XML_SVG_IMAGE:"image/svg+xml"}),s=e({HTML:"http://www.w3.org/1999/xhtml",isHTML:function(n){return n===s.HTML},SVG:"http://www.w3.org/2000/svg",XML:"http://www.w3.org/XML/1998/namespace",XMLNS:"http://www.w3.org/2000/xmlns/"});return on.assign=t,on.find=r,on.freeze=e,on.MIME_TYPE=i,on.NAMESPACE=s,on}var fy;function nT(){if(fy)return ls;fy=1;var r=Nh(),e=r.find,t=r.NAMESPACE;function i(M){return M!==""}function s(M){return M?M.split(/[\t\n\f\r ]+/).filter(i):[]}function n(M,L){return M.hasOwnProperty(L)||(M[L]=!0),M}function a(M){if(!M)return[];var L=s(M);return Object.keys(L.reduce(n,{}))}function o(M){return function(L){return M&&M.indexOf(L)!==-1}}function l(M,L){for(var x in M)Object.prototype.hasOwnProperty.call(M,x)&&(L[x]=M[x])}function u(M,L){var x=M.prototype;if(!(x instanceof L)){let D=function(){};D.prototype=L.prototype,D=new D,l(x,D),M.prototype=x=D}x.constructor!=M&&(typeof M!="function"&&console.error("unknown Class:"+M),x.constructor=M)}var c={},h=c.ELEMENT_NODE=1,f=c.ATTRIBUTE_NODE=2,m=c.TEXT_NODE=3,S=c.CDATA_SECTION_NODE=4,y=c.ENTITY_REFERENCE_NODE=5,E=c.ENTITY_NODE=6,C=c.PROCESSING_INSTRUCTION_NODE=7,_=c.COMMENT_NODE=8,v=c.DOCUMENT_NODE=9,T=c.DOCUMENT_TYPE_NODE=10,w=c.DOCUMENT_FRAGMENT_NODE=11,A=c.NOTATION_NODE=12,I={},N={};I.INDEX_SIZE_ERR=(N[1]="Index size error",1),I.DOMSTRING_SIZE_ERR=(N[2]="DOMString size error",2);var P=I.HIERARCHY_REQUEST_ERR=(N[3]="Hierarchy request error",3);I.WRONG_DOCUMENT_ERR=(N[4]="Wrong document",4),I.INVALID_CHARACTER_ERR=(N[5]="Invalid character",5),I.NO_DATA_ALLOWED_ERR=(N[6]="No data allowed",6),I.NO_MODIFICATION_ALLOWED_ERR=(N[7]="No modification allowed",7);var R=I.NOT_FOUND_ERR=(N[8]="Not found",8);I.NOT_SUPPORTED_ERR=(N[9]="Not supported",9);var X=I.INUSE_ATTRIBUTE_ERR=(N[10]="Attribute in use",10);I.INVALID_STATE_ERR=(N[11]="Invalid state",11),I.SYNTAX_ERR=(N[12]="Syntax error",12),I.INVALID_MODIFICATION_ERR=(N[13]="Invalid modification",13),I.NAMESPACE_ERR=(N[14]="Invalid namespace",14),I.INVALID_ACCESS_ERR=(N[15]="Invalid access",15);function j(M,L){if(L instanceof Error)var x=L;else x=this,Error.call(this,N[M]),this.message=N[M],Error.captureStackTrace&&Error.captureStackTrace(this,j);return x.code=M,L&&(this.message=this.message+": "+L),x}j.prototype=Error.prototype,l(I,j);function Z(){}Z.prototype={length:0,item:function(M){return M>=0&&M<this.length?this[M]:null},toString:function(M,L){for(var x=[],D=0;D<this.length;D++)Cr(this[D],x,M,L);return x.join("")},filter:function(M){return Array.prototype.filter.call(this,M)},indexOf:function(M){return Array.prototype.indexOf.call(this,M)}};function Y(M,L){this._node=M,this._refresh=L,te(this)}function te(M){var L=M._node._inc||M._node.ownerDocument._inc;if(M._inc!==L){var x=M._refresh(M._node);if(bi(M,"length",x.length),!M.$$length||x.length<M.$$length)for(var D=x.length;D in M;D++)Object.prototype.hasOwnProperty.call(M,D)&&delete M[D];l(x,M),M._inc=L}}Y.prototype.item=function(M){return te(this),this[M]||null},u(Y,Z);function le(){}function G(M,L){for(var x=M.length;x--;)if(M[x]===L)return x}function re(M,L,x,D){if(D?L[G(L,D)]=x:L[L.length++]=x,M){x.ownerElement=M;var B=M.ownerDocument;B&&(D&&at(B,M,D),Se(B,M,x))}}function J(M,L,x){var D=G(L,x);if(D>=0){for(var B=L.length-1;D<B;)L[D]=L[++D];if(L.length=B,M){var W=M.ownerDocument;W&&(at(W,M,x),x.ownerElement=null)}}else throw new j(R,new Error(M.tagName+"@"+x))}le.prototype={length:0,item:Z.prototype.item,getNamedItem:function(M){for(var L=this.length;L--;){var x=this[L];if(x.nodeName==M)return x}},setNamedItem:function(M){var L=M.ownerElement;if(L&&L!=this._ownerElement)throw new j(X);var x=this.getNamedItem(M.nodeName);return re(this._ownerElement,this,M,x),x},setNamedItemNS:function(M){var L=M.ownerElement,x;if(L&&L!=this._ownerElement)throw new j(X);return x=this.getNamedItemNS(M.namespaceURI,M.localName),re(this._ownerElement,this,M,x),x},removeNamedItem:function(M){var L=this.getNamedItem(M);return J(this._ownerElement,this,L),L},removeNamedItemNS:function(M,L){var x=this.getNamedItemNS(M,L);return J(this._ownerElement,this,x),x},getNamedItemNS:function(M,L){for(var x=this.length;x--;){var D=this[x];if(D.localName==L&&D.namespaceURI==M)return D}return null}};function ne(){}ne.prototype={hasFeature:function(M,L){return!0},createDocument:function(M,L,x){var D=new Pe;if(D.implementation=this,D.childNodes=new Z,D.doctype=x||null,x&&D.appendChild(x),L){var B=D.createElementNS(M,L);D.appendChild(B)}return D},createDocumentType:function(M,L,x){var D=new wr;return D.name=M,D.nodeName=M,D.publicId=L||"",D.systemId=x||"",D}};function ae(){}ae.prototype={firstChild:null,lastChild:null,previousSibling:null,nextSibling:null,attributes:null,parentNode:null,childNodes:null,ownerDocument:null,nodeValue:null,namespaceURI:null,prefix:null,localName:null,insertBefore:function(M,L){return zt(this,M,L)},replaceChild:function(M,L){zt(this,M,L,Jt),L&&this.removeChild(L)},removeChild:function(M){return Ge(this,M)},appendChild:function(M){return this.insertBefore(M,null)},hasChildNodes:function(){return this.firstChild!=null},cloneNode:function(M){return rs(this.ownerDocument||this,this,M)},normalize:function(){for(var M=this.firstChild;M;){var L=M.nextSibling;L&&L.nodeType==m&&M.nodeType==m?(this.removeChild(L),M.appendData(L.data)):(M.normalize(),M=L)}},isSupported:function(M,L){return this.ownerDocument.implementation.hasFeature(M,L)},hasAttributes:function(){return this.attributes.length>0},lookupPrefix:function(M){for(var L=this;L;){var x=L._nsMap;if(x){for(var D in x)if(Object.prototype.hasOwnProperty.call(x,D)&&x[D]===M)return D}L=L.nodeType==f?L.ownerDocument:L.parentNode}return null},lookupNamespaceURI:function(M){for(var L=this;L;){var x=L._nsMap;if(x&&Object.prototype.hasOwnProperty.call(x,M))return x[M];L=L.nodeType==f?L.ownerDocument:L.parentNode}return null},isDefaultNamespace:function(M){var L=this.lookupPrefix(M);return L==null}};function ve(M){return M=="<"&&"&lt;"||M==">"&&"&gt;"||M=="&"&&"&amp;"||M=='"'&&"&quot;"||"&#"+M.charCodeAt()+";"}l(c,ae),l(c,ae.prototype);function xe(M,L){if(L(M))return!0;if(M=M.firstChild)do if(xe(M,L))return!0;while(M=M.nextSibling)}function Pe(){this.ownerDocument=this}function Se(M,L,x){M&&M._inc++;var D=x.namespaceURI;D===t.XMLNS&&(L._nsMap[x.prefix?x.localName:""]=x.value)}function at(M,L,x,D){M&&M._inc++;var B=x.namespaceURI;B===t.XMLNS&&delete L._nsMap[x.prefix?x.localName:""]}function ft(M,L,x){if(M&&M._inc){M._inc++;var D=L.childNodes;if(x)D[D.length++]=x;else{for(var B=L.firstChild,W=0;B;)D[W++]=B,B=B.nextSibling;D.length=W,delete D[D.length]}}}function Ge(M,L){var x=L.previousSibling,D=L.nextSibling;return x?x.nextSibling=D:M.firstChild=D,D?D.previousSibling=x:M.lastChild=x,L.parentNode=null,L.previousSibling=null,L.nextSibling=null,ft(M.ownerDocument,M),L}function _t(M){return M&&(M.nodeType===ae.DOCUMENT_NODE||M.nodeType===ae.DOCUMENT_FRAGMENT_NODE||M.nodeType===ae.ELEMENT_NODE)}function yi(M){return M&&(Dt(M)||xr(M)||Pt(M)||M.nodeType===ae.DOCUMENT_FRAGMENT_NODE||M.nodeType===ae.COMMENT_NODE||M.nodeType===ae.PROCESSING_INSTRUCTION_NODE)}function Pt(M){return M&&M.nodeType===ae.DOCUMENT_TYPE_NODE}function Dt(M){return M&&M.nodeType===ae.ELEMENT_NODE}function xr(M){return M&&M.nodeType===ae.TEXT_NODE}function Mt(M,L){var x=M.childNodes||[];if(e(x,Dt)||Pt(L))return!1;var D=e(x,Pt);return!(L&&D&&x.indexOf(D)>x.indexOf(L))}function ur(M,L){var x=M.childNodes||[];function D(W){return Dt(W)&&W!==L}if(e(x,D))return!1;var B=e(x,Pt);return!(L&&B&&x.indexOf(B)>x.indexOf(L))}function xt(M,L,x){if(!_t(M))throw new j(P,"Unexpected parent node type "+M.nodeType);if(x&&x.parentNode!==M)throw new j(R,"child not in parent");if(!yi(L)||Pt(L)&&M.nodeType!==ae.DOCUMENT_NODE)throw new j(P,"Unexpected node type "+L.nodeType+" for parent node type "+M.nodeType)}function Kr(M,L,x){var D=M.childNodes||[],B=L.childNodes||[];if(L.nodeType===ae.DOCUMENT_FRAGMENT_NODE){var W=B.filter(Dt);if(W.length>1||e(B,xr))throw new j(P,"More than one element or text in fragment");if(W.length===1&&!Mt(M,x))throw new j(P,"Element in fragment can not be inserted before doctype")}if(Dt(L)&&!Mt(M,x))throw new j(P,"Only one element can be added and only after doctype");if(Pt(L)){if(e(D,Pt))throw new j(P,"Only one doctype is allowed");var oe=e(D,Dt);if(x&&D.indexOf(oe)<D.indexOf(x))throw new j(P,"Doctype can only be inserted before an element");if(!x&&oe)throw new j(P,"Doctype can not be appended since element is present")}}function Jt(M,L,x){var D=M.childNodes||[],B=L.childNodes||[];if(L.nodeType===ae.DOCUMENT_FRAGMENT_NODE){var W=B.filter(Dt);if(W.length>1||e(B,xr))throw new j(P,"More than one element or text in fragment");if(W.length===1&&!ur(M,x))throw new j(P,"Element in fragment can not be inserted before doctype")}if(Dt(L)&&!ur(M,x))throw new j(P,"Only one element can be added and only after doctype");if(Pt(L)){if(e(D,function(we){return Pt(we)&&we!==x}))throw new j(P,"Only one doctype is allowed");var oe=e(D,Dt);if(x&&D.indexOf(oe)<D.indexOf(x))throw new j(P,"Doctype can only be inserted before an element")}}function zt(M,L,x,D){xt(M,L,x),M.nodeType===ae.DOCUMENT_NODE&&(D||Kr)(M,L,x);var B=L.parentNode;if(B&&B.removeChild(L),L.nodeType===w){var W=L.firstChild;if(W==null)return L;var oe=L.lastChild}else W=oe=L;var he=x?x.previousSibling:M.lastChild;W.previousSibling=he,oe.nextSibling=x,he?he.nextSibling=W:M.firstChild=W,x==null?M.lastChild=oe:x.previousSibling=oe;do{W.parentNode=M;var we=M.ownerDocument||M;$e(W,we)}while(W!==oe&&(W=W.nextSibling));return ft(M.ownerDocument||M,M),L.nodeType==w&&(L.firstChild=L.lastChild=null),L}function $e(M,L){if(M.ownerDocument!==L){if(M.ownerDocument=L,M.nodeType===h&&M.attributes)for(var x=0;x<M.attributes.length;x++){var D=M.attributes.item(x);D&&(D.ownerDocument=L)}for(var B=M.firstChild;B;)$e(B,L),B=B.nextSibling}}function tt(M,L){L.parentNode&&L.parentNode.removeChild(L),L.parentNode=M,L.previousSibling=M.lastChild,L.nextSibling=null,L.previousSibling?L.previousSibling.nextSibling=L:M.firstChild=L,M.lastChild=L,ft(M.ownerDocument,M,L);var x=M.ownerDocument||M;return $e(L,x),L}Pe.prototype={nodeName:"#document",nodeType:v,doctype:null,documentElement:null,_inc:1,insertBefore:function(M,L){if(M.nodeType==w){for(var x=M.firstChild;x;){var D=x.nextSibling;this.insertBefore(x,L),x=D}return M}return zt(this,M,L),$e(M,this),this.documentElement===null&&M.nodeType===h&&(this.documentElement=M),M},removeChild:function(M){return this.documentElement==M&&(this.documentElement=null),Ge(this,M)},replaceChild:function(M,L){zt(this,M,L,Jt),$e(M,this),L&&this.removeChild(L),Dt(M)&&(this.documentElement=M)},importNode:function(M,L){return is(this,M,L)},getElementById:function(M){var L=null;return xe(this.documentElement,function(x){if(x.nodeType==h&&x.getAttribute("id")==M)return L=x,!0}),L},getElementsByClassName:function(M){var L=a(M);return new Y(this,function(x){var D=[];return L.length>0&&xe(x.documentElement,function(B){if(B!==x&&B.nodeType===h){var W=B.getAttribute("class");if(W){var oe=M===W;if(!oe){var he=a(W);oe=L.every(o(he))}oe&&D.push(B)}}}),D})},createElement:function(M){var L=new it;L.ownerDocument=this,L.nodeName=M,L.tagName=M,L.localName=M,L.childNodes=new Z;var x=L.attributes=new le;return x._ownerElement=L,L},createDocumentFragment:function(){var M=new qe;return M.ownerDocument=this,M.childNodes=new Z,M},createTextNode:function(M){var L=new zi;return L.ownerDocument=this,L.appendData(M),L},createComment:function(M){var L=new Jr;return L.ownerDocument=this,L.appendData(M),L},createCDATASection:function(M){var L=new cr;return L.ownerDocument=this,L.appendData(M),L},createProcessingInstruction:function(M,L){var x=new rn;return x.ownerDocument=this,x.tagName=x.nodeName=x.target=M,x.nodeValue=x.data=L,x},createAttribute:function(M){var L=new Xi;return L.ownerDocument=this,L.name=M,L.nodeName=M,L.localName=M,L.specified=!0,L},createEntityReference:function(M){var L=new ws;return L.ownerDocument=this,L.nodeName=M,L},createElementNS:function(M,L){var x=new it,D=L.split(":"),B=x.attributes=new le;return x.childNodes=new Z,x.ownerDocument=this,x.nodeName=L,x.tagName=L,x.namespaceURI=M,D.length==2?(x.prefix=D[0],x.localName=D[1]):x.localName=L,B._ownerElement=x,x},createAttributeNS:function(M,L){var x=new Xi,D=L.split(":");return x.ownerDocument=this,x.nodeName=L,x.name=L,x.namespaceURI=M,x.specified=!0,D.length==2?(x.prefix=D[0],x.localName=D[1]):x.localName=L,x}},u(Pe,ae);function it(){this._nsMap={}}it.prototype={nodeType:h,hasAttribute:function(M){return this.getAttributeNode(M)!=null},getAttribute:function(M){var L=this.getAttributeNode(M);return L&&L.value||""},getAttributeNode:function(M){return this.attributes.getNamedItem(M)},setAttribute:function(M,L){var x=this.ownerDocument.createAttribute(M);x.value=x.nodeValue=""+L,this.setAttributeNode(x)},removeAttribute:function(M){var L=this.getAttributeNode(M);L&&this.removeAttributeNode(L)},appendChild:function(M){return M.nodeType===w?this.insertBefore(M,null):tt(this,M)},setAttributeNode:function(M){return this.attributes.setNamedItem(M)},setAttributeNodeNS:function(M){return this.attributes.setNamedItemNS(M)},removeAttributeNode:function(M){return this.attributes.removeNamedItem(M.nodeName)},removeAttributeNS:function(M,L){var x=this.getAttributeNodeNS(M,L);x&&this.removeAttributeNode(x)},hasAttributeNS:function(M,L){return this.getAttributeNodeNS(M,L)!=null},getAttributeNS:function(M,L){var x=this.getAttributeNodeNS(M,L);return x&&x.value||""},setAttributeNS:function(M,L,x){var D=this.ownerDocument.createAttributeNS(M,L);D.value=D.nodeValue=""+x,this.setAttributeNode(D)},getAttributeNodeNS:function(M,L){return this.attributes.getNamedItemNS(M,L)},getElementsByTagName:function(M){return new Y(this,function(L){var x=[];return xe(L,function(D){D!==L&&D.nodeType==h&&(M==="*"||D.tagName==M)&&x.push(D)}),x})},getElementsByTagNameNS:function(M,L){return new Y(this,function(x){var D=[];return xe(x,function(B){B!==x&&B.nodeType===h&&(M==="*"||B.namespaceURI===M)&&(L==="*"||B.localName==L)&&D.push(B)}),D})}},Pe.prototype.getElementsByTagName=it.prototype.getElementsByTagName,Pe.prototype.getElementsByTagNameNS=it.prototype.getElementsByTagNameNS,u(it,ae);function Xi(){}Xi.prototype.nodeType=f,u(Xi,ae);function ji(){}ji.prototype={data:"",substringData:function(M,L){return this.data.substring(M,M+L)},appendData:function(M){M=this.data+M,this.nodeValue=this.data=M,this.length=M.length},insertData:function(M,L){this.replaceData(M,0,L)},appendChild:function(M){throw new Error(N[P])},deleteData:function(M,L){this.replaceData(M,L,"")},replaceData:function(M,L,x){var D=this.data.substring(0,M),B=this.data.substring(M+L);x=D+x+B,this.nodeValue=this.data=x,this.length=x.length}},u(ji,ae);function zi(){}zi.prototype={nodeName:"#text",nodeType:m,splitText:function(M){var L=this.data,x=L.substring(M);L=L.substring(0,M),this.data=this.nodeValue=L,this.length=L.length;var D=this.ownerDocument.createTextNode(x);return this.parentNode&&this.parentNode.insertBefore(D,this.nextSibling),D}},u(zi,ji);function Jr(){}Jr.prototype={nodeName:"#comment",nodeType:_},u(Jr,ji);function cr(){}cr.prototype={nodeName:"#cdata-section",nodeType:S},u(cr,ji);function wr(){}wr.prototype.nodeType=T,u(wr,ae);function xs(){}xs.prototype.nodeType=A,u(xs,ae);function tn(){}tn.prototype.nodeType=E,u(tn,ae);function ws(){}ws.prototype.nodeType=y,u(ws,ae);function qe(){}qe.prototype.nodeName="#document-fragment",qe.prototype.nodeType=w,u(qe,ae);function rn(){}rn.prototype.nodeType=C,u(rn,ae);function es(){}es.prototype.serializeToString=function(M,L,x){return Ke.call(M,L,x)},ae.prototype.toString=Ke;function Ke(M,L){var x=[],D=this.nodeType==9&&this.documentElement||this,B=D.prefix,W=D.namespaceURI;if(W&&B==null){var B=D.lookupPrefix(W);if(B==null)var oe=[{namespace:W,prefix:null}]}return Cr(this,x,M,L,oe),x.join("")}function Cs(M,L,x){var D=M.prefix||"",B=M.namespaceURI;if(!B||D==="xml"&&B===t.XML||B===t.XMLNS)return!1;for(var W=x.length;W--;){var oe=x[W];if(oe.prefix===D)return oe.namespace!==B}return!0}function ts(M,L,x){M.push(" ",L,'="',x.replace(/[<>&"\t\n\r]/g,ve),'"')}function Cr(M,L,x,D,B){if(B||(B=[]),D)if(M=D(M),M){if(typeof M=="string"){L.push(M);return}}else return;switch(M.nodeType){case h:var W=M.attributes,oe=W.length,Ve=M.firstChild,he=M.tagName;x=t.isHTML(M.namespaceURI)||x;var we=he;if(!x&&!M.prefix&&M.namespaceURI){for(var Oe,Ae=0;Ae<W.length;Ae++)if(W.item(Ae).name==="xmlns"){Oe=W.item(Ae).value;break}if(!Oe)for(var pe=B.length-1;pe>=0;pe--){var Te=B[pe];if(Te.prefix===""&&Te.namespace===M.namespaceURI){Oe=Te.namespace;break}}if(Oe!==M.namespaceURI)for(var pe=B.length-1;pe>=0;pe--){var Te=B[pe];if(Te.namespace===M.namespaceURI){Te.prefix&&(we=Te.prefix+":"+he);break}}}L.push("<",we);for(var De=0;De<oe;De++){var Ot=W.item(De);Ot.prefix=="xmlns"?B.push({prefix:Ot.localName,namespace:Ot.value}):Ot.nodeName=="xmlns"&&B.push({prefix:"",namespace:Ot.value})}for(var De=0;De<oe;De++){var Ot=W.item(De);if(Cs(Ot,x,B)){var yt=Ot.prefix||"",ei=Ot.namespaceURI;ts(L,yt?"xmlns:"+yt:"xmlns",ei),B.push({prefix:yt,namespace:ei})}Cr(Ot,L,x,D,B)}if(he===we&&Cs(M,x,B)){var yt=M.prefix||"",ei=M.namespaceURI;ts(L,yt?"xmlns:"+yt:"xmlns",ei),B.push({prefix:yt,namespace:ei})}if(Ve||x&&!/^(?:meta|link|img|br|hr|input)$/i.test(he)){if(L.push(">"),x&&/^script$/i.test(he))for(;Ve;)Ve.data?L.push(Ve.data):Cr(Ve,L,x,D,B.slice()),Ve=Ve.nextSibling;else for(;Ve;)Cr(Ve,L,x,D,B.slice()),Ve=Ve.nextSibling;L.push("</",we,">")}else L.push("/>");return;case v:case w:for(var Ve=M.firstChild;Ve;)Cr(Ve,L,x,D,B.slice()),Ve=Ve.nextSibling;return;case f:return ts(L,M.name,M.value);case m:return L.push(M.data.replace(/[<&>]/g,ve));case S:return L.push("<![CDATA[",M.data,"]]>");case _:return L.push("<!--",M.data,"-->");case T:var ss=M.publicId,Ne=M.systemId;if(L.push("<!DOCTYPE ",M.name),ss)L.push(" PUBLIC ",ss),Ne&&Ne!="."&&L.push(" ",Ne),L.push(">");else if(Ne&&Ne!=".")L.push(" SYSTEM ",Ne,">");else{var Fn=M.internalSubset;Fn&&L.push(" [",Fn,"]"),L.push(">")}return;case C:return L.push("<?",M.target," ",M.data,"?>");case y:return L.push("&",M.nodeName,";");default:L.push("??",M.nodeName)}}function is(M,L,x){var D;switch(L.nodeType){case h:D=L.cloneNode(!1),D.ownerDocument=M;case w:break;case f:x=!0;break}if(D||(D=L.cloneNode(!1)),D.ownerDocument=M,D.parentNode=null,x)for(var B=L.firstChild;B;)D.appendChild(is(M,B,x)),B=B.nextSibling;return D}function rs(M,L,x){var D=new L.constructor;for(var B in L)if(Object.prototype.hasOwnProperty.call(L,B)){var W=L[B];typeof W!="object"&&W!=D[B]&&(D[B]=W)}switch(L.childNodes&&(D.childNodes=new Z),D.ownerDocument=M,D.nodeType){case h:var oe=L.attributes,he=D.attributes=new le,we=oe.length;he._ownerElement=D;for(var Oe=0;Oe<we;Oe++)D.setAttributeNode(rs(M,oe.item(Oe),!0));break;case f:x=!0}if(x)for(var Ae=L.firstChild;Ae;)D.appendChild(rs(M,Ae,x)),Ae=Ae.nextSibling;return D}function bi(M,L,x){M[L]=x}try{if(Object.defineProperty){let M=function(L){switch(L.nodeType){case h:case w:var x=[];for(L=L.firstChild;L;)L.nodeType!==7&&L.nodeType!==8&&x.push(M(L)),L=L.nextSibling;return x.join("");default:return L.nodeValue}};Object.defineProperty(Y.prototype,"length",{get:function(){return te(this),this.$$length}}),Object.defineProperty(ae.prototype,"textContent",{get:function(){return M(this)},set:function(L){switch(this.nodeType){case h:case w:for(;this.firstChild;)this.removeChild(this.firstChild);(L||String(L))&&this.appendChild(this.ownerDocument.createTextNode(L));break;default:this.data=L,this.value=L,this.nodeValue=L}}}),bi=function(L,x,D){L["$$"+x]=D}}}catch{}return ls.DocumentType=wr,ls.DOMException=j,ls.DOMImplementation=ne,ls.Element=it,ls.Node=ae,ls.NodeList=Z,ls.XMLSerializer=es,ls}var wo={},Yd={},py;function VI(){return py||(py=1,(function(r){var e=Nh().freeze;r.XML_ENTITIES=e({amp:"&",apos:"'",gt:">",lt:"<",quot:'"'}),r.HTML_ENTITIES=e({Aacute:"Á",aacute:"á",Abreve:"Ă",abreve:"ă",ac:"∾",acd:"∿",acE:"∾̳",Acirc:"Â",acirc:"â",acute:"´",Acy:"А",acy:"а",AElig:"Æ",aelig:"æ",af:"⁡",Afr:"𝔄",afr:"𝔞",Agrave:"À",agrave:"à",alefsym:"ℵ",aleph:"ℵ",Alpha:"Α",alpha:"α",Amacr:"Ā",amacr:"ā",amalg:"⨿",AMP:"&",amp:"&",And:"⩓",and:"∧",andand:"⩕",andd:"⩜",andslope:"⩘",andv:"⩚",ang:"∠",ange:"⦤",angle:"∠",angmsd:"∡",angmsdaa:"⦨",angmsdab:"⦩",angmsdac:"⦪",angmsdad:"⦫",angmsdae:"⦬",angmsdaf:"⦭",angmsdag:"⦮",angmsdah:"⦯",angrt:"∟",angrtvb:"⊾",angrtvbd:"⦝",angsph:"∢",angst:"Å",angzarr:"⍼",Aogon:"Ą",aogon:"ą",Aopf:"𝔸",aopf:"𝕒",ap:"≈",apacir:"⩯",apE:"⩰",ape:"≊",apid:"≋",apos:"'",ApplyFunction:"⁡",approx:"≈",approxeq:"≊",Aring:"Å",aring:"å",Ascr:"𝒜",ascr:"𝒶",Assign:"≔",ast:"*",asymp:"≈",asympeq:"≍",Atilde:"Ã",atilde:"ã",Auml:"Ä",auml:"ä",awconint:"∳",awint:"⨑",backcong:"≌",backepsilon:"϶",backprime:"‵",backsim:"∽",backsimeq:"⋍",Backslash:"∖",Barv:"⫧",barvee:"⊽",Barwed:"⌆",barwed:"⌅",barwedge:"⌅",bbrk:"⎵",bbrktbrk:"⎶",bcong:"≌",Bcy:"Б",bcy:"б",bdquo:"„",becaus:"∵",Because:"∵",because:"∵",bemptyv:"⦰",bepsi:"϶",bernou:"ℬ",Bernoullis:"ℬ",Beta:"Β",beta:"β",beth:"ℶ",between:"≬",Bfr:"𝔅",bfr:"𝔟",bigcap:"⋂",bigcirc:"◯",bigcup:"⋃",bigodot:"⨀",bigoplus:"⨁",bigotimes:"⨂",bigsqcup:"⨆",bigstar:"★",bigtriangledown:"▽",bigtriangleup:"△",biguplus:"⨄",bigvee:"⋁",bigwedge:"⋀",bkarow:"⤍",blacklozenge:"⧫",blacksquare:"▪",blacktriangle:"▴",blacktriangledown:"▾",blacktriangleleft:"◂",blacktriangleright:"▸",blank:"␣",blk12:"▒",blk14:"░",blk34:"▓",block:"█",bne:"=⃥",bnequiv:"≡⃥",bNot:"⫭",bnot:"⌐",Bopf:"𝔹",bopf:"𝕓",bot:"⊥",bottom:"⊥",bowtie:"⋈",boxbox:"⧉",boxDL:"╗",boxDl:"╖",boxdL:"╕",boxdl:"┐",boxDR:"╔",boxDr:"╓",boxdR:"╒",boxdr:"┌",boxH:"═",boxh:"─",boxHD:"╦",boxHd:"╤",boxhD:"╥",boxhd:"┬",boxHU:"╩",boxHu:"╧",boxhU:"╨",boxhu:"┴",boxminus:"⊟",boxplus:"⊞",boxtimes:"⊠",boxUL:"╝",boxUl:"╜",boxuL:"╛",boxul:"┘",boxUR:"╚",boxUr:"╙",boxuR:"╘",boxur:"└",boxV:"║",boxv:"│",boxVH:"╬",boxVh:"╫",boxvH:"╪",boxvh:"┼",boxVL:"╣",boxVl:"╢",boxvL:"╡",boxvl:"┤",boxVR:"╠",boxVr:"╟",boxvR:"╞",boxvr:"├",bprime:"‵",Breve:"˘",breve:"˘",brvbar:"¦",Bscr:"ℬ",bscr:"𝒷",bsemi:"⁏",bsim:"∽",bsime:"⋍",bsol:"\\",bsolb:"⧅",bsolhsub:"⟈",bull:"•",bullet:"•",bump:"≎",bumpE:"⪮",bumpe:"≏",Bumpeq:"≎",bumpeq:"≏",Cacute:"Ć",cacute:"ć",Cap:"⋒",cap:"∩",capand:"⩄",capbrcup:"⩉",capcap:"⩋",capcup:"⩇",capdot:"⩀",CapitalDifferentialD:"ⅅ",caps:"∩︀",caret:"⁁",caron:"ˇ",Cayleys:"ℭ",ccaps:"⩍",Ccaron:"Č",ccaron:"č",Ccedil:"Ç",ccedil:"ç",Ccirc:"Ĉ",ccirc:"ĉ",Cconint:"∰",ccups:"⩌",ccupssm:"⩐",Cdot:"Ċ",cdot:"ċ",cedil:"¸",Cedilla:"¸",cemptyv:"⦲",cent:"¢",CenterDot:"·",centerdot:"·",Cfr:"ℭ",cfr:"𝔠",CHcy:"Ч",chcy:"ч",check:"✓",checkmark:"✓",Chi:"Χ",chi:"χ",cir:"○",circ:"ˆ",circeq:"≗",circlearrowleft:"↺",circlearrowright:"↻",circledast:"⊛",circledcirc:"⊚",circleddash:"⊝",CircleDot:"⊙",circledR:"®",circledS:"Ⓢ",CircleMinus:"⊖",CirclePlus:"⊕",CircleTimes:"⊗",cirE:"⧃",cire:"≗",cirfnint:"⨐",cirmid:"⫯",cirscir:"⧂",ClockwiseContourIntegral:"∲",CloseCurlyDoubleQuote:"”",CloseCurlyQuote:"’",clubs:"♣",clubsuit:"♣",Colon:"∷",colon:":",Colone:"⩴",colone:"≔",coloneq:"≔",comma:",",commat:"@",comp:"∁",compfn:"∘",complement:"∁",complexes:"ℂ",cong:"≅",congdot:"⩭",Congruent:"≡",Conint:"∯",conint:"∮",ContourIntegral:"∮",Copf:"ℂ",copf:"𝕔",coprod:"∐",Coproduct:"∐",COPY:"©",copy:"©",copysr:"℗",CounterClockwiseContourIntegral:"∳",crarr:"↵",Cross:"⨯",cross:"✗",Cscr:"𝒞",cscr:"𝒸",csub:"⫏",csube:"⫑",csup:"⫐",csupe:"⫒",ctdot:"⋯",cudarrl:"⤸",cudarrr:"⤵",cuepr:"⋞",cuesc:"⋟",cularr:"↶",cularrp:"⤽",Cup:"⋓",cup:"∪",cupbrcap:"⩈",CupCap:"≍",cupcap:"⩆",cupcup:"⩊",cupdot:"⊍",cupor:"⩅",cups:"∪︀",curarr:"↷",curarrm:"⤼",curlyeqprec:"⋞",curlyeqsucc:"⋟",curlyvee:"⋎",curlywedge:"⋏",curren:"¤",curvearrowleft:"↶",curvearrowright:"↷",cuvee:"⋎",cuwed:"⋏",cwconint:"∲",cwint:"∱",cylcty:"⌭",Dagger:"‡",dagger:"†",daleth:"ℸ",Darr:"↡",dArr:"⇓",darr:"↓",dash:"‐",Dashv:"⫤",dashv:"⊣",dbkarow:"⤏",dblac:"˝",Dcaron:"Ď",dcaron:"ď",Dcy:"Д",dcy:"д",DD:"ⅅ",dd:"ⅆ",ddagger:"‡",ddarr:"⇊",DDotrahd:"⤑",ddotseq:"⩷",deg:"°",Del:"∇",Delta:"Δ",delta:"δ",demptyv:"⦱",dfisht:"⥿",Dfr:"𝔇",dfr:"𝔡",dHar:"⥥",dharl:"⇃",dharr:"⇂",DiacriticalAcute:"´",DiacriticalDot:"˙",DiacriticalDoubleAcute:"˝",DiacriticalGrave:"`",DiacriticalTilde:"˜",diam:"⋄",Diamond:"⋄",diamond:"⋄",diamondsuit:"♦",diams:"♦",die:"¨",DifferentialD:"ⅆ",digamma:"ϝ",disin:"⋲",div:"÷",divide:"÷",divideontimes:"⋇",divonx:"⋇",DJcy:"Ђ",djcy:"ђ",dlcorn:"⌞",dlcrop:"⌍",dollar:"$",Dopf:"𝔻",dopf:"𝕕",Dot:"¨",dot:"˙",DotDot:"⃜",doteq:"≐",doteqdot:"≑",DotEqual:"≐",dotminus:"∸",dotplus:"∔",dotsquare:"⊡",doublebarwedge:"⌆",DoubleContourIntegral:"∯",DoubleDot:"¨",DoubleDownArrow:"⇓",DoubleLeftArrow:"⇐",DoubleLeftRightArrow:"⇔",DoubleLeftTee:"⫤",DoubleLongLeftArrow:"⟸",DoubleLongLeftRightArrow:"⟺",DoubleLongRightArrow:"⟹",DoubleRightArrow:"⇒",DoubleRightTee:"⊨",DoubleUpArrow:"⇑",DoubleUpDownArrow:"⇕",DoubleVerticalBar:"∥",DownArrow:"↓",Downarrow:"⇓",downarrow:"↓",DownArrowBar:"⤓",DownArrowUpArrow:"⇵",DownBreve:"̑",downdownarrows:"⇊",downharpoonleft:"⇃",downharpoonright:"⇂",DownLeftRightVector:"⥐",DownLeftTeeVector:"⥞",DownLeftVector:"↽",DownLeftVectorBar:"⥖",DownRightTeeVector:"⥟",DownRightVector:"⇁",DownRightVectorBar:"⥗",DownTee:"⊤",DownTeeArrow:"↧",drbkarow:"⤐",drcorn:"⌟",drcrop:"⌌",Dscr:"𝒟",dscr:"𝒹",DScy:"Ѕ",dscy:"ѕ",dsol:"⧶",Dstrok:"Đ",dstrok:"đ",dtdot:"⋱",dtri:"▿",dtrif:"▾",duarr:"⇵",duhar:"⥯",dwangle:"⦦",DZcy:"Џ",dzcy:"џ",dzigrarr:"⟿",Eacute:"É",eacute:"é",easter:"⩮",Ecaron:"Ě",ecaron:"ě",ecir:"≖",Ecirc:"Ê",ecirc:"ê",ecolon:"≕",Ecy:"Э",ecy:"э",eDDot:"⩷",Edot:"Ė",eDot:"≑",edot:"ė",ee:"ⅇ",efDot:"≒",Efr:"𝔈",efr:"𝔢",eg:"⪚",Egrave:"È",egrave:"è",egs:"⪖",egsdot:"⪘",el:"⪙",Element:"∈",elinters:"⏧",ell:"ℓ",els:"⪕",elsdot:"⪗",Emacr:"Ē",emacr:"ē",empty:"∅",emptyset:"∅",EmptySmallSquare:"◻",emptyv:"∅",EmptyVerySmallSquare:"▫",emsp:" ",emsp13:" ",emsp14:" ",ENG:"Ŋ",eng:"ŋ",ensp:" ",Eogon:"Ę",eogon:"ę",Eopf:"𝔼",eopf:"𝕖",epar:"⋕",eparsl:"⧣",eplus:"⩱",epsi:"ε",Epsilon:"Ε",epsilon:"ε",epsiv:"ϵ",eqcirc:"≖",eqcolon:"≕",eqsim:"≂",eqslantgtr:"⪖",eqslantless:"⪕",Equal:"⩵",equals:"=",EqualTilde:"≂",equest:"≟",Equilibrium:"⇌",equiv:"≡",equivDD:"⩸",eqvparsl:"⧥",erarr:"⥱",erDot:"≓",Escr:"ℰ",escr:"ℯ",esdot:"≐",Esim:"⩳",esim:"≂",Eta:"Η",eta:"η",ETH:"Ð",eth:"ð",Euml:"Ë",euml:"ë",euro:"€",excl:"!",exist:"∃",Exists:"∃",expectation:"ℰ",ExponentialE:"ⅇ",exponentiale:"ⅇ",fallingdotseq:"≒",Fcy:"Ф",fcy:"ф",female:"♀",ffilig:"ﬃ",fflig:"ﬀ",ffllig:"ﬄ",Ffr:"𝔉",ffr:"𝔣",filig:"ﬁ",FilledSmallSquare:"◼",FilledVerySmallSquare:"▪",fjlig:"fj",flat:"♭",fllig:"ﬂ",fltns:"▱",fnof:"ƒ",Fopf:"𝔽",fopf:"𝕗",ForAll:"∀",forall:"∀",fork:"⋔",forkv:"⫙",Fouriertrf:"ℱ",fpartint:"⨍",frac12:"½",frac13:"⅓",frac14:"¼",frac15:"⅕",frac16:"⅙",frac18:"⅛",frac23:"⅔",frac25:"⅖",frac34:"¾",frac35:"⅗",frac38:"⅜",frac45:"⅘",frac56:"⅚",frac58:"⅝",frac78:"⅞",frasl:"⁄",frown:"⌢",Fscr:"ℱ",fscr:"𝒻",gacute:"ǵ",Gamma:"Γ",gamma:"γ",Gammad:"Ϝ",gammad:"ϝ",gap:"⪆",Gbreve:"Ğ",gbreve:"ğ",Gcedil:"Ģ",Gcirc:"Ĝ",gcirc:"ĝ",Gcy:"Г",gcy:"г",Gdot:"Ġ",gdot:"ġ",gE:"≧",ge:"≥",gEl:"⪌",gel:"⋛",geq:"≥",geqq:"≧",geqslant:"⩾",ges:"⩾",gescc:"⪩",gesdot:"⪀",gesdoto:"⪂",gesdotol:"⪄",gesl:"⋛︀",gesles:"⪔",Gfr:"𝔊",gfr:"𝔤",Gg:"⋙",gg:"≫",ggg:"⋙",gimel:"ℷ",GJcy:"Ѓ",gjcy:"ѓ",gl:"≷",gla:"⪥",glE:"⪒",glj:"⪤",gnap:"⪊",gnapprox:"⪊",gnE:"≩",gne:"⪈",gneq:"⪈",gneqq:"≩",gnsim:"⋧",Gopf:"𝔾",gopf:"𝕘",grave:"`",GreaterEqual:"≥",GreaterEqualLess:"⋛",GreaterFullEqual:"≧",GreaterGreater:"⪢",GreaterLess:"≷",GreaterSlantEqual:"⩾",GreaterTilde:"≳",Gscr:"𝒢",gscr:"ℊ",gsim:"≳",gsime:"⪎",gsiml:"⪐",Gt:"≫",GT:">",gt:">",gtcc:"⪧",gtcir:"⩺",gtdot:"⋗",gtlPar:"⦕",gtquest:"⩼",gtrapprox:"⪆",gtrarr:"⥸",gtrdot:"⋗",gtreqless:"⋛",gtreqqless:"⪌",gtrless:"≷",gtrsim:"≳",gvertneqq:"≩︀",gvnE:"≩︀",Hacek:"ˇ",hairsp:" ",half:"½",hamilt:"ℋ",HARDcy:"Ъ",hardcy:"ъ",hArr:"⇔",harr:"↔",harrcir:"⥈",harrw:"↭",Hat:"^",hbar:"ℏ",Hcirc:"Ĥ",hcirc:"ĥ",hearts:"♥",heartsuit:"♥",hellip:"…",hercon:"⊹",Hfr:"ℌ",hfr:"𝔥",HilbertSpace:"ℋ",hksearow:"⤥",hkswarow:"⤦",hoarr:"⇿",homtht:"∻",hookleftarrow:"↩",hookrightarrow:"↪",Hopf:"ℍ",hopf:"𝕙",horbar:"―",HorizontalLine:"─",Hscr:"ℋ",hscr:"𝒽",hslash:"ℏ",Hstrok:"Ħ",hstrok:"ħ",HumpDownHump:"≎",HumpEqual:"≏",hybull:"⁃",hyphen:"‐",Iacute:"Í",iacute:"í",ic:"⁣",Icirc:"Î",icirc:"î",Icy:"И",icy:"и",Idot:"İ",IEcy:"Е",iecy:"е",iexcl:"¡",iff:"⇔",Ifr:"ℑ",ifr:"𝔦",Igrave:"Ì",igrave:"ì",ii:"ⅈ",iiiint:"⨌",iiint:"∭",iinfin:"⧜",iiota:"℩",IJlig:"Ĳ",ijlig:"ĳ",Im:"ℑ",Imacr:"Ī",imacr:"ī",image:"ℑ",ImaginaryI:"ⅈ",imagline:"ℐ",imagpart:"ℑ",imath:"ı",imof:"⊷",imped:"Ƶ",Implies:"⇒",in:"∈",incare:"℅",infin:"∞",infintie:"⧝",inodot:"ı",Int:"∬",int:"∫",intcal:"⊺",integers:"ℤ",Integral:"∫",intercal:"⊺",Intersection:"⋂",intlarhk:"⨗",intprod:"⨼",InvisibleComma:"⁣",InvisibleTimes:"⁢",IOcy:"Ё",iocy:"ё",Iogon:"Į",iogon:"į",Iopf:"𝕀",iopf:"𝕚",Iota:"Ι",iota:"ι",iprod:"⨼",iquest:"¿",Iscr:"ℐ",iscr:"𝒾",isin:"∈",isindot:"⋵",isinE:"⋹",isins:"⋴",isinsv:"⋳",isinv:"∈",it:"⁢",Itilde:"Ĩ",itilde:"ĩ",Iukcy:"І",iukcy:"і",Iuml:"Ï",iuml:"ï",Jcirc:"Ĵ",jcirc:"ĵ",Jcy:"Й",jcy:"й",Jfr:"𝔍",jfr:"𝔧",jmath:"ȷ",Jopf:"𝕁",jopf:"𝕛",Jscr:"𝒥",jscr:"𝒿",Jsercy:"Ј",jsercy:"ј",Jukcy:"Є",jukcy:"є",Kappa:"Κ",kappa:"κ",kappav:"ϰ",Kcedil:"Ķ",kcedil:"ķ",Kcy:"К",kcy:"к",Kfr:"𝔎",kfr:"𝔨",kgreen:"ĸ",KHcy:"Х",khcy:"х",KJcy:"Ќ",kjcy:"ќ",Kopf:"𝕂",kopf:"𝕜",Kscr:"𝒦",kscr:"𝓀",lAarr:"⇚",Lacute:"Ĺ",lacute:"ĺ",laemptyv:"⦴",lagran:"ℒ",Lambda:"Λ",lambda:"λ",Lang:"⟪",lang:"⟨",langd:"⦑",langle:"⟨",lap:"⪅",Laplacetrf:"ℒ",laquo:"«",Larr:"↞",lArr:"⇐",larr:"←",larrb:"⇤",larrbfs:"⤟",larrfs:"⤝",larrhk:"↩",larrlp:"↫",larrpl:"⤹",larrsim:"⥳",larrtl:"↢",lat:"⪫",lAtail:"⤛",latail:"⤙",late:"⪭",lates:"⪭︀",lBarr:"⤎",lbarr:"⤌",lbbrk:"❲",lbrace:"{",lbrack:"[",lbrke:"⦋",lbrksld:"⦏",lbrkslu:"⦍",Lcaron:"Ľ",lcaron:"ľ",Lcedil:"Ļ",lcedil:"ļ",lceil:"⌈",lcub:"{",Lcy:"Л",lcy:"л",ldca:"⤶",ldquo:"“",ldquor:"„",ldrdhar:"⥧",ldrushar:"⥋",ldsh:"↲",lE:"≦",le:"≤",LeftAngleBracket:"⟨",LeftArrow:"←",Leftarrow:"⇐",leftarrow:"←",LeftArrowBar:"⇤",LeftArrowRightArrow:"⇆",leftarrowtail:"↢",LeftCeiling:"⌈",LeftDoubleBracket:"⟦",LeftDownTeeVector:"⥡",LeftDownVector:"⇃",LeftDownVectorBar:"⥙",LeftFloor:"⌊",leftharpoondown:"↽",leftharpoonup:"↼",leftleftarrows:"⇇",LeftRightArrow:"↔",Leftrightarrow:"⇔",leftrightarrow:"↔",leftrightarrows:"⇆",leftrightharpoons:"⇋",leftrightsquigarrow:"↭",LeftRightVector:"⥎",LeftTee:"⊣",LeftTeeArrow:"↤",LeftTeeVector:"⥚",leftthreetimes:"⋋",LeftTriangle:"⊲",LeftTriangleBar:"⧏",LeftTriangleEqual:"⊴",LeftUpDownVector:"⥑",LeftUpTeeVector:"⥠",LeftUpVector:"↿",LeftUpVectorBar:"⥘",LeftVector:"↼",LeftVectorBar:"⥒",lEg:"⪋",leg:"⋚",leq:"≤",leqq:"≦",leqslant:"⩽",les:"⩽",lescc:"⪨",lesdot:"⩿",lesdoto:"⪁",lesdotor:"⪃",lesg:"⋚︀",lesges:"⪓",lessapprox:"⪅",lessdot:"⋖",lesseqgtr:"⋚",lesseqqgtr:"⪋",LessEqualGreater:"⋚",LessFullEqual:"≦",LessGreater:"≶",lessgtr:"≶",LessLess:"⪡",lesssim:"≲",LessSlantEqual:"⩽",LessTilde:"≲",lfisht:"⥼",lfloor:"⌊",Lfr:"𝔏",lfr:"𝔩",lg:"≶",lgE:"⪑",lHar:"⥢",lhard:"↽",lharu:"↼",lharul:"⥪",lhblk:"▄",LJcy:"Љ",ljcy:"љ",Ll:"⋘",ll:"≪",llarr:"⇇",llcorner:"⌞",Lleftarrow:"⇚",llhard:"⥫",lltri:"◺",Lmidot:"Ŀ",lmidot:"ŀ",lmoust:"⎰",lmoustache:"⎰",lnap:"⪉",lnapprox:"⪉",lnE:"≨",lne:"⪇",lneq:"⪇",lneqq:"≨",lnsim:"⋦",loang:"⟬",loarr:"⇽",lobrk:"⟦",LongLeftArrow:"⟵",Longleftarrow:"⟸",longleftarrow:"⟵",LongLeftRightArrow:"⟷",Longleftrightarrow:"⟺",longleftrightarrow:"⟷",longmapsto:"⟼",LongRightArrow:"⟶",Longrightarrow:"⟹",longrightarrow:"⟶",looparrowleft:"↫",looparrowright:"↬",lopar:"⦅",Lopf:"𝕃",lopf:"𝕝",loplus:"⨭",lotimes:"⨴",lowast:"∗",lowbar:"_",LowerLeftArrow:"↙",LowerRightArrow:"↘",loz:"◊",lozenge:"◊",lozf:"⧫",lpar:"(",lparlt:"⦓",lrarr:"⇆",lrcorner:"⌟",lrhar:"⇋",lrhard:"⥭",lrm:"‎",lrtri:"⊿",lsaquo:"‹",Lscr:"ℒ",lscr:"𝓁",Lsh:"↰",lsh:"↰",lsim:"≲",lsime:"⪍",lsimg:"⪏",lsqb:"[",lsquo:"‘",lsquor:"‚",Lstrok:"Ł",lstrok:"ł",Lt:"≪",LT:"<",lt:"<",ltcc:"⪦",ltcir:"⩹",ltdot:"⋖",lthree:"⋋",ltimes:"⋉",ltlarr:"⥶",ltquest:"⩻",ltri:"◃",ltrie:"⊴",ltrif:"◂",ltrPar:"⦖",lurdshar:"⥊",luruhar:"⥦",lvertneqq:"≨︀",lvnE:"≨︀",macr:"¯",male:"♂",malt:"✠",maltese:"✠",Map:"⤅",map:"↦",mapsto:"↦",mapstodown:"↧",mapstoleft:"↤",mapstoup:"↥",marker:"▮",mcomma:"⨩",Mcy:"М",mcy:"м",mdash:"—",mDDot:"∺",measuredangle:"∡",MediumSpace:" ",Mellintrf:"ℳ",Mfr:"𝔐",mfr:"𝔪",mho:"℧",micro:"µ",mid:"∣",midast:"*",midcir:"⫰",middot:"·",minus:"−",minusb:"⊟",minusd:"∸",minusdu:"⨪",MinusPlus:"∓",mlcp:"⫛",mldr:"…",mnplus:"∓",models:"⊧",Mopf:"𝕄",mopf:"𝕞",mp:"∓",Mscr:"ℳ",mscr:"𝓂",mstpos:"∾",Mu:"Μ",mu:"μ",multimap:"⊸",mumap:"⊸",nabla:"∇",Nacute:"Ń",nacute:"ń",nang:"∠⃒",nap:"≉",napE:"⩰̸",napid:"≋̸",napos:"ŉ",napprox:"≉",natur:"♮",natural:"♮",naturals:"ℕ",nbsp:" ",nbump:"≎̸",nbumpe:"≏̸",ncap:"⩃",Ncaron:"Ň",ncaron:"ň",Ncedil:"Ņ",ncedil:"ņ",ncong:"≇",ncongdot:"⩭̸",ncup:"⩂",Ncy:"Н",ncy:"н",ndash:"–",ne:"≠",nearhk:"⤤",neArr:"⇗",nearr:"↗",nearrow:"↗",nedot:"≐̸",NegativeMediumSpace:"​",NegativeThickSpace:"​",NegativeThinSpace:"​",NegativeVeryThinSpace:"​",nequiv:"≢",nesear:"⤨",nesim:"≂̸",NestedGreaterGreater:"≫",NestedLessLess:"≪",NewLine:`
`,nexist:"∄",nexists:"∄",Nfr:"𝔑",nfr:"𝔫",ngE:"≧̸",nge:"≱",ngeq:"≱",ngeqq:"≧̸",ngeqslant:"⩾̸",nges:"⩾̸",nGg:"⋙̸",ngsim:"≵",nGt:"≫⃒",ngt:"≯",ngtr:"≯",nGtv:"≫̸",nhArr:"⇎",nharr:"↮",nhpar:"⫲",ni:"∋",nis:"⋼",nisd:"⋺",niv:"∋",NJcy:"Њ",njcy:"њ",nlArr:"⇍",nlarr:"↚",nldr:"‥",nlE:"≦̸",nle:"≰",nLeftarrow:"⇍",nleftarrow:"↚",nLeftrightarrow:"⇎",nleftrightarrow:"↮",nleq:"≰",nleqq:"≦̸",nleqslant:"⩽̸",nles:"⩽̸",nless:"≮",nLl:"⋘̸",nlsim:"≴",nLt:"≪⃒",nlt:"≮",nltri:"⋪",nltrie:"⋬",nLtv:"≪̸",nmid:"∤",NoBreak:"⁠",NonBreakingSpace:" ",Nopf:"ℕ",nopf:"𝕟",Not:"⫬",not:"¬",NotCongruent:"≢",NotCupCap:"≭",NotDoubleVerticalBar:"∦",NotElement:"∉",NotEqual:"≠",NotEqualTilde:"≂̸",NotExists:"∄",NotGreater:"≯",NotGreaterEqual:"≱",NotGreaterFullEqual:"≧̸",NotGreaterGreater:"≫̸",NotGreaterLess:"≹",NotGreaterSlantEqual:"⩾̸",NotGreaterTilde:"≵",NotHumpDownHump:"≎̸",NotHumpEqual:"≏̸",notin:"∉",notindot:"⋵̸",notinE:"⋹̸",notinva:"∉",notinvb:"⋷",notinvc:"⋶",NotLeftTriangle:"⋪",NotLeftTriangleBar:"⧏̸",NotLeftTriangleEqual:"⋬",NotLess:"≮",NotLessEqual:"≰",NotLessGreater:"≸",NotLessLess:"≪̸",NotLessSlantEqual:"⩽̸",NotLessTilde:"≴",NotNestedGreaterGreater:"⪢̸",NotNestedLessLess:"⪡̸",notni:"∌",notniva:"∌",notnivb:"⋾",notnivc:"⋽",NotPrecedes:"⊀",NotPrecedesEqual:"⪯̸",NotPrecedesSlantEqual:"⋠",NotReverseElement:"∌",NotRightTriangle:"⋫",NotRightTriangleBar:"⧐̸",NotRightTriangleEqual:"⋭",NotSquareSubset:"⊏̸",NotSquareSubsetEqual:"⋢",NotSquareSuperset:"⊐̸",NotSquareSupersetEqual:"⋣",NotSubset:"⊂⃒",NotSubsetEqual:"⊈",NotSucceeds:"⊁",NotSucceedsEqual:"⪰̸",NotSucceedsSlantEqual:"⋡",NotSucceedsTilde:"≿̸",NotSuperset:"⊃⃒",NotSupersetEqual:"⊉",NotTilde:"≁",NotTildeEqual:"≄",NotTildeFullEqual:"≇",NotTildeTilde:"≉",NotVerticalBar:"∤",npar:"∦",nparallel:"∦",nparsl:"⫽⃥",npart:"∂̸",npolint:"⨔",npr:"⊀",nprcue:"⋠",npre:"⪯̸",nprec:"⊀",npreceq:"⪯̸",nrArr:"⇏",nrarr:"↛",nrarrc:"⤳̸",nrarrw:"↝̸",nRightarrow:"⇏",nrightarrow:"↛",nrtri:"⋫",nrtrie:"⋭",nsc:"⊁",nsccue:"⋡",nsce:"⪰̸",Nscr:"𝒩",nscr:"𝓃",nshortmid:"∤",nshortparallel:"∦",nsim:"≁",nsime:"≄",nsimeq:"≄",nsmid:"∤",nspar:"∦",nsqsube:"⋢",nsqsupe:"⋣",nsub:"⊄",nsubE:"⫅̸",nsube:"⊈",nsubset:"⊂⃒",nsubseteq:"⊈",nsubseteqq:"⫅̸",nsucc:"⊁",nsucceq:"⪰̸",nsup:"⊅",nsupE:"⫆̸",nsupe:"⊉",nsupset:"⊃⃒",nsupseteq:"⊉",nsupseteqq:"⫆̸",ntgl:"≹",Ntilde:"Ñ",ntilde:"ñ",ntlg:"≸",ntriangleleft:"⋪",ntrianglelefteq:"⋬",ntriangleright:"⋫",ntrianglerighteq:"⋭",Nu:"Ν",nu:"ν",num:"#",numero:"№",numsp:" ",nvap:"≍⃒",nVDash:"⊯",nVdash:"⊮",nvDash:"⊭",nvdash:"⊬",nvge:"≥⃒",nvgt:">⃒",nvHarr:"⤄",nvinfin:"⧞",nvlArr:"⤂",nvle:"≤⃒",nvlt:"<⃒",nvltrie:"⊴⃒",nvrArr:"⤃",nvrtrie:"⊵⃒",nvsim:"∼⃒",nwarhk:"⤣",nwArr:"⇖",nwarr:"↖",nwarrow:"↖",nwnear:"⤧",Oacute:"Ó",oacute:"ó",oast:"⊛",ocir:"⊚",Ocirc:"Ô",ocirc:"ô",Ocy:"О",ocy:"о",odash:"⊝",Odblac:"Ő",odblac:"ő",odiv:"⨸",odot:"⊙",odsold:"⦼",OElig:"Œ",oelig:"œ",ofcir:"⦿",Ofr:"𝔒",ofr:"𝔬",ogon:"˛",Ograve:"Ò",ograve:"ò",ogt:"⧁",ohbar:"⦵",ohm:"Ω",oint:"∮",olarr:"↺",olcir:"⦾",olcross:"⦻",oline:"‾",olt:"⧀",Omacr:"Ō",omacr:"ō",Omega:"Ω",omega:"ω",Omicron:"Ο",omicron:"ο",omid:"⦶",ominus:"⊖",Oopf:"𝕆",oopf:"𝕠",opar:"⦷",OpenCurlyDoubleQuote:"“",OpenCurlyQuote:"‘",operp:"⦹",oplus:"⊕",Or:"⩔",or:"∨",orarr:"↻",ord:"⩝",order:"ℴ",orderof:"ℴ",ordf:"ª",ordm:"º",origof:"⊶",oror:"⩖",orslope:"⩗",orv:"⩛",oS:"Ⓢ",Oscr:"𝒪",oscr:"ℴ",Oslash:"Ø",oslash:"ø",osol:"⊘",Otilde:"Õ",otilde:"õ",Otimes:"⨷",otimes:"⊗",otimesas:"⨶",Ouml:"Ö",ouml:"ö",ovbar:"⌽",OverBar:"‾",OverBrace:"⏞",OverBracket:"⎴",OverParenthesis:"⏜",par:"∥",para:"¶",parallel:"∥",parsim:"⫳",parsl:"⫽",part:"∂",PartialD:"∂",Pcy:"П",pcy:"п",percnt:"%",period:".",permil:"‰",perp:"⊥",pertenk:"‱",Pfr:"𝔓",pfr:"𝔭",Phi:"Φ",phi:"φ",phiv:"ϕ",phmmat:"ℳ",phone:"☎",Pi:"Π",pi:"π",pitchfork:"⋔",piv:"ϖ",planck:"ℏ",planckh:"ℎ",plankv:"ℏ",plus:"+",plusacir:"⨣",plusb:"⊞",pluscir:"⨢",plusdo:"∔",plusdu:"⨥",pluse:"⩲",PlusMinus:"±",plusmn:"±",plussim:"⨦",plustwo:"⨧",pm:"±",Poincareplane:"ℌ",pointint:"⨕",Popf:"ℙ",popf:"𝕡",pound:"£",Pr:"⪻",pr:"≺",prap:"⪷",prcue:"≼",prE:"⪳",pre:"⪯",prec:"≺",precapprox:"⪷",preccurlyeq:"≼",Precedes:"≺",PrecedesEqual:"⪯",PrecedesSlantEqual:"≼",PrecedesTilde:"≾",preceq:"⪯",precnapprox:"⪹",precneqq:"⪵",precnsim:"⋨",precsim:"≾",Prime:"″",prime:"′",primes:"ℙ",prnap:"⪹",prnE:"⪵",prnsim:"⋨",prod:"∏",Product:"∏",profalar:"⌮",profline:"⌒",profsurf:"⌓",prop:"∝",Proportion:"∷",Proportional:"∝",propto:"∝",prsim:"≾",prurel:"⊰",Pscr:"𝒫",pscr:"𝓅",Psi:"Ψ",psi:"ψ",puncsp:" ",Qfr:"𝔔",qfr:"𝔮",qint:"⨌",Qopf:"ℚ",qopf:"𝕢",qprime:"⁗",Qscr:"𝒬",qscr:"𝓆",quaternions:"ℍ",quatint:"⨖",quest:"?",questeq:"≟",QUOT:'"',quot:'"',rAarr:"⇛",race:"∽̱",Racute:"Ŕ",racute:"ŕ",radic:"√",raemptyv:"⦳",Rang:"⟫",rang:"⟩",rangd:"⦒",range:"⦥",rangle:"⟩",raquo:"»",Rarr:"↠",rArr:"⇒",rarr:"→",rarrap:"⥵",rarrb:"⇥",rarrbfs:"⤠",rarrc:"⤳",rarrfs:"⤞",rarrhk:"↪",rarrlp:"↬",rarrpl:"⥅",rarrsim:"⥴",Rarrtl:"⤖",rarrtl:"↣",rarrw:"↝",rAtail:"⤜",ratail:"⤚",ratio:"∶",rationals:"ℚ",RBarr:"⤐",rBarr:"⤏",rbarr:"⤍",rbbrk:"❳",rbrace:"}",rbrack:"]",rbrke:"⦌",rbrksld:"⦎",rbrkslu:"⦐",Rcaron:"Ř",rcaron:"ř",Rcedil:"Ŗ",rcedil:"ŗ",rceil:"⌉",rcub:"}",Rcy:"Р",rcy:"р",rdca:"⤷",rdldhar:"⥩",rdquo:"”",rdquor:"”",rdsh:"↳",Re:"ℜ",real:"ℜ",realine:"ℛ",realpart:"ℜ",reals:"ℝ",rect:"▭",REG:"®",reg:"®",ReverseElement:"∋",ReverseEquilibrium:"⇋",ReverseUpEquilibrium:"⥯",rfisht:"⥽",rfloor:"⌋",Rfr:"ℜ",rfr:"𝔯",rHar:"⥤",rhard:"⇁",rharu:"⇀",rharul:"⥬",Rho:"Ρ",rho:"ρ",rhov:"ϱ",RightAngleBracket:"⟩",RightArrow:"→",Rightarrow:"⇒",rightarrow:"→",RightArrowBar:"⇥",RightArrowLeftArrow:"⇄",rightarrowtail:"↣",RightCeiling:"⌉",RightDoubleBracket:"⟧",RightDownTeeVector:"⥝",RightDownVector:"⇂",RightDownVectorBar:"⥕",RightFloor:"⌋",rightharpoondown:"⇁",rightharpoonup:"⇀",rightleftarrows:"⇄",rightleftharpoons:"⇌",rightrightarrows:"⇉",rightsquigarrow:"↝",RightTee:"⊢",RightTeeArrow:"↦",RightTeeVector:"⥛",rightthreetimes:"⋌",RightTriangle:"⊳",RightTriangleBar:"⧐",RightTriangleEqual:"⊵",RightUpDownVector:"⥏",RightUpTeeVector:"⥜",RightUpVector:"↾",RightUpVectorBar:"⥔",RightVector:"⇀",RightVectorBar:"⥓",ring:"˚",risingdotseq:"≓",rlarr:"⇄",rlhar:"⇌",rlm:"‏",rmoust:"⎱",rmoustache:"⎱",rnmid:"⫮",roang:"⟭",roarr:"⇾",robrk:"⟧",ropar:"⦆",Ropf:"ℝ",ropf:"𝕣",roplus:"⨮",rotimes:"⨵",RoundImplies:"⥰",rpar:")",rpargt:"⦔",rppolint:"⨒",rrarr:"⇉",Rrightarrow:"⇛",rsaquo:"›",Rscr:"ℛ",rscr:"𝓇",Rsh:"↱",rsh:"↱",rsqb:"]",rsquo:"’",rsquor:"’",rthree:"⋌",rtimes:"⋊",rtri:"▹",rtrie:"⊵",rtrif:"▸",rtriltri:"⧎",RuleDelayed:"⧴",ruluhar:"⥨",rx:"℞",Sacute:"Ś",sacute:"ś",sbquo:"‚",Sc:"⪼",sc:"≻",scap:"⪸",Scaron:"Š",scaron:"š",sccue:"≽",scE:"⪴",sce:"⪰",Scedil:"Ş",scedil:"ş",Scirc:"Ŝ",scirc:"ŝ",scnap:"⪺",scnE:"⪶",scnsim:"⋩",scpolint:"⨓",scsim:"≿",Scy:"С",scy:"с",sdot:"⋅",sdotb:"⊡",sdote:"⩦",searhk:"⤥",seArr:"⇘",searr:"↘",searrow:"↘",sect:"§",semi:";",seswar:"⤩",setminus:"∖",setmn:"∖",sext:"✶",Sfr:"𝔖",sfr:"𝔰",sfrown:"⌢",sharp:"♯",SHCHcy:"Щ",shchcy:"щ",SHcy:"Ш",shcy:"ш",ShortDownArrow:"↓",ShortLeftArrow:"←",shortmid:"∣",shortparallel:"∥",ShortRightArrow:"→",ShortUpArrow:"↑",shy:"­",Sigma:"Σ",sigma:"σ",sigmaf:"ς",sigmav:"ς",sim:"∼",simdot:"⩪",sime:"≃",simeq:"≃",simg:"⪞",simgE:"⪠",siml:"⪝",simlE:"⪟",simne:"≆",simplus:"⨤",simrarr:"⥲",slarr:"←",SmallCircle:"∘",smallsetminus:"∖",smashp:"⨳",smeparsl:"⧤",smid:"∣",smile:"⌣",smt:"⪪",smte:"⪬",smtes:"⪬︀",SOFTcy:"Ь",softcy:"ь",sol:"/",solb:"⧄",solbar:"⌿",Sopf:"𝕊",sopf:"𝕤",spades:"♠",spadesuit:"♠",spar:"∥",sqcap:"⊓",sqcaps:"⊓︀",sqcup:"⊔",sqcups:"⊔︀",Sqrt:"√",sqsub:"⊏",sqsube:"⊑",sqsubset:"⊏",sqsubseteq:"⊑",sqsup:"⊐",sqsupe:"⊒",sqsupset:"⊐",sqsupseteq:"⊒",squ:"□",Square:"□",square:"□",SquareIntersection:"⊓",SquareSubset:"⊏",SquareSubsetEqual:"⊑",SquareSuperset:"⊐",SquareSupersetEqual:"⊒",SquareUnion:"⊔",squarf:"▪",squf:"▪",srarr:"→",Sscr:"𝒮",sscr:"𝓈",ssetmn:"∖",ssmile:"⌣",sstarf:"⋆",Star:"⋆",star:"☆",starf:"★",straightepsilon:"ϵ",straightphi:"ϕ",strns:"¯",Sub:"⋐",sub:"⊂",subdot:"⪽",subE:"⫅",sube:"⊆",subedot:"⫃",submult:"⫁",subnE:"⫋",subne:"⊊",subplus:"⪿",subrarr:"⥹",Subset:"⋐",subset:"⊂",subseteq:"⊆",subseteqq:"⫅",SubsetEqual:"⊆",subsetneq:"⊊",subsetneqq:"⫋",subsim:"⫇",subsub:"⫕",subsup:"⫓",succ:"≻",succapprox:"⪸",succcurlyeq:"≽",Succeeds:"≻",SucceedsEqual:"⪰",SucceedsSlantEqual:"≽",SucceedsTilde:"≿",succeq:"⪰",succnapprox:"⪺",succneqq:"⪶",succnsim:"⋩",succsim:"≿",SuchThat:"∋",Sum:"∑",sum:"∑",sung:"♪",Sup:"⋑",sup:"⊃",sup1:"¹",sup2:"²",sup3:"³",supdot:"⪾",supdsub:"⫘",supE:"⫆",supe:"⊇",supedot:"⫄",Superset:"⊃",SupersetEqual:"⊇",suphsol:"⟉",suphsub:"⫗",suplarr:"⥻",supmult:"⫂",supnE:"⫌",supne:"⊋",supplus:"⫀",Supset:"⋑",supset:"⊃",supseteq:"⊇",supseteqq:"⫆",supsetneq:"⊋",supsetneqq:"⫌",supsim:"⫈",supsub:"⫔",supsup:"⫖",swarhk:"⤦",swArr:"⇙",swarr:"↙",swarrow:"↙",swnwar:"⤪",szlig:"ß",Tab:"	",target:"⌖",Tau:"Τ",tau:"τ",tbrk:"⎴",Tcaron:"Ť",tcaron:"ť",Tcedil:"Ţ",tcedil:"ţ",Tcy:"Т",tcy:"т",tdot:"⃛",telrec:"⌕",Tfr:"𝔗",tfr:"𝔱",there4:"∴",Therefore:"∴",therefore:"∴",Theta:"Θ",theta:"θ",thetasym:"ϑ",thetav:"ϑ",thickapprox:"≈",thicksim:"∼",ThickSpace:"  ",thinsp:" ",ThinSpace:" ",thkap:"≈",thksim:"∼",THORN:"Þ",thorn:"þ",Tilde:"∼",tilde:"˜",TildeEqual:"≃",TildeFullEqual:"≅",TildeTilde:"≈",times:"×",timesb:"⊠",timesbar:"⨱",timesd:"⨰",tint:"∭",toea:"⤨",top:"⊤",topbot:"⌶",topcir:"⫱",Topf:"𝕋",topf:"𝕥",topfork:"⫚",tosa:"⤩",tprime:"‴",TRADE:"™",trade:"™",triangle:"▵",triangledown:"▿",triangleleft:"◃",trianglelefteq:"⊴",triangleq:"≜",triangleright:"▹",trianglerighteq:"⊵",tridot:"◬",trie:"≜",triminus:"⨺",TripleDot:"⃛",triplus:"⨹",trisb:"⧍",tritime:"⨻",trpezium:"⏢",Tscr:"𝒯",tscr:"𝓉",TScy:"Ц",tscy:"ц",TSHcy:"Ћ",tshcy:"ћ",Tstrok:"Ŧ",tstrok:"ŧ",twixt:"≬",twoheadleftarrow:"↞",twoheadrightarrow:"↠",Uacute:"Ú",uacute:"ú",Uarr:"↟",uArr:"⇑",uarr:"↑",Uarrocir:"⥉",Ubrcy:"Ў",ubrcy:"ў",Ubreve:"Ŭ",ubreve:"ŭ",Ucirc:"Û",ucirc:"û",Ucy:"У",ucy:"у",udarr:"⇅",Udblac:"Ű",udblac:"ű",udhar:"⥮",ufisht:"⥾",Ufr:"𝔘",ufr:"𝔲",Ugrave:"Ù",ugrave:"ù",uHar:"⥣",uharl:"↿",uharr:"↾",uhblk:"▀",ulcorn:"⌜",ulcorner:"⌜",ulcrop:"⌏",ultri:"◸",Umacr:"Ū",umacr:"ū",uml:"¨",UnderBar:"_",UnderBrace:"⏟",UnderBracket:"⎵",UnderParenthesis:"⏝",Union:"⋃",UnionPlus:"⊎",Uogon:"Ų",uogon:"ų",Uopf:"𝕌",uopf:"𝕦",UpArrow:"↑",Uparrow:"⇑",uparrow:"↑",UpArrowBar:"⤒",UpArrowDownArrow:"⇅",UpDownArrow:"↕",Updownarrow:"⇕",updownarrow:"↕",UpEquilibrium:"⥮",upharpoonleft:"↿",upharpoonright:"↾",uplus:"⊎",UpperLeftArrow:"↖",UpperRightArrow:"↗",Upsi:"ϒ",upsi:"υ",upsih:"ϒ",Upsilon:"Υ",upsilon:"υ",UpTee:"⊥",UpTeeArrow:"↥",upuparrows:"⇈",urcorn:"⌝",urcorner:"⌝",urcrop:"⌎",Uring:"Ů",uring:"ů",urtri:"◹",Uscr:"𝒰",uscr:"𝓊",utdot:"⋰",Utilde:"Ũ",utilde:"ũ",utri:"▵",utrif:"▴",uuarr:"⇈",Uuml:"Ü",uuml:"ü",uwangle:"⦧",vangrt:"⦜",varepsilon:"ϵ",varkappa:"ϰ",varnothing:"∅",varphi:"ϕ",varpi:"ϖ",varpropto:"∝",vArr:"⇕",varr:"↕",varrho:"ϱ",varsigma:"ς",varsubsetneq:"⊊︀",varsubsetneqq:"⫋︀",varsupsetneq:"⊋︀",varsupsetneqq:"⫌︀",vartheta:"ϑ",vartriangleleft:"⊲",vartriangleright:"⊳",Vbar:"⫫",vBar:"⫨",vBarv:"⫩",Vcy:"В",vcy:"в",VDash:"⊫",Vdash:"⊩",vDash:"⊨",vdash:"⊢",Vdashl:"⫦",Vee:"⋁",vee:"∨",veebar:"⊻",veeeq:"≚",vellip:"⋮",Verbar:"‖",verbar:"|",Vert:"‖",vert:"|",VerticalBar:"∣",VerticalLine:"|",VerticalSeparator:"❘",VerticalTilde:"≀",VeryThinSpace:" ",Vfr:"𝔙",vfr:"𝔳",vltri:"⊲",vnsub:"⊂⃒",vnsup:"⊃⃒",Vopf:"𝕍",vopf:"𝕧",vprop:"∝",vrtri:"⊳",Vscr:"𝒱",vscr:"𝓋",vsubnE:"⫋︀",vsubne:"⊊︀",vsupnE:"⫌︀",vsupne:"⊋︀",Vvdash:"⊪",vzigzag:"⦚",Wcirc:"Ŵ",wcirc:"ŵ",wedbar:"⩟",Wedge:"⋀",wedge:"∧",wedgeq:"≙",weierp:"℘",Wfr:"𝔚",wfr:"𝔴",Wopf:"𝕎",wopf:"𝕨",wp:"℘",wr:"≀",wreath:"≀",Wscr:"𝒲",wscr:"𝓌",xcap:"⋂",xcirc:"◯",xcup:"⋃",xdtri:"▽",Xfr:"𝔛",xfr:"𝔵",xhArr:"⟺",xharr:"⟷",Xi:"Ξ",xi:"ξ",xlArr:"⟸",xlarr:"⟵",xmap:"⟼",xnis:"⋻",xodot:"⨀",Xopf:"𝕏",xopf:"𝕩",xoplus:"⨁",xotime:"⨂",xrArr:"⟹",xrarr:"⟶",Xscr:"𝒳",xscr:"𝓍",xsqcup:"⨆",xuplus:"⨄",xutri:"△",xvee:"⋁",xwedge:"⋀",Yacute:"Ý",yacute:"ý",YAcy:"Я",yacy:"я",Ycirc:"Ŷ",ycirc:"ŷ",Ycy:"Ы",ycy:"ы",yen:"¥",Yfr:"𝔜",yfr:"𝔶",YIcy:"Ї",yicy:"ї",Yopf:"𝕐",yopf:"𝕪",Yscr:"𝒴",yscr:"𝓎",YUcy:"Ю",yucy:"ю",Yuml:"Ÿ",yuml:"ÿ",Zacute:"Ź",zacute:"ź",Zcaron:"Ž",zcaron:"ž",Zcy:"З",zcy:"з",Zdot:"Ż",zdot:"ż",zeetrf:"ℨ",ZeroWidthSpace:"​",Zeta:"Ζ",zeta:"ζ",Zfr:"ℨ",zfr:"𝔷",ZHcy:"Ж",zhcy:"ж",zigrarr:"⇝",Zopf:"ℤ",zopf:"𝕫",Zscr:"𝒵",zscr:"𝓏",zwj:"‍",zwnj:"‌"}),r.entityMap=r.HTML_ENTITIES})(Yd)),Yd}var Qu={},my;function XI(){if(my)return Qu;my=1;var r=Nh().NAMESPACE,e=/[A-Z_a-z\xC0-\xD6\xD8-\xF6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,t=new RegExp("[\\-\\.0-9"+e.source.slice(1,-1)+"\\u00B7\\u0300-\\u036F\\u203F-\\u2040]"),i=new RegExp("^"+e.source+t.source+"*(?::"+e.source+t.source+"*)?$"),s=0,n=1,a=2,o=3,l=4,u=5,c=6,h=7;function f(P,R){this.message=P,this.locator=R,Error.captureStackTrace&&Error.captureStackTrace(this,f)}f.prototype=new Error,f.prototype.name=f.name;function m(){}m.prototype={parse:function(P,R,X){var j=this.domBuilder;j.startDocument(),T(R,R={}),S(P,R,X,j,this.errorHandler),j.endDocument()}};function S(P,R,X,j,Z){function Y(tt){if(tt>65535){tt-=65536;var it=55296+(tt>>10),Xi=56320+(tt&1023);return String.fromCharCode(it,Xi)}else return String.fromCharCode(tt)}function te(tt){var it=tt.slice(1,-1);return Object.hasOwnProperty.call(X,it)?X[it]:it.charAt(0)==="#"?Y(parseInt(it.substr(1).replace("x","0x"))):(Z.error("entity not found:"+tt),tt)}function le(tt){if(tt>Pe){var it=P.substring(Pe,tt).replace(/&#?\w+;/g,te);ae&&G(Pe),j.characters(it,0,tt-Pe),Pe=tt}}function G(tt,it){for(;tt>=J&&(it=ne.exec(P));)re=it.index,J=re+it[0].length,ae.lineNumber++;ae.columnNumber=tt-re+1}for(var re=0,J=0,ne=/.*(?:\r\n?|\n)|.*$/g,ae=j.locator,ve=[{currentNSMap:R}],xe={},Pe=0;;){try{var Se=P.indexOf("<",Pe);if(Se<0){if(!P.substr(Pe).match(/^\s*$/)){var at=j.doc,ft=at.createTextNode(P.substr(Pe));at.appendChild(ft),j.currentElement=ft}return}switch(Se>Pe&&le(Se),P.charAt(Se+1)){case"/":var xt=P.indexOf(">",Se+3),Ge=P.substring(Se+2,xt).replace(/[ \t\n\r]+$/g,""),_t=ve.pop();xt<0?(Ge=P.substring(Se+2).replace(/[\s<].*/,""),Z.error("end tag name: "+Ge+" is not complete:"+_t.tagName),xt=Se+1+Ge.length):Ge.match(/\s</)&&(Ge=Ge.replace(/[\s<].*/,""),Z.error("end tag name: "+Ge+" maybe not complete"),xt=Se+1+Ge.length);var yi=_t.localNSMap,Pt=_t.tagName==Ge,Dt=Pt||_t.tagName&&_t.tagName.toLowerCase()==Ge.toLowerCase();if(Dt){if(j.endElement(_t.uri,_t.localName,Ge),yi)for(var xr in yi)Object.prototype.hasOwnProperty.call(yi,xr)&&j.endPrefixMapping(xr);Pt||Z.fatalError("end tag name: "+Ge+" is not match the current start tagName:"+_t.tagName)}else ve.push(_t);xt++;break;case"?":ae&&G(Se),xt=A(P,Se,j);break;case"!":ae&&G(Se),xt=w(P,Se,j,Z);break;default:ae&&G(Se);var Mt=new I,ur=ve[ve.length-1].currentNSMap,xt=E(P,Se,Mt,ur,te,Z),Kr=Mt.length;if(!Mt.closed&&v(P,xt,Mt.tagName,xe)&&(Mt.closed=!0,X.nbsp||Z.warning("unclosed xml attribute")),ae&&Kr){for(var Jt=y(ae,{}),zt=0;zt<Kr;zt++){var $e=Mt[zt];G($e.offset),$e.locator=y(ae,{})}j.locator=Jt,C(Mt,j,ur)&&ve.push(Mt),j.locator=ae}else C(Mt,j,ur)&&ve.push(Mt);r.isHTML(Mt.uri)&&!Mt.closed?xt=_(P,xt,Mt.tagName,te,j):xt++}}catch(tt){if(tt instanceof f)throw tt;Z.error("element parse error: "+tt),xt=-1}xt>Pe?Pe=xt:le(Math.max(Se,Pe)+1)}}function y(P,R){return R.lineNumber=P.lineNumber,R.columnNumber=P.columnNumber,R}function E(P,R,X,j,Z,Y){function te(ae,ve,xe){X.attributeNames.hasOwnProperty(ae)&&Y.fatalError("Attribute "+ae+" redefined"),X.addValue(ae,ve.replace(/[\t\n\r]/g," ").replace(/&#?\w+;/g,Z),xe)}for(var le,G,re=++R,J=s;;){var ne=P.charAt(re);switch(ne){case"=":if(J===n)le=P.slice(R,re),J=o;else if(J===a)J=o;else throw new Error("attribute equal must after attrName");break;case"'":case'"':if(J===o||J===n)if(J===n&&(Y.warning('attribute value must after "="'),le=P.slice(R,re)),R=re+1,re=P.indexOf(ne,R),re>0)G=P.slice(R,re),te(le,G,R-1),J=u;else throw new Error("attribute value no end '"+ne+"' match");else if(J==l)G=P.slice(R,re),te(le,G,R),Y.warning('attribute "'+le+'" missed start quot('+ne+")!!"),R=re+1,J=u;else throw new Error('attribute value must after "="');break;case"/":switch(J){case s:X.setTagName(P.slice(R,re));case u:case c:case h:J=h,X.closed=!0;case l:case n:break;case a:X.closed=!0;break;default:throw new Error("attribute invalid close char('/')")}break;case"":return Y.error("unexpected end of input"),J==s&&X.setTagName(P.slice(R,re)),re;case">":switch(J){case s:X.setTagName(P.slice(R,re));case u:case c:case h:break;case l:case n:G=P.slice(R,re),G.slice(-1)==="/"&&(X.closed=!0,G=G.slice(0,-1));case a:J===a&&(G=le),J==l?(Y.warning('attribute "'+G+'" missed quot(")!'),te(le,G,R)):((!r.isHTML(j[""])||!G.match(/^(?:disabled|checked|selected)$/i))&&Y.warning('attribute "'+G+'" missed value!! "'+G+'" instead!!'),te(G,G,R));break;case o:throw new Error("attribute value missed!!")}return re;case"":ne=" ";default:if(ne<=" ")switch(J){case s:X.setTagName(P.slice(R,re)),J=c;break;case n:le=P.slice(R,re),J=a;break;case l:var G=P.slice(R,re);Y.warning('attribute "'+G+'" missed quot(")!!'),te(le,G,R);case u:J=c;break}else switch(J){case a:X.tagName,(!r.isHTML(j[""])||!le.match(/^(?:disabled|checked|selected)$/i))&&Y.warning('attribute "'+le+'" missed value!! "'+le+'" instead2!!'),te(le,le,R),R=re,J=n;break;case u:Y.warning('attribute space is required"'+le+'"!!');case c:J=n,R=re;break;case o:J=l,R=re;break;case h:throw new Error("elements closed character '/' and '>' must be connected to")}}re++}}function C(P,R,X){for(var j=P.tagName,Z=null,ne=P.length;ne--;){var Y=P[ne],te=Y.qName,le=Y.value,ae=te.indexOf(":");if(ae>0)var G=Y.prefix=te.slice(0,ae),re=te.slice(ae+1),J=G==="xmlns"&&re;else re=te,G=null,J=te==="xmlns"&&"";Y.localName=re,J!==!1&&(Z==null&&(Z={},T(X,X={})),X[J]=Z[J]=le,Y.uri=r.XMLNS,R.startPrefixMapping(J,le))}for(var ne=P.length;ne--;){Y=P[ne];var G=Y.prefix;G&&(G==="xml"&&(Y.uri=r.XML),G!=="xmlns"&&(Y.uri=X[G||""]))}var ae=j.indexOf(":");ae>0?(G=P.prefix=j.slice(0,ae),re=P.localName=j.slice(ae+1)):(G=null,re=P.localName=j);var ve=P.uri=X[G||""];if(R.startElement(ve,re,j,P),P.closed){if(R.endElement(ve,re,j),Z)for(G in Z)Object.prototype.hasOwnProperty.call(Z,G)&&R.endPrefixMapping(G)}else return P.currentNSMap=X,P.localNSMap=Z,!0}function _(P,R,X,j,Z){if(/^(?:script|textarea)$/i.test(X)){var Y=P.indexOf("</"+X+">",R),te=P.substring(R+1,Y);if(/[&<]/.test(te))return/^script$/i.test(X)?(Z.characters(te,0,te.length),Y):(te=te.replace(/&#?\w+;/g,j),Z.characters(te,0,te.length),Y)}return R+1}function v(P,R,X,j){var Z=j[X];return Z==null&&(Z=P.lastIndexOf("</"+X+">"),Z<R&&(Z=P.lastIndexOf("</"+X)),j[X]=Z),Z<R}function T(P,R){for(var X in P)Object.prototype.hasOwnProperty.call(P,X)&&(R[X]=P[X])}function w(P,R,X,j){var Z=P.charAt(R+2);switch(Z){case"-":if(P.charAt(R+3)==="-"){var Y=P.indexOf("-->",R+4);return Y>R?(X.comment(P,R+4,Y-R-4),Y+3):(j.error("Unclosed comment"),-1)}else return-1;default:if(P.substr(R+3,6)=="CDATA["){var Y=P.indexOf("]]>",R+9);return X.startCDATA(),X.characters(P,R+9,Y-R-9),X.endCDATA(),Y+3}var te=N(P,R),le=te.length;if(le>1&&/!doctype/i.test(te[0][0])){var G=te[1][0],re=!1,J=!1;le>3&&(/^public$/i.test(te[2][0])?(re=te[3][0],J=le>4&&te[4][0]):/^system$/i.test(te[2][0])&&(J=te[3][0]));var ne=te[le-1];return X.startDTD(G,re,J),X.endDTD(),ne.index+ne[0].length}}return-1}function A(P,R,X){var j=P.indexOf("?>",R);if(j){var Z=P.substring(R,j).match(/^<\?(\S*)\s*([\s\S]*?)\s*$/);return Z?(Z[0].length,X.processingInstruction(Z[1],Z[2]),j+2):-1}return-1}function I(){this.attributeNames={}}I.prototype={setTagName:function(P){if(!i.test(P))throw new Error("invalid tagName:"+P);this.tagName=P},addValue:function(P,R,X){if(!i.test(P))throw new Error("invalid attribute:"+P);this.attributeNames[P]=this.length,this[this.length++]={qName:P,value:R,offset:X}},length:0,getLocalName:function(P){return this[P].localName},getLocator:function(P){return this[P].locator},getQName:function(P){return this[P].qName},getURI:function(P){return this[P].uri},getValue:function(P){return this[P].value}};function N(P,R){var X,j=[],Z=/'[^']+'|"[^"]+"|[^\s<>\/=]+=?|(\/?\s*>|<)/g;for(Z.lastIndex=R,Z.exec(P);X=Z.exec(P);)if(j.push(X),X[1])return j}return Qu.XMLReader=m,Qu.ParseError=f,Qu}var gy;function jI(){if(gy)return wo;gy=1;var r=Nh(),e=nT(),t=VI(),i=XI(),s=e.DOMImplementation,n=r.NAMESPACE,a=i.ParseError,o=i.XMLReader;function l(E){return E.replace(/\r[\n\u0085]/g,`
`).replace(/[\r\u0085\u2028]/g,`
`)}function u(E){this.options=E||{locator:{}}}u.prototype.parseFromString=function(E,C){var _=this.options,v=new o,T=_.domBuilder||new h,w=_.errorHandler,A=_.locator,I=_.xmlns||{},N=/\/x?html?$/.test(C),P=N?t.HTML_ENTITIES:t.XML_ENTITIES;A&&T.setDocumentLocator(A),v.errorHandler=c(w,T,A),v.domBuilder=_.domBuilder||T,N&&(I[""]=n.HTML),I.xml=I.xml||n.XML;var R=_.normalizeLineEndings||l;return E&&typeof E=="string"?v.parse(R(E),I,P):v.errorHandler.error("invalid doc source"),T.doc};function c(E,C,_){if(!E){if(C instanceof h)return C;E=C}var v={},T=E instanceof Function;_=_||{};function w(A){var I=E[A];!I&&T&&(I=E.length==2?function(N){E(A,N)}:E),v[A]=I&&function(N){I("[xmldom "+A+"]	"+N+m(_))}||function(){}}return w("warning"),w("error"),w("fatalError"),v}function h(){this.cdata=!1}function f(E,C){C.lineNumber=E.lineNumber,C.columnNumber=E.columnNumber}h.prototype={startDocument:function(){this.doc=new s().createDocument(null,null,null),this.locator&&(this.doc.documentURI=this.locator.systemId)},startElement:function(E,C,_,v){var T=this.doc,w=T.createElementNS(E,_||C),A=v.length;y(this,w),this.currentElement=w,this.locator&&f(this.locator,w);for(var I=0;I<A;I++){var E=v.getURI(I),N=v.getValue(I),_=v.getQName(I),P=T.createAttributeNS(E,_);this.locator&&f(v.getLocator(I),P),P.value=P.nodeValue=N,w.setAttributeNode(P)}},endElement:function(E,C,_){var v=this.currentElement;v.tagName,this.currentElement=v.parentNode},startPrefixMapping:function(E,C){},endPrefixMapping:function(E){},processingInstruction:function(E,C){var _=this.doc.createProcessingInstruction(E,C);this.locator&&f(this.locator,_),y(this,_)},ignorableWhitespace:function(E,C,_){},characters:function(E,C,_){if(E=S.apply(this,arguments),E){if(this.cdata)var v=this.doc.createCDATASection(E);else var v=this.doc.createTextNode(E);this.currentElement?this.currentElement.appendChild(v):/^\s*$/.test(E)&&this.doc.appendChild(v),this.locator&&f(this.locator,v)}},skippedEntity:function(E){},endDocument:function(){this.doc.normalize()},setDocumentLocator:function(E){(this.locator=E)&&(E.lineNumber=0)},comment:function(E,C,_){E=S.apply(this,arguments);var v=this.doc.createComment(E);this.locator&&f(this.locator,v),y(this,v)},startCDATA:function(){this.cdata=!0},endCDATA:function(){this.cdata=!1},startDTD:function(E,C,_){var v=this.doc.implementation;if(v&&v.createDocumentType){var T=v.createDocumentType(E,C,_);this.locator&&f(this.locator,T),y(this,T),this.doc.doctype=T}},warning:function(E){console.warn("[xmldom warning]	"+E,m(this.locator))},error:function(E){console.error("[xmldom error]	"+E,m(this.locator))},fatalError:function(E){throw new a(E,this.locator)}};function m(E){if(E)return`
@`+(E.systemId||"")+"#[line:"+E.lineNumber+",col:"+E.columnNumber+"]"}function S(E,C,_){return typeof E=="string"?E.substr(C,_):E.length>=C+_||C?new java.lang.String(E,C,_)+"":E}"endDTD,startEntity,endEntity,attributeDecl,elementDecl,externalEntityDecl,internalEntityDecl,resolveEntity,getExternalSubset,notationDecl,unparsedEntityDecl".replace(/\w+/g,function(E){h.prototype[E]=function(){return null}});function y(E,C){E.currentElement?E.currentElement.appendChild(C):E.doc.appendChild(C)}return wo.__DOMHandler=h,wo.normalizeLineEndings=l,wo.DOMParser=u,wo}var Oy;function zI(){if(Oy)return xo;Oy=1;var r=nT();return xo.DOMImplementation=r.DOMImplementation,xo.XMLSerializer=r.XMLSerializer,xo.DOMParser=jI().DOMParser,xo}var ZI=zI();/*! @name mpd-parser @version 1.3.1 @license Apache-2.0 */const yy=r=>!!r&&typeof r=="object",qt=(...r)=>r.reduce((e,t)=>(typeof t!="object"||Object.keys(t).forEach(i=>{Array.isArray(e[i])&&Array.isArray(t[i])?e[i]=e[i].concat(t[i]):yy(e[i])&&yy(t[i])?e[i]=qt(e[i],t[i]):e[i]=t[i]}),e),{}),aT=r=>Object.keys(r).map(e=>r[e]),WI=(r,e)=>{const t=[];for(let i=r;i<e;i++)t.push(i);return t},Ea=r=>r.reduce((e,t)=>e.concat(t),[]),oT=r=>{if(!r.length)return[];const e=[];for(let t=0;t<r.length;t++)e.push(r[t]);return e},HI=(r,e)=>r.reduce((t,i,s)=>(i[e]&&t.push(s),t),[]),YI=(r,e)=>aT(r.reduce((t,i)=>(i.forEach(s=>{t[e(s)]=s}),t),{}));var Aa={INVALID_NUMBER_OF_PERIOD:"INVALID_NUMBER_OF_PERIOD",DASH_EMPTY_MANIFEST:"DASH_EMPTY_MANIFEST",DASH_INVALID_XML:"DASH_INVALID_XML",NO_BASE_URL:"NO_BASE_URL",SEGMENT_TIME_UNSPECIFIED:"SEGMENT_TIME_UNSPECIFIED",UNSUPPORTED_UTC_TIMING_SCHEME:"UNSUPPORTED_UTC_TIMING_SCHEME"};const dl=({baseUrl:r="",source:e="",range:t="",indexRange:i=""})=>{const s={uri:e,resolvedUri:Bh(r||"",e)};if(t||i){const a=(t||i).split("-");let o=U.BigInt?U.BigInt(a[0]):parseInt(a[0],10),l=U.BigInt?U.BigInt(a[1]):parseInt(a[1],10);o<Number.MAX_SAFE_INTEGER&&typeof o=="bigint"&&(o=Number(o)),l<Number.MAX_SAFE_INTEGER&&typeof l=="bigint"&&(l=Number(l));let u;typeof l=="bigint"||typeof o=="bigint"?u=U.BigInt(l)-U.BigInt(o)+U.BigInt(1):u=l-o+1,typeof u=="bigint"&&u<Number.MAX_SAFE_INTEGER&&(u=Number(u)),s.byterange={length:u,offset:o}}return s},GI=r=>{let e;return typeof r.offset=="bigint"||typeof r.length=="bigint"?e=U.BigInt(r.offset)+U.BigInt(r.length)-U.BigInt(1):e=r.offset+r.length-1,`${r.offset}-${e}`},by=r=>(r&&typeof r!="number"&&(r=parseInt(r,10)),isNaN(r)?null:r),KI={static(r){const{duration:e,timescale:t=1,sourceDuration:i,periodDuration:s}=r,n=by(r.endNumber),a=e/t;return typeof n=="number"?{start:0,end:n}:typeof s=="number"?{start:0,end:s/a}:{start:0,end:i/a}},dynamic(r){const{NOW:e,clientOffset:t,availabilityStartTime:i,timescale:s=1,duration:n,periodStart:a=0,minimumUpdatePeriod:o=0,timeShiftBufferDepth:l=1/0}=r,u=by(r.endNumber),c=(e+t)/1e3,h=i+a,m=c+o-h,S=Math.ceil(m*s/n),y=Math.floor((c-h-l)*s/n),E=Math.floor((c-h)*s/n);return{start:Math.max(0,y),end:typeof u=="number"?u:Math.min(S,E)}}},JI=r=>e=>{const{duration:t,timescale:i=1,periodStart:s,startNumber:n=1}=r;return{number:n+e,duration:t/i,timeline:s,time:e*t}},cg=r=>{const{type:e,duration:t,timescale:i=1,periodDuration:s,sourceDuration:n}=r,{start:a,end:o}=KI[e](r),l=WI(a,o).map(JI(r));if(e==="static"){const u=l.length-1,c=typeof s=="number"?s:n;l[u].duration=c-t/i*u}return l},lT=r=>{const{baseUrl:e,initialization:t={},sourceDuration:i,indexRange:s="",periodStart:n,presentationTime:a,number:o=0,duration:l}=r;if(!e)throw new Error(Aa.NO_BASE_URL);const u=dl({baseUrl:e,source:t.sourceURL,range:t.range}),c=dl({baseUrl:e,source:e,indexRange:s});if(c.map=u,l){const h=cg(r);h.length&&(c.duration=h[0].duration,c.timeline=h[0].timeline)}else i&&(c.duration=i,c.timeline=n);return c.presentationTime=a||n,c.number=o,[c]},hg=(r,e,t)=>{const i=r.sidx.map?r.sidx.map:null,s=r.sidx.duration,n=r.timeline||0,a=r.sidx.byterange,o=a.offset+a.length,l=e.timescale,u=e.references.filter(E=>E.referenceType!==1),c=[],h=r.endList?"static":"dynamic",f=r.sidx.timeline;let m=f,S=r.mediaSequence||0,y;typeof e.firstOffset=="bigint"?y=U.BigInt(o)+e.firstOffset:y=o+e.firstOffset;for(let E=0;E<u.length;E++){const C=e.references[E],_=C.referencedSize,v=C.subsegmentDuration;let T;typeof y=="bigint"?T=y+U.BigInt(_)-U.BigInt(1):T=y+_-1;const w=`${y}-${T}`,I=lT({baseUrl:t,timescale:l,timeline:n,periodStart:f,presentationTime:m,number:S,duration:v,sourceDuration:s,indexRange:w,type:h})[0];i&&(I.map=i),c.push(I),typeof y=="bigint"?y+=U.BigInt(_):y+=_,m+=v/l,S++}return r.segments=c,r},eR=["AUDIO","SUBTITLES"],tR=1/60,uT=r=>YI(r,({timeline:e})=>e).sort((e,t)=>e.timeline>t.timeline?1:-1),iR=(r,e)=>{for(let t=0;t<r.length;t++)if(r[t].attributes.NAME===e)return r[t];return null},vy=r=>{let e=[];return qI(r,eR,(t,i,s,n)=>{e=e.concat(t.playlists||[])}),e},Sy=({playlist:r,mediaSequence:e})=>{r.mediaSequence=e,r.segments.forEach((t,i)=>{t.number=r.mediaSequence+i})},rR=({oldPlaylists:r,newPlaylists:e,timelineStarts:t})=>{e.forEach(i=>{i.discontinuitySequence=t.findIndex(function({timeline:l}){return l===i.timeline});const s=iR(r,i.attributes.NAME);if(!s||i.sidx)return;const n=i.segments[0],a=s.segments.findIndex(function(l){return Math.abs(l.presentationTime-n.presentationTime)<tR});if(a===-1){Sy({playlist:i,mediaSequence:s.mediaSequence+s.segments.length}),i.segments[0].discontinuity=!0,i.discontinuityStarts.unshift(0),(!s.segments.length&&i.timeline>s.timeline||s.segments.length&&i.timeline>s.segments[s.segments.length-1].timeline)&&i.discontinuitySequence--;return}s.segments[a].discontinuity&&!n.discontinuity&&(n.discontinuity=!0,i.discontinuityStarts.unshift(0),i.discontinuitySequence--),Sy({playlist:i,mediaSequence:s.segments[a].number})})},sR=({oldManifest:r,newManifest:e})=>{const t=r.playlists.concat(vy(r)),i=e.playlists.concat(vy(e));return e.timelineStarts=uT([r.timelineStarts,e.timelineStarts]),rR({oldPlaylists:t,newPlaylists:i,timelineStarts:e.timelineStarts}),e},Fh=r=>r&&r.uri+"-"+GI(r.byterange),Gd=r=>{const e=r.reduce(function(i,s){return i[s.attributes.baseUrl]||(i[s.attributes.baseUrl]=[]),i[s.attributes.baseUrl].push(s),i},{});let t=[];return Object.values(e).forEach(i=>{const s=aT(i.reduce((n,a)=>{const o=a.attributes.id+(a.attributes.lang||"");return n[o]?(a.segments&&(a.segments[0]&&(a.segments[0].discontinuity=!0),n[o].segments.push(...a.segments)),a.attributes.contentProtection&&(n[o].attributes.contentProtection=a.attributes.contentProtection)):(n[o]=a,n[o].attributes.timelineStarts=[]),n[o].attributes.timelineStarts.push({start:a.attributes.periodStart,timeline:a.attributes.periodStart}),n},{}));t=t.concat(s)}),t.map(i=>(i.discontinuityStarts=HI(i.segments||[],"discontinuity"),i))},dg=(r,e)=>{const t=Fh(r.sidx),i=t&&e[t]&&e[t].sidx;return i&&hg(r,i,r.sidx.resolvedUri),r},nR=(r,e={})=>{if(!Object.keys(e).length)return r;for(const t in r)r[t]=dg(r[t],e);return r},aR=({attributes:r,segments:e,sidx:t,mediaSequence:i,discontinuitySequence:s,discontinuityStarts:n},a)=>{const o={attributes:{NAME:r.id,BANDWIDTH:r.bandwidth,CODECS:r.codecs,"PROGRAM-ID":1},uri:"",endList:r.type==="static",timeline:r.periodStart,resolvedUri:r.baseUrl||"",targetDuration:r.duration,discontinuitySequence:s,discontinuityStarts:n,timelineStarts:r.timelineStarts,mediaSequence:i,segments:e};return r.contentProtection&&(o.contentProtection=r.contentProtection),r.serviceLocation&&(o.attributes.serviceLocation=r.serviceLocation),t&&(o.sidx=t),a&&(o.attributes.AUDIO="audio",o.attributes.SUBTITLES="subs"),o},oR=({attributes:r,segments:e,mediaSequence:t,discontinuityStarts:i,discontinuitySequence:s})=>{typeof e>"u"&&(e=[{uri:r.baseUrl,timeline:r.periodStart,resolvedUri:r.baseUrl||"",duration:r.sourceDuration,number:0}],r.duration=r.sourceDuration);const n={NAME:r.id,BANDWIDTH:r.bandwidth,"PROGRAM-ID":1};r.codecs&&(n.CODECS=r.codecs);const a={attributes:n,uri:"",endList:r.type==="static",timeline:r.periodStart,resolvedUri:r.baseUrl||"",targetDuration:r.duration,timelineStarts:r.timelineStarts,discontinuityStarts:i,discontinuitySequence:s,mediaSequence:t,segments:e};return r.serviceLocation&&(a.attributes.serviceLocation=r.serviceLocation),a},lR=(r,e={},t=!1)=>{let i;const s=r.reduce((n,a)=>{const o=a.attributes.role&&a.attributes.role.value||"",l=a.attributes.lang||"";let u=a.attributes.label||"main";if(l&&!a.attributes.label){const h=o?` (${o})`:"";u=`${a.attributes.lang}${h}`}n[u]||(n[u]={language:l,autoselect:!0,default:o==="main",playlists:[],uri:""});const c=dg(aR(a,t),e);return n[u].playlists.push(c),typeof i>"u"&&o==="main"&&(i=a,i.default=!0),n},{});if(!i){const n=Object.keys(s)[0];s[n].default=!0}return s},uR=(r,e={})=>r.reduce((t,i)=>{const s=i.attributes.label||i.attributes.lang||"text",n=i.attributes.lang||"und";return t[s]||(t[s]={language:n,default:!1,autoselect:!1,playlists:[],uri:""}),t[s].playlists.push(dg(oR(i),e)),t},{}),cR=r=>r.reduce((e,t)=>(t&&t.forEach(i=>{const{channel:s,language:n}=i;e[n]={autoselect:!1,default:!1,instreamId:s,language:n},i.hasOwnProperty("aspectRatio")&&(e[n].aspectRatio=i.aspectRatio),i.hasOwnProperty("easyReader")&&(e[n].easyReader=i.easyReader),i.hasOwnProperty("3D")&&(e[n]["3D"]=i["3D"])}),e),{}),hR=({attributes:r,segments:e,sidx:t,discontinuityStarts:i})=>{const s={attributes:{NAME:r.id,AUDIO:"audio",SUBTITLES:"subs",RESOLUTION:{width:r.width,height:r.height},CODECS:r.codecs,BANDWIDTH:r.bandwidth,"PROGRAM-ID":1},uri:"",endList:r.type==="static",timeline:r.periodStart,resolvedUri:r.baseUrl||"",targetDuration:r.duration,discontinuityStarts:i,timelineStarts:r.timelineStarts,segments:e};return r.frameRate&&(s.attributes["FRAME-RATE"]=r.frameRate),r.contentProtection&&(s.contentProtection=r.contentProtection),r.serviceLocation&&(s.attributes.serviceLocation=r.serviceLocation),t&&(s.sidx=t),s},dR=({attributes:r})=>r.mimeType==="video/mp4"||r.mimeType==="video/webm"||r.contentType==="video",fR=({attributes:r})=>r.mimeType==="audio/mp4"||r.mimeType==="audio/webm"||r.contentType==="audio",pR=({attributes:r})=>r.mimeType==="text/vtt"||r.contentType==="text",mR=(r,e)=>{r.forEach(t=>{t.mediaSequence=0,t.discontinuitySequence=e.findIndex(function({timeline:i}){return i===t.timeline}),t.segments&&t.segments.forEach((i,s)=>{i.number=s})})},Ty=r=>r?Object.keys(r).reduce((e,t)=>{const i=r[t];return e.concat(i.playlists)},[]):[],gR=({dashPlaylists:r,locations:e,contentSteering:t,sidxMapping:i={},previousManifest:s,eventStream:n})=>{if(!r.length)return{};const{sourceDuration:a,type:o,suggestedPresentationDelay:l,minimumUpdatePeriod:u}=r[0].attributes,c=Gd(r.filter(dR)).map(hR),h=Gd(r.filter(fR)),f=Gd(r.filter(pR)),m=r.map(T=>T.attributes.captionServices).filter(Boolean),S={allowCache:!0,discontinuityStarts:[],segments:[],endList:!0,mediaGroups:{AUDIO:{},VIDEO:{},"CLOSED-CAPTIONS":{},SUBTITLES:{}},uri:"",duration:a,playlists:nR(c,i)};u>=0&&(S.minimumUpdatePeriod=u*1e3),e&&(S.locations=e),t&&(S.contentSteering=t),o==="dynamic"&&(S.suggestedPresentationDelay=l),n&&n.length>0&&(S.eventStream=n);const y=S.playlists.length===0,E=h.length?lR(h,i,y):null,C=f.length?uR(f,i):null,_=c.concat(Ty(E),Ty(C)),v=_.map(({timelineStarts:T})=>T);return S.timelineStarts=uT(v),mR(_,S.timelineStarts),E&&(S.mediaGroups.AUDIO.audio=E),C&&(S.mediaGroups.SUBTITLES.subs=C),m.length&&(S.mediaGroups["CLOSED-CAPTIONS"].cc=cR(m)),s?sR({oldManifest:s,newManifest:S}):S},OR=(r,e,t)=>{const{NOW:i,clientOffset:s,availabilityStartTime:n,timescale:a=1,periodStart:o=0,minimumUpdatePeriod:l=0}=r,u=(i+s)/1e3,c=n+o,f=u+l-c;return Math.ceil((f*a-e)/t)},cT=(r,e)=>{const{type:t,minimumUpdatePeriod:i=0,media:s="",sourceDuration:n,timescale:a=1,startNumber:o=1,periodStart:l}=r,u=[];let c=-1;for(let h=0;h<e.length;h++){const f=e[h],m=f.d,S=f.r||0,y=f.t||0;c<0&&(c=y),y&&y>c&&(c=y);let E;if(S<0){const v=h+1;v===e.length?t==="dynamic"&&i>0&&s.indexOf("$Number$")>0?E=OR(r,c,m):E=(n*a-c)/m:E=(e[v].t-c)/m}else E=S+1;const C=o+u.length+E;let _=o+u.length;for(;_<C;)u.push({number:_,duration:m/a,time:c,timeline:l}),c+=m,_++}return u},yR=/\$([A-z]*)(?:(%0)([0-9]+)d)?\$/g,bR=r=>(e,t,i,s)=>{if(e==="$$")return"$";if(typeof r[t]>"u")return e;const n=""+r[t];return t==="RepresentationID"||(i?s=parseInt(s,10):s=1,n.length>=s)?n:`${new Array(s-n.length+1).join("0")}${n}`},_y=(r,e)=>r.replace(yR,bR(e)),vR=(r,e)=>!r.duration&&!e?[{number:r.startNumber||1,duration:r.sourceDuration,time:0,timeline:r.periodStart}]:r.duration?cg(r):cT(r,e),SR=(r,e)=>{const t={RepresentationID:r.id,Bandwidth:r.bandwidth||0},{initialization:i={sourceURL:"",range:""}}=r,s=dl({baseUrl:r.baseUrl,source:_y(i.sourceURL,t),range:i.range});return vR(r,e).map(a=>{t.Number=a.number,t.Time=a.time;const o=_y(r.media||"",t),l=r.timescale||1,u=r.presentationTimeOffset||0,c=r.periodStart+(a.time-u)/l;return{uri:o,timeline:a.timeline,duration:a.duration,resolvedUri:Bh(r.baseUrl||"",o),map:s,number:a.number,presentationTime:c}})},TR=(r,e)=>{const{baseUrl:t,initialization:i={}}=r,s=dl({baseUrl:t,source:i.sourceURL,range:i.range}),n=dl({baseUrl:t,source:e.media,range:e.mediaRange});return n.map=s,n},_R=(r,e)=>{const{duration:t,segmentUrls:i=[],periodStart:s}=r;if(!t&&!e||t&&e)throw new Error(Aa.SEGMENT_TIME_UNSPECIFIED);const n=i.map(l=>TR(r,l));let a;return t&&(a=cg(r)),e&&(a=cT(r,e)),a.map((l,u)=>{if(n[u]){const c=n[u],h=r.timescale||1,f=r.presentationTimeOffset||0;return c.timeline=l.timeline,c.duration=l.duration,c.number=l.number,c.presentationTime=s+(l.time-f)/h,c}}).filter(l=>l)},xR=({attributes:r,segmentInfo:e})=>{let t,i;e.template?(i=SR,t=qt(r,e.template)):e.base?(i=lT,t=qt(r,e.base)):e.list&&(i=_R,t=qt(r,e.list));const s={attributes:r};if(!i)return s;const n=i(t,e.segmentTimeline);if(t.duration){const{duration:a,timescale:o=1}=t;t.duration=a/o}else n.length?t.duration=n.reduce((a,o)=>Math.max(a,Math.ceil(o.duration)),0):t.duration=0;return s.attributes=t,s.segments=n,e.base&&t.indexRange&&(s.sidx=n[0],s.segments=[]),s},wR=r=>r.map(xR),mt=(r,e)=>oT(r.childNodes).filter(({tagName:t})=>t===e),zl=r=>r.textContent.trim(),CR=r=>parseFloat(r.split("/").reduce((e,t)=>e/t)),Wn=r=>{const o=/P(?:(\d*)Y)?(?:(\d*)M)?(?:(\d*)D)?(?:T(?:(\d*)H)?(?:(\d*)M)?(?:([\d.]*)S)?)?/.exec(r);if(!o)return 0;const[l,u,c,h,f,m]=o.slice(1);return parseFloat(l||0)*31536e3+parseFloat(u||0)*2592e3+parseFloat(c||0)*86400+parseFloat(h||0)*3600+parseFloat(f||0)*60+parseFloat(m||0)},kR=r=>(/^\d+-\d+-\d+T\d+:\d+:\d+(\.\d+)?$/.test(r)&&(r+="Z"),Date.parse(r)),xy={mediaPresentationDuration(r){return Wn(r)},availabilityStartTime(r){return kR(r)/1e3},minimumUpdatePeriod(r){return Wn(r)},suggestedPresentationDelay(r){return Wn(r)},type(r){return r},timeShiftBufferDepth(r){return Wn(r)},start(r){return Wn(r)},width(r){return parseInt(r,10)},height(r){return parseInt(r,10)},bandwidth(r){return parseInt(r,10)},frameRate(r){return CR(r)},startNumber(r){return parseInt(r,10)},timescale(r){return parseInt(r,10)},presentationTimeOffset(r){return parseInt(r,10)},duration(r){const e=parseInt(r,10);return isNaN(e)?Wn(r):e},d(r){return parseInt(r,10)},t(r){return parseInt(r,10)},r(r){return parseInt(r,10)},presentationTime(r){return parseInt(r,10)},DEFAULT(r){return r}},Rt=r=>r&&r.attributes?oT(r.attributes).reduce((e,t)=>{const i=xy[t.name]||xy.DEFAULT;return e[t.name]=i(t.value),e},{}):{},ER={"urn:uuid:1077efec-c0b2-4d02-ace3-3c1e52e2fb4b":"org.w3.clearkey","urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed":"com.widevine.alpha","urn:uuid:9a04f079-9840-4286-ab92-e65be0885f95":"com.microsoft.playready","urn:uuid:f239e769-efa3-4850-9c16-a903c6932efb":"com.adobe.primetime","urn:mpeg:dash:mp4protection:2011":"mp4protection"},Uh=(r,e)=>e.length?Ea(r.map(function(t){return e.map(function(i){const s=zl(i),n=Bh(t.baseUrl,s),a=qt(Rt(i),{baseUrl:n});return n!==s&&!a.serviceLocation&&t.serviceLocation&&(a.serviceLocation=t.serviceLocation),a})})):r,fg=r=>{const e=mt(r,"SegmentTemplate")[0],t=mt(r,"SegmentList")[0],i=t&&mt(t,"SegmentURL").map(h=>qt({tag:"SegmentURL"},Rt(h))),s=mt(r,"SegmentBase")[0],n=t||e,a=n&&mt(n,"SegmentTimeline")[0],o=t||s||e,l=o&&mt(o,"Initialization")[0],u=e&&Rt(e);u&&l?u.initialization=l&&Rt(l):u&&u.initialization&&(u.initialization={sourceURL:u.initialization});const c={template:u,segmentTimeline:a&&mt(a,"S").map(h=>Rt(h)),list:t&&qt(Rt(t),{segmentUrls:i,initialization:Rt(l)}),base:s&&qt(Rt(s),{initialization:Rt(l)})};return Object.keys(c).forEach(h=>{c[h]||delete c[h]}),c},AR=(r,e,t)=>i=>{const s=mt(i,"BaseURL"),n=Uh(e,s),a=qt(r,Rt(i)),o=fg(i);return n.map(l=>({segmentInfo:qt(t,o),attributes:qt(a,l)}))},PR=r=>r.reduce((e,t)=>{const i=Rt(t);i.schemeIdUri&&(i.schemeIdUri=i.schemeIdUri.toLowerCase());const s=ER[i.schemeIdUri];if(s){e[s]={attributes:i};const n=mt(t,"cenc:pssh")[0];if(n){const a=zl(n);e[s].pssh=a&&J1(a)}}return e},{}),DR=r=>{if(r.schemeIdUri==="urn:scte:dash:cc:cea-608:2015")return(typeof r.value!="string"?[]:r.value.split(";")).map(t=>{let i,s;return s=t,/^CC\d=/.test(t)?[i,s]=t.split("="):/^CC\d$/.test(t)&&(i=t),{channel:i,language:s}});if(r.schemeIdUri==="urn:scte:dash:cc:cea-708:2015")return(typeof r.value!="string"?[]:r.value.split(";")).map(t=>{const i={channel:void 0,language:void 0,aspectRatio:1,easyReader:0,"3D":0};if(/=/.test(t)){const[s,n=""]=t.split("=");i.channel=s,i.language=t,n.split(",").forEach(a=>{const[o,l]=a.split(":");o==="lang"?i.language=l:o==="er"?i.easyReader=Number(l):o==="war"?i.aspectRatio=Number(l):o==="3D"&&(i["3D"]=Number(l))})}else i.language=t;return i.channel&&(i.channel="SERVICE"+i.channel),i})},MR=r=>Ea(mt(r.node,"EventStream").map(e=>{const t=Rt(e),i=t.schemeIdUri;return mt(e,"Event").map(s=>{const n=Rt(s),a=n.presentationTime||0,o=t.timescale||1,l=n.duration||0,u=a/o+r.attributes.start;return{schemeIdUri:i,value:t.value,id:n.id,start:u,end:u+l/o,messageData:zl(s)||n.messageData,contentEncoding:t.contentEncoding,presentationTimeOffset:t.presentationTimeOffset||0}})})),IR=(r,e,t)=>i=>{const s=Rt(i),n=Uh(e,mt(i,"BaseURL")),a=mt(i,"Role")[0],o={role:Rt(a)};let l=qt(r,s,o);const u=mt(i,"Accessibility")[0],c=DR(Rt(u));c&&(l=qt(l,{captionServices:c}));const h=mt(i,"Label")[0];if(h&&h.childNodes.length){const E=h.childNodes[0].nodeValue.trim();l=qt(l,{label:E})}const f=PR(mt(i,"ContentProtection"));Object.keys(f).length&&(l=qt(l,{contentProtection:f}));const m=fg(i),S=mt(i,"Representation"),y=qt(t,m);return Ea(S.map(AR(l,n,y)))},RR=(r,e)=>(t,i)=>{const s=Uh(e,mt(t.node,"BaseURL")),n=qt(r,{periodStart:t.attributes.start});typeof t.attributes.duration=="number"&&(n.periodDuration=t.attributes.duration);const a=mt(t.node,"AdaptationSet"),o=fg(t.node);return Ea(a.map(IR(n,s,o)))},LR=(r,e)=>{if(r.length>1&&e({type:"warn",message:"The MPD manifest should contain no more than one ContentSteering tag"}),!r.length)return null;const t=qt({serverURL:zl(r[0])},Rt(r[0]));return t.queryBeforeStart=t.queryBeforeStart==="true",t},QR=({attributes:r,priorPeriodAttributes:e,mpdType:t})=>typeof r.start=="number"?r.start:e&&typeof e.start=="number"&&typeof e.duration=="number"?e.start+e.duration:!e&&t==="static"?0:null,$R=(r,e={})=>{const{manifestUri:t="",NOW:i=Date.now(),clientOffset:s=0,eventHandler:n=function(){}}=e,a=mt(r,"Period");if(!a.length)throw new Error(Aa.INVALID_NUMBER_OF_PERIOD);const o=mt(r,"Location"),l=Rt(r),u=Uh([{baseUrl:t}],mt(r,"BaseURL")),c=mt(r,"ContentSteering");l.type=l.type||"static",l.sourceDuration=l.mediaPresentationDuration||0,l.NOW=i,l.clientOffset=s,o.length&&(l.locations=o.map(zl));const h=[];return a.forEach((f,m)=>{const S=Rt(f),y=h[m-1];S.start=QR({attributes:S,priorPeriodAttributes:y?y.attributes:null,mpdType:l.type}),h.push({node:f,attributes:S})}),{locations:l.locations,contentSteeringInfo:LR(c,n),representationInfo:Ea(h.map(RR(l,u))),eventStream:Ea(h.map(MR))}},hT=r=>{if(r==="")throw new Error(Aa.DASH_EMPTY_MANIFEST);const e=new ZI.DOMParser;let t,i;try{t=e.parseFromString(r,"application/xml"),i=t&&t.documentElement.tagName==="MPD"?t.documentElement:null}catch{}if(!i||i&&i.getElementsByTagName("parsererror").length>0)throw new Error(Aa.DASH_INVALID_XML);return i},BR=r=>{const e=mt(r,"UTCTiming")[0];if(!e)return null;const t=Rt(e);switch(t.schemeIdUri){case"urn:mpeg:dash:utc:http-head:2014":case"urn:mpeg:dash:utc:http-head:2012":t.method="HEAD";break;case"urn:mpeg:dash:utc:http-xsdate:2014":case"urn:mpeg:dash:utc:http-iso:2014":case"urn:mpeg:dash:utc:http-xsdate:2012":case"urn:mpeg:dash:utc:http-iso:2012":t.method="GET";break;case"urn:mpeg:dash:utc:direct:2014":case"urn:mpeg:dash:utc:direct:2012":t.method="DIRECT",t.value=Date.parse(t.value);break;case"urn:mpeg:dash:utc:http-ntp:2014":case"urn:mpeg:dash:utc:ntp:2014":case"urn:mpeg:dash:utc:sntp:2014":default:throw new Error(Aa.UNSUPPORTED_UTC_TIMING_SCHEME)}return t},NR=(r,e={})=>{const t=$R(hT(r),e),i=wR(t.representationInfo);return gR({dashPlaylists:i,locations:t.locations,contentSteering:t.contentSteeringInfo,sidxMapping:e.sidxMapping,previousManifest:e.previousManifest,eventStream:t.eventStream})},FR=r=>BR(hT(r));var Kd,wy;function UR(){if(wy)return Kd;wy=1;var r=Math.pow(2,32),e=function(t){var i=new DataView(t.buffer,t.byteOffset,t.byteLength),s;return i.getBigUint64?(s=i.getBigUint64(0),s<Number.MAX_SAFE_INTEGER?Number(s):s):i.getUint32(0)*r+i.getUint32(4)};return Kd={getUint64:e,MAX_UINT32:r},Kd}var Jd,Cy;function qR(){if(Cy)return Jd;Cy=1;var r=UR().getUint64,e=function(t){var i=new DataView(t.buffer,t.byteOffset,t.byteLength),s={version:t[0],flags:new Uint8Array(t.subarray(1,4)),references:[],referenceId:i.getUint32(4),timescale:i.getUint32(8)},n=12;s.version===0?(s.earliestPresentationTime=i.getUint32(n),s.firstOffset=i.getUint32(n+4),n+=8):(s.earliestPresentationTime=r(t.subarray(n)),s.firstOffset=r(t.subarray(n+8)),n+=16),n+=2;var a=i.getUint16(n);for(n+=2;a>0;n+=12,a--)s.references.push({referenceType:(t[n]&128)>>>7,referencedSize:i.getUint32(n)&2147483647,subsegmentDuration:i.getUint32(n+4),startsWithSap:!!(t[n+8]&128),sapType:(t[n+8]&112)>>>4,sapDeltaTime:i.getUint32(n+8)&268435455});return s};return Jd=e,Jd}var VR=qR();const XR=jl(VR);var jR=ke([73,68,51]),zR=function(e,t){t===void 0&&(t=0),e=ke(e);var i=e[t+5],s=e[t+6]<<21|e[t+7]<<14|e[t+8]<<7|e[t+9],n=(i&16)>>4;return n?s+20:s+10},Bo=function r(e,t){return t===void 0&&(t=0),e=ke(e),e.length-t<10||!pt(e,jR,{offset:t})?t:(t+=zR(e,t),r(e,t))},ky=function(e){return typeof e=="string"?sT(e):e},ZR=function(e){return Array.isArray(e)?e.map(function(t){return ky(t)}):[ky(e)]},WR=function r(e,t,i){i===void 0&&(i=!1),t=ZR(t),e=ke(e);var s=[];if(!t.length)return s;for(var n=0;n<e.length;){var a=(e[n]<<24|e[n+1]<<16|e[n+2]<<8|e[n+3])>>>0,o=e.subarray(n+4,n+8);if(a===0)break;var l=n+a;if(l>e.length){if(i)break;l=e.length}var u=e.subarray(n+8,l);pt(o,t[0])&&(t.length===1?s.push(u):s.push.apply(s,r(u,t.slice(1),i))),n=l}return s},$u={EBML:ke([26,69,223,163]),DocType:ke([66,130]),Segment:ke([24,83,128,103]),SegmentInfo:ke([21,73,169,102]),Tracks:ke([22,84,174,107]),Track:ke([174]),TrackNumber:ke([215]),DefaultDuration:ke([35,227,131]),TrackEntry:ke([174]),TrackType:ke([131]),FlagDefault:ke([136]),CodecID:ke([134]),CodecPrivate:ke([99,162]),VideoTrack:ke([224]),AudioTrack:ke([225]),Cluster:ke([31,67,182,117]),Timestamp:ke([231]),TimestampScale:ke([42,215,177]),BlockGroup:ke([160]),BlockDuration:ke([155]),Block:ke([161]),SimpleBlock:ke([163])},pp=[128,64,32,16,8,4,2,1],HR=function(e){for(var t=1,i=0;i<pp.length&&!(e&pp[i]);i++)t++;return t},$c=function(e,t,i,s){i===void 0&&(i=!0),s===void 0&&(s=!1);var n=HR(e[t]),a=e.subarray(t,t+n);return i&&(a=Array.prototype.slice.call(e,t,t+n),a[0]^=pp[n-1]),{length:n,value:NI(a,{signed:s}),bytes:a}},Ey=function r(e){return typeof e=="string"?e.match(/.{1,2}/g).map(function(t){return r(t)}):typeof e=="number"?FI(e):e},YR=function(e){return Array.isArray(e)?e.map(function(t){return Ey(t)}):[Ey(e)]},GR=function r(e,t,i){if(i>=t.length)return t.length;var s=$c(t,i,!1);if(pt(e.bytes,s.bytes))return i;var n=$c(t,i+s.length);return r(e,t,i+n.length+n.value+s.length)},Ay=function r(e,t){t=YR(t),e=ke(e);var i=[];if(!t.length)return i;for(var s=0;s<e.length;){var n=$c(e,s,!1),a=$c(e,s+n.length),o=s+n.length+a.length;a.value===127&&(a.value=GR(n,e,o),a.value!==e.length&&(a.value-=o));var l=o+a.value>e.length?e.length:o+a.value,u=e.subarray(o,l);pt(t[0],n.bytes)&&(t.length===1?i.push(u):i=i.concat(r(u,t.slice(1))));var c=n.length+a.length+u.length;s+=c}return i},KR=ke([0,0,0,1]),JR=ke([0,0,1]),eL=ke([0,0,3]),tL=function(e){for(var t=[],i=1;i<e.length-2;)pt(e.subarray(i,i+3),eL)&&(t.push(i+2),i++),i++;if(t.length===0)return e;var s=e.length-t.length,n=new Uint8Array(s),a=0;for(i=0;i<s;a++,i++)a===t[0]&&(a++,t.shift()),n[i]=e[a];return n},dT=function(e,t,i,s){e=ke(e),i=[].concat(i);for(var n=0,a,o=0;n<e.length&&(o<s||a);){var l=void 0;if(pt(e.subarray(n),KR)?l=4:pt(e.subarray(n),JR)&&(l=3),!l){n++;continue}if(o++,a)return tL(e.subarray(a,n));var u=void 0;t==="h264"?u=e[n+l]&31:t==="h265"&&(u=e[n+l]>>1&63),i.indexOf(u)!==-1&&(a=n+l),n+=l+(t==="h264"?1:2)}return e.subarray(0,0)},iL=function(e,t,i){return dT(e,"h264",t,i)},rL=function(e,t,i){return dT(e,"h265",t,i)},hi={webm:ke([119,101,98,109]),matroska:ke([109,97,116,114,111,115,107,97]),flac:ke([102,76,97,67]),ogg:ke([79,103,103,83]),ac3:ke([11,119]),riff:ke([82,73,70,70]),avi:ke([65,86,73]),wav:ke([87,65,86,69]),"3gp":ke([102,116,121,112,51,103]),mp4:ke([102,116,121,112]),fmp4:ke([115,116,121,112]),mov:ke([102,116,121,112,113,116]),moov:ke([109,111,111,118]),moof:ke([109,111,111,102])},Pa={aac:function(e){var t=Bo(e);return pt(e,[255,16],{offset:t,mask:[255,22]})},mp3:function(e){var t=Bo(e);return pt(e,[255,2],{offset:t,mask:[255,6]})},webm:function(e){var t=Ay(e,[$u.EBML,$u.DocType])[0];return pt(t,hi.webm)},mkv:function(e){var t=Ay(e,[$u.EBML,$u.DocType])[0];return pt(t,hi.matroska)},mp4:function(e){if(Pa["3gp"](e)||Pa.mov(e))return!1;if(pt(e,hi.mp4,{offset:4})||pt(e,hi.fmp4,{offset:4})||pt(e,hi.moof,{offset:4})||pt(e,hi.moov,{offset:4}))return!0},mov:function(e){return pt(e,hi.mov,{offset:4})},"3gp":function(e){return pt(e,hi["3gp"],{offset:4})},ac3:function(e){var t=Bo(e);return pt(e,hi.ac3,{offset:t})},ts:function(e){if(e.length<189&&e.length>=1)return e[0]===71;for(var t=0;t+188<e.length&&t<188;){if(e[t]===71&&e[t+188]===71)return!0;t+=1}return!1},flac:function(e){var t=Bo(e);return pt(e,hi.flac,{offset:t})},ogg:function(e){return pt(e,hi.ogg)},avi:function(e){return pt(e,hi.riff)&&pt(e,hi.avi,{offset:8})},wav:function(e){return pt(e,hi.riff)&&pt(e,hi.wav,{offset:8})},h264:function(e){return iL(e,7,3).length},h265:function(e){return rL(e,[32,33],3).length}},mp=Object.keys(Pa).filter(function(r){return r!=="ts"&&r!=="h264"&&r!=="h265"}).concat(["ts","h264","h265"]);mp.forEach(function(r){var e=Pa[r];Pa[r]=function(t){return e(ke(t))}});var sL=Pa,pg=function(e){e=ke(e);for(var t=0;t<mp.length;t++){var i=mp[t];if(sL[i](e))return i}return""},nL=function(e){return WR(e,["moof"]).length>0},ef,Py;function aL(){if(Py)return ef;Py=1;var r=9e4,e,t,i,s,n,a,o;return e=function(l){return l*r},t=function(l,u){return l*u},i=function(l){return l/r},s=function(l,u){return l/u},n=function(l,u){return e(s(l,u))},a=function(l,u){return t(i(l),u)},o=function(l,u,c){return i(c?l:l-u)},ef={ONE_SECOND_IN_TS:r,secondsToVideoTs:e,secondsToAudioTs:t,videoTsToSeconds:i,audioTsToSeconds:s,audioTsToVideoTs:n,videoTsToAudioTs:a,metadataTsToSeconds:o},ef}var yn=aL();/**
 * @license
 * Video.js 8.23.4 <http://videojs.com/>
 * Copyright Brightcove, Inc. <https://www.brightcove.com/>
 * Available under Apache License Version 2.0
 * <https://github.com/videojs/video.js/blob/main/LICENSE>
 *
 * Includes vtt.js <https://github.com/mozilla/vtt.js>
 * Available under Apache License Version 2.0
 * <https://github.com/mozilla/vtt.js/blob/main/LICENSE>
 */var gp="8.23.4";const hs={},zs=function(r,e){return hs[r]=hs[r]||[],e&&(hs[r]=hs[r].concat(e)),hs[r]},oL=function(r,e){zs(r,e)},fT=function(r,e){const t=zs(r).indexOf(e);return t<=-1?!1:(hs[r]=hs[r].slice(),hs[r].splice(t,1),!0)},lL=function(r,e){zs(r,[].concat(e).map(t=>{const i=(...s)=>(fT(r,i),t(...s));return i}))},Bc={prefixed:!0},mc=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror","fullscreen"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror","-webkit-full-screen"]],Dy=mc[0];let No;for(let r=0;r<mc.length;r++)if(mc[r][1]in ue){No=mc[r];break}if(No){for(let r=0;r<No.length;r++)Bc[Dy[r]]=No[r];Bc.prefixed=No[0]!==Dy[0]}let Si=[];const uL=(r,e,t)=>(i,s,n)=>{const a=e.levels[s],o=new RegExp(`^(${a})$`);let l=r;if(i!=="log"&&n.unshift(i.toUpperCase()+":"),t&&(l=`%c${r}`,n.unshift(t)),n.unshift(l+":"),Si){Si.push([].concat(n));const c=Si.length-1e3;Si.splice(0,c>0?c:0)}if(!U.console)return;let u=U.console[i];!u&&i==="debug"&&(u=U.console.info||U.console.log),!(!u||!a||!o.test(i))&&u[Array.isArray(n)?"apply":"call"](U.console,n)};function Op(r,e=":",t=""){let i="info",s;function n(...a){s("log",i,a)}return s=uL(r,n,t),n.createLogger=(a,o,l)=>{const u=o!==void 0?o:e,c=l!==void 0?l:t,h=`${r} ${u} ${a}`;return Op(h,u,c)},n.createNewLogger=(a,o,l)=>Op(a,o,l),n.levels={all:"debug|log|warn|error",off:"",debug:"debug|log|warn|error",info:"log|warn|error",warn:"warn|error",error:"error",DEFAULT:i},n.level=a=>{if(typeof a=="string"){if(!n.levels.hasOwnProperty(a))throw new Error(`"${a}" in not a valid log level`);i=a}return i},n.history=()=>Si?[].concat(Si):[],n.history.filter=a=>(Si||[]).filter(o=>new RegExp(`.*${a}.*`).test(o[0])),n.history.clear=()=>{Si&&(Si.length=0)},n.history.disable=()=>{Si!==null&&(Si.length=0,Si=null)},n.history.enable=()=>{Si===null&&(Si=[])},n.error=(...a)=>s("error",i,a),n.warn=(...a)=>s("warn",i,a),n.debug=(...a)=>s("debug",i,a),n}const Be=Op("VIDEOJS"),pT=Be.createLogger,cL=Object.prototype.toString,mT=function(r){return Zr(r)?Object.keys(r):[]};function ca(r,e){mT(r).forEach(t=>e(r[t],t))}function gT(r,e,t=0){return mT(r).reduce((i,s)=>e(i,r[s],s),t)}function Zr(r){return!!r&&typeof r=="object"}function Da(r){return Zr(r)&&cL.call(r)==="[object Object]"&&r.constructor===Object}function Je(...r){const e={};return r.forEach(t=>{t&&ca(t,(i,s)=>{if(!Da(i)){e[s]=i;return}Da(e[s])||(e[s]={}),e[s]=Je(e[s],i)})}),e}function OT(r={}){const e=[];for(const t in r)if(r.hasOwnProperty(t)){const i=r[t];e.push(i)}return e}function qh(r,e,t,i=!0){const s=a=>Object.defineProperty(r,e,{value:a,enumerable:!0,writable:!0}),n={configurable:!0,enumerable:!0,get(){const a=t();return s(a),a}};return i&&(n.set=s),Object.defineProperty(r,e,n)}var hL=Object.freeze({__proto__:null,each:ca,reduce:gT,isObject:Zr,isPlain:Da,merge:Je,values:OT,defineLazyProperty:qh});let mg=!1,yT=null,Or=!1,bT,vT=!1,ha=!1,da=!1,Wr=!1,gg=null,Vh=null;const dL=!!(U.cast&&U.cast.framework&&U.cast.framework.CastReceiverContext);let ST=null,Nc=!1,Xh=!1,Fc=!1,jh=!1,Uc=!1,qc=!1,Vc=!1;const fl=!!(Ha()&&("ontouchstart"in U||U.navigator.maxTouchPoints||U.DocumentTouch&&U.document instanceof U.DocumentTouch)),Ds=U.navigator&&U.navigator.userAgentData;Ds&&Ds.platform&&Ds.brands&&(Or=Ds.platform==="Android",ha=!!Ds.brands.find(r=>r.brand==="Microsoft Edge"),da=!!Ds.brands.find(r=>r.brand==="Chromium"),Wr=!ha&&da,gg=Vh=(Ds.brands.find(r=>r.brand==="Chromium")||{}).version||null,Xh=Ds.platform==="Windows");if(!da){const r=U.navigator&&U.navigator.userAgent||"";mg=/iPod/i.test(r),yT=(function(){const e=r.match(/OS (\d+)_/i);return e&&e[1]?e[1]:null})(),Or=/Android/i.test(r),bT=(function(){const e=r.match(/Android (\d+)(?:\.(\d+))?(?:\.(\d+))*/i);if(!e)return null;const t=e[1]&&parseFloat(e[1]),i=e[2]&&parseFloat(e[2]);return t&&i?parseFloat(e[1]+"."+e[2]):t||null})(),vT=/Firefox/i.test(r),ha=/Edg/i.test(r),da=/Chrome/i.test(r)||/CriOS/i.test(r),Wr=!ha&&da,gg=Vh=(function(){const e=r.match(/(Chrome|CriOS)\/(\d+)/);return e&&e[2]?parseFloat(e[2]):null})(),ST=(function(){const e=/MSIE\s(\d+)\.\d/.exec(r);let t=e&&parseFloat(e[1]);return!t&&/Trident\/7.0/i.test(r)&&/rv:11.0/.test(r)&&(t=11),t})(),Uc=/Tizen/i.test(r),qc=/Web0S/i.test(r),Vc=Uc||qc,Nc=/Safari/i.test(r)&&!Wr&&!Or&&!ha&&!Vc,Xh=/Windows/i.test(r),Fc=/iPad/i.test(r)||Nc&&fl&&!/iPhone/i.test(r),jh=/iPhone/i.test(r)&&!Fc}const si=jh||Fc||mg,zh=(Nc||si)&&!Wr;var TT=Object.freeze({__proto__:null,get IS_IPOD(){return mg},get IOS_VERSION(){return yT},get IS_ANDROID(){return Or},get ANDROID_VERSION(){return bT},get IS_FIREFOX(){return vT},get IS_EDGE(){return ha},get IS_CHROMIUM(){return da},get IS_CHROME(){return Wr},get CHROMIUM_VERSION(){return gg},get CHROME_VERSION(){return Vh},IS_CHROMECAST_RECEIVER:dL,get IE_VERSION(){return ST},get IS_SAFARI(){return Nc},get IS_WINDOWS(){return Xh},get IS_IPAD(){return Fc},get IS_IPHONE(){return jh},get IS_TIZEN(){return Uc},get IS_WEBOS(){return qc},get IS_SMART_TV(){return Vc},TOUCH_ENABLED:fl,IS_IOS:si,IS_ANY_SAFARI:zh});function My(r){return typeof r=="string"&&!!r.trim()}function fL(r){if(r.indexOf(" ")>=0)throw new Error("class has illegal whitespace characters")}function Ha(){return ue===U.document}function Ya(r){return Zr(r)&&r.nodeType===1}function _T(){try{return U.parent!==U.self}catch{return!0}}function xT(r){return function(e,t){if(!My(e))return ue[r](null);My(t)&&(t=ue.querySelector(t));const i=Ya(t)?t:ue;return i[r]&&i[r](e)}}function Me(r="div",e={},t={},i){const s=ue.createElement(r);return Object.getOwnPropertyNames(e).forEach(function(n){const a=e[n];n==="textContent"?Js(s,a):(s[n]!==a||n==="tabIndex")&&(s[n]=a)}),Object.getOwnPropertyNames(t).forEach(function(n){s.setAttribute(n,t[n])}),i&&Og(s,i),s}function Js(r,e){return typeof r.textContent>"u"?r.innerText=e:r.textContent=e,r}function yp(r,e){e.firstChild?e.insertBefore(r,e.firstChild):e.appendChild(r)}function Ho(r,e){return fL(e),r.classList.contains(e)}function kn(r,...e){return r.classList.add(...e.reduce((t,i)=>t.concat(i.split(/\s+/)),[])),r}function Zh(r,...e){return r?(r.classList.remove(...e.reduce((t,i)=>t.concat(i.split(/\s+/)),[])),r):(Be.warn("removeClass was called with an element that doesn't exist"),null)}function wT(r,e,t){return typeof t=="function"&&(t=t(r,e)),typeof t!="boolean"&&(t=void 0),e.split(/\s+/).forEach(i=>r.classList.toggle(i,t)),r}function CT(r,e){Object.getOwnPropertyNames(e).forEach(function(t){const i=e[t];i===null||typeof i>"u"||i===!1?r.removeAttribute(t):r.setAttribute(t,i===!0?"":i)})}function Ls(r){const e={},t=["autoplay","controls","playsinline","loop","muted","default","defaultMuted"];if(r&&r.attributes&&r.attributes.length>0){const i=r.attributes;for(let s=i.length-1;s>=0;s--){const n=i[s].name;let a=i[s].value;t.includes(n)&&(a=a!==null),e[n]=a}}return e}function kT(r,e){return r.getAttribute(e)}function Ma(r,e,t){r.setAttribute(e,t)}function Wh(r,e){r.removeAttribute(e)}function ET(){ue.body.focus(),ue.onselectstart=function(){return!1}}function AT(){ue.onselectstart=function(){return!0}}function Ia(r){if(r&&r.getBoundingClientRect&&r.parentNode){const e=r.getBoundingClientRect(),t={};return["bottom","height","left","right","top","width"].forEach(i=>{e[i]!==void 0&&(t[i]=e[i])}),t.height||(t.height=parseFloat(Ra(r,"height"))),t.width||(t.width=parseFloat(Ra(r,"width"))),t}}function pl(r){if(!r||r&&!r.offsetParent)return{left:0,top:0,width:0,height:0};const e=r.offsetWidth,t=r.offsetHeight;let i=0,s=0;for(;r.offsetParent&&r!==ue[Bc.fullscreenElement];)i+=r.offsetLeft,s+=r.offsetTop,r=r.offsetParent;return{left:i,top:s,width:e,height:t}}function Hh(r,e){const t={x:0,y:0};if(si){let c=r;for(;c&&c.nodeName.toLowerCase()!=="html";){const h=Ra(c,"transform");if(/^matrix/.test(h)){const f=h.slice(7,-1).split(/,\s/).map(Number);t.x+=f[4],t.y+=f[5]}else if(/^matrix3d/.test(h)){const f=h.slice(9,-1).split(/,\s/).map(Number);t.x+=f[12],t.y+=f[13]}if(c.assignedSlot&&c.assignedSlot.parentElement&&U.WebKitCSSMatrix){const f=U.getComputedStyle(c.assignedSlot.parentElement).transform,m=new U.WebKitCSSMatrix(f);t.x+=m.m41,t.y+=m.m42}c=c.parentNode||c.host}}const i={},s=pl(e.target),n=pl(r),a=n.width,o=n.height;let l=e.offsetY-(n.top-s.top),u=e.offsetX-(n.left-s.left);return e.changedTouches&&(u=e.changedTouches[0].pageX-n.left,l=e.changedTouches[0].pageY+n.top,si&&(u-=t.x,l-=t.y)),i.y=1-Math.max(0,Math.min(1,l/o)),i.x=Math.max(0,Math.min(1,u/a)),i}function PT(r){return Zr(r)&&r.nodeType===3}function Yh(r){for(;r.firstChild;)r.removeChild(r.firstChild);return r}function DT(r){return typeof r=="function"&&(r=r()),(Array.isArray(r)?r:[r]).map(e=>{if(typeof e=="function"&&(e=e()),Ya(e)||PT(e))return e;if(typeof e=="string"&&/\S/.test(e))return ue.createTextNode(e)}).filter(e=>e)}function Og(r,e){return DT(e).forEach(t=>r.appendChild(t)),r}function MT(r,e){return Og(Yh(r),e)}function ml(r){return r.button===void 0&&r.buttons===void 0||r.button===0&&r.buttons===void 0||r.type==="mouseup"&&r.button===0&&r.buttons===0||r.type==="mousedown"&&r.button===0&&r.buttons===0?!0:!(r.button!==0||r.buttons!==1)}const Zs=xT("querySelector"),IT=xT("querySelectorAll");function Ra(r,e){if(!r||!e)return"";if(typeof U.getComputedStyle=="function"){let t;try{t=U.getComputedStyle(r)}catch{return""}return t?t.getPropertyValue(e)||t[e]:""}return""}function RT(r){[...ue.styleSheets].forEach(e=>{try{const t=[...e.cssRules].map(s=>s.cssText).join(""),i=ue.createElement("style");i.textContent=t,r.document.head.appendChild(i)}catch{const i=ue.createElement("link");i.rel="stylesheet",i.type=e.type,i.media=e.media.mediaText,i.href=e.href,r.document.head.appendChild(i)}})}var LT=Object.freeze({__proto__:null,isReal:Ha,isEl:Ya,isInFrame:_T,createEl:Me,textContent:Js,prependTo:yp,hasClass:Ho,addClass:kn,removeClass:Zh,toggleClass:wT,setAttributes:CT,getAttributes:Ls,getAttribute:kT,setAttribute:Ma,removeAttribute:Wh,blockTextSelection:ET,unblockTextSelection:AT,getBoundingClientRect:Ia,findPosition:pl,getPointerPosition:Hh,isTextNode:PT,emptyEl:Yh,normalizeContent:DT,appendContent:Og,insertContent:MT,isSingleLeftClick:ml,$:Zs,$$:IT,computedStyle:Ra,copyStyleSheetsToWindow:RT});let QT=!1,bp;const pL=function(){if(bp.options.autoSetup===!1)return;const r=Array.prototype.slice.call(ue.getElementsByTagName("video")),e=Array.prototype.slice.call(ue.getElementsByTagName("audio")),t=Array.prototype.slice.call(ue.getElementsByTagName("video-js")),i=r.concat(e,t);if(i&&i.length>0)for(let s=0,n=i.length;s<n;s++){const a=i[s];if(a&&a.getAttribute)a.player===void 0&&a.getAttribute("data-setup")!==null&&bp(a);else{vp(1);break}}else QT||vp(1)};function vp(r,e){Ha()&&(e&&(bp=e),U.setTimeout(pL,r))}function Sp(){QT=!0,U.removeEventListener("load",Sp)}Ha()&&(ue.readyState==="complete"?Sp():U.addEventListener("load",Sp));const $T=function(r){const e=ue.createElement("style");return e.className=r,e},BT=function(r,e){r.styleSheet?r.styleSheet.cssText=e:r.textContent=e};var mi=new WeakMap;const mL=3;let gL=mL;function rr(){return gL++}function Iy(r,e){if(!mi.has(r))return;const t=mi.get(r);t.handlers[e].length===0&&(delete t.handlers[e],r.removeEventListener?r.removeEventListener(e,t.dispatcher,!1):r.detachEvent&&r.detachEvent("on"+e,t.dispatcher)),Object.getOwnPropertyNames(t.handlers).length<=0&&(delete t.handlers,delete t.dispatcher,delete t.disabled),Object.getOwnPropertyNames(t).length===0&&mi.delete(r)}function yg(r,e,t,i){t.forEach(function(s){r(e,s,i)})}function Gh(r){if(r.fixed_)return r;function e(){return!0}function t(){return!1}if(!r||!r.isPropagationStopped||!r.isImmediatePropagationStopped){const i=r||U.event;r={};const s=["layerX","layerY","keyLocation","path","webkitMovementX","webkitMovementY","mozPressure","mozInputSource"];for(const n in i)s.includes(n)||n==="returnValue"&&i.preventDefault||(r[n]=i[n]);if(r.target||(r.target=r.srcElement||ue),r.relatedTarget||(r.relatedTarget=r.fromElement===r.target?r.toElement:r.fromElement),r.preventDefault=function(){i.preventDefault&&i.preventDefault(),r.returnValue=!1,i.returnValue=!1,r.defaultPrevented=!0},r.defaultPrevented=!1,r.stopPropagation=function(){i.stopPropagation&&i.stopPropagation(),r.cancelBubble=!0,i.cancelBubble=!0,r.isPropagationStopped=e},r.isPropagationStopped=t,r.stopImmediatePropagation=function(){i.stopImmediatePropagation&&i.stopImmediatePropagation(),r.isImmediatePropagationStopped=e,r.stopPropagation()},r.isImmediatePropagationStopped=t,r.clientX!==null&&r.clientX!==void 0){const n=ue.documentElement,a=ue.body;r.pageX=r.clientX+(n&&n.scrollLeft||a&&a.scrollLeft||0)-(n&&n.clientLeft||a&&a.clientLeft||0),r.pageY=r.clientY+(n&&n.scrollTop||a&&a.scrollTop||0)-(n&&n.clientTop||a&&a.clientTop||0)}r.which=r.charCode||r.keyCode,r.button!==null&&r.button!==void 0&&(r.button=r.button&1?0:r.button&4?1:r.button&2?2:0)}return r.fixed_=!0,r}let Bu;const OL=function(){if(typeof Bu!="boolean"){Bu=!1;try{const r=Object.defineProperty({},"passive",{get(){Bu=!0}});U.addEventListener("test",null,r),U.removeEventListener("test",null,r)}catch{}}return Bu},yL=["touchstart","touchmove"];function Ui(r,e,t){if(Array.isArray(e))return yg(Ui,r,e,t);mi.has(r)||mi.set(r,{});const i=mi.get(r);if(i.handlers||(i.handlers={}),i.handlers[e]||(i.handlers[e]=[]),t.guid||(t.guid=rr()),i.handlers[e].push(t),i.dispatcher||(i.disabled=!1,i.dispatcher=function(s,n){if(i.disabled)return;s=Gh(s);const a=i.handlers[s.type];if(a){const o=a.slice(0);for(let l=0,u=o.length;l<u&&!s.isImmediatePropagationStopped();l++)try{o[l].call(r,s,n)}catch(c){Be.error(c)}}}),i.handlers[e].length===1)if(r.addEventListener){let s=!1;OL()&&yL.indexOf(e)>-1&&(s={passive:!0}),r.addEventListener(e,i.dispatcher,s)}else r.attachEvent&&r.attachEvent("on"+e,i.dispatcher)}function ni(r,e,t){if(!mi.has(r))return;const i=mi.get(r);if(!i.handlers)return;if(Array.isArray(e))return yg(ni,r,e,t);const s=function(a,o){i.handlers[o]=[],Iy(a,o)};if(e===void 0){for(const a in i.handlers)Object.prototype.hasOwnProperty.call(i.handlers||{},a)&&s(r,a);return}const n=i.handlers[e];if(n){if(!t){s(r,e);return}if(t.guid)for(let a=0;a<n.length;a++)n[a].guid===t.guid&&n.splice(a--,1);Iy(r,e)}}function Ga(r,e,t){const i=mi.has(r)?mi.get(r):{},s=r.parentNode||r.ownerDocument;if(typeof e=="string"?e={type:e,target:r}:e.target||(e.target=r),e=Gh(e),i.dispatcher&&i.dispatcher.call(r,e,t),s&&!e.isPropagationStopped()&&e.bubbles===!0)Ga.call(null,s,e,t);else if(!s&&!e.defaultPrevented&&e.target&&e.target[e.type]){mi.has(e.target)||mi.set(e.target,{});const n=mi.get(e.target);e.target[e.type]&&(n.disabled=!0,typeof e.target[e.type]=="function"&&e.target[e.type](),n.disabled=!1)}return!e.defaultPrevented}function Kh(r,e,t){if(Array.isArray(e))return yg(Kh,r,e,t);const i=function(){ni(r,e,i),t.apply(this,arguments)};i.guid=t.guid=t.guid||rr(),Ui(r,e,i)}function bg(r,e,t){const i=function(){ni(r,e,i),t.apply(this,arguments)};i.guid=t.guid=t.guid||rr(),Ui(r,e,i)}var bL=Object.freeze({__proto__:null,fixEvent:Gh,on:Ui,off:ni,trigger:Ga,one:Kh,any:bg});const sr=30,ut=function(r,e,t){e.guid||(e.guid=rr());const i=e.bind(r);return i.guid=t?t+"_"+e.guid:e.guid,i},Hr=function(r,e){let t=U.performance.now();return function(...s){const n=U.performance.now();n-t>=e&&(r(...s),t=n)}},NT=function(r,e,t,i=U){let s;const n=()=>{i.clearTimeout(s),s=null},a=function(){const o=this,l=arguments;let u=function(){s=null,u=null,t||r.apply(o,l)};!s&&t&&r.apply(o,l),i.clearTimeout(s),s=i.setTimeout(u,e)};return a.cancel=n,a};var vL=Object.freeze({__proto__:null,UPDATE_REFRESH_INTERVAL:sr,bind_:ut,throttle:Hr,debounce:NT});let Co;class qi{on(e,t){const i=this.addEventListener;this.addEventListener=()=>{},Ui(this,e,t),this.addEventListener=i}off(e,t){ni(this,e,t)}one(e,t){const i=this.addEventListener;this.addEventListener=()=>{},Kh(this,e,t),this.addEventListener=i}any(e,t){const i=this.addEventListener;this.addEventListener=()=>{},bg(this,e,t),this.addEventListener=i}trigger(e){const t=e.type||e;typeof e=="string"&&(e={type:t}),e=Gh(e),this.allowedEvents_[t]&&this["on"+t]&&this["on"+t](e),Ga(this,e)}queueTrigger(e){Co||(Co=new Map);const t=e.type||e;let i=Co.get(this);i||(i=new Map,Co.set(this,i));const s=i.get(t);i.delete(t),U.clearTimeout(s);const n=U.setTimeout(()=>{i.delete(t),i.size===0&&(i=null,Co.delete(this)),this.trigger(e)},0);i.set(t,n)}}qi.prototype.allowedEvents_={};qi.prototype.addEventListener=qi.prototype.on;qi.prototype.removeEventListener=qi.prototype.off;qi.prototype.dispatchEvent=qi.prototype.trigger;const Jh=r=>typeof r.name=="function"?r.name():typeof r.name=="string"?r.name:r.name_?r.name_:r.constructor&&r.constructor.name?r.constructor.name:typeof r,ps=r=>r instanceof qi||!!r.eventBusEl_&&["on","one","off","trigger"].every(e=>typeof r[e]=="function"),SL=(r,e)=>{ps(r)?e():(r.eventedCallbacks||(r.eventedCallbacks=[]),r.eventedCallbacks.push(e))},Tp=r=>typeof r=="string"&&/\S/.test(r)||Array.isArray(r)&&!!r.length,Xc=(r,e,t)=>{if(!r||!r.nodeName&&!ps(r))throw new Error(`Invalid target for ${Jh(e)}#${t}; must be a DOM node or evented object.`)},FT=(r,e,t)=>{if(!Tp(r))throw new Error(`Invalid event type for ${Jh(e)}#${t}; must be a non-empty string or array.`)},UT=(r,e,t)=>{if(typeof r!="function")throw new Error(`Invalid listener for ${Jh(e)}#${t}; must be a function.`)},tf=(r,e,t)=>{const i=e.length<3||e[0]===r||e[0]===r.eventBusEl_;let s,n,a;return i?(s=r.eventBusEl_,e.length>=3&&e.shift(),[n,a]=e):(s=e[0],n=e[1],a=e[2]),Xc(s,r,t),FT(n,r,t),UT(a,r,t),a=ut(r,a),{isTargetingSelf:i,target:s,type:n,listener:a}},ln=(r,e,t,i)=>{Xc(r,r,e),r.nodeName?bL[e](r,t,i):r[e](t,i)},TL={on(...r){const{isTargetingSelf:e,target:t,type:i,listener:s}=tf(this,r,"on");if(ln(t,"on",i,s),!e){const n=()=>this.off(t,i,s);n.guid=s.guid;const a=()=>this.off("dispose",n);a.guid=s.guid,ln(this,"on","dispose",n),ln(t,"on","dispose",a)}},one(...r){const{isTargetingSelf:e,target:t,type:i,listener:s}=tf(this,r,"one");if(e)ln(t,"one",i,s);else{const n=(...a)=>{this.off(t,i,n),s.apply(null,a)};n.guid=s.guid,ln(t,"one",i,n)}},any(...r){const{isTargetingSelf:e,target:t,type:i,listener:s}=tf(this,r,"any");if(e)ln(t,"any",i,s);else{const n=(...a)=>{this.off(t,i,n),s.apply(null,a)};n.guid=s.guid,ln(t,"any",i,n)}},off(r,e,t){if(!r||Tp(r))ni(this.eventBusEl_,r,e);else{const i=r,s=e;Xc(i,this,"off"),FT(s,this,"off"),UT(t,this,"off"),t=ut(this,t),this.off("dispose",t),i.nodeName?(ni(i,s,t),ni(i,"dispose",t)):ps(i)&&(i.off(s,t),i.off("dispose",t))}},trigger(r,e){Xc(this.eventBusEl_,this,"trigger");const t=r&&typeof r!="string"?r.type:r;if(!Tp(t))throw new Error(`Invalid event type for ${Jh(this)}#trigger; must be a non-empty string or object with a type key that has a non-empty value.`);return Ga(this.eventBusEl_,r,e)}};function vg(r,e={}){const{eventBusKey:t}=e;if(t){if(!r[t].nodeName)throw new Error(`The eventBusKey "${t}" does not refer to an element.`);r.eventBusEl_=r[t]}else r.eventBusEl_=Me("span",{className:"vjs-event-bus"});return Object.assign(r,TL),r.eventedCallbacks&&r.eventedCallbacks.forEach(i=>{i()}),r.on("dispose",()=>{r.off(),[r,r.el_,r.eventBusEl_].forEach(function(i){i&&mi.has(i)&&mi.delete(i)}),U.setTimeout(()=>{r.eventBusEl_=null},0)}),r}const _L={state:{},setState(r){typeof r=="function"&&(r=r());let e;return ca(r,(t,i)=>{this.state[i]!==t&&(e=e||{},e[i]={from:this.state[i],to:t}),this.state[i]=t}),e&&ps(this)&&this.trigger({changes:e,type:"statechanged"}),e}};function qT(r,e){return Object.assign(r,_L),r.state=Object.assign({},r.state,e),typeof r.handleStateChanged=="function"&&ps(r)&&r.on("statechanged",r.handleStateChanged),r}const Yo=function(r){return typeof r!="string"?r:r.replace(/./,e=>e.toLowerCase())},Tt=function(r){return typeof r!="string"?r:r.replace(/./,e=>e.toUpperCase())},VT=function(r,e){return Tt(r)===Tt(e)};var xL=Object.freeze({__proto__:null,toLowerCase:Yo,toTitleCase:Tt,titleCaseEquals:VT});class ee{constructor(e,t,i){if(!e&&this.play?this.player_=e=this:this.player_=e,this.isDisposed_=!1,this.parentComponent_=null,this.options_=Je({},this.options_),t=this.options_=Je(this.options_,t),this.id_=t.id||t.el&&t.el.id,!this.id_){const s=e&&e.id&&e.id()||"no_player";this.id_=`${s}_component_${rr()}`}this.name_=t.name||null,t.el?this.el_=t.el:t.createEl!==!1&&(this.el_=this.createEl()),t.className&&this.el_&&t.className.split(" ").forEach(s=>this.addClass(s)),["on","off","one","any","trigger"].forEach(s=>{this[s]=void 0}),t.evented!==!1&&(vg(this,{eventBusKey:this.el_?"el_":null}),this.handleLanguagechange=this.handleLanguagechange.bind(this),this.on(this.player_,"languagechange",this.handleLanguagechange)),qT(this,this.constructor.defaultState),this.children_=[],this.childIndex_={},this.childNameIndex_={},this.setTimeoutIds_=new Set,this.setIntervalIds_=new Set,this.rafIds_=new Set,this.namedRafs_=new Map,this.clearingTimersOnDispose_=!1,t.initChildren!==!1&&this.initChildren(),this.ready(i),t.reportTouchActivity!==!1&&this.enableTouchActivity()}dispose(e={}){if(!this.isDisposed_){if(this.readyQueue_&&(this.readyQueue_.length=0),this.trigger({type:"dispose",bubbles:!1}),this.isDisposed_=!0,this.children_)for(let t=this.children_.length-1;t>=0;t--)this.children_[t].dispose&&this.children_[t].dispose();this.children_=null,this.childIndex_=null,this.childNameIndex_=null,this.parentComponent_=null,this.el_&&(this.el_.parentNode&&(e.restoreEl?this.el_.parentNode.replaceChild(e.restoreEl,this.el_):this.el_.parentNode.removeChild(this.el_)),this.el_=null),this.player_=null}}isDisposed(){return!!this.isDisposed_}player(){return this.player_}options(e){return e?(this.options_=Je(this.options_,e),this.options_):this.options_}el(){return this.el_}createEl(e,t,i){return Me(e,t,i)}localize(e,t,i=e){const s=this.player_.language&&this.player_.language(),n=this.player_.languages&&this.player_.languages(),a=n&&n[s],o=s&&s.split("-")[0],l=n&&n[o];let u=i;return a&&a[e]?u=a[e]:l&&l[e]&&(u=l[e]),t&&(u=u.replace(/\{(\d+)\}/g,function(c,h){const f=t[h-1];let m=f;return typeof f>"u"&&(m=c),m})),u}handleLanguagechange(){}contentEl(){return this.contentEl_||this.el_}id(){return this.id_}name(){return this.name_}children(){return this.children_}getChildById(e){return this.childIndex_[e]}getChild(e){if(e)return this.childNameIndex_[e]}getDescendant(...e){e=e.reduce((i,s)=>i.concat(s),[]);let t=this;for(let i=0;i<e.length;i++)if(t=t.getChild(e[i]),!t||!t.getChild)return;return t}setIcon(e,t=this.el()){if(!this.player_.options_.experimentalSvgIcons)return;const i="http://www.w3.org/2000/svg",s=Me("span",{className:"vjs-icon-placeholder vjs-svg-icon"},{"aria-hidden":"true"}),n=ue.createElementNS(i,"svg");n.setAttributeNS(null,"viewBox","0 0 512 512");const a=ue.createElementNS(i,"use");return n.appendChild(a),a.setAttributeNS(null,"href",`#vjs-icon-${e}`),s.appendChild(n),this.iconIsSet_?t.replaceChild(s,t.querySelector(".vjs-icon-placeholder")):t.appendChild(s),this.iconIsSet_=!0,s}addChild(e,t={},i=this.children_.length){let s,n;if(typeof e=="string"){n=Tt(e);const a=t.componentClass||n;t.name=n;const o=ee.getComponent(a);if(!o)throw new Error(`Component ${a} does not exist`);if(typeof o!="function")return null;s=new o(this.player_||this,t)}else s=e;if(s.parentComponent_&&s.parentComponent_.removeChild(s),this.children_.splice(i,0,s),s.parentComponent_=this,typeof s.id=="function"&&(this.childIndex_[s.id()]=s),n=n||s.name&&Tt(s.name()),n&&(this.childNameIndex_[n]=s,this.childNameIndex_[Yo(n)]=s),typeof s.el=="function"&&s.el()){let a=null;this.children_[i+1]&&(this.children_[i+1].el_?a=this.children_[i+1].el_:Ya(this.children_[i+1])&&(a=this.children_[i+1])),this.contentEl().insertBefore(s.el(),a)}return s}removeChild(e){if(typeof e=="string"&&(e=this.getChild(e)),!e||!this.children_)return;let t=!1;for(let s=this.children_.length-1;s>=0;s--)if(this.children_[s]===e){t=!0,this.children_.splice(s,1);break}if(!t)return;e.parentComponent_=null,this.childIndex_[e.id()]=null,this.childNameIndex_[Tt(e.name())]=null,this.childNameIndex_[Yo(e.name())]=null;const i=e.el();i&&i.parentNode===this.contentEl()&&this.contentEl().removeChild(e.el())}initChildren(){const e=this.options_.children;if(e){const t=this.options_,i=a=>{const o=a.name;let l=a.opts;if(t[o]!==void 0&&(l=t[o]),l===!1)return;l===!0&&(l={}),l.playerOptions=this.options_.playerOptions;const u=this.addChild(o,l);u&&(this[o]=u)};let s;const n=ee.getComponent("Tech");Array.isArray(e)?s=e:s=Object.keys(e),s.concat(Object.keys(this.options_).filter(function(a){return!s.some(function(o){return typeof o=="string"?a===o:a===o.name})})).map(a=>{let o,l;return typeof a=="string"?(o=a,l=e[o]||this.options_[o]||{}):(o=a.name,l=a),{name:o,opts:l}}).filter(a=>{const o=ee.getComponent(a.opts.componentClass||Tt(a.name));return o&&!n.isTech(o)}).forEach(i)}}buildCSSClass(){return""}ready(e,t=!1){if(e){if(!this.isReady_){this.readyQueue_=this.readyQueue_||[],this.readyQueue_.push(e);return}t?e.call(this):this.setTimeout(e,1)}}triggerReady(){this.isReady_=!0,this.setTimeout(function(){const e=this.readyQueue_;this.readyQueue_=[],e&&e.length>0&&e.forEach(function(t){t.call(this)},this),this.trigger("ready")},1)}$(e,t){return Zs(e,t||this.contentEl())}$$(e,t){return IT(e,t||this.contentEl())}hasClass(e){return Ho(this.el_,e)}addClass(...e){kn(this.el_,...e)}removeClass(...e){Zh(this.el_,...e)}toggleClass(e,t){wT(this.el_,e,t)}show(){this.removeClass("vjs-hidden")}hide(){this.addClass("vjs-hidden")}lockShowing(){this.addClass("vjs-lock-showing")}unlockShowing(){this.removeClass("vjs-lock-showing")}getAttribute(e){return kT(this.el_,e)}setAttribute(e,t){Ma(this.el_,e,t)}removeAttribute(e){Wh(this.el_,e)}width(e,t){return this.dimension("width",e,t)}height(e,t){return this.dimension("height",e,t)}dimensions(e,t){this.width(e,!0),this.height(t)}dimension(e,t,i){if(t!==void 0){(t===null||t!==t)&&(t=0),(""+t).indexOf("%")!==-1||(""+t).indexOf("px")!==-1?this.el_.style[e]=t:t==="auto"?this.el_.style[e]="":this.el_.style[e]=t+"px",i||this.trigger("componentresize");return}if(!this.el_)return 0;const s=this.el_.style[e],n=s.indexOf("px");return parseInt(n!==-1?s.slice(0,n):this.el_["offset"+Tt(e)],10)}currentDimension(e){let t=0;if(e!=="width"&&e!=="height")throw new Error("currentDimension only accepts width or height value");if(t=Ra(this.el_,e),t=parseFloat(t),t===0||isNaN(t)){const i=`offset${Tt(e)}`;t=this.el_[i]}return t}currentDimensions(){return{width:this.currentDimension("width"),height:this.currentDimension("height")}}currentWidth(){return this.currentDimension("width")}currentHeight(){return this.currentDimension("height")}getPositions(){const e=this.el_.getBoundingClientRect(),t={x:e.x,y:e.y,width:e.width,height:e.height,top:e.top,right:e.right,bottom:e.bottom,left:e.left},i={x:e.left+e.width/2,y:e.top+e.height/2,width:0,height:0,top:e.top+e.height/2,right:e.left+e.width/2,bottom:e.top+e.height/2,left:e.left+e.width/2};return{boundingClientRect:t,center:i}}focus(){this.el_.focus()}blur(){this.el_.blur()}handleKeyDown(e){this.player_&&(e.key!=="Tab"&&!(this.player_.options_.playerOptions.spatialNavigation&&this.player_.options_.playerOptions.spatialNavigation.enabled)&&e.stopPropagation(),this.player_.handleKeyDown(e))}handleKeyPress(e){this.handleKeyDown(e)}emitTapEvents(){let e=0,t=null;const i=10,s=200;let n;this.on("touchstart",function(o){o.touches.length===1&&(t={pageX:o.touches[0].pageX,pageY:o.touches[0].pageY},e=U.performance.now(),n=!0)}),this.on("touchmove",function(o){if(o.touches.length>1)n=!1;else if(t){const l=o.touches[0].pageX-t.pageX,u=o.touches[0].pageY-t.pageY;Math.sqrt(l*l+u*u)>i&&(n=!1)}});const a=function(){n=!1};this.on("touchleave",a),this.on("touchcancel",a),this.on("touchend",function(o){t=null,n===!0&&U.performance.now()-e<s&&(o.preventDefault(),this.trigger("tap"))})}enableTouchActivity(){if(!this.player()||!this.player().reportUserActivity)return;const e=ut(this.player(),this.player().reportUserActivity);let t;this.on("touchstart",function(){e(),this.clearInterval(t),t=this.setInterval(e,250)});const i=function(s){e(),this.clearInterval(t)};this.on("touchmove",e),this.on("touchend",i),this.on("touchcancel",i)}setTimeout(e,t){var i;return e=ut(this,e),this.clearTimersOnDispose_(),i=U.setTimeout(()=>{this.setTimeoutIds_.has(i)&&this.setTimeoutIds_.delete(i),e()},t),this.setTimeoutIds_.add(i),i}clearTimeout(e){return this.setTimeoutIds_.has(e)&&(this.setTimeoutIds_.delete(e),U.clearTimeout(e)),e}setInterval(e,t){e=ut(this,e),this.clearTimersOnDispose_();const i=U.setInterval(e,t);return this.setIntervalIds_.add(i),i}clearInterval(e){return this.setIntervalIds_.has(e)&&(this.setIntervalIds_.delete(e),U.clearInterval(e)),e}requestAnimationFrame(e){this.clearTimersOnDispose_();var t;return e=ut(this,e),t=U.requestAnimationFrame(()=>{this.rafIds_.has(t)&&this.rafIds_.delete(t),e()}),this.rafIds_.add(t),t}requestNamedAnimationFrame(e,t){this.namedRafs_.has(e)&&this.cancelNamedAnimationFrame(e),this.clearTimersOnDispose_(),t=ut(this,t);const i=this.requestAnimationFrame(()=>{t(),this.namedRafs_.has(e)&&this.namedRafs_.delete(e)});return this.namedRafs_.set(e,i),e}cancelNamedAnimationFrame(e){this.namedRafs_.has(e)&&(this.cancelAnimationFrame(this.namedRafs_.get(e)),this.namedRafs_.delete(e))}cancelAnimationFrame(e){return this.rafIds_.has(e)&&(this.rafIds_.delete(e),U.cancelAnimationFrame(e)),e}clearTimersOnDispose_(){this.clearingTimersOnDispose_||(this.clearingTimersOnDispose_=!0,this.one("dispose",()=>{[["namedRafs_","cancelNamedAnimationFrame"],["rafIds_","cancelAnimationFrame"],["setTimeoutIds_","clearTimeout"],["setIntervalIds_","clearInterval"]].forEach(([e,t])=>{this[e].forEach((i,s)=>this[t](s))}),this.clearingTimersOnDispose_=!1}))}getIsDisabled(){return!!this.el_.disabled}getIsExpresslyInert(){return this.el_.inert&&!this.el_.ownerDocument.documentElement.inert}getIsFocusable(e){return(e||this.el_).tabIndex>=0&&!(this.getIsDisabled()||this.getIsExpresslyInert())}getIsAvailableToBeFocused(e){function t(n){const a=U.getComputedStyle(n,null),o=a.getPropertyValue("visibility");return a.getPropertyValue("display")!=="none"&&!["hidden","collapse"].includes(o)}function i(n){return!(!t(n.parentElement)||!t(n)||n.style.opacity==="0"||U.getComputedStyle(n).height==="0px"||U.getComputedStyle(n).width==="0px")}function s(n){if(n.offsetWidth+n.offsetHeight+n.getBoundingClientRect().height+n.getBoundingClientRect().width===0)return!1;const a={x:n.getBoundingClientRect().left+n.offsetWidth/2,y:n.getBoundingClientRect().top+n.offsetHeight/2};if(a.x<0||a.x>(ue.documentElement.clientWidth||U.innerWidth)||a.y<0||a.y>(ue.documentElement.clientHeight||U.innerHeight))return!1;let o=ue.elementFromPoint(a.x,a.y);for(;o;){if(o===n)return!0;if(o.parentNode)o=o.parentNode;else return!1}}return e||(e=this.el()),!!(s(e)&&i(e)&&(!e.parentElement||e.tabIndex>=0))}static registerComponent(e,t){if(typeof e!="string"||!e)throw new Error(`Illegal component name, "${e}"; must be a non-empty string.`);const i=ee.getComponent("Tech"),s=i&&i.isTech(t),n=ee===t||ee.prototype.isPrototypeOf(t.prototype);if(s||!n){let o;throw s?o="techs must be registered using Tech.registerTech()":o="must be a Component subclass",new Error(`Illegal component, "${e}"; ${o}.`)}e=Tt(e),ee.components_||(ee.components_={});const a=ee.getComponent("Player");if(e==="Player"&&a&&a.players){const o=a.players,l=Object.keys(o);if(o&&l.length>0){for(let u=0;u<l.length;u++)if(o[l[u]]!==null)throw new Error("Can not register Player component after player has been created.")}}return ee.components_[e]=t,ee.components_[Yo(e)]=t,t}static getComponent(e){if(!(!e||!ee.components_))return ee.components_[e]}}ee.registerComponent("Component",ee);function wL(r,e,t){if(typeof e!="number"||e<0||e>t)throw new Error(`Failed to execute '${r}' on 'TimeRanges': The index provided (${e}) is non-numeric or out of bounds (0-${t}).`)}function Ry(r,e,t,i){return wL(r,i,t.length-1),t[i][e]}function rf(r){let e;return r===void 0||r.length===0?e={length:0,start(){throw new Error("This TimeRanges object is empty")},end(){throw new Error("This TimeRanges object is empty")}}:e={length:r.length,start:Ry.bind(null,"start",0,r),end:Ry.bind(null,"end",1,r)},U.Symbol&&U.Symbol.iterator&&(e[U.Symbol.iterator]=()=>(r||[]).values()),e}function mr(r,e){return Array.isArray(r)?rf(r):r===void 0||e===void 0?rf():rf([[r,e]])}const XT=function(r,e){r=r<0?0:r;let t=Math.floor(r%60),i=Math.floor(r/60%60),s=Math.floor(r/3600);const n=Math.floor(e/60%60),a=Math.floor(e/3600);return(isNaN(r)||r===1/0)&&(s=i=t="-"),s=s>0||a>0?s+":":"",i=((s||n>=10)&&i<10?"0"+i:i)+":",t=t<10?"0"+t:t,s+i+t};let Sg=XT;function jT(r){Sg=r}function zT(){Sg=XT}function Mn(r,e=r){return Sg(r,e)}var CL=Object.freeze({__proto__:null,createTimeRanges:mr,createTimeRange:mr,setFormatTime:jT,resetFormatTime:zT,formatTime:Mn});function ZT(r,e){let t=0,i,s;if(!e)return 0;(!r||!r.length)&&(r=mr(0,0));for(let n=0;n<r.length;n++)i=r.start(n),s=r.end(n),s>e&&(s=e),t+=s-i;return t/e}function St(r){if(r instanceof St)return r;typeof r=="number"?this.code=r:typeof r=="string"?this.message=r:Zr(r)&&(typeof r.code=="number"&&(this.code=r.code),Object.assign(this,r)),this.message||(this.message=St.defaultMessages[this.code]||"")}St.prototype.code=0;St.prototype.message="";St.prototype.status=null;St.prototype.metadata=null;St.errorTypes=["MEDIA_ERR_CUSTOM","MEDIA_ERR_ABORTED","MEDIA_ERR_NETWORK","MEDIA_ERR_DECODE","MEDIA_ERR_SRC_NOT_SUPPORTED","MEDIA_ERR_ENCRYPTED"];St.defaultMessages={1:"You aborted the media playback",2:"A network error caused the media download to fail part-way.",3:"The media playback was aborted due to a corruption problem or because the media used features your browser did not support.",4:"The media could not be loaded, either because the server or network failed or because the format is not supported.",5:"The media is encrypted and we do not have the keys to decrypt it."};St.MEDIA_ERR_CUSTOM=0;St.prototype.MEDIA_ERR_CUSTOM=0;St.MEDIA_ERR_ABORTED=1;St.prototype.MEDIA_ERR_ABORTED=1;St.MEDIA_ERR_NETWORK=2;St.prototype.MEDIA_ERR_NETWORK=2;St.MEDIA_ERR_DECODE=3;St.prototype.MEDIA_ERR_DECODE=3;St.MEDIA_ERR_SRC_NOT_SUPPORTED=4;St.prototype.MEDIA_ERR_SRC_NOT_SUPPORTED=4;St.MEDIA_ERR_ENCRYPTED=5;St.prototype.MEDIA_ERR_ENCRYPTED=5;function Go(r){return r!=null&&typeof r.then=="function"}function Br(r){Go(r)&&r.then(null,e=>{})}const _p=function(r){return["kind","label","language","id","inBandMetadataTrackDispatchType","mode","src"].reduce((t,i,s)=>(r[i]&&(t[i]=r[i]),t),{cues:r.cues&&Array.prototype.map.call(r.cues,function(t){return{startTime:t.startTime,endTime:t.endTime,text:t.text,id:t.id}})})},kL=function(r){const e=r.$$("track"),t=Array.prototype.map.call(e,s=>s.track);return Array.prototype.map.call(e,function(s){const n=_p(s.track);return s.src&&(n.src=s.src),n}).concat(Array.prototype.filter.call(r.textTracks(),function(s){return t.indexOf(s)===-1}).map(_p))},EL=function(r,e){return r.forEach(function(t){const i=e.addRemoteTextTrack(t).track;!t.src&&t.cues&&t.cues.forEach(s=>i.addCue(s))}),e.textTracks()};var xp={textTracksToJson:kL,jsonToTextTracks:EL,trackToJson:_p};const sf="vjs-modal-dialog";class Ka extends ee{constructor(e,t){super(e,t),this.handleKeyDown_=i=>this.handleKeyDown(i),this.close_=i=>this.close(i),this.opened_=this.hasBeenOpened_=this.hasBeenFilled_=!1,this.closeable(!this.options_.uncloseable),this.content(this.options_.content),this.contentEl_=Me("div",{className:`${sf}-content`},{role:"document"}),this.descEl_=Me("p",{className:`${sf}-description vjs-control-text`,id:this.el().getAttribute("aria-describedby")}),Js(this.descEl_,this.description()),this.el_.appendChild(this.descEl_),this.el_.appendChild(this.contentEl_)}createEl(){return super.createEl("div",{className:this.buildCSSClass(),tabIndex:-1},{"aria-describedby":`${this.id()}_description`,"aria-hidden":"true","aria-label":this.label(),role:"dialog","aria-live":"polite"})}dispose(){this.contentEl_=null,this.descEl_=null,this.previouslyActiveEl_=null,super.dispose()}buildCSSClass(){return`${sf} vjs-hidden ${super.buildCSSClass()}`}label(){return this.localize(this.options_.label||"Modal Window")}description(){let e=this.options_.description||this.localize("This is a modal window.");return this.closeable()&&(e+=" "+this.localize("This modal can be closed by pressing the Escape key or activating the close button.")),e}open(){if(this.opened_){this.options_.fillAlways&&this.fill();return}const e=this.player();this.trigger("beforemodalopen"),this.opened_=!0,(this.options_.fillAlways||!this.hasBeenOpened_&&!this.hasBeenFilled_)&&this.fill(),this.wasPlaying_=!e.paused(),this.options_.pauseOnOpen&&this.wasPlaying_&&e.pause(),this.on("keydown",this.handleKeyDown_),this.hadControls_=e.controls(),e.controls(!1),this.show(),this.conditionalFocus_(),this.el().setAttribute("aria-hidden","false"),this.trigger("modalopen"),this.hasBeenOpened_=!0}opened(e){return typeof e=="boolean"&&this[e?"open":"close"](),this.opened_}close(){if(!this.opened_)return;const e=this.player();this.trigger("beforemodalclose"),this.opened_=!1,this.wasPlaying_&&this.options_.pauseOnOpen&&e.play(),this.off("keydown",this.handleKeyDown_),this.hadControls_&&e.controls(!0),this.hide(),this.el().setAttribute("aria-hidden","true"),this.trigger({type:"modalclose",bubbles:!0}),this.conditionalBlur_(),this.options_.temporary&&this.dispose()}closeable(e){if(typeof e=="boolean"){const t=this.closeable_=!!e;let i=this.getChild("closeButton");if(t&&!i){const s=this.contentEl_;this.contentEl_=this.el_,i=this.addChild("closeButton",{controlText:"Close Modal Dialog"}),this.contentEl_=s,this.on(i,"close",this.close_)}!t&&i&&(this.off(i,"close",this.close_),this.removeChild(i),i.dispose())}return this.closeable_}fill(){this.fillWith(this.content())}fillWith(e){const t=this.contentEl(),i=t.parentNode,s=t.nextSibling;this.trigger("beforemodalfill"),this.hasBeenFilled_=!0,i.removeChild(t),this.empty(),MT(t,e),this.trigger("modalfill"),s?i.insertBefore(t,s):i.appendChild(t);const n=this.getChild("closeButton");n&&i.appendChild(n.el_),this.trigger("aftermodalfill")}empty(){this.trigger("beforemodalempty"),Yh(this.contentEl()),this.trigger("modalempty")}content(e){return typeof e<"u"&&(this.content_=e),this.content_}conditionalFocus_(){const e=ue.activeElement,t=this.player_.el_;this.previouslyActiveEl_=null,(t.contains(e)||t===e)&&(this.previouslyActiveEl_=e,this.focus())}conditionalBlur_(){this.previouslyActiveEl_&&(this.previouslyActiveEl_.focus(),this.previouslyActiveEl_=null)}handleKeyDown(e){if(this.trigger({type:"modalKeydown",originalEvent:e,target:this,bubbles:!0}),e.stopPropagation(),e.key==="Escape"&&this.closeable()){e.preventDefault(),this.close();return}if(e.key!=="Tab")return;const t=this.focusableEls_(),i=this.el_.querySelector(":focus");let s;for(let n=0;n<t.length;n++)if(i===t[n]){s=n;break}ue.activeElement===this.el_&&(s=0),e.shiftKey&&s===0?(t[t.length-1].focus(),e.preventDefault()):!e.shiftKey&&s===t.length-1&&(t[0].focus(),e.preventDefault())}focusableEls_(){const e=this.el_.querySelectorAll("*");return Array.prototype.filter.call(e,t=>(t instanceof U.HTMLAnchorElement||t instanceof U.HTMLAreaElement)&&t.hasAttribute("href")||(t instanceof U.HTMLInputElement||t instanceof U.HTMLSelectElement||t instanceof U.HTMLTextAreaElement||t instanceof U.HTMLButtonElement)&&!t.hasAttribute("disabled")||t instanceof U.HTMLIFrameElement||t instanceof U.HTMLObjectElement||t instanceof U.HTMLEmbedElement||t.hasAttribute("tabindex")&&t.getAttribute("tabindex")!==-1||t.hasAttribute("contenteditable"))}}Ka.prototype.options_={pauseOnOpen:!0,temporary:!0};ee.registerComponent("ModalDialog",Ka);class In extends qi{constructor(e=[]){super(),this.tracks_=[],Object.defineProperty(this,"length",{get(){return this.tracks_.length}});for(let t=0;t<e.length;t++)this.addTrack(e[t])}addTrack(e){const t=this.tracks_.length;""+t in this||Object.defineProperty(this,t,{get(){return this.tracks_[t]}}),this.tracks_.indexOf(e)===-1&&(this.tracks_.push(e),this.trigger({track:e,type:"addtrack",target:this})),e.labelchange_=()=>{this.trigger({track:e,type:"labelchange",target:this})},ps(e)&&e.addEventListener("labelchange",e.labelchange_)}removeTrack(e){let t;for(let i=0,s=this.length;i<s;i++)if(this[i]===e){t=this[i],t.off&&t.off(),this.tracks_.splice(i,1);break}t&&this.trigger({track:t,type:"removetrack",target:this})}getTrackById(e){let t=null;for(let i=0,s=this.length;i<s;i++){const n=this[i];if(n.id===e){t=n;break}}return t}}In.prototype.allowedEvents_={change:"change",addtrack:"addtrack",removetrack:"removetrack",labelchange:"labelchange"};for(const r in In.prototype.allowedEvents_)In.prototype["on"+r]=null;const nf=function(r,e){for(let t=0;t<r.length;t++)!Object.keys(r[t]).length||e.id===r[t].id||(r[t].enabled=!1)};class WT extends In{constructor(e=[]){for(let t=e.length-1;t>=0;t--)if(e[t].enabled){nf(e,e[t]);break}super(e),this.changing_=!1}addTrack(e){e.enabled&&nf(this,e),super.addTrack(e),e.addEventListener&&(e.enabledChange_=()=>{this.changing_||(this.changing_=!0,nf(this,e),this.changing_=!1,this.trigger("change"))},e.addEventListener("enabledchange",e.enabledChange_))}removeTrack(e){super.removeTrack(e),e.removeEventListener&&e.enabledChange_&&(e.removeEventListener("enabledchange",e.enabledChange_),e.enabledChange_=null)}}const af=function(r,e){for(let t=0;t<r.length;t++)!Object.keys(r[t]).length||e.id===r[t].id||(r[t].selected=!1)};class HT extends In{constructor(e=[]){for(let t=e.length-1;t>=0;t--)if(e[t].selected){af(e,e[t]);break}super(e),this.changing_=!1,Object.defineProperty(this,"selectedIndex",{get(){for(let t=0;t<this.length;t++)if(this[t].selected)return t;return-1},set(){}})}addTrack(e){e.selected&&af(this,e),super.addTrack(e),e.addEventListener&&(e.selectedChange_=()=>{this.changing_||(this.changing_=!0,af(this,e),this.changing_=!1,this.trigger("change"))},e.addEventListener("selectedchange",e.selectedChange_))}removeTrack(e){super.removeTrack(e),e.removeEventListener&&e.selectedChange_&&(e.removeEventListener("selectedchange",e.selectedChange_),e.selectedChange_=null)}}class Tg extends In{addTrack(e){super.addTrack(e),this.queueChange_||(this.queueChange_=()=>this.queueTrigger("change")),this.triggerSelectedlanguagechange||(this.triggerSelectedlanguagechange_=()=>this.trigger("selectedlanguagechange")),e.addEventListener("modechange",this.queueChange_),["metadata","chapters"].indexOf(e.kind)===-1&&e.addEventListener("modechange",this.triggerSelectedlanguagechange_)}removeTrack(e){super.removeTrack(e),e.removeEventListener&&(this.queueChange_&&e.removeEventListener("modechange",this.queueChange_),this.selectedlanguagechange_&&e.removeEventListener("modechange",this.triggerSelectedlanguagechange_))}toJSON(){return this.tracks_.map(e=>e.toJSON())}}class AL{constructor(e=[]){this.trackElements_=[],Object.defineProperty(this,"length",{get(){return this.trackElements_.length}});for(let t=0,i=e.length;t<i;t++)this.addTrackElement_(e[t])}addTrackElement_(e){const t=this.trackElements_.length;""+t in this||Object.defineProperty(this,t,{get(){return this.trackElements_[t]}}),this.trackElements_.indexOf(e)===-1&&this.trackElements_.push(e)}getTrackElementByTrack_(e){let t;for(let i=0,s=this.trackElements_.length;i<s;i++)if(e===this.trackElements_[i].track){t=this.trackElements_[i];break}return t}removeTrackElement_(e){for(let t=0,i=this.trackElements_.length;t<i;t++)if(e===this.trackElements_[t]){this.trackElements_[t].track&&typeof this.trackElements_[t].track.off=="function"&&this.trackElements_[t].track.off(),typeof this.trackElements_[t].off=="function"&&this.trackElements_[t].off(),this.trackElements_.splice(t,1);break}}}class jc{constructor(e){jc.prototype.setCues_.call(this,e),Object.defineProperty(this,"length",{get(){return this.length_}})}setCues_(e){const t=this.length||0;let i=0;const s=e.length;this.cues_=e,this.length_=e.length;const n=function(a){""+a in this||Object.defineProperty(this,""+a,{get(){return this.cues_[a]}})};if(t<s)for(i=t;i<s;i++)n.call(this,i)}getCueById(e){let t=null;for(let i=0,s=this.length;i<s;i++){const n=this[i];if(n.id===e){t=n;break}}return t}}const PL={alternative:"alternative",captions:"captions",main:"main",sign:"sign",subtitles:"subtitles",commentary:"commentary"},DL={alternative:"alternative",descriptions:"descriptions",main:"main","main-desc":"main-desc",translation:"translation",commentary:"commentary"},ML={subtitles:"subtitles",captions:"captions",descriptions:"descriptions",chapters:"chapters",metadata:"metadata"},Ly={disabled:"disabled",hidden:"hidden",showing:"showing"};class _g extends qi{constructor(e={}){super();const t={id:e.id||"vjs_track_"+rr(),kind:e.kind||"",language:e.language||""};let i=e.label||"";for(const s in t)Object.defineProperty(this,s,{get(){return t[s]},set(){}});Object.defineProperty(this,"label",{get(){return i},set(s){s!==i&&(i=s,this.trigger("labelchange"))}})}}const xg=function(r){return new URL(r,ue.baseURI)},YT=function(r){return new URL(r,ue.baseURI).href},wg=function(r){if(typeof r=="string"){const t=r.split("?")[0].replace(/\/+$/,"").match(/\.([^.\/]+)$/);return t?t[1].toLowerCase():""}return""},ed=function(r,e=U.location){return xg(r).origin!==e.origin};var IL=Object.freeze({__proto__:null,parseUrl:xg,getAbsoluteURL:YT,getFileExtension:wg,isCrossOrigin:ed});const Qy=function(r,e){const t=new U.WebVTT.Parser(U,U.vttjs,U.WebVTT.StringDecoder()),i=[];t.oncue=function(s){e.addCue(s)},t.onparsingerror=function(s){i.push(s)},t.onflush=function(){e.trigger({type:"loadeddata",target:e})},t.parse(r),i.length>0&&(U.console&&U.console.groupCollapsed&&U.console.groupCollapsed(`Text Track parsing errors for ${e.src}`),i.forEach(s=>Be.error(s)),U.console&&U.console.groupEnd&&U.console.groupEnd()),t.flush()},$y=function(r,e){const t={uri:r},i=ed(r);i&&(t.cors=i);const s=e.tech_.crossOrigin()==="use-credentials";s&&(t.withCredentials=s),K1(t,ut(this,function(n,a,o){if(n)return Be.error(n,a);e.loaded_=!0,typeof U.WebVTT!="function"?e.tech_&&e.tech_.any(["vttjsloaded","vttjserror"],l=>{if(l.type==="vttjserror"){Be.error(`vttjs failed to load, stopping trying to process ${e.src}`);return}return Qy(o,e)}):Qy(o,e)}))};class Zl extends _g{constructor(e={}){if(!e.tech)throw new Error("A tech was not provided.");const t=Je(e,{kind:ML[e.kind]||"subtitles",language:e.language||e.srclang||""});let i=Ly[t.mode]||"disabled";const s=t.default;(t.kind==="metadata"||t.kind==="chapters")&&(i="hidden"),super(t),this.tech_=t.tech,this.cues_=[],this.activeCues_=[],this.preload_=this.tech_.preloadTextTracks!==!1;const n=new jc(this.cues_),a=new jc(this.activeCues_);let o=!1;this.timeupdateHandler=ut(this,function(u={}){if(!this.tech_.isDisposed()){if(!this.tech_.isReady_){u.type!=="timeupdate"&&(this.rvf_=this.tech_.requestVideoFrameCallback(this.timeupdateHandler));return}this.activeCues=this.activeCues,o&&(this.trigger("cuechange"),o=!1),u.type!=="timeupdate"&&(this.rvf_=this.tech_.requestVideoFrameCallback(this.timeupdateHandler))}});const l=()=>{this.stopTracking()};this.tech_.one("dispose",l),i!=="disabled"&&this.startTracking(),Object.defineProperties(this,{default:{get(){return s},set(){}},mode:{get(){return i},set(u){Ly[u]&&i!==u&&(i=u,!this.preload_&&i!=="disabled"&&this.cues.length===0&&$y(this.src,this),this.stopTracking(),i!=="disabled"&&this.startTracking(),this.trigger("modechange"))}},cues:{get(){return this.loaded_?n:null},set(){}},activeCues:{get(){if(!this.loaded_)return null;if(this.cues.length===0)return a;const u=this.tech_.currentTime(),c=[];for(let h=0,f=this.cues.length;h<f;h++){const m=this.cues[h];m.startTime<=u&&m.endTime>=u&&c.push(m)}if(o=!1,c.length!==this.activeCues_.length)o=!0;else for(let h=0;h<c.length;h++)this.activeCues_.indexOf(c[h])===-1&&(o=!0);return this.activeCues_=c,a.setCues_(this.activeCues_),a},set(){}}}),t.src?(this.src=t.src,this.preload_||(this.loaded_=!0),(this.preload_||t.kind!=="subtitles"&&t.kind!=="captions")&&$y(this.src,this)):this.loaded_=!0}startTracking(){this.rvf_=this.tech_.requestVideoFrameCallback(this.timeupdateHandler),this.tech_.on("timeupdate",this.timeupdateHandler)}stopTracking(){this.rvf_&&(this.tech_.cancelVideoFrameCallback(this.rvf_),this.rvf_=void 0),this.tech_.off("timeupdate",this.timeupdateHandler)}addCue(e){let t=e;if(!("getCueAsHTML"in t)){t=new U.vttjs.VTTCue(e.startTime,e.endTime,e.text);for(const s in e)s in t||(t[s]=e[s]);t.id=e.id,t.originalCue_=e}const i=this.tech_.textTracks();for(let s=0;s<i.length;s++)i[s]!==this&&i[s].removeCue(t);this.cues_.push(t),this.cues.setCues_(this.cues_)}toJSON(){return xp.trackToJson(this)}removeCue(e){let t=this.cues_.length;for(;t--;){const i=this.cues_[t];if(i===e||i.originalCue_&&i.originalCue_===e){this.cues_.splice(t,1),this.cues.setCues_(this.cues_);break}}}}Zl.prototype.allowedEvents_={cuechange:"cuechange"};class GT extends _g{constructor(e={}){const t=Je(e,{kind:DL[e.kind]||""});super(t);let i=!1;Object.defineProperty(this,"enabled",{get(){return i},set(s){typeof s!="boolean"||s===i||(i=s,this.trigger("enabledchange"))}}),t.enabled&&(this.enabled=t.enabled),this.loaded_=!0}}class KT extends _g{constructor(e={}){const t=Je(e,{kind:PL[e.kind]||""});super(t);let i=!1;Object.defineProperty(this,"selected",{get(){return i},set(s){typeof s!="boolean"||s===i||(i=s,this.trigger("selectedchange"))}}),t.selected&&(this.selected=t.selected)}}class Os extends qi{constructor(e={}){super();let t;const i=new Zl(e);this.kind=i.kind,this.src=i.src,this.srclang=i.language,this.label=i.label,this.default=i.default,Object.defineProperties(this,{readyState:{get(){return t}},track:{get(){return i}}}),t=Os.NONE,i.addEventListener("loadeddata",()=>{t=Os.LOADED,this.trigger({type:"load",target:this})})}}Os.prototype.allowedEvents_={load:"load"};Os.NONE=0;Os.LOADING=1;Os.LOADED=2;Os.ERROR=3;const tr={audio:{ListClass:WT,TrackClass:GT,capitalName:"Audio"},video:{ListClass:HT,TrackClass:KT,capitalName:"Video"},text:{ListClass:Tg,TrackClass:Zl,capitalName:"Text"}};Object.keys(tr).forEach(function(r){tr[r].getterName=`${r}Tracks`,tr[r].privateName=`${r}Tracks_`});const La={remoteText:{ListClass:Tg,TrackClass:Zl,capitalName:"RemoteText",getterName:"remoteTextTracks",privateName:"remoteTextTracks_"},remoteTextEl:{ListClass:AL,TrackClass:Os,capitalName:"RemoteTextTrackEls",getterName:"remoteTextTrackEls",privateName:"remoteTextTrackEls_"}},pi=Object.assign({},tr,La);La.names=Object.keys(La);tr.names=Object.keys(tr);pi.names=[].concat(La.names).concat(tr.names);function RL(r,e,t,i,s={}){const n=r.textTracks();s.kind=e,t&&(s.label=t),i&&(s.language=i),s.tech=r;const a=new pi.text.TrackClass(s);return n.addTrack(a),a}class Le extends ee{constructor(e={},t=function(){}){e.reportTouchActivity=!1,super(null,e,t),this.onDurationChange_=i=>this.onDurationChange(i),this.trackProgress_=i=>this.trackProgress(i),this.trackCurrentTime_=i=>this.trackCurrentTime(i),this.stopTrackingCurrentTime_=i=>this.stopTrackingCurrentTime(i),this.disposeSourceHandler_=i=>this.disposeSourceHandler(i),this.queuedHanders_=new Set,this.hasStarted_=!1,this.on("playing",function(){this.hasStarted_=!0}),this.on("loadstart",function(){this.hasStarted_=!1}),pi.names.forEach(i=>{const s=pi[i];e&&e[s.getterName]&&(this[s.privateName]=e[s.getterName])}),this.featuresProgressEvents||this.manualProgressOn(),this.featuresTimeupdateEvents||this.manualTimeUpdatesOn(),["Text","Audio","Video"].forEach(i=>{e[`native${i}Tracks`]===!1&&(this[`featuresNative${i}Tracks`]=!1)}),e.nativeCaptions===!1||e.nativeTextTracks===!1?this.featuresNativeTextTracks=!1:(e.nativeCaptions===!0||e.nativeTextTracks===!0)&&(this.featuresNativeTextTracks=!0),this.featuresNativeTextTracks||this.emulateTextTracks(),this.preloadTextTracks=e.preloadTextTracks!==!1,this.autoRemoteTextTracks_=new pi.text.ListClass,this.initTrackListeners(),e.nativeControlsForTouch||this.emitTapEvents(),this.constructor&&(this.name_=this.constructor.name||"Unknown Tech")}triggerSourceset(e){this.isReady_||this.one("ready",()=>this.setTimeout(()=>this.triggerSourceset(e),1)),this.trigger({src:e,type:"sourceset"})}manualProgressOn(){this.on("durationchange",this.onDurationChange_),this.manualProgress=!0,this.one("ready",this.trackProgress_)}manualProgressOff(){this.manualProgress=!1,this.stopTrackingProgress(),this.off("durationchange",this.onDurationChange_)}trackProgress(e){this.stopTrackingProgress(),this.progressInterval=this.setInterval(ut(this,function(){const t=this.bufferedPercent();this.bufferedPercent_!==t&&this.trigger("progress"),this.bufferedPercent_=t,t===1&&this.stopTrackingProgress()}),500)}onDurationChange(e){this.duration_=this.duration()}buffered(){return mr(0,0)}bufferedPercent(){return ZT(this.buffered(),this.duration_)}stopTrackingProgress(){this.clearInterval(this.progressInterval)}manualTimeUpdatesOn(){this.manualTimeUpdates=!0,this.on("play",this.trackCurrentTime_),this.on("pause",this.stopTrackingCurrentTime_)}manualTimeUpdatesOff(){this.manualTimeUpdates=!1,this.stopTrackingCurrentTime(),this.off("play",this.trackCurrentTime_),this.off("pause",this.stopTrackingCurrentTime_)}trackCurrentTime(){this.currentTimeInterval&&this.stopTrackingCurrentTime(),this.currentTimeInterval=this.setInterval(function(){this.trigger({type:"timeupdate",target:this,manuallyTriggered:!0})},250)}stopTrackingCurrentTime(){this.clearInterval(this.currentTimeInterval),this.trigger({type:"timeupdate",target:this,manuallyTriggered:!0})}dispose(){this.clearTracks(tr.names),this.manualProgress&&this.manualProgressOff(),this.manualTimeUpdates&&this.manualTimeUpdatesOff(),super.dispose()}clearTracks(e){e=[].concat(e),e.forEach(t=>{const i=this[`${t}Tracks`]()||[];let s=i.length;for(;s--;){const n=i[s];t==="text"&&this.removeRemoteTextTrack(n),i.removeTrack(n)}})}cleanupAutoTextTracks(){const e=this.autoRemoteTextTracks_||[];let t=e.length;for(;t--;){const i=e[t];this.removeRemoteTextTrack(i)}}reset(){}crossOrigin(){}setCrossOrigin(){}error(e){return e!==void 0&&(this.error_=new St(e),this.trigger("error")),this.error_}played(){return this.hasStarted_?mr(0,0):mr()}play(){}setScrubbing(e){}scrubbing(){}setCurrentTime(e){this.manualTimeUpdates&&this.trigger({type:"timeupdate",target:this,manuallyTriggered:!0})}initTrackListeners(){tr.names.forEach(e=>{const t=tr[e],i=()=>{this.trigger(`${e}trackchange`)},s=this[t.getterName]();s.addEventListener("removetrack",i),s.addEventListener("addtrack",i),this.on("dispose",()=>{s.removeEventListener("removetrack",i),s.removeEventListener("addtrack",i)})})}addWebVttScript_(){if(!U.WebVTT)if(ue.body.contains(this.el())){if(!this.options_["vtt.js"]&&Da(oy)&&Object.keys(oy).length>0){this.trigger("vttjsloaded");return}const e=ue.createElement("script");e.src=this.options_["vtt.js"]||"https://vjs.zencdn.net/vttjs/0.14.1/vtt.min.js",e.onload=()=>{this.trigger("vttjsloaded")},e.onerror=()=>{this.trigger("vttjserror")},this.on("dispose",()=>{e.onload=null,e.onerror=null}),U.WebVTT=!0,this.el().parentNode.appendChild(e)}else this.ready(this.addWebVttScript_)}emulateTextTracks(){const e=this.textTracks(),t=this.remoteTextTracks(),i=o=>e.addTrack(o.track),s=o=>e.removeTrack(o.track);t.on("addtrack",i),t.on("removetrack",s),this.addWebVttScript_();const n=()=>this.trigger("texttrackchange"),a=()=>{n();for(let o=0;o<e.length;o++){const l=e[o];l.removeEventListener("cuechange",n),l.mode==="showing"&&l.addEventListener("cuechange",n)}};a(),e.addEventListener("change",a),e.addEventListener("addtrack",a),e.addEventListener("removetrack",a),this.on("dispose",function(){t.off("addtrack",i),t.off("removetrack",s),e.removeEventListener("change",a),e.removeEventListener("addtrack",a),e.removeEventListener("removetrack",a);for(let o=0;o<e.length;o++)e[o].removeEventListener("cuechange",n)})}addTextTrack(e,t,i){if(!e)throw new Error("TextTrack kind is required but was not provided");return RL(this,e,t,i)}createRemoteTextTrack(e){const t=Je(e,{tech:this});return new La.remoteTextEl.TrackClass(t)}addRemoteTextTrack(e={},t){const i=this.createRemoteTextTrack(e);return typeof t!="boolean"&&(t=!1),this.remoteTextTrackEls().addTrackElement_(i),this.remoteTextTracks().addTrack(i.track),t===!1&&this.ready(()=>this.autoRemoteTextTracks_.addTrack(i.track)),i}removeRemoteTextTrack(e){const t=this.remoteTextTrackEls().getTrackElementByTrack_(e);this.remoteTextTrackEls().removeTrackElement_(t),this.remoteTextTracks().removeTrack(e),this.autoRemoteTextTracks_.removeTrack(e)}getVideoPlaybackQuality(){return{}}requestPictureInPicture(){return Promise.reject()}disablePictureInPicture(){return!0}setDisablePictureInPicture(){}requestVideoFrameCallback(e){const t=rr();return!this.isReady_||this.paused()?(this.queuedHanders_.add(t),this.one("playing",()=>{this.queuedHanders_.has(t)&&(this.queuedHanders_.delete(t),e())})):this.requestNamedAnimationFrame(t,e),t}cancelVideoFrameCallback(e){this.queuedHanders_.has(e)?this.queuedHanders_.delete(e):this.cancelNamedAnimationFrame(e)}setPoster(){}playsinline(){}setPlaysinline(){}overrideNativeAudioTracks(e){}overrideNativeVideoTracks(e){}canPlayType(e){return""}static canPlayType(e){return""}static canPlaySource(e,t){return Le.canPlayType(e.type)}static isTech(e){return e.prototype instanceof Le||e instanceof Le||e===Le}static registerTech(e,t){if(Le.techs_||(Le.techs_={}),!Le.isTech(t))throw new Error(`Tech ${e} must be a Tech`);if(!Le.canPlayType)throw new Error("Techs must have a static canPlayType method on them");if(!Le.canPlaySource)throw new Error("Techs must have a static canPlaySource method on them");return e=Tt(e),Le.techs_[e]=t,Le.techs_[Yo(e)]=t,e!=="Tech"&&Le.defaultTechOrder_.push(e),t}static getTech(e){if(e){if(Le.techs_&&Le.techs_[e])return Le.techs_[e];if(e=Tt(e),U&&U.videojs&&U.videojs[e])return Be.warn(`The ${e} tech was added to the videojs object when it should be registered using videojs.registerTech(name, tech)`),U.videojs[e]}}}pi.names.forEach(function(r){const e=pi[r];Le.prototype[e.getterName]=function(){return this[e.privateName]=this[e.privateName]||new e.ListClass,this[e.privateName]}});Le.prototype.featuresVolumeControl=!0;Le.prototype.featuresMuteControl=!0;Le.prototype.featuresFullscreenResize=!1;Le.prototype.featuresPlaybackRate=!1;Le.prototype.featuresProgressEvents=!1;Le.prototype.featuresSourceset=!1;Le.prototype.featuresTimeupdateEvents=!1;Le.prototype.featuresNativeTextTracks=!1;Le.prototype.featuresVideoFrameCallback=!1;Le.withSourceHandlers=function(r){r.registerSourceHandler=function(t,i){let s=r.sourceHandlers;s||(s=r.sourceHandlers=[]),i===void 0&&(i=s.length),s.splice(i,0,t)},r.canPlayType=function(t){const i=r.sourceHandlers||[];let s;for(let n=0;n<i.length;n++)if(s=i[n].canPlayType(t),s)return s;return""},r.selectSourceHandler=function(t,i){const s=r.sourceHandlers||[];let n;for(let a=0;a<s.length;a++)if(n=s[a].canHandleSource(t,i),n)return s[a];return null},r.canPlaySource=function(t,i){const s=r.selectSourceHandler(t,i);return s?s.canHandleSource(t,i):""},["seekable","seeking","duration"].forEach(function(t){const i=this[t];typeof i=="function"&&(this[t]=function(){return this.sourceHandler_&&this.sourceHandler_[t]?this.sourceHandler_[t].apply(this.sourceHandler_,arguments):i.apply(this,arguments)})},r.prototype),r.prototype.setSource=function(t){let i=r.selectSourceHandler(t,this.options_);i||(r.nativeSourceHandler?i=r.nativeSourceHandler:Be.error("No source handler found for the current source.")),this.disposeSourceHandler(),this.off("dispose",this.disposeSourceHandler_),i!==r.nativeSourceHandler&&(this.currentSource_=t),this.sourceHandler_=i.handleSource(t,this,this.options_),this.one("dispose",this.disposeSourceHandler_)},r.prototype.disposeSourceHandler=function(){this.currentSource_&&(this.clearTracks(["audio","video"]),this.currentSource_=null),this.cleanupAutoTextTracks(),this.sourceHandler_&&(this.sourceHandler_.dispose&&this.sourceHandler_.dispose(),this.sourceHandler_=null)}};ee.registerComponent("Tech",Le);Le.registerTech("Tech",Le);Le.defaultTechOrder_=[];const En={},zc={},Zc={};function LL(r,e){En[r]=En[r]||[],En[r].push(e)}function QL(r,e,t){r.setTimeout(()=>hn(e,En[e.type],t,r),1)}function $L(r,e){r.forEach(t=>t.setTech&&t.setTech(e))}function BL(r,e,t){return r.reduceRight(Cg(t),e[t]())}function NL(r,e,t,i){return e[t](r.reduce(Cg(t),i))}function By(r,e,t,i=null){const s="call"+Tt(t),n=r.reduce(Cg(s),i),a=n===Zc,o=a?null:e[t](n);return qL(r,t,o,a),o}const FL={buffered:1,currentTime:1,duration:1,muted:1,played:1,paused:1,seekable:1,volume:1,ended:1},UL={setCurrentTime:1,setMuted:1,setVolume:1},Ny={play:1,pause:1};function Cg(r){return(e,t)=>e===Zc?Zc:t[r]?t[r](e):e}function qL(r,e,t,i){for(let s=r.length-1;s>=0;s--){const n=r[s];n[e]&&n[e](i,t)}}function VL(r){zc.hasOwnProperty(r.id())&&delete zc[r.id()]}function XL(r,e){const t=zc[r.id()];let i=null;if(t==null)return i=e(r),zc[r.id()]=[[e,i]],i;for(let s=0;s<t.length;s++){const[n,a]=t[s];n===e&&(i=a)}return i===null&&(i=e(r),t.push([e,i])),i}function hn(r={},e=[],t,i,s=[],n=!1){const[a,...o]=e;if(typeof a=="string")hn(r,En[a],t,i,s,n);else if(a){const l=XL(i,a);if(!l.setSource)return s.push(l),hn(r,o,t,i,s,n);l.setSource(Object.assign({},r),function(u,c){if(u)return hn(r,o,t,i,s,n);s.push(l),hn(c,r.type===c.type?o:En[c.type],t,i,s,n)})}else o.length?hn(r,o,t,i,s,n):n?t(r,s):hn(r,En["*"],t,i,s,!0)}const jL={opus:"video/ogg",ogv:"video/ogg",mp4:"video/mp4",mov:"video/mp4",m4v:"video/mp4",mkv:"video/x-matroska",m4a:"audio/mp4",mp3:"audio/mpeg",aac:"audio/aac",caf:"audio/x-caf",flac:"audio/flac",oga:"audio/ogg",wav:"audio/wav",m3u8:"application/x-mpegURL",mpd:"application/dash+xml",jpg:"image/jpeg",jpeg:"image/jpeg",gif:"image/gif",png:"image/png",svg:"image/svg+xml",webp:"image/webp"},Wc=function(r=""){const e=wg(r);return jL[e.toLowerCase()]||""},zL=(r,e)=>{if(!e)return"";if(r.cache_.source.src===e&&r.cache_.source.type)return r.cache_.source.type;const t=r.cache_.sources.filter(s=>s.src===e);if(t.length)return t[0].type;const i=r.$$("source");for(let s=0;s<i.length;s++){const n=i[s];if(n.type&&n.src&&n.src===e)return n.type}return Wc(e)},JT=function(r){if(Array.isArray(r)){let e=[];r.forEach(function(t){t=JT(t),Array.isArray(t)?e=e.concat(t):Zr(t)&&e.push(t)}),r=e}else typeof r=="string"&&r.trim()?r=[Fy({src:r})]:Zr(r)&&typeof r.src=="string"&&r.src&&r.src.trim()?r=[Fy(r)]:r=[];return r};function Fy(r){if(!r.type){const e=Wc(r.src);e&&(r.type=e)}return r}var ZL=`<svg xmlns="http://www.w3.org/2000/svg">
  <defs>
    <symbol viewBox="0 0 48 48" id="vjs-icon-play">
      <path d="M16 10v28l22-14z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-pause">
      <path d="M12 38h8V10h-8v28zm16-28v28h8V10h-8z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-audio">
      <path d="M24 2C14.06 2 6 10.06 6 20v14c0 3.31 2.69 6 6 6h6V24h-8v-4c0-7.73 6.27-14 14-14s14 6.27 14 14v4h-8v16h6c3.31 0 6-2.69 6-6V20c0-9.94-8.06-18-18-18z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-captions">
      <path d="M38 8H10c-2.21 0-4 1.79-4 4v24c0 2.21 1.79 4 4 4h28c2.21 0 4-1.79 4-4V12c0-2.21-1.79-4-4-4zM22 22h-3v-1h-4v6h4v-1h3v2a2 2 0 0 1-2 2h-6a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h6a2 2 0 0 1 2 2v2zm14 0h-3v-1h-4v6h4v-1h3v2a2 2 0 0 1-2 2h-6a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h6a2 2 0 0 1 2 2v2z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-subtitles">
      <path d="M40 8H8c-2.21 0-4 1.79-4 4v24c0 2.21 1.79 4 4 4h32c2.21 0 4-1.79 4-4V12c0-2.21-1.79-4-4-4zM8 24h8v4H8v-4zm20 12H8v-4h20v4zm12 0h-8v-4h8v4zm0-8H20v-4h20v4z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-fullscreen-enter">
      <path d="M14 28h-4v10h10v-4h-6v-6zm-4-8h4v-6h6v-4H10v10zm24 14h-6v4h10V28h-4v6zm-6-24v4h6v6h4V10H28z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-fullscreen-exit">
      <path d="M10 32h6v6h4V28H10v4zm6-16h-6v4h10V10h-4v6zm12 22h4v-6h6v-4H28v10zm4-22v-6h-4v10h10v-4h-6z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-play-circle">
      <path d="M20 33l12-9-12-9v18zm4-29C12.95 4 4 12.95 4 24s8.95 20 20 20 20-8.95 20-20S35.05 4 24 4zm0 36c-8.82 0-16-7.18-16-16S15.18 8 24 8s16 7.18 16 16-7.18 16-16 16z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-volume-mute">
      <path d="M33 24c0-3.53-2.04-6.58-5-8.05v4.42l4.91 4.91c.06-.42.09-.85.09-1.28zm5 0c0 1.88-.41 3.65-1.08 5.28l3.03 3.03C41.25 29.82 42 27 42 24c0-8.56-5.99-15.72-14-17.54v4.13c5.78 1.72 10 7.07 10 13.41zM8.55 6L6 8.55 15.45 18H6v12h8l10 10V26.55l8.51 8.51c-1.34 1.03-2.85 1.86-4.51 2.36v4.13a17.94 17.94 0 0 0 7.37-3.62L39.45 42 42 39.45l-18-18L8.55 6zM24 8l-4.18 4.18L24 16.36V8z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-volume-low">
      <path d="M14 18v12h8l10 10V8L22 18h-8z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-volume-medium">
      <path d="M37 24c0-3.53-2.04-6.58-5-8.05v16.11c2.96-1.48 5-4.53 5-8.06zm-27-6v12h8l10 10V8L18 18h-8z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-volume-high">
      <path d="M6 18v12h8l10 10V8L14 18H6zm27 6c0-3.53-2.04-6.58-5-8.05v16.11c2.96-1.48 5-4.53 5-8.06zM28 6.46v4.13c5.78 1.72 10 7.07 10 13.41s-4.22 11.69-10 13.41v4.13c8.01-1.82 14-8.97 14-17.54S36.01 8.28 28 6.46z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-spinner">
      <path d="M18.8 21l9.53-16.51C26.94 4.18 25.49 4 24 4c-4.8 0-9.19 1.69-12.64 4.51l7.33 12.69.11-.2zm24.28-3c-1.84-5.85-6.3-10.52-11.99-12.68L23.77 18h19.31zm.52 2H28.62l.58 1 9.53 16.5C41.99 33.94 44 29.21 44 24c0-1.37-.14-2.71-.4-4zm-26.53 4l-7.8-13.5C6.01 14.06 4 18.79 4 24c0 1.37.14 2.71.4 4h14.98l-2.31-4zM4.92 30c1.84 5.85 6.3 10.52 11.99 12.68L24.23 30H4.92zm22.54 0l-7.8 13.51c1.4.31 2.85.49 4.34.49 4.8 0 9.19-1.69 12.64-4.51L29.31 26.8 27.46 30z"></path>
    </symbol>
    <symbol viewBox="0 0 24 24" id="vjs-icon-hd">
      <path d="M19 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-8 12H9.5v-2h-2v2H6V9h1.5v2.5h2V9H11v6zm2-6h4c.55 0 1 .45 1 1v4c0 .55-.45 1-1 1h-4V9zm1.5 4.5h2v-3h-2v3z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-chapters">
      <path d="M6 26h4v-4H6v4zm0 8h4v-4H6v4zm0-16h4v-4H6v4zm8 8h28v-4H14v4zm0 8h28v-4H14v4zm0-20v4h28v-4H14z"></path>
    </symbol>
    <symbol viewBox="0 0 40 40" id="vjs-icon-downloading">
      <path d="M18.208 36.875q-3.208-.292-5.979-1.729-2.771-1.438-4.812-3.729-2.042-2.292-3.188-5.229-1.146-2.938-1.146-6.23 0-6.583 4.334-11.416 4.333-4.834 10.833-5.5v3.166q-5.167.75-8.583 4.646Q6.25 14.75 6.25 19.958q0 5.209 3.396 9.104 3.396 3.896 8.562 4.646zM20 28.417L11.542 20l2.083-2.083 4.917 4.916v-11.25h2.916v11.25l4.875-4.916L28.417 20zm1.792 8.458v-3.167q1.833-.25 3.541-.958 1.709-.708 3.167-1.875l2.333 2.292q-1.958 1.583-4.25 2.541-2.291.959-4.791 1.167zm6.791-27.792q-1.541-1.125-3.25-1.854-1.708-.729-3.541-1.021V3.042q2.5.25 4.77 1.208 2.271.958 4.271 2.5zm4.584 21.584l-2.25-2.25q1.166-1.5 1.854-3.209.687-1.708.937-3.541h3.209q-.292 2.5-1.229 4.791-.938 2.292-2.521 4.209zm.541-12.417q-.291-1.833-.958-3.562-.667-1.73-1.833-3.188l2.375-2.208q1.541 1.916 2.458 4.208.917 2.292 1.167 4.75z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-file-download">
      <path d="M10.8 40.55q-1.35 0-2.375-1T7.4 37.15v-7.7h3.4v7.7h26.35v-7.7h3.4v7.7q0 1.4-1 2.4t-2.4 1zM24 32.1L13.9 22.05l2.45-2.45 5.95 5.95V7.15h3.4v18.4l5.95-5.95 2.45 2.45z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-file-download-done">
      <path d="M9.8 40.5v-3.45h28.4v3.45zm9.2-9.05L7.4 19.85l2.45-2.35L19 26.65l19.2-19.2 2.4 2.4z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-file-download-off">
      <path d="M4.9 4.75L43.25 43.1 41 45.3l-4.75-4.75q-.05.05-.075.025-.025-.025-.075-.025H10.8q-1.35 0-2.375-1T7.4 37.15v-7.7h3.4v7.7h22.05l-7-7-1.85 1.8L13.9 21.9l1.85-1.85L2.7 7zm26.75 14.7l2.45 2.45-3.75 3.8-2.45-2.5zM25.7 7.15V21.1l-3.4-3.45V7.15z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-share">
      <path d="M36 32.17c-1.52 0-2.89.59-3.93 1.54L17.82 25.4c.11-.45.18-.92.18-1.4s-.07-.95-.18-1.4l14.1-8.23c1.07 1 2.5 1.62 4.08 1.62 3.31 0 6-2.69 6-6s-2.69-6-6-6-6 2.69-6 6c0 .48.07.95.18 1.4l-14.1 8.23c-1.07-1-2.5-1.62-4.08-1.62-3.31 0-6 2.69-6 6s2.69 6 6 6c1.58 0 3.01-.62 4.08-1.62l14.25 8.31c-.1.42-.16.86-.16 1.31A5.83 5.83 0 1 0 36 32.17z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-cog">
      <path d="M38.86 25.95c.08-.64.14-1.29.14-1.95s-.06-1.31-.14-1.95l4.23-3.31c.38-.3.49-.84.24-1.28l-4-6.93c-.25-.43-.77-.61-1.22-.43l-4.98 2.01c-1.03-.79-2.16-1.46-3.38-1.97L29 4.84c-.09-.47-.5-.84-1-.84h-8c-.5 0-.91.37-.99.84l-.75 5.3a14.8 14.8 0 0 0-3.38 1.97L9.9 10.1a1 1 0 0 0-1.22.43l-4 6.93c-.25.43-.14.97.24 1.28l4.22 3.31C9.06 22.69 9 23.34 9 24s.06 1.31.14 1.95l-4.22 3.31c-.38.3-.49.84-.24 1.28l4 6.93c.25.43.77.61 1.22.43l4.98-2.01c1.03.79 2.16 1.46 3.38 1.97l.75 5.3c.08.47.49.84.99.84h8c.5 0 .91-.37.99-.84l.75-5.3a14.8 14.8 0 0 0 3.38-1.97l4.98 2.01a1 1 0 0 0 1.22-.43l4-6.93c.25-.43.14-.97-.24-1.28l-4.22-3.31zM24 31c-3.87 0-7-3.13-7-7s3.13-7 7-7 7 3.13 7 7-3.13 7-7 7z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-square">
      <path d="M36 8H12c-2.21 0-4 1.79-4 4v24c0 2.21 1.79 4 4 4h24c2.21 0 4-1.79 4-4V12c0-2.21-1.79-4-4-4zm0 28H12V12h24v24z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-circle">
      <circle cx="24" cy="24" r="20"></circle>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-circle-outline">
      <path d="M24 4C12.95 4 4 12.95 4 24s8.95 20 20 20 20-8.95 20-20S35.05 4 24 4zm0 36c-8.82 0-16-7.18-16-16S15.18 8 24 8s16 7.18 16 16-7.18 16-16 16z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-circle-inner-circle">
      <path d="M24 4C12.97 4 4 12.97 4 24s8.97 20 20 20 20-8.97 20-20S35.03 4 24 4zm0 36c-8.82 0-16-7.18-16-16S15.18 8 24 8s16 7.18 16 16-7.18 16-16 16zm6-16c0 3.31-2.69 6-6 6s-6-2.69-6-6 2.69-6 6-6 6 2.69 6 6z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-cancel">
      <path d="M24 4C12.95 4 4 12.95 4 24s8.95 20 20 20 20-8.95 20-20S35.05 4 24 4zm10 27.17L31.17 34 24 26.83 16.83 34 14 31.17 21.17 24 14 16.83 16.83 14 24 21.17 31.17 14 34 16.83 26.83 24 34 31.17z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-replay">
      <path d="M24 10V2L14 12l10 10v-8c6.63 0 12 5.37 12 12s-5.37 12-12 12-12-5.37-12-12H8c0 8.84 7.16 16 16 16s16-7.16 16-16-7.16-16-16-16z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-repeat">
      <path d="M14 14h20v6l8-8-8-8v6H10v12h4v-8zm20 20H14v-6l-8 8 8 8v-6h24V26h-4v8z"></path>
    </symbol>
    <symbol viewBox="0 96 48 48" id="vjs-icon-replay-5">
      <path d="M17.689 98l-8.697 8.696 8.697 8.697 2.486-2.485-4.32-4.319h1.302c4.93 0 9.071 1.722 12.424 5.165 3.352 3.443 5.029 7.638 5.029 12.584h3.55c0-2.958-.553-5.73-1.658-8.313-1.104-2.583-2.622-4.841-4.555-6.774-1.932-1.932-4.19-3.45-6.773-4.555-2.584-1.104-5.355-1.657-8.313-1.657H15.5l4.615-4.615zm-8.08 21.659v13.861h11.357v5.008H9.609V143h12.7c.834 0 1.55-.298 2.146-.894.596-.597.895-1.31.895-2.145v-7.781c0-.835-.299-1.55-.895-2.147a2.929 2.929 0 0 0-2.147-.894h-8.227v-5.096H25.35v-4.384z"></path>
    </symbol>
    <symbol viewBox="0 96 48 48" id="vjs-icon-replay-10">
      <path d="M42.315 125.63c0-4.997-1.694-9.235-5.08-12.713-3.388-3.479-7.571-5.218-12.552-5.218h-1.315l4.363 4.363-2.51 2.51-8.787-8.786L25.221 97l2.45 2.45-4.662 4.663h1.375c2.988 0 5.788.557 8.397 1.673 2.61 1.116 4.892 2.65 6.844 4.602 1.953 1.953 3.487 4.234 4.602 6.844 1.116 2.61 1.674 5.41 1.674 8.398zM8.183 142v-19.657H3.176V117.8h9.643V142zm13.63 0c-1.156 0-2.127-.393-2.912-1.178-.778-.778-1.168-1.746-1.168-2.902v-16.04c0-1.156.393-2.127 1.178-2.912.779-.779 1.746-1.168 2.902-1.168h7.696c1.156 0 2.126.392 2.911 1.177.779.78 1.168 1.747 1.168 2.903v16.04c0 1.156-.392 2.127-1.177 2.912-.779.779-1.746 1.168-2.902 1.168zm.556-4.636h6.583v-15.02H22.37z"></path>
    </symbol>
    <symbol viewBox="0 96 48 48" id="vjs-icon-replay-30">
      <path d="M26.047 97l-8.733 8.732 8.733 8.733 2.496-2.494-4.336-4.338h1.307c4.95 0 9.108 1.73 12.474 5.187 3.367 3.458 5.051 7.668 5.051 12.635h3.565c0-2.97-.556-5.751-1.665-8.346-1.109-2.594-2.633-4.862-4.574-6.802-1.94-1.941-4.208-3.466-6.803-4.575-2.594-1.109-5.375-1.664-8.345-1.664H23.85l4.634-4.634zM2.555 117.531v4.688h10.297v5.25H5.873v4.687h6.979v5.156H2.555V142H13.36c1.061 0 1.95-.395 2.668-1.186.718-.79 1.076-1.772 1.076-2.94v-16.218c0-1.168-.358-2.149-1.076-2.94-.717-.79-1.607-1.185-2.668-1.185zm22.482.14c-1.149 0-2.11.39-2.885 1.165-.78.78-1.172 1.744-1.172 2.893v15.943c0 1.149.388 2.11 1.163 2.885.78.78 1.745 1.172 2.894 1.172h7.649c1.148 0 2.11-.388 2.884-1.163.78-.78 1.17-1.745 1.17-2.894v-15.943c0-1.15-.386-2.111-1.16-2.885-.78-.78-1.746-1.172-2.894-1.172zm.553 4.518h6.545v14.93H25.59z"></path>
    </symbol>
    <symbol viewBox="0 96 48 48" id="vjs-icon-forward-5">
      <path d="M29.508 97l-2.431 2.43 4.625 4.625h-1.364c-2.965 0-5.742.554-8.332 1.66-2.589 1.107-4.851 2.629-6.788 4.566-1.937 1.937-3.458 4.2-4.565 6.788-1.107 2.59-1.66 5.367-1.66 8.331h3.557c0-4.957 1.68-9.16 5.04-12.611 3.36-3.45 7.51-5.177 12.451-5.177h1.304l-4.326 4.33 2.49 2.49 8.715-8.716zm-9.783 21.61v13.89h11.382v5.018H19.725V142h12.727a2.93 2.93 0 0 0 2.15-.896 2.93 2.93 0 0 0 .896-2.15v-7.798c0-.837-.299-1.554-.896-2.152a2.93 2.93 0 0 0-2.15-.896h-8.245V123h11.29v-4.392z"></path>
    </symbol>
    <symbol viewBox="0 96 48 48" id="vjs-icon-forward-10">
      <path d="M23.119 97l-2.386 2.383 4.538 4.538h-1.339c-2.908 0-5.633.543-8.173 1.63-2.54 1.085-4.76 2.577-6.66 4.478-1.9 1.9-3.392 4.12-4.478 6.66-1.085 2.54-1.629 5.264-1.629 8.172h3.49c0-4.863 1.648-8.986 4.944-12.372 3.297-3.385 7.368-5.078 12.216-5.078h1.279l-4.245 4.247 2.443 2.442 8.55-8.55zm-9.52 21.45v4.42h4.871V142h4.513v-23.55zm18.136 0c-1.125 0-2.066.377-2.824 1.135-.764.764-1.148 1.709-1.148 2.834v15.612c0 1.124.38 2.066 1.139 2.824.764.764 1.708 1.145 2.833 1.145h7.489c1.125 0 2.066-.378 2.824-1.136.764-.764 1.145-1.709 1.145-2.833v-15.612c0-1.125-.378-2.067-1.136-2.825-.764-.764-1.708-1.145-2.833-1.145zm.54 4.42h6.408v14.617h-6.407z"></path>
    </symbol>
    <symbol viewBox="0 96 48 48" id="vjs-icon-forward-30">
      <path d="M25.549 97l-2.437 2.434 4.634 4.635H26.38c-2.97 0-5.753.555-8.347 1.664-2.594 1.109-4.861 2.633-6.802 4.574-1.94 1.94-3.465 4.207-4.574 6.802-1.109 2.594-1.664 5.377-1.664 8.347h3.565c0-4.967 1.683-9.178 5.05-12.636 3.366-3.458 7.525-5.187 12.475-5.187h1.307l-4.335 4.338 2.495 2.494 8.732-8.732zm-11.553 20.53v4.689h10.297v5.249h-6.978v4.688h6.978v5.156H13.996V142h10.808c1.06 0 1.948-.395 2.666-1.186.718-.79 1.077-1.771 1.077-2.94v-16.217c0-1.169-.36-2.15-1.077-2.94-.718-.79-1.605-1.186-2.666-1.186zm21.174.168c-1.149 0-2.11.389-2.884 1.163-.78.78-1.172 1.745-1.172 2.894v15.942c0 1.15.388 2.11 1.162 2.885.78.78 1.745 1.17 2.894 1.17h7.649c1.149 0 2.11-.386 2.885-1.16.78-.78 1.17-1.746 1.17-2.895v-15.942c0-1.15-.387-2.11-1.161-2.885-.78-.78-1.745-1.172-2.894-1.172zm.552 4.516h6.542v14.931h-6.542z"></path>
    </symbol>
    <symbol viewBox="0 0 512 512" id="vjs-icon-audio-description">
      <g fill-rule="evenodd"><path d="M227.29 381.351V162.993c50.38-1.017 89.108-3.028 117.631 17.126 27.374 19.342 48.734 56.965 44.89 105.325-4.067 51.155-41.335 94.139-89.776 98.475-24.085 2.155-71.972 0-71.972 0s-.84-1.352-.773-2.568m48.755-54.804c31.43 1.26 53.208-16.633 56.495-45.386 4.403-38.51-21.188-63.552-58.041-60.796v103.612c-.036 1.466.575 2.22 1.546 2.57"></path><path d="M383.78 381.328c13.336 3.71 17.387-11.06 23.215-21.408 12.722-22.571 22.294-51.594 22.445-84.774.221-47.594-18.343-82.517-35.6-106.182h-8.51c-.587 3.874 2.226 7.315 3.865 10.276 13.166 23.762 25.367 56.553 25.54 94.194.2 43.176-14.162 79.278-30.955 107.894"></path><path d="M425.154 381.328c13.336 3.71 17.384-11.061 23.215-21.408 12.721-22.571 22.291-51.594 22.445-84.774.221-47.594-18.343-82.517-35.6-106.182h-8.511c-.586 3.874 2.226 7.315 3.866 10.276 13.166 23.762 25.367 56.553 25.54 94.194.2 43.176-14.162 79.278-30.955 107.894"></path><path d="M466.26 381.328c13.337 3.71 17.385-11.061 23.216-21.408 12.722-22.571 22.292-51.594 22.445-84.774.221-47.594-18.343-82.517-35.6-106.182h-8.51c-.587 3.874 2.225 7.315 3.865 10.276 13.166 23.762 25.367 56.553 25.54 94.194.2 43.176-14.162 79.278-30.955 107.894M4.477 383.005H72.58l18.573-28.484 64.169-.135s.065 19.413.065 28.62h48.756V160.307h-58.816c-5.653 9.537-140.85 222.697-140.85 222.697zm152.667-145.282v71.158l-40.453-.27 40.453-70.888z"></path></g>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-next-item">
      <path d="M12 36l17-12-17-12v24zm20-24v24h4V12h-4z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-previous-item">
      <path d="M12 12h4v24h-4zm7 12l17 12V12z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-shuffle">
      <path d="M21.17 18.34L10.83 8 8 10.83l10.34 10.34 2.83-2.83zM29 8l4.09 4.09L8 37.17 10.83 40l25.09-25.09L40 19V8H29zm.66 18.83l-2.83 2.83 6.26 6.26L29 40h11V29l-4.09 4.09-6.25-6.26z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-cast">
      <path d="M42 6H6c-2.21 0-4 1.79-4 4v6h4v-6h36v28H28v4h14c2.21 0 4-1.79 4-4V10c0-2.21-1.79-4-4-4zM2 36v6h6c0-3.31-2.69-6-6-6zm0-8v4c5.52 0 10 4.48 10 10h4c0-7.73-6.27-14-14-14zm0-8v4c9.94 0 18 8.06 18 18h4c0-12.15-9.85-22-22-22z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-picture-in-picture-enter">
      <path d="M38 22H22v11.99h16V22zm8 16V9.96C46 7.76 44.2 6 42 6H6C3.8 6 2 7.76 2 9.96V38c0 2.2 1.8 4 4 4h36c2.2 0 4-1.8 4-4zm-4 .04H6V9.94h36v28.1z"></path>
    </symbol>
    <symbol viewBox="0 0 22 18" id="vjs-icon-picture-in-picture-exit">
      <path d="M18 4H4v10h14V4zm4 12V1.98C22 .88 21.1 0 20 0H2C.9 0 0 .88 0 1.98V16c0 1.1.9 2 2 2h18c1.1 0 2-.9 2-2zm-2 .02H2V1.97h18v14.05z"></path>
      <path fill="none" d="M-1-3h24v24H-1z"></path>
    </symbol>
    <symbol viewBox="0 0 1792 1792" id="vjs-icon-facebook">
      <path d="M1343 12v264h-157q-86 0-116 36t-30 108v189h293l-39 296h-254v759H734V905H479V609h255V391q0-186 104-288.5T1115 0q147 0 228 12z"></path>
    </symbol>
    <symbol viewBox="0 0 1792 1792" id="vjs-icon-linkedin">
      <path d="M477 625v991H147V625h330zm21-306q1 73-50.5 122T312 490h-2q-82 0-132-49t-50-122q0-74 51.5-122.5T314 148t133 48.5T498 319zm1166 729v568h-329v-530q0-105-40.5-164.5T1168 862q-63 0-105.5 34.5T999 982q-11 30-11 81v553H659q2-399 2-647t-1-296l-1-48h329v144h-2q20-32 41-56t56.5-52 87-43.5T1285 602q171 0 275 113.5t104 332.5z"></path>
    </symbol>
    <symbol viewBox="0 0 1200 1227" id="vjs-icon-twitter">
      <path d="M714.163 519.284L1160.89 0H1055.03L667.137 450.887L357.328 0H0L468.492 681.821L0 1226.37H105.866L515.491 750.218L842.672 1226.37H1200L714.137 519.284H714.163ZM569.165 687.828L521.697 619.934L144.011 79.6944H306.615L611.412 515.685L658.88 583.579L1055.08 1150.3H892.476L569.165 687.854V687.828Z"/>
    </symbol>
    <symbol viewBox="0 0 1792 1792" id="vjs-icon-tumblr">
      <path d="M1328 1329l80 237q-23 35-111 66t-177 32q-104 2-190.5-26T787 1564t-95-106-55.5-120-16.5-118V676H452V461q72-26 129-69.5t91-90 58-102 34-99T779 12q1-5 4.5-8.5T791 0h244v424h333v252h-334v518q0 30 6.5 56t22.5 52.5 49.5 41.5 81.5 14q78-2 134-29z"></path>
    </symbol>
    <symbol viewBox="0 0 1792 1792" id="vjs-icon-pinterest">
      <path d="M1664 896q0 209-103 385.5T1281.5 1561 896 1664q-111 0-218-32 59-93 78-164 9-34 54-211 20 39 73 67.5t114 28.5q121 0 216-68.5t147-188.5 52-270q0-114-59.5-214T1180 449t-255-63q-105 0-196 29t-154.5 77-109 110.5-67 129.5T377 866q0 104 40 183t117 111q30 12 38-20 2-7 8-31t8-30q6-23-11-43-51-61-51-151 0-151 104.5-259.5T904 517q151 0 235.5 82t84.5 213q0 170-68.5 289T980 1220q-61 0-98-43.5T859 1072q8-35 26.5-93.5t30-103T927 800q0-50-27-83t-77-33q-62 0-105 57t-43 142q0 73 25 122l-99 418q-17 70-13 177-206-91-333-281T128 896q0-209 103-385.5T510.5 231 896 128t385.5 103T1561 510.5 1664 896z"></path>
    </symbol>
  </defs>
</svg>`;const Uy=Uc?10009:qc?461:8,Hn={codes:{play:415,pause:19,ff:417,rw:412,back:Uy},names:{415:"play",19:"pause",417:"ff",412:"rw",[Uy]:"back"},isEventKey(r,e){return e=e.toLowerCase(),!!(this.names[r.keyCode]&&this.names[r.keyCode]===e)},getEventName(r){if(this.names[r.keyCode])return this.names[r.keyCode];if(this.codes[r.code]){const e=this.codes[r.code];return this.names[e]}return null}},qy=5;class WL extends qi{constructor(e){super(),this.player_=e,this.focusableComponents=[],this.isListening_=!1,this.isPaused_=!1,this.onKeyDown_=this.onKeyDown_.bind(this),this.lastFocusedComponent_=null}start(){this.isListening_||(this.player_.on("keydown",this.onKeyDown_),this.player_.on("modalKeydown",this.onKeyDown_),this.player_.on("loadedmetadata",()=>{this.focus(this.updateFocusableComponents()[0])}),this.player_.on("modalclose",()=>{this.refocusComponent()}),this.player_.on("focusin",this.handlePlayerFocus_.bind(this)),this.player_.on("focusout",this.handlePlayerBlur_.bind(this)),this.isListening_=!0,this.player_.errorDisplay&&this.player_.errorDisplay.on("aftermodalfill",()=>{this.updateFocusableComponents(),this.focusableComponents.length&&(this.focusableComponents.length>1?this.focusableComponents[1].focus():this.focusableComponents[0].focus())}))}stop(){this.player_.off("keydown",this.onKeyDown_),this.isListening_=!1}onKeyDown_(e){const t=e.originalEvent?e.originalEvent:e;if(["ArrowLeft","ArrowRight","ArrowUp","ArrowDown"].includes(t.key)){if(this.isPaused_)return;t.preventDefault();const i=t.key.substring(5).toLowerCase();this.move(i)}else if(Hn.isEventKey(t,"play")||Hn.isEventKey(t,"pause")||Hn.isEventKey(t,"ff")||Hn.isEventKey(t,"rw")){t.preventDefault();const i=Hn.getEventName(t);this.performMediaAction_(i)}else Hn.isEventKey(t,"Back")&&e.target&&typeof e.target.closeable=="function"&&e.target.closeable()&&(t.preventDefault(),e.target.close())}performMediaAction_(e){if(this.player_)switch(e){case"play":this.player_.paused()&&this.player_.play();break;case"pause":this.player_.paused()||this.player_.pause();break;case"ff":this.userSeek_(this.player_.currentTime()+qy);break;case"rw":this.userSeek_(this.player_.currentTime()-qy);break}}userSeek_(e){this.player_.liveTracker&&this.player_.liveTracker.isLive()&&this.player_.liveTracker.nextSeekedFromUser(),this.player_.currentTime(e)}pause(){this.isPaused_=!0}resume(){this.isPaused_=!1}handlePlayerBlur_(e){const t=e.relatedTarget;let i=null;const s=this.getCurrentComponent(e.target);t&&(i=!!t.closest(".video-js"),t.classList.contains("vjs-text-track-settings")&&!this.isPaused_&&this.searchForTrackSelect_()),(!e.currentTarget.contains(e.relatedTarget)&&!i||!t)&&(s&&s.name()==="CloseButton"?this.refocusComponent():(this.pause(),s&&s.el()&&(this.lastFocusedComponent_=s)))}handlePlayerFocus_(){this.getCurrentComponent()&&this.getCurrentComponent().getIsFocusable()&&this.resume()}updateFocusableComponents(){const e=this.player_,t=[];function i(s){for(const n of s)n.hasOwnProperty("el_")&&n.getIsFocusable()&&n.getIsAvailableToBeFocused(n.el())&&t.push(n),n.hasOwnProperty("children_")&&n.children_.length>0&&i(n.children_)}return e.children_.forEach(s=>{if(s.hasOwnProperty("el_"))if(s.getIsFocusable&&s.getIsAvailableToBeFocused&&s.getIsFocusable()&&s.getIsAvailableToBeFocused(s.el())){t.push(s);return}else s.hasOwnProperty("children_")&&s.children_.length>0?i(s.children_):s.hasOwnProperty("items")&&s.items.length>0?i(s.items):this.findSuitableDOMChild(s)&&t.push(s);if(s.name_==="ErrorDisplay"&&s.opened_){const n=s.el_.querySelector(".vjs-errors-ok-button-container");n&&n.querySelectorAll("button").forEach((o,l)=>{t.push({name:()=>"ModalButton"+(l+1),el:()=>o,getPositions:()=>{const u=o.getBoundingClientRect(),c={x:u.x,y:u.y,width:u.width,height:u.height,top:u.top,right:u.right,bottom:u.bottom,left:u.left},h={x:u.left+u.width/2,y:u.top+u.height/2,width:0,height:0,top:u.top+u.height/2,right:u.left+u.width/2,bottom:u.top+u.height/2,left:u.left+u.width/2};return{boundingClientRect:c,center:h}},getIsAvailableToBeFocused:()=>!0,getIsFocusable:u=>!0,focus:()=>o.focus()})})}}),this.focusableComponents=t,this.focusableComponents}findSuitableDOMChild(e){function t(i){if(e.getIsFocusable(i)&&e.getIsAvailableToBeFocused(i))return i;for(let s=0;s<i.children.length;s++){const n=i.children[s],a=t(n);if(a)return a}return null}return e.el()?t(e.el()):null}getCurrentComponent(e){this.updateFocusableComponents();const t=e||document.activeElement;if(this.focusableComponents.length){for(const i of this.focusableComponents)if(i.el()===t)return i}}add(e){const t=[...this.focusableComponents];e.hasOwnProperty("el_")&&e.getIsFocusable()&&e.getIsAvailableToBeFocused(e.el())&&t.push(e),this.focusableComponents=t,this.trigger({type:"focusableComponentsChanged",focusableComponents:this.focusableComponents})}remove(e){for(let t=0;t<this.focusableComponents.length;t++)if(this.focusableComponents[t].name()===e.name()){this.focusableComponents.splice(t,1),this.trigger({type:"focusableComponentsChanged",focusableComponents:this.focusableComponents});return}}clear(){this.focusableComponents.length>0&&(this.focusableComponents=[],this.trigger({type:"focusableComponentsChanged",focusableComponents:this.focusableComponents}))}move(e){const t=this.getCurrentComponent();if(!t)return;const i=t.getPositions(),s=this.focusableComponents.filter(a=>a!==t&&this.isInDirection_(i.boundingClientRect,a.getPositions().boundingClientRect,e)),n=this.findBestCandidate_(i.center,s,e);n?this.focus(n):this.trigger({type:"endOfFocusableComponents",direction:e,focusedComponent:t})}findBestCandidate_(e,t,i){let s=1/0,n=null;for(const a of t){const o=a.getPositions().center,l=this.calculateDistance_(e,o,i);l<s&&(s=l,n=a)}return n}isInDirection_(e,t,i){switch(i){case"right":return t.left>=e.right;case"left":return t.right<=e.left;case"down":return t.top>=e.bottom;case"up":return t.bottom<=e.top;default:return!1}}refocusComponent(){if(this.lastFocusedComponent_){this.player_.userActive()||this.player_.userActive(!0),this.updateFocusableComponents();for(let e=0;e<this.focusableComponents.length;e++)if(this.focusableComponents[e].name()===this.lastFocusedComponent_.name()){this.focus(this.focusableComponents[e]);return}}else this.focus(this.updateFocusableComponents()[0])}focus(e){typeof e=="object"&&(e.getIsAvailableToBeFocused(e.el())?e.focus():this.findSuitableDOMChild(e)&&this.findSuitableDOMChild(e).focus())}calculateDistance_(e,t,i){const s=Math.abs(e.x-t.x),n=Math.abs(e.y-t.y);let a;switch(i){case"right":case"left":a=s+n*100;break;case"up":a=n*2+s*.5;break;case"down":a=n*5+s;break;default:a=s+n}return a}searchForTrackSelect_(){const e=this;for(const t of e.updateFocusableComponents())if(t.constructor.name==="TextTrackSelect"){e.focus(t);break}}}class HL extends ee{constructor(e,t,i){const s=Je({createEl:!1},t);if(super(e,s,i),!t.playerOptions.sources||t.playerOptions.sources.length===0)for(let n=0,a=t.playerOptions.techOrder;n<a.length;n++){const o=Tt(a[n]);let l=Le.getTech(o);if(o||(l=ee.getComponent(o)),l&&l.isSupported()){e.loadTech_(o);break}}else e.src(t.playerOptions.sources)}}ee.registerComponent("MediaLoader",HL);class td extends ee{constructor(e,t){super(e,t),this.options_.controlText&&this.controlText(this.options_.controlText),this.handleMouseOver_=i=>this.handleMouseOver(i),this.handleMouseOut_=i=>this.handleMouseOut(i),this.handleClick_=i=>this.handleClick(i),this.handleKeyDown_=i=>this.handleKeyDown(i),this.emitTapEvents(),this.enable()}createEl(e="div",t={},i={}){t=Object.assign({className:this.buildCSSClass(),tabIndex:0},t),e==="button"&&Be.error(`Creating a ClickableComponent with an HTML element of ${e} is not supported; use a Button instead.`),i=Object.assign({role:"button"},i),this.tabIndex_=t.tabIndex;const s=Me(e,t,i);return this.player_.options_.experimentalSvgIcons||s.appendChild(Me("span",{className:"vjs-icon-placeholder"},{"aria-hidden":!0})),this.createControlTextEl(s),s}dispose(){this.controlTextEl_=null,super.dispose()}createControlTextEl(e){return this.controlTextEl_=Me("span",{className:"vjs-control-text"},{"aria-live":"polite"}),e&&e.appendChild(this.controlTextEl_),this.controlText(this.controlText_,e),this.controlTextEl_}controlText(e,t=this.el()){if(e===void 0)return this.controlText_||"Need Text";const i=this.localize(e);this.controlText_=e,Js(this.controlTextEl_,i),!this.nonIconControl&&!this.player_.options_.noUITitleAttributes&&t.setAttribute("title",i)}buildCSSClass(){return`vjs-control vjs-button ${super.buildCSSClass()}`}enable(){this.enabled_||(this.enabled_=!0,this.removeClass("vjs-disabled"),this.el_.setAttribute("aria-disabled","false"),typeof this.tabIndex_<"u"&&this.el_.setAttribute("tabIndex",this.tabIndex_),this.on(["tap","click"],this.handleClick_),this.on("keydown",this.handleKeyDown_))}disable(){this.enabled_=!1,this.addClass("vjs-disabled"),this.el_.setAttribute("aria-disabled","true"),typeof this.tabIndex_<"u"&&this.el_.removeAttribute("tabIndex"),this.off("mouseover",this.handleMouseOver_),this.off("mouseout",this.handleMouseOut_),this.off(["tap","click"],this.handleClick_),this.off("keydown",this.handleKeyDown_)}handleLanguagechange(){this.controlText(this.controlText_)}handleClick(e){this.options_.clickHandler&&this.options_.clickHandler.call(this,arguments)}handleKeyDown(e){e.key===" "||e.key==="Enter"?(e.preventDefault(),e.stopPropagation(),this.trigger("click")):super.handleKeyDown(e)}}ee.registerComponent("ClickableComponent",td);class wp extends td{constructor(e,t){super(e,t),this.update(),this.update_=i=>this.update(i),e.on("posterchange",this.update_)}dispose(){this.player().off("posterchange",this.update_),super.dispose()}createEl(){return Me("div",{className:"vjs-poster"})}crossOrigin(e){if(typeof e>"u")return this.$("img")?this.$("img").crossOrigin:this.player_.tech_&&this.player_.tech_.isReady_?this.player_.crossOrigin():this.player_.options_.crossOrigin||this.player_.options_.crossorigin||null;if(e!==null&&e!=="anonymous"&&e!=="use-credentials"){this.player_.log.warn(`crossOrigin must be null,  "anonymous" or "use-credentials", given "${e}"`);return}this.$("img")&&(this.$("img").crossOrigin=e)}update(e){const t=this.player().poster();this.setSrc(t),t?this.show():this.hide()}setSrc(e){if(!e){this.el_.textContent="";return}this.$("img")||this.el_.appendChild(Me("picture",{className:"vjs-poster",tabIndex:-1},{},Me("img",{loading:"lazy",crossOrigin:this.crossOrigin()},{alt:""}))),this.$("img").src=e}handleClick(e){this.player_.controls()&&(this.player_.tech(!0)&&this.player_.tech(!0).focus(),this.player_.paused()?Br(this.player_.play()):this.player_.pause())}}wp.prototype.crossorigin=wp.prototype.crossOrigin;ee.registerComponent("PosterImage",wp);const Zi="#222",Vy="#ccc",YL={monospace:"monospace",sansSerif:"sans-serif",serif:"serif",monospaceSansSerif:'"Andale Mono", "Lucida Console", monospace',monospaceSerif:'"Courier New", monospace',proportionalSansSerif:"sans-serif",proportionalSerif:"serif",casual:'"Comic Sans MS", Impact, fantasy',script:'"Monotype Corsiva", cursive',smallcaps:'"Andale Mono", "Lucida Console", monospace, sans-serif'};function of(r,e){let t;if(r.length===4)t=r[1]+r[1]+r[2]+r[2]+r[3]+r[3];else if(r.length===7)t=r.slice(1);else throw new Error("Invalid color code provided, "+r+"; must be formatted as e.g. #f0e or #f604e2.");return"rgba("+parseInt(t.slice(0,2),16)+","+parseInt(t.slice(2,4),16)+","+parseInt(t.slice(4,6),16)+","+e+")"}function Er(r,e,t){try{r.style[e]=t}catch{return}}function Xy(r){return r?`${r}px`:""}class GL extends ee{constructor(e,t,i){super(e,t,i);const s=a=>this.updateDisplay(a),n=a=>{this.updateDisplayOverlay(),this.updateDisplay(a)};e.on("loadstart",a=>this.toggleDisplay(a)),e.on("useractive",s),e.on("userinactive",s),e.on("texttrackchange",s),e.on("loadedmetadata",a=>{this.updateDisplayOverlay(),this.preselectTrack(a)}),e.ready(ut(this,function(){if(e.tech_&&e.tech_.featuresNativeTextTracks){this.hide();return}e.on("fullscreenchange",n),e.on("playerresize",n);const a=U.screen.orientation||U,o=U.screen.orientation?"change":"orientationchange";a.addEventListener(o,n),e.on("dispose",()=>a.removeEventListener(o,n));const l=this.options_.playerOptions.tracks||[];for(let u=0;u<l.length;u++)this.player_.addRemoteTextTrack(l[u],!0);this.preselectTrack()}))}preselectTrack(){const e={captions:1,subtitles:1},t=this.player_.textTracks(),i=this.player_.cache_.selectedLanguage;let s,n,a;for(let o=0;o<t.length;o++){const l=t[o];i&&i.enabled&&i.language&&i.language===l.language&&l.kind in e?l.kind===i.kind?a=l:a||(a=l):i&&!i.enabled?(a=null,s=null,n=null):l.default&&(l.kind==="descriptions"&&!s?s=l:l.kind in e&&!n&&(n=l))}a?a.mode="showing":n?n.mode="showing":s&&(s.mode="showing")}toggleDisplay(){this.player_.tech_&&this.player_.tech_.featuresNativeTextTracks?this.hide():this.show()}createEl(){return super.createEl("div",{className:"vjs-text-track-display"},{translate:"yes","aria-live":"off","aria-atomic":"true"})}clearDisplay(){typeof U.WebVTT=="function"&&U.WebVTT.processCues(U,[],this.el_)}updateDisplay(){const e=this.player_.textTracks(),t=this.options_.allowMultipleShowingTracks;if(this.clearDisplay(),t){const a=[];for(let o=0;o<e.length;++o){const l=e[o];l.mode==="showing"&&a.push(l)}this.updateForTrack(a);return}let i=null,s=null,n=e.length;for(;n--;){const a=e[n];a.mode==="showing"&&(a.kind==="descriptions"?i=a:s=a)}if(s?(this.getAttribute("aria-live")!=="off"&&this.setAttribute("aria-live","off"),this.updateForTrack(s)):i&&(this.getAttribute("aria-live")!=="assertive"&&this.setAttribute("aria-live","assertive"),this.updateForTrack(i)),!U.CSS.supports("inset","10px")){const a=this.el_,o=a.querySelectorAll(".vjs-text-track-cue"),l=this.player_.controlBar.el_.getBoundingClientRect().height,u=this.player_.el_.getBoundingClientRect().height;a.style="",Er(a,"position","relative"),Er(a,"height",u-l+"px"),Er(a,"top","unset"),Vc?Er(a,"bottom",u+"px"):Er(a,"bottom","0px"),o.length>0&&o.forEach(c=>{if(c.style.inset){const h=c.style.inset.split(" ");h.length===3&&Object.assign(c.style,{top:h[0],right:h[1],bottom:h[2],left:"unset"})}})}}updateDisplayOverlay(){if(!this.player_.videoHeight()||!U.CSS.supports("inset-inline: 10px"))return;const e=this.player_.currentWidth(),t=this.player_.currentHeight(),i=e/t,s=this.player_.videoWidth()/this.player_.videoHeight();let n=0,a=0;Math.abs(i-s)>.1&&(i>s?n=Math.round((e-t*s)/2):a=Math.round((t-e/s)/2)),Er(this.el_,"insetInline",Xy(n)),Er(this.el_,"insetBlock",Xy(a))}updateDisplayState(e){const t=this.player_.textTrackSettings.getValues(),i=e.activeCues;let s=i.length;for(;s--;){const n=i[s];if(!n)continue;const a=n.displayState;if(t.color&&(a.firstChild.style.color=t.color),t.textOpacity&&Er(a.firstChild,"color",of(t.color||"#fff",t.textOpacity)),t.backgroundColor&&(a.firstChild.style.backgroundColor=t.backgroundColor),t.backgroundOpacity&&Er(a.firstChild,"backgroundColor",of(t.backgroundColor||"#000",t.backgroundOpacity)),t.windowColor&&(t.windowOpacity?Er(a,"backgroundColor",of(t.windowColor,t.windowOpacity)):a.style.backgroundColor=t.windowColor),t.edgeStyle&&(t.edgeStyle==="dropshadow"?a.firstChild.style.textShadow=`2px 2px 3px ${Zi}, 2px 2px 4px ${Zi}, 2px 2px 5px ${Zi}`:t.edgeStyle==="raised"?a.firstChild.style.textShadow=`1px 1px ${Zi}, 2px 2px ${Zi}, 3px 3px ${Zi}`:t.edgeStyle==="depressed"?a.firstChild.style.textShadow=`1px 1px ${Vy}, 0 1px ${Vy}, -1px -1px ${Zi}, 0 -1px ${Zi}`:t.edgeStyle==="uniform"&&(a.firstChild.style.textShadow=`0 0 4px ${Zi}, 0 0 4px ${Zi}, 0 0 4px ${Zi}, 0 0 4px ${Zi}`)),t.fontPercent&&t.fontPercent!==1){const o=U.parseFloat(a.style.fontSize);a.style.fontSize=o*t.fontPercent+"px",a.style.height="auto",a.style.top="auto"}t.fontFamily&&t.fontFamily!=="default"&&(t.fontFamily==="small-caps"?a.firstChild.style.fontVariant="small-caps":a.firstChild.style.fontFamily=YL[t.fontFamily])}}updateForTrack(e){if(Array.isArray(e)||(e=[e]),typeof U.WebVTT!="function"||e.every(i=>!i.activeCues))return;const t=[];for(let i=0;i<e.length;++i){const s=e[i];for(let n=0;n<s.activeCues.length;++n)t.push(s.activeCues[n])}U.WebVTT.processCues(U,t,this.el_);for(let i=0;i<e.length;++i){const s=e[i];for(let n=0;n<s.activeCues.length;++n){const a=s.activeCues[n].displayState;kn(a,"vjs-text-track-cue","vjs-text-track-cue-"+(s.language?s.language:i)),s.language&&Ma(a,"lang",s.language)}this.player_.textTrackSettings&&this.updateDisplayState(s)}}}ee.registerComponent("TextTrackDisplay",GL);class KL extends ee{createEl(){const e=this.player_.isAudio(),t=this.localize(e?"Audio Player":"Video Player"),i=Me("span",{className:"vjs-control-text",textContent:this.localize("{1} is loading.",[t])}),s=super.createEl("div",{className:"vjs-loading-spinner",dir:"ltr"});return s.appendChild(i),s}handleLanguagechange(){this.$(".vjs-control-text").textContent=this.localize("{1} is loading.",[this.player_.isAudio()?"Audio Player":"Video Player"])}}ee.registerComponent("LoadingSpinner",KL);class ai extends td{createEl(e,t={},i={}){e="button",t=Object.assign({className:this.buildCSSClass()},t),i=Object.assign({type:"button"},i);const s=Me(e,t,i);return this.player_.options_.experimentalSvgIcons||s.appendChild(Me("span",{className:"vjs-icon-placeholder"},{"aria-hidden":!0})),this.createControlTextEl(s),s}addChild(e,t={}){const i=this.constructor.name;return Be.warn(`Adding an actionable (user controllable) child to a Button (${i}) is not supported; use a ClickableComponent instead.`),ee.prototype.addChild.call(this,e,t)}enable(){super.enable(),this.el_.removeAttribute("disabled")}disable(){super.disable(),this.el_.setAttribute("disabled","disabled")}handleKeyDown(e){if(e.key===" "||e.key==="Enter"){e.stopPropagation();return}super.handleKeyDown(e)}}ee.registerComponent("Button",ai);class e_ extends ai{constructor(e,t){super(e,t),this.mouseused_=!1,this.setIcon("play"),this.on("mousedown",i=>this.handleMouseDown(i))}buildCSSClass(){return"vjs-big-play-button"}handleClick(e){const t=this.player_.play();if(e.type==="tap"||this.mouseused_&&"clientX"in e&&"clientY"in e){Br(t),this.player_.tech(!0)&&this.player_.tech(!0).focus();return}const i=this.player_.getChild("controlBar"),s=i&&i.getChild("playToggle");if(!s){this.player_.tech(!0).focus();return}const n=()=>s.focus();Go(t)?t.then(n,()=>{}):this.setTimeout(n,1)}handleKeyDown(e){this.mouseused_=!1,super.handleKeyDown(e)}handleMouseDown(e){this.mouseused_=!0}}e_.prototype.controlText_="Play Video";ee.registerComponent("BigPlayButton",e_);class JL extends ai{constructor(e,t){super(e,t),this.setIcon("cancel"),this.controlText(t&&t.controlText||this.localize("Close"))}buildCSSClass(){return`vjs-close-button ${super.buildCSSClass()}`}handleClick(e){this.trigger({type:"close",bubbles:!1})}handleKeyDown(e){e.key==="Escape"?(e.preventDefault(),e.stopPropagation(),this.trigger("click")):super.handleKeyDown(e)}}ee.registerComponent("CloseButton",JL);class t_ extends ai{constructor(e,t={}){super(e,t),t.replay=t.replay===void 0||t.replay,this.setIcon("play"),this.on(e,"play",i=>this.handlePlay(i)),this.on(e,"pause",i=>this.handlePause(i)),t.replay&&this.on(e,"ended",i=>this.handleEnded(i))}buildCSSClass(){return`vjs-play-control ${super.buildCSSClass()}`}handleClick(e){this.player_.paused()?Br(this.player_.play()):this.player_.pause()}handleSeeked(e){this.removeClass("vjs-ended"),this.player_.paused()?this.handlePause(e):this.handlePlay(e)}handlePlay(e){this.removeClass("vjs-ended","vjs-paused"),this.addClass("vjs-playing"),this.setIcon("pause"),this.controlText("Pause")}handlePause(e){this.removeClass("vjs-playing"),this.addClass("vjs-paused"),this.setIcon("play"),this.controlText("Play")}handleEnded(e){this.removeClass("vjs-playing"),this.addClass("vjs-ended"),this.setIcon("replay"),this.controlText("Replay"),this.one(this.player_,"seeked",t=>this.handleSeeked(t))}}t_.prototype.controlText_="Play";ee.registerComponent("PlayToggle",t_);class Ja extends ee{constructor(e,t){super(e,t),this.on(e,["timeupdate","ended","seeking"],i=>this.update(i)),this.updateTextNode_()}createEl(){const e=this.buildCSSClass(),t=super.createEl("div",{className:`${e} vjs-time-control vjs-control`}),i=Me("span",{className:"vjs-control-text",textContent:`${this.localize(this.labelText_)} `},{role:"presentation"});return t.appendChild(i),this.contentEl_=Me("span",{className:`${e}-display`},{role:"presentation"}),t.appendChild(this.contentEl_),t}dispose(){this.contentEl_=null,this.textNode_=null,super.dispose()}update(e){!this.player_.options_.enableSmoothSeeking&&e.type==="seeking"||this.updateContent(e)}updateTextNode_(e=0){e=Mn(e),this.formattedTime_!==e&&(this.formattedTime_=e,this.requestNamedAnimationFrame("TimeDisplay#updateTextNode_",()=>{if(!this.contentEl_)return;let t=this.textNode_;t&&this.contentEl_.firstChild!==t&&(t=null,Be.warn("TimeDisplay#updateTextnode_: Prevented replacement of text node element since it was no longer a child of this node. Appending a new node instead.")),this.textNode_=ue.createTextNode(this.formattedTime_),this.textNode_&&(t?this.contentEl_.replaceChild(this.textNode_,t):this.contentEl_.appendChild(this.textNode_))}))}updateContent(e){}}Ja.prototype.labelText_="Time";Ja.prototype.controlText_="Time";ee.registerComponent("TimeDisplay",Ja);class kg extends Ja{buildCSSClass(){return"vjs-current-time"}updateContent(e){let t;this.player_.ended()?t=this.player_.duration():e&&e.target&&typeof e.target.pendingSeekTime=="function"?t=e.target.pendingSeekTime():t=this.player_.scrubbing()?this.player_.getCache().currentTime:this.player_.currentTime(),this.updateTextNode_(t)}}kg.prototype.labelText_="Current Time";kg.prototype.controlText_="Current Time";ee.registerComponent("CurrentTimeDisplay",kg);class Eg extends Ja{constructor(e,t){super(e,t);const i=s=>this.updateContent(s);this.on(e,"durationchange",i),this.on(e,"loadstart",i),this.on(e,"loadedmetadata",i)}buildCSSClass(){return"vjs-duration"}updateContent(e){const t=this.player_.duration();this.updateTextNode_(t)}}Eg.prototype.labelText_="Duration";Eg.prototype.controlText_="Duration";ee.registerComponent("DurationDisplay",Eg);class eQ extends ee{createEl(){const e=super.createEl("div",{className:"vjs-time-control vjs-time-divider"},{"aria-hidden":!0}),t=super.createEl("div"),i=super.createEl("span",{textContent:"/"});return t.appendChild(i),e.appendChild(t),e}}ee.registerComponent("TimeDivider",eQ);class Ag extends Ja{constructor(e,t){super(e,t),this.on(e,"durationchange",i=>this.updateContent(i))}buildCSSClass(){return"vjs-remaining-time"}createEl(){const e=super.createEl();return this.options_.displayNegative!==!1&&e.insertBefore(Me("span",{},{"aria-hidden":!0},"-"),this.contentEl_),e}updateContent(e){if(typeof this.player_.duration()!="number")return;let t;this.player_.ended()?t=0:this.player_.remainingTimeDisplay?t=this.player_.remainingTimeDisplay():t=this.player_.remainingTime(),this.updateTextNode_(t)}}Ag.prototype.labelText_="Remaining Time";Ag.prototype.controlText_="Remaining Time";ee.registerComponent("RemainingTimeDisplay",Ag);class tQ extends ee{constructor(e,t){super(e,t),this.updateShowing(),this.on(this.player(),"durationchange",i=>this.updateShowing(i))}createEl(){const e=super.createEl("div",{className:"vjs-live-control vjs-control"});return this.contentEl_=Me("div",{className:"vjs-live-display"},{"aria-live":"off"}),this.contentEl_.appendChild(Me("span",{className:"vjs-control-text",textContent:`${this.localize("Stream Type")} `})),this.contentEl_.appendChild(ue.createTextNode(this.localize("LIVE"))),e.appendChild(this.contentEl_),e}dispose(){this.contentEl_=null,super.dispose()}updateShowing(e){this.player().duration()===1/0?this.show():this.hide()}}ee.registerComponent("LiveDisplay",tQ);class i_ extends ai{constructor(e,t){super(e,t),this.updateLiveEdgeStatus(),this.player_.liveTracker&&(this.updateLiveEdgeStatusHandler_=i=>this.updateLiveEdgeStatus(i),this.on(this.player_.liveTracker,"liveedgechange",this.updateLiveEdgeStatusHandler_))}createEl(){const e=super.createEl("button",{className:"vjs-seek-to-live-control vjs-control"});return this.setIcon("circle",e),this.textEl_=Me("span",{className:"vjs-seek-to-live-text",textContent:this.localize("LIVE")},{"aria-hidden":"true"}),e.appendChild(this.textEl_),e}updateLiveEdgeStatus(){!this.player_.liveTracker||this.player_.liveTracker.atLiveEdge()?(this.setAttribute("aria-disabled",!0),this.addClass("vjs-at-live-edge"),this.controlText("Seek to live, currently playing live")):(this.setAttribute("aria-disabled",!1),this.removeClass("vjs-at-live-edge"),this.controlText("Seek to live, currently behind live"))}handleClick(){this.player_.liveTracker.seekToLiveEdge()}dispose(){this.player_.liveTracker&&this.off(this.player_.liveTracker,"liveedgechange",this.updateLiveEdgeStatusHandler_),this.textEl_=null,super.dispose()}}i_.prototype.controlText_="Seek to live, currently playing live";ee.registerComponent("SeekToLive",i_);function Wl(r,e,t){return r=Number(r),Math.min(t,Math.max(e,isNaN(r)?e:r))}var iQ=Object.freeze({__proto__:null,clamp:Wl});class Pg extends ee{constructor(e,t){super(e,t),this.handleMouseDown_=i=>this.handleMouseDown(i),this.handleMouseUp_=i=>this.handleMouseUp(i),this.handleKeyDown_=i=>this.handleKeyDown(i),this.handleClick_=i=>this.handleClick(i),this.handleMouseMove_=i=>this.handleMouseMove(i),this.update_=i=>this.update(i),this.bar=this.getChild(this.options_.barName),this.vertical(!!this.options_.vertical),this.enable()}enabled(){return this.enabled_}enable(){this.enabled()||(this.on("mousedown",this.handleMouseDown_),this.on("touchstart",this.handleMouseDown_),this.on("keydown",this.handleKeyDown_),this.on("click",this.handleClick_),this.on(this.player_,"controlsvisible",this.update),this.playerEvent&&this.on(this.player_,this.playerEvent,this.update),this.removeClass("disabled"),this.setAttribute("tabindex",0),this.enabled_=!0)}disable(){if(!this.enabled())return;const e=this.bar.el_.ownerDocument;this.off("mousedown",this.handleMouseDown_),this.off("touchstart",this.handleMouseDown_),this.off("keydown",this.handleKeyDown_),this.off("click",this.handleClick_),this.off(this.player_,"controlsvisible",this.update_),this.off(e,"mousemove",this.handleMouseMove_),this.off(e,"mouseup",this.handleMouseUp_),this.off(e,"touchmove",this.handleMouseMove_),this.off(e,"touchend",this.handleMouseUp_),this.removeAttribute("tabindex"),this.addClass("disabled"),this.playerEvent&&this.off(this.player_,this.playerEvent,this.update),this.enabled_=!1}createEl(e,t={},i={}){return t.className=t.className+" vjs-slider",t=Object.assign({tabIndex:0},t),i=Object.assign({role:"slider","aria-valuenow":0,"aria-valuemin":0,"aria-valuemax":100},i),super.createEl(e,t,i)}handleMouseDown(e){const t=this.bar.el_.ownerDocument;e.type==="mousedown"&&e.preventDefault(),e.type==="touchstart"&&!Wr&&e.preventDefault(),ET(),this.addClass("vjs-sliding"),this.trigger("slideractive"),this.on(t,"mousemove",this.handleMouseMove_),this.on(t,"mouseup",this.handleMouseUp_),this.on(t,"touchmove",this.handleMouseMove_),this.on(t,"touchend",this.handleMouseUp_),this.handleMouseMove(e,!0)}handleMouseMove(e){}handleMouseUp(e){const t=this.bar.el_.ownerDocument;AT(),this.removeClass("vjs-sliding"),this.trigger("sliderinactive"),this.off(t,"mousemove",this.handleMouseMove_),this.off(t,"mouseup",this.handleMouseUp_),this.off(t,"touchmove",this.handleMouseMove_),this.off(t,"touchend",this.handleMouseUp_),this.update()}update(){if(!this.el_||!this.bar)return;const e=this.getProgress();return e===this.progress_||(this.progress_=e,this.requestNamedAnimationFrame("Slider#update",()=>{const t=this.vertical()?"height":"width";this.bar.el().style[t]=(e*100).toFixed(2)+"%"})),e}getProgress(){return Number(Wl(this.getPercent(),0,1).toFixed(4))}calculateDistance(e){const t=Hh(this.el_,e);return this.vertical()?t.y:t.x}handleKeyDown(e){const t=this.options_.playerOptions.spatialNavigation,i=t&&t.enabled,s=t&&t.horizontalSeek;i?s&&e.key==="ArrowLeft"||!s&&e.key==="ArrowDown"?(e.preventDefault(),e.stopPropagation(),this.stepBack()):s&&e.key==="ArrowRight"||!s&&e.key==="ArrowUp"?(e.preventDefault(),e.stopPropagation(),this.stepForward()):(this.pendingSeekTime()&&(this.pendingSeekTime(null),this.userSeek_(this.player_.currentTime())),super.handleKeyDown(e)):e.key==="ArrowLeft"||e.key==="ArrowDown"?(e.preventDefault(),e.stopPropagation(),this.stepBack()):e.key==="ArrowUp"||e.key==="ArrowRight"?(e.preventDefault(),e.stopPropagation(),this.stepForward()):super.handleKeyDown(e)}handleClick(e){e.stopPropagation(),e.preventDefault()}vertical(e){if(e===void 0)return this.vertical_||!1;this.vertical_=!!e,this.vertical_?this.addClass("vjs-slider-vertical"):this.addClass("vjs-slider-horizontal")}}ee.registerComponent("Slider",Pg);const lf=(r,e)=>Wl(r/e*100,0,100).toFixed(2)+"%";class rQ extends ee{constructor(e,t){super(e,t),this.partEls_=[],this.on(e,"progress",i=>this.update(i))}createEl(){const e=super.createEl("div",{className:"vjs-load-progress"}),t=Me("span",{className:"vjs-control-text"}),i=Me("span",{textContent:this.localize("Loaded")}),s=ue.createTextNode(": ");return this.percentageEl_=Me("span",{className:"vjs-control-text-loaded-percentage",textContent:"0%"}),e.appendChild(t),t.appendChild(i),t.appendChild(s),t.appendChild(this.percentageEl_),e}dispose(){this.partEls_=null,this.percentageEl_=null,super.dispose()}update(e){this.requestNamedAnimationFrame("LoadProgressBar#update",()=>{const t=this.player_.liveTracker,i=this.player_.buffered(),s=t&&t.isLive()?t.seekableEnd():this.player_.duration(),n=this.player_.bufferedEnd(),a=this.partEls_,o=lf(n,s);this.percent_!==o&&(this.el_.style.width=o,Js(this.percentageEl_,o),this.percent_=o);for(let l=0;l<i.length;l++){const u=i.start(l),c=i.end(l);let h=a[l];h||(h=this.el_.appendChild(Me()),a[l]=h),!(h.dataset.start===u&&h.dataset.end===c)&&(h.dataset.start=u,h.dataset.end=c,h.style.left=lf(u,n),h.style.width=lf(c-u,n))}for(let l=a.length;l>i.length;l--)this.el_.removeChild(a[l-1]);a.length=i.length})}}ee.registerComponent("LoadProgressBar",rQ);class sQ extends ee{constructor(e,t){super(e,t),this.update=Hr(ut(this,this.update),sr)}createEl(){return super.createEl("div",{className:"vjs-time-tooltip"},{"aria-hidden":"true"})}update(e,t,i){const s=pl(this.el_),n=Ia(this.player_.el()),a=e.width*t;if(!n||!s)return;let o=e.left-n.left+a,l=e.width-a+(n.right-e.right);l||(l=e.width-a,o=a);let u=s.width/2;o<u?u+=u-o:l<u&&(u=l),u<0?u=0:u>s.width&&(u=s.width),u=Math.round(u),this.el_.style.right=`-${u}px`,this.write(i)}write(e){Js(this.el_,e)}updateTime(e,t,i,s){this.requestNamedAnimationFrame("TimeTooltip#updateTime",()=>{let n;const a=this.player_.duration();if(this.player_.liveTracker&&this.player_.liveTracker.isLive()){const o=this.player_.liveTracker.liveWindow(),l=o-t*o;n=(l<1?"":"-")+Mn(l,o)}else n=Mn(i,a);this.update(e,t,n),s&&s()})}}ee.registerComponent("TimeTooltip",sQ);class Dg extends ee{constructor(e,t){super(e,t),this.setIcon("circle"),this.update=Hr(ut(this,this.update),sr)}createEl(){return super.createEl("div",{className:"vjs-play-progress vjs-slider-bar"},{"aria-hidden":"true"})}update(e,t,i){const s=this.getChild("timeTooltip");if(!s)return;const n=i&&i.target&&typeof i.target.pendingSeekTime=="function"?i.target.pendingSeekTime():this.player_.scrubbing()?this.player_.getCache().currentTime:this.player_.currentTime();s.updateTime(e,t,n)}}Dg.prototype.options_={children:[]};!si&&!Or&&Dg.prototype.options_.children.push("timeTooltip");ee.registerComponent("PlayProgressBar",Dg);class r_ extends ee{constructor(e,t){super(e,t),this.update=Hr(ut(this,this.update),sr)}createEl(){return super.createEl("div",{className:"vjs-mouse-display"})}update(e,t){const i=t*this.player_.duration();this.getChild("timeTooltip").updateTime(e,t,i,()=>{this.el_.style.left=`${e.width*t}px`})}}r_.prototype.options_={children:["timeTooltip"]};ee.registerComponent("MouseTimeDisplay",r_);class id extends Pg{constructor(e,t){t=Je(id.prototype.options_,t),t.children=[...t.children];const i=e.options_.disableSeekWhileScrubbingOnMobile&&(si||Or)||e.options_.disableSeekWhileScrubbingOnSTV;(!si&&!Or||i)&&t.children.splice(1,0,"mouseTimeDisplay"),super(e,t),this.shouldDisableSeekWhileScrubbing_=i,this.pendingSeekTime_=null,this.setEventHandlers_()}setEventHandlers_(){this.update_=ut(this,this.update),this.update=Hr(this.update_,sr),this.on(this.player_,["durationchange","timeupdate"],this.update),this.on(this.player_,["ended"],this.update_),this.player_.liveTracker&&this.on(this.player_.liveTracker,"liveedgechange",this.update),this.updateInterval=null,this.enableIntervalHandler_=e=>this.enableInterval_(e),this.disableIntervalHandler_=e=>this.disableInterval_(e),this.on(this.player_,["playing"],this.enableIntervalHandler_),this.on(this.player_,["ended","pause","waiting"],this.disableIntervalHandler_),"hidden"in ue&&"visibilityState"in ue&&this.on(ue,"visibilitychange",this.toggleVisibility_)}toggleVisibility_(e){ue.visibilityState==="hidden"?(this.cancelNamedAnimationFrame("SeekBar#update"),this.cancelNamedAnimationFrame("Slider#update"),this.disableInterval_(e)):(!this.player_.ended()&&!this.player_.paused()&&this.enableInterval_(),this.update())}enableInterval_(){this.updateInterval||(this.updateInterval=this.setInterval(this.update,sr))}disableInterval_(e){this.player_.liveTracker&&this.player_.liveTracker.isLive()&&e&&e.type!=="ended"||this.updateInterval&&(this.clearInterval(this.updateInterval),this.updateInterval=null)}createEl(){return super.createEl("div",{className:"vjs-progress-holder"},{"aria-label":this.localize("Progress Bar")})}update(e){if(ue.visibilityState==="hidden")return;const t=super.update();return this.requestNamedAnimationFrame("SeekBar#update",()=>{const i=this.player_.ended()?this.player_.duration():this.getCurrentTime_(),s=this.player_.liveTracker;let n=this.player_.duration();s&&s.isLive()&&(n=this.player_.liveTracker.liveCurrentTime()),this.percent_!==t&&(this.el_.setAttribute("aria-valuenow",(t*100).toFixed(2)),this.percent_=t),(this.currentTime_!==i||this.duration_!==n)&&(this.el_.setAttribute("aria-valuetext",this.localize("progress bar timing: currentTime={1} duration={2}",[Mn(i,n),Mn(n,n)],"{1} of {2}")),this.currentTime_=i,this.duration_=n),this.bar&&this.bar.update(Ia(this.el()),this.getProgress(),e)}),t}userSeek_(e){this.player_.liveTracker&&this.player_.liveTracker.isLive()&&this.player_.liveTracker.nextSeekedFromUser(),this.player_.currentTime(e)}getCurrentTime_(){return this.player_.scrubbing()?this.player_.getCache().currentTime:this.player_.currentTime()}pendingSeekTime(e){if(e!==void 0)if(e!==null){const t=this.player_.duration();this.pendingSeekTime_=Math.max(0,Math.min(e,t))}else this.pendingSeekTime_=null;return this.pendingSeekTime_}getPercent(){if(this.pendingSeekTime()!==null)return this.pendingSeekTime()/this.player_.duration();const e=this.getCurrentTime_();let t;const i=this.player_.liveTracker;return i&&i.isLive()?(t=(e-i.seekableStart())/i.liveWindow(),i.atLiveEdge()&&(t=1)):t=e/this.player_.duration(),t}handleMouseDown(e){ml(e)&&(e.stopPropagation(),this.videoWasPlaying=!this.player_.paused(),this.shouldDisableSeekWhileScrubbing_||this.player_.pause(),super.handleMouseDown(e))}handleMouseMove(e,t=!1){if(!ml(e)||isNaN(this.player_.duration()))return;!t&&!this.player_.scrubbing()&&this.player_.scrubbing(!0);let i;const s=this.calculateDistance(e),n=this.player_.liveTracker;if(!n||!n.isLive())i=s*this.player_.duration(),i===this.player_.duration()&&(i=i-.1);else{if(s>=.99){n.seekToLiveEdge();return}const a=n.seekableStart(),o=n.liveCurrentTime();if(i=a+s*n.liveWindow(),i>=o&&(i=o),i<=a&&(i=a+.1),i===1/0)return}this.shouldDisableSeekWhileScrubbing_?this.pendingSeekTime(i):this.userSeek_(i),this.player_.options_.enableSmoothSeeking&&this.update()}enable(){super.enable();const e=this.getChild("mouseTimeDisplay");e&&e.show()}disable(){super.disable();const e=this.getChild("mouseTimeDisplay");e&&e.hide()}handleMouseUp(e){super.handleMouseUp(e),e&&e.stopPropagation(),this.player_.scrubbing(!1),this.pendingSeekTime()!==null&&(this.userSeek_(this.pendingSeekTime()),this.pendingSeekTime(null)),this.player_.trigger({type:"timeupdate",target:this,manuallyTriggered:!0}),this.videoWasPlaying?Br(this.player_.play()):this.update_()}handlePendingSeek_(e){this.player_.paused()||this.player_.pause();const t=this.pendingSeekTime()!==null?this.pendingSeekTime():this.player_.currentTime();this.pendingSeekTime(t+e),this.player_.trigger({type:"timeupdate",target:this,manuallyTriggered:!0})}stepForward(){this.shouldDisableSeekWhileScrubbing_?this.handlePendingSeek_(this.options().stepSeconds):this.userSeek_(this.player_.currentTime()+this.options().stepSeconds)}stepBack(){this.shouldDisableSeekWhileScrubbing_?this.handlePendingSeek_(-this.options().stepSeconds):this.userSeek_(this.player_.currentTime()-this.options().stepSeconds)}handleAction(e){this.pendingSeekTime()!==null&&(this.userSeek_(this.pendingSeekTime()),this.pendingSeekTime(null)),this.player_.paused()?this.player_.play():this.player_.pause()}handleKeyDown(e){const t=this.player_.liveTracker;if(e.key===" "||e.key==="Enter")e.preventDefault(),e.stopPropagation(),this.handleAction(e);else if(e.key==="Home")e.preventDefault(),e.stopPropagation(),this.userSeek_(0);else if(e.key==="End")e.preventDefault(),e.stopPropagation(),t&&t.isLive()?this.userSeek_(t.liveCurrentTime()):this.userSeek_(this.player_.duration());else if(/^[0-9]$/.test(e.key)){e.preventDefault(),e.stopPropagation();const i=parseInt(e.key,10)*.1;t&&t.isLive()?this.userSeek_(t.seekableStart()+t.liveWindow()*i):this.userSeek_(this.player_.duration()*i)}else e.key==="PageDown"?(e.preventDefault(),e.stopPropagation(),this.userSeek_(this.player_.currentTime()-this.options().stepSeconds*this.options().pageMultiplier)):e.key==="PageUp"?(e.preventDefault(),e.stopPropagation(),this.userSeek_(this.player_.currentTime()+this.options().stepSeconds*this.options().pageMultiplier)):super.handleKeyDown(e)}dispose(){this.disableInterval_(),this.off(this.player_,["durationchange","timeupdate"],this.update),this.off(this.player_,["ended"],this.update_),this.player_.liveTracker&&this.off(this.player_.liveTracker,"liveedgechange",this.update),this.off(this.player_,["playing"],this.enableIntervalHandler_),this.off(this.player_,["ended","pause","waiting"],this.disableIntervalHandler_),"hidden"in ue&&"visibilityState"in ue&&this.off(ue,"visibilitychange",this.toggleVisibility_),super.dispose()}}id.prototype.options_={children:["loadProgressBar","playProgressBar"],barName:"playProgressBar",stepSeconds:5,pageMultiplier:12};ee.registerComponent("SeekBar",id);class s_ extends ee{constructor(e,t){super(e,t),this.handleMouseMove=Hr(ut(this,this.handleMouseMove),sr),this.throttledHandleMouseSeek=Hr(ut(this,this.handleMouseSeek),sr),this.handleMouseUpHandler_=i=>this.handleMouseUp(i),this.handleMouseDownHandler_=i=>this.handleMouseDown(i),this.enable()}createEl(){return super.createEl("div",{className:"vjs-progress-control vjs-control"})}handleMouseMove(e){const t=this.getChild("seekBar");if(!t)return;const i=t.getChild("playProgressBar"),s=t.getChild("mouseTimeDisplay");if(!i&&!s)return;const n=t.el(),a=pl(n);let o=Hh(n,e).x;o=Wl(o,0,1),s&&s.update(a,o),i&&i.update(a,t.getProgress())}handleMouseSeek(e){const t=this.getChild("seekBar");t&&t.handleMouseMove(e)}enabled(){return this.enabled_}disable(){if(this.children().forEach(e=>e.disable&&e.disable()),!!this.enabled()&&(this.off(["mousedown","touchstart"],this.handleMouseDownHandler_),this.off(this.el_,["mousemove","touchmove"],this.handleMouseMove),this.removeListenersAddedOnMousedownAndTouchstart(),this.addClass("disabled"),this.enabled_=!1,this.player_.scrubbing())){const e=this.getChild("seekBar");this.player_.scrubbing(!1),e.videoWasPlaying&&Br(this.player_.play())}}enable(){this.children().forEach(e=>e.enable&&e.enable()),!this.enabled()&&(this.on(["mousedown","touchstart"],this.handleMouseDownHandler_),this.on(this.el_,["mousemove","touchmove"],this.handleMouseMove),this.removeClass("disabled"),this.enabled_=!0)}removeListenersAddedOnMousedownAndTouchstart(){const e=this.el_.ownerDocument;this.off(e,"mousemove",this.throttledHandleMouseSeek),this.off(e,"touchmove",this.throttledHandleMouseSeek),this.off(e,"mouseup",this.handleMouseUpHandler_),this.off(e,"touchend",this.handleMouseUpHandler_)}handleMouseDown(e){const t=this.el_.ownerDocument,i=this.getChild("seekBar");i&&i.handleMouseDown(e),this.on(t,"mousemove",this.throttledHandleMouseSeek),this.on(t,"touchmove",this.throttledHandleMouseSeek),this.on(t,"mouseup",this.handleMouseUpHandler_),this.on(t,"touchend",this.handleMouseUpHandler_)}handleMouseUp(e){const t=this.getChild("seekBar");t&&t.handleMouseUp(e),this.removeListenersAddedOnMousedownAndTouchstart()}}s_.prototype.options_={children:["seekBar"]};ee.registerComponent("ProgressControl",s_);class n_ extends ai{constructor(e,t){super(e,t),this.setIcon("picture-in-picture-enter"),this.on(e,["enterpictureinpicture","leavepictureinpicture"],i=>this.handlePictureInPictureChange(i)),this.on(e,["disablepictureinpicturechanged","loadedmetadata"],i=>this.handlePictureInPictureEnabledChange(i)),this.on(e,["loadedmetadata","audioonlymodechange","audiopostermodechange"],()=>this.handlePictureInPictureAudioModeChange()),this.disable()}buildCSSClass(){return`vjs-picture-in-picture-control vjs-hidden ${super.buildCSSClass()}`}handlePictureInPictureAudioModeChange(){if(!(this.player_.currentType().substring(0,5)==="audio"||this.player_.audioPosterMode()||this.player_.audioOnlyMode())){this.show();return}this.player_.isInPictureInPicture()&&this.player_.exitPictureInPicture(),this.hide()}handlePictureInPictureEnabledChange(){ue.pictureInPictureEnabled&&this.player_.disablePictureInPicture()===!1||this.player_.options_.enableDocumentPictureInPicture&&"documentPictureInPicture"in U?this.enable():this.disable()}handlePictureInPictureChange(e){this.player_.isInPictureInPicture()?(this.setIcon("picture-in-picture-exit"),this.controlText("Exit Picture-in-Picture")):(this.setIcon("picture-in-picture-enter"),this.controlText("Picture-in-Picture")),this.handlePictureInPictureEnabledChange()}handleClick(e){this.player_.isInPictureInPicture()?this.player_.exitPictureInPicture():this.player_.requestPictureInPicture()}show(){typeof ue.exitPictureInPicture=="function"&&super.show()}}n_.prototype.controlText_="Picture-in-Picture";ee.registerComponent("PictureInPictureToggle",n_);class a_ extends ai{constructor(e,t){super(e,t),this.setIcon("fullscreen-enter"),this.on(e,"fullscreenchange",i=>this.handleFullscreenChange(i)),ue[e.fsApi_.fullscreenEnabled]===!1&&this.disable()}buildCSSClass(){return`vjs-fullscreen-control ${super.buildCSSClass()}`}handleFullscreenChange(e){this.player_.isFullscreen()?(this.controlText("Exit Fullscreen"),this.setIcon("fullscreen-exit")):(this.controlText("Fullscreen"),this.setIcon("fullscreen-enter"))}handleClick(e){this.player_.isFullscreen()?this.player_.exitFullscreen():this.player_.requestFullscreen()}}a_.prototype.controlText_="Fullscreen";ee.registerComponent("FullscreenToggle",a_);const nQ=function(r,e){e.tech_&&!e.tech_.featuresVolumeControl&&r.addClass("vjs-hidden"),r.on(e,"loadstart",function(){e.tech_.featuresVolumeControl?r.removeClass("vjs-hidden"):r.addClass("vjs-hidden")})};class aQ extends ee{createEl(){const e=super.createEl("div",{className:"vjs-volume-level"});return this.setIcon("circle",e),e.appendChild(super.createEl("span",{className:"vjs-control-text"})),e}}ee.registerComponent("VolumeLevel",aQ);class oQ extends ee{constructor(e,t){super(e,t),this.update=Hr(ut(this,this.update),sr)}createEl(){return super.createEl("div",{className:"vjs-volume-tooltip"},{"aria-hidden":"true"})}update(e,t,i,s){if(!i){const n=Ia(this.el_),a=Ia(this.player_.el()),o=e.width*t;if(!a||!n)return;const l=e.left-a.left+o,u=e.width-o+(a.right-e.right);let c=n.width/2;l<c?c+=c-l:u<c&&(c=u),c<0?c=0:c>n.width&&(c=n.width),this.el_.style.right=`-${c}px`}this.write(`${s}%`)}write(e){Js(this.el_,e)}updateVolume(e,t,i,s,n){this.requestNamedAnimationFrame("VolumeLevelTooltip#updateVolume",()=>{this.update(e,t,i,s.toFixed(0)),n&&n()})}}ee.registerComponent("VolumeLevelTooltip",oQ);class o_ extends ee{constructor(e,t){super(e,t),this.update=Hr(ut(this,this.update),sr)}createEl(){return super.createEl("div",{className:"vjs-mouse-display"})}update(e,t,i){const s=100*t;this.getChild("volumeLevelTooltip").updateVolume(e,t,i,s,()=>{i?this.el_.style.bottom=`${e.height*t}px`:this.el_.style.left=`${e.width*t}px`})}}o_.prototype.options_={children:["volumeLevelTooltip"]};ee.registerComponent("MouseVolumeLevelDisplay",o_);class rd extends Pg{constructor(e,t){super(e,t),this.on("slideractive",i=>this.updateLastVolume_(i)),this.on(e,"volumechange",i=>this.updateARIAAttributes(i)),e.ready(()=>this.updateARIAAttributes())}createEl(){return super.createEl("div",{className:"vjs-volume-bar vjs-slider-bar"},{"aria-label":this.localize("Volume Level"),"aria-live":"polite"})}handleMouseDown(e){ml(e)&&super.handleMouseDown(e)}handleMouseMove(e){const t=this.getChild("mouseVolumeLevelDisplay");if(t){const i=this.el(),s=Ia(i),n=this.vertical();let a=Hh(i,e);a=n?a.y:a.x,a=Wl(a,0,1),t.update(s,a,n)}ml(e)&&(this.checkMuted(),this.player_.volume(this.calculateDistance(e)))}checkMuted(){this.player_.muted()&&this.player_.muted(!1)}getPercent(){return this.player_.muted()?0:this.player_.volume()}stepForward(){this.checkMuted(),this.player_.volume(this.player_.volume()+.1)}stepBack(){this.checkMuted(),this.player_.volume(this.player_.volume()-.1)}updateARIAAttributes(e){const t=this.player_.muted()?0:this.volumeAsPercentage_();this.el_.setAttribute("aria-valuenow",t),this.el_.setAttribute("aria-valuetext",t+"%")}volumeAsPercentage_(){return Math.round(this.player_.volume()*100)}updateLastVolume_(){const e=this.player_.volume();this.one("sliderinactive",()=>{this.player_.volume()===0&&this.player_.lastVolume_(e)})}}rd.prototype.options_={children:["volumeLevel"],barName:"volumeLevel"};!si&&!Or&&rd.prototype.options_.children.splice(0,0,"mouseVolumeLevelDisplay");rd.prototype.playerEvent="volumechange";ee.registerComponent("VolumeBar",rd);class l_ extends ee{constructor(e,t={}){t.vertical=t.vertical||!1,(typeof t.volumeBar>"u"||Da(t.volumeBar))&&(t.volumeBar=t.volumeBar||{},t.volumeBar.vertical=t.vertical),super(e,t),nQ(this,e),this.throttledHandleMouseMove=Hr(ut(this,this.handleMouseMove),sr),this.handleMouseUpHandler_=i=>this.handleMouseUp(i),this.on("mousedown",i=>this.handleMouseDown(i)),this.on("touchstart",i=>this.handleMouseDown(i)),this.on("mousemove",i=>this.handleMouseMove(i)),this.on(this.volumeBar,["focus","slideractive"],()=>{this.volumeBar.addClass("vjs-slider-active"),this.addClass("vjs-slider-active"),this.trigger("slideractive")}),this.on(this.volumeBar,["blur","sliderinactive"],()=>{this.volumeBar.removeClass("vjs-slider-active"),this.removeClass("vjs-slider-active"),this.trigger("sliderinactive")})}createEl(){let e="vjs-volume-horizontal";return this.options_.vertical&&(e="vjs-volume-vertical"),super.createEl("div",{className:`vjs-volume-control vjs-control ${e}`})}handleMouseDown(e){const t=this.el_.ownerDocument;this.on(t,"mousemove",this.throttledHandleMouseMove),this.on(t,"touchmove",this.throttledHandleMouseMove),this.on(t,"mouseup",this.handleMouseUpHandler_),this.on(t,"touchend",this.handleMouseUpHandler_)}handleMouseUp(e){const t=this.el_.ownerDocument;this.off(t,"mousemove",this.throttledHandleMouseMove),this.off(t,"touchmove",this.throttledHandleMouseMove),this.off(t,"mouseup",this.handleMouseUpHandler_),this.off(t,"touchend",this.handleMouseUpHandler_)}handleMouseMove(e){this.volumeBar.handleMouseMove(e)}}l_.prototype.options_={children:["volumeBar"]};ee.registerComponent("VolumeControl",l_);const lQ=function(r,e){e.tech_&&!e.tech_.featuresMuteControl&&r.addClass("vjs-hidden"),r.on(e,"loadstart",function(){e.tech_.featuresMuteControl?r.removeClass("vjs-hidden"):r.addClass("vjs-hidden")})};class u_ extends ai{constructor(e,t){super(e,t),lQ(this,e),this.on(e,["loadstart","volumechange"],i=>this.update(i))}buildCSSClass(){return`vjs-mute-control ${super.buildCSSClass()}`}handleClick(e){const t=this.player_.volume(),i=this.player_.lastVolume_();if(t===0){const s=i<.1?.1:i;this.player_.volume(s),this.player_.muted(!1)}else this.player_.muted(!this.player_.muted())}update(e){this.updateIcon_(),this.updateControlText_()}updateIcon_(){const e=this.player_.volume();let t=3;this.setIcon("volume-high"),si&&this.player_.tech_&&this.player_.tech_.el_&&this.player_.muted(this.player_.tech_.el_.muted),e===0||this.player_.muted()?(this.setIcon("volume-mute"),t=0):e<.33?(this.setIcon("volume-low"),t=1):e<.67&&(this.setIcon("volume-medium"),t=2),Zh(this.el_,[0,1,2,3].reduce((i,s)=>i+`${s?" ":""}vjs-vol-${s}`,"")),kn(this.el_,`vjs-vol-${t}`)}updateControlText_(){const t=this.player_.muted()||this.player_.volume()===0?"Unmute":"Mute";this.controlText()!==t&&this.controlText(t)}}u_.prototype.controlText_="Mute";ee.registerComponent("MuteToggle",u_);class c_ extends ee{constructor(e,t={}){typeof t.inline<"u"?t.inline=t.inline:t.inline=!0,(typeof t.volumeControl>"u"||Da(t.volumeControl))&&(t.volumeControl=t.volumeControl||{},t.volumeControl.vertical=!t.inline),super(e,t),this.handleKeyPressHandler_=i=>this.handleKeyPress(i),this.on(e,["loadstart"],i=>this.volumePanelState_(i)),this.on(this.muteToggle,"keyup",i=>this.handleKeyPress(i)),this.on(this.volumeControl,"keyup",i=>this.handleVolumeControlKeyUp(i)),this.on("keydown",i=>this.handleKeyPress(i)),this.on("mouseover",i=>this.handleMouseOver(i)),this.on("mouseout",i=>this.handleMouseOut(i)),this.on(this.volumeControl,["slideractive"],this.sliderActive_),this.on(this.volumeControl,["sliderinactive"],this.sliderInactive_)}sliderActive_(){this.addClass("vjs-slider-active")}sliderInactive_(){this.removeClass("vjs-slider-active")}volumePanelState_(){this.volumeControl.hasClass("vjs-hidden")&&this.muteToggle.hasClass("vjs-hidden")&&this.addClass("vjs-hidden"),this.volumeControl.hasClass("vjs-hidden")&&!this.muteToggle.hasClass("vjs-hidden")&&this.addClass("vjs-mute-toggle-only")}createEl(){let e="vjs-volume-panel-horizontal";return this.options_.inline||(e="vjs-volume-panel-vertical"),super.createEl("div",{className:`vjs-volume-panel vjs-control ${e}`})}dispose(){this.handleMouseOut(),super.dispose()}handleVolumeControlKeyUp(e){e.key==="Escape"&&this.muteToggle.focus()}handleMouseOver(e){this.addClass("vjs-hover"),Ui(ue,"keyup",this.handleKeyPressHandler_)}handleMouseOut(e){this.removeClass("vjs-hover"),ni(ue,"keyup",this.handleKeyPressHandler_)}handleKeyPress(e){e.key==="Escape"&&this.handleMouseOut()}}c_.prototype.options_={children:["muteToggle","volumeControl"]};ee.registerComponent("VolumePanel",c_);class h_ extends ai{constructor(e,t){super(e,t),this.validOptions=[5,10,30],this.skipTime=this.getSkipForwardTime(),this.skipTime&&this.validOptions.includes(this.skipTime)?(this.setIcon(`forward-${this.skipTime}`),this.controlText(this.localize("Skip forward {1} seconds",[this.skipTime.toLocaleString(e.language())])),this.show()):this.hide()}getSkipForwardTime(){const e=this.options_.playerOptions;return e.controlBar&&e.controlBar.skipButtons&&e.controlBar.skipButtons.forward}buildCSSClass(){return`vjs-skip-forward-${this.getSkipForwardTime()} ${super.buildCSSClass()}`}handleClick(e){if(isNaN(this.player_.duration()))return;const t=this.player_.currentTime(),i=this.player_.liveTracker,s=i&&i.isLive()?i.seekableEnd():this.player_.duration();let n;t+this.skipTime<=s?n=t+this.skipTime:n=s,this.player_.currentTime(n)}handleLanguagechange(){this.controlText(this.localize("Skip forward {1} seconds",[this.skipTime]))}}h_.prototype.controlText_="Skip Forward";ee.registerComponent("SkipForward",h_);class d_ extends ai{constructor(e,t){super(e,t),this.validOptions=[5,10,30],this.skipTime=this.getSkipBackwardTime(),this.skipTime&&this.validOptions.includes(this.skipTime)?(this.setIcon(`replay-${this.skipTime}`),this.controlText(this.localize("Skip backward {1} seconds",[this.skipTime.toLocaleString(e.language())])),this.show()):this.hide()}getSkipBackwardTime(){const e=this.options_.playerOptions;return e.controlBar&&e.controlBar.skipButtons&&e.controlBar.skipButtons.backward}buildCSSClass(){return`vjs-skip-backward-${this.getSkipBackwardTime()} ${super.buildCSSClass()}`}handleClick(e){const t=this.player_.currentTime(),i=this.player_.liveTracker,s=i&&i.isLive()&&i.seekableStart();let n;s&&t-this.skipTime<=s?n=s:t>=this.skipTime?n=t-this.skipTime:n=0,this.player_.currentTime(n)}handleLanguagechange(){this.controlText(this.localize("Skip backward {1} seconds",[this.skipTime]))}}d_.prototype.controlText_="Skip Backward";ee.registerComponent("SkipBackward",d_);class f_ extends ee{constructor(e,t){super(e,t),t&&(this.menuButton_=t.menuButton),this.focusedChild_=-1,this.on("keydown",i=>this.handleKeyDown(i)),this.boundHandleBlur_=i=>this.handleBlur(i),this.boundHandleTapClick_=i=>this.handleTapClick(i)}addEventListenerForItem(e){e instanceof ee&&(this.on(e,"blur",this.boundHandleBlur_),this.on(e,["tap","click"],this.boundHandleTapClick_))}removeEventListenerForItem(e){e instanceof ee&&(this.off(e,"blur",this.boundHandleBlur_),this.off(e,["tap","click"],this.boundHandleTapClick_))}removeChild(e){typeof e=="string"&&(e=this.getChild(e)),this.removeEventListenerForItem(e),super.removeChild(e)}addItem(e){const t=this.addChild(e);t&&this.addEventListenerForItem(t)}createEl(){const e=this.options_.contentElType||"ul";this.contentEl_=Me(e,{className:"vjs-menu-content"}),this.contentEl_.setAttribute("role","menu");const t=super.createEl("div",{append:this.contentEl_,className:"vjs-menu"});return t.appendChild(this.contentEl_),Ui(t,"click",function(i){i.preventDefault(),i.stopImmediatePropagation()}),t}dispose(){this.contentEl_=null,this.boundHandleBlur_=null,this.boundHandleTapClick_=null,super.dispose()}handleBlur(e){const t=e.relatedTarget||ue.activeElement;if(!this.children().some(i=>i.el()===t)){const i=this.menuButton_;i&&i.buttonPressed_&&t!==i.el().firstChild&&i.unpressButton()}}handleTapClick(e){if(this.menuButton_){this.menuButton_.unpressButton();const t=this.children();if(!Array.isArray(t))return;const i=t.filter(s=>s.el()===e.target)[0];if(!i)return;i.name()!=="CaptionSettingsMenuItem"&&this.menuButton_.focus()}}handleKeyDown(e){e.key==="ArrowLeft"||e.key==="ArrowDown"?(e.preventDefault(),e.stopPropagation(),this.stepForward()):(e.key==="ArrowRight"||e.key==="ArrowUp")&&(e.preventDefault(),e.stopPropagation(),this.stepBack())}stepForward(){let e=0;this.focusedChild_!==void 0&&(e=this.focusedChild_+1),this.focus(e)}stepBack(){let e=0;this.focusedChild_!==void 0&&(e=this.focusedChild_-1),this.focus(e)}focus(e=0){const t=this.children().slice();t.length&&t[0].hasClass("vjs-menu-title")&&t.shift(),t.length>0&&(e<0?e=0:e>=t.length&&(e=t.length-1),this.focusedChild_=e,t[e].el_.focus())}}ee.registerComponent("Menu",f_);class Mg extends ee{constructor(e,t={}){super(e,t),this.menuButton_=new ai(e,t),this.menuButton_.controlText(this.controlText_),this.menuButton_.el_.setAttribute("aria-haspopup","true");const i=ai.prototype.buildCSSClass();this.menuButton_.el_.className=this.buildCSSClass()+" "+i,this.menuButton_.removeClass("vjs-control"),this.addChild(this.menuButton_),this.update(),this.enabled_=!0;const s=n=>this.handleClick(n);this.handleMenuKeyUp_=n=>this.handleMenuKeyUp(n),this.on(this.menuButton_,"tap",s),this.on(this.menuButton_,"click",s),this.on(this.menuButton_,"keydown",n=>this.handleKeyDown(n)),this.on(this.menuButton_,"mouseenter",()=>{this.addClass("vjs-hover"),this.menu.show(),Ui(ue,"keyup",this.handleMenuKeyUp_)}),this.on("mouseleave",n=>this.handleMouseLeave(n)),this.on("keydown",n=>this.handleSubmenuKeyDown(n))}update(){const e=this.createMenu();this.menu&&(this.menu.dispose(),this.removeChild(this.menu)),this.menu=e,this.addChild(e),this.buttonPressed_=!1,this.menuButton_.el_.setAttribute("aria-expanded","false"),this.items&&this.items.length<=this.hideThreshold_?(this.hide(),this.menu.contentEl_.removeAttribute("role")):(this.show(),this.menu.contentEl_.setAttribute("role","menu"))}createMenu(){const e=new f_(this.player_,{menuButton:this});if(this.hideThreshold_=0,this.options_.title){const t=Me("li",{className:"vjs-menu-title",textContent:Tt(this.options_.title),tabIndex:-1}),i=new ee(this.player_,{el:t});e.addItem(i)}if(this.items=this.createItems(),this.items)for(let t=0;t<this.items.length;t++)e.addItem(this.items[t]);return e}createItems(){}createEl(){return super.createEl("div",{className:this.buildWrapperCSSClass()},{})}setIcon(e){super.setIcon(e,this.menuButton_.el_)}buildWrapperCSSClass(){let e="vjs-menu-button";this.options_.inline===!0?e+="-inline":e+="-popup";const t=ai.prototype.buildCSSClass();return`vjs-menu-button ${e} ${t} ${super.buildCSSClass()}`}buildCSSClass(){let e="vjs-menu-button";return this.options_.inline===!0?e+="-inline":e+="-popup",`vjs-menu-button ${e} ${super.buildCSSClass()}`}controlText(e,t=this.menuButton_.el()){return this.menuButton_.controlText(e,t)}dispose(){this.handleMouseLeave(),super.dispose()}handleClick(e){this.buttonPressed_?this.unpressButton():this.pressButton()}handleMouseLeave(e){this.removeClass("vjs-hover"),ni(ue,"keyup",this.handleMenuKeyUp_)}focus(){this.menuButton_.focus()}blur(){this.menuButton_.blur()}handleKeyDown(e){e.key==="Escape"||e.key==="Tab"?(this.buttonPressed_&&this.unpressButton(),!e.key==="Tab"&&(e.preventDefault(),this.menuButton_.focus())):(e.key==="Up"||e.key==="Down"&&!(this.player_.options_.playerOptions.spatialNavigation&&this.player_.options_.playerOptions.spatialNavigation.enabled))&&(this.buttonPressed_||(e.preventDefault(),this.pressButton()))}handleMenuKeyUp(e){(e.key==="Escape"||e.key==="Tab")&&this.removeClass("vjs-hover")}handleSubmenuKeyPress(e){this.handleSubmenuKeyDown(e)}handleSubmenuKeyDown(e){(e.key==="Escape"||e.key==="Tab")&&(this.buttonPressed_&&this.unpressButton(),!e.key==="Tab"&&(e.preventDefault(),this.menuButton_.focus()))}pressButton(){if(this.enabled_){if(this.buttonPressed_=!0,this.menu.show(),this.menu.lockShowing(),this.menuButton_.el_.setAttribute("aria-expanded","true"),si&&_T())return;this.menu.focus()}}unpressButton(){this.enabled_&&(this.buttonPressed_=!1,this.menu.unlockShowing(),this.menu.hide(),this.menuButton_.el_.setAttribute("aria-expanded","false"))}disable(){this.unpressButton(),this.enabled_=!1,this.addClass("vjs-disabled"),this.menuButton_.disable()}enable(){this.enabled_=!0,this.removeClass("vjs-disabled"),this.menuButton_.enable()}}ee.registerComponent("MenuButton",Mg);class Ig extends Mg{constructor(e,t){const i=t.tracks;if(super(e,t),this.items.length<=1&&this.hide(),!i)return;const s=ut(this,this.update);i.addEventListener("removetrack",s),i.addEventListener("addtrack",s),i.addEventListener("labelchange",s),this.player_.on("ready",s),this.player_.on("dispose",function(){i.removeEventListener("removetrack",s),i.removeEventListener("addtrack",s),i.removeEventListener("labelchange",s)})}}ee.registerComponent("TrackButton",Ig);class Hl extends td{constructor(e,t){super(e,t),this.selectable=t.selectable,this.isSelected_=t.selected||!1,this.multiSelectable=t.multiSelectable,this.selected(this.isSelected_),this.selectable?this.multiSelectable?this.el_.setAttribute("role","menuitemcheckbox"):this.el_.setAttribute("role","menuitemradio"):this.el_.setAttribute("role","menuitem")}createEl(e,t,i){this.nonIconControl=!0;const s=super.createEl("li",Object.assign({className:"vjs-menu-item",tabIndex:-1},t),i),n=Me("span",{className:"vjs-menu-item-text",textContent:this.localize(this.options_.label)});return this.player_.options_.experimentalSvgIcons?s.appendChild(n):s.replaceChild(n,s.querySelector(".vjs-icon-placeholder")),s}handleKeyDown(e){["Tab","Escape","ArrowUp","ArrowLeft","ArrowRight","ArrowDown"].includes(e.key)||super.handleKeyDown(e)}handleClick(e){this.selected(!0)}selected(e){this.selectable&&(e?(this.addClass("vjs-selected"),this.el_.setAttribute("aria-checked","true"),this.controlText(", selected"),this.isSelected_=!0):(this.removeClass("vjs-selected"),this.el_.setAttribute("aria-checked","false"),this.controlText(""),this.isSelected_=!1))}}ee.registerComponent("MenuItem",Hl);class Yl extends Hl{constructor(e,t){const i=t.track,s=e.textTracks();t.label=i.label||i.language||"Unknown",t.selected=i.mode==="showing",super(e,t),this.track=i,this.kinds=(t.kinds||[t.kind||this.track.kind]).filter(Boolean);const n=(...o)=>{this.handleTracksChange.apply(this,o)},a=(...o)=>{this.handleSelectedLanguageChange.apply(this,o)};if(e.on(["loadstart","texttrackchange"],n),s.addEventListener("change",n),s.addEventListener("selectedlanguagechange",a),this.on("dispose",function(){e.off(["loadstart","texttrackchange"],n),s.removeEventListener("change",n),s.removeEventListener("selectedlanguagechange",a)}),s.onchange===void 0){let o;this.on(["tap","click"],function(){if(typeof U.Event!="object")try{o=new U.Event("change")}catch{}o||(o=ue.createEvent("Event"),o.initEvent("change",!0,!0)),s.dispatchEvent(o)})}this.handleTracksChange()}handleClick(e){const t=this.track,i=this.player_.textTracks();if(super.handleClick(e),!!i)for(let s=0;s<i.length;s++){const n=i[s];this.kinds.indexOf(n.kind)!==-1&&(n===t?n.mode!=="showing"&&(n.mode="showing"):n.mode!=="disabled"&&(n.mode="disabled"))}}handleTracksChange(e){const t=this.track.mode==="showing";t!==this.isSelected_&&this.selected(t)}handleSelectedLanguageChange(e){if(this.track.mode==="showing"){const t=this.player_.cache_.selectedLanguage;if(t&&t.enabled&&t.language===this.track.language&&t.kind!==this.track.kind)return;this.player_.cache_.selectedLanguage={enabled:!0,language:this.track.language,kind:this.track.kind}}}dispose(){this.track=null,super.dispose()}}ee.registerComponent("TextTrackMenuItem",Yl);class p_ extends Yl{constructor(e,t){t.track={player:e,kind:t.kind,kinds:t.kinds,default:!1,mode:"disabled"},t.kinds||(t.kinds=[t.kind]),t.label?t.track.label=t.label:t.track.label=t.kinds.join(" and ")+" off",t.selectable=!0,t.multiSelectable=!1,super(e,t)}handleTracksChange(e){const t=this.player().textTracks();let i=!0;for(let s=0,n=t.length;s<n;s++){const a=t[s];if(this.options_.kinds.indexOf(a.kind)>-1&&a.mode==="showing"){i=!1;break}}i!==this.isSelected_&&this.selected(i)}handleSelectedLanguageChange(e){const t=this.player().textTracks();let i=!0;for(let s=0,n=t.length;s<n;s++){const a=t[s];if(["captions","descriptions","subtitles"].indexOf(a.kind)>-1&&a.mode==="showing"){i=!1;break}}i&&(this.player_.cache_.selectedLanguage={enabled:!1})}handleLanguagechange(){this.$(".vjs-menu-item-text").textContent=this.player_.localize(this.options_.label),super.handleLanguagechange()}}ee.registerComponent("OffTextTrackMenuItem",p_);class eo extends Ig{constructor(e,t={}){t.tracks=e.textTracks(),super(e,t)}createItems(e=[],t=Yl){let i;this.label_&&(i=`${this.label_} off`),e.push(new p_(this.player_,{kinds:this.kinds_,kind:this.kind_,label:i})),this.hideThreshold_+=1;const s=this.player_.textTracks();Array.isArray(this.kinds_)||(this.kinds_=[this.kind_]);for(let n=0;n<s.length;n++){const a=s[n];if(this.kinds_.indexOf(a.kind)>-1){const o=new t(this.player_,{track:a,kinds:this.kinds_,kind:this.kind_,selectable:!0,multiSelectable:!1});o.addClass(`vjs-${a.kind}-menu-item`),e.push(o)}}return e}}ee.registerComponent("TextTrackButton",eo);class m_ extends Hl{constructor(e,t){const i=t.track,s=t.cue,n=e.currentTime();t.selectable=!0,t.multiSelectable=!1,t.label=s.text,t.selected=s.startTime<=n&&n<s.endTime,super(e,t),this.track=i,this.cue=s}handleClick(e){super.handleClick(),this.player_.currentTime(this.cue.startTime)}}ee.registerComponent("ChaptersTrackMenuItem",m_);class Rg extends eo{constructor(e,t,i){super(e,t,i),this.setIcon("chapters"),this.selectCurrentItem_=()=>{this.items.forEach(s=>{s.selected(this.track_.activeCues[0]===s.cue)})}}buildCSSClass(){return`vjs-chapters-button ${super.buildCSSClass()}`}buildWrapperCSSClass(){return`vjs-chapters-button ${super.buildWrapperCSSClass()}`}update(e){if(e&&e.track&&e.track.kind!=="chapters")return;const t=this.findChaptersTrack();t!==this.track_?(this.setTrack(t),super.update()):(!this.items||t&&t.cues&&t.cues.length!==this.items.length)&&super.update()}setTrack(e){if(this.track_!==e){if(this.updateHandler_||(this.updateHandler_=this.update.bind(this)),this.track_){const t=this.player_.remoteTextTrackEls().getTrackElementByTrack_(this.track_);t&&t.removeEventListener("load",this.updateHandler_),this.track_.removeEventListener("cuechange",this.selectCurrentItem_),this.track_=null}if(this.track_=e,this.track_){this.track_.mode="hidden";const t=this.player_.remoteTextTrackEls().getTrackElementByTrack_(this.track_);t&&t.addEventListener("load",this.updateHandler_),this.track_.addEventListener("cuechange",this.selectCurrentItem_)}}}findChaptersTrack(){const e=this.player_.textTracks()||[];for(let t=e.length-1;t>=0;t--){const i=e[t];if(i.kind===this.kind_)return i}}getMenuCaption(){return this.track_&&this.track_.label?this.track_.label:this.localize(Tt(this.kind_))}createMenu(){return this.options_.title=this.getMenuCaption(),super.createMenu()}createItems(){const e=[];if(!this.track_)return e;const t=this.track_.cues;if(!t)return e;for(let i=0,s=t.length;i<s;i++){const n=t[i],a=new m_(this.player_,{track:this.track_,cue:n});e.push(a)}return e}}Rg.prototype.kind_="chapters";Rg.prototype.controlText_="Chapters";ee.registerComponent("ChaptersButton",Rg);class Lg extends eo{constructor(e,t,i){super(e,t,i),this.setIcon("audio-description");const s=e.textTracks(),n=ut(this,this.handleTracksChange);s.addEventListener("change",n),this.on("dispose",function(){s.removeEventListener("change",n)})}handleTracksChange(e){const t=this.player().textTracks();let i=!1;for(let s=0,n=t.length;s<n;s++){const a=t[s];if(a.kind!==this.kind_&&a.mode==="showing"){i=!0;break}}i?this.disable():this.enable()}buildCSSClass(){return`vjs-descriptions-button ${super.buildCSSClass()}`}buildWrapperCSSClass(){return`vjs-descriptions-button ${super.buildWrapperCSSClass()}`}}Lg.prototype.kind_="descriptions";Lg.prototype.controlText_="Descriptions";ee.registerComponent("DescriptionsButton",Lg);class Qg extends eo{constructor(e,t,i){super(e,t,i),this.setIcon("subtitles")}buildCSSClass(){return`vjs-subtitles-button ${super.buildCSSClass()}`}buildWrapperCSSClass(){return`vjs-subtitles-button ${super.buildWrapperCSSClass()}`}}Qg.prototype.kind_="subtitles";Qg.prototype.controlText_="Subtitles";ee.registerComponent("SubtitlesButton",Qg);class $g extends Yl{constructor(e,t){t.track={player:e,kind:t.kind,label:t.kind+" settings",selectable:!1,default:!1,mode:"disabled"},t.selectable=!1,t.name="CaptionSettingsMenuItem",super(e,t),this.addClass("vjs-texttrack-settings"),this.controlText(", opens "+t.kind+" settings dialog")}handleClick(e){this.player().getChild("textTrackSettings").open()}handleLanguagechange(){this.$(".vjs-menu-item-text").textContent=this.player_.localize(this.options_.kind+" settings"),super.handleLanguagechange()}}ee.registerComponent("CaptionSettingsMenuItem",$g);class Bg extends eo{constructor(e,t,i){super(e,t,i),this.setIcon("captions")}buildCSSClass(){return`vjs-captions-button ${super.buildCSSClass()}`}buildWrapperCSSClass(){return`vjs-captions-button ${super.buildWrapperCSSClass()}`}createItems(){const e=[];return!(this.player().tech_&&this.player().tech_.featuresNativeTextTracks)&&this.player().getChild("textTrackSettings")&&(e.push(new $g(this.player_,{kind:this.kind_})),this.hideThreshold_+=1),super.createItems(e)}}Bg.prototype.kind_="captions";Bg.prototype.controlText_="Captions";ee.registerComponent("CaptionsButton",Bg);class g_ extends Yl{createEl(e,t,i){const s=super.createEl(e,t,i),n=s.querySelector(".vjs-menu-item-text");return this.options_.track.kind==="captions"&&(this.player_.options_.experimentalSvgIcons?this.setIcon("captions",s):n.appendChild(Me("span",{className:"vjs-icon-placeholder"},{"aria-hidden":!0})),n.appendChild(Me("span",{className:"vjs-control-text",textContent:` ${this.localize("Captions")}`}))),s}}ee.registerComponent("SubsCapsMenuItem",g_);class Ng extends eo{constructor(e,t={}){super(e,t),this.label_="subtitles",this.setIcon("subtitles"),["en","en-us","en-ca","fr-ca"].indexOf(this.player_.language_)>-1&&(this.label_="captions",this.setIcon("captions")),this.menuButton_.controlText(Tt(this.label_))}buildCSSClass(){return`vjs-subs-caps-button ${super.buildCSSClass()}`}buildWrapperCSSClass(){return`vjs-subs-caps-button ${super.buildWrapperCSSClass()}`}createItems(){let e=[];return!(this.player().tech_&&this.player().tech_.featuresNativeTextTracks)&&this.player().getChild("textTrackSettings")&&(e.push(new $g(this.player_,{kind:this.label_})),this.hideThreshold_+=1),e=super.createItems(e,g_),e}}Ng.prototype.kinds_=["captions","subtitles"];Ng.prototype.controlText_="Subtitles";ee.registerComponent("SubsCapsButton",Ng);class O_ extends Hl{constructor(e,t){const i=t.track,s=e.audioTracks();t.label=i.label||i.language||"Unknown",t.selected=i.enabled,super(e,t),this.track=i,this.addClass(`vjs-${i.kind}-menu-item`);const n=(...a)=>{this.handleTracksChange.apply(this,a)};s.addEventListener("change",n),this.on("dispose",()=>{s.removeEventListener("change",n)})}createEl(e,t,i){const s=super.createEl(e,t,i),n=s.querySelector(".vjs-menu-item-text");return["main-desc","descriptions"].indexOf(this.options_.track.kind)>=0&&(n.appendChild(Me("span",{className:"vjs-icon-placeholder"},{"aria-hidden":!0})),n.appendChild(Me("span",{className:"vjs-control-text",textContent:" "+this.localize("Descriptions")}))),s}handleClick(e){if(super.handleClick(e),this.track.enabled=!0,this.player_.tech_.featuresNativeAudioTracks){const t=this.player_.audioTracks();for(let i=0;i<t.length;i++){const s=t[i];s!==this.track&&(s.enabled=s===this.track)}}}handleTracksChange(e){this.selected(this.track.enabled)}}ee.registerComponent("AudioTrackMenuItem",O_);class y_ extends Ig{constructor(e,t={}){t.tracks=e.audioTracks(),super(e,t),this.setIcon("audio")}buildCSSClass(){return`vjs-audio-button ${super.buildCSSClass()}`}buildWrapperCSSClass(){return`vjs-audio-button ${super.buildWrapperCSSClass()}`}createItems(e=[]){this.hideThreshold_=1;const t=this.player_.audioTracks();for(let i=0;i<t.length;i++){const s=t[i];e.push(new O_(this.player_,{track:s,selectable:!0,multiSelectable:!1}))}return e}}y_.prototype.controlText_="Audio Track";ee.registerComponent("AudioTrackButton",y_);class Fg extends Hl{constructor(e,t){const i=t.rate,s=parseFloat(i,10);t.label=i,t.selected=s===e.playbackRate(),t.selectable=!0,t.multiSelectable=!1,super(e,t),this.label=i,this.rate=s,this.on(e,"ratechange",n=>this.update(n))}handleClick(e){super.handleClick(),this.player().playbackRate(this.rate)}update(e){this.selected(this.player().playbackRate()===this.rate)}}Fg.prototype.contentElType="button";ee.registerComponent("PlaybackRateMenuItem",Fg);class b_ extends Mg{constructor(e,t){super(e,t),this.menuButton_.el_.setAttribute("aria-describedby",this.labelElId_),this.updateVisibility(),this.updateLabel(),this.on(e,"loadstart",i=>this.updateVisibility(i)),this.on(e,"ratechange",i=>this.updateLabel(i)),this.on(e,"playbackrateschange",i=>this.handlePlaybackRateschange(i))}createEl(){const e=super.createEl();return this.labelElId_="vjs-playback-rate-value-label-"+this.id_,this.labelEl_=Me("div",{className:"vjs-playback-rate-value",id:this.labelElId_,textContent:"1x"}),e.appendChild(this.labelEl_),e}dispose(){this.labelEl_=null,super.dispose()}buildCSSClass(){return`vjs-playback-rate ${super.buildCSSClass()}`}buildWrapperCSSClass(){return`vjs-playback-rate ${super.buildWrapperCSSClass()}`}createItems(){const e=this.playbackRates(),t=[];for(let i=e.length-1;i>=0;i--)t.push(new Fg(this.player(),{rate:e[i]+"x"}));return t}handlePlaybackRateschange(e){this.update()}playbackRates(){const e=this.player();return e.playbackRates&&e.playbackRates()||[]}playbackRateSupported(){return this.player().tech_&&this.player().tech_.featuresPlaybackRate&&this.playbackRates()&&this.playbackRates().length>0}updateVisibility(e){this.playbackRateSupported()?this.removeClass("vjs-hidden"):this.addClass("vjs-hidden")}updateLabel(e){this.playbackRateSupported()&&(this.labelEl_.textContent=this.player().playbackRate()+"x")}}b_.prototype.controlText_="Playback Rate";ee.registerComponent("PlaybackRateMenuButton",b_);class v_ extends ee{buildCSSClass(){return`vjs-spacer ${super.buildCSSClass()}`}createEl(e="div",t={},i={}){return t.className||(t.className=this.buildCSSClass()),super.createEl(e,t,i)}}ee.registerComponent("Spacer",v_);class uQ extends v_{buildCSSClass(){return`vjs-custom-control-spacer ${super.buildCSSClass()}`}createEl(){return super.createEl("div",{className:this.buildCSSClass(),textContent:" "})}}ee.registerComponent("CustomControlSpacer",uQ);class S_ extends ee{createEl(){return super.createEl("div",{className:"vjs-control-bar",dir:"ltr"})}}S_.prototype.options_={children:["playToggle","skipBackward","skipForward","volumePanel","currentTimeDisplay","timeDivider","durationDisplay","progressControl","liveDisplay","seekToLive","remainingTimeDisplay","customControlSpacer","playbackRateMenuButton","chaptersButton","descriptionsButton","subsCapsButton","audioTrackButton","pictureInPictureToggle","fullscreenToggle"]};ee.registerComponent("ControlBar",S_);class T_ extends Ka{constructor(e,t){super(e,t),this.on(e,"error",i=>{this.open(i)})}buildCSSClass(){return`vjs-error-display ${super.buildCSSClass()}`}content(){const e=this.player().error();return e?this.localize(e.message):""}}T_.prototype.options_=Object.assign({},Ka.prototype.options_,{pauseOnOpen:!1,fillAlways:!0,temporary:!1,uncloseable:!0});ee.registerComponent("ErrorDisplay",T_);class __ extends ee{constructor(e,t={}){super(e,t),this.el_.setAttribute("aria-labelledby",this.selectLabelledbyIds)}createEl(){return this.selectLabelledbyIds=[this.options_.legendId,this.options_.labelId].join(" ").trim(),Me("select",{id:this.options_.id},{},this.options_.SelectOptions.map(t=>{const i=(this.options_.labelId?this.options_.labelId:`vjs-track-option-${rr()}`)+"-"+t[1].replace(/\W+/g,""),s=Me("option",{id:i,value:this.localize(t[0]),textContent:this.localize(t[1])});return s.setAttribute("aria-labelledby",`${this.selectLabelledbyIds} ${i}`),s}))}}ee.registerComponent("TextTrackSelect",__);class An extends ee{constructor(e,t={}){super(e,t);const i=Me("legend",{textContent:this.localize(this.options_.legendText),id:this.options_.legendId});this.el().appendChild(i);const s=this.options_.selects;for(const n of s){const a=this.options_.selectConfigs[n],o=a.className,l=a.id.replace("%s",this.options_.id_);let u=null;const c=`vjs_select_${rr()}`;if(this.options_.type==="colors"){u=Me("span",{className:o});const f=Me("label",{id:l,className:"vjs-label",textContent:this.localize(a.label)});f.setAttribute("for",c),u.appendChild(f)}const h=new __(e,{SelectOptions:a.options,legendId:this.options_.legendId,id:c,labelId:l});this.addChild(h),this.options_.type==="colors"&&(u.appendChild(h.el()),this.el().appendChild(u))}}createEl(){return Me("fieldset",{className:this.options_.className})}}ee.registerComponent("TextTrackFieldset",An);class x_ extends ee{constructor(e,t={}){super(e,t);const i=this.options_.textTrackComponentid,s=new An(e,{id_:i,legendId:`captions-text-legend-${i}`,legendText:this.localize("Text"),className:"vjs-fg vjs-track-setting",selects:this.options_.fieldSets[0],selectConfigs:this.options_.selectConfigs,type:"colors"});this.addChild(s);const n=new An(e,{id_:i,legendId:`captions-background-${i}`,legendText:this.localize("Text Background"),className:"vjs-bg vjs-track-setting",selects:this.options_.fieldSets[1],selectConfigs:this.options_.selectConfigs,type:"colors"});this.addChild(n);const a=new An(e,{id_:i,legendId:`captions-window-${i}`,legendText:this.localize("Caption Area Background"),className:"vjs-window vjs-track-setting",selects:this.options_.fieldSets[2],selectConfigs:this.options_.selectConfigs,type:"colors"});this.addChild(a)}createEl(){return Me("div",{className:"vjs-track-settings-colors"})}}ee.registerComponent("TextTrackSettingsColors",x_);class w_ extends ee{constructor(e,t={}){super(e,t);const i=this.options_.textTrackComponentid,s=new An(e,{id_:i,legendId:`captions-font-size-${i}`,legendText:"Font Size",className:"vjs-font-percent vjs-track-setting",selects:this.options_.fieldSets[0],selectConfigs:this.options_.selectConfigs,type:"font"});this.addChild(s);const n=new An(e,{id_:i,legendId:`captions-edge-style-${i}`,legendText:this.localize("Text Edge Style"),className:"vjs-edge-style vjs-track-setting",selects:this.options_.fieldSets[1],selectConfigs:this.options_.selectConfigs,type:"font"});this.addChild(n);const a=new An(e,{id_:i,legendId:`captions-font-family-${i}`,legendText:this.localize("Font Family"),className:"vjs-font-family vjs-track-setting",selects:this.options_.fieldSets[2],selectConfigs:this.options_.selectConfigs,type:"font"});this.addChild(a)}createEl(){return Me("div",{className:"vjs-track-settings-font"})}}ee.registerComponent("TextTrackSettingsFont",w_);class C_ extends ee{constructor(e,t={}){super(e,t);const i=new ai(e,{controlText:this.localize("restore all settings to the default values"),className:"vjs-default-button"});i.el().classList.remove("vjs-control","vjs-button"),i.el().textContent=this.localize("Reset"),this.addChild(i);const s=this.localize("Done"),n=new ai(e,{controlText:s,className:"vjs-done-button"});n.el().classList.remove("vjs-control","vjs-button"),n.el().textContent=s,this.addChild(n)}createEl(){return Me("div",{className:"vjs-track-settings-controls"})}}ee.registerComponent("TrackSettingsControls",C_);const uf="vjs-text-track-settings",jy=["#000","Black"],zy=["#00F","Blue"],Zy=["#0FF","Cyan"],Wy=["#0F0","Green"],Hy=["#F0F","Magenta"],Yy=["#F00","Red"],Gy=["#FFF","White"],Ky=["#FF0","Yellow"],cf=["1","Opaque"],hf=["0.5","Semi-Transparent"],Jy=["0","Transparent"],Qs={backgroundColor:{selector:".vjs-bg-color > select",id:"captions-background-color-%s",label:"Color",options:[jy,Gy,Yy,Wy,zy,Ky,Hy,Zy],className:"vjs-bg-color"},backgroundOpacity:{selector:".vjs-bg-opacity > select",id:"captions-background-opacity-%s",label:"Opacity",options:[cf,hf,Jy],className:"vjs-bg-opacity vjs-opacity"},color:{selector:".vjs-text-color > select",id:"captions-foreground-color-%s",label:"Color",options:[Gy,jy,Yy,Wy,zy,Ky,Hy,Zy],className:"vjs-text-color"},edgeStyle:{selector:".vjs-edge-style > select",id:"",label:"Text Edge Style",options:[["none","None"],["raised","Raised"],["depressed","Depressed"],["uniform","Uniform"],["dropshadow","Drop shadow"]]},fontFamily:{selector:".vjs-font-family > select",id:"",label:"Font Family",options:[["proportionalSansSerif","Proportional Sans-Serif"],["monospaceSansSerif","Monospace Sans-Serif"],["proportionalSerif","Proportional Serif"],["monospaceSerif","Monospace Serif"],["casual","Casual"],["script","Script"],["small-caps","Small Caps"]]},fontPercent:{selector:".vjs-font-percent > select",id:"",label:"Font Size",options:[["0.50","50%"],["0.75","75%"],["1.00","100%"],["1.25","125%"],["1.50","150%"],["1.75","175%"],["2.00","200%"],["3.00","300%"],["4.00","400%"]],default:2,parser:r=>r==="1.00"?null:Number(r)},textOpacity:{selector:".vjs-text-opacity > select",id:"captions-foreground-opacity-%s",label:"Opacity",options:[cf,hf],className:"vjs-text-opacity vjs-opacity"},windowColor:{selector:".vjs-window-color > select",id:"captions-window-color-%s",label:"Color",className:"vjs-window-color"},windowOpacity:{selector:".vjs-window-opacity > select",id:"captions-window-opacity-%s",label:"Opacity",options:[Jy,hf,cf],className:"vjs-window-opacity vjs-opacity"}};Qs.windowColor.options=Qs.backgroundColor.options;function k_(r,e){if(e&&(r=e(r)),r&&r!=="none")return r}function cQ(r,e){const t=r.options[r.options.selectedIndex].value;return k_(t,e)}function hQ(r,e,t){if(e){for(let i=0;i<r.options.length;i++)if(k_(r.options[i].value,t)===e){r.selectedIndex=i;break}}}class dQ extends Ka{constructor(e,t){t.temporary=!1,super(e,t),this.updateDisplay=this.updateDisplay.bind(this),this.fill(),this.hasBeenOpened_=this.hasBeenFilled_=!0,this.renderModalComponents(e),this.endDialog=Me("p",{className:"vjs-control-text",textContent:this.localize("End of dialog window.")}),this.el().appendChild(this.endDialog),this.setDefaults(),t.persistTextTrackSettings===void 0&&(this.options_.persistTextTrackSettings=this.options_.playerOptions.persistTextTrackSettings),this.bindFunctionsToSelectsAndButtons(),this.options_.persistTextTrackSettings&&this.restoreSettings()}renderModalComponents(e){const t=new x_(e,{textTrackComponentid:this.id_,selectConfigs:Qs,fieldSets:[["color","textOpacity"],["backgroundColor","backgroundOpacity"],["windowColor","windowOpacity"]]});this.addChild(t);const i=new w_(e,{textTrackComponentid:this.id_,selectConfigs:Qs,fieldSets:[["fontPercent"],["edgeStyle"],["fontFamily"]]});this.addChild(i);const s=new C_(e);this.addChild(s)}bindFunctionsToSelectsAndButtons(){this.on(this.$(".vjs-done-button"),["click","tap"],()=>{this.saveSettings(),this.close()}),this.on(this.$(".vjs-default-button"),["click","tap"],()=>{this.setDefaults(),this.updateDisplay()}),ca(Qs,e=>{this.on(this.$(e.selector),"change",this.updateDisplay)})}dispose(){this.endDialog=null,super.dispose()}label(){return this.localize("Caption Settings Dialog")}description(){return this.localize("Beginning of dialog window. Escape will cancel and close the window.")}buildCSSClass(){return super.buildCSSClass()+" vjs-text-track-settings"}getValues(){return gT(Qs,(e,t,i)=>{const s=cQ(this.$(t.selector),t.parser);return s!==void 0&&(e[i]=s),e},{})}setValues(e){ca(Qs,(t,i)=>{hQ(this.$(t.selector),e[i],t.parser)})}setDefaults(){ca(Qs,e=>{const t=e.hasOwnProperty("default")?e.default:0;this.$(e.selector).selectedIndex=t})}restoreSettings(){let e;try{e=JSON.parse(U.localStorage.getItem(uf))}catch(t){Be.warn(t)}e&&this.setValues(e)}saveSettings(){if(!this.options_.persistTextTrackSettings)return;const e=this.getValues();try{Object.keys(e).length?U.localStorage.setItem(uf,JSON.stringify(e)):U.localStorage.removeItem(uf)}catch(t){Be.warn(t)}}updateDisplay(){const e=this.player_.getChild("textTrackDisplay");e&&e.updateDisplay()}handleLanguagechange(){this.fill(),this.renderModalComponents(this.player_),this.bindFunctionsToSelectsAndButtons()}}ee.registerComponent("TextTrackSettings",dQ);class fQ extends ee{constructor(e,t){let i=t.ResizeObserver||U.ResizeObserver;t.ResizeObserver===null&&(i=!1);const s=Je({createEl:!i,reportTouchActivity:!1},t);super(e,s),this.ResizeObserver=t.ResizeObserver||U.ResizeObserver,this.loadListener_=null,this.resizeObserver_=null,this.debouncedHandler_=NT(()=>{this.resizeHandler()},100,!1,this),i?(this.resizeObserver_=new this.ResizeObserver(this.debouncedHandler_),this.resizeObserver_.observe(e.el())):(this.loadListener_=()=>{if(!this.el_||!this.el_.contentWindow)return;const n=this.debouncedHandler_;let a=this.unloadListener_=function(){ni(this,"resize",n),ni(this,"unload",a),a=null};Ui(this.el_.contentWindow,"unload",a),Ui(this.el_.contentWindow,"resize",n)},this.one("load",this.loadListener_))}createEl(){return super.createEl("iframe",{className:"vjs-resize-manager",tabIndex:-1,title:this.localize("No content")},{"aria-hidden":"true"})}resizeHandler(){!this.player_||!this.player_.trigger||this.player_.trigger("playerresize")}dispose(){this.debouncedHandler_&&this.debouncedHandler_.cancel(),this.resizeObserver_&&(this.player_.el()&&this.resizeObserver_.unobserve(this.player_.el()),this.resizeObserver_.disconnect()),this.loadListener_&&this.off("load",this.loadListener_),this.el_&&this.el_.contentWindow&&this.unloadListener_&&this.unloadListener_.call(this.el_.contentWindow),this.ResizeObserver=null,this.resizeObserver=null,this.debouncedHandler_=null,this.loadListener_=null,super.dispose()}}ee.registerComponent("ResizeManager",fQ);const pQ={trackingThreshold:20,liveTolerance:15};class mQ extends ee{constructor(e,t){const i=Je(pQ,t,{createEl:!1});super(e,i),this.trackLiveHandler_=()=>this.trackLive_(),this.handlePlay_=s=>this.handlePlay(s),this.handleFirstTimeupdate_=s=>this.handleFirstTimeupdate(s),this.handleSeeked_=s=>this.handleSeeked(s),this.seekToLiveEdge_=s=>this.seekToLiveEdge(s),this.reset_(),this.on(this.player_,"durationchange",s=>this.handleDurationchange(s)),this.on(this.player_,"canplay",()=>this.toggleTracking())}trackLive_(){const e=this.player_.seekable();if(!e||!e.length)return;const t=Number(U.performance.now().toFixed(4)),i=this.lastTime_===-1?0:(t-this.lastTime_)/1e3;this.lastTime_=t,this.pastSeekEnd_=this.pastSeekEnd()+i;const s=this.liveCurrentTime(),n=this.player_.currentTime();let a=this.player_.paused()||this.seekedBehindLive_||Math.abs(s-n)>this.options_.liveTolerance;(!this.timeupdateSeen_||s===1/0)&&(a=!1),a!==this.behindLiveEdge_&&(this.behindLiveEdge_=a,this.trigger("liveedgechange"))}handleDurationchange(){this.toggleTracking()}toggleTracking(){this.player_.duration()===1/0&&this.liveWindow()>=this.options_.trackingThreshold?(this.player_.options_.liveui&&this.player_.addClass("vjs-liveui"),this.startTracking()):(this.player_.removeClass("vjs-liveui"),this.stopTracking())}startTracking(){this.isTracking()||(this.timeupdateSeen_||(this.timeupdateSeen_=this.player_.hasStarted()),this.trackingInterval_=this.setInterval(this.trackLiveHandler_,sr),this.trackLive_(),this.on(this.player_,["play","pause"],this.trackLiveHandler_),this.timeupdateSeen_?this.on(this.player_,"seeked",this.handleSeeked_):(this.one(this.player_,"play",this.handlePlay_),this.one(this.player_,"timeupdate",this.handleFirstTimeupdate_)))}handleFirstTimeupdate(){this.timeupdateSeen_=!0,this.on(this.player_,"seeked",this.handleSeeked_)}handleSeeked(){const e=Math.abs(this.liveCurrentTime()-this.player_.currentTime());this.seekedBehindLive_=this.nextSeekedFromUser_&&e>2,this.nextSeekedFromUser_=!1,this.trackLive_()}handlePlay(){this.one(this.player_,"timeupdate",this.seekToLiveEdge_)}reset_(){this.lastTime_=-1,this.pastSeekEnd_=0,this.lastSeekEnd_=-1,this.behindLiveEdge_=!0,this.timeupdateSeen_=!1,this.seekedBehindLive_=!1,this.nextSeekedFromUser_=!1,this.clearInterval(this.trackingInterval_),this.trackingInterval_=null,this.off(this.player_,["play","pause"],this.trackLiveHandler_),this.off(this.player_,"seeked",this.handleSeeked_),this.off(this.player_,"play",this.handlePlay_),this.off(this.player_,"timeupdate",this.handleFirstTimeupdate_),this.off(this.player_,"timeupdate",this.seekToLiveEdge_)}nextSeekedFromUser(){this.nextSeekedFromUser_=!0}stopTracking(){this.isTracking()&&(this.reset_(),this.trigger("liveedgechange"))}seekableEnd(){const e=this.player_.seekable(),t=[];let i=e?e.length:0;for(;i--;)t.push(e.end(i));return t.length?t.sort()[t.length-1]:1/0}seekableStart(){const e=this.player_.seekable(),t=[];let i=e?e.length:0;for(;i--;)t.push(e.start(i));return t.length?t.sort()[0]:0}liveWindow(){const e=this.liveCurrentTime();return e===1/0?0:e-this.seekableStart()}isLive(){return this.isTracking()}atLiveEdge(){return!this.behindLiveEdge()}liveCurrentTime(){return this.pastSeekEnd()+this.seekableEnd()}pastSeekEnd(){const e=this.seekableEnd();return this.lastSeekEnd_!==-1&&e!==this.lastSeekEnd_&&(this.pastSeekEnd_=0),this.lastSeekEnd_=e,this.pastSeekEnd_}behindLiveEdge(){return this.behindLiveEdge_}isTracking(){return typeof this.trackingInterval_=="number"}seekToLiveEdge(){this.seekedBehindLive_=!1,!this.atLiveEdge()&&(this.nextSeekedFromUser_=!1,this.player_.currentTime(this.liveCurrentTime()))}dispose(){this.stopTracking(),super.dispose()}}ee.registerComponent("LiveTracker",mQ);class gQ extends ee{constructor(e,t){super(e,t),this.on("statechanged",i=>this.updateDom_()),this.updateDom_()}createEl(){return this.els={title:Me("div",{className:"vjs-title-bar-title",id:`vjs-title-bar-title-${rr()}`}),description:Me("div",{className:"vjs-title-bar-description",id:`vjs-title-bar-description-${rr()}`})},Me("div",{className:"vjs-title-bar"},{},OT(this.els))}updateDom_(){const e=this.player_.tech_,t=e&&e.el_,i={title:"aria-labelledby",description:"aria-describedby"};["title","description"].forEach(s=>{const n=this.state[s],a=this.els[s],o=i[s];Yh(a),n&&Js(a,n),t&&(t.removeAttribute(o),n&&t.setAttribute(o,a.id))}),this.state.title||this.state.description?this.show():this.hide()}update(e){this.setState(e)}dispose(){const e=this.player_.tech_,t=e&&e.el_;t&&(t.removeAttribute("aria-labelledby"),t.removeAttribute("aria-describedby")),super.dispose(),this.els=null}}ee.registerComponent("TitleBar",gQ);const OQ={initialDisplay:4e3,position:[],takeFocus:!1};class yQ extends ai{constructor(e,t){t=Je(OQ,t),super(e,t),this.controlText(t.controlText),this.hide(),this.on(this.player_,["useractive","userinactive"],i=>{this.removeClass("force-display")})}buildCSSClass(){return`vjs-transient-button focus-visible ${this.options_.position.map(e=>`vjs-${e}`).join(" ")}`}createEl(){const e=Me("button",{},{type:"button",class:this.buildCSSClass()},Me("span"));return this.controlTextEl_=e.querySelector("span"),e}show(){super.show(),this.addClass("force-display"),this.options_.takeFocus&&this.el().focus({preventScroll:!0}),this.forceDisplayTimeout=this.player_.setTimeout(()=>{this.removeClass("force-display")},this.options_.initialDisplay)}hide(){this.removeClass("force-display"),super.hide()}dispose(){this.player_.clearTimeout(this.forceDisplayTimeout),super.dispose()}}ee.registerComponent("TransientButton",yQ);const Cp=r=>{const e=r.el();if(e.hasAttribute("src"))return r.triggerSourceset(e.src),!0;const t=r.$$("source"),i=[];let s="";if(!t.length)return!1;for(let n=0;n<t.length;n++){const a=t[n].src;a&&i.indexOf(a)===-1&&i.push(a)}return i.length?(i.length===1&&(s=i[0]),r.triggerSourceset(s),!0):!1},bQ=Object.defineProperty({},"innerHTML",{get(){return this.cloneNode(!0).innerHTML},set(r){const e=ue.createElement(this.nodeName.toLowerCase());e.innerHTML=r;const t=ue.createDocumentFragment();for(;e.childNodes.length;)t.appendChild(e.childNodes[0]);return this.innerText="",U.Element.prototype.appendChild.call(this,t),this.innerHTML}}),E_=(r,e)=>{let t={};for(let i=0;i<r.length&&(t=Object.getOwnPropertyDescriptor(r[i],e),!(t&&t.set&&t.get));i++);return t.enumerable=!0,t.configurable=!0,t},vQ=r=>E_([r.el(),U.HTMLMediaElement.prototype,U.Element.prototype,bQ],"innerHTML"),eb=function(r){const e=r.el();if(e.resetSourceWatch_)return;const t={},i=vQ(r),s=n=>(...a)=>{const o=n.apply(e,a);return Cp(r),o};["append","appendChild","insertAdjacentHTML"].forEach(n=>{e[n]&&(t[n]=e[n],e[n]=s(t[n]))}),Object.defineProperty(e,"innerHTML",Je(i,{set:s(i.set)})),e.resetSourceWatch_=()=>{e.resetSourceWatch_=null,Object.keys(t).forEach(n=>{e[n]=t[n]}),Object.defineProperty(e,"innerHTML",i)},r.one("sourceset",e.resetSourceWatch_)},SQ=Object.defineProperty({},"src",{get(){return this.hasAttribute("src")?YT(U.Element.prototype.getAttribute.call(this,"src")):""},set(r){return U.Element.prototype.setAttribute.call(this,"src",r),r}}),TQ=r=>E_([r.el(),U.HTMLMediaElement.prototype,SQ],"src"),_Q=function(r){if(!r.featuresSourceset)return;const e=r.el();if(e.resetSourceset_)return;const t=TQ(r),i=e.setAttribute,s=e.load;Object.defineProperty(e,"src",Je(t,{set:n=>{const a=t.set.call(e,n);return r.triggerSourceset(e.src),a}})),e.setAttribute=(n,a)=>{const o=i.call(e,n,a);return/src/i.test(n)&&r.triggerSourceset(e.src),o},e.load=()=>{const n=s.call(e);return Cp(r)||(r.triggerSourceset(""),eb(r)),n},e.currentSrc?r.triggerSourceset(e.currentSrc):Cp(r)||eb(r),e.resetSourceset_=()=>{e.resetSourceset_=null,e.load=s,e.setAttribute=i,Object.defineProperty(e,"src",t),e.resetSourceWatch_&&e.resetSourceWatch_()}};class ye extends Le{constructor(e,t){super(e,t);const i=e.source;let s=!1;if(this.featuresVideoFrameCallback=this.featuresVideoFrameCallback&&this.el_.tagName==="VIDEO",i&&(this.el_.currentSrc!==i.src||e.tag&&e.tag.initNetworkState_===3)?this.setSource(i):this.handleLateInit_(this.el_),e.enableSourceset&&this.setupSourcesetHandling_(),this.isScrubbing_=!1,this.el_.hasChildNodes()){const n=this.el_.childNodes;let a=n.length;const o=[];for(;a--;){const l=n[a];l.nodeName.toLowerCase()==="track"&&(this.featuresNativeTextTracks?(this.remoteTextTrackEls().addTrackElement_(l),this.remoteTextTracks().addTrack(l.track),this.textTracks().addTrack(l.track),!s&&!this.el_.hasAttribute("crossorigin")&&ed(l.src)&&(s=!0)):o.push(l))}for(let l=0;l<o.length;l++)this.el_.removeChild(o[l])}this.proxyNativeTracks_(),this.featuresNativeTextTracks&&s&&Be.warn(`Text Tracks are being loaded from another origin but the crossorigin attribute isn't used.
This may prevent text tracks from loading.`),this.restoreMetadataTracksInIOSNativePlayer_(),(fl||jh)&&e.nativeControlsForTouch===!0&&this.setControls(!0),this.proxyWebkitFullscreen_(),this.triggerReady()}dispose(){this.el_&&this.el_.resetSourceset_&&this.el_.resetSourceset_(),ye.disposeMediaElement(this.el_),this.options_=null,super.dispose()}setupSourcesetHandling_(){_Q(this)}restoreMetadataTracksInIOSNativePlayer_(){const e=this.textTracks();let t;const i=()=>{t=[];for(let n=0;n<e.length;n++){const a=e[n];a.kind==="metadata"&&t.push({track:a,storedMode:a.mode})}};i(),e.addEventListener("change",i),this.on("dispose",()=>e.removeEventListener("change",i));const s=()=>{for(let n=0;n<t.length;n++){const a=t[n];a.track.mode==="disabled"&&a.track.mode!==a.storedMode&&(a.track.mode=a.storedMode)}e.removeEventListener("change",s)};this.on("webkitbeginfullscreen",()=>{e.removeEventListener("change",i),e.removeEventListener("change",s),e.addEventListener("change",s)}),this.on("webkitendfullscreen",()=>{e.removeEventListener("change",i),e.addEventListener("change",i),e.removeEventListener("change",s)})}overrideNative_(e,t){if(t!==this[`featuresNative${e}Tracks`])return;const i=e.toLowerCase();this[`${i}TracksListeners_`]&&Object.keys(this[`${i}TracksListeners_`]).forEach(s=>{this.el()[`${i}Tracks`].removeEventListener(s,this[`${i}TracksListeners_`][s])}),this[`featuresNative${e}Tracks`]=!t,this[`${i}TracksListeners_`]=null,this.proxyNativeTracksForType_(i)}overrideNativeAudioTracks(e){this.overrideNative_("Audio",e)}overrideNativeVideoTracks(e){this.overrideNative_("Video",e)}proxyNativeTracksForType_(e){const t=tr[e],i=this.el()[t.getterName],s=this[t.getterName]();if(!this[`featuresNative${t.capitalName}Tracks`]||!i||!i.addEventListener)return;const n={change:o=>{const l={type:"change",target:s,currentTarget:s,srcElement:s};s.trigger(l),e==="text"&&this[La.remoteText.getterName]().trigger(l)},addtrack(o){s.addTrack(o.track)},removetrack(o){s.removeTrack(o.track)}},a=function(){const o=[];for(let l=0;l<s.length;l++){let u=!1;for(let c=0;c<i.length;c++)if(i[c]===s[l]){u=!0;break}u||o.push(s[l])}for(;o.length;)s.removeTrack(o.shift())};this[t.getterName+"Listeners_"]=n,Object.keys(n).forEach(o=>{const l=n[o];i.addEventListener(o,l),this.on("dispose",u=>i.removeEventListener(o,l))}),this.on("loadstart",a),this.on("dispose",o=>this.off("loadstart",a))}proxyNativeTracks_(){tr.names.forEach(e=>{this.proxyNativeTracksForType_(e)})}createEl(){let e=this.options_.tag;if(!e||!(this.options_.playerElIngest||this.movingMediaElementInDOM)){if(e){const i=e.cloneNode(!0);e.parentNode&&e.parentNode.insertBefore(i,e),ye.disposeMediaElement(e),e=i}else{e=ue.createElement("video");const i=this.options_.tag&&Ls(this.options_.tag),s=Je({},i);(!fl||this.options_.nativeControlsForTouch!==!0)&&delete s.controls,CT(e,Object.assign(s,{id:this.options_.techId,class:"vjs-tech"}))}e.playerId=this.options_.playerId}typeof this.options_.preload<"u"&&Ma(e,"preload",this.options_.preload),this.options_.disablePictureInPicture!==void 0&&(e.disablePictureInPicture=this.options_.disablePictureInPicture);const t=["loop","muted","playsinline","autoplay"];for(let i=0;i<t.length;i++){const s=t[i],n=this.options_[s];typeof n<"u"&&(n?Ma(e,s,s):Wh(e,s),e[s]=n)}return e}handleLateInit_(e){if(e.networkState===0||e.networkState===3)return;if(e.readyState===0){let i=!1;const s=function(){i=!0};this.on("loadstart",s);const n=function(){i||this.trigger("loadstart")};this.on("loadedmetadata",n),this.ready(function(){this.off("loadstart",s),this.off("loadedmetadata",n),i||this.trigger("loadstart")});return}const t=["loadstart"];t.push("loadedmetadata"),e.readyState>=2&&t.push("loadeddata"),e.readyState>=3&&t.push("canplay"),e.readyState>=4&&t.push("canplaythrough"),this.ready(function(){t.forEach(function(i){this.trigger(i)},this)})}setScrubbing(e){this.isScrubbing_=e}scrubbing(){return this.isScrubbing_}setCurrentTime(e){try{this.isScrubbing_&&this.el_.fastSeek&&zh?this.el_.fastSeek(e):this.el_.currentTime=e}catch(t){Be(t,"Video is not ready. (Video.js)")}}duration(){if(this.el_.duration===1/0&&Or&&Wr&&this.el_.currentTime===0){const e=()=>{this.el_.currentTime>0&&(this.el_.duration===1/0&&this.trigger("durationchange"),this.off("timeupdate",e))};return this.on("timeupdate",e),NaN}return this.el_.duration||NaN}width(){return this.el_.offsetWidth}height(){return this.el_.offsetHeight}proxyWebkitFullscreen_(){if(!("webkitDisplayingFullscreen"in this.el_))return;const e=function(){this.trigger("fullscreenchange",{isFullscreen:!1}),this.el_.controls&&!this.options_.nativeControlsForTouch&&this.controls()&&(this.el_.controls=!1)},t=function(){"webkitPresentationMode"in this.el_&&this.el_.webkitPresentationMode!=="picture-in-picture"&&(this.one("webkitendfullscreen",e),this.trigger("fullscreenchange",{isFullscreen:!0,nativeIOSFullscreen:!0}))};this.on("webkitbeginfullscreen",t),this.on("dispose",()=>{this.off("webkitbeginfullscreen",t),this.off("webkitendfullscreen",e)})}supportsFullScreen(){return typeof this.el_.webkitEnterFullScreen=="function"}enterFullScreen(){const e=this.el_;if(e.paused&&e.networkState<=e.HAVE_METADATA)Br(this.el_.play()),this.setTimeout(function(){e.pause();try{e.webkitEnterFullScreen()}catch(t){this.trigger("fullscreenerror",t)}},0);else try{e.webkitEnterFullScreen()}catch(t){this.trigger("fullscreenerror",t)}}exitFullScreen(){if(!this.el_.webkitDisplayingFullscreen){this.trigger("fullscreenerror",new Error("The video is not fullscreen"));return}this.el_.webkitExitFullScreen()}requestPictureInPicture(){return this.el_.requestPictureInPicture()}requestVideoFrameCallback(e){return this.featuresVideoFrameCallback&&!this.el_.webkitKeys?this.el_.requestVideoFrameCallback(e):super.requestVideoFrameCallback(e)}cancelVideoFrameCallback(e){this.featuresVideoFrameCallback&&!this.el_.webkitKeys?this.el_.cancelVideoFrameCallback(e):super.cancelVideoFrameCallback(e)}src(e){if(e===void 0)return this.el_.src;this.setSrc(e)}addSourceElement(e,t){if(!e)return Be.error("Invalid source URL."),!1;const i={src:e};t&&(i.type=t);const s=Me("source",{},i);return this.el_.appendChild(s),!0}removeSourceElement(e){if(!e)return Be.error("Source URL is required to remove the source element."),!1;const t=this.el_.querySelectorAll("source");for(const i of t)if(i.src===e)return this.el_.removeChild(i),!0;return Be.warn(`No matching source element found with src: ${e}`),!1}reset(){ye.resetMediaElement(this.el_)}currentSrc(){return this.currentSource_?this.currentSource_.src:this.el_.currentSrc}setControls(e){this.el_.controls=!!e}addTextTrack(e,t,i){return this.featuresNativeTextTracks?this.el_.addTextTrack(e,t,i):super.addTextTrack(e,t,i)}createRemoteTextTrack(e){if(!this.featuresNativeTextTracks)return super.createRemoteTextTrack(e);const t=ue.createElement("track");return e.kind&&(t.kind=e.kind),e.label&&(t.label=e.label),(e.language||e.srclang)&&(t.srclang=e.language||e.srclang),e.default&&(t.default=e.default),e.id&&(t.id=e.id),e.src&&(t.src=e.src),t}addRemoteTextTrack(e,t){const i=super.addRemoteTextTrack(e,t);return this.featuresNativeTextTracks&&this.el().appendChild(i),i}removeRemoteTextTrack(e){if(super.removeRemoteTextTrack(e),this.featuresNativeTextTracks){const t=this.$$("track");let i=t.length;for(;i--;)(e===t[i]||e===t[i].track)&&this.el().removeChild(t[i])}}getVideoPlaybackQuality(){if(typeof this.el().getVideoPlaybackQuality=="function")return this.el().getVideoPlaybackQuality();const e={};return typeof this.el().webkitDroppedFrameCount<"u"&&typeof this.el().webkitDecodedFrameCount<"u"&&(e.droppedVideoFrames=this.el().webkitDroppedFrameCount,e.totalVideoFrames=this.el().webkitDecodedFrameCount),U.performance&&(e.creationTime=U.performance.now()),e}}qh(ye,"TEST_VID",function(){if(!Ha())return;const r=ue.createElement("video"),e=ue.createElement("track");return e.kind="captions",e.srclang="en",e.label="English",r.appendChild(e),r});ye.isSupported=function(){try{ye.TEST_VID.volume=.5}catch{return!1}return!!(ye.TEST_VID&&ye.TEST_VID.canPlayType)};ye.canPlayType=function(r){return ye.TEST_VID.canPlayType(r)};ye.canPlaySource=function(r,e){return ye.canPlayType(r.type)};ye.canControlVolume=function(){try{const r=ye.TEST_VID.volume;ye.TEST_VID.volume=r/2+.1;const e=r!==ye.TEST_VID.volume;return e&&si?(U.setTimeout(()=>{ye&&ye.prototype&&(ye.prototype.featuresVolumeControl=r!==ye.TEST_VID.volume)}),!1):e}catch{return!1}};ye.canMuteVolume=function(){try{const r=ye.TEST_VID.muted;return ye.TEST_VID.muted=!r,ye.TEST_VID.muted?Ma(ye.TEST_VID,"muted","muted"):Wh(ye.TEST_VID,"muted","muted"),r!==ye.TEST_VID.muted}catch{return!1}};ye.canControlPlaybackRate=function(){if(Or&&Wr&&Vh<58)return!1;try{const r=ye.TEST_VID.playbackRate;return ye.TEST_VID.playbackRate=r/2+.1,r!==ye.TEST_VID.playbackRate}catch{return!1}};ye.canOverrideAttributes=function(){try{const r=()=>{};Object.defineProperty(ue.createElement("video"),"src",{get:r,set:r}),Object.defineProperty(ue.createElement("audio"),"src",{get:r,set:r}),Object.defineProperty(ue.createElement("video"),"innerHTML",{get:r,set:r}),Object.defineProperty(ue.createElement("audio"),"innerHTML",{get:r,set:r})}catch{return!1}return!0};ye.supportsNativeTextTracks=function(){return zh||si&&Wr};ye.supportsNativeVideoTracks=function(){return!!(ye.TEST_VID&&ye.TEST_VID.videoTracks)};ye.supportsNativeAudioTracks=function(){return!!(ye.TEST_VID&&ye.TEST_VID.audioTracks)};ye.Events=["loadstart","suspend","abort","error","emptied","stalled","loadedmetadata","loadeddata","canplay","canplaythrough","playing","waiting","seeking","seeked","ended","durationchange","timeupdate","progress","play","pause","ratechange","resize","volumechange"];[["featuresMuteControl","canMuteVolume"],["featuresPlaybackRate","canControlPlaybackRate"],["featuresSourceset","canOverrideAttributes"],["featuresNativeTextTracks","supportsNativeTextTracks"],["featuresNativeVideoTracks","supportsNativeVideoTracks"],["featuresNativeAudioTracks","supportsNativeAudioTracks"]].forEach(function([r,e]){qh(ye.prototype,r,()=>ye[e](),!0)});ye.prototype.featuresVolumeControl=ye.canControlVolume();ye.prototype.movingMediaElementInDOM=!si;ye.prototype.featuresFullscreenResize=!0;ye.prototype.featuresProgressEvents=!0;ye.prototype.featuresTimeupdateEvents=!0;ye.prototype.featuresVideoFrameCallback=!!(ye.TEST_VID&&ye.TEST_VID.requestVideoFrameCallback);ye.disposeMediaElement=function(r){if(r){for(r.parentNode&&r.parentNode.removeChild(r);r.hasChildNodes();)r.removeChild(r.firstChild);r.removeAttribute("src"),typeof r.load=="function"&&(function(){try{r.load()}catch{}})()}};ye.resetMediaElement=function(r){if(!r)return;const e=r.querySelectorAll("source");let t=e.length;for(;t--;)r.removeChild(e[t]);r.removeAttribute("src"),typeof r.load=="function"&&(function(){try{r.load()}catch{}})()};["muted","defaultMuted","autoplay","controls","loop","playsinline"].forEach(function(r){ye.prototype[r]=function(){return this.el_[r]||this.el_.hasAttribute(r)}});["muted","defaultMuted","autoplay","loop","playsinline"].forEach(function(r){ye.prototype["set"+Tt(r)]=function(e){this.el_[r]=e,e?this.el_.setAttribute(r,r):this.el_.removeAttribute(r)}});["paused","currentTime","buffered","volume","poster","preload","error","seeking","seekable","ended","playbackRate","defaultPlaybackRate","disablePictureInPicture","played","networkState","readyState","videoWidth","videoHeight","crossOrigin"].forEach(function(r){ye.prototype[r]=function(){return this.el_[r]}});["volume","src","poster","preload","playbackRate","defaultPlaybackRate","disablePictureInPicture","crossOrigin"].forEach(function(r){ye.prototype["set"+Tt(r)]=function(e){this.el_[r]=e}});["pause","load","play"].forEach(function(r){ye.prototype[r]=function(){return this.el_[r]()}});Le.withSourceHandlers(ye);ye.nativeSourceHandler={};ye.nativeSourceHandler.canPlayType=function(r){try{return ye.TEST_VID.canPlayType(r)}catch{return""}};ye.nativeSourceHandler.canHandleSource=function(r,e){if(r.type)return ye.nativeSourceHandler.canPlayType(r.type);if(r.src){const t=wg(r.src);return ye.nativeSourceHandler.canPlayType(`video/${t}`)}return""};ye.nativeSourceHandler.handleSource=function(r,e,t){e.setSrc(r.src)};ye.nativeSourceHandler.dispose=function(){};ye.registerSourceHandler(ye.nativeSourceHandler);Le.registerTech("Html5",ye);const A_=["progress","abort","suspend","emptied","stalled","loadedmetadata","loadeddata","timeupdate","resize","volumechange","texttrackchange"],df={canplay:"CanPlay",canplaythrough:"CanPlayThrough",playing:"Playing",seeked:"Seeked"},kp=["tiny","xsmall","small","medium","large","xlarge","huge"],gc={};kp.forEach(r=>{const e=r.charAt(0)==="x"?`x-${r.substring(1)}`:r;gc[r]=`vjs-layout-${e}`});const xQ={tiny:210,xsmall:320,small:425,medium:768,large:1440,xlarge:2560,huge:1/0};class Ze extends ee{constructor(e,t,i){if(e.id=e.id||t.id||`vjs_video_${rr()}`,t=Object.assign(Ze.getTagSettings(e),t),t.initChildren=!1,t.createEl=!1,t.evented=!1,t.reportTouchActivity=!1,!t.language){const a=e.closest("[lang]");a&&(t.language=a.getAttribute("lang"))}if(super(null,t,i),this.boundDocumentFullscreenChange_=a=>this.documentFullscreenChange_(a),this.boundFullWindowOnEscKey_=a=>this.fullWindowOnEscKey(a),this.boundUpdateStyleEl_=a=>this.updateStyleEl_(a),this.boundApplyInitTime_=a=>this.applyInitTime_(a),this.boundUpdateCurrentBreakpoint_=a=>this.updateCurrentBreakpoint_(a),this.boundHandleTechClick_=a=>this.handleTechClick_(a),this.boundHandleTechDoubleClick_=a=>this.handleTechDoubleClick_(a),this.boundHandleTechTouchStart_=a=>this.handleTechTouchStart_(a),this.boundHandleTechTouchMove_=a=>this.handleTechTouchMove_(a),this.boundHandleTechTouchEnd_=a=>this.handleTechTouchEnd_(a),this.boundHandleTechTap_=a=>this.handleTechTap_(a),this.boundUpdatePlayerHeightOnAudioOnlyMode_=a=>this.updatePlayerHeightOnAudioOnlyMode_(a),this.isFullscreen_=!1,this.log=pT(this.id_),this.fsApi_=Bc,this.isPosterFromTech_=!1,this.queuedCallbacks_=[],this.isReady_=!1,this.hasStarted_=!1,this.userActive_=!1,this.debugEnabled_=!1,this.audioOnlyMode_=!1,this.audioPosterMode_=!1,this.audioOnlyCache_={controlBarHeight:null,playerHeight:null,hiddenChildren:[]},!this.options_||!this.options_.techOrder||!this.options_.techOrder.length)throw new Error("No techOrder specified. Did you overwrite videojs.options instead of just changing the properties you want to override?");if(this.tag=e,this.tagAttributes=e&&Ls(e),this.language(this.options_.language),t.languages){const a={};Object.getOwnPropertyNames(t.languages).forEach(function(o){a[o.toLowerCase()]=t.languages[o]}),this.languages_=a}else this.languages_=Ze.prototype.options_.languages;this.resetCache_(),this.poster_=t.poster||"",this.controls_=!!t.controls,e.controls=!1,e.removeAttribute("controls"),this.changingSrc_=!1,this.playCallbacks_=[],this.playTerminatedQueue_=[],e.hasAttribute("autoplay")?this.autoplay(!0):this.autoplay(this.options_.autoplay),t.plugins&&Object.keys(t.plugins).forEach(a=>{if(typeof this[a]!="function")throw new Error(`plugin "${a}" does not exist`)}),this.scrubbing_=!1,this.el_=this.createEl(),vg(this,{eventBusKey:"el_"}),this.fsApi_.requestFullscreen&&(Ui(ue,this.fsApi_.fullscreenchange,this.boundDocumentFullscreenChange_),this.on(this.fsApi_.fullscreenchange,this.boundDocumentFullscreenChange_)),this.fluid_&&this.on(["playerreset","resize"],this.boundUpdateStyleEl_);const s=Je(this.options_);if(t.plugins&&Object.keys(t.plugins).forEach(a=>{this[a](t.plugins[a])}),t.debug&&this.debug(!0),this.options_.playerOptions=s,this.middleware_=[],this.playbackRates(t.playbackRates),t.experimentalSvgIcons){const o=new U.DOMParser().parseFromString(ZL,"image/svg+xml");if(o.querySelector("parsererror"))Be.warn("Failed to load SVG Icons. Falling back to Font Icons."),this.options_.experimentalSvgIcons=null;else{const u=o.documentElement;u.style.display="none",this.el_.appendChild(u),this.addClass("vjs-svg-icons-enabled")}}this.initChildren(),this.isAudio(e.nodeName.toLowerCase()==="audio"),this.controls()?this.addClass("vjs-controls-enabled"):this.addClass("vjs-controls-disabled"),this.el_.setAttribute("role","region"),this.isAudio()?this.el_.setAttribute("aria-label",this.localize("Audio Player")):this.el_.setAttribute("aria-label",this.localize("Video Player")),this.isAudio()&&this.addClass("vjs-audio"),t.spatialNavigation&&t.spatialNavigation.enabled&&(this.spatialNavigation=new WL(this),this.addClass("vjs-spatial-navigation-enabled")),fl&&this.addClass("vjs-touch-enabled"),si||this.addClass("vjs-workinghover"),Ze.players[this.id_]=this;const n=gp.split(".")[0];this.addClass(`vjs-v${n}`),this.userActive(!0),this.reportUserActivity(),this.one("play",a=>this.listenForUserActivity_(a)),this.on("keydown",a=>this.handleKeyDown(a)),this.on("languagechange",a=>this.handleLanguagechange(a)),this.breakpoints(this.options_.breakpoints),this.responsive(this.options_.responsive),this.on("ready",()=>{this.audioPosterMode(this.options_.audioPosterMode),this.audioOnlyMode(this.options_.audioOnlyMode)})}dispose(){this.trigger("dispose"),this.off("dispose"),ni(ue,this.fsApi_.fullscreenchange,this.boundDocumentFullscreenChange_),ni(ue,"keydown",this.boundFullWindowOnEscKey_),this.styleEl_&&this.styleEl_.parentNode&&(this.styleEl_.parentNode.removeChild(this.styleEl_),this.styleEl_=null),Ze.players[this.id_]=null,this.tag&&this.tag.player&&(this.tag.player=null),this.el_&&this.el_.player&&(this.el_.player=null),this.tech_&&(this.tech_.dispose(),this.isPosterFromTech_=!1,this.poster_=""),this.playerElIngest_&&(this.playerElIngest_=null),this.tag&&(this.tag=null),VL(this),pi.names.forEach(e=>{const t=pi[e],i=this[t.getterName]();i&&i.off&&i.off()}),super.dispose({restoreEl:this.options_.restoreEl})}createEl(){let e=this.tag,t,i=this.playerElIngest_=e.parentNode&&e.parentNode.hasAttribute&&e.parentNode.hasAttribute("data-vjs-player");const s=this.tag.tagName.toLowerCase()==="video-js";i?t=this.el_=e.parentNode:s||(t=this.el_=super.createEl("div"));const n=Ls(e);if(s){for(t=this.el_=e,e=this.tag=ue.createElement("video");t.children.length;)e.appendChild(t.firstChild);Ho(t,"video-js")||kn(t,"video-js"),t.appendChild(e),i=this.playerElIngest_=t,Object.keys(t).forEach(l=>{try{e[l]=t[l]}catch{}})}e.setAttribute("tabindex","-1"),n.tabindex="-1",Wr&&Xh&&(e.setAttribute("role","application"),n.role="application"),e.removeAttribute("width"),e.removeAttribute("height"),"width"in n&&delete n.width,"height"in n&&delete n.height,Object.getOwnPropertyNames(n).forEach(function(l){s&&l==="class"||t.setAttribute(l,n[l]),s&&e.setAttribute(l,n[l])}),e.playerId=e.id,e.id+="_html5_api",e.className="vjs-tech",e.player=t.player=this,this.addClass("vjs-paused");const a=["IS_SMART_TV","IS_TIZEN","IS_WEBOS","IS_ANDROID","IS_IPAD","IS_IPHONE","IS_CHROMECAST_RECEIVER"].filter(l=>TT[l]).map(l=>"vjs-device-"+l.substring(3).toLowerCase().replace(/\_/g,"-"));if(this.addClass(...a),U.VIDEOJS_NO_DYNAMIC_STYLE!==!0){this.styleEl_=$T("vjs-styles-dimensions");const l=Zs(".vjs-styles-defaults"),u=Zs("head");u.insertBefore(this.styleEl_,l?l.nextSibling:u.firstChild)}this.fill_=!1,this.fluid_=!1,this.width(this.options_.width),this.height(this.options_.height),this.fill(this.options_.fill),this.fluid(this.options_.fluid),this.aspectRatio(this.options_.aspectRatio),this.crossOrigin(this.options_.crossOrigin||this.options_.crossorigin);const o=e.getElementsByTagName("a");for(let l=0;l<o.length;l++){const u=o.item(l);kn(u,"vjs-hidden"),u.setAttribute("hidden","hidden")}return e.initNetworkState_=e.networkState,e.parentNode&&!i&&e.parentNode.insertBefore(t,e),yp(e,t),this.children_.unshift(e),this.el_.setAttribute("lang",this.language_),this.el_.setAttribute("translate","no"),this.el_=t,t}crossOrigin(e){if(typeof e>"u")return this.techGet_("crossOrigin");if(e!==null&&e!=="anonymous"&&e!=="use-credentials"){Be.warn(`crossOrigin must be null,  "anonymous" or "use-credentials", given "${e}"`);return}this.techCall_("setCrossOrigin",e),this.posterImage&&this.posterImage.crossOrigin(e)}width(e){return this.dimension("width",e)}height(e){return this.dimension("height",e)}dimension(e,t){const i=e+"_";if(t===void 0)return this[i]||0;if(t===""||t==="auto"){this[i]=void 0,this.updateStyleEl_();return}const s=parseFloat(t);if(isNaN(s)){Be.error(`Improper value "${t}" supplied for for ${e}`);return}this[i]=s,this.updateStyleEl_()}fluid(e){if(e===void 0)return!!this.fluid_;this.fluid_=!!e,ps(this)&&this.off(["playerreset","resize"],this.boundUpdateStyleEl_),e?(this.addClass("vjs-fluid"),this.fill(!1),SL(this,()=>{this.on(["playerreset","resize"],this.boundUpdateStyleEl_)})):this.removeClass("vjs-fluid"),this.updateStyleEl_()}fill(e){if(e===void 0)return!!this.fill_;this.fill_=!!e,e?(this.addClass("vjs-fill"),this.fluid(!1)):this.removeClass("vjs-fill")}aspectRatio(e){if(e===void 0)return this.aspectRatio_;if(!/^\d+\:\d+$/.test(e))throw new Error("Improper value supplied for aspect ratio. The format should be width:height, for example 16:9.");this.aspectRatio_=e,this.fluid(!0),this.updateStyleEl_()}updateStyleEl_(){if(U.VIDEOJS_NO_DYNAMIC_STYLE===!0){const o=typeof this.width_=="number"?this.width_:this.options_.width,l=typeof this.height_=="number"?this.height_:this.options_.height,u=this.tech_&&this.tech_.el();u&&(o>=0&&(u.width=o),l>=0&&(u.height=l));return}let e,t,i,s;this.aspectRatio_!==void 0&&this.aspectRatio_!=="auto"?i=this.aspectRatio_:this.videoWidth()>0?i=this.videoWidth()+":"+this.videoHeight():i="16:9";const n=i.split(":"),a=n[1]/n[0];this.width_!==void 0?e=this.width_:this.height_!==void 0?e=this.height_/a:e=this.videoWidth()||300,this.height_!==void 0?t=this.height_:t=e*a,/^[^a-zA-Z]/.test(this.id())?s="dimensions-"+this.id():s=this.id()+"-dimensions",this.addClass(s),BT(this.styleEl_,`
      .${s} {
        width: ${e}px;
        height: ${t}px;
      }

      .${s}.vjs-fluid:not(.vjs-audio-only-mode) {
        padding-top: ${a*100}%;
      }
    `)}loadTech_(e,t){this.tech_&&this.unloadTech_();const i=Tt(e),s=e.charAt(0).toLowerCase()+e.slice(1);i!=="Html5"&&this.tag&&(Le.getTech("Html5").disposeMediaElement(this.tag),this.tag.player=null,this.tag=null),this.techName_=i,this.isReady_=!1;let n=this.autoplay();(typeof this.autoplay()=="string"||this.autoplay()===!0&&this.options_.normalizeAutoplay)&&(n=!1);const a={source:t,autoplay:n,nativeControlsForTouch:this.options_.nativeControlsForTouch,playerId:this.id(),techId:`${this.id()}_${s}_api`,playsinline:this.options_.playsinline,preload:this.options_.preload,loop:this.options_.loop,disablePictureInPicture:this.options_.disablePictureInPicture,muted:this.options_.muted,poster:this.poster(),language:this.language(),playerElIngest:this.playerElIngest_||!1,"vtt.js":this.options_["vtt.js"],canOverridePoster:!!this.options_.techCanOverridePoster,enableSourceset:this.options_.enableSourceset};pi.names.forEach(l=>{const u=pi[l];a[u.getterName]=this[u.privateName]}),Object.assign(a,this.options_[i]),Object.assign(a,this.options_[s]),Object.assign(a,this.options_[e.toLowerCase()]),this.tag&&(a.tag=this.tag),t&&t.src===this.cache_.src&&this.cache_.currentTime>0&&(a.startTime=this.cache_.currentTime);const o=Le.getTech(e);if(!o)throw new Error(`No Tech named '${i}' exists! '${i}' should be registered using videojs.registerTech()'`);this.tech_=new o(a),this.tech_.ready(ut(this,this.handleTechReady_),!0),xp.jsonToTextTracks(this.textTracksJson_||[],this.tech_),A_.forEach(l=>{this.on(this.tech_,l,u=>this[`handleTech${Tt(l)}_`](u))}),Object.keys(df).forEach(l=>{this.on(this.tech_,l,u=>{if(this.tech_.playbackRate()===0&&this.tech_.seeking()){this.queuedCallbacks_.push({callback:this[`handleTech${df[l]}_`].bind(this),event:u});return}this[`handleTech${df[l]}_`](u)})}),this.on(this.tech_,"loadstart",l=>this.handleTechLoadStart_(l)),this.on(this.tech_,"sourceset",l=>this.handleTechSourceset_(l)),this.on(this.tech_,"waiting",l=>this.handleTechWaiting_(l)),this.on(this.tech_,"ended",l=>this.handleTechEnded_(l)),this.on(this.tech_,"seeking",l=>this.handleTechSeeking_(l)),this.on(this.tech_,"play",l=>this.handleTechPlay_(l)),this.on(this.tech_,"pause",l=>this.handleTechPause_(l)),this.on(this.tech_,"durationchange",l=>this.handleTechDurationChange_(l)),this.on(this.tech_,"fullscreenchange",(l,u)=>this.handleTechFullscreenChange_(l,u)),this.on(this.tech_,"fullscreenerror",(l,u)=>this.handleTechFullscreenError_(l,u)),this.on(this.tech_,"enterpictureinpicture",l=>this.handleTechEnterPictureInPicture_(l)),this.on(this.tech_,"leavepictureinpicture",l=>this.handleTechLeavePictureInPicture_(l)),this.on(this.tech_,"error",l=>this.handleTechError_(l)),this.on(this.tech_,"posterchange",l=>this.handleTechPosterChange_(l)),this.on(this.tech_,"textdata",l=>this.handleTechTextData_(l)),this.on(this.tech_,"ratechange",l=>this.handleTechRateChange_(l)),this.on(this.tech_,"loadedmetadata",this.boundUpdateStyleEl_),this.usingNativeControls(this.techGet_("controls")),this.controls()&&!this.usingNativeControls()&&this.addTechControlsListeners_(),this.tech_.el().parentNode!==this.el()&&(i!=="Html5"||!this.tag)&&yp(this.tech_.el(),this.el()),this.tag&&(this.tag.player=null,this.tag=null)}unloadTech_(){pi.names.forEach(e=>{const t=pi[e];this[t.privateName]=this[t.getterName]()}),this.textTracksJson_=xp.textTracksToJson(this.tech_),this.isReady_=!1,this.tech_.dispose(),this.tech_=!1,this.isPosterFromTech_&&(this.poster_="",this.trigger("posterchange")),this.isPosterFromTech_=!1}tech(e){return e===void 0&&Be.warn(`Using the tech directly can be dangerous. I hope you know what you're doing.
See https://github.com/videojs/video.js/issues/2617 for more info.
`),this.tech_}version(){return{"video.js":gp}}addTechControlsListeners_(){this.removeTechControlsListeners_(),this.on(this.tech_,"click",this.boundHandleTechClick_),this.on(this.tech_,"dblclick",this.boundHandleTechDoubleClick_),this.on(this.tech_,"touchstart",this.boundHandleTechTouchStart_),this.on(this.tech_,"touchmove",this.boundHandleTechTouchMove_),this.on(this.tech_,"touchend",this.boundHandleTechTouchEnd_),this.on(this.tech_,"tap",this.boundHandleTechTap_)}removeTechControlsListeners_(){this.off(this.tech_,"tap",this.boundHandleTechTap_),this.off(this.tech_,"touchstart",this.boundHandleTechTouchStart_),this.off(this.tech_,"touchmove",this.boundHandleTechTouchMove_),this.off(this.tech_,"touchend",this.boundHandleTechTouchEnd_),this.off(this.tech_,"click",this.boundHandleTechClick_),this.off(this.tech_,"dblclick",this.boundHandleTechDoubleClick_)}handleTechReady_(){this.triggerReady(),this.cache_.volume&&this.techCall_("setVolume",this.cache_.volume),this.handleTechPosterChange_(),this.handleTechDurationChange_()}handleTechLoadStart_(){this.removeClass("vjs-ended","vjs-seeking"),this.error(null),this.handleTechDurationChange_(),this.paused()?(this.hasStarted(!1),this.trigger("loadstart")):this.trigger("loadstart"),this.manualAutoplay_(this.autoplay()===!0&&this.options_.normalizeAutoplay?"play":this.autoplay())}manualAutoplay_(e){if(!this.tech_||typeof e!="string")return;const t=()=>{const s=this.muted();this.muted(!0);const n=()=>{this.muted(s)};this.playTerminatedQueue_.push(n);const a=this.play();if(Go(a))return a.catch(o=>{throw n(),new Error(`Rejection at manualAutoplay. Restoring muted value. ${o||""}`)})};let i;if(e==="any"&&!this.muted()?(i=this.play(),Go(i)&&(i=i.catch(t))):e==="muted"&&!this.muted()?i=t():i=this.play(),!!Go(i))return i.then(()=>{this.trigger({type:"autoplay-success",autoplay:e})}).catch(()=>{this.trigger({type:"autoplay-failure",autoplay:e})})}updateSourceCaches_(e=""){let t=e,i="";typeof t!="string"&&(t=e.src,i=e.type),this.cache_.source=this.cache_.source||{},this.cache_.sources=this.cache_.sources||[],t&&!i&&(i=zL(this,t)),this.cache_.source=Je({},e,{src:t,type:i});const s=this.cache_.sources.filter(l=>l.src&&l.src===t),n=[],a=this.$$("source"),o=[];for(let l=0;l<a.length;l++){const u=Ls(a[l]);n.push(u),u.src&&u.src===t&&o.push(u.src)}o.length&&!s.length?this.cache_.sources=n:s.length||(this.cache_.sources=[this.cache_.source]),this.cache_.src=t}handleTechSourceset_(e){if(!this.changingSrc_){let t=n=>this.updateSourceCaches_(n);const i=this.currentSource().src,s=e.src;i&&!/^blob:/.test(i)&&/^blob:/.test(s)&&(!this.lastSource_||this.lastSource_.tech!==s&&this.lastSource_.player!==i)&&(t=()=>{}),t(s),e.src||this.tech_.any(["sourceset","loadstart"],n=>{if(n.type==="sourceset")return;const a=this.techGet_("currentSrc");this.lastSource_.tech=a,this.updateSourceCaches_(a)})}this.lastSource_={player:this.currentSource().src,tech:e.src},this.trigger({src:e.src,type:"sourceset"})}hasStarted(e){if(e===void 0)return this.hasStarted_;e!==this.hasStarted_&&(this.hasStarted_=e,this.hasStarted_?this.addClass("vjs-has-started"):this.removeClass("vjs-has-started"))}handleTechPlay_(){this.removeClass("vjs-ended","vjs-paused"),this.addClass("vjs-playing"),this.hasStarted(!0),this.trigger("play")}handleTechRateChange_(){this.tech_.playbackRate()>0&&this.cache_.lastPlaybackRate===0&&(this.queuedCallbacks_.forEach(e=>e.callback(e.event)),this.queuedCallbacks_=[]),this.cache_.lastPlaybackRate=this.tech_.playbackRate(),this.trigger("ratechange")}handleTechWaiting_(){this.addClass("vjs-waiting"),this.trigger("waiting");const e=this.currentTime(),t=()=>{e!==this.currentTime()&&(this.removeClass("vjs-waiting"),this.off("timeupdate",t))};this.on("timeupdate",t)}handleTechCanPlay_(){this.removeClass("vjs-waiting"),this.trigger("canplay")}handleTechCanPlayThrough_(){this.removeClass("vjs-waiting"),this.trigger("canplaythrough")}handleTechPlaying_(){this.removeClass("vjs-waiting"),this.trigger("playing")}handleTechSeeking_(){this.addClass("vjs-seeking"),this.trigger("seeking")}handleTechSeeked_(){this.removeClass("vjs-seeking","vjs-ended"),this.trigger("seeked")}handleTechPause_(){this.removeClass("vjs-playing"),this.addClass("vjs-paused"),this.trigger("pause")}handleTechEnded_(){this.addClass("vjs-ended"),this.removeClass("vjs-waiting"),this.options_.loop?(this.currentTime(0),this.play()):this.paused()||this.pause(),this.trigger("ended")}handleTechDurationChange_(){this.duration(this.techGet_("duration"))}handleTechClick_(e){this.controls_&&(this.options_===void 0||this.options_.userActions===void 0||this.options_.userActions.click===void 0||this.options_.userActions.click!==!1)&&(this.options_!==void 0&&this.options_.userActions!==void 0&&typeof this.options_.userActions.click=="function"?this.options_.userActions.click.call(this,e):this.paused()?Br(this.play()):this.pause())}handleTechDoubleClick_(e){if(!this.controls_)return;Array.prototype.some.call(this.$$(".vjs-control-bar, .vjs-modal-dialog"),i=>i.contains(e.target))||(this.options_===void 0||this.options_.userActions===void 0||this.options_.userActions.doubleClick===void 0||this.options_.userActions.doubleClick!==!1)&&(this.options_!==void 0&&this.options_.userActions!==void 0&&typeof this.options_.userActions.doubleClick=="function"?this.options_.userActions.doubleClick.call(this,e):this.isInPictureInPicture()&&!ue.pictureInPictureElement?this.exitPictureInPicture():this.isFullscreen()?this.exitFullscreen():this.requestFullscreen())}handleTechTap_(){this.userActive(!this.userActive())}handleTechTouchStart_(){this.userWasActive=this.userActive()}handleTechTouchMove_(){this.userWasActive&&this.reportUserActivity()}handleTechTouchEnd_(e){e.cancelable&&e.preventDefault()}toggleFullscreenClass_(){this.isFullscreen()?this.addClass("vjs-fullscreen"):this.removeClass("vjs-fullscreen")}documentFullscreenChange_(e){const t=e.target.player;if(t&&t!==this)return;const i=this.el();let s=ue[this.fsApi_.fullscreenElement]===i;!s&&i.matches&&(s=i.matches(":"+this.fsApi_.fullscreen)),this.isFullscreen(s)}handleTechFullscreenChange_(e,t){t&&(t.nativeIOSFullscreen&&(this.addClass("vjs-ios-native-fs"),this.tech_.one("webkitendfullscreen",()=>{this.removeClass("vjs-ios-native-fs")})),this.isFullscreen(t.isFullscreen))}handleTechFullscreenError_(e,t){this.trigger("fullscreenerror",t)}togglePictureInPictureClass_(){this.isInPictureInPicture()?this.addClass("vjs-picture-in-picture"):this.removeClass("vjs-picture-in-picture")}handleTechEnterPictureInPicture_(e){this.isInPictureInPicture(!0)}handleTechLeavePictureInPicture_(e){this.isInPictureInPicture(!1)}handleTechError_(){const e=this.tech_.error();e&&this.error(e)}handleTechTextData_(){let e=null;arguments.length>1&&(e=arguments[1]),this.trigger("textdata",e)}getCache(){return this.cache_}resetCache_(){this.cache_={currentTime:0,initTime:0,inactivityTimeout:this.options_.inactivityTimeout,duration:NaN,lastVolume:1,lastPlaybackRate:this.defaultPlaybackRate(),media:null,src:"",source:{},sources:[],playbackRates:[],volume:1}}techCall_(e,t){this.ready(function(){if(e in UL)return NL(this.middleware_,this.tech_,e,t);if(e in Ny)return By(this.middleware_,this.tech_,e,t);try{this.tech_&&this.tech_[e](t)}catch(i){throw Be(i),i}},!0)}techGet_(e){if(!(!this.tech_||!this.tech_.isReady_)){if(e in FL)return BL(this.middleware_,this.tech_,e);if(e in Ny)return By(this.middleware_,this.tech_,e);try{return this.tech_[e]()}catch(t){throw this.tech_[e]===void 0?(Be(`Video.js: ${e} method not defined for ${this.techName_} playback technology.`,t),t):t.name==="TypeError"?(Be(`Video.js: ${e} unavailable on ${this.techName_} playback technology element.`,t),this.tech_.isReady_=!1,t):(Be(t),t)}}}play(){return new Promise(e=>{this.play_(e)})}play_(e=Br){this.playCallbacks_.push(e);const t=!!(!this.changingSrc_&&(this.src()||this.currentSrc())),i=!!(zh||si);if(this.waitToPlay_&&(this.off(["ready","loadstart"],this.waitToPlay_),this.waitToPlay_=null),!this.isReady_||!t){this.waitToPlay_=a=>{this.play_()},this.one(["ready","loadstart"],this.waitToPlay_),!t&&i&&this.load();return}const s=this.techGet_("play");i&&this.hasClass("vjs-ended")&&this.resetProgressBar_(),s===null?this.runPlayTerminatedQueue_():this.runPlayCallbacks_(s)}runPlayTerminatedQueue_(){const e=this.playTerminatedQueue_.slice(0);this.playTerminatedQueue_=[],e.forEach(function(t){t()})}runPlayCallbacks_(e){const t=this.playCallbacks_.slice(0);this.playCallbacks_=[],this.playTerminatedQueue_=[],t.forEach(function(i){i(e)})}pause(){this.techCall_("pause")}paused(){return this.techGet_("paused")!==!1}played(){return this.techGet_("played")||mr(0,0)}scrubbing(e){if(typeof e>"u")return this.scrubbing_;this.scrubbing_=!!e,this.techCall_("setScrubbing",this.scrubbing_),e?this.addClass("vjs-scrubbing"):this.removeClass("vjs-scrubbing")}currentTime(e){if(e===void 0)return this.cache_.currentTime=this.techGet_("currentTime")||0,this.cache_.currentTime;if(e<0&&(e=0),!this.isReady_||this.changingSrc_||!this.tech_||!this.tech_.isReady_){this.cache_.initTime=e,this.off("canplay",this.boundApplyInitTime_),this.one("canplay",this.boundApplyInitTime_);return}this.techCall_("setCurrentTime",e),this.cache_.initTime=0,isFinite(e)&&(this.cache_.currentTime=Number(e))}applyInitTime_(){this.currentTime(this.cache_.initTime)}duration(e){if(e===void 0)return this.cache_.duration!==void 0?this.cache_.duration:NaN;e=parseFloat(e),e<0&&(e=1/0),e!==this.cache_.duration&&(this.cache_.duration=e,e===1/0?this.addClass("vjs-live"):this.removeClass("vjs-live"),isNaN(e)||this.trigger("durationchange"))}remainingTime(){return this.duration()-this.currentTime()}remainingTimeDisplay(){return Math.floor(this.duration())-Math.floor(this.currentTime())}buffered(){let e=this.techGet_("buffered");return(!e||!e.length)&&(e=mr(0,0)),e}seekable(){let e=this.techGet_("seekable");return(!e||!e.length)&&(e=mr(0,0)),e}seeking(){return this.techGet_("seeking")}ended(){return this.techGet_("ended")}networkState(){return this.techGet_("networkState")}readyState(){return this.techGet_("readyState")}bufferedPercent(){return ZT(this.buffered(),this.duration())}bufferedEnd(){const e=this.buffered(),t=this.duration();let i=e.end(e.length-1);return i>t&&(i=t),i}volume(e){let t;if(e!==void 0){t=Math.max(0,Math.min(1,e)),this.cache_.volume=t,this.techCall_("setVolume",t),t>0&&this.lastVolume_(t);return}return t=parseFloat(this.techGet_("volume")),isNaN(t)?1:t}muted(e){if(e!==void 0){this.techCall_("setMuted",e);return}return this.techGet_("muted")||!1}defaultMuted(e){return e!==void 0&&this.techCall_("setDefaultMuted",e),this.techGet_("defaultMuted")||!1}lastVolume_(e){if(e!==void 0&&e!==0){this.cache_.lastVolume=e;return}return this.cache_.lastVolume}supportsFullScreen(){return this.techGet_("supportsFullScreen")||!1}isFullscreen(e){if(e!==void 0){const t=this.isFullscreen_;this.isFullscreen_=!!e,this.isFullscreen_!==t&&this.fsApi_.prefixed&&this.trigger("fullscreenchange"),this.toggleFullscreenClass_();return}return this.isFullscreen_}requestFullscreen(e){this.isInPictureInPicture()&&this.exitPictureInPicture();const t=this;return new Promise((i,s)=>{function n(){t.off("fullscreenerror",o),t.off("fullscreenchange",a)}function a(){n(),i()}function o(u,c){n(),s(c)}t.one("fullscreenchange",a),t.one("fullscreenerror",o);const l=t.requestFullscreenHelper_(e);l&&(l.then(n,n),l.then(i,s))})}requestFullscreenHelper_(e){let t;if(this.fsApi_.prefixed||(t=this.options_.fullscreen&&this.options_.fullscreen.options||{},e!==void 0&&(t=e)),this.fsApi_.requestFullscreen){const i=this.el_[this.fsApi_.requestFullscreen](t);return i&&i.then(()=>this.isFullscreen(!0),()=>this.isFullscreen(!1)),i}else this.tech_.supportsFullScreen()&&!this.options_.preferFullWindow?this.techCall_("enterFullScreen"):this.enterFullWindow()}exitFullscreen(){const e=this;return new Promise((t,i)=>{function s(){e.off("fullscreenerror",a),e.off("fullscreenchange",n)}function n(){s(),t()}function a(l,u){s(),i(u)}e.one("fullscreenchange",n),e.one("fullscreenerror",a);const o=e.exitFullscreenHelper_();o&&(o.then(s,s),o.then(t,i))})}exitFullscreenHelper_(){if(this.fsApi_.requestFullscreen){const e=ue[this.fsApi_.exitFullscreen]();return e&&Br(e.then(()=>this.isFullscreen(!1))),e}else this.tech_.supportsFullScreen()&&!this.options_.preferFullWindow?this.techCall_("exitFullScreen"):this.exitFullWindow()}enterFullWindow(){this.isFullscreen(!0),this.isFullWindow=!0,this.docOrigOverflow=ue.documentElement.style.overflow,Ui(ue,"keydown",this.boundFullWindowOnEscKey_),ue.documentElement.style.overflow="hidden",kn(ue.body,"vjs-full-window"),this.trigger("enterFullWindow")}fullWindowOnEscKey(e){e.key==="Escape"&&this.isFullscreen()===!0&&(this.isFullWindow?this.exitFullWindow():this.exitFullscreen())}exitFullWindow(){this.isFullscreen(!1),this.isFullWindow=!1,ni(ue,"keydown",this.boundFullWindowOnEscKey_),ue.documentElement.style.overflow=this.docOrigOverflow,Zh(ue.body,"vjs-full-window"),this.trigger("exitFullWindow")}disablePictureInPicture(e){if(e===void 0)return this.techGet_("disablePictureInPicture");this.techCall_("setDisablePictureInPicture",e),this.options_.disablePictureInPicture=e,this.trigger("disablepictureinpicturechanged")}isInPictureInPicture(e){if(e!==void 0){this.isInPictureInPicture_=!!e,this.togglePictureInPictureClass_();return}return!!this.isInPictureInPicture_}requestPictureInPicture(){if(this.options_.enableDocumentPictureInPicture&&U.documentPictureInPicture){const e=ue.createElement(this.el().tagName);return e.classList=this.el().classList,e.classList.add("vjs-pip-container"),this.posterImage&&e.appendChild(this.posterImage.el().cloneNode(!0)),this.titleBar&&e.appendChild(this.titleBar.el().cloneNode(!0)),e.appendChild(Me("p",{className:"vjs-pip-text"},{},this.localize("Playing in picture-in-picture"))),U.documentPictureInPicture.requestWindow({width:this.videoWidth(),height:this.videoHeight()}).then(t=>(RT(t),this.el_.parentNode.insertBefore(e,this.el_),t.document.body.appendChild(this.el_),t.document.body.classList.add("vjs-pip-window"),this.player_.isInPictureInPicture(!0),this.player_.trigger({type:"enterpictureinpicture",pipWindow:t}),t.addEventListener("pagehide",i=>{const s=i.target.querySelector(".video-js");e.parentNode.replaceChild(s,e),this.player_.isInPictureInPicture(!1),this.player_.trigger("leavepictureinpicture")}),t))}return"pictureInPictureEnabled"in ue&&this.disablePictureInPicture()===!1?this.techGet_("requestPictureInPicture"):Promise.reject("No PiP mode is available")}exitPictureInPicture(){if(U.documentPictureInPicture&&U.documentPictureInPicture.window)return U.documentPictureInPicture.window.close(),Promise.resolve();if("pictureInPictureEnabled"in ue)return ue.exitPictureInPicture()}handleKeyDown(e){const{userActions:t}=this.options_;!t||!t.hotkeys||(s=>{const n=s.tagName.toLowerCase();if(s.isContentEditable)return!0;const a=["button","checkbox","hidden","radio","reset","submit"];return n==="input"?a.indexOf(s.type)===-1:["textarea"].indexOf(n)!==-1})(this.el_.ownerDocument.activeElement)||(typeof t.hotkeys=="function"?t.hotkeys.call(this,e):this.handleHotkeys(e))}handleHotkeys(e){const t=this.options_.userActions?this.options_.userActions.hotkeys:{},{fullscreenKey:i=a=>e.key.toLowerCase()==="f",muteKey:s=a=>e.key.toLowerCase()==="m",playPauseKey:n=a=>e.key.toLowerCase()==="k"||e.key.toLowerCase()===" "}=t;if(i.call(this,e)){e.preventDefault(),e.stopPropagation();const a=ee.getComponent("FullscreenToggle");ue[this.fsApi_.fullscreenEnabled]!==!1&&a.prototype.handleClick.call(this,e)}else s.call(this,e)?(e.preventDefault(),e.stopPropagation(),ee.getComponent("MuteToggle").prototype.handleClick.call(this,e)):n.call(this,e)&&(e.preventDefault(),e.stopPropagation(),ee.getComponent("PlayToggle").prototype.handleClick.call(this,e))}canPlayType(e){let t;for(let i=0,s=this.options_.techOrder;i<s.length;i++){const n=s[i];let a=Le.getTech(n);if(a||(a=ee.getComponent(n)),!a){Be.error(`The "${n}" tech is undefined. Skipped browser support check for that tech.`);continue}if(a.isSupported()&&(t=a.canPlayType(e),t))return t}return""}selectSource(e){const t=this.options_.techOrder.map(o=>[o,Le.getTech(o)]).filter(([o,l])=>l?l.isSupported():(Be.error(`The "${o}" tech is undefined. Skipped browser support check for that tech.`),!1)),i=function(o,l,u){let c;return o.some(h=>l.some(f=>{if(c=u(h,f),c)return!0})),c};let s;const n=o=>(l,u)=>o(u,l),a=([o,l],u)=>{if(l.canPlaySource(u,this.options_[o.toLowerCase()]))return{source:u,tech:o}};return this.options_.sourceOrder?s=i(e,t,n(a)):s=i(t,e,a),s||!1}handleSrc_(e,t){if(typeof e>"u")return this.cache_.src||"";this.resetRetryOnError_&&this.resetRetryOnError_();const i=JT(e);if(!i.length){this.setTimeout(function(){this.error({code:4,message:this.options_.notSupportedMessage})},0);return}if(this.changingSrc_=!0,t||(this.cache_.sources=i),this.updateSourceCaches_(i[0]),QL(this,i[0],(s,n)=>{if(this.middleware_=n,t||(this.cache_.sources=i),this.updateSourceCaches_(s),this.src_(s)){if(i.length>1)return this.handleSrc_(i.slice(1));this.changingSrc_=!1,this.setTimeout(function(){this.error({code:4,message:this.options_.notSupportedMessage})},0),this.triggerReady();return}$L(n,this.tech_)}),i.length>1){const s=()=>{this.error(null),this.handleSrc_(i.slice(1),!0)},n=()=>{this.off("error",s)};this.one("error",s),this.one("playing",n),this.resetRetryOnError_=()=>{this.off("error",s),this.off("playing",n)}}}src(e){return this.handleSrc_(e,!1)}src_(e){const t=this.selectSource([e]);return t?VT(t.tech,this.techName_)?(this.ready(function(){this.tech_.constructor.prototype.hasOwnProperty("setSource")?this.techCall_("setSource",e):this.techCall_("src",e.src),this.changingSrc_=!1},!0),!1):(this.changingSrc_=!0,this.loadTech_(t.tech,t.source),this.tech_.ready(()=>{this.changingSrc_=!1}),!1):!0}addSourceElement(e,t){return this.tech_?this.tech_.addSourceElement(e,t):!1}removeSourceElement(e){return this.tech_?this.tech_.removeSourceElement(e):!1}load(){if(this.tech_&&this.tech_.vhs){this.src(this.currentSource());return}this.techCall_("load")}reset(){if(this.paused())this.doReset_();else{const e=this.play();Br(e.then(()=>this.doReset_()))}}doReset_(){this.tech_&&this.tech_.clearTracks("text"),this.removeClass("vjs-playing"),this.addClass("vjs-paused"),this.resetCache_(),this.poster(""),this.loadTech_(this.options_.techOrder[0],null),this.techCall_("reset"),this.resetControlBarUI_(),this.error(null),this.titleBar&&this.titleBar.update({title:void 0,description:void 0}),ps(this)&&this.trigger("playerreset")}resetControlBarUI_(){this.resetProgressBar_(),this.resetPlaybackRate_(),this.resetVolumeBar_()}resetProgressBar_(){this.currentTime(0);const{currentTimeDisplay:e,durationDisplay:t,progressControl:i,remainingTimeDisplay:s}=this.controlBar||{},{seekBar:n}=i||{};e&&e.updateContent(),t&&t.updateContent(),s&&s.updateContent(),n&&(n.update(),n.loadProgressBar&&n.loadProgressBar.update())}resetPlaybackRate_(){this.playbackRate(this.defaultPlaybackRate()),this.handleTechRateChange_()}resetVolumeBar_(){this.volume(1),this.trigger("volumechange")}currentSources(){const e=this.currentSource(),t=[];return Object.keys(e).length!==0&&t.push(e),this.cache_.sources||t}currentSource(){return this.cache_.source||{}}currentSrc(){return this.currentSource()&&this.currentSource().src||""}currentType(){return this.currentSource()&&this.currentSource().type||""}preload(e){if(e!==void 0){this.techCall_("setPreload",e),this.options_.preload=e;return}return this.techGet_("preload")}autoplay(e){if(e===void 0)return this.options_.autoplay||!1;let t;typeof e=="string"&&/(any|play|muted)/.test(e)||e===!0&&this.options_.normalizeAutoplay?(this.options_.autoplay=e,this.manualAutoplay_(typeof e=="string"?e:"play"),t=!1):e?this.options_.autoplay=!0:this.options_.autoplay=!1,t=typeof t>"u"?this.options_.autoplay:t,this.tech_&&this.techCall_("setAutoplay",t)}playsinline(e){return e!==void 0&&(this.techCall_("setPlaysinline",e),this.options_.playsinline=e),this.techGet_("playsinline")}loop(e){if(e!==void 0){this.techCall_("setLoop",e),this.options_.loop=e;return}return this.techGet_("loop")}poster(e){if(e===void 0)return this.poster_;e||(e=""),e!==this.poster_&&(this.poster_=e,this.techCall_("setPoster",e),this.isPosterFromTech_=!1,this.trigger("posterchange"))}handleTechPosterChange_(){if((!this.poster_||this.options_.techCanOverridePoster)&&this.tech_&&this.tech_.poster){const e=this.tech_.poster()||"";e!==this.poster_&&(this.poster_=e,this.isPosterFromTech_=!0,this.trigger("posterchange"))}}controls(e){if(e===void 0)return!!this.controls_;e=!!e,this.controls_!==e&&(this.controls_=e,this.usingNativeControls()&&this.techCall_("setControls",e),this.controls_?(this.removeClass("vjs-controls-disabled"),this.addClass("vjs-controls-enabled"),this.trigger("controlsenabled"),this.usingNativeControls()||this.addTechControlsListeners_()):(this.removeClass("vjs-controls-enabled"),this.addClass("vjs-controls-disabled"),this.trigger("controlsdisabled"),this.usingNativeControls()||this.removeTechControlsListeners_()))}usingNativeControls(e){if(e===void 0)return!!this.usingNativeControls_;e=!!e,this.usingNativeControls_!==e&&(this.usingNativeControls_=e,this.usingNativeControls_?(this.addClass("vjs-using-native-controls"),this.trigger("usingnativecontrols")):(this.removeClass("vjs-using-native-controls"),this.trigger("usingcustomcontrols")))}error(e){if(e===void 0)return this.error_||null;if(zs("beforeerror").forEach(t=>{const i=t(this,e);if(!(Zr(i)&&!Array.isArray(i)||typeof i=="string"||typeof i=="number"||i===null)){this.log.error("please return a value that MediaError expects in beforeerror hooks");return}e=i}),this.options_.suppressNotSupportedError&&e&&e.code===4){const t=function(){this.error(e)};this.options_.suppressNotSupportedError=!1,this.any(["click","touchstart"],t),this.one("loadstart",function(){this.off(["click","touchstart"],t)});return}if(e===null){this.error_=null,this.removeClass("vjs-error"),this.errorDisplay&&this.errorDisplay.close();return}this.error_=new St(e),this.addClass("vjs-error"),Be.error(`(CODE:${this.error_.code} ${St.errorTypes[this.error_.code]})`,this.error_.message,this.error_),this.trigger("error"),zs("error").forEach(t=>t(this,this.error_))}reportUserActivity(e){this.userActivity_=!0}userActive(e){if(e===void 0)return this.userActive_;if(e=!!e,e!==this.userActive_){if(this.userActive_=e,this.userActive_){this.userActivity_=!0,this.removeClass("vjs-user-inactive"),this.addClass("vjs-user-active"),this.trigger("useractive");return}this.tech_&&this.tech_.one("mousemove",function(t){t.stopPropagation(),t.preventDefault()}),this.userActivity_=!1,this.removeClass("vjs-user-active"),this.addClass("vjs-user-inactive"),this.trigger("userinactive")}}listenForUserActivity_(){let e,t,i;const s=ut(this,this.reportUserActivity),n=function(h){(h.screenX!==t||h.screenY!==i)&&(t=h.screenX,i=h.screenY,s())},a=function(){s(),this.clearInterval(e),e=this.setInterval(s,250)},o=function(h){s(),this.clearInterval(e)};this.on("mousedown",a),this.on("mousemove",n),this.on("mouseup",o),this.on("mouseleave",o);const l=this.getChild("controlBar");l&&!si&&!Or&&(l.on("mouseenter",function(h){this.player().options_.inactivityTimeout!==0&&(this.player().cache_.inactivityTimeout=this.player().options_.inactivityTimeout),this.player().options_.inactivityTimeout=0}),l.on("mouseleave",function(h){this.player().options_.inactivityTimeout=this.player().cache_.inactivityTimeout})),this.on("keydown",s),this.on("keyup",s);let u;const c=function(){if(!this.userActivity_)return;this.userActivity_=!1,this.userActive(!0),this.clearTimeout(u);const h=this.options_.inactivityTimeout;h<=0||(u=this.setTimeout(function(){this.userActivity_||this.userActive(!1)},h))};this.setInterval(c,250)}playbackRate(e){if(e!==void 0){this.techCall_("setPlaybackRate",e);return}return this.tech_&&this.tech_.featuresPlaybackRate?this.cache_.lastPlaybackRate||this.techGet_("playbackRate"):1}defaultPlaybackRate(e){return e!==void 0?this.techCall_("setDefaultPlaybackRate",e):this.tech_&&this.tech_.featuresPlaybackRate?this.techGet_("defaultPlaybackRate"):1}isAudio(e){if(e!==void 0){this.isAudio_=!!e;return}return!!this.isAudio_}updatePlayerHeightOnAudioOnlyMode_(){const e=this.getChild("ControlBar");!e||this.audioOnlyCache_.controlBarHeight===e.currentHeight()||(this.audioOnlyCache_.controlBarHeight=e.currentHeight(),this.height(this.audioOnlyCache_.controlBarHeight))}enableAudioOnlyUI_(){this.addClass("vjs-audio-only-mode");const e=this.children(),t=this.getChild("ControlBar"),i=t&&t.currentHeight();e.forEach(s=>{s!==t&&s.el_&&!s.hasClass("vjs-hidden")&&(s.hide(),this.audioOnlyCache_.hiddenChildren.push(s))}),this.audioOnlyCache_.playerHeight=this.currentHeight(),this.audioOnlyCache_.controlBarHeight=i,this.on("playerresize",this.boundUpdatePlayerHeightOnAudioOnlyMode_),this.height(i),this.trigger("audioonlymodechange")}disableAudioOnlyUI_(){this.removeClass("vjs-audio-only-mode"),this.off("playerresize",this.boundUpdatePlayerHeightOnAudioOnlyMode_),this.audioOnlyCache_.hiddenChildren.forEach(e=>e.show()),this.height(this.audioOnlyCache_.playerHeight),this.trigger("audioonlymodechange")}audioOnlyMode(e){if(typeof e!="boolean"||e===this.audioOnlyMode_)return this.audioOnlyMode_;if(this.audioOnlyMode_=e,e){const t=[];return this.isInPictureInPicture()&&t.push(this.exitPictureInPicture()),this.isFullscreen()&&t.push(this.exitFullscreen()),this.audioPosterMode()&&t.push(this.audioPosterMode(!1)),Promise.all(t).then(()=>this.enableAudioOnlyUI_())}return Promise.resolve().then(()=>this.disableAudioOnlyUI_())}enablePosterModeUI_(){(this.tech_&&this.tech_).hide(),this.addClass("vjs-audio-poster-mode"),this.trigger("audiopostermodechange")}disablePosterModeUI_(){(this.tech_&&this.tech_).show(),this.removeClass("vjs-audio-poster-mode"),this.trigger("audiopostermodechange")}audioPosterMode(e){return typeof e!="boolean"||e===this.audioPosterMode_?this.audioPosterMode_:(this.audioPosterMode_=e,e?this.audioOnlyMode()?this.audioOnlyMode(!1).then(()=>{this.enablePosterModeUI_()}):Promise.resolve().then(()=>{this.enablePosterModeUI_()}):Promise.resolve().then(()=>{this.disablePosterModeUI_()}))}addTextTrack(e,t,i){if(this.tech_)return this.tech_.addTextTrack(e,t,i)}addRemoteTextTrack(e,t){if(this.tech_)return this.tech_.addRemoteTextTrack(e,t)}removeRemoteTextTrack(e={}){let{track:t}=e;if(t||(t=e),this.tech_)return this.tech_.removeRemoteTextTrack(t)}getVideoPlaybackQuality(){return this.techGet_("getVideoPlaybackQuality")}videoWidth(){return this.tech_&&this.tech_.videoWidth&&this.tech_.videoWidth()||0}videoHeight(){return this.tech_&&this.tech_.videoHeight&&this.tech_.videoHeight()||0}language(e){if(e===void 0)return this.language_;this.language_!==String(e).toLowerCase()&&(this.language_=String(e).toLowerCase(),ps(this)&&this.trigger("languagechange"))}languages(){return Je(Ze.prototype.options_.languages,this.languages_)}toJSON(){const e=Je(this.options_),t=e.tracks;e.tracks=[];for(let i=0;i<t.length;i++){let s=t[i];s=Je(s),s.player=void 0,e.tracks[i]=s}return e}createModal(e,t){t=t||{},t.content=e||"";const i=new Ka(this,t);return this.addChild(i),i.on("dispose",()=>{this.removeChild(i)}),i.open(),i}updateCurrentBreakpoint_(){if(!this.responsive())return;const e=this.currentBreakpoint(),t=this.currentWidth();for(let i=0;i<kp.length;i++){const s=kp[i],n=this.breakpoints_[s];if(t<=n){if(e===s)return;e&&this.removeClass(gc[e]),this.addClass(gc[s]),this.breakpoint_=s;break}}}removeCurrentBreakpoint_(){const e=this.currentBreakpointClass();this.breakpoint_="",e&&this.removeClass(e)}breakpoints(e){return e===void 0?Object.assign(this.breakpoints_):(this.breakpoint_="",this.breakpoints_=Object.assign({},xQ,e),this.updateCurrentBreakpoint_(),Object.assign(this.breakpoints_))}responsive(e){if(e===void 0)return this.responsive_;e=!!e;const t=this.responsive_;if(e!==t)return this.responsive_=e,e?(this.on("playerresize",this.boundUpdateCurrentBreakpoint_),this.updateCurrentBreakpoint_()):(this.off("playerresize",this.boundUpdateCurrentBreakpoint_),this.removeCurrentBreakpoint_()),e}currentBreakpoint(){return this.breakpoint_}currentBreakpointClass(){return gc[this.breakpoint_]||""}loadMedia(e,t){if(!e||typeof e!="object")return;const i=this.crossOrigin();this.reset(),this.cache_.media=Je(e);const{artist:s,artwork:n,description:a,poster:o,src:l,textTracks:u,title:c}=this.cache_.media;!n&&o&&(this.cache_.media.artwork=[{src:o,type:Wc(o)}]),i&&this.crossOrigin(i),l&&this.src(l),o&&this.poster(o),Array.isArray(u)&&u.forEach(h=>this.addRemoteTextTrack(h,!1)),this.titleBar&&this.titleBar.update({title:c,description:a||s||""}),this.ready(t)}getMedia(){if(!this.cache_.media){const e=this.poster(),t=this.currentSources(),i=Array.prototype.map.call(this.remoteTextTracks(),n=>({kind:n.kind,label:n.label,language:n.language,src:n.src})),s={src:t,textTracks:i};return e&&(s.poster=e,s.artwork=[{src:s.poster,type:Wc(s.poster)}]),s}return Je(this.cache_.media)}static getTagSettings(e){const t={sources:[],tracks:[]},i=Ls(e),s=i["data-setup"];if(Ho(e,"vjs-fill")&&(i.fill=!0),Ho(e,"vjs-fluid")&&(i.fluid=!0),s!==null)try{Object.assign(i,JSON.parse(s||"{}"))}catch(n){Be.error("data-setup",n)}if(Object.assign(t,i),e.hasChildNodes()){const n=e.childNodes;for(let a=0,o=n.length;a<o;a++){const l=n[a],u=l.nodeName.toLowerCase();u==="source"?t.sources.push(Ls(l)):u==="track"&&t.tracks.push(Ls(l))}}return t}debug(e){if(e===void 0)return this.debugEnabled_;e?(this.trigger("debugon"),this.previousLogLevel_=this.log.level,this.log.level("debug"),this.debugEnabled_=!0):(this.trigger("debugoff"),this.log.level(this.previousLogLevel_),this.previousLogLevel_=void 0,this.debugEnabled_=!1)}playbackRates(e){if(e===void 0)return this.cache_.playbackRates;Array.isArray(e)&&e.every(t=>typeof t=="number")&&(this.cache_.playbackRates=e,this.trigger("playbackrateschange"))}}Ze.prototype.videoTracks=()=>{};Ze.prototype.audioTracks=()=>{};Ze.prototype.textTracks=()=>{};Ze.prototype.remoteTextTracks=()=>{};Ze.prototype.remoteTextTrackEls=()=>{};pi.names.forEach(function(r){const e=pi[r];Ze.prototype[e.getterName]=function(){return this.tech_?this.tech_[e.getterName]():(this[e.privateName]=this[e.privateName]||new e.ListClass,this[e.privateName])}});Ze.prototype.crossorigin=Ze.prototype.crossOrigin;Ze.players={};const ko=U.navigator;Ze.prototype.options_={techOrder:Le.defaultTechOrder_,html5:{},enableSourceset:!0,inactivityTimeout:2e3,playbackRates:[],liveui:!1,children:["mediaLoader","posterImage","titleBar","textTrackDisplay","loadingSpinner","bigPlayButton","liveTracker","controlBar","errorDisplay","textTrackSettings","resizeManager"],language:ko&&(ko.languages&&ko.languages[0]||ko.userLanguage||ko.language)||"en",languages:{},notSupportedMessage:"No compatible source was found for this media.",normalizeAutoplay:!1,fullscreen:{options:{navigationUI:"hide"}},breakpoints:{},responsive:!1,audioOnlyMode:!1,audioPosterMode:!1,spatialNavigation:{enabled:!1,horizontalSeek:!1},enableSmoothSeeking:!1,disableSeekWhileScrubbingOnMobile:!1,disableSeekWhileScrubbingOnSTV:!1};A_.forEach(function(r){Ze.prototype[`handleTech${Tt(r)}_`]=function(){return this.trigger(r)}});ee.registerComponent("Player",Ze);const Hc="plugin",fa="activePlugins_",ia={},Yc=r=>ia.hasOwnProperty(r),Oc=r=>Yc(r)?ia[r]:void 0,P_=(r,e)=>{r[fa]=r[fa]||{},r[fa][e]=!0},Gc=(r,e,t)=>{const i=(t?"before":"")+"pluginsetup";r.trigger(i,e),r.trigger(i+":"+e.name,e)},wQ=function(r,e){const t=function(){Gc(this,{name:r,plugin:e,instance:null},!0);const i=e.apply(this,arguments);return P_(this,r),Gc(this,{name:r,plugin:e,instance:i}),i};return Object.keys(e).forEach(function(i){t[i]=e[i]}),t},tb=(r,e)=>(e.prototype.name=r,function(...t){Gc(this,{name:r,plugin:e,instance:null},!0);const i=new e(this,...t);return this[r]=()=>i,Gc(this,i.getEventHash()),i});class Ai{constructor(e){if(this.constructor===Ai)throw new Error("Plugin must be sub-classed; not directly instantiated.");this.player=e,this.log||(this.log=this.player.log.createLogger(this.name)),vg(this),delete this.trigger,qT(this,this.constructor.defaultState),P_(e,this.name),this.dispose=this.dispose.bind(this),e.on("dispose",this.dispose)}version(){return this.constructor.VERSION}getEventHash(e={}){return e.name=this.name,e.plugin=this.constructor,e.instance=this,e}trigger(e,t={}){return Ga(this.eventBusEl_,e,this.getEventHash(t))}handleStateChanged(e){}dispose(){const{name:e,player:t}=this;this.trigger("dispose"),this.off(),t.off("dispose",this.dispose),t[fa][e]=!1,this.player=this.state=null,t[e]=tb(e,ia[e])}static isBasic(e){const t=typeof e=="string"?Oc(e):e;return typeof t=="function"&&!Ai.prototype.isPrototypeOf(t.prototype)}static registerPlugin(e,t){if(typeof e!="string")throw new Error(`Illegal plugin name, "${e}", must be a string, was ${typeof e}.`);if(Yc(e))Be.warn(`A plugin named "${e}" already exists. You may want to avoid re-registering plugins!`);else if(Ze.prototype.hasOwnProperty(e))throw new Error(`Illegal plugin name, "${e}", cannot share a name with an existing player method!`);if(typeof t!="function")throw new Error(`Illegal plugin for "${e}", must be a function, was ${typeof t}.`);return ia[e]=t,e!==Hc&&(Ai.isBasic(t)?Ze.prototype[e]=wQ(e,t):Ze.prototype[e]=tb(e,t)),t}static deregisterPlugin(e){if(e===Hc)throw new Error("Cannot de-register base plugin.");Yc(e)&&(delete ia[e],delete Ze.prototype[e])}static getPlugins(e=Object.keys(ia)){let t;return e.forEach(i=>{const s=Oc(i);s&&(t=t||{},t[i]=s)}),t}static getPluginVersion(e){const t=Oc(e);return t&&t.VERSION||""}}Ai.getPlugin=Oc;Ai.BASE_PLUGIN_NAME=Hc;Ai.registerPlugin(Hc,Ai);Ze.prototype.usingPlugin=function(r){return!!this[fa]&&this[fa][r]===!0};Ze.prototype.hasPlugin=function(r){return!!Yc(r)};function CQ(r,e){let t=!1;return function(...i){return t||Be.warn(r),t=!0,e.apply(this,i)}}function Sr(r,e,t,i){return CQ(`${e} is deprecated and will be removed in ${r}.0; please use ${t} instead.`,i)}var kQ={NetworkBadStatus:"networkbadstatus",NetworkRequestFailed:"networkrequestfailed",NetworkRequestAborted:"networkrequestaborted",NetworkRequestTimeout:"networkrequesttimeout",NetworkBodyParserFailed:"networkbodyparserfailed",StreamingHlsPlaylistParserError:"streaminghlsplaylistparsererror",StreamingDashManifestParserError:"streamingdashmanifestparsererror",StreamingContentSteeringParserError:"streamingcontentsteeringparsererror",StreamingVttParserError:"streamingvttparsererror",StreamingFailedToSelectNextSegment:"streamingfailedtoselectnextsegment",StreamingFailedToDecryptSegment:"streamingfailedtodecryptsegment",StreamingFailedToTransmuxSegment:"streamingfailedtotransmuxsegment",StreamingFailedToAppendSegment:"streamingfailedtoappendsegment",StreamingCodecsChangeError:"streamingcodecschangeerror"};const D_=r=>r.indexOf("#")===0?r.slice(1):r;function H(r,e,t){let i=H.getPlayer(r);if(i)return e&&Be.warn(`Player "${r}" is already initialised. Options will not be applied.`),t&&i.ready(t),i;const s=typeof r=="string"?Zs("#"+D_(r)):r;if(!Ya(s))throw new TypeError("The element or ID supplied is not valid. (videojs)");const a=("getRootNode"in s?s.getRootNode()instanceof U.ShadowRoot:!1)?s.getRootNode():s.ownerDocument.body;(!s.ownerDocument.defaultView||!a.contains(s))&&Be.warn("The element supplied is not included in the DOM"),e=e||{},e.restoreEl===!0&&(e.restoreEl=(s.parentNode&&s.parentNode.hasAttribute&&s.parentNode.hasAttribute("data-vjs-player")?s.parentNode:s).cloneNode(!0)),zs("beforesetup").forEach(l=>{const u=l(s,Je(e));if(!Zr(u)||Array.isArray(u)){Be.error("please return an object in beforesetup hooks");return}e=Je(e,u)});const o=ee.getComponent("Player");return i=new o(s,e,t),zs("setup").forEach(l=>l(i)),i}H.hooks_=hs;H.hooks=zs;H.hook=oL;H.hookOnce=lL;H.removeHook=fT;if(U.VIDEOJS_NO_DYNAMIC_STYLE!==!0&&Ha()){let r=Zs(".vjs-styles-defaults");if(!r){r=$T("vjs-styles-defaults");const e=Zs("head");e&&e.insertBefore(r,e.firstChild),BT(r,`
      .video-js {
        width: 300px;
        height: 150px;
      }

      .vjs-fluid:not(.vjs-audio-only-mode) {
        padding-top: 56.25%
      }
    `)}}vp(1,H);H.VERSION=gp;H.options=Ze.prototype.options_;H.getPlayers=()=>Ze.players;H.getPlayer=r=>{const e=Ze.players;let t;if(typeof r=="string"){const i=D_(r),s=e[i];if(s)return s;t=Zs("#"+i)}else t=r;if(Ya(t)){const{player:i,playerId:s}=t;if(i||e[s])return i||e[s]}};H.getAllPlayers=()=>Object.keys(Ze.players).map(r=>Ze.players[r]).filter(Boolean);H.players=Ze.players;H.getComponent=ee.getComponent;H.registerComponent=(r,e)=>(Le.isTech(e)&&Be.warn(`The ${r} tech was registered as a component. It should instead be registered using videojs.registerTech(name, tech)`),ee.registerComponent.call(ee,r,e));H.getTech=Le.getTech;H.registerTech=Le.registerTech;H.use=LL;Object.defineProperty(H,"middleware",{value:{},writeable:!1,enumerable:!0});Object.defineProperty(H.middleware,"TERMINATOR",{value:Zc,writeable:!1,enumerable:!0});H.browser=TT;H.obj=hL;H.mergeOptions=Sr(9,"videojs.mergeOptions","videojs.obj.merge",Je);H.defineLazyProperty=Sr(9,"videojs.defineLazyProperty","videojs.obj.defineLazyProperty",qh);H.bind=Sr(9,"videojs.bind","native Function.prototype.bind",ut);H.registerPlugin=Ai.registerPlugin;H.deregisterPlugin=Ai.deregisterPlugin;H.plugin=(r,e)=>(Be.warn("videojs.plugin() is deprecated; use videojs.registerPlugin() instead"),Ai.registerPlugin(r,e));H.getPlugins=Ai.getPlugins;H.getPlugin=Ai.getPlugin;H.getPluginVersion=Ai.getPluginVersion;H.addLanguage=function(r,e){return r=(""+r).toLowerCase(),H.options.languages=Je(H.options.languages,{[r]:e}),H.options.languages[r]};H.log=Be;H.createLogger=pT;H.time=CL;H.createTimeRange=Sr(9,"videojs.createTimeRange","videojs.time.createTimeRanges",mr);H.createTimeRanges=Sr(9,"videojs.createTimeRanges","videojs.time.createTimeRanges",mr);H.formatTime=Sr(9,"videojs.formatTime","videojs.time.formatTime",Mn);H.setFormatTime=Sr(9,"videojs.setFormatTime","videojs.time.setFormatTime",jT);H.resetFormatTime=Sr(9,"videojs.resetFormatTime","videojs.time.resetFormatTime",zT);H.parseUrl=Sr(9,"videojs.parseUrl","videojs.url.parseUrl",xg);H.isCrossOrigin=Sr(9,"videojs.isCrossOrigin","videojs.url.isCrossOrigin",ed);H.EventTarget=qi;H.any=bg;H.on=Ui;H.one=Kh;H.off=ni;H.trigger=Ga;H.xhr=K1;H.TrackList=In;H.TextTrack=Zl;H.TextTrackList=Tg;H.AudioTrack=GT;H.AudioTrackList=WT;H.VideoTrack=KT;H.VideoTrackList=HT;["isEl","isTextNode","createEl","hasClass","addClass","removeClass","toggleClass","setAttributes","getAttributes","emptyEl","appendContent","insertContent"].forEach(r=>{H[r]=function(){return Be.warn(`videojs.${r}() is deprecated; use videojs.dom.${r}() instead`),LT[r].apply(null,arguments)}});H.computedStyle=Sr(9,"videojs.computedStyle","videojs.dom.computedStyle",Ra);H.dom=LT;H.fn=vL;H.num=iQ;H.str=xL;H.url=IL;H.Error=kQ;/*! @name videojs-contrib-quality-levels @version 4.1.0 @license Apache-2.0 */class EQ{constructor(e){let t=this;return t.id=e.id,t.label=t.id,t.width=e.width,t.height=e.height,t.bitrate=e.bandwidth,t.frameRate=e.frameRate,t.enabled_=e.enabled,Object.defineProperty(t,"enabled",{get(){return t.enabled_()},set(i){t.enabled_(i)}}),t}}class Kc extends H.EventTarget{constructor(){super();let e=this;return e.levels_=[],e.selectedIndex_=-1,Object.defineProperty(e,"selectedIndex",{get(){return e.selectedIndex_}}),Object.defineProperty(e,"length",{get(){return e.levels_.length}}),e[Symbol.iterator]=()=>e.levels_.values(),e}addQualityLevel(e){let t=this.getQualityLevelById(e.id);if(t)return t;const i=this.levels_.length;return t=new EQ(e),""+i in this||Object.defineProperty(this,i,{get(){return this.levels_[i]}}),this.levels_.push(t),this.trigger({qualityLevel:t,type:"addqualitylevel"}),t}removeQualityLevel(e){let t=null;for(let i=0,s=this.length;i<s;i++)if(this[i]===e){t=this.levels_.splice(i,1)[0],this.selectedIndex_===i?this.selectedIndex_=-1:this.selectedIndex_>i&&this.selectedIndex_--;break}return t&&this.trigger({qualityLevel:e,type:"removequalitylevel"}),t}getQualityLevelById(e){for(let t=0,i=this.length;t<i;t++){const s=this[t];if(s.id===e)return s}return null}dispose(){this.selectedIndex_=-1,this.levels_.length=0}}Kc.prototype.allowedEvents_={change:"change",addqualitylevel:"addqualitylevel",removequalitylevel:"removequalitylevel"};for(const r in Kc.prototype.allowedEvents_)Kc.prototype["on"+r]=null;var M_="4.1.0";const AQ=function(r,e){const t=r.qualityLevels,i=new Kc,s=function(){i.dispose(),r.qualityLevels=t,r.off("dispose",s)};return r.on("dispose",s),r.qualityLevels=()=>i,r.qualityLevels.VERSION=M_,i},I_=function(r){return AQ(this,H.obj.merge({},r))};H.registerPlugin("qualityLevels",I_);I_.VERSION=M_;/*! @name @videojs/http-streaming @version 3.17.2 @license Apache-2.0 */const _i=Bh,Jc=(r,e)=>e&&e.responseURL&&r!==e.responseURL?e.responseURL:r,ar=r=>H.log.debug?H.log.debug.bind(H,"VHS:",`${r} >`):function(){};function We(...r){const e=H.obj||H;return(e.merge||e.mergeOptions).apply(e,r)}function Xt(...r){const e=H.time||H;return(e.createTimeRanges||e.createTimeRanges).apply(e,r)}function PQ(r){if(r.length===0)return"Buffered Ranges are empty";let e=`Buffered Ranges: 
`;for(let t=0;t<r.length;t++){const i=r.start(t),s=r.end(t);e+=`${i} --> ${s}. Duration (${s-i})
`}return e}const Nr=1/30,Fr=Nr*3,R_=function(r,e){const t=[];let i;if(r&&r.length)for(i=0;i<r.length;i++)e(r.start(i),r.end(i))&&t.push([r.start(i),r.end(i)]);return Xt(t)},ra=function(r,e){return R_(r,function(t,i){return t-Fr<=e&&i+Fr>=e})},Nu=function(r,e){return R_(r,function(t){return t-Nr>=e})},DQ=function(r){if(r.length<2)return Xt();const e=[];for(let t=1;t<r.length;t++){const i=r.end(t-1),s=r.start(t);e.push([i,s])}return Xt(e)},MQ=function(r,e){let t=null,i=null,s=0;const n=[],a=[];if(!r||!r.length||!e||!e.length)return Xt();let o=r.length;for(;o--;)n.push({time:r.start(o),type:"start"}),n.push({time:r.end(o),type:"end"});for(o=e.length;o--;)n.push({time:e.start(o),type:"start"}),n.push({time:e.end(o),type:"end"});for(n.sort(function(l,u){return l.time-u.time}),o=0;o<n.length;o++)n[o].type==="start"?(s++,s===2&&(t=n[o].time)):n[o].type==="end"&&(s--,s===1&&(i=n[o].time)),t!==null&&i!==null&&(a.push([t,i]),t=null,i=null);return Xt(a)},L_=r=>{const e=[];if(!r||!r.length)return"";for(let t=0;t<r.length;t++)e.push(r.start(t)+" => "+r.end(t));return e.join(", ")},IQ=function(r,e,t=1){return((r.length?r.end(r.length-1):0)-e)/t},bn=r=>{const e=[];for(let t=0;t<r.length;t++)e.push({start:r.start(t),end:r.end(t)});return e},RQ=function(r,e){if(r===e)return!1;if(!r&&e||!e&&r||r.length!==e.length)return!0;for(let t=0;t<r.length;t++)if(r.start(t)!==e.start(t)||r.end(t)!==e.end(t))return!0;return!1},ff=function(r){if(!(!r||!r.length||!r.end))return r.end(r.length-1)},Ug=function(r,e){let t=0;if(!r||!r.length)return t;for(let i=0;i<r.length;i++){const s=r.start(i),n=r.end(i);if(!(e>n)){if(e>s&&e<=n){t+=n-e;continue}t+=n-s}}return t},qg=(r,e)=>{if(!e.preload)return e.duration;let t=0;return(e.parts||[]).forEach(function(i){t+=i.duration}),(e.preloadHints||[]).forEach(function(i){i.type==="PART"&&(t+=r.partTargetDuration)}),t},Ep=r=>(r.segments||[]).reduce((e,t,i)=>(t.parts?t.parts.forEach(function(s,n){e.push({duration:s.duration,segmentIndex:i,partIndex:n,part:s,segment:t})}):e.push({duration:t.duration,segmentIndex:i,partIndex:null,segment:t,part:null}),e),[]),Q_=r=>{const e=r.segments&&r.segments.length&&r.segments[r.segments.length-1];return e&&e.parts||[]},$_=({preloadSegment:r})=>{if(!r)return;const{parts:e,preloadHints:t}=r;let i=(t||[]).reduce((s,n)=>s+(n.type==="PART"?1:0),0);return i+=e&&e.length?e.length:0,i},B_=(r,e)=>{if(e.endList)return 0;if(r&&r.suggestedPresentationDelay)return r.suggestedPresentationDelay;const t=Q_(e).length>0;return t&&e.serverControl&&e.serverControl.partHoldBack?e.serverControl.partHoldBack:t&&e.partTargetDuration?e.partTargetDuration*3:e.serverControl&&e.serverControl.holdBack?e.serverControl.holdBack:e.targetDuration?e.targetDuration*3:0},LQ=function(r,e){let t=0,i=e-r.mediaSequence,s=r.segments[i];if(s){if(typeof s.start<"u")return{result:s.start,precise:!0};if(typeof s.end<"u")return{result:s.end-s.duration,precise:!0}}for(;i--;){if(s=r.segments[i],typeof s.end<"u")return{result:t+s.end,precise:!0};if(t+=qg(r,s),typeof s.start<"u")return{result:t+s.start,precise:!0}}return{result:t,precise:!1}},QQ=function(r,e){let t=0,i,s=e-r.mediaSequence;for(;s<r.segments.length;s++){if(i=r.segments[s],typeof i.start<"u")return{result:i.start-t,precise:!0};if(t+=qg(r,i),typeof i.end<"u")return{result:i.end-t,precise:!0}}return{result:-1,precise:!1}},N_=function(r,e,t){if(typeof e>"u"&&(e=r.mediaSequence+r.segments.length),e<r.mediaSequence)return 0;const i=LQ(r,e);if(i.precise)return i.result;const s=QQ(r,e);return s.precise?s.result:i.result+t},F_=function(r,e,t){if(!r)return 0;if(typeof t!="number"&&(t=0),typeof e>"u"){if(r.totalDuration)return r.totalDuration;if(!r.endList)return U.Infinity}return N_(r,e,t)},Ko=function({defaultDuration:r,durationList:e,startIndex:t,endIndex:i}){let s=0;if(t>i&&([t,i]=[i,t]),t<0){for(let n=t;n<Math.min(0,i);n++)s+=r;t=0}for(let n=t;n<i;n++)s+=e[n].duration;return s},U_=function(r,e,t,i){if(!r||!r.segments)return null;if(r.endList)return F_(r);if(e===null)return null;e=e||0;let s=N_(r,r.mediaSequence+r.segments.length,e);return t&&(i=typeof i=="number"?i:B_(null,r),s-=i),Math.max(0,s)},$Q=function(r,e,t){const s=e||0;let n=U_(r,e,!0,t);return n===null?Xt():(n<s&&(n=s),Xt(s,n))},BQ=function({playlist:r,currentTime:e,startingSegmentIndex:t,startingPartIndex:i,startTime:s,exactManifestTimings:n}){let a=e-s;const o=Ep(r);let l=0;for(let u=0;u<o.length;u++){const c=o[u];if(t===c.segmentIndex&&!(typeof i=="number"&&typeof c.partIndex=="number"&&i!==c.partIndex)){l=u;break}}if(a<0){if(l>0)for(let u=l-1;u>=0;u--){const c=o[u];if(a+=c.duration,n){if(a<0)continue}else if(a+Nr<=0)continue;return{partIndex:c.partIndex,segmentIndex:c.segmentIndex,startTime:s-Ko({defaultDuration:r.targetDuration,durationList:o,startIndex:l,endIndex:u})}}return{partIndex:o[0]&&o[0].partIndex||null,segmentIndex:o[0]&&o[0].segmentIndex||0,startTime:e}}if(l<0){for(let u=l;u<0;u++)if(a-=r.targetDuration,a<0)return{partIndex:o[0]&&o[0].partIndex||null,segmentIndex:o[0]&&o[0].segmentIndex||0,startTime:e};l=0}for(let u=l;u<o.length;u++){const c=o[u];a-=c.duration;const h=c.duration>Nr,f=a===0,m=h&&a+Nr>=0;if(!((f||m)&&u!==o.length-1)){if(n){if(a>0)continue}else if(a-Nr>=0)continue;return{partIndex:c.partIndex,segmentIndex:c.segmentIndex,startTime:s+Ko({defaultDuration:r.targetDuration,durationList:o,startIndex:l,endIndex:u})}}}return{segmentIndex:o[o.length-1].segmentIndex,partIndex:o[o.length-1].partIndex,startTime:e}},q_=function(r){return r.excludeUntil&&r.excludeUntil>Date.now()},Vg=function(r){return r.excludeUntil&&r.excludeUntil===1/0},sd=function(r){const e=q_(r);return!r.disabled&&!e},NQ=function(r){return r.disabled},FQ=function(r){for(let e=0;e<r.segments.length;e++)if(r.segments[e].key)return!0;return!1},V_=function(r,e){return e.attributes&&e.attributes[r]},UQ=function(r,e,t,i=0){return V_("BANDWIDTH",t)?(r*t.attributes.BANDWIDTH-i*8)/e:NaN},Ap=(r,e)=>{if(r.playlists.length===1)return!0;const t=e.attributes.BANDWIDTH||Number.MAX_VALUE;return r.playlists.filter(i=>sd(i)?(i.attributes.BANDWIDTH||0)<t:!1).length===0},Xg=(r,e)=>!r&&!e||!r&&e||r&&!e?!1:!!(r===e||r.id&&e.id&&r.id===e.id||r.resolvedUri&&e.resolvedUri&&r.resolvedUri===e.resolvedUri||r.uri&&e.uri&&r.uri===e.uri),ib=function(r,e){const t=r&&r.mediaGroups&&r.mediaGroups.AUDIO||{};let i=!1;for(const s in t){for(const n in t[s])if(i=e(t[s][n]),i)break;if(i)break}return!!i},Gl=r=>{if(!r||!r.playlists||!r.playlists.length)return ib(r,t=>t.playlists&&t.playlists.length||t.uri);for(let e=0;e<r.playlists.length;e++){const t=r.playlists[e],i=t.attributes&&t.attributes.CODECS;if(!(i&&i.split(",").every(n=>tT(n))||ib(r,n=>Xg(t,n))))return!1}return!0};var Ci={liveEdgeDelay:B_,duration:F_,seekable:$Q,getMediaInfoForTime:BQ,isEnabled:sd,isDisabled:NQ,isExcluded:q_,isIncompatible:Vg,playlistEnd:U_,isAes:FQ,hasAttribute:V_,estimateSegmentRequestTime:UQ,isLowestEnabledRendition:Ap,isAudioOnly:Gl,playlistMatch:Xg,segmentDurationWithParts:qg};const{log:X_}=H,pa=(r,e)=>`${r}-${e}`,j_=(r,e,t)=>`placeholder-uri-${r}-${e}-${t}`,qQ=({onwarn:r,oninfo:e,manifestString:t,customTagParsers:i=[],customTagMappers:s=[],llhls:n})=>{const a=new AI;r&&a.on("warn",r),e&&a.on("info",e),i.forEach(u=>a.addParser(u)),s.forEach(u=>a.addTagMapper(u)),a.push(t),a.end();const o=a.manifest;if(n||(["preloadSegment","skip","serverControl","renditionReports","partInf","partTargetDuration"].forEach(function(u){o.hasOwnProperty(u)&&delete o[u]}),o.segments&&o.segments.forEach(function(u){["parts","preloadHints"].forEach(function(c){u.hasOwnProperty(c)&&delete u[c]})})),!o.targetDuration){let u=10;o.segments&&o.segments.length&&(u=o.segments.reduce((c,h)=>Math.max(c,h.duration),0)),r&&r({message:`manifest has no targetDuration defaulting to ${u}`}),o.targetDuration=u}const l=Q_(o);if(l.length&&!o.partTargetDuration){const u=l.reduce((c,h)=>Math.max(c,h.duration),0);r&&(r({message:`manifest has no partTargetDuration defaulting to ${u}`}),X_.error("LL-HLS manifest has parts but lacks required #EXT-X-PART-INF:PART-TARGET value. See https://datatracker.ietf.org/doc/html/draft-pantos-hls-rfc8216bis-09#section-4.4.3.7. Playback is not guaranteed.")),o.partTargetDuration=u}return o},to=(r,e)=>{r.mediaGroups&&["AUDIO","SUBTITLES"].forEach(t=>{if(r.mediaGroups[t])for(const i in r.mediaGroups[t])for(const s in r.mediaGroups[t][i]){const n=r.mediaGroups[t][i][s];e(n,t,i,s)}})},z_=({playlist:r,uri:e,id:t})=>{r.id=t,r.playlistErrors_=0,e&&(r.uri=e),r.attributes=r.attributes||{}},VQ=r=>{let e=r.playlists.length;for(;e--;){const t=r.playlists[e];z_({playlist:t,id:pa(e,t.uri)}),t.resolvedUri=_i(r.uri,t.uri),r.playlists[t.id]=t,r.playlists[t.uri]=t,t.attributes.BANDWIDTH||X_.warn("Invalid playlist STREAM-INF detected. Missing BANDWIDTH attribute.")}},XQ=r=>{to(r,e=>{e.uri&&(e.resolvedUri=_i(r.uri,e.uri))})},jQ=(r,e)=>{const t=pa(0,e),i={mediaGroups:{AUDIO:{},VIDEO:{},"CLOSED-CAPTIONS":{},SUBTITLES:{}},uri:U.location.href,resolvedUri:U.location.href,playlists:[{uri:e,id:t,resolvedUri:e,attributes:{}}]};return i.playlists[t]=i.playlists[0],i.playlists[e]=i.playlists[0],i},Z_=(r,e,t=j_)=>{r.uri=e;for(let s=0;s<r.playlists.length;s++)if(!r.playlists[s].uri){const n=`placeholder-uri-${s}`;r.playlists[s].uri=n}const i=Gl(r);to(r,(s,n,a,o)=>{if(!s.playlists||!s.playlists.length){if(i&&n==="AUDIO"&&!s.uri)for(let l=0;l<r.playlists.length;l++){const u=r.playlists[l];if(u.attributes&&u.attributes.AUDIO&&u.attributes.AUDIO===a)return}s.playlists=[At({},s)]}s.playlists.forEach(function(l,u){const c=t(n,a,o,l),h=pa(u,c);l.uri?l.resolvedUri=l.resolvedUri||_i(r.uri,l.uri):(l.uri=u===0?c:h,l.resolvedUri=l.uri),l.id=l.id||h,l.attributes=l.attributes||{},r.playlists[l.id]=l,r.playlists[l.uri]=l})}),VQ(r),XQ(r)};class rb{constructor(){this.offset_=null,this.pendingDateRanges_=new Map,this.processedDateRanges_=new Map}setOffset(e=[]){if(this.offset_!==null||!e.length)return;const[t]=e;t.programDateTime!==void 0&&(this.offset_=t.programDateTime/1e3)}setPendingDateRanges(e=[]){if(!e.length)return;const[t]=e,i=t.startDate.getTime();this.trimProcessedDateRanges_(i),this.pendingDateRanges_=e.reduce((s,n)=>(s.set(n.id,n),s),new Map)}processDateRange(e){this.pendingDateRanges_.delete(e.id),this.processedDateRanges_.set(e.id,e)}getDateRangesToProcess(){if(this.offset_===null)return[];const e={},t=[];this.pendingDateRanges_.forEach((i,s)=>{if(!this.processedDateRanges_.has(s)&&(i.startTime=i.startDate.getTime()/1e3-this.offset_,i.processDateRange=()=>this.processDateRange(i),t.push(i),!!i.class))if(e[i.class]){const n=e[i.class].push(i);i.classListIndex=n-1}else e[i.class]=[i],i.classListIndex=0});for(const i of t){const s=e[i.class]||[];i.endDate?i.endTime=i.endDate.getTime()/1e3-this.offset_:i.endOnNext&&s[i.classListIndex+1]?i.endTime=s[i.classListIndex+1].startTime:i.duration?i.endTime=i.startTime+i.duration:i.plannedDuration?i.endTime=i.startTime+i.plannedDuration:i.endTime=i.startTime}return t}trimProcessedDateRanges_(e){new Map(this.processedDateRanges_).forEach((i,s)=>{i.startDate.getTime()<e&&this.processedDateRanges_.delete(s)})}}const W_=22,Pn=({requestType:r,request:e,error:t,parseFailure:i})=>{const s=e.status<200||e.status>299,n=e.status>=400&&e.status<=499,a={uri:e.uri,requestType:r},o=s&&!n||i;if(t&&n)a.error=At({},t),a.errorType=H.Error.NetworkRequestFailed;else if(e.aborted)a.errorType=H.Error.NetworkRequestAborted;else if(e.timedout)a.errorType=H.Error.NetworkRequestTimeout;else if(o){const l=i?H.Error.NetworkBodyParserFailed:H.Error.NetworkBadStatus;a.errorType=l,a.status=e.status,a.headers=e.headers}return a},zQ=ar("CodecUtils"),H_=function(r){const e=r.attributes||{};if(e.CODECS)return Ir(e.CODECS)},Y_=(r,e)=>{const t=e.attributes||{};return r&&r.mediaGroups&&r.mediaGroups.AUDIO&&t.AUDIO&&r.mediaGroups.AUDIO[t.AUDIO]},ZQ=(r,e)=>{if(!Y_(r,e))return!0;const t=e.attributes||{},i=r.mediaGroups.AUDIO[t.AUDIO];for(const s in i)if(!i[s].uri&&!i[s].playlists)return!0;return!1},gl=function(r){const e={};return r.forEach(({mediaType:t,type:i,details:s})=>{e[t]=e[t]||[],e[t].push(eT(`${i}${s}`))}),Object.keys(e).forEach(function(t){if(e[t].length>1){zQ(`multiple ${t} codecs found as attributes: ${e[t].join(", ")}. Setting playlist codecs to null so that we wait for mux.js to probe segments for real codecs.`),e[t]=null;return}e[t]=e[t][0]}),e},sb=function(r){let e=0;return r.audio&&e++,r.video&&e++,e},Jo=function(r,e){const t=e.attributes||{},i=gl(H_(e)||[]);if(Y_(r,e)&&!i.audio&&!ZQ(r,e)){const s=gl(DI(r,t.AUDIO)||[]);s.audio&&(i.audio=s.audio)}return i},{EventTarget:WQ}=H,HQ=(r,e)=>{if(e.endList||!e.serverControl)return r;const t={};if(e.serverControl.canBlockReload){const{preloadSegment:i}=e;let s=e.mediaSequence+e.segments.length;if(i){const n=i.parts||[],a=$_(e)-1;a>-1&&a!==n.length-1&&(t._HLS_part=a),(a>-1||n.length)&&s--}t._HLS_msn=s}if(e.serverControl&&e.serverControl.canSkipUntil&&(t._HLS_skip=e.serverControl.canSkipDateranges?"v2":"YES"),Object.keys(t).length){const i=new U.URL(r);["_HLS_skip","_HLS_msn","_HLS_part"].forEach(function(s){t.hasOwnProperty(s)&&i.searchParams.set(s,t[s])}),r=i.toString()}return r},YQ=(r,e)=>{if(!r)return e;const t=We(r,e);if(r.preloadHints&&!e.preloadHints&&delete t.preloadHints,r.parts&&!e.parts)delete t.parts;else if(r.parts&&e.parts)for(let i=0;i<e.parts.length;i++)r.parts&&r.parts[i]&&(t.parts[i]=We(r.parts[i],e.parts[i]));return!r.skipped&&e.skipped&&(t.skipped=!1),r.preload&&!e.preload&&(t.preload=!1),t},GQ=(r,e,t)=>{const i=r.slice(),s=e.slice();t=t||0;const n=[];let a;for(let o=0;o<s.length;o++){const l=i[o+t],u=s[o];l?(a=l.map||a,n.push(YQ(l,u))):(a&&!u.map&&(u.map=a),n.push(u))}return n},G_=(r,e)=>{!r.resolvedUri&&r.uri&&(r.resolvedUri=_i(e,r.uri)),r.key&&!r.key.resolvedUri&&(r.key.resolvedUri=_i(e,r.key.uri)),r.map&&!r.map.resolvedUri&&(r.map.resolvedUri=_i(e,r.map.uri)),r.map&&r.map.key&&!r.map.key.resolvedUri&&(r.map.key.resolvedUri=_i(e,r.map.key.uri)),r.parts&&r.parts.length&&r.parts.forEach(t=>{t.resolvedUri||(t.resolvedUri=_i(e,t.uri))}),r.preloadHints&&r.preloadHints.length&&r.preloadHints.forEach(t=>{t.resolvedUri||(t.resolvedUri=_i(e,t.uri))})},K_=function(r){const e=r.segments||[],t=r.preloadSegment;if(t&&t.parts&&t.parts.length){if(t.preloadHints){for(let i=0;i<t.preloadHints.length;i++)if(t.preloadHints[i].type==="MAP")return e}t.duration=r.targetDuration,t.preload=!0,e.push(t)}return e},J_=(r,e)=>r===e||r.segments&&e.segments&&r.segments.length===e.segments.length&&r.endList===e.endList&&r.mediaSequence===e.mediaSequence&&r.preloadSegment===e.preloadSegment,Pp=(r,e,t=J_)=>{const i=We(r,{}),s=i.playlists[e.id];if(!s||t(s,e))return null;e.segments=K_(e);const n=We(s,e);if(n.preloadSegment&&!e.preloadSegment&&delete n.preloadSegment,s.segments){if(e.skip){e.segments=e.segments||[];for(let a=0;a<e.skip.skippedSegments;a++)e.segments.unshift({skipped:!0})}n.segments=GQ(s.segments,e.segments,e.mediaSequence-s.mediaSequence)}n.segments.forEach(a=>{G_(a,n.resolvedUri)});for(let a=0;a<i.playlists.length;a++)i.playlists[a].id===e.id&&(i.playlists[a]=n);return i.playlists[e.id]=n,i.playlists[e.uri]=n,to(r,(a,o,l,u)=>{if(a.playlists)for(let c=0;c<a.playlists.length;c++)e.id===a.playlists[c].id&&(a.playlists[c]=n)}),i},Dp=(r,e)=>{const t=r.segments||[],i=t[t.length-1],s=i&&i.parts&&i.parts[i.parts.length-1],n=s&&s.duration||i&&i.duration;return e&&n?n*1e3:(r.partTargetDuration||r.targetDuration||10)*500},nb=(r,e,t)=>{if(!r)return;const i=[];return r.forEach(s=>{if(!s.attributes)return;const{BANDWIDTH:n,RESOLUTION:a,CODECS:o}=s.attributes;i.push({id:s.id,bandwidth:n,resolution:a,codecs:o})}),{type:e,isLive:t,renditions:i}};class sa extends WQ{constructor(e,t,i={}){if(super(),!e)throw new Error("A non-empty playlist URL or object is required");this.logger_=ar("PlaylistLoader");const{withCredentials:s=!1}=i;this.src=e,this.vhs_=t,this.withCredentials=s,this.addDateRangesToTextTrack_=i.addDateRangesToTextTrack;const n=t.options_;this.customTagParsers=n&&n.customTagParsers||[],this.customTagMappers=n&&n.customTagMappers||[],this.llhls=n&&n.llhls,this.dateRangesStorage_=new rb,this.state="HAVE_NOTHING",this.handleMediaupdatetimeout_=this.handleMediaupdatetimeout_.bind(this),this.on("mediaupdatetimeout",this.handleMediaupdatetimeout_),this.on("loadedplaylist",this.handleLoadedPlaylist_.bind(this))}handleLoadedPlaylist_(){const e=this.media();if(!e)return;this.dateRangesStorage_.setOffset(e.segments),this.dateRangesStorage_.setPendingDateRanges(e.dateRanges);const t=this.dateRangesStorage_.getDateRangesToProcess();!t.length||!this.addDateRangesToTextTrack_||this.addDateRangesToTextTrack_(t)}handleMediaupdatetimeout_(){if(this.state!=="HAVE_METADATA")return;const e=this.media();let t=_i(this.main.uri,e.uri);this.llhls&&(t=HQ(t,e)),this.state="HAVE_CURRENT_METADATA",this.request=this.vhs_.xhr({uri:t,withCredentials:this.withCredentials,requestType:"hls-playlist"},(i,s)=>{if(this.request){if(i)return this.playlistRequestError(this.request,this.media(),"HAVE_METADATA");this.haveMetadata({playlistString:this.request.responseText,url:this.media().uri,id:this.media().id})}})}playlistRequestError(e,t,i){const{uri:s,id:n}=t;this.request=null,i&&(this.state=i),this.error={playlist:this.main.playlists[n],status:e.status,message:`HLS playlist request error at URL: ${s}.`,responseText:e.responseText,code:e.status>=500?4:2,metadata:Pn({requestType:e.requestType,request:e,error:e.error})},this.trigger("error")}parseManifest_({url:e,manifestString:t}){try{const i=qQ({onwarn:({message:s})=>this.logger_(`m3u8-parser warn for ${e}: ${s}`),oninfo:({message:s})=>this.logger_(`m3u8-parser info for ${e}: ${s}`),manifestString:t,customTagParsers:this.customTagParsers,customTagMappers:this.customTagMappers,llhls:this.llhls});return!i.playlists||!i.playlists.length||this.excludeAudioOnlyVariants(i.playlists),i}catch(i){this.error=i,this.error.metadata={errorType:H.Error.StreamingHlsPlaylistParserError,error:i}}}excludeAudioOnlyVariants(e){const t=i=>{const s=i.attributes||{},{width:n,height:a}=s.RESOLUTION||{};if(n&&a)return!0;const o=H_(i)||[];return!!gl(o).video};e.some(t)&&e.forEach(i=>{t(i)||(i.excludeUntil=1/0)})}haveMetadata({playlistString:e,playlistObject:t,url:i,id:s}){this.request=null,this.state="HAVE_METADATA";const n={playlistInfo:{type:"media",uri:i}};this.trigger({type:"playlistparsestart",metadata:n});const a=t||this.parseManifest_({url:i,manifestString:e});a.lastRequest=Date.now(),z_({playlist:a,uri:i,id:s});const o=Pp(this.main,a);this.targetDuration=a.partTargetDuration||a.targetDuration,this.pendingMedia_=null,o?(this.main=o,this.media_=this.main.playlists[s]):this.trigger("playlistunchanged"),this.updateMediaUpdateTimeout_(Dp(this.media(),!!o)),n.parsedPlaylist=nb(this.main.playlists,n.playlistInfo.type,!this.media_.endList),this.trigger({type:"playlistparsecomplete",metadata:n}),this.trigger("loadedplaylist")}dispose(){this.trigger("dispose"),this.stopRequest(),U.clearTimeout(this.mediaUpdateTimeout),U.clearTimeout(this.finalRenditionTimeout),this.dateRangesStorage_=new rb,this.off()}stopRequest(){if(this.request){const e=this.request;this.request=null,e.onreadystatechange=null,e.abort()}}media(e,t){if(!e)return this.media_;if(this.state==="HAVE_NOTHING")throw new Error("Cannot switch media playlist from "+this.state);if(typeof e=="string"){if(!this.main.playlists[e])throw new Error("Unknown playlist URI: "+e);e=this.main.playlists[e]}if(U.clearTimeout(this.finalRenditionTimeout),t){const o=(e.partTargetDuration||e.targetDuration)/2*1e3||5e3;this.finalRenditionTimeout=U.setTimeout(this.media.bind(this,e,!1),o);return}const i=this.state,s=!this.media_||e.id!==this.media_.id,n=this.main.playlists[e.id];if(n&&n.endList||e.endList&&e.segments.length){this.request&&(this.request.onreadystatechange=null,this.request.abort(),this.request=null),this.state="HAVE_METADATA",this.media_=e,s&&(this.trigger("mediachanging"),i==="HAVE_MAIN_MANIFEST"?this.trigger("loadedmetadata"):this.trigger("mediachange"));return}if(this.updateMediaUpdateTimeout_(Dp(e,!0)),!s)return;if(this.state="SWITCHING_MEDIA",this.request){if(e.resolvedUri===this.request.url)return;this.request.onreadystatechange=null,this.request.abort(),this.request=null}this.media_&&this.trigger("mediachanging"),this.pendingMedia_=e;const a={playlistInfo:{type:"media",uri:e.uri}};this.trigger({type:"playlistrequeststart",metadata:a}),this.request=this.vhs_.xhr({uri:e.resolvedUri,withCredentials:this.withCredentials,requestType:"hls-playlist"},(o,l)=>{if(this.request){if(e.lastRequest=Date.now(),e.resolvedUri=Jc(e.resolvedUri,l),o)return this.playlistRequestError(this.request,e,i);this.trigger({type:"playlistrequestcomplete",metadata:a}),this.haveMetadata({playlistString:l.responseText,url:e.uri,id:e.id}),i==="HAVE_MAIN_MANIFEST"?this.trigger("loadedmetadata"):this.trigger("mediachange")}})}pause(){this.mediaUpdateTimeout&&(U.clearTimeout(this.mediaUpdateTimeout),this.mediaUpdateTimeout=null),this.stopRequest(),this.state==="HAVE_NOTHING"&&(this.started=!1),this.state==="SWITCHING_MEDIA"?this.media_?this.state="HAVE_METADATA":this.state="HAVE_MAIN_MANIFEST":this.state==="HAVE_CURRENT_METADATA"&&(this.state="HAVE_METADATA")}load(e){this.mediaUpdateTimeout&&(U.clearTimeout(this.mediaUpdateTimeout),this.mediaUpdateTimeout=null);const t=this.media();if(e){const i=t?(t.partTargetDuration||t.targetDuration)/2*1e3:5e3;this.mediaUpdateTimeout=U.setTimeout(()=>{this.mediaUpdateTimeout=null,this.load()},i);return}if(!this.started){this.start();return}t&&!t.endList?this.trigger("mediaupdatetimeout"):this.trigger("loadedplaylist")}updateMediaUpdateTimeout_(e){this.mediaUpdateTimeout&&(U.clearTimeout(this.mediaUpdateTimeout),this.mediaUpdateTimeout=null),!(!this.media()||this.media().endList)&&(this.mediaUpdateTimeout=U.setTimeout(()=>{this.mediaUpdateTimeout=null,this.trigger("mediaupdatetimeout"),this.updateMediaUpdateTimeout_(e)},e))}start(){if(this.started=!0,typeof this.src=="object"){this.src.uri||(this.src.uri=U.location.href),this.src.resolvedUri=this.src.uri,setTimeout(()=>{this.setupInitialPlaylist(this.src)},0);return}const e={playlistInfo:{type:"multivariant",uri:this.src}};this.trigger({type:"playlistrequeststart",metadata:e}),this.request=this.vhs_.xhr({uri:this.src,withCredentials:this.withCredentials,requestType:"hls-playlist"},(t,i)=>{if(!this.request)return;if(this.request=null,t)return this.error={status:i.status,message:`HLS playlist request error at URL: ${this.src}.`,responseText:i.responseText,code:2,metadata:Pn({requestType:i.requestType,request:i,error:t})},this.state==="HAVE_NOTHING"&&(this.started=!1),this.trigger("error");this.trigger({type:"playlistrequestcomplete",metadata:e}),this.src=Jc(this.src,i),this.trigger({type:"playlistparsestart",metadata:e});const s=this.parseManifest_({manifestString:i.responseText,url:this.src});e.parsedPlaylist=nb(s.playlists,e.playlistInfo.type,!1),this.trigger({type:"playlistparsecomplete",metadata:e}),this.setupInitialPlaylist(s)})}srcUri(){return typeof this.src=="string"?this.src:this.src.uri}setupInitialPlaylist(e){if(this.state="HAVE_MAIN_MANIFEST",e.playlists){this.main=e,Z_(this.main,this.srcUri()),e.playlists.forEach(i=>{i.segments=K_(i),i.segments.forEach(s=>{G_(s,i.resolvedUri)})}),this.trigger("loadedplaylist"),this.request||this.media(this.main.playlists[0]);return}const t=this.srcUri()||U.location.href;this.main=jQ(e,t),this.haveMetadata({playlistObject:e,url:t,id:this.main.playlists[0].id}),this.trigger("loadedmetadata")}updateOrDeleteClone(e,t){const i=this.main,s=e.ID;let n=i.playlists.length;for(;n--;){const a=i.playlists[n];if(a.attributes["PATHWAY-ID"]===s){const o=a.resolvedUri,l=a.id;if(t){const u=this.createCloneURI_(a.resolvedUri,e),c=pa(s,u),h=this.createCloneAttributes_(s,a.attributes),f=this.createClonePlaylist_(a,c,e,h);i.playlists[n]=f,i.playlists[c]=f,i.playlists[u]=f}else i.playlists.splice(n,1);delete i.playlists[l],delete i.playlists[o]}}this.updateOrDeleteCloneMedia(e,t)}updateOrDeleteCloneMedia(e,t){const i=this.main,s=e.ID;["AUDIO","SUBTITLES","CLOSED-CAPTIONS"].forEach(n=>{if(!(!i.mediaGroups[n]||!i.mediaGroups[n][s])){for(const a in i.mediaGroups[n])if(a===s){for(const o in i.mediaGroups[n][a])i.mediaGroups[n][a][o].playlists.forEach((u,c)=>{const h=i.playlists[u.id],f=h.id,m=h.resolvedUri;delete i.playlists[f],delete i.playlists[m]});delete i.mediaGroups[n][a]}}}),t&&this.createClonedMediaGroups_(e)}addClonePathway(e,t={}){const i=this.main,s=i.playlists.length,n=this.createCloneURI_(t.resolvedUri,e),a=pa(e.ID,n),o=this.createCloneAttributes_(e.ID,t.attributes),l=this.createClonePlaylist_(t,a,e,o);i.playlists[s]=l,i.playlists[a]=l,i.playlists[n]=l,this.createClonedMediaGroups_(e)}createClonedMediaGroups_(e){const t=e.ID,i=e["BASE-ID"],s=this.main;["AUDIO","SUBTITLES","CLOSED-CAPTIONS"].forEach(n=>{if(!(!s.mediaGroups[n]||s.mediaGroups[n][t]))for(const a in s.mediaGroups[n]){if(a===i)s.mediaGroups[n][t]={};else continue;for(const o in s.mediaGroups[n][a]){const l=s.mediaGroups[n][a][o];s.mediaGroups[n][t][o]=At({},l);const u=s.mediaGroups[n][t][o],c=this.createCloneURI_(l.resolvedUri,e);u.resolvedUri=c,u.uri=c,u.playlists=[],l.playlists.forEach((h,f)=>{const m=s.playlists[h.id],S=j_(n,t,o),y=pa(t,S);if(m&&!s.playlists[y]){const E=this.createClonePlaylist_(m,y,e),C=E.resolvedUri;s.playlists[y]=E,s.playlists[C]=E}u.playlists[f]=this.createClonePlaylist_(h,y,e)})}}})}createClonePlaylist_(e,t,i,s){const n=this.createCloneURI_(e.resolvedUri,i),a={resolvedUri:n,uri:n,id:t};return e.segments&&(a.segments=[]),s&&(a.attributes=s),We(e,a)}createCloneURI_(e,t){const i=new URL(e);i.hostname=t["URI-REPLACEMENT"].HOST;const s=t["URI-REPLACEMENT"].PARAMS;for(const n of Object.keys(s))i.searchParams.set(n,s[n]);return i.href}createCloneAttributes_(e,t){const i={"PATHWAY-ID":e};return["AUDIO","SUBTITLES","CLOSED-CAPTIONS"].forEach(s=>{t[s]&&(i[s]=e)}),i}getKeyIdSet(e){const t=new Set;if(!e||!e.contentProtection)return t;for(const i in e.contentProtection)if(e.contentProtection[i]&&e.contentProtection[i].attributes&&e.contentProtection[i].attributes.keyId){const s=e.contentProtection[i].attributes.keyId;t.add(s.toLowerCase())}return t}}const Mp=function(r,e,t,i){const s=r.responseType==="arraybuffer"?r.response:r.responseText;!e&&s&&(r.responseTime=Date.now(),r.roundTripTime=r.responseTime-r.requestTime,r.bytesReceived=s.byteLength||s.length,r.bandwidth||(r.bandwidth=Math.floor(r.bytesReceived/r.roundTripTime*8*1e3))),t.headers&&(r.responseHeaders=t.headers),e&&e.code==="ETIMEDOUT"&&(r.timedout=!0),!e&&!r.aborted&&t.statusCode!==200&&t.statusCode!==206&&t.statusCode!==0&&(e=new Error("XHR Failed with a response of: "+(r&&(s||r.responseText)))),i(e,r)},KQ=(r,e)=>{if(!r||!r.size)return;let t=e;return r.forEach(i=>{t=i(t)}),t},JQ=(r,e,t,i)=>{!r||!r.size||r.forEach(s=>{s(e,t,i)})},ex=function(){const r=function e(t,i){t=We({timeout:45e3},t);const s=e.beforeRequest||H.Vhs.xhr.beforeRequest,n=e._requestCallbackSet||H.Vhs.xhr._requestCallbackSet||new Set,a=e._responseCallbackSet||H.Vhs.xhr._responseCallbackSet;s&&typeof s=="function"&&(H.log.warn("beforeRequest is deprecated, use onRequest instead."),n.add(s));const o=H.Vhs.xhr.original===!0?H.xhr:H.Vhs.xhr,l=KQ(n,t);n.delete(s);const u=o(l||t,function(h,f){return JQ(a,u,h,f),Mp(u,h,f,i)}),c=u.abort;return u.abort=function(){return u.aborted=!0,c.apply(u,arguments)},u.uri=t.uri,u.requestType=t.requestType,u.requestTime=Date.now(),u};return r.original=!0,r},e$=function(r){let e;const t=r.offset;return typeof r.offset=="bigint"||typeof r.length=="bigint"?e=U.BigInt(r.offset)+U.BigInt(r.length)-U.BigInt(1):e=r.offset+r.length-1,"bytes="+t+"-"+e},Ip=function(r){const e={};return r.byterange&&(e.Range=e$(r.byterange)),e},t$=function(r,e){return r.start(e)+"-"+r.end(e)},i$=function(r,e){const t=r.toString(16);return"00".substring(0,2-t.length)+t+(e%2?" ":"")},r$=function(r){return r>=32&&r<126?String.fromCharCode(r):"."},tx=function(r){const e={};return Object.keys(r).forEach(t=>{const i=r[t];rT(i)?e[t]={bytes:i.buffer,byteOffset:i.byteOffset,byteLength:i.byteLength}:e[t]=i}),e},eh=function(r){const e=r.byterange||{length:1/0,offset:0};return[e.length,e.offset,r.resolvedUri].join(",")},ix=function(r){return r.resolvedUri},rx=r=>{const e=Array.prototype.slice.call(r),t=16;let i="",s,n;for(let a=0;a<e.length/t;a++)s=e.slice(a*t,a*t+t).map(i$).join(""),n=e.slice(a*t,a*t+t).map(r$).join(""),i+=s+" "+n+`
`;return i},s$=({bytes:r})=>rx(r),n$=r=>{let e="",t;for(t=0;t<r.length;t++)e+=t$(r,t)+" ";return e};var a$=Object.freeze({__proto__:null,createTransferableMessage:tx,initSegmentId:eh,segmentKeyId:ix,hexDump:rx,tagDump:s$,textRanges:n$});const sx=.25,o$=(r,e)=>{if(!e.dateTimeObject)return null;const t=e.videoTimingInfo.transmuxerPrependedSeconds,s=e.videoTimingInfo.transmuxedPresentationStart+t,n=r-s;return new Date(e.dateTimeObject.getTime()+n*1e3)},l$=r=>r.transmuxedPresentationEnd-r.transmuxedPresentationStart-r.transmuxerPrependedSeconds,u$=(r,e)=>{let t;try{t=new Date(r)}catch{return null}if(!e||!e.segments||e.segments.length===0)return null;let i=e.segments[0];if(t<new Date(i.dateTimeObject))return null;for(let l=0;l<e.segments.length-1;l++){i=e.segments[l];const u=new Date(e.segments[l+1].dateTimeObject);if(t<u)break}const s=e.segments[e.segments.length-1],n=s.dateTimeObject,a=s.videoTimingInfo?l$(s.videoTimingInfo):s.duration+s.duration*sx,o=new Date(n.getTime()+a*1e3);return t>o?null:(t>new Date(n)&&(i=s),{segment:i,estimatedStart:i.videoTimingInfo?i.videoTimingInfo.transmuxedPresentationStart:Ci.duration(e,e.mediaSequence+e.segments.indexOf(i)),type:i.videoTimingInfo?"accurate":"estimate"})},c$=(r,e)=>{if(!e||!e.segments||e.segments.length===0)return null;let t=0,i;for(let n=0;n<e.segments.length&&(i=e.segments[n],t=i.videoTimingInfo?i.videoTimingInfo.transmuxedPresentationEnd:t+i.duration,!(r<=t));n++);const s=e.segments[e.segments.length-1];if(s.videoTimingInfo&&s.videoTimingInfo.transmuxedPresentationEnd<r)return null;if(r>t){if(r>t+s.duration*sx)return null;i=s}return{segment:i,estimatedStart:i.videoTimingInfo?i.videoTimingInfo.transmuxedPresentationStart:t-i.duration,type:i.videoTimingInfo?"accurate":"estimate"}},h$=(r,e)=>{let t,i;try{t=new Date(r),i=new Date(e)}catch{}const s=t.getTime();return(i.getTime()-s)/1e3},d$=r=>{if(!r.segments||r.segments.length===0)return!1;for(let e=0;e<r.segments.length;e++)if(!r.segments[e].dateTimeObject)return!1;return!0},f$=({playlist:r,time:e=void 0,callback:t})=>{if(!t)throw new Error("getProgramTime: callback must be provided");if(!r||e===void 0)return t({message:"getProgramTime: playlist and time must be provided"});const i=c$(e,r);if(!i)return t({message:"valid programTime was not found"});if(i.type==="estimate")return t({message:"Accurate programTime could not be determined. Please seek to e.seekTime and try again",seekTime:i.estimatedStart});const s={mediaSeconds:e},n=o$(e,i.segment);return n&&(s.programDateTime=n.toISOString()),t(null,s)},nx=({programTime:r,playlist:e,retryCount:t=2,seekTo:i,pauseAfterSeek:s=!0,tech:n,callback:a})=>{if(!a)throw new Error("seekToProgramTime: callback must be provided");if(typeof r>"u"||!e||!i)return a({message:"seekToProgramTime: programTime, seekTo and playlist must be provided"});if(!e.endList&&!n.hasStarted_)return a({message:"player must be playing a live stream to start buffering"});if(!d$(e))return a({message:"programDateTime tags must be provided in the manifest "+e.resolvedUri});const o=u$(r,e);if(!o)return a({message:`${r} was not found in the stream`});const l=o.segment,u=h$(l.dateTimeObject,r);if(o.type==="estimate"){if(t===0)return a({message:`${r} is not buffered yet. Try again`});i(o.estimatedStart+u),n.one("seeked",()=>{nx({programTime:r,playlist:e,retryCount:t-1,seekTo:i,pauseAfterSeek:s,tech:n,callback:a})});return}const c=l.start+u,h=()=>a(null,n.currentTime());n.one("seeked",h),s&&n.pause(),i(c)},pf=(r,e)=>{if(r.readyState===4)return e()},p$=(r,e,t,i)=>{let s=[],n,a=!1;const o=function(h,f,m,S){return f.abort(),a=!0,t(h,f,m,S)},l=function(h,f){if(a)return;if(h)return h.metadata=Pn({requestType:i,request:f,error:h}),o(h,f,"",s);const m=f.responseText.substring(s&&s.byteLength||0,f.responseText.length);if(s=UI(s,sT(m,!0)),n=n||Bo(s),s.length<10||n&&s.length<n+2)return pf(f,()=>o(h,f,"",s));const S=pg(s);return S==="ts"&&s.length<188?pf(f,()=>o(h,f,"",s)):!S&&s.length<376?pf(f,()=>o(h,f,"",s)):o(null,f,S,s)},c=e({uri:r,beforeSend(h){h.overrideMimeType("text/plain; charset=x-user-defined"),h.addEventListener("progress",function({total:f,loaded:m}){return Mp(h,null,{statusCode:h.status},l)})}},function(h,f){return Mp(c,h,f,l)});return c},{EventTarget:m$}=H,ab=function(r,e){if(!J_(r,e)||r.sidx&&e.sidx&&(r.sidx.offset!==e.sidx.offset||r.sidx.length!==e.sidx.length))return!1;if(!r.sidx&&e.sidx||r.sidx&&!e.sidx||r.segments&&!e.segments||!r.segments&&e.segments)return!1;if(!r.segments&&!e.segments)return!0;for(let t=0;t<r.segments.length;t++){const i=r.segments[t],s=e.segments[t];if(i.uri!==s.uri)return!1;if(!i.byterange&&!s.byterange)continue;const n=i.byterange,a=s.byterange;if(n&&!a||!n&&a||n.offset!==a.offset||n.length!==a.length)return!1}return!0},g$=(r,e,t,i)=>{const s=i.attributes.NAME||t;return`placeholder-uri-${r}-${e}-${s}`},O$=({mainXml:r,srcUrl:e,clientOffset:t,sidxMapping:i,previousManifest:s})=>{const n=NR(r,{manifestUri:e,clientOffset:t,sidxMapping:i,previousManifest:s});return Z_(n,e,g$),n},y$=(r,e)=>{to(r,(t,i,s,n)=>{(!e.mediaGroups[i][s]||!(n in e.mediaGroups[i][s]))&&delete r.mediaGroups[i][s][n]})},b$=(r,e,t)=>{let i=!0,s=We(r,{duration:e.duration,minimumUpdatePeriod:e.minimumUpdatePeriod,timelineStarts:e.timelineStarts});for(let n=0;n<e.playlists.length;n++){const a=e.playlists[n];if(a.sidx){const l=Fh(a.sidx);t&&t[l]&&t[l].sidx&&hg(a,t[l].sidx,a.sidx.resolvedUri)}const o=Pp(s,a,ab);o&&(s=o,i=!1)}return to(e,(n,a,o,l)=>{if(n.playlists&&n.playlists.length){const u=n.playlists[0].id,c=Pp(s,n.playlists[0],ab);c&&(s=c,l in s.mediaGroups[a][o]||(s.mediaGroups[a][o][l]=n),s.mediaGroups[a][o][l].playlists[0]=s.playlists[u],i=!1)}}),y$(s,e),e.minimumUpdatePeriod!==r.minimumUpdatePeriod&&(i=!1),i?null:s},v$=(r,e)=>(!r.map&&!e.map||!!(r.map&&e.map&&r.map.byterange.offset===e.map.byterange.offset&&r.map.byterange.length===e.map.byterange.length))&&r.uri===e.uri&&r.byterange.offset===e.byterange.offset&&r.byterange.length===e.byterange.length,ob=(r,e)=>{const t={};for(const i in r){const n=r[i].sidx;if(n){const a=Fh(n);if(!e[a])break;const o=e[a].sidxInfo;v$(o,n)&&(t[a]=e[a])}}return t},S$=(r,e)=>{let i=ob(r.playlists,e);return to(r,(s,n,a,o)=>{if(s.playlists&&s.playlists.length){const l=s.playlists;i=We(i,ob(l,e))}}),i};class Rp extends m${constructor(e,t,i={},s){super(),this.isPaused_=!0,this.mainPlaylistLoader_=s||this,s||(this.isMain_=!0);const{withCredentials:n=!1}=i;if(this.vhs_=t,this.withCredentials=n,this.addMetadataToTextTrack=i.addMetadataToTextTrack,!e)throw new Error("A non-empty playlist URL or object is required");this.on("minimumUpdatePeriod",()=>{this.refreshXml_()}),this.on("mediaupdatetimeout",()=>{this.refreshMedia_(this.media().id)}),this.state="HAVE_NOTHING",this.loadedPlaylists_={},this.logger_=ar("DashPlaylistLoader"),this.isMain_?(this.mainPlaylistLoader_.srcUrl=e,this.mainPlaylistLoader_.sidxMapping_={}):this.childPlaylist_=e}get isPaused(){return this.isPaused_}requestErrored_(e,t,i){if(!this.request)return!0;if(this.request=null,e)return this.error=typeof e=="object"&&!(e instanceof Error)?e:{status:t.status,message:"DASH request error at URL: "+t.uri,response:t.response,code:2,metadata:e.metadata},i&&(this.state=i),this.trigger("error"),!0}addSidxSegments_(e,t,i){const s=e.sidx&&Fh(e.sidx);if(!e.sidx||!s||this.mainPlaylistLoader_.sidxMapping_[s]){U.clearTimeout(this.mediaRequest_),this.mediaRequest_=U.setTimeout(()=>i(!1),0);return}const n=Jc(e.sidx.resolvedUri),a=(l,u)=>{if(this.requestErrored_(l,u,t))return;const c=this.mainPlaylistLoader_.sidxMapping_,{requestType:h}=u;let f;try{f=XR(ke(u.response).subarray(8))}catch(m){m.metadata=Pn({requestType:h,request:u,parseFailure:!0}),this.requestErrored_(m,u,t);return}return c[s]={sidxInfo:e.sidx,sidx:f},hg(e,f,e.sidx.resolvedUri),i(!0)},o="dash-sidx";this.request=p$(n,this.vhs_.xhr,(l,u,c,h)=>{if(l)return a(l,u);if(!c||c!=="mp4"){const S=c||"unknown";return a({status:u.status,message:`Unsupported ${S} container type for sidx segment at URL: ${n}`,response:"",playlist:e,internal:!0,playlistExclusionDuration:1/0,code:2},u)}const{offset:f,length:m}=e.sidx.byterange;if(h.length>=m+f)return a(l,{response:h.subarray(f,f+m),status:u.status,uri:u.uri});this.request=this.vhs_.xhr({uri:n,responseType:"arraybuffer",requestType:"dash-sidx",headers:Ip({byterange:e.sidx.byterange})},a)},o)}dispose(){this.isPaused_=!0,this.trigger("dispose"),this.stopRequest(),this.loadedPlaylists_={},U.clearTimeout(this.minimumUpdatePeriodTimeout_),U.clearTimeout(this.mediaRequest_),U.clearTimeout(this.mediaUpdateTimeout),this.mediaUpdateTimeout=null,this.mediaRequest_=null,this.minimumUpdatePeriodTimeout_=null,this.mainPlaylistLoader_.createMupOnMedia_&&(this.off("loadedmetadata",this.mainPlaylistLoader_.createMupOnMedia_),this.mainPlaylistLoader_.createMupOnMedia_=null),this.off()}hasPendingRequest(){return this.request||this.mediaRequest_}stopRequest(){if(this.request){const e=this.request;this.request=null,e.onreadystatechange=null,e.abort()}}media(e){if(!e)return this.media_;if(this.state==="HAVE_NOTHING")throw new Error("Cannot switch media playlist from "+this.state);const t=this.state;if(typeof e=="string"){if(!this.mainPlaylistLoader_.main.playlists[e])throw new Error("Unknown playlist URI: "+e);e=this.mainPlaylistLoader_.main.playlists[e]}const i=!this.media_||e.id!==this.media_.id;if(i&&this.loadedPlaylists_[e.id]&&this.loadedPlaylists_[e.id].endList){this.state="HAVE_METADATA",this.media_=e,i&&(this.trigger("mediachanging"),this.trigger("mediachange"));return}i&&(this.media_&&this.trigger("mediachanging"),this.addSidxSegments_(e,t,s=>{this.haveMetadata({startingState:t,playlist:e})}))}haveMetadata({startingState:e,playlist:t}){this.state="HAVE_METADATA",this.loadedPlaylists_[t.id]=t,U.clearTimeout(this.mediaRequest_),this.mediaRequest_=null,this.refreshMedia_(t.id),e==="HAVE_MAIN_MANIFEST"?this.trigger("loadedmetadata"):this.trigger("mediachange")}pause(){this.isPaused_=!0,this.mainPlaylistLoader_.createMupOnMedia_&&(this.off("loadedmetadata",this.mainPlaylistLoader_.createMupOnMedia_),this.mainPlaylistLoader_.createMupOnMedia_=null),this.stopRequest(),U.clearTimeout(this.mediaUpdateTimeout),this.mediaUpdateTimeout=null,this.isMain_&&(U.clearTimeout(this.mainPlaylistLoader_.minimumUpdatePeriodTimeout_),this.mainPlaylistLoader_.minimumUpdatePeriodTimeout_=null),this.state==="HAVE_NOTHING"&&(this.started=!1)}load(e){this.isPaused_=!1,U.clearTimeout(this.mediaUpdateTimeout),this.mediaUpdateTimeout=null;const t=this.media();if(e){const i=t?t.targetDuration/2*1e3:5e3;this.mediaUpdateTimeout=U.setTimeout(()=>this.load(),i);return}if(!this.started){this.start();return}t&&!t.endList?(this.isMain_&&!this.minimumUpdatePeriodTimeout_&&(this.trigger("minimumUpdatePeriod"),this.updateMinimumUpdatePeriodTimeout_()),this.trigger("mediaupdatetimeout")):this.trigger("loadedplaylist")}start(){if(this.started=!0,!this.isMain_){U.clearTimeout(this.mediaRequest_),this.mediaRequest_=U.setTimeout(()=>this.haveMain_(),0);return}this.requestMain_((e,t)=>{this.haveMain_(),!this.hasPendingRequest()&&!this.media_&&this.media(this.mainPlaylistLoader_.main.playlists[0])})}requestMain_(e){const t={manifestInfo:{uri:this.mainPlaylistLoader_.srcUrl}};this.trigger({type:"manifestrequeststart",metadata:t}),this.request=this.vhs_.xhr({uri:this.mainPlaylistLoader_.srcUrl,withCredentials:this.withCredentials,requestType:"dash-manifest"},(i,s)=>{if(i){const{requestType:a}=s;i.metadata=Pn({requestType:a,request:s,error:i})}if(this.requestErrored_(i,s)){this.state==="HAVE_NOTHING"&&(this.started=!1);return}this.trigger({type:"manifestrequestcomplete",metadata:t});const n=s.responseText!==this.mainPlaylistLoader_.mainXml_;if(this.mainPlaylistLoader_.mainXml_=s.responseText,s.responseHeaders&&s.responseHeaders.date?this.mainLoaded_=Date.parse(s.responseHeaders.date):this.mainLoaded_=Date.now(),this.mainPlaylistLoader_.srcUrl=Jc(this.mainPlaylistLoader_.srcUrl,s),n){this.handleMain_(),this.syncClientServerClock_(()=>e(s,n));return}return e(s,n)})}syncClientServerClock_(e){const t=FR(this.mainPlaylistLoader_.mainXml_);if(t===null)return this.mainPlaylistLoader_.clientOffset_=this.mainLoaded_-Date.now(),e();if(t.method==="DIRECT")return this.mainPlaylistLoader_.clientOffset_=t.value-Date.now(),e();this.request=this.vhs_.xhr({uri:_i(this.mainPlaylistLoader_.srcUrl,t.value),method:t.method,withCredentials:this.withCredentials,requestType:"dash-clock-sync"},(i,s)=>{if(!this.request)return;if(i){const{requestType:a}=s;return this.error.metadata=Pn({requestType:a,request:s,error:i}),this.mainPlaylistLoader_.clientOffset_=this.mainLoaded_-Date.now(),e()}let n;t.method==="HEAD"?!s.responseHeaders||!s.responseHeaders.date?n=this.mainLoaded_:n=Date.parse(s.responseHeaders.date):n=Date.parse(s.responseText),this.mainPlaylistLoader_.clientOffset_=n-Date.now(),e()})}haveMain_(){this.state="HAVE_MAIN_MANIFEST",this.isMain_?this.trigger("loadedplaylist"):this.media_||this.media(this.childPlaylist_)}handleMain_(){U.clearTimeout(this.mediaRequest_),this.mediaRequest_=null;const e=this.mainPlaylistLoader_.main,t={manifestInfo:{uri:this.mainPlaylistLoader_.srcUrl}};this.trigger({type:"manifestparsestart",metadata:t});let i;try{i=O$({mainXml:this.mainPlaylistLoader_.mainXml_,srcUrl:this.mainPlaylistLoader_.srcUrl,clientOffset:this.mainPlaylistLoader_.clientOffset_,sidxMapping:this.mainPlaylistLoader_.sidxMapping_,previousManifest:e})}catch(n){this.error=n,this.error.metadata={errorType:H.Error.StreamingDashManifestParserError,error:n},this.trigger("error")}e&&(i=b$(e,i,this.mainPlaylistLoader_.sidxMapping_)),this.mainPlaylistLoader_.main=i||e;const s=this.mainPlaylistLoader_.main.locations&&this.mainPlaylistLoader_.main.locations[0];if(s&&s!==this.mainPlaylistLoader_.srcUrl&&(this.mainPlaylistLoader_.srcUrl=s),(!e||i&&i.minimumUpdatePeriod!==e.minimumUpdatePeriod)&&this.updateMinimumUpdatePeriodTimeout_(),this.addEventStreamToMetadataTrack_(i),i){const{duration:n,endList:a}=i,o=[];i.playlists.forEach(u=>{o.push({id:u.id,bandwidth:u.attributes.BANDWIDTH,resolution:u.attributes.RESOLUTION,codecs:u.attributes.CODECS})});const l={duration:n,isLive:!a,renditions:o};t.parsedManifest=l,this.trigger({type:"manifestparsecomplete",metadata:t})}return!!i}updateMinimumUpdatePeriodTimeout_(){const e=this.mainPlaylistLoader_;e.createMupOnMedia_&&(e.off("loadedmetadata",e.createMupOnMedia_),e.createMupOnMedia_=null),e.minimumUpdatePeriodTimeout_&&(U.clearTimeout(e.minimumUpdatePeriodTimeout_),e.minimumUpdatePeriodTimeout_=null);let t=e.main&&e.main.minimumUpdatePeriod;if(t===0&&(e.media()?t=e.media().targetDuration*1e3:(e.createMupOnMedia_=e.updateMinimumUpdatePeriodTimeout_,e.one("loadedmetadata",e.createMupOnMedia_))),typeof t!="number"||t<=0){t<0&&this.logger_(`found invalid minimumUpdatePeriod of ${t}, not setting a timeout`);return}this.createMUPTimeout_(t)}createMUPTimeout_(e){const t=this.mainPlaylistLoader_;t.minimumUpdatePeriodTimeout_=U.setTimeout(()=>{t.minimumUpdatePeriodTimeout_=null,t.trigger("minimumUpdatePeriod"),t.createMUPTimeout_(e)},e)}refreshXml_(){this.requestMain_((e,t)=>{t&&(this.media_&&(this.media_=this.mainPlaylistLoader_.main.playlists[this.media_.id]),this.mainPlaylistLoader_.sidxMapping_=S$(this.mainPlaylistLoader_.main,this.mainPlaylistLoader_.sidxMapping_),this.addSidxSegments_(this.media(),this.state,i=>{this.refreshMedia_(this.media().id)}))})}refreshMedia_(e){if(!e)throw new Error("refreshMedia_ must take a media id");this.media_&&this.isMain_&&this.handleMain_();const t=this.mainPlaylistLoader_.main.playlists,i=!this.media_||this.media_!==t[e];if(i?this.media_=t[e]:this.trigger("playlistunchanged"),!this.mediaUpdateTimeout){const s=()=>{this.media().endList||(this.mediaUpdateTimeout=U.setTimeout(()=>{this.trigger("mediaupdatetimeout"),s()},Dp(this.media(),!!i)))};s()}this.trigger("loadedplaylist")}addEventStreamToMetadataTrack_(e){if(e&&this.mainPlaylistLoader_.main.eventStream){const t=this.mainPlaylistLoader_.main.eventStream.map(i=>({cueTime:i.start,frames:[{data:i.messageData}]}));this.addMetadataToTextTrack("EventStream",t,this.mainPlaylistLoader_.main.duration)}}getKeyIdSet(e){if(e.contentProtection){const t=new Set;for(const i in e.contentProtection){const s=e.contentProtection[i].attributes["cenc:default_KID"];s&&t.add(s.replace(/-/g,"").toLowerCase())}return t}}}var Ut={GOAL_BUFFER_LENGTH:30,MAX_GOAL_BUFFER_LENGTH:60,BACK_BUFFER_LENGTH:30,GOAL_BUFFER_LENGTH_RATE:1,INITIAL_BANDWIDTH:4194304,BANDWIDTH_VARIANCE:1.2,BUFFER_LOW_WATER_LINE:0,MAX_BUFFER_LOW_WATER_LINE:30,EXPERIMENTAL_MAX_BUFFER_LOW_WATER_LINE:16,BUFFER_LOW_WATER_LINE_RATE:1,BUFFER_HIGH_WATER_LINE:30};const T$=r=>{const e=new Uint8Array(new ArrayBuffer(r.length));for(let t=0;t<r.length;t++)e[t]=r.charCodeAt(t);return e.buffer},ax=function(r){return r.on=r.addEventListener,r.off=r.removeEventListener,r},_$=function(r){try{return URL.createObjectURL(new Blob([r],{type:"application/javascript"}))}catch{const t=new BlobBuilder;return t.append(r),URL.createObjectURL(t.getBlob())}},ox=function(r){return function(){const e=_$(r),t=ax(new Worker(e));t.objURL=e;const i=t.terminate;return t.on=t.addEventListener,t.off=t.removeEventListener,t.terminate=function(){return URL.revokeObjectURL(e),i.call(this)},t}},lx=function(r){return`var browserWorkerPolyFill = ${ax.toString()};
browserWorkerPolyFill(self);
`+r},ux=function(r){return r.toString().replace(/^function.+?{/,"").slice(0,-1)},x$=lx(ux(function(){var r=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},e=function(){this.init=function(){var d={};this.on=function(p,O){d[p]||(d[p]=[]),d[p]=d[p].concat(O)},this.off=function(p,O){var g;return d[p]?(g=d[p].indexOf(O),d[p]=d[p].slice(),d[p].splice(g,1),g>-1):!1},this.trigger=function(p){var O,g,b,k;if(O=d[p],!!O)if(arguments.length===2)for(b=O.length,g=0;g<b;++g)O[g].call(this,arguments[1]);else{for(k=[],g=arguments.length,g=1;g<arguments.length;++g)k.push(arguments[g]);for(b=O.length,g=0;g<b;++g)O[g].apply(this,k)}},this.dispose=function(){d={}}}};e.prototype.pipe=function(d){return this.on("data",function(p){d.push(p)}),this.on("done",function(p){d.flush(p)}),this.on("partialdone",function(p){d.partialFlush(p)}),this.on("endedtimeline",function(p){d.endTimeline(p)}),this.on("reset",function(p){d.reset(p)}),d},e.prototype.push=function(d){this.trigger("data",d)},e.prototype.flush=function(d){this.trigger("done",d)},e.prototype.partialFlush=function(d){this.trigger("partialdone",d)},e.prototype.endTimeline=function(d){this.trigger("endedtimeline",d)},e.prototype.reset=function(d){this.trigger("reset",d)};var t=e,i=Math.pow(2,32),s=function(d){var p=new DataView(d.buffer,d.byteOffset,d.byteLength),O;return p.getBigUint64?(O=p.getBigUint64(0),O<Number.MAX_SAFE_INTEGER?Number(O):O):p.getUint32(0)*i+p.getUint32(4)},n={getUint64:s,MAX_UINT32:i},a=n.MAX_UINT32,o,l,u,c,h,f,m,S,y,E,C,_,v,T,w,A,I,N,P,R,X,j,Z,Y,te,le,G,re,J,ne,ae,ve,xe,Pe,Se,at;(function(){var d;if(Z={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],mvex:[],mvhd:[],pasp:[],sdtp:[],smhd:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],styp:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[]},!(typeof Uint8Array>"u")){for(d in Z)Z.hasOwnProperty(d)&&(Z[d]=[d.charCodeAt(0),d.charCodeAt(1),d.charCodeAt(2),d.charCodeAt(3)]);Y=new Uint8Array([105,115,111,109]),le=new Uint8Array([97,118,99,49]),te=new Uint8Array([0,0,0,1]),G=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),re=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]),J={video:G,audio:re},ve=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),ae=new Uint8Array([0,0,0,0,0,0,0,0]),xe=new Uint8Array([0,0,0,0,0,0,0,0]),Pe=xe,Se=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),at=xe,ne=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0])}})(),o=function(d){var p=[],O=0,g,b,k;for(g=1;g<arguments.length;g++)p.push(arguments[g]);for(g=p.length;g--;)O+=p[g].byteLength;for(b=new Uint8Array(O+8),k=new DataView(b.buffer,b.byteOffset,b.byteLength),k.setUint32(0,b.byteLength),b.set(d,4),g=0,O=8;g<p.length;g++)b.set(p[g],O),O+=p[g].byteLength;return b},l=function(){return o(Z.dinf,o(Z.dref,ve))},u=function(d){return o(Z.esds,new Uint8Array([0,0,0,0,3,25,0,0,0,4,17,64,21,0,6,0,0,0,218,192,0,0,218,192,5,2,d.audioobjecttype<<3|d.samplingfrequencyindex>>>1,d.samplingfrequencyindex<<7|d.channelcount<<3,6,1,2]))},c=function(){return o(Z.ftyp,Y,te,Y,le)},A=function(d){return o(Z.hdlr,J[d])},h=function(d){return o(Z.mdat,d)},w=function(d){var p=new Uint8Array([0,0,0,0,0,0,0,2,0,0,0,3,0,1,95,144,d.duration>>>24&255,d.duration>>>16&255,d.duration>>>8&255,d.duration&255,85,196,0,0]);return d.samplerate&&(p[12]=d.samplerate>>>24&255,p[13]=d.samplerate>>>16&255,p[14]=d.samplerate>>>8&255,p[15]=d.samplerate&255),o(Z.mdhd,p)},T=function(d){return o(Z.mdia,w(d),A(d.type),m(d))},f=function(d){return o(Z.mfhd,new Uint8Array([0,0,0,0,(d&4278190080)>>24,(d&16711680)>>16,(d&65280)>>8,d&255]))},m=function(d){return o(Z.minf,d.type==="video"?o(Z.vmhd,ne):o(Z.smhd,ae),l(),N(d))},S=function(d,p){for(var O=[],g=p.length;g--;)O[g]=R(p[g]);return o.apply(null,[Z.moof,f(d)].concat(O))},y=function(d){for(var p=d.length,O=[];p--;)O[p]=_(d[p]);return o.apply(null,[Z.moov,C(4294967295)].concat(O).concat(E(d)))},E=function(d){for(var p=d.length,O=[];p--;)O[p]=X(d[p]);return o.apply(null,[Z.mvex].concat(O))},C=function(d){var p=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,2,0,1,95,144,(d&4278190080)>>24,(d&16711680)>>16,(d&65280)>>8,d&255,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return o(Z.mvhd,p)},I=function(d){var p=d.samples||[],O=new Uint8Array(4+p.length),g,b;for(b=0;b<p.length;b++)g=p[b].flags,O[b+4]=g.dependsOn<<4|g.isDependedOn<<2|g.hasRedundancy;return o(Z.sdtp,O)},N=function(d){return o(Z.stbl,P(d),o(Z.stts,at),o(Z.stsc,Pe),o(Z.stsz,Se),o(Z.stco,xe))},(function(){var d,p;P=function(O){return o(Z.stsd,new Uint8Array([0,0,0,0,0,0,0,1]),O.type==="video"?d(O):p(O))},d=function(O){var g=O.sps||[],b=O.pps||[],k=[],Q=[],$,F;for($=0;$<g.length;$++)k.push((g[$].byteLength&65280)>>>8),k.push(g[$].byteLength&255),k=k.concat(Array.prototype.slice.call(g[$]));for($=0;$<b.length;$++)Q.push((b[$].byteLength&65280)>>>8),Q.push(b[$].byteLength&255),Q=Q.concat(Array.prototype.slice.call(b[$]));if(F=[Z.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,(O.width&65280)>>8,O.width&255,(O.height&65280)>>8,O.height&255,0,72,0,0,0,72,0,0,0,0,0,0,0,1,19,118,105,100,101,111,106,115,45,99,111,110,116,114,105,98,45,104,108,115,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),o(Z.avcC,new Uint8Array([1,O.profileIdc,O.profileCompatibility,O.levelIdc,255].concat([g.length],k,[b.length],Q))),o(Z.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192]))],O.sarRatio){var q=O.sarRatio[0],z=O.sarRatio[1];F.push(o(Z.pasp,new Uint8Array([(q&4278190080)>>24,(q&16711680)>>16,(q&65280)>>8,q&255,(z&4278190080)>>24,(z&16711680)>>16,(z&65280)>>8,z&255])))}return o.apply(null,F)},p=function(O){return o(Z.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,(O.channelcount&65280)>>8,O.channelcount&255,(O.samplesize&65280)>>8,O.samplesize&255,0,0,0,0,(O.samplerate&65280)>>8,O.samplerate&255,0,0]),u(O))}})(),v=function(d){var p=new Uint8Array([0,0,0,7,0,0,0,0,0,0,0,0,(d.id&4278190080)>>24,(d.id&16711680)>>16,(d.id&65280)>>8,d.id&255,0,0,0,0,(d.duration&4278190080)>>24,(d.duration&16711680)>>16,(d.duration&65280)>>8,d.duration&255,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,(d.width&65280)>>8,d.width&255,0,0,(d.height&65280)>>8,d.height&255,0,0]);return o(Z.tkhd,p)},R=function(d){var p,O,g,b,k,Q,$;return p=o(Z.tfhd,new Uint8Array([0,0,0,58,(d.id&4278190080)>>24,(d.id&16711680)>>16,(d.id&65280)>>8,d.id&255,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0])),Q=Math.floor(d.baseMediaDecodeTime/a),$=Math.floor(d.baseMediaDecodeTime%a),O=o(Z.tfdt,new Uint8Array([1,0,0,0,Q>>>24&255,Q>>>16&255,Q>>>8&255,Q&255,$>>>24&255,$>>>16&255,$>>>8&255,$&255])),k=92,d.type==="audio"?(g=j(d,k),o(Z.traf,p,O,g)):(b=I(d),g=j(d,b.length+k),o(Z.traf,p,O,g,b))},_=function(d){return d.duration=d.duration||4294967295,o(Z.trak,v(d),T(d))},X=function(d){var p=new Uint8Array([0,0,0,0,(d.id&4278190080)>>24,(d.id&16711680)>>16,(d.id&65280)>>8,d.id&255,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]);return d.type!=="video"&&(p[p.length-1]=0),o(Z.trex,p)},(function(){var d,p,O;O=function(g,b){var k=0,Q=0,$=0,F=0;return g.length&&(g[0].duration!==void 0&&(k=1),g[0].size!==void 0&&(Q=2),g[0].flags!==void 0&&($=4),g[0].compositionTimeOffset!==void 0&&(F=8)),[0,0,k|Q|$|F,1,(g.length&4278190080)>>>24,(g.length&16711680)>>>16,(g.length&65280)>>>8,g.length&255,(b&4278190080)>>>24,(b&16711680)>>>16,(b&65280)>>>8,b&255]},p=function(g,b){var k,Q,$,F,q,z;for(F=g.samples||[],b+=20+16*F.length,$=O(F,b),Q=new Uint8Array($.length+F.length*16),Q.set($),k=$.length,z=0;z<F.length;z++)q=F[z],Q[k++]=(q.duration&4278190080)>>>24,Q[k++]=(q.duration&16711680)>>>16,Q[k++]=(q.duration&65280)>>>8,Q[k++]=q.duration&255,Q[k++]=(q.size&4278190080)>>>24,Q[k++]=(q.size&16711680)>>>16,Q[k++]=(q.size&65280)>>>8,Q[k++]=q.size&255,Q[k++]=q.flags.isLeading<<2|q.flags.dependsOn,Q[k++]=q.flags.isDependedOn<<6|q.flags.hasRedundancy<<4|q.flags.paddingValue<<1|q.flags.isNonSyncSample,Q[k++]=q.flags.degradationPriority&61440,Q[k++]=q.flags.degradationPriority&15,Q[k++]=(q.compositionTimeOffset&4278190080)>>>24,Q[k++]=(q.compositionTimeOffset&16711680)>>>16,Q[k++]=(q.compositionTimeOffset&65280)>>>8,Q[k++]=q.compositionTimeOffset&255;return o(Z.trun,Q)},d=function(g,b){var k,Q,$,F,q,z;for(F=g.samples||[],b+=20+8*F.length,$=O(F,b),k=new Uint8Array($.length+F.length*8),k.set($),Q=$.length,z=0;z<F.length;z++)q=F[z],k[Q++]=(q.duration&4278190080)>>>24,k[Q++]=(q.duration&16711680)>>>16,k[Q++]=(q.duration&65280)>>>8,k[Q++]=q.duration&255,k[Q++]=(q.size&4278190080)>>>24,k[Q++]=(q.size&16711680)>>>16,k[Q++]=(q.size&65280)>>>8,k[Q++]=q.size&255;return o(Z.trun,k)},j=function(g,b){return g.type==="audio"?d(g,b):p(g,b)}})();var ft={ftyp:c,mdat:h,moof:S,moov:y,initSegment:function(d){var p=c(),O=y(d),g;return g=new Uint8Array(p.byteLength+O.byteLength),g.set(p),g.set(O,p.byteLength),g}},Ge=function(d){var p,O,g=[],b=[];for(b.byteLength=0,b.nalCount=0,b.duration=0,g.byteLength=0,p=0;p<d.length;p++)O=d[p],O.nalUnitType==="access_unit_delimiter_rbsp"?(g.length&&(g.duration=O.dts-g.dts,b.byteLength+=g.byteLength,b.nalCount+=g.length,b.duration+=g.duration,b.push(g)),g=[O],g.byteLength=O.data.byteLength,g.pts=O.pts,g.dts=O.dts):(O.nalUnitType==="slice_layer_without_partitioning_rbsp_idr"&&(g.keyFrame=!0),g.duration=O.dts-g.dts,g.byteLength+=O.data.byteLength,g.push(O));return b.length&&(!g.duration||g.duration<=0)&&(g.duration=b[b.length-1].duration),b.byteLength+=g.byteLength,b.nalCount+=g.length,b.duration+=g.duration,b.push(g),b},_t=function(d){var p,O,g=[],b=[];for(g.byteLength=0,g.nalCount=0,g.duration=0,g.pts=d[0].pts,g.dts=d[0].dts,b.byteLength=0,b.nalCount=0,b.duration=0,b.pts=d[0].pts,b.dts=d[0].dts,p=0;p<d.length;p++)O=d[p],O.keyFrame?(g.length&&(b.push(g),b.byteLength+=g.byteLength,b.nalCount+=g.nalCount,b.duration+=g.duration),g=[O],g.nalCount=O.length,g.byteLength=O.byteLength,g.pts=O.pts,g.dts=O.dts,g.duration=O.duration):(g.duration+=O.duration,g.nalCount+=O.length,g.byteLength+=O.byteLength,g.push(O));return b.length&&g.duration<=0&&(g.duration=b[b.length-1].duration),b.byteLength+=g.byteLength,b.nalCount+=g.nalCount,b.duration+=g.duration,b.push(g),b},yi=function(d){var p;return!d[0][0].keyFrame&&d.length>1&&(p=d.shift(),d.byteLength-=p.byteLength,d.nalCount-=p.nalCount,d[0][0].dts=p.dts,d[0][0].pts=p.pts,d[0][0].duration+=p.duration),d},Pt=function(){return{size:0,flags:{isLeading:0,dependsOn:1,isDependedOn:0,hasRedundancy:0,degradationPriority:0,isNonSyncSample:1}}},Dt=function(d,p){var O=Pt();return O.dataOffset=p,O.compositionTimeOffset=d.pts-d.dts,O.duration=d.duration,O.size=4*d.length,O.size+=d.byteLength,d.keyFrame&&(O.flags.dependsOn=2,O.flags.isNonSyncSample=0),O},xr=function(d,p){var O,g,b,k,Q,$=p||0,F=[];for(O=0;O<d.length;O++)for(k=d[O],g=0;g<k.length;g++)Q=k[g],b=Dt(Q,$),$+=b.size,F.push(b);return F},Mt=function(d){var p,O,g,b,k,Q,$=0,F=d.byteLength,q=d.nalCount,z=F+4*q,K=new Uint8Array(z),de=new DataView(K.buffer);for(p=0;p<d.length;p++)for(b=d[p],O=0;O<b.length;O++)for(k=b[O],g=0;g<k.length;g++)Q=k[g],de.setUint32($,Q.data.byteLength),$+=4,K.set(Q.data,$),$+=Q.data.byteLength;return K},ur=function(d,p){var O,g=p||0,b=[];return O=Dt(d,g),b.push(O),b},xt=function(d){var p,O,g=0,b=d.byteLength,k=d.length,Q=b+4*k,$=new Uint8Array(Q),F=new DataView($.buffer);for(p=0;p<d.length;p++)O=d[p],F.setUint32(g,O.data.byteLength),g+=4,$.set(O.data,g),g+=O.data.byteLength;return $},Kr={groupNalsIntoFrames:Ge,groupFramesIntoGops:_t,extendFirstKeyFrame:yi,generateSampleTable:xr,concatenateNalData:Mt,generateSampleTableForFrame:ur,concatenateNalDataForFrame:xt},Jt=[33,16,5,32,164,27],zt=[33,65,108,84,1,2,4,8,168,2,4,8,17,191,252],$e=function(d){for(var p=[];d--;)p.push(0);return p},tt=function(d){return Object.keys(d).reduce(function(p,O){return p[O]=new Uint8Array(d[O].reduce(function(g,b){return g.concat(b)},[])),p},{})},it,Xi=function(){if(!it){var d={96e3:[Jt,[227,64],$e(154),[56]],88200:[Jt,[231],$e(170),[56]],64e3:[Jt,[248,192],$e(240),[56]],48e3:[Jt,[255,192],$e(268),[55,148,128],$e(54),[112]],44100:[Jt,[255,192],$e(268),[55,163,128],$e(84),[112]],32e3:[Jt,[255,192],$e(268),[55,234],$e(226),[112]],24e3:[Jt,[255,192],$e(268),[55,255,128],$e(268),[111,112],$e(126),[224]],16e3:[Jt,[255,192],$e(268),[55,255,128],$e(268),[111,255],$e(269),[223,108],$e(195),[1,192]],12e3:[zt,$e(268),[3,127,248],$e(268),[6,255,240],$e(268),[13,255,224],$e(268),[27,253,128],$e(259),[56]],11025:[zt,$e(268),[3,127,248],$e(268),[6,255,240],$e(268),[13,255,224],$e(268),[27,255,192],$e(268),[55,175,128],$e(108),[112]],8e3:[zt,$e(268),[3,121,16],$e(47),[7]]};it=tt(d)}return it},ji=9e4,zi,Jr,cr,wr,xs,tn,ws;zi=function(d){return d*ji},Jr=function(d,p){return d*p},cr=function(d){return d/ji},wr=function(d,p){return d/p},xs=function(d,p){return zi(wr(d,p))},tn=function(d,p){return Jr(cr(d),p)},ws=function(d,p,O){return cr(O?d:d-p)};var qe={ONE_SECOND_IN_TS:ji,secondsToVideoTs:zi,secondsToAudioTs:Jr,videoTsToSeconds:cr,audioTsToSeconds:wr,audioTsToVideoTs:xs,videoTsToAudioTs:tn,metadataTsToSeconds:ws},rn=Xi,es=qe,Ke=function(d){var p,O,g=0;for(p=0;p<d.length;p++)O=d[p],g+=O.data.byteLength;return g},Cs=function(d,p,O,g){var b,k=0,Q=0,$=0,F=0,q,z,K;if(p.length&&(b=es.audioTsToVideoTs(d.baseMediaDecodeTime,d.samplerate),k=Math.ceil(es.ONE_SECOND_IN_TS/(d.samplerate/1024)),O&&g&&(Q=b-Math.max(O,g),$=Math.floor(Q/k),F=$*k),!($<1||F>es.ONE_SECOND_IN_TS/2))){for(q=rn()[d.samplerate],q||(q=p[0].data),z=0;z<$;z++)K=p[0],p.splice(0,0,{data:q,dts:K.dts-k,pts:K.pts-k});return d.baseMediaDecodeTime-=Math.floor(es.videoTsToAudioTs(F,d.samplerate)),F}},ts=function(d,p,O){return p.minSegmentDts>=O?d:(p.minSegmentDts=1/0,d.filter(function(g){return g.dts>=O?(p.minSegmentDts=Math.min(p.minSegmentDts,g.dts),p.minSegmentPts=p.minSegmentDts,!0):!1}))},Cr=function(d){var p,O,g=[];for(p=0;p<d.length;p++)O=d[p],g.push({size:O.data.byteLength,duration:1024});return g},is=function(d){var p,O,g=0,b=new Uint8Array(Ke(d));for(p=0;p<d.length;p++)O=d[p],b.set(O.data,g),g+=O.data.byteLength;return b},rs={prefixWithSilence:Cs,trimAdtsFramesByEarliestDts:ts,generateSampleTable:Cr,concatenateFrameData:is},bi=qe.ONE_SECOND_IN_TS,M=function(d,p){typeof p.pts=="number"&&(d.timelineStartInfo.pts===void 0&&(d.timelineStartInfo.pts=p.pts),d.minSegmentPts===void 0?d.minSegmentPts=p.pts:d.minSegmentPts=Math.min(d.minSegmentPts,p.pts),d.maxSegmentPts===void 0?d.maxSegmentPts=p.pts:d.maxSegmentPts=Math.max(d.maxSegmentPts,p.pts)),typeof p.dts=="number"&&(d.timelineStartInfo.dts===void 0&&(d.timelineStartInfo.dts=p.dts),d.minSegmentDts===void 0?d.minSegmentDts=p.dts:d.minSegmentDts=Math.min(d.minSegmentDts,p.dts),d.maxSegmentDts===void 0?d.maxSegmentDts=p.dts:d.maxSegmentDts=Math.max(d.maxSegmentDts,p.dts))},L=function(d){delete d.minSegmentDts,delete d.maxSegmentDts,delete d.minSegmentPts,delete d.maxSegmentPts},x=function(d,p){var O,g,b=d.minSegmentDts;return p||(b-=d.timelineStartInfo.dts),O=d.timelineStartInfo.baseMediaDecodeTime,O+=b,O=Math.max(0,O),d.type==="audio"&&(g=d.samplerate/bi,O*=g,O=Math.floor(O)),O},D={clearDtsInfo:L,calculateTrackBaseMediaDecodeTime:x,collectDtsInfo:M},B=4,W=128,oe=function(d){for(var p=0,O={payloadType:-1,payloadSize:0},g=0,b=0;p<d.byteLength&&d[p]!==W;){for(;d[p]===255;)g+=255,p++;for(g+=d[p++];d[p]===255;)b+=255,p++;if(b+=d[p++],!O.payload&&g===B){var k=String.fromCharCode(d[p+3],d[p+4],d[p+5],d[p+6]);if(k==="GA94"){O.payloadType=g,O.payloadSize=b,O.payload=d.subarray(p,p+b);break}else O.payload=void 0}p+=b,g=0,b=0}return O},he=function(d){return d.payload[0]!==181||(d.payload[1]<<8|d.payload[2])!==49||String.fromCharCode(d.payload[3],d.payload[4],d.payload[5],d.payload[6])!=="GA94"||d.payload[7]!==3?null:d.payload.subarray(8,d.payload.length-1)},we=function(d,p){var O=[],g,b,k,Q;if(!(p[0]&64))return O;for(b=p[0]&31,g=0;g<b;g++)k=g*3,Q={type:p[k+2]&3,pts:d},p[k+2]&4&&(Q.ccData=p[k+3]<<8|p[k+4],O.push(Q));return O},Oe=function(d){for(var p=d.byteLength,O=[],g=1,b,k;g<p-2;)d[g]===0&&d[g+1]===0&&d[g+2]===3?(O.push(g+2),g+=2):g++;if(O.length===0)return d;b=p-O.length,k=new Uint8Array(b);var Q=0;for(g=0;g<b;Q++,g++)Q===O[0]&&(Q++,O.shift()),k[g]=d[Q];return k},Ae={parseSei:oe,parseUserData:he,parseCaptionPackets:we,discardEmulationPreventionBytes:Oe,USER_DATA_REGISTERED_ITU_T_T35:B},pe=t,Te=Ae,De=function(d){d=d||{},De.prototype.init.call(this),this.parse708captions_=typeof d.parse708captions=="boolean"?d.parse708captions:!0,this.captionPackets_=[],this.ccStreams_=[new ot(0,0),new ot(0,1),new ot(1,0),new ot(1,1)],this.parse708captions_&&(this.cc708Stream_=new Ne({captionServices:d.captionServices})),this.reset(),this.ccStreams_.forEach(function(p){p.on("data",this.trigger.bind(this,"data")),p.on("partialdone",this.trigger.bind(this,"partialdone")),p.on("done",this.trigger.bind(this,"done"))},this),this.parse708captions_&&(this.cc708Stream_.on("data",this.trigger.bind(this,"data")),this.cc708Stream_.on("partialdone",this.trigger.bind(this,"partialdone")),this.cc708Stream_.on("done",this.trigger.bind(this,"done")))};De.prototype=new pe,De.prototype.push=function(d){var p,O,g;if(d.nalUnitType==="sei_rbsp"&&(p=Te.parseSei(d.escapedRBSP),!!p.payload&&p.payloadType===Te.USER_DATA_REGISTERED_ITU_T_T35&&(O=Te.parseUserData(p),!!O))){if(d.dts<this.latestDts_){this.ignoreNextEqualDts_=!0;return}else if(d.dts===this.latestDts_&&this.ignoreNextEqualDts_){this.numSameDts_--,this.numSameDts_||(this.ignoreNextEqualDts_=!1);return}g=Te.parseCaptionPackets(d.pts,O),this.captionPackets_=this.captionPackets_.concat(g),this.latestDts_!==d.dts&&(this.numSameDts_=0),this.numSameDts_++,this.latestDts_=d.dts}},De.prototype.flushCCStreams=function(d){this.ccStreams_.forEach(function(p){return d==="flush"?p.flush():p.partialFlush()},this)},De.prototype.flushStream=function(d){if(!this.captionPackets_.length){this.flushCCStreams(d);return}this.captionPackets_.forEach(function(p,O){p.presortIndex=O}),this.captionPackets_.sort(function(p,O){return p.pts===O.pts?p.presortIndex-O.presortIndex:p.pts-O.pts}),this.captionPackets_.forEach(function(p){p.type<2?this.dispatchCea608Packet(p):this.dispatchCea708Packet(p)},this),this.captionPackets_.length=0,this.flushCCStreams(d)},De.prototype.flush=function(){return this.flushStream("flush")},De.prototype.partialFlush=function(){return this.flushStream("partialFlush")},De.prototype.reset=function(){this.latestDts_=null,this.ignoreNextEqualDts_=!1,this.numSameDts_=0,this.activeCea608Channel_=[null,null],this.ccStreams_.forEach(function(d){d.reset()})},De.prototype.dispatchCea608Packet=function(d){this.setsTextOrXDSActive(d)?this.activeCea608Channel_[d.type]=null:this.setsChannel1Active(d)?this.activeCea608Channel_[d.type]=0:this.setsChannel2Active(d)&&(this.activeCea608Channel_[d.type]=1),this.activeCea608Channel_[d.type]!==null&&this.ccStreams_[(d.type<<1)+this.activeCea608Channel_[d.type]].push(d)},De.prototype.setsChannel1Active=function(d){return(d.ccData&30720)===4096},De.prototype.setsChannel2Active=function(d){return(d.ccData&30720)===6144},De.prototype.setsTextOrXDSActive=function(d){return(d.ccData&28928)===256||(d.ccData&30974)===4138||(d.ccData&30974)===6186},De.prototype.dispatchCea708Packet=function(d){this.parse708captions_&&this.cc708Stream_.push(d)};var Ot={127:9834,4128:32,4129:160,4133:8230,4138:352,4140:338,4144:9608,4145:8216,4146:8217,4147:8220,4148:8221,4149:8226,4153:8482,4154:353,4156:339,4157:8480,4159:376,4214:8539,4215:8540,4216:8541,4217:8542,4218:9168,4219:9124,4220:9123,4221:9135,4222:9126,4223:9121,4256:12600},yt=function(d){var p=Ot[d]||d;return d&4096&&d===p?"":String.fromCharCode(p)},ei=function(d){return 32<=d&&d<=127||160<=d&&d<=255},Ve=function(d){this.windowNum=d,this.reset()};Ve.prototype.reset=function(){this.clearText(),this.pendingNewLine=!1,this.winAttr={},this.penAttr={},this.penLoc={},this.penColor={},this.visible=0,this.rowLock=0,this.columnLock=0,this.priority=0,this.relativePositioning=0,this.anchorVertical=0,this.anchorHorizontal=0,this.anchorPoint=0,this.rowCount=1,this.virtualRowCount=this.rowCount+1,this.columnCount=41,this.windowStyle=0,this.penStyle=0},Ve.prototype.getText=function(){return this.rows.join(`
`)},Ve.prototype.clearText=function(){this.rows=[""],this.rowIdx=0},Ve.prototype.newLine=function(d){for(this.rows.length>=this.virtualRowCount&&typeof this.beforeRowOverflow=="function"&&this.beforeRowOverflow(d),this.rows.length>0&&(this.rows.push(""),this.rowIdx++);this.rows.length>this.virtualRowCount;)this.rows.shift(),this.rowIdx--},Ve.prototype.isEmpty=function(){return this.rows.length===0?!0:this.rows.length===1?this.rows[0]==="":!1},Ve.prototype.addText=function(d){this.rows[this.rowIdx]+=d},Ve.prototype.backspace=function(){if(!this.isEmpty()){var d=this.rows[this.rowIdx];this.rows[this.rowIdx]=d.substr(0,d.length-1)}};var ss=function(d,p,O){this.serviceNum=d,this.text="",this.currentWindow=new Ve(-1),this.windows=[],this.stream=O,typeof p=="string"&&this.createTextDecoder(p)};ss.prototype.init=function(d,p){this.startPts=d;for(var O=0;O<8;O++)this.windows[O]=new Ve(O),typeof p=="function"&&(this.windows[O].beforeRowOverflow=p)},ss.prototype.setCurrentWindow=function(d){this.currentWindow=this.windows[d]},ss.prototype.createTextDecoder=function(d){if(typeof TextDecoder>"u")this.stream.trigger("log",{level:"warn",message:"The `encoding` option is unsupported without TextDecoder support"});else try{this.textDecoder_=new TextDecoder(d)}catch(p){this.stream.trigger("log",{level:"warn",message:"TextDecoder could not be created with "+d+" encoding. "+p})}};var Ne=function(d){d=d||{},Ne.prototype.init.call(this);var p=this,O=d.captionServices||{},g={},b;Object.keys(O).forEach(k=>{b=O[k],/^SERVICE/.test(k)&&(g[k]=b.encoding)}),this.serviceEncodings=g,this.current708Packet=null,this.services={},this.push=function(k){k.type===3?(p.new708Packet(),p.add708Bytes(k)):(p.current708Packet===null&&p.new708Packet(),p.add708Bytes(k))}};Ne.prototype=new pe,Ne.prototype.new708Packet=function(){this.current708Packet!==null&&this.push708Packet(),this.current708Packet={data:[],ptsVals:[]}},Ne.prototype.add708Bytes=function(d){var p=d.ccData,O=p>>>8,g=p&255;this.current708Packet.ptsVals.push(d.pts),this.current708Packet.data.push(O),this.current708Packet.data.push(g)},Ne.prototype.push708Packet=function(){var d=this.current708Packet,p=d.data,O=null,g=null,b=0,k=p[b++];for(d.seq=k>>6,d.sizeCode=k&63;b<p.length;b++)k=p[b++],O=k>>5,g=k&31,O===7&&g>0&&(k=p[b++],O=k),this.pushServiceBlock(O,b,g),g>0&&(b+=g-1)},Ne.prototype.pushServiceBlock=function(d,p,O){var g,b=p,k=this.current708Packet.data,Q=this.services[d];for(Q||(Q=this.initService(d,b));b<p+O&&b<k.length;b++)g=k[b],ei(g)?b=this.handleText(b,Q):g===24?b=this.multiByteCharacter(b,Q):g===16?b=this.extendedCommands(b,Q):128<=g&&g<=135?b=this.setCurrentWindow(b,Q):152<=g&&g<=159?b=this.defineWindow(b,Q):g===136?b=this.clearWindows(b,Q):g===140?b=this.deleteWindows(b,Q):g===137?b=this.displayWindows(b,Q):g===138?b=this.hideWindows(b,Q):g===139?b=this.toggleWindows(b,Q):g===151?b=this.setWindowAttributes(b,Q):g===144?b=this.setPenAttributes(b,Q):g===145?b=this.setPenColor(b,Q):g===146?b=this.setPenLocation(b,Q):g===143?Q=this.reset(b,Q):g===8?Q.currentWindow.backspace():g===12?Q.currentWindow.clearText():g===13?Q.currentWindow.pendingNewLine=!0:g===14?Q.currentWindow.clearText():g===141&&b++},Ne.prototype.extendedCommands=function(d,p){var O=this.current708Packet.data,g=O[++d];return ei(g)&&(d=this.handleText(d,p,{isExtended:!0})),d},Ne.prototype.getPts=function(d){return this.current708Packet.ptsVals[Math.floor(d/2)]},Ne.prototype.initService=function(d,p){var g="SERVICE"+d,O=this,g,b;return g in this.serviceEncodings&&(b=this.serviceEncodings[g]),this.services[d]=new ss(d,b,O),this.services[d].init(this.getPts(p),function(k){O.flushDisplayed(k,O.services[d])}),this.services[d]},Ne.prototype.handleText=function(d,p,O){var g=O&&O.isExtended,b=O&&O.isMultiByte,k=this.current708Packet.data,Q=g?4096:0,$=k[d],F=k[d+1],q=p.currentWindow,z,K;function de(se){return se.map(Ce=>("0"+(Ce&255).toString(16)).slice(-2)).join("")}if(b?(K=[$,F],d++):K=[$],p.textDecoder_&&!g)z=p.textDecoder_.decode(new Uint8Array(K));else if(b){const se=de(K);z=String.fromCharCode(parseInt(se,16))}else z=yt(Q|$);return q.pendingNewLine&&!q.isEmpty()&&q.newLine(this.getPts(d)),q.pendingNewLine=!1,q.addText(z),d},Ne.prototype.multiByteCharacter=function(d,p){var O=this.current708Packet.data,g=O[d+1],b=O[d+2];return ei(g)&&ei(b)&&(d=this.handleText(++d,p,{isMultiByte:!0})),d},Ne.prototype.setCurrentWindow=function(d,p){var O=this.current708Packet.data,g=O[d],b=g&7;return p.setCurrentWindow(b),d},Ne.prototype.defineWindow=function(d,p){var O=this.current708Packet.data,g=O[d],b=g&7;p.setCurrentWindow(b);var k=p.currentWindow;return g=O[++d],k.visible=(g&32)>>5,k.rowLock=(g&16)>>4,k.columnLock=(g&8)>>3,k.priority=g&7,g=O[++d],k.relativePositioning=(g&128)>>7,k.anchorVertical=g&127,g=O[++d],k.anchorHorizontal=g,g=O[++d],k.anchorPoint=(g&240)>>4,k.rowCount=g&15,g=O[++d],k.columnCount=g&63,g=O[++d],k.windowStyle=(g&56)>>3,k.penStyle=g&7,k.virtualRowCount=k.rowCount+1,d},Ne.prototype.setWindowAttributes=function(d,p){var O=this.current708Packet.data,g=O[d],b=p.currentWindow.winAttr;return g=O[++d],b.fillOpacity=(g&192)>>6,b.fillRed=(g&48)>>4,b.fillGreen=(g&12)>>2,b.fillBlue=g&3,g=O[++d],b.borderType=(g&192)>>6,b.borderRed=(g&48)>>4,b.borderGreen=(g&12)>>2,b.borderBlue=g&3,g=O[++d],b.borderType+=(g&128)>>5,b.wordWrap=(g&64)>>6,b.printDirection=(g&48)>>4,b.scrollDirection=(g&12)>>2,b.justify=g&3,g=O[++d],b.effectSpeed=(g&240)>>4,b.effectDirection=(g&12)>>2,b.displayEffect=g&3,d},Ne.prototype.flushDisplayed=function(d,p){for(var O=[],g=0;g<8;g++)p.windows[g].visible&&!p.windows[g].isEmpty()&&O.push(p.windows[g].getText());p.endPts=d,p.text=O.join(`

`),this.pushCaption(p),p.startPts=d},Ne.prototype.pushCaption=function(d){d.text!==""&&(this.trigger("data",{startPts:d.startPts,endPts:d.endPts,text:d.text,stream:"cc708_"+d.serviceNum}),d.text="",d.startPts=d.endPts)},Ne.prototype.displayWindows=function(d,p){var O=this.current708Packet.data,g=O[++d],b=this.getPts(d);this.flushDisplayed(b,p);for(var k=0;k<8;k++)g&1<<k&&(p.windows[k].visible=1);return d},Ne.prototype.hideWindows=function(d,p){var O=this.current708Packet.data,g=O[++d],b=this.getPts(d);this.flushDisplayed(b,p);for(var k=0;k<8;k++)g&1<<k&&(p.windows[k].visible=0);return d},Ne.prototype.toggleWindows=function(d,p){var O=this.current708Packet.data,g=O[++d],b=this.getPts(d);this.flushDisplayed(b,p);for(var k=0;k<8;k++)g&1<<k&&(p.windows[k].visible^=1);return d},Ne.prototype.clearWindows=function(d,p){var O=this.current708Packet.data,g=O[++d],b=this.getPts(d);this.flushDisplayed(b,p);for(var k=0;k<8;k++)g&1<<k&&p.windows[k].clearText();return d},Ne.prototype.deleteWindows=function(d,p){var O=this.current708Packet.data,g=O[++d],b=this.getPts(d);this.flushDisplayed(b,p);for(var k=0;k<8;k++)g&1<<k&&p.windows[k].reset();return d},Ne.prototype.setPenAttributes=function(d,p){var O=this.current708Packet.data,g=O[d],b=p.currentWindow.penAttr;return g=O[++d],b.textTag=(g&240)>>4,b.offset=(g&12)>>2,b.penSize=g&3,g=O[++d],b.italics=(g&128)>>7,b.underline=(g&64)>>6,b.edgeType=(g&56)>>3,b.fontStyle=g&7,d},Ne.prototype.setPenColor=function(d,p){var O=this.current708Packet.data,g=O[d],b=p.currentWindow.penColor;return g=O[++d],b.fgOpacity=(g&192)>>6,b.fgRed=(g&48)>>4,b.fgGreen=(g&12)>>2,b.fgBlue=g&3,g=O[++d],b.bgOpacity=(g&192)>>6,b.bgRed=(g&48)>>4,b.bgGreen=(g&12)>>2,b.bgBlue=g&3,g=O[++d],b.edgeRed=(g&48)>>4,b.edgeGreen=(g&12)>>2,b.edgeBlue=g&3,d},Ne.prototype.setPenLocation=function(d,p){var O=this.current708Packet.data,g=O[d],b=p.currentWindow.penLoc;return p.currentWindow.pendingNewLine=!0,g=O[++d],b.row=g&15,g=O[++d],b.column=g&63,d},Ne.prototype.reset=function(d,p){var O=this.getPts(d);return this.flushDisplayed(O,p),this.initService(p.serviceNum,d)};var Fn={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,304:174,305:176,306:189,307:191,308:8482,309:162,310:163,311:9834,312:224,313:160,314:232,315:226,316:234,317:238,318:244,319:251,544:193,545:201,546:211,547:218,548:220,549:252,550:8216,551:161,552:42,553:39,554:8212,555:169,556:8480,557:8226,558:8220,559:8221,560:192,561:194,562:199,563:200,564:202,565:203,566:235,567:206,568:207,569:239,570:212,571:217,572:249,573:219,574:171,575:187,800:195,801:227,802:205,803:204,804:236,805:210,806:242,807:213,808:245,809:123,810:125,811:92,812:94,813:95,814:124,815:126,816:196,817:228,818:214,819:246,820:223,821:165,822:164,823:9474,824:197,825:229,826:216,827:248,828:9484,829:9488,830:9492,831:9496},Un=function(d){return d===null?"":(d=Fn[d]||d,String.fromCharCode(d))},qn=14,bd=[4352,4384,4608,4640,5376,5408,5632,5664,5888,5920,4096,4864,4896,5120,5152],ns=function(){for(var d=[],p=qn+1;p--;)d.push({text:"",indent:0,offset:0});return d},ot=function(d,p){ot.prototype.init.call(this),this.field_=d||0,this.dataChannel_=p||0,this.name_="CC"+((this.field_<<1|this.dataChannel_)+1),this.setConstants(),this.reset(),this.push=function(O){var g,b,k,Q,$;if(g=O.ccData&32639,g===this.lastControlCode_){this.lastControlCode_=null;return}if((g&61440)===4096?this.lastControlCode_=g:g!==this.PADDING_&&(this.lastControlCode_=null),k=g>>>8,Q=g&255,g!==this.PADDING_)if(g===this.RESUME_CAPTION_LOADING_)this.mode_="popOn";else if(g===this.END_OF_CAPTION_)this.mode_="popOn",this.clearFormatting(O.pts),this.flushDisplayed(O.pts),b=this.displayed_,this.displayed_=this.nonDisplayed_,this.nonDisplayed_=b,this.startPts_=O.pts;else if(g===this.ROLL_UP_2_ROWS_)this.rollUpRows_=2,this.setRollUp(O.pts);else if(g===this.ROLL_UP_3_ROWS_)this.rollUpRows_=3,this.setRollUp(O.pts);else if(g===this.ROLL_UP_4_ROWS_)this.rollUpRows_=4,this.setRollUp(O.pts);else if(g===this.CARRIAGE_RETURN_)this.clearFormatting(O.pts),this.flushDisplayed(O.pts),this.shiftRowsUp_(),this.startPts_=O.pts;else if(g===this.BACKSPACE_)this.mode_==="popOn"?this.nonDisplayed_[this.row_].text=this.nonDisplayed_[this.row_].text.slice(0,-1):this.displayed_[this.row_].text=this.displayed_[this.row_].text.slice(0,-1);else if(g===this.ERASE_DISPLAYED_MEMORY_)this.flushDisplayed(O.pts),this.displayed_=ns();else if(g===this.ERASE_NON_DISPLAYED_MEMORY_)this.nonDisplayed_=ns();else if(g===this.RESUME_DIRECT_CAPTIONING_)this.mode_!=="paintOn"&&(this.flushDisplayed(O.pts),this.displayed_=ns()),this.mode_="paintOn",this.startPts_=O.pts;else if(this.isSpecialCharacter(k,Q))k=(k&3)<<8,$=Un(k|Q),this[this.mode_](O.pts,$),this.column_++;else if(this.isExtCharacter(k,Q))this.mode_==="popOn"?this.nonDisplayed_[this.row_].text=this.nonDisplayed_[this.row_].text.slice(0,-1):this.displayed_[this.row_].text=this.displayed_[this.row_].text.slice(0,-1),k=(k&3)<<8,$=Un(k|Q),this[this.mode_](O.pts,$),this.column_++;else if(this.isMidRowCode(k,Q))this.clearFormatting(O.pts),this[this.mode_](O.pts," "),this.column_++,(Q&14)===14&&this.addFormatting(O.pts,["i"]),(Q&1)===1&&this.addFormatting(O.pts,["u"]);else if(this.isOffsetControlCode(k,Q)){const q=Q&3;this.nonDisplayed_[this.row_].offset=q,this.column_+=q}else if(this.isPAC(k,Q)){var F=bd.indexOf(g&7968);if(this.mode_==="rollUp"&&(F-this.rollUpRows_+1<0&&(F=this.rollUpRows_-1),this.setRollUp(O.pts,F)),F!==this.row_&&F>=0&&F<=14&&(this.clearFormatting(O.pts),this.row_=F),Q&1&&this.formatting_.indexOf("u")===-1&&this.addFormatting(O.pts,["u"]),(g&16)===16){const q=(g&14)>>1;this.column_=q*4,this.nonDisplayed_[this.row_].indent+=q}this.isColorPAC(Q)&&(Q&14)===14&&this.addFormatting(O.pts,["i"])}else this.isNormalChar(k)&&(Q===0&&(Q=null),$=Un(k),$+=Un(Q),this[this.mode_](O.pts,$),this.column_+=$.length)}};ot.prototype=new pe,ot.prototype.flushDisplayed=function(d){const p=g=>{this.trigger("log",{level:"warn",message:"Skipping a malformed 608 caption at index "+g+"."})},O=[];this.displayed_.forEach((g,b)=>{if(g&&g.text&&g.text.length){try{g.text=g.text.trim()}catch{p(b)}g.text.length&&O.push({text:g.text,line:b+1,position:10+Math.min(70,g.indent*10)+g.offset*2.5})}else g==null&&p(b)}),O.length&&this.trigger("data",{startPts:this.startPts_,endPts:d,content:O,stream:this.name_})},ot.prototype.reset=function(){this.mode_="popOn",this.topRow_=0,this.startPts_=0,this.displayed_=ns(),this.nonDisplayed_=ns(),this.lastControlCode_=null,this.column_=0,this.row_=qn,this.rollUpRows_=2,this.formatting_=[]},ot.prototype.setConstants=function(){this.dataChannel_===0?(this.BASE_=16,this.EXT_=17,this.CONTROL_=(20|this.field_)<<8,this.OFFSET_=23):this.dataChannel_===1&&(this.BASE_=24,this.EXT_=25,this.CONTROL_=(28|this.field_)<<8,this.OFFSET_=31),this.PADDING_=0,this.RESUME_CAPTION_LOADING_=this.CONTROL_|32,this.END_OF_CAPTION_=this.CONTROL_|47,this.ROLL_UP_2_ROWS_=this.CONTROL_|37,this.ROLL_UP_3_ROWS_=this.CONTROL_|38,this.ROLL_UP_4_ROWS_=this.CONTROL_|39,this.CARRIAGE_RETURN_=this.CONTROL_|45,this.RESUME_DIRECT_CAPTIONING_=this.CONTROL_|41,this.BACKSPACE_=this.CONTROL_|33,this.ERASE_DISPLAYED_MEMORY_=this.CONTROL_|44,this.ERASE_NON_DISPLAYED_MEMORY_=this.CONTROL_|46},ot.prototype.isSpecialCharacter=function(d,p){return d===this.EXT_&&p>=48&&p<=63},ot.prototype.isExtCharacter=function(d,p){return(d===this.EXT_+1||d===this.EXT_+2)&&p>=32&&p<=63},ot.prototype.isMidRowCode=function(d,p){return d===this.EXT_&&p>=32&&p<=47},ot.prototype.isOffsetControlCode=function(d,p){return d===this.OFFSET_&&p>=33&&p<=35},ot.prototype.isPAC=function(d,p){return d>=this.BASE_&&d<this.BASE_+8&&p>=64&&p<=127},ot.prototype.isColorPAC=function(d){return d>=64&&d<=79||d>=96&&d<=127},ot.prototype.isNormalChar=function(d){return d>=32&&d<=127},ot.prototype.setRollUp=function(d,p){if(this.mode_!=="rollUp"&&(this.row_=qn,this.mode_="rollUp",this.flushDisplayed(d),this.nonDisplayed_=ns(),this.displayed_=ns()),p!==void 0&&p!==this.row_)for(var O=0;O<this.rollUpRows_;O++)this.displayed_[p-O]=this.displayed_[this.row_-O],this.displayed_[this.row_-O]={text:"",indent:0,offset:0};p===void 0&&(p=this.row_),this.topRow_=p-this.rollUpRows_+1},ot.prototype.addFormatting=function(d,p){this.formatting_=this.formatting_.concat(p);var O=p.reduce(function(g,b){return g+"<"+b+">"},"");this[this.mode_](d,O)},ot.prototype.clearFormatting=function(d){if(this.formatting_.length){var p=this.formatting_.reverse().reduce(function(O,g){return O+"</"+g+">"},"");this.formatting_=[],this[this.mode_](d,p)}},ot.prototype.popOn=function(d,p){var O=this.nonDisplayed_[this.row_].text;O+=p,this.nonDisplayed_[this.row_].text=O},ot.prototype.rollUp=function(d,p){var O=this.displayed_[this.row_].text;O+=p,this.displayed_[this.row_].text=O},ot.prototype.shiftRowsUp_=function(){var d;for(d=0;d<this.topRow_;d++)this.displayed_[d]={text:"",indent:0,offset:0};for(d=this.row_+1;d<qn+1;d++)this.displayed_[d]={text:"",indent:0,offset:0};for(d=this.topRow_;d<this.row_;d++)this.displayed_[d]=this.displayed_[d+1];this.displayed_[this.row_]={text:"",indent:0,offset:0}},ot.prototype.paintOn=function(d,p){var O=this.displayed_[this.row_].text;O+=p,this.displayed_[this.row_].text=O};var hu={CaptionStream:De,Cea608Stream:ot,Cea708Stream:Ne},Vn={H264_STREAM_TYPE:27,ADTS_STREAM_TYPE:15,METADATA_STREAM_TYPE:21},Yk=t,Gk=8589934592,Kk=4294967296,q0="shared",vd=function(d,p){var O=1;for(d>p&&(O=-1);Math.abs(p-d)>Kk;)d+=O*Gk;return d},Sd=function(d){var p,O;Sd.prototype.init.call(this),this.type_=d||q0,this.push=function(g){if(g.type==="metadata"){this.trigger("data",g);return}this.type_!==q0&&g.type!==this.type_||(O===void 0&&(O=g.dts),g.dts=vd(g.dts,O),g.pts=vd(g.pts,O),p=g.dts,this.trigger("data",g))},this.flush=function(){O=p,this.trigger("done")},this.endTimeline=function(){this.flush(),this.trigger("endedtimeline")},this.discontinuity=function(){O=void 0,p=void 0},this.reset=function(){this.discontinuity(),this.trigger("reset")}};Sd.prototype=new Yk;var V0={TimestampRolloverStream:Sd,handleRollover:vd},Jk=(d,p,O)=>{if(!d)return-1;for(var g=O;g<d.length;g++)if(d[g]===p)return g;return-1},eE={typedArrayIndexOf:Jk},du=eE.typedArrayIndexOf,fu={Utf8:3},X0=function(d,p,O){var g,b="";for(g=p;g<O;g++)b+="%"+("00"+d[g].toString(16)).slice(-2);return b},oo=function(d,p,O){return decodeURIComponent(X0(d,p,O))},lo=function(d,p,O){return unescape(X0(d,p,O))},uo=function(d){return d[0]<<21|d[1]<<14|d[2]<<7|d[3]},co={APIC:function(d){var p=1,O,g,b="-->";d.data[0]===fu.Utf8&&(O=du(d.data,0,p),!(O<0)&&(d.mimeType=lo(d.data,p,O),p=O+1,d.pictureType=d.data[p],p++,g=du(d.data,0,p),!(g<0)&&(d.description=oo(d.data,p,g),p=g+1,d.mimeType===b?d.url=lo(d.data,p,d.data.length):d.pictureData=d.data.subarray(p,d.data.length))))},"T*":function(d){d.data[0]===fu.Utf8&&(d.value=oo(d.data,1,d.data.length).replace(/\0*$/,""),d.values=d.value.split("\0"))},TXXX:function(d){var p;d.data[0]===fu.Utf8&&(p=du(d.data,0,1),p!==-1&&(d.description=oo(d.data,1,p),d.value=oo(d.data,p+1,d.data.length).replace(/\0*$/,""),d.data=d.value))},"W*":function(d){d.url=lo(d.data,0,d.data.length).replace(/\0.*$/,"")},WXXX:function(d){var p;d.data[0]===fu.Utf8&&(p=du(d.data,0,1),p!==-1&&(d.description=oo(d.data,1,p),d.url=lo(d.data,p+1,d.data.length).replace(/\0.*$/,"")))},PRIV:function(d){var p;for(p=0;p<d.data.length;p++)if(d.data[p]===0){d.owner=lo(d.data,0,p);break}d.privateData=d.data.subarray(p+1),d.data=d.privateData}},tE=function(d){var p,O,g=10,b=0,k=[];if(!(d.length<10||d[0]!==73||d[1]!==68||d[2]!==51)){b=uo(d.subarray(6,10)),b+=10;var Q=d[5]&64;Q&&(g+=4,g+=uo(d.subarray(10,14)),b-=uo(d.subarray(16,20)));do{if(p=uo(d.subarray(g+4,g+8)),p<1)break;O=String.fromCharCode(d[g],d[g+1],d[g+2],d[g+3]);var $={id:O,data:d.subarray(g+10,g+p+10)};$.key=$.id,co[$.id]?co[$.id]($):$.id[0]==="T"?co["T*"]($):$.id[0]==="W"&&co["W*"]($),k.push($),g+=10,g+=p}while(g<b);return k}},j0={parseId3Frames:tE,parseSyncSafeInteger:uo,frameParsers:co},iE=t,rE=Vn,ks=j0,pu;pu=function(d){var p={descriptor:d&&d.descriptor},O=0,g=[],b=0,k;if(pu.prototype.init.call(this),this.dispatchType=rE.METADATA_STREAM_TYPE.toString(16),p.descriptor)for(k=0;k<p.descriptor.length;k++)this.dispatchType+=("00"+p.descriptor[k].toString(16)).slice(-2);this.push=function(Q){var $,F,q,z,K,de;if(Q.type==="timed-metadata"){if(Q.dataAlignmentIndicator&&(b=0,g.length=0),g.length===0&&(Q.data.length<10||Q.data[0]!==73||Q.data[1]!==68||Q.data[2]!==51)){this.trigger("log",{level:"warn",message:"Skipping unrecognized metadata packet"});return}if(g.push(Q),b+=Q.data.byteLength,g.length===1&&(O=ks.parseSyncSafeInteger(Q.data.subarray(6,10)),O+=10),!(b<O)){for($={data:new Uint8Array(O),frames:[],pts:g[0].pts,dts:g[0].dts},K=0;K<O;)$.data.set(g[0].data.subarray(0,O-K),K),K+=g[0].data.byteLength,b-=g[0].data.byteLength,g.shift();F=10,$.data[5]&64&&(F+=4,F+=ks.parseSyncSafeInteger($.data.subarray(10,14)),O-=ks.parseSyncSafeInteger($.data.subarray(16,20)));do{if(q=ks.parseSyncSafeInteger($.data.subarray(F+4,F+8)),q<1){this.trigger("log",{level:"warn",message:"Malformed ID3 frame encountered. Skipping remaining metadata parsing."});break}if(de=String.fromCharCode($.data[F],$.data[F+1],$.data[F+2],$.data[F+3]),z={id:de,data:$.data.subarray(F+10,F+q+10)},z.key=z.id,ks.frameParsers[z.id]?ks.frameParsers[z.id](z):z.id[0]==="T"?ks.frameParsers["T*"](z):z.id[0]==="W"&&ks.frameParsers["W*"](z),z.owner==="com.apple.streaming.transportStreamTimestamp"){var se=z.data,Ce=(se[3]&1)<<30|se[4]<<22|se[5]<<14|se[6]<<6|se[7]>>>2;Ce*=4,Ce+=se[7]&3,z.timeStamp=Ce,$.pts===void 0&&$.dts===void 0&&($.pts=z.timeStamp,$.dts=z.timeStamp),this.trigger("timestamp",z)}$.frames.push(z),F+=10,F+=q}while(F<O);this.trigger("data",$)}}}},pu.prototype=new iE;var sE=pu,Td=t,_d=hu,hr=Vn,nE=V0.TimestampRolloverStream,mu,ho,gu,Xn=188,xd=71;mu=function(){var d=new Uint8Array(Xn),p=0;mu.prototype.init.call(this),this.push=function(O){var g=0,b=Xn,k;for(p?(k=new Uint8Array(O.byteLength+p),k.set(d.subarray(0,p)),k.set(O,p),p=0):k=O;b<k.byteLength;){if(k[g]===xd&&k[b]===xd){this.trigger("data",k.subarray(g,b)),g+=Xn,b+=Xn;continue}g++,b++}g<k.byteLength&&(d.set(k.subarray(g),0),p=k.byteLength-g)},this.flush=function(){p===Xn&&d[0]===xd&&(this.trigger("data",d),p=0),this.trigger("done")},this.endTimeline=function(){this.flush(),this.trigger("endedtimeline")},this.reset=function(){p=0,this.trigger("reset")}},mu.prototype=new Td,ho=function(){var d,p,O,g;ho.prototype.init.call(this),g=this,this.packetsWaitingForPmt=[],this.programMapTable=void 0,d=function(b,k){var Q=0;k.payloadUnitStartIndicator&&(Q+=b[Q]+1),k.type==="pat"?p(b.subarray(Q),k):O(b.subarray(Q),k)},p=function(b,k){k.section_number=b[7],k.last_section_number=b[8],g.pmtPid=(b[10]&31)<<8|b[11],k.pmtPid=g.pmtPid},O=function(b,k){var Q,$,F,q;if(b[5]&1){for(g.programMapTable={video:null,audio:null,"timed-metadata":{}},Q=(b[1]&15)<<8|b[2],$=3+Q-4,F=(b[10]&15)<<8|b[11],q=12+F;q<$;){var z=b[q],K=(b[q+1]&31)<<8|b[q+2];z===hr.H264_STREAM_TYPE&&g.programMapTable.video===null?g.programMapTable.video=K:z===hr.ADTS_STREAM_TYPE&&g.programMapTable.audio===null?g.programMapTable.audio=K:z===hr.METADATA_STREAM_TYPE&&(g.programMapTable["timed-metadata"][K]=z),q+=((b[q+3]&15)<<8|b[q+4])+5}k.programMapTable=g.programMapTable}},this.push=function(b){var k={},Q=4;if(k.payloadUnitStartIndicator=!!(b[1]&64),k.pid=b[1]&31,k.pid<<=8,k.pid|=b[2],(b[3]&48)>>>4>1&&(Q+=b[Q]+1),k.pid===0)k.type="pat",d(b.subarray(Q),k),this.trigger("data",k);else if(k.pid===this.pmtPid)for(k.type="pmt",d(b.subarray(Q),k),this.trigger("data",k);this.packetsWaitingForPmt.length;)this.processPes_.apply(this,this.packetsWaitingForPmt.shift());else this.programMapTable===void 0?this.packetsWaitingForPmt.push([b,Q,k]):this.processPes_(b,Q,k)},this.processPes_=function(b,k,Q){Q.pid===this.programMapTable.video?Q.streamType=hr.H264_STREAM_TYPE:Q.pid===this.programMapTable.audio?Q.streamType=hr.ADTS_STREAM_TYPE:Q.streamType=this.programMapTable["timed-metadata"][Q.pid],Q.type="pes",Q.data=b.subarray(k),this.trigger("data",Q)}},ho.prototype=new Td,ho.STREAM_TYPES={h264:27,adts:15},gu=function(){var d=this,p=!1,O={data:[],size:0},g={data:[],size:0},b={data:[],size:0},k,Q=function(F,q){var z;const K=F[0]<<16|F[1]<<8|F[2];q.data=new Uint8Array,K===1&&(q.packetLength=6+(F[4]<<8|F[5]),q.dataAlignmentIndicator=(F[6]&4)!==0,z=F[7],z&192&&(q.pts=(F[9]&14)<<27|(F[10]&255)<<20|(F[11]&254)<<12|(F[12]&255)<<5|(F[13]&254)>>>3,q.pts*=4,q.pts+=(F[13]&6)>>>1,q.dts=q.pts,z&64&&(q.dts=(F[14]&14)<<27|(F[15]&255)<<20|(F[16]&254)<<12|(F[17]&255)<<5|(F[18]&254)>>>3,q.dts*=4,q.dts+=(F[18]&6)>>>1)),q.data=F.subarray(9+F[8]))},$=function(F,q,z){var K=new Uint8Array(F.size),de={type:q},se=0,Ce=0,Qe=!1,Nt;if(!(!F.data.length||F.size<9)){for(de.trackId=F.data[0].pid,se=0;se<F.data.length;se++)Nt=F.data[se],K.set(Nt.data,Ce),Ce+=Nt.data.byteLength;Q(K,de),Qe=q==="video"||de.packetLength<=F.size,(z||Qe)&&(F.size=0,F.data.length=0),Qe&&d.trigger("data",de)}};gu.prototype.init.call(this),this.push=function(F){({pat:function(){},pes:function(){var q,z;switch(F.streamType){case hr.H264_STREAM_TYPE:q=O,z="video";break;case hr.ADTS_STREAM_TYPE:q=g,z="audio";break;case hr.METADATA_STREAM_TYPE:q=b,z="timed-metadata";break;default:return}F.payloadUnitStartIndicator&&$(q,z,!0),q.data.push(F),q.size+=F.data.byteLength},pmt:function(){var q={type:"metadata",tracks:[]};k=F.programMapTable,k.video!==null&&q.tracks.push({timelineStartInfo:{baseMediaDecodeTime:0},id:+k.video,codec:"avc",type:"video"}),k.audio!==null&&q.tracks.push({timelineStartInfo:{baseMediaDecodeTime:0},id:+k.audio,codec:"adts",type:"audio"}),p=!0,d.trigger("data",q)}})[F.type]()},this.reset=function(){O.size=0,O.data.length=0,g.size=0,g.data.length=0,this.trigger("reset")},this.flushStreams_=function(){$(O,"video"),$(g,"audio"),$(b,"timed-metadata")},this.flush=function(){if(!p&&k){var F={type:"metadata",tracks:[]};k.video!==null&&F.tracks.push({timelineStartInfo:{baseMediaDecodeTime:0},id:+k.video,codec:"avc",type:"video"}),k.audio!==null&&F.tracks.push({timelineStartInfo:{baseMediaDecodeTime:0},id:+k.audio,codec:"adts",type:"audio"}),d.trigger("data",F)}p=!1,this.flushStreams_(),this.trigger("done")}},gu.prototype=new Td;var z0={PAT_PID:0,MP2T_PACKET_LENGTH:Xn,TransportPacketStream:mu,TransportParseStream:ho,ElementaryStream:gu,TimestampRolloverStream:nE,CaptionStream:_d.CaptionStream,Cea608Stream:_d.Cea608Stream,Cea708Stream:_d.Cea708Stream,MetadataStream:sE};for(var wd in hr)hr.hasOwnProperty(wd)&&(z0[wd]=hr[wd]);var aE=z0,oE=t,lE=qe.ONE_SECOND_IN_TS,Ou,Z0=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];Ou=function(d){var p,O=0;Ou.prototype.init.call(this),this.skipWarn_=function(g,b){this.trigger("log",{level:"warn",message:`adts skiping bytes ${g} to ${b} in frame ${O} outside syncword`})},this.push=function(g){var b=0,k,Q,$,F,q;if(d||(O=0),g.type==="audio"){p&&p.length?($=p,p=new Uint8Array($.byteLength+g.data.byteLength),p.set($),p.set(g.data,$.byteLength)):p=g.data;for(var z;b+7<p.length;){if(p[b]!==255||(p[b+1]&246)!==240){typeof z!="number"&&(z=b),b++;continue}if(typeof z=="number"&&(this.skipWarn_(z,b),z=null),Q=(~p[b+1]&1)*2,k=(p[b+3]&3)<<11|p[b+4]<<3|(p[b+5]&224)>>5,F=((p[b+6]&3)+1)*1024,q=F*lE/Z0[(p[b+2]&60)>>>2],p.byteLength-b<k)break;this.trigger("data",{pts:g.pts+O*q,dts:g.dts+O*q,sampleCount:F,audioobjecttype:(p[b+2]>>>6&3)+1,channelcount:(p[b+2]&1)<<2|(p[b+3]&192)>>>6,samplerate:Z0[(p[b+2]&60)>>>2],samplingfrequencyindex:(p[b+2]&60)>>>2,samplesize:16,data:p.subarray(b+7+Q,b+k)}),O++,b+=k}typeof z=="number"&&(this.skipWarn_(z,b),z=null),p=p.subarray(b)}},this.flush=function(){O=0,this.trigger("done")},this.reset=function(){p=void 0,this.trigger("reset")},this.endTimeline=function(){p=void 0,this.trigger("endedtimeline")}},Ou.prototype=new oE;var uE=Ou,W0;W0=function(d){var p=d.byteLength,O=0,g=0;this.length=function(){return 8*p},this.bitsAvailable=function(){return 8*p+g},this.loadWord=function(){var b=d.byteLength-p,k=new Uint8Array(4),Q=Math.min(4,p);if(Q===0)throw new Error("no bytes available");k.set(d.subarray(b,b+Q)),O=new DataView(k.buffer).getUint32(0),g=Q*8,p-=Q},this.skipBits=function(b){var k;g>b?(O<<=b,g-=b):(b-=g,k=Math.floor(b/8),b-=k*8,p-=k,this.loadWord(),O<<=b,g-=b)},this.readBits=function(b){var k=Math.min(g,b),Q=O>>>32-k;return g-=k,g>0?O<<=k:p>0&&this.loadWord(),k=b-k,k>0?Q<<k|this.readBits(k):Q},this.skipLeadingZeros=function(){var b;for(b=0;b<g;++b)if((O&2147483648>>>b)!==0)return O<<=b,g-=b,b;return this.loadWord(),b+this.skipLeadingZeros()},this.skipUnsignedExpGolomb=function(){this.skipBits(1+this.skipLeadingZeros())},this.skipExpGolomb=function(){this.skipBits(1+this.skipLeadingZeros())},this.readUnsignedExpGolomb=function(){var b=this.skipLeadingZeros();return this.readBits(b+1)-1},this.readExpGolomb=function(){var b=this.readUnsignedExpGolomb();return 1&b?1+b>>>1:-1*(b>>>1)},this.readBoolean=function(){return this.readBits(1)===1},this.readUnsignedByte=function(){return this.readBits(8)},this.loadWord()};var cE=W0,H0=t,hE=cE,yu,bu,Y0;bu=function(){var d=0,p,O;bu.prototype.init.call(this),this.push=function(g){var b;O?(b=new Uint8Array(O.byteLength+g.data.byteLength),b.set(O),b.set(g.data,O.byteLength),O=b):O=g.data;for(var k=O.byteLength;d<k-3;d++)if(O[d+2]===1){p=d+5;break}for(;p<k;)switch(O[p]){case 0:if(O[p-1]!==0){p+=2;break}else if(O[p-2]!==0){p++;break}d+3!==p-2&&this.trigger("data",O.subarray(d+3,p-2));do p++;while(O[p]!==1&&p<k);d=p-2,p+=3;break;case 1:if(O[p-1]!==0||O[p-2]!==0){p+=3;break}this.trigger("data",O.subarray(d+3,p-2)),d=p-2,p+=3;break;default:p+=3;break}O=O.subarray(d),p-=d,d=0},this.reset=function(){O=null,d=0,this.trigger("reset")},this.flush=function(){O&&O.byteLength>3&&this.trigger("data",O.subarray(d+3)),O=null,d=0,this.trigger("done")},this.endTimeline=function(){this.flush(),this.trigger("endedtimeline")}},bu.prototype=new H0,Y0={100:!0,110:!0,122:!0,244:!0,44:!0,83:!0,86:!0,118:!0,128:!0,138:!0,139:!0,134:!0},yu=function(){var d=new bu,p,O,g,b,k,Q,$;yu.prototype.init.call(this),p=this,this.push=function(F){F.type==="video"&&(O=F.trackId,g=F.pts,b=F.dts,d.push(F))},d.on("data",function(F){var q={trackId:O,pts:g,dts:b,data:F,nalUnitTypeCode:F[0]&31};switch(q.nalUnitTypeCode){case 5:q.nalUnitType="slice_layer_without_partitioning_rbsp_idr";break;case 6:q.nalUnitType="sei_rbsp",q.escapedRBSP=k(F.subarray(1));break;case 7:q.nalUnitType="seq_parameter_set_rbsp",q.escapedRBSP=k(F.subarray(1)),q.config=Q(q.escapedRBSP);break;case 8:q.nalUnitType="pic_parameter_set_rbsp";break;case 9:q.nalUnitType="access_unit_delimiter_rbsp";break}p.trigger("data",q)}),d.on("done",function(){p.trigger("done")}),d.on("partialdone",function(){p.trigger("partialdone")}),d.on("reset",function(){p.trigger("reset")}),d.on("endedtimeline",function(){p.trigger("endedtimeline")}),this.flush=function(){d.flush()},this.partialFlush=function(){d.partialFlush()},this.reset=function(){d.reset()},this.endTimeline=function(){d.endTimeline()},$=function(F,q){var z=8,K=8,de,se;for(de=0;de<F;de++)K!==0&&(se=q.readExpGolomb(),K=(z+se+256)%256),z=K===0?z:K},k=function(F){for(var q=F.byteLength,z=[],K=1,de,se;K<q-2;)F[K]===0&&F[K+1]===0&&F[K+2]===3?(z.push(K+2),K+=2):K++;if(z.length===0)return F;de=q-z.length,se=new Uint8Array(de);var Ce=0;for(K=0;K<de;Ce++,K++)Ce===z[0]&&(Ce++,z.shift()),se[K]=F[Ce];return se},Q=function(F){var q=0,z=0,K=0,de=0,se,Ce,Qe,Nt,Pi,As,bo,vo,So,To,Du,ct=[1,1],_o,fr;if(se=new hE(F),Ce=se.readUnsignedByte(),Nt=se.readUnsignedByte(),Qe=se.readUnsignedByte(),se.skipUnsignedExpGolomb(),Y0[Ce]&&(Pi=se.readUnsignedExpGolomb(),Pi===3&&se.skipBits(1),se.skipUnsignedExpGolomb(),se.skipUnsignedExpGolomb(),se.skipBits(1),se.readBoolean()))for(Du=Pi!==3?8:12,fr=0;fr<Du;fr++)se.readBoolean()&&(fr<6?$(16,se):$(64,se));if(se.skipUnsignedExpGolomb(),As=se.readUnsignedExpGolomb(),As===0)se.readUnsignedExpGolomb();else if(As===1)for(se.skipBits(1),se.skipExpGolomb(),se.skipExpGolomb(),bo=se.readUnsignedExpGolomb(),fr=0;fr<bo;fr++)se.skipExpGolomb();if(se.skipUnsignedExpGolomb(),se.skipBits(1),vo=se.readUnsignedExpGolomb(),So=se.readUnsignedExpGolomb(),To=se.readBits(1),To===0&&se.skipBits(1),se.skipBits(1),se.readBoolean()&&(q=se.readUnsignedExpGolomb(),z=se.readUnsignedExpGolomb(),K=se.readUnsignedExpGolomb(),de=se.readUnsignedExpGolomb()),se.readBoolean()&&se.readBoolean()){switch(_o=se.readUnsignedByte(),_o){case 1:ct=[1,1];break;case 2:ct=[12,11];break;case 3:ct=[10,11];break;case 4:ct=[16,11];break;case 5:ct=[40,33];break;case 6:ct=[24,11];break;case 7:ct=[20,11];break;case 8:ct=[32,11];break;case 9:ct=[80,33];break;case 10:ct=[18,11];break;case 11:ct=[15,11];break;case 12:ct=[64,33];break;case 13:ct=[160,99];break;case 14:ct=[4,3];break;case 15:ct=[3,2];break;case 16:ct=[2,1];break;case 255:{ct=[se.readUnsignedByte()<<8|se.readUnsignedByte(),se.readUnsignedByte()<<8|se.readUnsignedByte()];break}}ct&&ct[0]/ct[1]}return{profileIdc:Ce,levelIdc:Qe,profileCompatibility:Nt,width:(vo+1)*16-q*2-z*2,height:(2-To)*(So+1)*16-K*2-de*2,sarRatio:ct}}},yu.prototype=new H0;var dE={H264Stream:yu},fE=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350],G0=function(d,p){var O=d[p+6]<<21|d[p+7]<<14|d[p+8]<<7|d[p+9],g=d[p+5],b=(g&16)>>4;return O=O>=0?O:0,b?O+20:O+10},K0=function(d,p){return d.length-p<10||d[p]!==73||d[p+1]!==68||d[p+2]!==51?p:(p+=G0(d,p),K0(d,p))},pE=function(d){var p=K0(d,0);return d.length>=p+2&&(d[p]&255)===255&&(d[p+1]&240)===240&&(d[p+1]&22)===16},J0=function(d){return d[0]<<21|d[1]<<14|d[2]<<7|d[3]},mE=function(d,p,O){var g,b="";for(g=p;g<O;g++)b+="%"+("00"+d[g].toString(16)).slice(-2);return b},gE=function(d,p,O){return unescape(mE(d,p,O))},OE=function(d,p){var O=(d[p+5]&224)>>5,g=d[p+4]<<3,b=d[p+3]&6144;return b|g|O},yE=function(d,p){return d[p]===73&&d[p+1]===68&&d[p+2]===51?"timed-metadata":d[p]&!0&&(d[p+1]&240)===240?"audio":null},bE=function(d){for(var p=0;p+5<d.length;){if(d[p]!==255||(d[p+1]&246)!==240){p++;continue}return fE[(d[p+2]&60)>>>2]}return null},vE=function(d){var p,O,g,b;p=10,d[5]&64&&(p+=4,p+=J0(d.subarray(10,14)));do{if(O=J0(d.subarray(p+4,p+8)),O<1)return null;if(b=String.fromCharCode(d[p],d[p+1],d[p+2],d[p+3]),b==="PRIV"){g=d.subarray(p+10,p+O+10);for(var k=0;k<g.byteLength;k++)if(g[k]===0){var Q=gE(g,0,k);if(Q==="com.apple.streaming.transportStreamTimestamp"){var $=g.subarray(k+1),F=($[3]&1)<<30|$[4]<<22|$[5]<<14|$[6]<<6|$[7]>>>2;return F*=4,F+=$[7]&3,F}break}}p+=10,p+=O}while(p<d.byteLength);return null},Cd={isLikelyAacData:pE,parseId3TagSize:G0,parseAdtsSize:OE,parseType:yE,parseSampleRate:bE,parseAacTimestamp:vE},SE=t,eO=Cd,vu;vu=function(){var d=new Uint8Array,p=0;vu.prototype.init.call(this),this.setTimestamp=function(O){p=O},this.push=function(O){var g=0,b=0,k,Q,$,F;for(d.length?(F=d.length,d=new Uint8Array(O.byteLength+F),d.set(d.subarray(0,F)),d.set(O,F)):d=O;d.length-b>=3;){if(d[b]===73&&d[b+1]===68&&d[b+2]===51){if(d.length-b<10||(g=eO.parseId3TagSize(d,b),b+g>d.length))break;Q={type:"timed-metadata",data:d.subarray(b,b+g)},this.trigger("data",Q),b+=g;continue}else if((d[b]&255)===255&&(d[b+1]&240)===240){if(d.length-b<7||(g=eO.parseAdtsSize(d,b),b+g>d.length))break;$={type:"audio",data:d.subarray(b,b+g),pts:p,dts:p},this.trigger("data",$),b+=g;continue}b++}k=d.length-b,k>0?d=d.subarray(b):d=new Uint8Array},this.reset=function(){d=new Uint8Array,this.trigger("reset")},this.endTimeline=function(){d=new Uint8Array,this.trigger("endedtimeline")}},vu.prototype=new SE;var TE=vu,_E=["audioobjecttype","channelcount","samplerate","samplingfrequencyindex","samplesize"],xE=_E,wE=["width","height","profileIdc","levelIdc","profileCompatibility","sarRatio"],CE=wE,Su=t,fo=ft,po=Kr,Tu=rs,dr=D,as=aE,_u=qe,tO=uE,kE=dE.H264Stream,EE=TE,AE=Cd.isLikelyAacData,PE=qe.ONE_SECOND_IN_TS,iO=xE,rO=CE,xu,mo,wu,sn,DE=function(d,p){p.stream=d,this.trigger("log",p)},sO=function(d,p){for(var O=Object.keys(p),g=0;g<O.length;g++){var b=O[g];b==="headOfPipeline"||!p[b].on||p[b].on("log",DE.bind(d,b))}},nO=function(d,p){var O;if(d.length!==p.length)return!1;for(O=0;O<d.length;O++)if(d[O]!==p[O])return!1;return!0},aO=function(d,p,O,g,b,k){var Q=O-p,$=g-p,F=b-O;return{start:{dts:d,pts:d+Q},end:{dts:d+$,pts:d+F},prependedContentDuration:k,baseMediaDecodeTime:d}};mo=function(d,p){var O=[],g,b=0,k=0,Q=1/0;p=p||{},g=p.firstSequenceNumber||0,mo.prototype.init.call(this),this.push=function($){dr.collectDtsInfo(d,$),d&&iO.forEach(function(F){d[F]=$[F]}),O.push($)},this.setEarliestDts=function($){b=$},this.setVideoBaseMediaDecodeTime=function($){Q=$},this.setAudioAppendStart=function($){k=$},this.flush=function(){var $,F,q,z,K,de,se;if(O.length===0){this.trigger("done","AudioSegmentStream");return}$=Tu.trimAdtsFramesByEarliestDts(O,d,b),d.baseMediaDecodeTime=dr.calculateTrackBaseMediaDecodeTime(d,p.keepOriginalTimestamps),se=Tu.prefixWithSilence(d,$,k,Q),d.samples=Tu.generateSampleTable($),q=fo.mdat(Tu.concatenateFrameData($)),O=[],F=fo.moof(g,[d]),z=new Uint8Array(F.byteLength+q.byteLength),g++,z.set(F),z.set(q,F.byteLength),dr.clearDtsInfo(d),K=Math.ceil(PE*1024/d.samplerate),$.length&&(de=$.length*K,this.trigger("segmentTimingInfo",aO(_u.audioTsToVideoTs(d.baseMediaDecodeTime,d.samplerate),$[0].dts,$[0].pts,$[0].dts+de,$[0].pts+de,se||0)),this.trigger("timingInfo",{start:$[0].pts,end:$[0].pts+de})),this.trigger("data",{track:d,boxes:z}),this.trigger("done","AudioSegmentStream")},this.reset=function(){dr.clearDtsInfo(d),O=[],this.trigger("reset")}},mo.prototype=new Su,xu=function(d,p){var O,g=[],b=[],k,Q;p=p||{},O=p.firstSequenceNumber||0,xu.prototype.init.call(this),delete d.minPTS,this.gopCache_=[],this.push=function($){dr.collectDtsInfo(d,$),$.nalUnitType==="seq_parameter_set_rbsp"&&!k&&(k=$.config,d.sps=[$.data],rO.forEach(function(F){d[F]=k[F]},this)),$.nalUnitType==="pic_parameter_set_rbsp"&&!Q&&(Q=$.data,d.pps=[$.data]),g.push($)},this.flush=function(){for(var $,F,q,z,K,de,se=0,Ce,Qe;g.length&&g[0].nalUnitType!=="access_unit_delimiter_rbsp";)g.shift();if(g.length===0){this.resetStream_(),this.trigger("done","VideoSegmentStream");return}if($=po.groupNalsIntoFrames(g),q=po.groupFramesIntoGops($),q[0][0].keyFrame||(F=this.getGopForFusion_(g[0],d),F?(se=F.duration,q.unshift(F),q.byteLength+=F.byteLength,q.nalCount+=F.nalCount,q.pts=F.pts,q.dts=F.dts,q.duration+=F.duration):q=po.extendFirstKeyFrame(q)),b.length){var Nt;if(p.alignGopsAtEnd?Nt=this.alignGopsAtEnd_(q):Nt=this.alignGopsAtStart_(q),!Nt){this.gopCache_.unshift({gop:q.pop(),pps:d.pps,sps:d.sps}),this.gopCache_.length=Math.min(6,this.gopCache_.length),g=[],this.resetStream_(),this.trigger("done","VideoSegmentStream");return}dr.clearDtsInfo(d),q=Nt}dr.collectDtsInfo(d,q),d.samples=po.generateSampleTable(q),K=fo.mdat(po.concatenateNalData(q)),d.baseMediaDecodeTime=dr.calculateTrackBaseMediaDecodeTime(d,p.keepOriginalTimestamps),this.trigger("processedGopsInfo",q.map(function(Pi){return{pts:Pi.pts,dts:Pi.dts,byteLength:Pi.byteLength}})),Ce=q[0],Qe=q[q.length-1],this.trigger("segmentTimingInfo",aO(d.baseMediaDecodeTime,Ce.dts,Ce.pts,Qe.dts+Qe.duration,Qe.pts+Qe.duration,se)),this.trigger("timingInfo",{start:q[0].pts,end:q[q.length-1].pts+q[q.length-1].duration}),this.gopCache_.unshift({gop:q.pop(),pps:d.pps,sps:d.sps}),this.gopCache_.length=Math.min(6,this.gopCache_.length),g=[],this.trigger("baseMediaDecodeTime",d.baseMediaDecodeTime),this.trigger("timelineStartInfo",d.timelineStartInfo),z=fo.moof(O,[d]),de=new Uint8Array(z.byteLength+K.byteLength),O++,de.set(z),de.set(K,z.byteLength),this.trigger("data",{track:d,boxes:de}),this.resetStream_(),this.trigger("done","VideoSegmentStream")},this.reset=function(){this.resetStream_(),g=[],this.gopCache_.length=0,b.length=0,this.trigger("reset")},this.resetStream_=function(){dr.clearDtsInfo(d),k=void 0,Q=void 0},this.getGopForFusion_=function($){var F=45e3,q=1/0,z,K,de,se,Ce;for(Ce=0;Ce<this.gopCache_.length;Ce++)se=this.gopCache_[Ce],de=se.gop,!(!(d.pps&&nO(d.pps[0],se.pps[0]))||!(d.sps&&nO(d.sps[0],se.sps[0])))&&(de.dts<d.timelineStartInfo.dts||(z=$.dts-de.dts-de.duration,z>=-1e4&&z<=F&&(!K||q>z)&&(K=se,q=z)));return K?K.gop:null},this.alignGopsAtStart_=function($){var F,q,z,K,de,se,Ce,Qe;for(de=$.byteLength,se=$.nalCount,Ce=$.duration,F=q=0;F<b.length&&q<$.length&&(z=b[F],K=$[q],z.pts!==K.pts);){if(K.pts>z.pts){F++;continue}q++,de-=K.byteLength,se-=K.nalCount,Ce-=K.duration}return q===0?$:q===$.length?null:(Qe=$.slice(q),Qe.byteLength=de,Qe.duration=Ce,Qe.nalCount=se,Qe.pts=Qe[0].pts,Qe.dts=Qe[0].dts,Qe)},this.alignGopsAtEnd_=function($){var F,q,z,K,de,se;for(F=b.length-1,q=$.length-1,de=null,se=!1;F>=0&&q>=0;){if(z=b[F],K=$[q],z.pts===K.pts){se=!0;break}if(z.pts>K.pts){F--;continue}F===b.length-1&&(de=q),q--}if(!se&&de===null)return null;var Ce;if(se?Ce=q:Ce=de,Ce===0)return $;var Qe=$.slice(Ce),Nt=Qe.reduce(function(Pi,As){return Pi.byteLength+=As.byteLength,Pi.duration+=As.duration,Pi.nalCount+=As.nalCount,Pi},{byteLength:0,duration:0,nalCount:0});return Qe.byteLength=Nt.byteLength,Qe.duration=Nt.duration,Qe.nalCount=Nt.nalCount,Qe.pts=Qe[0].pts,Qe.dts=Qe[0].dts,Qe},this.alignGopsWith=function($){b=$}},xu.prototype=new Su,sn=function(d,p){this.numberOfTracks=0,this.metadataStream=p,d=d||{},typeof d.remux<"u"?this.remuxTracks=!!d.remux:this.remuxTracks=!0,typeof d.keepOriginalTimestamps=="boolean"?this.keepOriginalTimestamps=d.keepOriginalTimestamps:this.keepOriginalTimestamps=!1,this.pendingTracks=[],this.videoTrack=null,this.pendingBoxes=[],this.pendingCaptions=[],this.pendingMetadata=[],this.pendingBytes=0,this.emittedTracks=0,sn.prototype.init.call(this),this.push=function(O){if(O.content||O.text)return this.pendingCaptions.push(O);if(O.frames)return this.pendingMetadata.push(O);this.pendingTracks.push(O.track),this.pendingBytes+=O.boxes.byteLength,O.track.type==="video"&&(this.videoTrack=O.track,this.pendingBoxes.push(O.boxes)),O.track.type==="audio"&&(this.audioTrack=O.track,this.pendingBoxes.unshift(O.boxes))}},sn.prototype=new Su,sn.prototype.flush=function(d){var p=0,O={captions:[],captionStreams:{},metadata:[],info:{}},g,b,k,Q=0,$;if(this.pendingTracks.length<this.numberOfTracks){if(d!=="VideoSegmentStream"&&d!=="AudioSegmentStream")return;if(this.remuxTracks)return;if(this.pendingTracks.length===0){this.emittedTracks++,this.emittedTracks>=this.numberOfTracks&&(this.trigger("done"),this.emittedTracks=0);return}}if(this.videoTrack?(Q=this.videoTrack.timelineStartInfo.pts,rO.forEach(function(F){O.info[F]=this.videoTrack[F]},this)):this.audioTrack&&(Q=this.audioTrack.timelineStartInfo.pts,iO.forEach(function(F){O.info[F]=this.audioTrack[F]},this)),this.videoTrack||this.audioTrack){for(this.pendingTracks.length===1?O.type=this.pendingTracks[0].type:O.type="combined",this.emittedTracks+=this.pendingTracks.length,k=fo.initSegment(this.pendingTracks),O.initSegment=new Uint8Array(k.byteLength),O.initSegment.set(k),O.data=new Uint8Array(this.pendingBytes),$=0;$<this.pendingBoxes.length;$++)O.data.set(this.pendingBoxes[$],p),p+=this.pendingBoxes[$].byteLength;for($=0;$<this.pendingCaptions.length;$++)g=this.pendingCaptions[$],g.startTime=_u.metadataTsToSeconds(g.startPts,Q,this.keepOriginalTimestamps),g.endTime=_u.metadataTsToSeconds(g.endPts,Q,this.keepOriginalTimestamps),O.captionStreams[g.stream]=!0,O.captions.push(g);for($=0;$<this.pendingMetadata.length;$++)b=this.pendingMetadata[$],b.cueTime=_u.metadataTsToSeconds(b.pts,Q,this.keepOriginalTimestamps),O.metadata.push(b);for(O.metadata.dispatchType=this.metadataStream.dispatchType,this.pendingTracks.length=0,this.videoTrack=null,this.pendingBoxes.length=0,this.pendingCaptions.length=0,this.pendingBytes=0,this.pendingMetadata.length=0,this.trigger("data",O),$=0;$<O.captions.length;$++)g=O.captions[$],this.trigger("caption",g);for($=0;$<O.metadata.length;$++)b=O.metadata[$],this.trigger("id3Frame",b)}this.emittedTracks>=this.numberOfTracks&&(this.trigger("done"),this.emittedTracks=0)},sn.prototype.setRemux=function(d){this.remuxTracks=d},wu=function(d){var p=this,O=!0,g,b;wu.prototype.init.call(this),d=d||{},this.baseMediaDecodeTime=d.baseMediaDecodeTime||0,this.transmuxPipeline_={},this.setupAacPipeline=function(){var k={};this.transmuxPipeline_=k,k.type="aac",k.metadataStream=new as.MetadataStream,k.aacStream=new EE,k.audioTimestampRolloverStream=new as.TimestampRolloverStream("audio"),k.timedMetadataTimestampRolloverStream=new as.TimestampRolloverStream("timed-metadata"),k.adtsStream=new tO,k.coalesceStream=new sn(d,k.metadataStream),k.headOfPipeline=k.aacStream,k.aacStream.pipe(k.audioTimestampRolloverStream).pipe(k.adtsStream),k.aacStream.pipe(k.timedMetadataTimestampRolloverStream).pipe(k.metadataStream).pipe(k.coalesceStream),k.metadataStream.on("timestamp",function(Q){k.aacStream.setTimestamp(Q.timeStamp)}),k.aacStream.on("data",function(Q){Q.type!=="timed-metadata"&&Q.type!=="audio"||k.audioSegmentStream||(b=b||{timelineStartInfo:{baseMediaDecodeTime:p.baseMediaDecodeTime},codec:"adts",type:"audio"},k.coalesceStream.numberOfTracks++,k.audioSegmentStream=new mo(b,d),k.audioSegmentStream.on("log",p.getLogTrigger_("audioSegmentStream")),k.audioSegmentStream.on("timingInfo",p.trigger.bind(p,"audioTimingInfo")),k.adtsStream.pipe(k.audioSegmentStream).pipe(k.coalesceStream),p.trigger("trackinfo",{hasAudio:!!b,hasVideo:!!g}))}),k.coalesceStream.on("data",this.trigger.bind(this,"data")),k.coalesceStream.on("done",this.trigger.bind(this,"done")),sO(this,k)},this.setupTsPipeline=function(){var k={};this.transmuxPipeline_=k,k.type="ts",k.metadataStream=new as.MetadataStream,k.packetStream=new as.TransportPacketStream,k.parseStream=new as.TransportParseStream,k.elementaryStream=new as.ElementaryStream,k.timestampRolloverStream=new as.TimestampRolloverStream,k.adtsStream=new tO,k.h264Stream=new kE,k.captionStream=new as.CaptionStream(d),k.coalesceStream=new sn(d,k.metadataStream),k.headOfPipeline=k.packetStream,k.packetStream.pipe(k.parseStream).pipe(k.elementaryStream).pipe(k.timestampRolloverStream),k.timestampRolloverStream.pipe(k.h264Stream),k.timestampRolloverStream.pipe(k.adtsStream),k.timestampRolloverStream.pipe(k.metadataStream).pipe(k.coalesceStream),k.h264Stream.pipe(k.captionStream).pipe(k.coalesceStream),k.elementaryStream.on("data",function(Q){var $;if(Q.type==="metadata"){for($=Q.tracks.length;$--;)!g&&Q.tracks[$].type==="video"?(g=Q.tracks[$],g.timelineStartInfo.baseMediaDecodeTime=p.baseMediaDecodeTime):!b&&Q.tracks[$].type==="audio"&&(b=Q.tracks[$],b.timelineStartInfo.baseMediaDecodeTime=p.baseMediaDecodeTime);g&&!k.videoSegmentStream&&(k.coalesceStream.numberOfTracks++,k.videoSegmentStream=new xu(g,d),k.videoSegmentStream.on("log",p.getLogTrigger_("videoSegmentStream")),k.videoSegmentStream.on("timelineStartInfo",function(F){b&&!d.keepOriginalTimestamps&&(b.timelineStartInfo=F,k.audioSegmentStream.setEarliestDts(F.dts-p.baseMediaDecodeTime))}),k.videoSegmentStream.on("processedGopsInfo",p.trigger.bind(p,"gopInfo")),k.videoSegmentStream.on("segmentTimingInfo",p.trigger.bind(p,"videoSegmentTimingInfo")),k.videoSegmentStream.on("baseMediaDecodeTime",function(F){b&&k.audioSegmentStream.setVideoBaseMediaDecodeTime(F)}),k.videoSegmentStream.on("timingInfo",p.trigger.bind(p,"videoTimingInfo")),k.h264Stream.pipe(k.videoSegmentStream).pipe(k.coalesceStream)),b&&!k.audioSegmentStream&&(k.coalesceStream.numberOfTracks++,k.audioSegmentStream=new mo(b,d),k.audioSegmentStream.on("log",p.getLogTrigger_("audioSegmentStream")),k.audioSegmentStream.on("timingInfo",p.trigger.bind(p,"audioTimingInfo")),k.audioSegmentStream.on("segmentTimingInfo",p.trigger.bind(p,"audioSegmentTimingInfo")),k.adtsStream.pipe(k.audioSegmentStream).pipe(k.coalesceStream)),p.trigger("trackinfo",{hasAudio:!!b,hasVideo:!!g})}}),k.coalesceStream.on("data",this.trigger.bind(this,"data")),k.coalesceStream.on("id3Frame",function(Q){Q.dispatchType=k.metadataStream.dispatchType,p.trigger("id3Frame",Q)}),k.coalesceStream.on("caption",this.trigger.bind(this,"caption")),k.coalesceStream.on("done",this.trigger.bind(this,"done")),sO(this,k)},this.setBaseMediaDecodeTime=function(k){var Q=this.transmuxPipeline_;d.keepOriginalTimestamps||(this.baseMediaDecodeTime=k),b&&(b.timelineStartInfo.dts=void 0,b.timelineStartInfo.pts=void 0,dr.clearDtsInfo(b),Q.audioTimestampRolloverStream&&Q.audioTimestampRolloverStream.discontinuity()),g&&(Q.videoSegmentStream&&(Q.videoSegmentStream.gopCache_=[]),g.timelineStartInfo.dts=void 0,g.timelineStartInfo.pts=void 0,dr.clearDtsInfo(g),Q.captionStream.reset()),Q.timestampRolloverStream&&Q.timestampRolloverStream.discontinuity()},this.setAudioAppendStart=function(k){b&&this.transmuxPipeline_.audioSegmentStream.setAudioAppendStart(k)},this.setRemux=function(k){var Q=this.transmuxPipeline_;d.remux=k,Q&&Q.coalesceStream&&Q.coalesceStream.setRemux(k)},this.alignGopsWith=function(k){g&&this.transmuxPipeline_.videoSegmentStream&&this.transmuxPipeline_.videoSegmentStream.alignGopsWith(k)},this.getLogTrigger_=function(k){var Q=this;return function($){$.stream=k,Q.trigger("log",$)}},this.push=function(k){if(O){var Q=AE(k);Q&&this.transmuxPipeline_.type!=="aac"?this.setupAacPipeline():!Q&&this.transmuxPipeline_.type!=="ts"&&this.setupTsPipeline(),O=!1}this.transmuxPipeline_.headOfPipeline.push(k)},this.flush=function(){O=!0,this.transmuxPipeline_.headOfPipeline.flush()},this.endTimeline=function(){this.transmuxPipeline_.headOfPipeline.endTimeline()},this.reset=function(){this.transmuxPipeline_.headOfPipeline&&this.transmuxPipeline_.headOfPipeline.reset()},this.resetCaptions=function(){this.transmuxPipeline_.captionStream&&this.transmuxPipeline_.captionStream.reset()}},wu.prototype=new Su;var ME={Transmuxer:wu},IE=function(d){return d>>>0},RE=function(d){return("00"+d.toString(16)).slice(-2)},Cu={toUnsigned:IE,toHexString:RE},LE=function(d){var p="";return p+=String.fromCharCode(d[0]),p+=String.fromCharCode(d[1]),p+=String.fromCharCode(d[2]),p+=String.fromCharCode(d[3]),p},oO=LE,QE=Cu.toUnsigned,$E=oO,lO=function(d,p){var O=[],g,b,k,Q,$;if(!p.length)return null;for(g=0;g<d.byteLength;)b=QE(d[g]<<24|d[g+1]<<16|d[g+2]<<8|d[g+3]),k=$E(d.subarray(g+4,g+8)),Q=b>1?g+b:d.byteLength,k===p[0]&&(p.length===1?O.push(d.subarray(g+8,Q)):($=lO(d.subarray(g+8,Q),p.slice(1)),$.length&&(O=O.concat($)))),g=Q;return O},kd=lO,BE=Cu.toUnsigned,NE=n.getUint64,FE=function(d){var p={version:d[0],flags:new Uint8Array(d.subarray(1,4))};return p.version===1?p.baseMediaDecodeTime=NE(d.subarray(4)):p.baseMediaDecodeTime=BE(d[4]<<24|d[5]<<16|d[6]<<8|d[7]),p},Ed=FE,UE=function(d){var p=new DataView(d.buffer,d.byteOffset,d.byteLength),O={version:d[0],flags:new Uint8Array(d.subarray(1,4)),trackId:p.getUint32(4)},g=O.flags[2]&1,b=O.flags[2]&2,k=O.flags[2]&8,Q=O.flags[2]&16,$=O.flags[2]&32,F=O.flags[0]&65536,q=O.flags[0]&131072,z;return z=8,g&&(z+=4,O.baseDataOffset=p.getUint32(12),z+=4),b&&(O.sampleDescriptionIndex=p.getUint32(z),z+=4),k&&(O.defaultSampleDuration=p.getUint32(z),z+=4),Q&&(O.defaultSampleSize=p.getUint32(z),z+=4),$&&(O.defaultSampleFlags=p.getUint32(z)),F&&(O.durationIsEmpty=!0),!g&&q&&(O.baseDataOffsetIsMoof=!0),O},uO=UE,qE=function(d){return{isLeading:(d[0]&12)>>>2,dependsOn:d[0]&3,isDependedOn:(d[1]&192)>>>6,hasRedundancy:(d[1]&48)>>>4,paddingValue:(d[1]&14)>>>1,isNonSyncSample:d[1]&1,degradationPriority:d[2]<<8|d[3]}},VE=qE,cO=VE,XE=function(d){var p={version:d[0],flags:new Uint8Array(d.subarray(1,4)),samples:[]},O=new DataView(d.buffer,d.byteOffset,d.byteLength),g=p.flags[2]&1,b=p.flags[2]&4,k=p.flags[1]&1,Q=p.flags[1]&2,$=p.flags[1]&4,F=p.flags[1]&8,q=O.getUint32(4),z=8,K;for(g&&(p.dataOffset=O.getInt32(z),z+=4),b&&q&&(K={flags:cO(d.subarray(z,z+4))},z+=4,k&&(K.duration=O.getUint32(z),z+=4),Q&&(K.size=O.getUint32(z),z+=4),F&&(p.version===1?K.compositionTimeOffset=O.getInt32(z):K.compositionTimeOffset=O.getUint32(z),z+=4),p.samples.push(K),q--);q--;)K={},k&&(K.duration=O.getUint32(z),z+=4),Q&&(K.size=O.getUint32(z),z+=4),$&&(K.flags=cO(d.subarray(z,z+4)),z+=4),F&&(p.version===1?K.compositionTimeOffset=O.getInt32(z):K.compositionTimeOffset=O.getUint32(z),z+=4),p.samples.push(K);return p},hO=XE,dO={tfdt:Ed,trun:hO},fO={parseTfdt:dO.tfdt,parseTrun:dO.trun},jE=function(d){for(var p=0,O=String.fromCharCode(d[p]),g="";O!=="\0";)g+=O,p++,O=String.fromCharCode(d[p]);return g+=O,g},zE={uint8ToCString:jE},ku=zE.uint8ToCString,ZE=n.getUint64,WE=function(d){var p=4,O=d[0],g,b,k,Q,$,F,q,z;if(O===0){g=ku(d.subarray(p)),p+=g.length,b=ku(d.subarray(p)),p+=b.length;var K=new DataView(d.buffer);k=K.getUint32(p),p+=4,$=K.getUint32(p),p+=4,F=K.getUint32(p),p+=4,q=K.getUint32(p),p+=4}else if(O===1){var K=new DataView(d.buffer);k=K.getUint32(p),p+=4,Q=ZE(d.subarray(p)),p+=8,F=K.getUint32(p),p+=4,q=K.getUint32(p),p+=4,g=ku(d.subarray(p)),p+=g.length,b=ku(d.subarray(p)),p+=b.length}z=new Uint8Array(d.subarray(p,d.byteLength));var de={scheme_id_uri:g,value:b,timescale:k||1,presentation_time:Q,presentation_time_delta:$,event_duration:F,id:q,message_data:z};return YE(O,de)?de:void 0},HE=function(d,p,O,g){return d||d===0?d/p:g+O/p},YE=function(d,p){var O=p.scheme_id_uri!=="\0",g=d===0&&pO(p.presentation_time_delta)&&O,b=d===1&&pO(p.presentation_time)&&O;return!(d>1)&&g||b},pO=function(d){return d!==void 0||d!==null},GE={parseEmsgBox:WE,scaleTime:HE},go;typeof window<"u"?go=window:typeof r<"u"?go=r:typeof self<"u"?go=self:go={};var mO=go,Eu=Cu.toUnsigned,Oo=Cu.toHexString,wt=kd,jn=oO,Ad=GE,KE=uO,JE=hO,eA=Ed,tA=n.getUint64,gO,OO,yO,bO,vO,Pd,SO,Dd=mO,iA=j0.parseId3Frames;gO=function(d){var p={},O=wt(d,["moov","trak"]);return O.reduce(function(g,b){var k,Q,$,F,q;return k=wt(b,["tkhd"])[0],!k||(Q=k[0],$=Q===0?12:20,F=Eu(k[$]<<24|k[$+1]<<16|k[$+2]<<8|k[$+3]),q=wt(b,["mdia","mdhd"])[0],!q)?null:(Q=q[0],$=Q===0?12:20,g[F]=Eu(q[$]<<24|q[$+1]<<16|q[$+2]<<8|q[$+3]),g)},p)},OO=function(d,p){var O;O=wt(p,["moof","traf"]);var g=O.reduce(function(b,k){var Q=wt(k,["tfhd"])[0],$=Eu(Q[4]<<24|Q[5]<<16|Q[6]<<8|Q[7]),F=d[$]||9e4,q=wt(k,["tfdt"])[0],z=new DataView(q.buffer,q.byteOffset,q.byteLength),K;q[0]===1?K=tA(q.subarray(4,12)):K=z.getUint32(4);let de;return typeof K=="bigint"?de=K/Dd.BigInt(F):typeof K=="number"&&!isNaN(K)&&(de=K/F),de<Number.MAX_SAFE_INTEGER&&(de=Number(de)),de<b&&(b=de),b},1/0);return typeof g=="bigint"||isFinite(g)?g:0},yO=function(d,p){var O=wt(p,["moof","traf"]),g=0,b=0,k;if(O&&O.length){var Q=wt(O[0],["tfhd"])[0],$=wt(O[0],["trun"])[0],F=wt(O[0],["tfdt"])[0];if(Q){var q=KE(Q);k=q.trackId}if(F){var z=eA(F);g=z.baseMediaDecodeTime}if($){var K=JE($);K.samples&&K.samples.length&&(b=K.samples[0].compositionTimeOffset||0)}}var de=d[k]||9e4;typeof g=="bigint"&&(b=Dd.BigInt(b),de=Dd.BigInt(de));var se=(g+b)/de;return typeof se=="bigint"&&se<Number.MAX_SAFE_INTEGER&&(se=Number(se)),se},bO=function(d){var p=wt(d,["moov","trak"]),O=[];return p.forEach(function(g){var b=wt(g,["mdia","hdlr"]),k=wt(g,["tkhd"]);b.forEach(function(Q,$){var F=jn(Q.subarray(8,12)),q=k[$],z,K,de;F==="vide"&&(z=new DataView(q.buffer,q.byteOffset,q.byteLength),K=z.getUint8(0),de=K===0?z.getUint32(12):z.getUint32(20),O.push(de))})}),O},Pd=function(d){var p=d[0],O=p===0?12:20;return Eu(d[O]<<24|d[O+1]<<16|d[O+2]<<8|d[O+3])},vO=function(d){var p=wt(d,["moov","trak"]),O=[];return p.forEach(function(g){var b={},k=wt(g,["tkhd"])[0],Q,$;k&&(Q=new DataView(k.buffer,k.byteOffset,k.byteLength),$=Q.getUint8(0),b.id=$===0?Q.getUint32(12):Q.getUint32(20));var F=wt(g,["mdia","hdlr"])[0];if(F){var q=jn(F.subarray(8,12));q==="vide"?b.type="video":q==="soun"?b.type="audio":b.type=q}var z=wt(g,["mdia","minf","stbl","stsd"])[0];if(z){var K=z.subarray(8);b.codec=jn(K.subarray(4,8));var de=wt(K,[b.codec])[0],se,Ce;de&&(/^[asm]vc[1-9]$/i.test(b.codec)?(se=de.subarray(78),Ce=jn(se.subarray(4,8)),Ce==="avcC"&&se.length>11?(b.codec+=".",b.codec+=Oo(se[9]),b.codec+=Oo(se[10]),b.codec+=Oo(se[11])):b.codec="avc1.4d400d"):/^mp4[a,v]$/i.test(b.codec)?(se=de.subarray(28),Ce=jn(se.subarray(4,8)),Ce==="esds"&&se.length>20&&se[19]!==0?(b.codec+="."+Oo(se[19]),b.codec+="."+Oo(se[20]>>>2&63).replace(/^0/,"")):b.codec="mp4a.40.2"):b.codec=b.codec.toLowerCase())}var Qe=wt(g,["mdia","mdhd"])[0];Qe&&(b.timescale=Pd(Qe)),O.push(b)}),O},SO=function(d,p=0){var O=wt(d,["emsg"]);return O.map(g=>{var b=Ad.parseEmsgBox(new Uint8Array(g)),k=iA(b.message_data);return{cueTime:Ad.scaleTime(b.presentation_time,b.timescale,b.presentation_time_delta,p),duration:Ad.scaleTime(b.event_duration,b.timescale),frames:k}})};var yo={findBox:wt,parseType:jn,timescale:gO,startTime:OO,compositionStartTime:yO,videoTrackIds:bO,tracks:vO,getTimescaleFromMediaHeader:Pd,getEmsgID3:SO};const{parseTrun:rA}=fO,{findBox:TO}=yo;var _O=mO,sA=function(d){var p=TO(d,["moof","traf"]),O=TO(d,["mdat"]),g=[];return O.forEach(function(b,k){var Q=p[k];g.push({mdat:b,traf:Q})}),g},nA=function(d,p,O){var g=p,b=O.defaultSampleDuration||0,k=O.defaultSampleSize||0,Q=O.trackId,$=[];return d.forEach(function(F){var q=rA(F),z=q.samples;z.forEach(function(K){K.duration===void 0&&(K.duration=b),K.size===void 0&&(K.size=k),K.trackId=Q,K.dts=g,K.compositionTimeOffset===void 0&&(K.compositionTimeOffset=0),typeof g=="bigint"?(K.pts=g+_O.BigInt(K.compositionTimeOffset),g+=_O.BigInt(K.duration)):(K.pts=g+K.compositionTimeOffset,g+=K.duration)}),$=$.concat(z)}),$},xO={getMdatTrafPairs:sA,parseSamples:nA},aA=Ae.discardEmulationPreventionBytes,oA=hu.CaptionStream,Md=kd,lA=Ed,uA=uO,{getMdatTrafPairs:cA,parseSamples:hA}=xO,dA=function(d,p){for(var O=d,g=0;g<p.length;g++){var b=p[g];if(O<b.size)return b;O-=b.size}return null},fA=function(d,p,O){var g=new DataView(d.buffer,d.byteOffset,d.byteLength),b={logs:[],seiNals:[]},k,Q,$,F;for(Q=0;Q+4<d.length;Q+=$)if($=g.getUint32(Q),Q+=4,!($<=0))switch(d[Q]&31){case 6:var q=d.subarray(Q+1,Q+1+$),z=dA(Q,p);if(k={nalUnitType:"sei_rbsp",size:$,data:q,escapedRBSP:aA(q),trackId:O},z)k.pts=z.pts,k.dts=z.dts,F=z;else if(F)k.pts=F.pts,k.dts=F.dts;else{b.logs.push({level:"warn",message:"We've encountered a nal unit without data at "+Q+" for trackId "+O+". See mux.js#223."});break}b.seiNals.push(k);break}return b},pA=function(d,p){var O={},g=cA(d);return g.forEach(function(b){var k=b.mdat,Q=b.traf,$=Md(Q,["tfhd"]),F=uA($[0]),q=F.trackId,z=Md(Q,["tfdt"]),K=z.length>0?lA(z[0]).baseMediaDecodeTime:0,de=Md(Q,["trun"]),se,Ce;p===q&&de.length>0&&(se=hA(de,K,F),Ce=fA(k,se,q),O[q]||(O[q]={seiNals:[],logs:[]}),O[q].seiNals=O[q].seiNals.concat(Ce.seiNals),O[q].logs=O[q].logs.concat(Ce.logs))}),O},mA=function(d,p,O){var g;if(p===null)return null;g=pA(d,p);var b=g[p]||{};return{seiNals:b.seiNals,logs:b.logs,timescale:O}},gA=function(){var d=!1,p,O,g,b,k,Q;this.isInitialized=function(){return d},this.init=function($){p=new oA,d=!0,Q=$?$.isPartial:!1,p.on("data",function(F){F.startTime=F.startPts/b,F.endTime=F.endPts/b,k.captions.push(F),k.captionStreams[F.stream]=!0}),p.on("log",function(F){k.logs.push(F)})},this.isNewInit=function($,F){return $&&$.length===0||F&&typeof F=="object"&&Object.keys(F).length===0?!1:g!==$[0]||b!==F[g]},this.parse=function($,F,q){var z;if(this.isInitialized()){if(!F||!q)return null;if(this.isNewInit(F,q))g=F[0],b=q[g];else if(g===null||!b)return O.push($),null}else return null;for(;O.length>0;){var K=O.shift();this.parse(K,F,q)}return z=mA($,g,b),z&&z.logs&&(k.logs=k.logs.concat(z.logs)),z===null||!z.seiNals?k.logs.length?{logs:k.logs,captions:[],captionStreams:[]}:null:(this.pushNals(z.seiNals),this.flushStream(),k)},this.pushNals=function($){if(!this.isInitialized()||!$||$.length===0)return null;$.forEach(function(F){p.push(F)})},this.flushStream=function(){if(!this.isInitialized())return null;Q?p.partialFlush():p.flush()},this.clearParsedCaptions=function(){k.captions=[],k.captionStreams={},k.logs=[]},this.resetCaptionStream=function(){if(!this.isInitialized())return null;p.reset()},this.clearAllCaptions=function(){this.clearParsedCaptions(),this.resetCaptionStream()},this.reset=function(){O=[],g=null,b=null,k?this.clearParsedCaptions():k={captions:[],captionStreams:{},logs:[]},this.resetCaptionStream()},this.reset()},OA=gA;const{parseTfdt:yA}=fO,Es=kd,{getTimescaleFromMediaHeader:bA}=yo,{parseSamples:vA,getMdatTrafPairs:SA}=xO;var wO=function(){let d=9e4;this.init=function(p){const O=Es(p,["moov","trak","mdia","mdhd"])[0];O&&(d=bA(O))},this.parseSegment=function(p){const O=[],g=SA(p);let b=0;return g.forEach(function(k){const Q=k.mdat,$=k.traf,F=Es($,["tfdt"])[0],q=Es($,["tfhd"])[0],z=Es($,["trun"]);if(F&&(b=yA(F).baseMediaDecodeTime),z.length&&q){const K=vA(z,b,q);let de=0;K.forEach(function(se){const Ce="utf-8",Qe=new TextDecoder(Ce),Nt=Q.slice(de,de+se.size);if(Es(Nt,["vtte"])[0]){de+=se.size;return}Es(Nt,["vttc"]).forEach(function(bo){const vo=Es(bo,["payl"])[0],So=Es(bo,["sttg"])[0],To=se.pts/d,Du=(se.pts+se.duration)/d;let ct,_o;if(vo)try{ct=Qe.decode(vo)}catch(fr){console.error(fr)}if(So)try{_o=Qe.decode(So)}catch(fr){console.error(fr)}se.duration&&ct&&O.push({cueText:ct,start:To,end:Du,settings:_o})}),de+=se.size})}}),O}},Id=Vn,CO=function(d){var p=d[1]&31;return p<<=8,p|=d[2],p},Au=function(d){return!!(d[1]&64)},Pu=function(d){var p=0;return(d[3]&48)>>>4>1&&(p+=d[4]+1),p},TA=function(d,p){var O=CO(d);return O===0?"pat":O===p?"pmt":p?"pes":null},_A=function(d){var p=Au(d),O=4+Pu(d);return p&&(O+=d[O]+1),(d[O+10]&31)<<8|d[O+11]},xA=function(d){var p={},O=Au(d),g=4+Pu(d);if(O&&(g+=d[g]+1),!!(d[g+5]&1)){var b,k,Q;b=(d[g+1]&15)<<8|d[g+2],k=3+b-4,Q=(d[g+10]&15)<<8|d[g+11];for(var $=12+Q;$<k;){var F=g+$;p[(d[F+1]&31)<<8|d[F+2]]=d[F],$+=((d[F+3]&15)<<8|d[F+4])+5}return p}},wA=function(d,p){var O=CO(d),g=p[O];switch(g){case Id.H264_STREAM_TYPE:return"video";case Id.ADTS_STREAM_TYPE:return"audio";case Id.METADATA_STREAM_TYPE:return"timed-metadata";default:return null}},CA=function(d){var p=Au(d);if(!p)return null;var O=4+Pu(d);if(O>=d.byteLength)return null;var g=null,b;return b=d[O+7],b&192&&(g={},g.pts=(d[O+9]&14)<<27|(d[O+10]&255)<<20|(d[O+11]&254)<<12|(d[O+12]&255)<<5|(d[O+13]&254)>>>3,g.pts*=4,g.pts+=(d[O+13]&6)>>>1,g.dts=g.pts,b&64&&(g.dts=(d[O+14]&14)<<27|(d[O+15]&255)<<20|(d[O+16]&254)<<12|(d[O+17]&255)<<5|(d[O+18]&254)>>>3,g.dts*=4,g.dts+=(d[O+18]&6)>>>1)),g},Rd=function(d){switch(d){case 5:return"slice_layer_without_partitioning_rbsp_idr";case 6:return"sei_rbsp";case 7:return"seq_parameter_set_rbsp";case 8:return"pic_parameter_set_rbsp";case 9:return"access_unit_delimiter_rbsp";default:return null}},kA=function(d){for(var p=4+Pu(d),O=d.subarray(p),g=0,b=0,k=!1,Q;b<O.byteLength-3;b++)if(O[b+2]===1){g=b+5;break}for(;g<O.byteLength;)switch(O[g]){case 0:if(O[g-1]!==0){g+=2;break}else if(O[g-2]!==0){g++;break}b+3!==g-2&&(Q=Rd(O[b+3]&31),Q==="slice_layer_without_partitioning_rbsp_idr"&&(k=!0));do g++;while(O[g]!==1&&g<O.length);b=g-2,g+=3;break;case 1:if(O[g-1]!==0||O[g-2]!==0){g+=3;break}Q=Rd(O[b+3]&31),Q==="slice_layer_without_partitioning_rbsp_idr"&&(k=!0),b=g-2,g+=3;break;default:g+=3;break}return O=O.subarray(b),g-=b,b=0,O&&O.byteLength>3&&(Q=Rd(O[b+3]&31),Q==="slice_layer_without_partitioning_rbsp_idr"&&(k=!0)),k},EA={parseType:TA,parsePat:_A,parsePmt:xA,parsePayloadUnitStartIndicator:Au,parsePesType:wA,parsePesTime:CA,videoPacketContainsKeyFrame:kA},kO=Vn,zn=V0.handleRollover,Ye={};Ye.ts=EA,Ye.aac=Cd;var nn=qe.ONE_SECOND_IN_TS,ui=188,kr=71,AA=function(d,p){for(var O=0,g=ui,b,k;g<d.byteLength;){if(d[O]===kr&&d[g]===kr){switch(b=d.subarray(O,g),k=Ye.ts.parseType(b,p.pid),k){case"pat":p.pid=Ye.ts.parsePat(b);break;case"pmt":var Q=Ye.ts.parsePmt(b);p.table=p.table||{},Object.keys(Q).forEach(function($){p.table[$]=Q[$]});break}O+=ui,g+=ui;continue}O++,g++}},EO=function(d,p,O){for(var g=0,b=ui,k,Q,$,F,q,z=!1;b<=d.byteLength;){if(d[g]===kr&&(d[b]===kr||b===d.byteLength)){switch(k=d.subarray(g,b),Q=Ye.ts.parseType(k,p.pid),Q){case"pes":$=Ye.ts.parsePesType(k,p.table),F=Ye.ts.parsePayloadUnitStartIndicator(k),$==="audio"&&F&&(q=Ye.ts.parsePesTime(k),q&&(q.type="audio",O.audio.push(q),z=!0));break}if(z)break;g+=ui,b+=ui;continue}g++,b++}for(b=d.byteLength,g=b-ui,z=!1;g>=0;){if(d[g]===kr&&(d[b]===kr||b===d.byteLength)){switch(k=d.subarray(g,b),Q=Ye.ts.parseType(k,p.pid),Q){case"pes":$=Ye.ts.parsePesType(k,p.table),F=Ye.ts.parsePayloadUnitStartIndicator(k),$==="audio"&&F&&(q=Ye.ts.parsePesTime(k),q&&(q.type="audio",O.audio.push(q),z=!0));break}if(z)break;g-=ui,b-=ui;continue}g--,b--}},PA=function(d,p,O){for(var g=0,b=ui,k,Q,$,F,q,z,K,de,se=!1,Ce={data:[],size:0};b<d.byteLength;){if(d[g]===kr&&d[b]===kr){switch(k=d.subarray(g,b),Q=Ye.ts.parseType(k,p.pid),Q){case"pes":if($=Ye.ts.parsePesType(k,p.table),F=Ye.ts.parsePayloadUnitStartIndicator(k),$==="video"&&(F&&!se&&(q=Ye.ts.parsePesTime(k),q&&(q.type="video",O.video.push(q),se=!0)),!O.firstKeyFrame)){if(F&&Ce.size!==0){for(z=new Uint8Array(Ce.size),K=0;Ce.data.length;)de=Ce.data.shift(),z.set(de,K),K+=de.byteLength;if(Ye.ts.videoPacketContainsKeyFrame(z)){var Qe=Ye.ts.parsePesTime(z);Qe?(O.firstKeyFrame=Qe,O.firstKeyFrame.type="video"):console.warn("Failed to extract PTS/DTS from PES at first keyframe. This could be an unusual TS segment, or else mux.js did not parse your TS segment correctly. If you know your TS segments do contain PTS/DTS on keyframes please file a bug report! You can try ffprobe to double check for yourself.")}Ce.size=0}Ce.data.push(k),Ce.size+=k.byteLength}break}if(se&&O.firstKeyFrame)break;g+=ui,b+=ui;continue}g++,b++}for(b=d.byteLength,g=b-ui,se=!1;g>=0;){if(d[g]===kr&&d[b]===kr){switch(k=d.subarray(g,b),Q=Ye.ts.parseType(k,p.pid),Q){case"pes":$=Ye.ts.parsePesType(k,p.table),F=Ye.ts.parsePayloadUnitStartIndicator(k),$==="video"&&F&&(q=Ye.ts.parsePesTime(k),q&&(q.type="video",O.video.push(q),se=!0));break}if(se)break;g-=ui,b-=ui;continue}g--,b--}},DA=function(d,p){if(d.audio&&d.audio.length){var O=p;(typeof O>"u"||isNaN(O))&&(O=d.audio[0].dts),d.audio.forEach(function(k){k.dts=zn(k.dts,O),k.pts=zn(k.pts,O),k.dtsTime=k.dts/nn,k.ptsTime=k.pts/nn})}if(d.video&&d.video.length){var g=p;if((typeof g>"u"||isNaN(g))&&(g=d.video[0].dts),d.video.forEach(function(k){k.dts=zn(k.dts,g),k.pts=zn(k.pts,g),k.dtsTime=k.dts/nn,k.ptsTime=k.pts/nn}),d.firstKeyFrame){var b=d.firstKeyFrame;b.dts=zn(b.dts,g),b.pts=zn(b.pts,g),b.dtsTime=b.dts/nn,b.ptsTime=b.pts/nn}}},MA=function(d){for(var p=!1,O=0,g=null,b=null,k=0,Q=0,$;d.length-Q>=3;){var F=Ye.aac.parseType(d,Q);switch(F){case"timed-metadata":if(d.length-Q<10){p=!0;break}if(k=Ye.aac.parseId3TagSize(d,Q),k>d.length){p=!0;break}b===null&&($=d.subarray(Q,Q+k),b=Ye.aac.parseAacTimestamp($)),Q+=k;break;case"audio":if(d.length-Q<7){p=!0;break}if(k=Ye.aac.parseAdtsSize(d,Q),k>d.length){p=!0;break}g===null&&($=d.subarray(Q,Q+k),g=Ye.aac.parseSampleRate($)),O++,Q+=k;break;default:Q++;break}if(p)return null}if(g===null||b===null)return null;var q=nn/g,z={audio:[{type:"audio",dts:b,pts:b},{type:"audio",dts:b+O*1024*q,pts:b+O*1024*q}]};return z},IA=function(d){var p={pid:null,table:null},O={};AA(d,p);for(var g in p.table)if(p.table.hasOwnProperty(g)){var b=p.table[g];switch(b){case kO.H264_STREAM_TYPE:O.video=[],PA(d,p,O),O.video.length===0&&delete O.video;break;case kO.ADTS_STREAM_TYPE:O.audio=[],EO(d,p,O),O.audio.length===0&&delete O.audio;break}}return O},RA=function(d,p){var O=Ye.aac.isLikelyAacData(d),g;return O?g=MA(d):g=IA(d),!g||!g.audio&&!g.video?null:(DA(g,p),g)},LA={inspect:RA,parseAudioPes_:EO};const QA=function(d,p){p.on("data",function(O){const g=O.initSegment;O.initSegment={data:g.buffer,byteOffset:g.byteOffset,byteLength:g.byteLength};const b=O.data;O.data=b.buffer,d.postMessage({action:"data",segment:O,byteOffset:b.byteOffset,byteLength:b.byteLength},[O.data])}),p.on("done",function(O){d.postMessage({action:"done"})}),p.on("gopInfo",function(O){d.postMessage({action:"gopInfo",gopInfo:O})}),p.on("videoSegmentTimingInfo",function(O){const g={start:{decode:qe.videoTsToSeconds(O.start.dts),presentation:qe.videoTsToSeconds(O.start.pts)},end:{decode:qe.videoTsToSeconds(O.end.dts),presentation:qe.videoTsToSeconds(O.end.pts)},baseMediaDecodeTime:qe.videoTsToSeconds(O.baseMediaDecodeTime)};O.prependedContentDuration&&(g.prependedContentDuration=qe.videoTsToSeconds(O.prependedContentDuration)),d.postMessage({action:"videoSegmentTimingInfo",videoSegmentTimingInfo:g})}),p.on("audioSegmentTimingInfo",function(O){const g={start:{decode:qe.videoTsToSeconds(O.start.dts),presentation:qe.videoTsToSeconds(O.start.pts)},end:{decode:qe.videoTsToSeconds(O.end.dts),presentation:qe.videoTsToSeconds(O.end.pts)},baseMediaDecodeTime:qe.videoTsToSeconds(O.baseMediaDecodeTime)};O.prependedContentDuration&&(g.prependedContentDuration=qe.videoTsToSeconds(O.prependedContentDuration)),d.postMessage({action:"audioSegmentTimingInfo",audioSegmentTimingInfo:g})}),p.on("id3Frame",function(O){d.postMessage({action:"id3Frame",id3Frame:O})}),p.on("caption",function(O){d.postMessage({action:"caption",caption:O})}),p.on("trackinfo",function(O){d.postMessage({action:"trackinfo",trackInfo:O})}),p.on("audioTimingInfo",function(O){d.postMessage({action:"audioTimingInfo",audioTimingInfo:{start:qe.videoTsToSeconds(O.start),end:qe.videoTsToSeconds(O.end)}})}),p.on("videoTimingInfo",function(O){d.postMessage({action:"videoTimingInfo",videoTimingInfo:{start:qe.videoTsToSeconds(O.start),end:qe.videoTsToSeconds(O.end)}})}),p.on("log",function(O){d.postMessage({action:"log",log:O})})};class AO{constructor(p,O){this.options=O||{},this.self=p,this.init()}init(){this.transmuxer&&this.transmuxer.dispose(),this.transmuxer=new ME.Transmuxer(this.options),QA(this.self,this.transmuxer)}pushMp4Captions(p){this.captionParser||(this.captionParser=new OA,this.captionParser.init());const O=new Uint8Array(p.data,p.byteOffset,p.byteLength),g=this.captionParser.parse(O,p.trackIds,p.timescales);this.self.postMessage({action:"mp4Captions",captions:g&&g.captions||[],logs:g&&g.logs||[],data:O.buffer},[O.buffer])}initMp4WebVttParser(p){this.webVttParser||(this.webVttParser=new wO);const O=new Uint8Array(p.data,p.byteOffset,p.byteLength);this.webVttParser.init(O)}getMp4WebVttText(p){this.webVttParser||(this.webVttParser=new wO);const O=new Uint8Array(p.data,p.byteOffset,p.byteLength),g=this.webVttParser.parseSegment(O);this.self.postMessage({action:"getMp4WebVttText",mp4VttCues:g||[],data:O.buffer},[O.buffer])}probeMp4StartTime({timescales:p,data:O}){const g=yo.startTime(p,O);this.self.postMessage({action:"probeMp4StartTime",startTime:g,data:O},[O.buffer])}probeMp4Tracks({data:p}){const O=yo.tracks(p);this.self.postMessage({action:"probeMp4Tracks",tracks:O,data:p},[p.buffer])}probeEmsgID3({data:p,offset:O}){const g=yo.getEmsgID3(p,O);this.self.postMessage({action:"probeEmsgID3",id3Frames:g,emsgData:p},[p.buffer])}probeTs({data:p,baseStartTime:O}){const g=typeof O=="number"&&!isNaN(O)?O*qe.ONE_SECOND_IN_TS:void 0,b=LA.inspect(p,g);let k=null;b&&(k={hasVideo:b.video&&b.video.length===2||!1,hasAudio:b.audio&&b.audio.length===2||!1},k.hasVideo&&(k.videoStart=b.video[0].ptsTime),k.hasAudio&&(k.audioStart=b.audio[0].ptsTime)),this.self.postMessage({action:"probeTs",result:k,data:p},[p.buffer])}clearAllMp4Captions(){this.captionParser&&this.captionParser.clearAllCaptions()}clearParsedMp4Captions(){this.captionParser&&this.captionParser.clearParsedCaptions()}push(p){const O=new Uint8Array(p.data,p.byteOffset,p.byteLength);this.transmuxer.push(O)}reset(){this.transmuxer.reset()}setTimestampOffset(p){const O=p.timestampOffset||0;this.transmuxer.setBaseMediaDecodeTime(Math.round(qe.secondsToVideoTs(O)))}setAudioAppendStart(p){this.transmuxer.setAudioAppendStart(Math.ceil(qe.secondsToVideoTs(p.appendStart)))}setRemux(p){this.transmuxer.setRemux(p.remux)}flush(p){this.transmuxer.flush(),self.postMessage({action:"done",type:"transmuxed"})}endTimeline(){this.transmuxer.endTimeline(),self.postMessage({action:"endedtimeline",type:"transmuxed"})}alignGopsWith(p){this.transmuxer.alignGopsWith(p.gopsToAlignWith.slice())}}self.onmessage=function(d){if(d.data.action==="init"&&d.data.options){this.messageHandlers=new AO(self,d.data.options);return}this.messageHandlers||(this.messageHandlers=new AO(self)),d.data&&d.data.action&&d.data.action!=="init"&&this.messageHandlers[d.data.action]&&this.messageHandlers[d.data.action](d.data)}}));var w$=ox(x$);const C$=(r,e,t)=>{const{type:i,initSegment:s,captions:n,captionStreams:a,metadata:o,videoFrameDtsTime:l,videoFramePtsTime:u}=r.data.segment;e.buffer.push({captions:n,captionStreams:a,metadata:o});const c=r.data.segment.boxes||{data:r.data.segment.data},h={type:i,data:new Uint8Array(c.data,c.data.byteOffset,c.data.byteLength),initSegment:new Uint8Array(s.data,s.byteOffset,s.byteLength)};typeof l<"u"&&(h.videoFrameDtsTime=l),typeof u<"u"&&(h.videoFramePtsTime=u),t(h)},k$=({transmuxedData:r,callback:e})=>{r.buffer=[],e(r)},E$=(r,e)=>{e.gopInfo=r.data.gopInfo},cx=r=>{const{transmuxer:e,bytes:t,audioAppendStart:i,gopsToAlignWith:s,remux:n,onData:a,onTrackInfo:o,onAudioTimingInfo:l,onVideoTimingInfo:u,onVideoSegmentTimingInfo:c,onAudioSegmentTimingInfo:h,onId3:f,onCaptions:m,onDone:S,onEndedTimeline:y,onTransmuxerLog:E,isEndOfTimeline:C,segment:_,triggerSegmentEventFn:v}=r,T={buffer:[]};let w=C;const A=N=>{e.currentTransmux===r&&(N.data.action==="data"&&C$(N,T,a),N.data.action==="trackinfo"&&o(N.data.trackInfo),N.data.action==="gopInfo"&&E$(N,T),N.data.action==="audioTimingInfo"&&l(N.data.audioTimingInfo),N.data.action==="videoTimingInfo"&&u(N.data.videoTimingInfo),N.data.action==="videoSegmentTimingInfo"&&c(N.data.videoSegmentTimingInfo),N.data.action==="audioSegmentTimingInfo"&&h(N.data.audioSegmentTimingInfo),N.data.action==="id3Frame"&&f([N.data.id3Frame],N.data.id3Frame.dispatchType),N.data.action==="caption"&&m(N.data.caption),N.data.action==="endedtimeline"&&(w=!1,y()),N.data.action==="log"&&E(N.data.log),N.data.type==="transmuxed"&&(w||(e.onmessage=null,k$({transmuxedData:T,callback:S}),hx(e))))},I=()=>{const N={message:"Received an error message from the transmuxer worker",metadata:{errorType:H.Error.StreamingFailedToTransmuxSegment,segmentInfo:pn({segment:_})}};S(null,N)};if(e.onmessage=A,e.onerror=I,i&&e.postMessage({action:"setAudioAppendStart",appendStart:i}),Array.isArray(s)&&e.postMessage({action:"alignGopsWith",gopsToAlignWith:s}),typeof n<"u"&&e.postMessage({action:"setRemux",remux:n}),t.byteLength){const N=t instanceof ArrayBuffer?t:t.buffer,P=t instanceof ArrayBuffer?0:t.byteOffset;v({type:"segmenttransmuxingstart",segment:_}),e.postMessage({action:"push",data:N,byteOffset:P,byteLength:t.byteLength},[N])}C&&e.postMessage({action:"endTimeline"}),e.postMessage({action:"flush"})},hx=r=>{r.currentTransmux=null,r.transmuxQueue.length&&(r.currentTransmux=r.transmuxQueue.shift(),typeof r.currentTransmux=="function"?r.currentTransmux():cx(r.currentTransmux))},lb=(r,e)=>{r.postMessage({action:e}),hx(r)},dx=(r,e)=>{if(!e.currentTransmux){e.currentTransmux=r,lb(e,r);return}e.transmuxQueue.push(lb.bind(null,e,r))},A$=r=>{dx("reset",r)},P$=r=>{dx("endTimeline",r)},fx=r=>{if(!r.transmuxer.currentTransmux){r.transmuxer.currentTransmux=r,cx(r);return}r.transmuxer.transmuxQueue.push(r)},D$=r=>{const e=new w$;e.currentTransmux=null,e.transmuxQueue=[];const t=e.terminate;return e.terminate=()=>(e.currentTransmux=null,e.transmuxQueue.length=0,t.call(e)),e.postMessage({action:"init",options:r}),e};var mf={reset:A$,endTimeline:P$,transmux:fx,createTransmuxer:D$};const ma=function(r){const e=r.transmuxer,t=r.endAction||r.action,i=r.callback,s=At({},r,{endAction:null,transmuxer:null,callback:null}),n=a=>{a.data.action===t&&(e.removeEventListener("message",n),a.data.data&&(a.data.data=new Uint8Array(a.data.data,r.byteOffset||0,r.byteLength||a.data.data.byteLength),r.data&&(r.data=a.data.data)),i(a.data))};if(e.addEventListener("message",n),r.data){const a=r.data instanceof ArrayBuffer;s.byteOffset=a?0:r.data.byteOffset,s.byteLength=r.data.byteLength;const o=[a?r.data:r.data.buffer];e.postMessage(s,o)}else e.postMessage(s)},Ur={FAILURE:2,TIMEOUT:-101,ABORTED:-102},px="wvtt",Lp=r=>{r.forEach(e=>{e.abort()})},M$=r=>({bandwidth:r.bandwidth,bytesReceived:r.bytesReceived||0,roundTripTime:r.roundTripTime||0}),I$=r=>{const e=r.target,i={bandwidth:1/0,bytesReceived:0,roundTripTime:Date.now()-e.requestTime||0};return i.bytesReceived=r.loaded,i.bandwidth=Math.floor(i.bytesReceived/i.roundTripTime*8*1e3),i},jg=(r,e)=>{const{requestType:t}=e,i=Pn({requestType:t,request:e,error:r});return e.timedout?{status:e.status,message:"HLS request timed-out at URL: "+e.uri,code:Ur.TIMEOUT,xhr:e,metadata:i}:e.aborted?{status:e.status,message:"HLS request aborted at URL: "+e.uri,code:Ur.ABORTED,xhr:e,metadata:i}:r?{status:e.status,message:"HLS request errored at URL: "+e.uri,code:Ur.FAILURE,xhr:e,metadata:i}:e.responseType==="arraybuffer"&&e.response.byteLength===0?{status:e.status,message:"Empty HLS response at URL: "+e.uri,code:Ur.FAILURE,xhr:e,metadata:i}:null},ub=(r,e,t,i)=>(s,n)=>{const a=n.response,o=jg(s,n);if(o)return t(o,r);if(a.byteLength!==16)return t({status:n.status,message:"Invalid HLS key at URL: "+n.uri,code:Ur.FAILURE,xhr:n},r);const l=new DataView(a),u=new Uint32Array([l.getUint32(0),l.getUint32(4),l.getUint32(8),l.getUint32(12)]);for(let h=0;h<e.length;h++)e[h].bytes=u;const c={uri:n.uri};return i({type:"segmentkeyloadcomplete",segment:r,keyInfo:c}),t(null,r)},R$=(r,e)=>{e===px&&r.transmuxer.postMessage({action:"initMp4WebVttParser",data:r.map.bytes})},L$=(r,e,t)=>{e===px&&ma({action:"getMp4WebVttText",data:r.bytes,transmuxer:r.transmuxer,callback:({data:i,mp4VttCues:s})=>{r.bytes=i,t(null,r,{mp4VttCues:s})}})},mx=(r,e)=>{const t=pg(r.map.bytes);if(t!=="mp4"){const i=r.map.resolvedUri||r.map.uri,s=t||"unknown";return e({internal:!0,message:`Found unsupported ${s} container for initialization segment at URL: ${i}`,code:Ur.FAILURE,metadata:{mediaType:s}})}ma({action:"probeMp4Tracks",data:r.map.bytes,transmuxer:r.transmuxer,callback:({tracks:i,data:s})=>(r.map.bytes=s,i.forEach(function(n){r.map.tracks=r.map.tracks||{},!r.map.tracks[n.type]&&(r.map.tracks[n.type]=n,typeof n.id=="number"&&n.timescale&&(r.map.timescales=r.map.timescales||{},r.map.timescales[n.id]=n.timescale),n.type==="text"&&R$(r,n.codec))}),e(null))})},Q$=({segment:r,finishProcessingFn:e,triggerSegmentEventFn:t})=>(i,s)=>{const n=jg(i,s);if(n)return e(n,r);const a=new Uint8Array(s.response);if(t({type:"segmentloaded",segment:r}),r.map.key)return r.map.encryptedBytes=a,e(null,r);r.map.bytes=a,mx(r,function(o){if(o)return o.xhr=s,o.status=s.status,e(o,r);e(null,r)})},$$=({segment:r,finishProcessingFn:e,responseType:t,triggerSegmentEventFn:i})=>(s,n)=>{const a=jg(s,n);if(a)return e(a,r);i({type:"segmentloaded",segment:r});const o=t==="arraybuffer"||!n.responseText?n.response:T$(n.responseText.substring(r.lastReachedChar||0));return r.stats=M$(n),r.key?r.encryptedBytes=new Uint8Array(o):r.bytes=new Uint8Array(o),e(null,r)},B$=({segment:r,bytes:e,trackInfoFn:t,timingInfoFn:i,videoSegmentTimingInfoFn:s,audioSegmentTimingInfoFn:n,id3Fn:a,captionsFn:o,isEndOfTimeline:l,endedTimelineFn:u,dataFn:c,doneFn:h,onTransmuxerLog:f,triggerSegmentEventFn:m})=>{const S=r.map&&r.map.tracks||{},y=!!(S.audio&&S.video);let E=i.bind(null,r,"audio","start");const C=i.bind(null,r,"audio","end");let _=i.bind(null,r,"video","start");const v=i.bind(null,r,"video","end"),T=()=>fx({bytes:e,transmuxer:r.transmuxer,audioAppendStart:r.audioAppendStart,gopsToAlignWith:r.gopsToAlignWith,remux:y,onData:w=>{w.type=w.type==="combined"?"video":w.type,c(r,w)},onTrackInfo:w=>{t&&(y&&(w.isMuxed=!0),t(r,w))},onAudioTimingInfo:w=>{E&&typeof w.start<"u"&&(E(w.start),E=null),C&&typeof w.end<"u"&&C(w.end)},onVideoTimingInfo:w=>{_&&typeof w.start<"u"&&(_(w.start),_=null),v&&typeof w.end<"u"&&v(w.end)},onVideoSegmentTimingInfo:w=>{const A={pts:{start:w.start.presentation,end:w.end.presentation},dts:{start:w.start.decode,end:w.end.decode}};m({type:"segmenttransmuxingtiminginfoavailable",segment:r,timingInfo:A}),s(w)},onAudioSegmentTimingInfo:w=>{const A={pts:{start:w.start.pts,end:w.end.pts},dts:{start:w.start.dts,end:w.end.dts}};m({type:"segmenttransmuxingtiminginfoavailable",segment:r,timingInfo:A}),n(w)},onId3:(w,A)=>{a(r,w,A)},onCaptions:w=>{o(r,[w])},isEndOfTimeline:l,onEndedTimeline:()=>{u()},onTransmuxerLog:f,onDone:(w,A)=>{h&&(w.type=w.type==="combined"?"video":w.type,m({type:"segmenttransmuxingcomplete",segment:r}),h(A,r,w))},segment:r,triggerSegmentEventFn:m});ma({action:"probeTs",transmuxer:r.transmuxer,data:e,baseStartTime:r.baseStartTime,callback:w=>{r.bytes=e=w.data;const A=w.result;A&&(t(r,{hasAudio:A.hasAudio,hasVideo:A.hasVideo,isMuxed:y}),t=null),T()}})},gx=({segment:r,bytes:e,trackInfoFn:t,timingInfoFn:i,videoSegmentTimingInfoFn:s,audioSegmentTimingInfoFn:n,id3Fn:a,captionsFn:o,isEndOfTimeline:l,endedTimelineFn:u,dataFn:c,doneFn:h,onTransmuxerLog:f,triggerSegmentEventFn:m})=>{let S=new Uint8Array(e);if(nL(S)){r.isFmp4=!0;const{tracks:y}=r.map;if(y.text&&(!y.audio||!y.video)){c(r,{data:S,type:"text"}),L$(r,y.text.codec,h);return}const C={isFmp4:!0,hasVideo:!!y.video,hasAudio:!!y.audio};y.audio&&y.audio.codec&&y.audio.codec!=="enca"&&(C.audioCodec=y.audio.codec),y.video&&y.video.codec&&y.video.codec!=="encv"&&(C.videoCodec=y.video.codec),y.video&&y.audio&&(C.isMuxed=!0),t(r,C);const _=(v,T)=>{c(r,{data:S,type:C.hasAudio&&!C.isMuxed?"audio":"video"}),T&&T.length&&a(r,T),v&&v.length&&o(r,v),h(null,r,{})};ma({action:"probeMp4StartTime",timescales:r.map.timescales,data:S,transmuxer:r.transmuxer,callback:({data:v,startTime:T})=>{e=v.buffer,r.bytes=S=v,C.hasAudio&&!C.isMuxed&&i(r,"audio","start",T),C.hasVideo&&i(r,"video","start",T),ma({action:"probeEmsgID3",data:S,transmuxer:r.transmuxer,offset:T,callback:({emsgData:w,id3Frames:A})=>{if(e=w.buffer,r.bytes=S=w,!y.video||!w.byteLength||!r.transmuxer){_(void 0,A);return}ma({action:"pushMp4Captions",endAction:"mp4Captions",transmuxer:r.transmuxer,data:S,timescales:r.map.timescales,trackIds:[y.video.id],callback:I=>{e=I.data.buffer,r.bytes=S=I.data,I.logs.forEach(function(N){f(We(N,{stream:"mp4CaptionParser"}))}),_(I.captions,A)}})}})}});return}if(!r.transmuxer){h(null,r,{});return}if(typeof r.container>"u"&&(r.container=pg(S)),r.container!=="ts"&&r.container!=="aac"){t(r,{hasAudio:!1,hasVideo:!1}),h(null,r,{});return}B$({segment:r,bytes:e,trackInfoFn:t,timingInfoFn:i,videoSegmentTimingInfoFn:s,audioSegmentTimingInfoFn:n,id3Fn:a,captionsFn:o,isEndOfTimeline:l,endedTimelineFn:u,dataFn:c,doneFn:h,onTransmuxerLog:f,triggerSegmentEventFn:m})},Ox=function({id:r,key:e,encryptedBytes:t,decryptionWorker:i,segment:s,doneFn:n},a){const o=u=>{if(u.data.source===r){i.removeEventListener("message",o);const c=u.data.decrypted;a(new Uint8Array(c.bytes,c.byteOffset,c.byteLength))}};i.onerror=()=>{const u="An error occurred in the decryption worker",c=pn({segment:s}),h={message:u,metadata:{error:new Error(u),errorType:H.Error.StreamingFailedToDecryptSegment,segmentInfo:c,keyInfo:{uri:s.key.resolvedUri||s.map.key.resolvedUri}}};n(h,s)},i.addEventListener("message",o);let l;e.bytes.slice?l=e.bytes.slice():l=new Uint32Array(Array.prototype.slice.call(e.bytes)),i.postMessage(tx({source:r,encrypted:t,key:l,iv:e.iv}),[t.buffer,l.buffer])},N$=({decryptionWorker:r,segment:e,trackInfoFn:t,timingInfoFn:i,videoSegmentTimingInfoFn:s,audioSegmentTimingInfoFn:n,id3Fn:a,captionsFn:o,isEndOfTimeline:l,endedTimelineFn:u,dataFn:c,doneFn:h,onTransmuxerLog:f,triggerSegmentEventFn:m})=>{m({type:"segmentdecryptionstart"}),Ox({id:e.requestId,key:e.key,encryptedBytes:e.encryptedBytes,decryptionWorker:r,segment:e,doneFn:h},S=>{e.bytes=S,m({type:"segmentdecryptioncomplete",segment:e}),gx({segment:e,bytes:e.bytes,trackInfoFn:t,timingInfoFn:i,videoSegmentTimingInfoFn:s,audioSegmentTimingInfoFn:n,id3Fn:a,captionsFn:o,isEndOfTimeline:l,endedTimelineFn:u,dataFn:c,doneFn:h,onTransmuxerLog:f,triggerSegmentEventFn:m})})},F$=({activeXhrs:r,decryptionWorker:e,trackInfoFn:t,timingInfoFn:i,videoSegmentTimingInfoFn:s,audioSegmentTimingInfoFn:n,id3Fn:a,captionsFn:o,isEndOfTimeline:l,endedTimelineFn:u,dataFn:c,doneFn:h,onTransmuxerLog:f,triggerSegmentEventFn:m})=>{let S=0,y=!1;return(E,C)=>{if(!y){if(E)return y=!0,Lp(r),h(E,C);if(S+=1,S===r.length){const _=function(){if(C.encryptedBytes)return N$({decryptionWorker:e,segment:C,trackInfoFn:t,timingInfoFn:i,videoSegmentTimingInfoFn:s,audioSegmentTimingInfoFn:n,id3Fn:a,captionsFn:o,isEndOfTimeline:l,endedTimelineFn:u,dataFn:c,doneFn:h,onTransmuxerLog:f,triggerSegmentEventFn:m});gx({segment:C,bytes:C.bytes,trackInfoFn:t,timingInfoFn:i,videoSegmentTimingInfoFn:s,audioSegmentTimingInfoFn:n,id3Fn:a,captionsFn:o,isEndOfTimeline:l,endedTimelineFn:u,dataFn:c,doneFn:h,onTransmuxerLog:f,triggerSegmentEventFn:m})};if(C.endOfAllRequests=Date.now(),C.map&&C.map.encryptedBytes&&!C.map.bytes)return m({type:"segmentdecryptionstart",segment:C}),Ox({decryptionWorker:e,id:C.requestId+"-init",encryptedBytes:C.map.encryptedBytes,key:C.map.key,segment:C,doneFn:h},v=>{C.map.bytes=v,m({type:"segmentdecryptioncomplete",segment:C}),mx(C,T=>{if(T)return Lp(r),h(T,C);_()})});_()}}}},U$=({loadendState:r,abortFn:e})=>t=>{t.target.aborted&&e&&!r.calledAbortFn&&(e(),r.calledAbortFn=!0)},q$=({segment:r,progressFn:e,trackInfoFn:t,timingInfoFn:i,videoSegmentTimingInfoFn:s,audioSegmentTimingInfoFn:n,id3Fn:a,captionsFn:o,isEndOfTimeline:l,endedTimelineFn:u,dataFn:c})=>h=>{if(!h.target.aborted)return r.stats=We(r.stats,I$(h)),!r.stats.firstBytesReceivedAt&&r.stats.bytesReceived&&(r.stats.firstBytesReceivedAt=Date.now()),e(h,r)},V$=({xhr:r,xhrOptions:e,decryptionWorker:t,segment:i,abortFn:s,progressFn:n,trackInfoFn:a,timingInfoFn:o,videoSegmentTimingInfoFn:l,audioSegmentTimingInfoFn:u,id3Fn:c,captionsFn:h,isEndOfTimeline:f,endedTimelineFn:m,dataFn:S,doneFn:y,onTransmuxerLog:E,triggerSegmentEventFn:C})=>{const _=[],v=F$({activeXhrs:_,decryptionWorker:t,trackInfoFn:a,timingInfoFn:o,videoSegmentTimingInfoFn:l,audioSegmentTimingInfoFn:u,id3Fn:c,captionsFn:h,isEndOfTimeline:f,endedTimelineFn:m,dataFn:S,doneFn:y,onTransmuxerLog:E,triggerSegmentEventFn:C});if(i.key&&!i.key.bytes){const N=[i.key];i.map&&!i.map.bytes&&i.map.key&&i.map.key.resolvedUri===i.key.resolvedUri&&N.push(i.map.key);const P=We(e,{uri:i.key.resolvedUri,responseType:"arraybuffer",requestType:"segment-key"}),R=ub(i,N,v,C),X={uri:i.key.resolvedUri};C({type:"segmentkeyloadstart",segment:i,keyInfo:X});const j=r(P,R);_.push(j)}if(i.map&&!i.map.bytes){if(i.map.key&&(!i.key||i.key.resolvedUri!==i.map.key.resolvedUri)){const j=We(e,{uri:i.map.key.resolvedUri,responseType:"arraybuffer",requestType:"segment-key"}),Z=ub(i,[i.map.key],v,C),Y={uri:i.map.key.resolvedUri};C({type:"segmentkeyloadstart",segment:i,keyInfo:Y});const te=r(j,Z);_.push(te)}const P=We(e,{uri:i.map.resolvedUri,responseType:"arraybuffer",headers:Ip(i.map),requestType:"segment-media-initialization"}),R=Q$({segment:i,finishProcessingFn:v,triggerSegmentEventFn:C});C({type:"segmentloadstart",segment:i});const X=r(P,R);_.push(X)}const T=We(e,{uri:i.part&&i.part.resolvedUri||i.resolvedUri,responseType:"arraybuffer",headers:Ip(i),requestType:"segment"}),w=$$({segment:i,finishProcessingFn:v,responseType:T.responseType,triggerSegmentEventFn:C});C({type:"segmentloadstart",segment:i});const A=r(T,w);A.addEventListener("progress",q$({segment:i,progressFn:n,trackInfoFn:a,timingInfoFn:o,videoSegmentTimingInfoFn:l,audioSegmentTimingInfoFn:u,id3Fn:c,captionsFn:h,isEndOfTimeline:f,endedTimelineFn:m,dataFn:S})),_.push(A);const I={};return _.forEach(N=>{N.addEventListener("loadend",U$({loadendState:I,abortFn:s}))}),()=>Lp(_)},Fu=ar("PlaylistSelector"),cb=function(r){if(!r||!r.playlist)return;const e=r.playlist;return JSON.stringify({id:e.id,bandwidth:r.bandwidth,width:r.width,height:r.height,codecs:e.attributes&&e.attributes.CODECS||""})},ga=function(r,e){if(!r)return"";const t=U.getComputedStyle(r);return t?t[e]:""},Oa=function(r,e){const t=r.slice();r.sort(function(i,s){const n=e(i,s);return n===0?t.indexOf(i)-t.indexOf(s):n})},zg=function(r,e){let t,i;return r.attributes.BANDWIDTH&&(t=r.attributes.BANDWIDTH),t=t||U.Number.MAX_VALUE,e.attributes.BANDWIDTH&&(i=e.attributes.BANDWIDTH),i=i||U.Number.MAX_VALUE,t-i},X$=function(r,e){let t,i;return r.attributes.RESOLUTION&&r.attributes.RESOLUTION.width&&(t=r.attributes.RESOLUTION.width),t=t||U.Number.MAX_VALUE,e.attributes.RESOLUTION&&e.attributes.RESOLUTION.width&&(i=e.attributes.RESOLUTION.width),i=i||U.Number.MAX_VALUE,t===i&&r.attributes.BANDWIDTH&&e.attributes.BANDWIDTH?r.attributes.BANDWIDTH-e.attributes.BANDWIDTH:t-i};let yx=function(r){const{main:e,bandwidth:t,playerWidth:i,playerHeight:s,playerObjectFit:n,limitRenditionByPlayerDimensions:a,playlistController:o}=r;if(!e)return;const l={bandwidth:t,width:i,height:s,limitRenditionByPlayerDimensions:a};let u=e.playlists;Ci.isAudioOnly(e)&&(u=o.getAudioTrackPlaylists_(),l.audioOnly=!0);let c=u.map(I=>{let N;const P=I.attributes&&I.attributes.RESOLUTION&&I.attributes.RESOLUTION.width,R=I.attributes&&I.attributes.RESOLUTION&&I.attributes.RESOLUTION.height;return N=I.attributes&&I.attributes.BANDWIDTH,N=N||U.Number.MAX_VALUE,{bandwidth:N,width:P,height:R,playlist:I}});Oa(c,(I,N)=>I.bandwidth-N.bandwidth),c=c.filter(I=>!Ci.isIncompatible(I.playlist));let h=c.filter(I=>Ci.isEnabled(I.playlist));h.length||(h=c.filter(I=>!Ci.isDisabled(I.playlist)));const f=h.filter(I=>I.bandwidth*Ut.BANDWIDTH_VARIANCE<t);let m=f[f.length-1];const S=f.filter(I=>I.bandwidth===m.bandwidth)[0];if(a===!1){const I=S||h[0]||c[0];if(I&&I.playlist){let N="sortedPlaylistReps";return S&&(N="bandwidthBestRep"),h[0]&&(N="enabledPlaylistReps"),Fu(`choosing ${cb(I)} using ${N} with options`,l),I.playlist}return Fu("could not choose a playlist with options",l),null}const y=f.filter(I=>I.width&&I.height);Oa(y,(I,N)=>I.width-N.width);const E=y.filter(I=>I.width===i&&I.height===s);m=E[E.length-1];const C=E.filter(I=>I.bandwidth===m.bandwidth)[0];let _,v,T;C||(_=y.filter(I=>n==="cover"?I.width>i&&I.height>s:I.width>i||I.height>s),v=_.filter(I=>I.width===_[0].width&&I.height===_[0].height),m=v[v.length-1],T=v.filter(I=>I.bandwidth===m.bandwidth)[0]);let w;if(o.leastPixelDiffSelector){const I=y.map(N=>(N.pixelDiff=Math.abs(N.width-i)+Math.abs(N.height-s),N));Oa(I,(N,P)=>N.pixelDiff===P.pixelDiff?P.bandwidth-N.bandwidth:N.pixelDiff-P.pixelDiff),w=I[0]}const A=w||T||C||S||h[0]||c[0];if(A&&A.playlist){let I="sortedPlaylistReps";return w?I="leastPixelDiffRep":T?I="resolutionPlusOneRep":C?I="resolutionBestRep":S?I="bandwidthBestRep":h[0]&&(I="enabledPlaylistReps"),Fu(`choosing ${cb(A)} using ${I} with options`,l),A.playlist}return Fu("could not choose a playlist with options",l),null};const hb=function(){let r=this.useDevicePixelRatio&&U.devicePixelRatio||1;return isNaN(this.customPixelRatio)||(r=this.customPixelRatio),yx({main:this.playlists.main,bandwidth:this.systemBandwidth,playerWidth:parseInt(ga(this.tech_.el(),"width"),10)*r,playerHeight:parseInt(ga(this.tech_.el(),"height"),10)*r,playerObjectFit:this.usePlayerObjectFit?ga(this.tech_.el(),"objectFit"):"",limitRenditionByPlayerDimensions:this.limitRenditionByPlayerDimensions,playlistController:this.playlistController_})},j$=function(r){let e=-1,t=-1;if(r<0||r>1)throw new Error("Moving average bandwidth decay must be between 0 and 1.");return function(){let i=this.useDevicePixelRatio&&U.devicePixelRatio||1;return isNaN(this.customPixelRatio)||(i=this.customPixelRatio),e<0&&(e=this.systemBandwidth,t=this.systemBandwidth),this.systemBandwidth>0&&this.systemBandwidth!==t&&(e=r*this.systemBandwidth+(1-r)*e,t=this.systemBandwidth),yx({main:this.playlists.main,bandwidth:e,playerWidth:parseInt(ga(this.tech_.el(),"width"),10)*i,playerHeight:parseInt(ga(this.tech_.el(),"height"),10)*i,playerObjectFit:this.usePlayerObjectFit?ga(this.tech_.el(),"objectFit"):"",limitRenditionByPlayerDimensions:this.limitRenditionByPlayerDimensions,playlistController:this.playlistController_})}},z$=function(r){const{main:e,currentTime:t,bandwidth:i,duration:s,segmentDuration:n,timeUntilRebuffer:a,currentTimeline:o,syncController:l}=r,u=e.playlists.filter(S=>!Ci.isIncompatible(S));let c=u.filter(Ci.isEnabled);c.length||(c=u.filter(S=>!Ci.isDisabled(S)));const f=c.filter(Ci.hasAttribute.bind(null,"BANDWIDTH")).map(S=>{const E=l.getSyncPoint(S,s,o,t)?1:2,_=Ci.estimateSegmentRequestTime(n,i,S)*E-a;return{playlist:S,rebufferingImpact:_}}),m=f.filter(S=>S.rebufferingImpact<=0);return Oa(m,(S,y)=>zg(y.playlist,S.playlist)),m.length?m[0]:(Oa(f,(S,y)=>S.rebufferingImpact-y.rebufferingImpact),f[0]||null)},Z$=function(){const r=this.playlists.main.playlists.filter(Ci.isEnabled);return Oa(r,(t,i)=>zg(t,i)),r.filter(t=>!!Jo(this.playlists.main,t).video)[0]||null},W$=r=>{let e=0,t;return r.bytes&&(t=new Uint8Array(r.bytes),r.segments.forEach(i=>{t.set(i,e),e+=i.byteLength})),t};function bx(r){try{return new URL(r).pathname.split("/").slice(-2).join("/")}catch{return""}}const H$=function(r,e,t){if(!r[t]){e.trigger({type:"usage",name:"vhs-608"});let i=t;/^cc708_/.test(t)&&(i="SERVICE"+t.split("_")[1]);const s=e.textTracks().getTrackById(i);if(s)r[t]=s;else{const n=e.options_.vhs&&e.options_.vhs.captionServices||{};let a=t,o=t,l=!1;const u=n[i];u&&(a=u.label,o=u.language,l=u.default),r[t]=e.addRemoteTextTrack({kind:"captions",id:i,default:l,label:a,language:o},!1).track}}},Y$=function({inbandTextTracks:r,captionArray:e,timestampOffset:t}){if(!e)return;const i=U.WebKitDataCue||U.VTTCue;e.forEach(s=>{const n=s.stream;s.content?s.content.forEach(a=>{const o=new i(s.startTime+t,s.endTime+t,a.text);o.line=a.line,o.align="left",o.position=a.position,o.positionAlign="line-left",r[n].addCue(o)}):r[n].addCue(new i(s.startTime+t,s.endTime+t,s.text))})},G$=function(r){Object.defineProperties(r.frame,{id:{get(){return H.log.warn("cue.frame.id is deprecated. Use cue.value.key instead."),r.value.key}},value:{get(){return H.log.warn("cue.frame.value is deprecated. Use cue.value.data instead."),r.value.data}},privateData:{get(){return H.log.warn("cue.frame.privateData is deprecated. Use cue.value.data instead."),r.value.data}}})},K$=({inbandTextTracks:r,metadataArray:e,timestampOffset:t,videoDuration:i})=>{if(!e)return;const s=U.WebKitDataCue||U.VTTCue,n=r.metadataTrack_;if(!n||(e.forEach(c=>{const h=c.cueTime+t;typeof h!="number"||U.isNaN(h)||h<0||!(h<1/0)||!c.frames||!c.frames.length||c.frames.forEach(f=>{const m=new s(h,h,f.value||f.url||f.data||"");m.frame=f,m.value=f,G$(m),n.addCue(m)})}),!n.cues||!n.cues.length))return;const a=n.cues,o=[];for(let c=0;c<a.length;c++)a[c]&&o.push(a[c]);const l=o.reduce((c,h)=>{const f=c[h.startTime]||[];return f.push(h),c[h.startTime]=f,c},{}),u=Object.keys(l).sort((c,h)=>Number(c)-Number(h));u.forEach((c,h)=>{const f=l[c],m=isFinite(i)?i:c,S=Number(u[h+1])||m;f.forEach(y=>{y.endTime=S})})},J$={id:"ID",class:"CLASS",startDate:"START-DATE",duration:"DURATION",endDate:"END-DATE",endOnNext:"END-ON-NEXT",plannedDuration:"PLANNED-DURATION",scte35Out:"SCTE35-OUT",scte35In:"SCTE35-IN"},e5=new Set(["id","class","startDate","duration","endDate","endOnNext","startTime","endTime","processDateRange"]),t5=({inbandTextTracks:r,dateRanges:e})=>{const t=r.metadataTrack_;if(!t)return;const i=U.WebKitDataCue||U.VTTCue;e.forEach(s=>{for(const n of Object.keys(s)){if(e5.has(n))continue;const a=new i(s.startTime,s.endTime,"");a.id=s.id,a.type="com.apple.quicktime.HLS",a.value={key:J$[n],data:s[n]},(n==="scte35Out"||n==="scte35In")&&(a.value.data=new Uint8Array(a.value.data.match(/[\da-f]{2}/gi)).buffer),t.addCue(a)}s.processDateRange()})},db=(r,e,t)=>{r.metadataTrack_||(r.metadataTrack_=t.addRemoteTextTrack({kind:"metadata",label:"Timed Metadata"},!1).track,H.browser.IS_ANY_SAFARI||(r.metadataTrack_.inBandMetadataTrackDispatchType=e))},Fo=function(r,e,t){let i,s;if(t&&t.cues)for(i=t.cues.length;i--;)s=t.cues[i],s.startTime>=r&&s.endTime<=e&&t.removeCue(s)},i5=function(r){const e=r.cues;if(!e)return;const t={};for(let i=e.length-1;i>=0;i--){const s=e[i],n=`${s.startTime}-${s.endTime}-${s.text}`;t[n]?r.removeCue(s):t[n]=s}},r5=(r,e,t)=>{if(typeof e>"u"||e===null||!r.length)return[];const i=Math.ceil((e-t+3)*yn.ONE_SECOND_IN_TS);let s;for(s=0;s<r.length&&!(r[s].pts>i);s++);return r.slice(s)},s5=(r,e,t)=>{if(!e.length)return r;if(t)return e.slice();const i=e[0].pts;let s=0;for(s;s<r.length&&!(r[s].pts>=i);s++);return r.slice(0,s).concat(e)},n5=(r,e,t,i)=>{const s=Math.ceil((e-i)*yn.ONE_SECOND_IN_TS),n=Math.ceil((t-i)*yn.ONE_SECOND_IN_TS),a=r.slice();let o=r.length;for(;o--&&!(r[o].pts<=n););if(o===-1)return a;let l=o+1;for(;l--&&!(r[l].pts<=s););return l=Math.max(l,0),a.splice(l,o-l+1),a},a5=function(r,e){if(!r&&!e||!r&&e||r&&!e)return!1;if(r===e)return!0;const t=Object.keys(r).sort(),i=Object.keys(e).sort();if(t.length!==i.length)return!1;for(let s=0;s<t.length;s++){const n=t[s];if(n!==i[s]||r[n]!==e[n])return!1}return!0},o5=function(r,e,t){e=e||[];const i=[];let s=0;for(let n=0;n<e.length;n++){const a=e[n];if(r===a.timeline&&(i.push(n),s+=a.duration,s>t))return n}return i.length===0?0:i[i.length-1]},Eo=1,l5=500,fb=r=>typeof r=="number"&&isFinite(r),Uu=1/60,u5=(r,e,t)=>r!=="main"||!e||!t?null:!t.hasAudio&&!t.hasVideo?"Neither audio nor video found in segment.":e.hasVideo&&!t.hasVideo?"Only audio found in segment when we expected video. We can't switch to audio only from a stream that had video. To get rid of this message, please add codec information to the manifest.":!e.hasVideo&&t.hasVideo?"Video found in segment when we expected only audio. We can't switch to a stream with video from an audio only stream. To get rid of this message, please add codec information to the manifest.":null,c5=(r,e,t)=>{let i=e-Ut.BACK_BUFFER_LENGTH;r.length&&(i=Math.max(i,r.start(0)));const s=e-t;return Math.min(s,i)},Yn=r=>{const{startOfSegment:e,duration:t,segment:i,part:s,playlist:{mediaSequence:n,id:a,segments:o=[]},mediaIndex:l,partIndex:u,timeline:c}=r,h=o.length-1;let f="mediaIndex/partIndex increment";r.getMediaInfoForTime?f=`getMediaInfoForTime (${r.getMediaInfoForTime})`:r.isSyncRequest&&(f="getSyncSegmentCandidate (isSyncRequest)"),r.independent&&(f+=` with independent ${r.independent}`);const m=typeof u=="number",S=r.segment.uri?"segment":"pre-segment",y=m?$_({preloadSegment:i})-1:0;return`${S} [${n+l}/${n+h}]`+(m?` part [${u}/${y}]`:"")+` segment start/end [${i.start} => ${i.end}]`+(m?` part start/end [${s.start} => ${s.end}]`:"")+` startOfSegment [${e}] duration [${t}] timeline [${c}] selected by [${f}] playlist [${a}]`},pb=r=>`${r}TimingInfo`,h5=({segmentTimeline:r,currentTimeline:e,startOfSegment:t,buffered:i,overrideCheck:s})=>!s&&r===e?null:r<e?t:i.length?i.end(i.length-1):t,Qp=({timelineChangeController:r,currentTimeline:e,segmentTimeline:t,loaderType:i,audioDisabled:s})=>{if(e===t)return!1;if(i==="audio"){const n=r.lastTimelineChange({type:"main"});return!n||n.to!==t}if(i==="main"&&s){const n=r.pendingTimelineChange({type:"audio"});return!(n&&n.to===t)}return!1},d5=r=>{if(!r)return!1;const e=r.pendingTimelineChange({type:"audio"}),t=r.pendingTimelineChange({type:"main"}),i=e&&t,s=i&&e.to!==t.to;return!!(i&&e.from!==-1&&t.from!==-1&&s)},f5=r=>{const e=r.timelineChangeController_.pendingTimelineChange({type:"audio"}),t=r.timelineChangeController_.pendingTimelineChange({type:"main"});return e&&t&&e.to<t.to},Ms=r=>{const e=r.pendingSegment_;if(!e)return;if(Qp({timelineChangeController:r.timelineChangeController_,currentTimeline:r.currentTimeline_,segmentTimeline:e.timeline,loaderType:r.loaderType_,audioDisabled:r.audioDisabled_})&&d5(r.timelineChangeController_)){if(f5(r)){r.timelineChangeController_.trigger("audioTimelineBehind");return}r.timelineChangeController_.trigger("fixBadTimelineChange")}},p5=r=>{let e=0;return["video","audio"].forEach(function(t){const i=r[`${t}TimingInfo`];if(!i)return;const{start:s,end:n}=i;let a;typeof s=="bigint"||typeof n=="bigint"?a=U.BigInt(n)-U.BigInt(s):typeof s=="number"&&typeof n=="number"&&(a=n-s),typeof a<"u"&&a>e&&(e=a)}),typeof e=="bigint"&&e<Number.MAX_SAFE_INTEGER&&(e=Number(e)),e},mb=({segmentDuration:r,maxDuration:e})=>r?Math.round(r)>e+Nr:!1,m5=(r,e)=>{if(e!=="hls")return null;const t=p5({audioTimingInfo:r.audioTimingInfo,videoTimingInfo:r.videoTimingInfo});if(!t)return null;const i=r.playlist.targetDuration,s=mb({segmentDuration:t,maxDuration:i*2}),n=mb({segmentDuration:t,maxDuration:i}),a=`Segment with index ${r.mediaIndex} from playlist ${r.playlist.id} has a duration of ${t} when the reported duration is ${r.duration} and the target duration is ${i}. For HLS content, a duration in excess of the target duration may result in playback issues. See the HLS specification section on EXT-X-TARGETDURATION for more details: https://tools.ietf.org/html/draft-pantos-http-live-streaming-23#section-4.3.3.1`;return s||n?{severity:s?"warn":"info",message:a}:null},pn=({type:r,segment:e})=>{if(!e)return;const t=!!(e.key||e.map&&e.map.ke),i=!!(e.map&&!e.map.bytes),s=e.startOfSegment===void 0?e.start:e.startOfSegment;return{type:r||e.type,uri:e.resolvedUri||e.uri,start:s,duration:e.duration,isEncrypted:t,isMediaInitialization:i}};class $p extends H.EventTarget{constructor(e,t={}){if(super(),!e)throw new TypeError("Initialization settings are required");if(typeof e.currentTime!="function")throw new TypeError("No currentTime getter specified");if(!e.mediaSource)throw new TypeError("No MediaSource specified");this.bandwidth=e.bandwidth,this.throughput={rate:0,count:0},this.roundTrip=NaN,this.resetStats_(),this.mediaIndex=null,this.partIndex=null,this.hasPlayed_=e.hasPlayed,this.currentTime_=e.currentTime,this.seekable_=e.seekable,this.seeking_=e.seeking,this.duration_=e.duration,this.mediaSource_=e.mediaSource,this.vhs_=e.vhs,this.loaderType_=e.loaderType,this.currentMediaInfo_=void 0,this.startingMediaInfo_=void 0,this.segmentMetadataTrack_=e.segmentMetadataTrack,this.goalBufferLength_=e.goalBufferLength,this.sourceType_=e.sourceType,this.sourceUpdater_=e.sourceUpdater,this.inbandTextTracks_=e.inbandTextTracks,this.state_="INIT",this.timelineChangeController_=e.timelineChangeController,this.shouldSaveSegmentTimingInfo_=!0,this.parse708captions_=e.parse708captions,this.useDtsForTimestampOffset_=e.useDtsForTimestampOffset,this.captionServices_=e.captionServices,this.exactManifestTimings=e.exactManifestTimings,this.addMetadataToTextTrack=e.addMetadataToTextTrack,this.checkBufferTimeout_=null,this.error_=void 0,this.currentTimeline_=-1,this.shouldForceTimestampOffsetAfterResync_=!1,this.pendingSegment_=null,this.xhrOptions_=null,this.pendingSegments_=[],this.audioDisabled_=!1,this.isPendingTimestampOffset_=!1,this.gopBuffer_=[],this.timeMapping_=0,this.safeAppend_=!1,this.appendInitSegment_={audio:!0,video:!0},this.playlistOfLastInitSegment_={audio:null,video:null},this.callQueue_=[],this.loadQueue_=[],this.metadataQueue_={id3:[],caption:[]},this.waitingOnRemove_=!1,this.quotaExceededErrorRetryTimeout_=null,this.activeInitSegmentId_=null,this.initSegments_={},this.cacheEncryptionKeys_=e.cacheEncryptionKeys,this.keyCache_={},this.decrypter_=e.decrypter,this.syncController_=e.syncController,this.syncPoint_={segmentIndex:0,time:0},this.transmuxer_=this.createTransmuxer_(),this.triggerSyncInfoUpdate_=()=>this.trigger("syncinfoupdate"),this.syncController_.on("syncinfoupdate",this.triggerSyncInfoUpdate_),this.mediaSource_.addEventListener("sourceopen",()=>{this.isEndOfStream_()||(this.ended_=!1)}),this.fetchAtBuffer_=!1,this.logger_=ar(`SegmentLoader[${this.loaderType_}]`),Object.defineProperty(this,"state",{get(){return this.state_},set(i){i!==this.state_&&(this.logger_(`${this.state_} -> ${i}`),this.state_=i,this.trigger("statechange"))}}),this.sourceUpdater_.on("ready",()=>{this.hasEnoughInfoToAppend_()?this.processCallQueue_():Ms(this)}),this.sourceUpdater_.on("codecschange",i=>{this.trigger(At({type:"codecschange"},i))}),this.loaderType_==="main"&&this.timelineChangeController_.on("pendingtimelinechange",()=>{this.hasEnoughInfoToAppend_()?this.processCallQueue_():Ms(this)}),this.loaderType_==="audio"&&this.timelineChangeController_.on("timelinechange",i=>{this.trigger(At({type:"timelinechange"},i)),this.hasEnoughInfoToLoad_()?this.processLoadQueue_():Ms(this),this.hasEnoughInfoToAppend_()?this.processCallQueue_():Ms(this)})}get mediaSequenceSync_(){return this.syncController_.getMediaSequenceSync(this.loaderType_)}createTransmuxer_(){return mf.createTransmuxer({remux:!1,alignGopsAtEnd:this.safeAppend_,keepOriginalTimestamps:!0,parse708captions:this.parse708captions_,captionServices:this.captionServices_})}resetStats_(){this.mediaBytesTransferred=0,this.mediaRequests=0,this.mediaRequestsAborted=0,this.mediaRequestsTimedout=0,this.mediaRequestsErrored=0,this.mediaTransferDuration=0,this.mediaSecondsLoaded=0,this.mediaAppends=0}dispose(){this.trigger("dispose"),this.state="DISPOSED",this.pause(),this.abort_(),this.transmuxer_&&this.transmuxer_.terminate(),this.resetStats_(),this.checkBufferTimeout_&&U.clearTimeout(this.checkBufferTimeout_),this.syncController_&&this.triggerSyncInfoUpdate_&&this.syncController_.off("syncinfoupdate",this.triggerSyncInfoUpdate_),this.off()}setAudio(e){this.audioDisabled_=!e,e?this.appendInitSegment_.audio=!0:this.sourceUpdater_.removeAudio(0,this.duration_())}abort(){if(this.state!=="WAITING"){this.pendingSegment_&&(this.pendingSegment_=null),this.timelineChangeController_.clearPendingTimelineChange(this.loaderType_);return}this.abort_(),this.state="READY",this.paused()||this.monitorBuffer_()}abort_(){this.pendingSegment_&&this.pendingSegment_.abortRequests&&this.pendingSegment_.abortRequests(),this.pendingSegment_=null,this.callQueue_=[],this.loadQueue_=[],this.metadataQueue_.id3=[],this.metadataQueue_.caption=[],this.timelineChangeController_.clearPendingTimelineChange(this.loaderType_),this.waitingOnRemove_=!1,U.clearTimeout(this.quotaExceededErrorRetryTimeout_),this.quotaExceededErrorRetryTimeout_=null}checkForAbort_(e){return this.state==="APPENDING"&&!this.pendingSegment_?(this.state="READY",!0):!this.pendingSegment_||this.pendingSegment_.requestId!==e}error(e){return typeof e<"u"&&(this.logger_("error occurred:",e),this.error_=e),this.pendingSegment_=null,this.error_}endOfStream(){this.ended_=!0,this.transmuxer_&&mf.reset(this.transmuxer_),this.gopBuffer_.length=0,this.pause(),this.trigger("ended")}buffered_(){const e=this.getMediaInfo_();if(!this.sourceUpdater_||!e)return Xt();if(this.loaderType_==="main"){const{hasAudio:t,hasVideo:i,isMuxed:s}=e;if(i&&t&&!this.audioDisabled_&&!s)return this.sourceUpdater_.buffered();if(i)return this.sourceUpdater_.videoBuffered()}return this.sourceUpdater_.audioBuffered()}initSegmentForMap(e,t=!1){if(!e)return null;const i=eh(e);let s=this.initSegments_[i];return t&&!s&&e.bytes&&(this.initSegments_[i]=s={resolvedUri:e.resolvedUri,byterange:e.byterange,bytes:e.bytes,tracks:e.tracks,timescales:e.timescales}),s||e}segmentKey(e,t=!1){if(!e)return null;const i=ix(e);let s=this.keyCache_[i];this.cacheEncryptionKeys_&&t&&!s&&e.bytes&&(this.keyCache_[i]=s={resolvedUri:e.resolvedUri,bytes:e.bytes});const n={resolvedUri:(s||e).resolvedUri};return s&&(n.bytes=s.bytes),n}couldBeginLoading_(){return this.playlist_&&!this.paused()}load(){if(this.monitorBuffer_(),!!this.playlist_){if(this.state==="INIT"&&this.couldBeginLoading_())return this.init_();!this.couldBeginLoading_()||this.state!=="READY"&&this.state!=="INIT"||(this.state="READY")}}init_(){return this.state="READY",this.resetEverything(),this.monitorBuffer_()}playlist(e,t={}){if(!e||this.playlist_&&this.playlist_.endList&&e.endList&&this.playlist_.uri===e.uri)return;const i=this.playlist_,s=this.pendingSegment_;this.playlist_=e,this.xhrOptions_=t,this.state==="INIT"&&(e.syncInfo={mediaSequence:e.mediaSequence,time:0},this.loaderType_==="main"&&this.syncController_.setDateTimeMappingForStart(e));let n=null;if(i&&(i.id?n=i.id:i.uri&&(n=i.uri)),this.logger_(`playlist update [${n} => ${e.id||e.uri}]`),this.mediaSequenceSync_&&(this.mediaSequenceSync_.update(e,this.currentTime_()),this.logger_(`Playlist update:
currentTime: ${this.currentTime_()}
bufferedEnd: ${ff(this.buffered_())}
`,this.mediaSequenceSync_.diagnostics)),this.trigger("syncinfoupdate"),this.state==="INIT"&&this.couldBeginLoading_())return this.init_();if(!i||i.uri!==e.uri){this.mediaIndex!==null&&(!e.endList&&typeof e.partTargetDuration=="number"?this.resetLoader():this.resyncLoader()),this.currentMediaInfo_=void 0,this.trigger("playlistupdate");return}const a=e.mediaSequence-i.mediaSequence;if(this.logger_(`live window shift [${a}]`),this.mediaIndex!==null)if(this.mediaIndex-=a,this.mediaIndex<0)this.mediaIndex=null,this.partIndex=null;else{const o=this.playlist_.segments[this.mediaIndex];if(this.partIndex&&(!o.parts||!o.parts.length||!o.parts[this.partIndex])){const l=this.mediaIndex;this.logger_(`currently processing part (index ${this.partIndex}) no longer exists.`),this.resetLoader(),this.mediaIndex=l}}s&&(s.mediaIndex-=a,s.mediaIndex<0?(s.mediaIndex=null,s.partIndex=null):(s.mediaIndex>=0&&(s.segment=e.segments[s.mediaIndex]),s.partIndex>=0&&s.segment.parts&&(s.part=s.segment.parts[s.partIndex]))),this.syncController_.saveExpiredSegmentInfo(i,e)}pause(){this.checkBufferTimeout_&&(U.clearTimeout(this.checkBufferTimeout_),this.checkBufferTimeout_=null)}paused(){return this.checkBufferTimeout_===null}resetEverything(e){this.ended_=!1,this.activeInitSegmentId_=null,this.appendInitSegment_={audio:!0,video:!0},this.resetLoader(),this.remove(0,1/0,e),this.transmuxer_&&(this.transmuxer_.postMessage({action:"clearAllMp4Captions"}),this.transmuxer_.postMessage({action:"reset"}))}resetLoader(){this.fetchAtBuffer_=!1,this.mediaSequenceSync_&&this.mediaSequenceSync_.resetAppendedStatus(),this.resyncLoader()}resyncLoader(){this.transmuxer_&&mf.reset(this.transmuxer_),this.mediaIndex=null,this.partIndex=null,this.syncPoint_=null,this.isPendingTimestampOffset_=!1;const e=this.currentMediaInfo_&&this.currentMediaInfo_.isFmp4;this.sourceType_==="hls"&&!e&&(this.shouldForceTimestampOffsetAfterResync_=!0),this.callQueue_=[],this.loadQueue_=[],this.metadataQueue_.id3=[],this.metadataQueue_.caption=[],this.abort(),this.transmuxer_&&this.transmuxer_.postMessage({action:"clearParsedMp4Captions"})}remove(e,t,i=()=>{},s=!1){if(t===1/0&&(t=this.duration_()),t<=e){this.logger_("skipping remove because end ${end} is <= start ${start}");return}if(!this.sourceUpdater_||!this.getMediaInfo_()){this.logger_("skipping remove because no source updater or starting media info");return}let n=1;const a=()=>{n--,n===0&&i()};(s||!this.audioDisabled_)&&(n++,this.sourceUpdater_.removeAudio(e,t,a)),(s||this.loaderType_==="main")&&(this.gopBuffer_=n5(this.gopBuffer_,e,t,this.timeMapping_),n++,this.sourceUpdater_.removeVideo(e,t,a));for(const o in this.inbandTextTracks_)Fo(e,t,this.inbandTextTracks_[o]);Fo(e,t,this.segmentMetadataTrack_),a()}monitorBuffer_(){this.checkBufferTimeout_&&U.clearTimeout(this.checkBufferTimeout_),this.checkBufferTimeout_=U.setTimeout(this.monitorBufferTick_.bind(this),1)}monitorBufferTick_(){this.state==="READY"&&this.fillBuffer_(),this.checkBufferTimeout_&&U.clearTimeout(this.checkBufferTimeout_),this.checkBufferTimeout_=U.setTimeout(this.monitorBufferTick_.bind(this),l5)}fillBuffer_(){if(this.sourceUpdater_.updating())return;const e=this.chooseNextRequest_();if(!e)return;const t={segmentInfo:pn({type:this.loaderType_,segment:e})};this.trigger({type:"segmentselected",metadata:t}),typeof e.timestampOffset=="number"&&(this.isPendingTimestampOffset_=!1,this.timelineChangeController_.pendingTimelineChange({type:this.loaderType_,from:this.currentTimeline_,to:e.timeline})),this.loadSegment_(e)}isEndOfStream_(e=this.mediaIndex,t=this.playlist_,i=this.partIndex){if(!t||!this.mediaSource_)return!1;const s=typeof e=="number"&&t.segments[e],n=e+1===t.segments.length,a=!s||!s.parts||i+1===s.parts.length;return t.endList&&this.mediaSource_.readyState==="open"&&n&&a}chooseNextRequest_(){const e=this.buffered_(),t=ff(e)||0,i=Ug(e,this.currentTime_()),s=!this.hasPlayed_()&&i>=1,n=i>=this.goalBufferLength_(),a=this.playlist_.segments;if(!a.length||s||n)return null;this.syncPoint_=this.syncPoint_||this.syncController_.getSyncPoint(this.playlist_,this.duration_(),this.currentTimeline_,this.currentTime_(),this.loaderType_);const o={partIndex:null,mediaIndex:null,startOfSegment:null,playlist:this.playlist_,isSyncRequest:!this.syncPoint_};if(o.isSyncRequest)o.mediaIndex=o5(this.currentTimeline_,a,t),this.logger_(`choose next request. Can not find sync point. Fallback to media Index: ${o.mediaIndex}`);else if(this.mediaIndex!==null){const f=a[this.mediaIndex],m=typeof this.partIndex=="number"?this.partIndex:-1;o.startOfSegment=f.end?f.end:t,f.parts&&f.parts[m+1]?(o.mediaIndex=this.mediaIndex,o.partIndex=m+1):o.mediaIndex=this.mediaIndex+1}else{let f,m,S;const y=this.fetchAtBuffer_?t:this.currentTime_();if(this.mediaSequenceSync_&&this.logger_(`chooseNextRequest_ request after Quality Switch:
For TargetTime: ${y}.
CurrentTime: ${this.currentTime_()}
BufferedEnd: ${t}
Fetch At Buffer: ${this.fetchAtBuffer_}
`,this.mediaSequenceSync_.diagnostics),this.mediaSequenceSync_&&this.mediaSequenceSync_.isReliable){const E=this.getSyncInfoFromMediaSequenceSync_(y);if(!E){const C="No sync info found while using media sequence sync";return this.error({message:C,metadata:{errorType:H.Error.StreamingFailedToSelectNextSegment,error:new Error(C)}}),this.logger_("chooseNextRequest_ - no sync info found using media sequence sync"),null}this.logger_(`chooseNextRequest_ mediaSequence syncInfo (${E.start} --> ${E.end})`),f=E.segmentIndex,m=E.partIndex,S=E.start}else{this.logger_("chooseNextRequest_ - fallback to a regular segment selection algorithm, based on a syncPoint.");const E=Ci.getMediaInfoForTime({exactManifestTimings:this.exactManifestTimings,playlist:this.playlist_,currentTime:y,startingPartIndex:this.syncPoint_.partIndex,startingSegmentIndex:this.syncPoint_.segmentIndex,startTime:this.syncPoint_.time});f=E.segmentIndex,m=E.partIndex,S=E.startTime}o.getMediaInfoForTime=this.fetchAtBuffer_?`bufferedEnd ${y}`:`currentTime ${y}`,o.mediaIndex=f,o.startOfSegment=S,o.partIndex=m,this.logger_(`choose next request. Playlist switched and we have a sync point. Media Index: ${o.mediaIndex} `)}const l=a[o.mediaIndex];let u=l&&typeof o.partIndex=="number"&&l.parts&&l.parts[o.partIndex];if(!l||typeof o.partIndex=="number"&&!u)return null;typeof o.partIndex!="number"&&l.parts&&(o.partIndex=0,u=l.parts[0]);const c=this.vhs_.playlists&&this.vhs_.playlists.main&&this.vhs_.playlists.main.independentSegments||this.playlist_.independentSegments;if(!i&&u&&!c&&!u.independent)if(o.partIndex===0){const f=a[o.mediaIndex-1],m=f.parts&&f.parts.length&&f.parts[f.parts.length-1];m&&m.independent&&(o.mediaIndex-=1,o.partIndex=f.parts.length-1,o.independent="previous segment")}else l.parts[o.partIndex-1].independent&&(o.partIndex-=1,o.independent="previous part");const h=this.mediaSource_&&this.mediaSource_.readyState==="ended";return o.mediaIndex>=a.length-1&&h&&!this.seeking_()?null:(this.shouldForceTimestampOffsetAfterResync_&&(this.shouldForceTimestampOffsetAfterResync_=!1,o.forceTimestampOffset=!0,this.logger_("choose next request. Force timestamp offset after loader resync")),this.generateSegmentInfo_(o))}getSyncInfoFromMediaSequenceSync_(e){if(!this.mediaSequenceSync_)return null;const t=Math.max(e,this.mediaSequenceSync_.start);e!==t&&this.logger_(`getSyncInfoFromMediaSequenceSync_. Pulled target time from ${e} to ${t}`);const i=this.mediaSequenceSync_.getSyncInfoForTime(t);if(!i)return null;if(!i.isAppended)return i;const s=this.mediaSequenceSync_.getSyncInfoForTime(i.end);return s?(s.isAppended&&this.logger_("getSyncInfoFromMediaSequenceSync_: We encounter unexpected scenario where next media sequence sync info is also appended!"),s):null}generateSegmentInfo_(e){const{independent:t,playlist:i,mediaIndex:s,startOfSegment:n,isSyncRequest:a,partIndex:o,forceTimestampOffset:l,getMediaInfoForTime:u}=e,c=i.segments[s],h=typeof o=="number"&&c.parts[o],f={requestId:"segment-loader-"+Math.random(),uri:h&&h.resolvedUri||c.resolvedUri,mediaIndex:s,partIndex:h?o:null,isSyncRequest:a,startOfSegment:n,playlist:i,bytes:null,encryptedBytes:null,timestampOffset:null,timeline:c.timeline,duration:h&&h.duration||c.duration,segment:c,part:h,byteLength:0,transmuxer:this.transmuxer_,getMediaInfoForTime:u,independent:t},m=typeof l<"u"?l:this.isPendingTimestampOffset_;f.timestampOffset=this.timestampOffsetForSegment_({segmentTimeline:c.timeline,currentTimeline:this.currentTimeline_,startOfSegment:n,buffered:this.buffered_(),overrideCheck:m});const S=ff(this.sourceUpdater_.audioBuffered());return typeof S=="number"&&(f.audioAppendStart=S-this.sourceUpdater_.audioTimestampOffset()),this.sourceUpdater_.videoBuffered().length&&(f.gopsToAlignWith=r5(this.gopBuffer_,this.currentTime_()-this.sourceUpdater_.videoTimestampOffset(),this.timeMapping_)),f}timestampOffsetForSegment_(e){return h5(e)}earlyAbortWhenNeeded_(e){if(this.vhs_.tech_.paused()||!this.xhrOptions_.timeout||!this.playlist_.attributes.BANDWIDTH||Date.now()-(e.firstBytesReceivedAt||Date.now())<1e3)return;const t=this.currentTime_(),i=e.bandwidth,s=this.pendingSegment_.duration,n=Ci.estimateSegmentRequestTime(s,i,this.playlist_,e.bytesReceived),a=IQ(this.buffered_(),t,this.vhs_.tech_.playbackRate())-1;if(n<=a)return;const o=z$({main:this.vhs_.playlists.main,currentTime:t,bandwidth:i,duration:this.duration_(),segmentDuration:s,timeUntilRebuffer:a,currentTimeline:this.currentTimeline_,syncController:this.syncController_});if(!o)return;const u=n-a-o.rebufferingImpact;let c=.5;a<=Nr&&(c=1),!(!o.playlist||o.playlist.uri===this.playlist_.uri||u<c)&&(this.bandwidth=o.playlist.attributes.BANDWIDTH*Ut.BANDWIDTH_VARIANCE+1,this.trigger("earlyabort"))}handleAbort_(e){this.logger_(`Aborting ${Yn(e)}`),this.mediaRequestsAborted+=1}handleProgress_(e,t){this.earlyAbortWhenNeeded_(t.stats),!this.checkForAbort_(t.requestId)&&this.trigger("progress")}handleTrackInfo_(e,t){const{hasAudio:i,hasVideo:s}=t,n={segmentInfo:pn({type:this.loaderType_,segment:e}),trackInfo:{hasAudio:i,hasVideo:s}};this.trigger({type:"segmenttransmuxingtrackinfoavailable",metadata:n}),this.earlyAbortWhenNeeded_(e.stats),!this.checkForAbort_(e.requestId)&&(this.checkForIllegalMediaSwitch(t)||(t=t||{},a5(this.currentMediaInfo_,t)||(this.appendInitSegment_={audio:!0,video:!0},this.startingMediaInfo_=t,this.currentMediaInfo_=t,this.logger_("trackinfo update",t),this.trigger("trackinfo")),!this.checkForAbort_(e.requestId)&&(this.pendingSegment_.trackInfo=t,this.hasEnoughInfoToAppend_()?this.processCallQueue_():Ms(this))))}handleTimingInfo_(e,t,i,s){if(this.earlyAbortWhenNeeded_(e.stats),this.checkForAbort_(e.requestId))return;const n=this.pendingSegment_,a=pb(t);n[a]=n[a]||{},n[a][i]=s,this.logger_(`timinginfo: ${t} - ${i} - ${s}`),this.hasEnoughInfoToAppend_()?this.processCallQueue_():Ms(this)}handleCaptions_(e,t){if(this.earlyAbortWhenNeeded_(e.stats),this.checkForAbort_(e.requestId))return;if(t.length===0){this.logger_("SegmentLoader received no captions from a caption event");return}if(!this.pendingSegment_.hasAppendedData_){this.metadataQueue_.caption.push(this.handleCaptions_.bind(this,e,t));return}const s=this.sourceUpdater_.videoTimestampOffset()===null?this.sourceUpdater_.audioTimestampOffset():this.sourceUpdater_.videoTimestampOffset(),n={};t.forEach(a=>{n[a.stream]=n[a.stream]||{startTime:1/0,captions:[],endTime:0};const o=n[a.stream];o.startTime=Math.min(o.startTime,a.startTime+s),o.endTime=Math.max(o.endTime,a.endTime+s),o.captions.push(a)}),Object.keys(n).forEach(a=>{const{startTime:o,endTime:l,captions:u}=n[a],c=this.inbandTextTracks_;this.logger_(`adding cues from ${o} -> ${l} for ${a}`),H$(c,this.vhs_.tech_,a),Fo(o,l,c[a]),Y$({captionArray:u,inbandTextTracks:c,timestampOffset:s})}),this.transmuxer_&&this.transmuxer_.postMessage({action:"clearParsedMp4Captions"})}handleId3_(e,t,i){if(this.earlyAbortWhenNeeded_(e.stats),this.checkForAbort_(e.requestId))return;if(!this.pendingSegment_.hasAppendedData_){this.metadataQueue_.id3.push(this.handleId3_.bind(this,e,t,i));return}this.addMetadataToTextTrack(i,t,this.duration_())}processMetadataQueue_(){this.metadataQueue_.id3.forEach(e=>e()),this.metadataQueue_.caption.forEach(e=>e()),this.metadataQueue_.id3=[],this.metadataQueue_.caption=[]}processCallQueue_(){const e=this.callQueue_;this.callQueue_=[],e.forEach(t=>t())}processLoadQueue_(){const e=this.loadQueue_;this.loadQueue_=[],e.forEach(t=>t())}hasEnoughInfoToLoad_(){if(this.loaderType_!=="audio")return!0;const e=this.pendingSegment_;return e?this.getCurrentMediaInfo_()?!Qp({timelineChangeController:this.timelineChangeController_,currentTimeline:this.currentTimeline_,segmentTimeline:e.timeline,loaderType:this.loaderType_,audioDisabled:this.audioDisabled_}):!0:!1}getCurrentMediaInfo_(e=this.pendingSegment_){return e&&e.trackInfo||this.currentMediaInfo_}getMediaInfo_(e=this.pendingSegment_){return this.getCurrentMediaInfo_(e)||this.startingMediaInfo_}getPendingSegmentPlaylist(){return this.pendingSegment_?this.pendingSegment_.playlist:null}hasEnoughInfoToAppend_(){if(!this.sourceUpdater_.ready()||this.waitingOnRemove_||this.quotaExceededErrorRetryTimeout_)return!1;const e=this.pendingSegment_,t=this.getCurrentMediaInfo_();if(!e||!t)return!1;const{hasAudio:i,hasVideo:s,isMuxed:n}=t;return!(s&&!e.videoTimingInfo||i&&!this.audioDisabled_&&!n&&!e.audioTimingInfo||Qp({timelineChangeController:this.timelineChangeController_,currentTimeline:this.currentTimeline_,segmentTimeline:e.timeline,loaderType:this.loaderType_,audioDisabled:this.audioDisabled_}))}handleData_(e,t){if(this.earlyAbortWhenNeeded_(e.stats),this.checkForAbort_(e.requestId))return;if(this.callQueue_.length||!this.hasEnoughInfoToAppend_()){Ms(this),this.callQueue_.push(this.handleData_.bind(this,e,t));return}const i=this.pendingSegment_;if(this.setTimeMapping_(i.timeline),this.updateMediaSecondsLoaded_(i.part||i.segment),this.mediaSource_.readyState!=="closed"){if(e.map&&(e.map=this.initSegmentForMap(e.map,!0),i.segment.map=e.map),e.key&&this.segmentKey(e.key,!0),i.isFmp4=e.isFmp4,i.timingInfo=i.timingInfo||{},i.isFmp4)this.trigger("fmp4"),i.timingInfo.start=i[pb(t.type)].start;else{const s=this.getCurrentMediaInfo_(),n=this.loaderType_==="main"&&s&&s.hasVideo;let a;n&&(a=i.videoTimingInfo.start),i.timingInfo.start=this.trueSegmentStart_({currentStart:i.timingInfo.start,playlist:i.playlist,mediaIndex:i.mediaIndex,currentVideoTimestampOffset:this.sourceUpdater_.videoTimestampOffset(),useVideoTimingInfo:n,firstVideoFrameTimeForData:a,videoTimingInfo:i.videoTimingInfo,audioTimingInfo:i.audioTimingInfo})}if(this.updateAppendInitSegmentStatus(i,t.type),this.updateSourceBufferTimestampOffset_(i),i.isSyncRequest){this.updateTimingInfoEnd_(i),this.syncController_.saveSegmentTimingInfo({segmentInfo:i,shouldSaveTimelineMapping:this.loaderType_==="main"});const s=this.chooseNextRequest_();if(s.mediaIndex!==i.mediaIndex||s.partIndex!==i.partIndex){this.logger_("sync segment was incorrect, not appending");return}this.logger_("sync segment was correct, appending")}i.hasAppendedData_=!0,this.processMetadataQueue_(),this.appendData_(i,t)}}updateAppendInitSegmentStatus(e,t){this.loaderType_==="main"&&typeof e.timestampOffset=="number"&&!e.changedTimestampOffset&&(this.appendInitSegment_={audio:!0,video:!0}),this.playlistOfLastInitSegment_[t]!==e.playlist&&(this.appendInitSegment_[t]=!0)}getInitSegmentAndUpdateState_({type:e,initSegment:t,map:i,playlist:s}){if(i){const n=eh(i);if(this.activeInitSegmentId_===n)return null;t=this.initSegmentForMap(i,!0).bytes,this.activeInitSegmentId_=n}return t&&this.appendInitSegment_[e]?(this.playlistOfLastInitSegment_[e]=s,this.appendInitSegment_[e]=!1,this.activeInitSegmentId_=null,t):null}handleQuotaExceededError_({segmentInfo:e,type:t,bytes:i},s){const n=this.sourceUpdater_.audioBuffered(),a=this.sourceUpdater_.videoBuffered();n.length>1&&this.logger_("On QUOTA_EXCEEDED_ERR, found gaps in the audio buffer: "+bn(n).join(", ")),a.length>1&&this.logger_("On QUOTA_EXCEEDED_ERR, found gaps in the video buffer: "+bn(a).join(", "));const o=n.length?n.start(0):0,l=n.length?n.end(n.length-1):0,u=a.length?a.start(0):0,c=a.length?a.end(a.length-1):0;if(l-o<=Eo&&c-u<=Eo){this.logger_(`On QUOTA_EXCEEDED_ERR, single segment too large to append to buffer, triggering an error. Appended byte length: ${i.byteLength}, audio buffer: ${bn(n).join(", ")}, video buffer: ${bn(a).join(", ")}, `),this.error({message:"Quota exceeded error with append of a single segment of content",excludeUntil:1/0}),this.trigger("error");return}this.waitingOnRemove_=!0,this.callQueue_.push(this.appendToSourceBuffer_.bind(this,{segmentInfo:e,type:t,bytes:i}));const f=this.currentTime_()-Eo;this.logger_(`On QUOTA_EXCEEDED_ERR, removing audio/video from 0 to ${f}`),this.remove(0,f,()=>{this.logger_(`On QUOTA_EXCEEDED_ERR, retrying append in ${Eo}s`),this.waitingOnRemove_=!1,this.quotaExceededErrorRetryTimeout_=U.setTimeout(()=>{this.logger_("On QUOTA_EXCEEDED_ERR, re-processing call queue"),this.quotaExceededErrorRetryTimeout_=null,this.processCallQueue_()},Eo*1e3)},!0)}handleAppendError_({segmentInfo:e,type:t,bytes:i},s){if(s){if(s.code===W_){this.handleQuotaExceededError_({segmentInfo:e,type:t,bytes:i});return}this.logger_("Received non QUOTA_EXCEEDED_ERR on append",s),this.error({message:`${t} append of ${i.length}b failed for segment #${e.mediaIndex} in playlist ${e.playlist.id}`,metadata:{errorType:H.Error.StreamingFailedToAppendSegment}}),this.trigger("appenderror")}}appendToSourceBuffer_({segmentInfo:e,type:t,initSegment:i,data:s,bytes:n}){if(!n){const o=[s];let l=s.byteLength;i&&(o.unshift(i),l+=i.byteLength),n=W$({bytes:l,segments:o})}const a={segmentInfo:pn({type:this.loaderType_,segment:e})};this.trigger({type:"segmentappendstart",metadata:a}),this.sourceUpdater_.appendBuffer({segmentInfo:e,type:t,bytes:n},this.handleAppendError_.bind(this,{segmentInfo:e,type:t,bytes:n}))}handleSegmentTimingInfo_(e,t,i){if(!this.pendingSegment_||t!==this.pendingSegment_.requestId)return;const s=this.pendingSegment_.segment,n=`${e}TimingInfo`;s[n]||(s[n]={}),s[n].transmuxerPrependedSeconds=i.prependedContentDuration||0,s[n].transmuxedPresentationStart=i.start.presentation,s[n].transmuxedDecodeStart=i.start.decode,s[n].transmuxedPresentationEnd=i.end.presentation,s[n].transmuxedDecodeEnd=i.end.decode,s[n].baseMediaDecodeTime=i.baseMediaDecodeTime}appendData_(e,t){const{type:i,data:s}=t;if(!s||!s.byteLength||i==="audio"&&this.audioDisabled_)return;const n=this.getInitSegmentAndUpdateState_({type:i,initSegment:t.initSegment,playlist:e.playlist,map:e.isFmp4?e.segment.map:null});this.appendToSourceBuffer_({segmentInfo:e,type:i,initSegment:n,data:s})}loadSegment_(e){if(this.state="WAITING",this.pendingSegment_=e,this.trimBackBuffer_(e),typeof e.timestampOffset=="number"&&this.transmuxer_&&this.transmuxer_.postMessage({action:"clearAllMp4Captions"}),!this.hasEnoughInfoToLoad_()){Ms(this),this.loadQueue_.push(()=>{const t=At({},e,{forceTimestampOffset:!0});At(e,this.generateSegmentInfo_(t)),this.isPendingTimestampOffset_=!1,this.updateTransmuxerAndRequestSegment_(e)});return}this.updateTransmuxerAndRequestSegment_(e)}updateTransmuxerAndRequestSegment_(e){this.shouldUpdateTransmuxerTimestampOffset_(e.timestampOffset)&&(this.gopBuffer_.length=0,e.gopsToAlignWith=[],this.timeMapping_=0,this.transmuxer_.postMessage({action:"reset"}),this.transmuxer_.postMessage({action:"setTimestampOffset",timestampOffset:e.timestampOffset}));const t=this.createSimplifiedSegmentObj_(e),i=this.isEndOfStream_(e.mediaIndex,e.playlist,e.partIndex),s=this.mediaIndex!==null,n=e.timeline!==this.currentTimeline_&&e.timeline>0,a=i||s&&n;this.logger_(`Requesting
${bx(e.uri)}
${Yn(e)}`),t.map&&!t.map.bytes&&(this.logger_("going to request init segment."),this.appendInitSegment_={video:!0,audio:!0}),e.abortRequests=V$({xhr:this.vhs_.xhr,xhrOptions:this.xhrOptions_,decryptionWorker:this.decrypter_,segment:t,abortFn:this.handleAbort_.bind(this,e),progressFn:this.handleProgress_.bind(this),trackInfoFn:this.handleTrackInfo_.bind(this),timingInfoFn:this.handleTimingInfo_.bind(this),videoSegmentTimingInfoFn:this.handleSegmentTimingInfo_.bind(this,"video",e.requestId),audioSegmentTimingInfoFn:this.handleSegmentTimingInfo_.bind(this,"audio",e.requestId),captionsFn:this.handleCaptions_.bind(this),isEndOfTimeline:a,endedTimelineFn:()=>{this.logger_("received endedtimeline callback")},id3Fn:this.handleId3_.bind(this),dataFn:this.handleData_.bind(this),doneFn:this.segmentRequestFinished_.bind(this),onTransmuxerLog:({message:o,level:l,stream:u})=>{this.logger_(`${Yn(e)} logged from transmuxer stream ${u} as a ${l}: ${o}`)},triggerSegmentEventFn:({type:o,segment:l,keyInfo:u,trackInfo:c,timingInfo:h})=>{const m={segmentInfo:pn({segment:l})};u&&(m.keyInfo=u),c&&(m.trackInfo=c),h&&(m.timingInfo=h),this.trigger({type:o,metadata:m})}})}trimBackBuffer_(e){const t=c5(this.seekable_(),this.currentTime_(),this.playlist_.targetDuration||10);t>0&&this.remove(0,t)}createSimplifiedSegmentObj_(e){const t=e.segment,i=e.part,s=e.segment.key||e.segment.map&&e.segment.map.key,n=e.segment.map&&!e.segment.map.bytes,a={resolvedUri:i?i.resolvedUri:t.resolvedUri,byterange:i?i.byterange:t.byterange,requestId:e.requestId,transmuxer:e.transmuxer,audioAppendStart:e.audioAppendStart,gopsToAlignWith:e.gopsToAlignWith,part:e.part,type:this.loaderType_,start:e.startOfSegment,duration:e.duration,isEncrypted:s,isMediaInitialization:n},o=e.playlist.segments[e.mediaIndex-1];if(o&&o.timeline===t.timeline&&(o.videoTimingInfo?a.baseStartTime=o.videoTimingInfo.transmuxedDecodeEnd:o.audioTimingInfo&&(a.baseStartTime=o.audioTimingInfo.transmuxedDecodeEnd)),t.key){const l=t.key.iv||new Uint32Array([0,0,0,e.mediaIndex+e.playlist.mediaSequence]);a.key=this.segmentKey(t.key),a.key.iv=l}return t.map&&(a.map=this.initSegmentForMap(t.map)),a}saveTransferStats_(e){this.mediaRequests+=1,e&&(this.mediaBytesTransferred+=e.bytesReceived,this.mediaTransferDuration+=e.roundTripTime)}saveBandwidthRelatedStats_(e,t){if(this.pendingSegment_.byteLength=t.bytesReceived,e<Uu){this.logger_(`Ignoring segment's bandwidth because its duration of ${e} is less than the min to record ${Uu}`);return}const i={bandwidthInfo:{from:this.bandwidth,to:t.bandwidth}};this.trigger({type:"bandwidthupdated",metadata:i}),this.bandwidth=t.bandwidth,this.roundTrip=t.roundTripTime}handleTimeout_(){this.mediaRequestsTimedout+=1,this.bandwidth=1,this.roundTrip=NaN,this.trigger("bandwidthupdate"),this.trigger("timeout")}segmentRequestFinished_(e,t,i){if(this.callQueue_.length){this.callQueue_.push(this.segmentRequestFinished_.bind(this,e,t,i));return}if(this.saveTransferStats_(t.stats),!this.pendingSegment_||t.requestId!==this.pendingSegment_.requestId)return;if(e){if(this.pendingSegment_=null,this.state="READY",e.code===Ur.ABORTED)return;if(this.pause(),e.code===Ur.TIMEOUT){this.handleTimeout_();return}this.mediaRequestsErrored+=1,this.error(e),this.trigger("error");return}const s=this.pendingSegment_;this.saveBandwidthRelatedStats_(s.duration,t.stats),s.endOfAllRequests=t.endOfAllRequests,i.gopInfo&&(this.gopBuffer_=s5(this.gopBuffer_,i.gopInfo,this.safeAppend_)),this.state="APPENDING",this.trigger("appending"),this.waitForAppendsToComplete_(s)}setTimeMapping_(e){const t=this.syncController_.mappingForTimeline(e);t!==null&&(this.timeMapping_=t)}updateMediaSecondsLoaded_(e){typeof e.start=="number"&&typeof e.end=="number"?this.mediaSecondsLoaded+=e.end-e.start:this.mediaSecondsLoaded+=e.duration}shouldUpdateTransmuxerTimestampOffset_(e){return e===null?!1:this.loaderType_==="main"&&e!==this.sourceUpdater_.videoTimestampOffset()||!this.audioDisabled_&&e!==this.sourceUpdater_.audioTimestampOffset()}trueSegmentStart_({currentStart:e,playlist:t,mediaIndex:i,firstVideoFrameTimeForData:s,currentVideoTimestampOffset:n,useVideoTimingInfo:a,videoTimingInfo:o,audioTimingInfo:l}){if(typeof e<"u")return e;if(!a)return l.start;const u=t.segments[i-1];return i===0||!u||typeof u.start>"u"||u.end!==s+n?s:o.start}waitForAppendsToComplete_(e){const t=this.getCurrentMediaInfo_(e);if(!t){this.error({message:"No starting media returned, likely due to an unsupported media format.",playlistExclusionDuration:1/0}),this.trigger("error");return}const{hasAudio:i,hasVideo:s,isMuxed:n}=t,a=this.loaderType_==="main"&&s,o=!this.audioDisabled_&&i&&!n;if(e.waitingOnAppends=0,!e.hasAppendedData_){!e.timingInfo&&typeof e.timestampOffset=="number"&&(this.isPendingTimestampOffset_=!0),e.timingInfo={start:0},e.waitingOnAppends++,this.isPendingTimestampOffset_||(this.updateSourceBufferTimestampOffset_(e),this.processMetadataQueue_()),this.checkAppendsDone_(e);return}a&&e.waitingOnAppends++,o&&e.waitingOnAppends++,a&&this.sourceUpdater_.videoQueueCallback(this.checkAppendsDone_.bind(this,e)),o&&this.sourceUpdater_.audioQueueCallback(this.checkAppendsDone_.bind(this,e))}checkAppendsDone_(e){this.checkForAbort_(e.requestId)||(e.waitingOnAppends--,e.waitingOnAppends===0&&this.handleAppendsDone_())}checkForIllegalMediaSwitch(e){const t=u5(this.loaderType_,this.getCurrentMediaInfo_(),e);return t?(this.error({message:t,playlistExclusionDuration:1/0}),this.trigger("error"),!0):!1}updateSourceBufferTimestampOffset_(e){if(e.timestampOffset===null||typeof e.timingInfo.start!="number"||e.changedTimestampOffset||this.loaderType_!=="main")return;let t=!1;e.timestampOffset-=this.getSegmentStartTimeForTimestampOffsetCalculation_({videoTimingInfo:e.segment.videoTimingInfo,audioTimingInfo:e.segment.audioTimingInfo,timingInfo:e.timingInfo}),e.changedTimestampOffset=!0,e.timestampOffset!==this.sourceUpdater_.videoTimestampOffset()&&(this.sourceUpdater_.videoTimestampOffset(e.timestampOffset),t=!0),e.timestampOffset!==this.sourceUpdater_.audioTimestampOffset()&&(this.sourceUpdater_.audioTimestampOffset(e.timestampOffset),t=!0),t&&this.trigger("timestampoffset")}getSegmentStartTimeForTimestampOffsetCalculation_({videoTimingInfo:e,audioTimingInfo:t,timingInfo:i}){return this.useDtsForTimestampOffset_?e&&typeof e.transmuxedDecodeStart=="number"?e.transmuxedDecodeStart:t&&typeof t.transmuxedDecodeStart=="number"?t.transmuxedDecodeStart:i.start:i.start}updateTimingInfoEnd_(e){e.timingInfo=e.timingInfo||{};const t=this.getMediaInfo_(),s=this.loaderType_==="main"&&t&&t.hasVideo&&e.videoTimingInfo?e.videoTimingInfo:e.audioTimingInfo;s&&(e.timingInfo.end=typeof s.end=="number"?s.end:s.start+e.duration)}handleAppendsDone_(){if(this.pendingSegment_){const l={segmentInfo:pn({type:this.loaderType_,segment:this.pendingSegment_})};this.trigger({type:"appendsdone",metadata:l})}if(!this.pendingSegment_){this.state="READY",this.paused()||this.monitorBuffer_();return}const e=this.pendingSegment_;e.part&&e.part.syncInfo?e.part.syncInfo.markAppended():e.segment.syncInfo&&e.segment.syncInfo.markAppended(),this.updateTimingInfoEnd_(e),this.shouldSaveSegmentTimingInfo_&&this.syncController_.saveSegmentTimingInfo({segmentInfo:e,shouldSaveTimelineMapping:this.loaderType_==="main"});const t=m5(e,this.sourceType_);if(t&&(t.severity==="warn"?H.log.warn(t.message):this.logger_(t.message)),this.recordThroughput_(e),this.pendingSegment_=null,this.state="READY",e.isSyncRequest&&(this.trigger("syncinfoupdate"),!e.hasAppendedData_)){this.logger_(`Throwing away un-appended sync request ${Yn(e)}`);return}this.logger_(`Appended ${Yn(e)}`),this.addSegmentMetadataCue_(e),this.fetchAtBuffer_=!0,this.currentTimeline_!==e.timeline&&(this.timelineChangeController_.lastTimelineChange({type:this.loaderType_,from:this.currentTimeline_,to:e.timeline}),this.loaderType_==="main"&&!this.audioDisabled_&&this.timelineChangeController_.lastTimelineChange({type:"audio",from:this.currentTimeline_,to:e.timeline})),this.currentTimeline_=e.timeline,this.trigger("syncinfoupdate");const i=e.segment,s=e.part,n=i.end&&this.currentTime_()-i.end>e.playlist.targetDuration*3,a=s&&s.end&&this.currentTime_()-s.end>e.playlist.partTargetDuration*3;if(n||a){this.logger_(`bad ${n?"segment":"part"} ${Yn(e)}`),this.resetEverything();return}this.mediaIndex!==null&&this.trigger("bandwidthupdate"),this.trigger("progress"),this.mediaIndex=e.mediaIndex,this.partIndex=e.partIndex,this.isEndOfStream_(e.mediaIndex,e.playlist,e.partIndex)&&this.endOfStream(),this.trigger("appended"),e.hasAppendedData_&&this.mediaAppends++,this.paused()||this.monitorBuffer_()}recordThroughput_(e){if(e.duration<Uu){this.logger_(`Ignoring segment's throughput because its duration of ${e.duration} is less than the min to record ${Uu}`);return}const t=this.throughput.rate,i=Date.now()-e.endOfAllRequests+1,s=Math.floor(e.byteLength/i*8*1e3);this.throughput.rate+=(s-t)/++this.throughput.count}addSegmentMetadataCue_(e){if(!this.segmentMetadataTrack_)return;const t=e.segment,i=t.start,s=t.end;if(!fb(i)||!fb(s))return;Fo(i,s,this.segmentMetadataTrack_);const n=U.WebKitDataCue||U.VTTCue,a={custom:t.custom,dateTimeObject:t.dateTimeObject,dateTimeString:t.dateTimeString,programDateTime:t.programDateTime,bandwidth:e.playlist.attributes.BANDWIDTH,resolution:e.playlist.attributes.RESOLUTION,codecs:e.playlist.attributes.CODECS,byteLength:e.byteLength,uri:e.uri,timeline:e.timeline,playlist:e.playlist.id,start:i,end:s},o=JSON.stringify(a),l=new n(i,s,o);l.value=a,this.segmentMetadataTrack_.addCue(l)}}function ds(){}const vx=function(r){return typeof r!="string"?r:r.replace(/./,e=>e.toUpperCase())},g5=["video","audio"],Bp=(r,e)=>{const t=e[`${r}Buffer`];return t&&t.updating||e.queuePending[r]},O5=(r,e)=>{for(let t=0;t<e.length;t++){const i=e[t];if(i.type==="mediaSource")return null;if(i.type===r)return t}return null},ya=(r,e)=>{if(e.queue.length===0)return;let t=0,i=e.queue[t];if(i.type==="mediaSource"){!e.updating()&&e.mediaSource.readyState!=="closed"&&(e.queue.shift(),i.action(e),i.doneFn&&i.doneFn(),ya("audio",e),ya("video",e));return}if(r!=="mediaSource"&&!(!e.ready()||e.mediaSource.readyState==="closed"||Bp(r,e))){if(i.type!==r){if(t=O5(r,e.queue),t===null)return;i=e.queue[t]}if(e.queue.splice(t,1),e.queuePending[r]=i,i.action(r,e),!i.doneFn){e.queuePending[r]=null,ya(r,e);return}}},Sx=(r,e)=>{const t=e[`${r}Buffer`],i=vx(r);t&&(t.removeEventListener("updateend",e[`on${i}UpdateEnd_`]),t.removeEventListener("error",e[`on${i}Error_`]),e.codecs[r]=null,e[`${r}Buffer`]=null)},Rr=(r,e)=>r&&e&&Array.prototype.indexOf.call(r.sourceBuffers,e)!==-1,Di={appendBuffer:(r,e,t)=>(i,s)=>{const n=s[`${i}Buffer`];if(Rr(s.mediaSource,n)){s.logger_(`Appending segment ${e.mediaIndex}'s ${r.length} bytes to ${i}Buffer`);try{n.appendBuffer(r)}catch(a){s.logger_(`Error with code ${a.code} `+(a.code===W_?"(QUOTA_EXCEEDED_ERR) ":"")+`when appending segment ${e.mediaIndex} to ${i}Buffer`),s.queuePending[i]=null,t(a)}}},remove:(r,e)=>(t,i)=>{const s=i[`${t}Buffer`];if(Rr(i.mediaSource,s)){i.logger_(`Removing ${r} to ${e} from ${t}Buffer`);try{s.remove(r,e)}catch{i.logger_(`Remove ${r} to ${e} from ${t}Buffer failed`)}}},timestampOffset:r=>(e,t)=>{const i=t[`${e}Buffer`];Rr(t.mediaSource,i)&&(t.logger_(`Setting ${e}timestampOffset to ${r}`),i.timestampOffset=r)},callback:r=>(e,t)=>{r()},endOfStream:r=>e=>{if(e.mediaSource.readyState==="open"){e.logger_(`Calling mediaSource endOfStream(${r||""})`);try{e.mediaSource.endOfStream(r)}catch(t){H.log.warn("Failed to call media source endOfStream",t)}}},duration:r=>e=>{e.logger_(`Setting mediaSource duration to ${r}`);try{e.mediaSource.duration=r}catch(t){H.log.warn("Failed to set media source duration",t)}},abort:()=>(r,e)=>{if(e.mediaSource.readyState!=="open")return;const t=e[`${r}Buffer`];if(Rr(e.mediaSource,t)){e.logger_(`calling abort on ${r}Buffer`);try{t.abort()}catch(i){H.log.warn(`Failed to abort on ${r}Buffer`,i)}}},addSourceBuffer:(r,e)=>t=>{const i=vx(r),s=ka(e);t.logger_(`Adding ${r}Buffer with codec ${e} to mediaSource`);const n=t.mediaSource.addSourceBuffer(s);n.addEventListener("updateend",t[`on${i}UpdateEnd_`]),n.addEventListener("error",t[`on${i}Error_`]),t.codecs[r]=e,t[`${r}Buffer`]=n},removeSourceBuffer:r=>e=>{const t=e[`${r}Buffer`];if(Sx(r,e),!!Rr(e.mediaSource,t)){e.logger_(`Removing ${r}Buffer with codec ${e.codecs[r]} from mediaSource`);try{e.mediaSource.removeSourceBuffer(t)}catch(i){H.log.warn(`Failed to removeSourceBuffer ${r}Buffer`,i)}}},changeType:r=>(e,t)=>{const i=t[`${e}Buffer`],s=ka(r);if(!Rr(t.mediaSource,i))return;const n=r.substring(0,r.indexOf(".")),a=t.codecs[e];if(a.substring(0,a.indexOf("."))===n)return;const l={codecsChangeInfo:{from:a,to:r}};t.trigger({type:"codecschange",metadata:l}),t.logger_(`changing ${e}Buffer codec from ${a} to ${r}`);try{i.changeType(s),t.codecs[e]=r}catch(u){l.errorType=H.Error.StreamingCodecsChangeError,l.error=u,u.metadata=l,t.error_=u,t.trigger("error"),H.log.warn(`Failed to changeType on ${e}Buffer`,u)}}},Mi=({type:r,sourceUpdater:e,action:t,doneFn:i,name:s})=>{e.queue.push({type:r,action:t,doneFn:i,name:s}),ya(r,e)},gb=(r,e)=>t=>{const i=e[`${r}Buffered`](),s=PQ(i);if(e.logger_(`received "updateend" event for ${r} Source Buffer: `,s),e.queuePending[r]){const n=e.queuePending[r].doneFn;e.queuePending[r]=null,n&&n(e[`${r}Error_`])}ya(r,e)};class Tx extends H.EventTarget{constructor(e){super(),this.mediaSource=e,this.sourceopenListener_=()=>ya("mediaSource",this),this.mediaSource.addEventListener("sourceopen",this.sourceopenListener_),this.logger_=ar("SourceUpdater"),this.audioTimestampOffset_=0,this.videoTimestampOffset_=0,this.queue=[],this.queuePending={audio:null,video:null},this.delayedAudioAppendQueue_=[],this.videoAppendQueued_=!1,this.codecs={},this.onVideoUpdateEnd_=gb("video",this),this.onAudioUpdateEnd_=gb("audio",this),this.onVideoError_=t=>{this.videoError_=t},this.onAudioError_=t=>{this.audioError_=t},this.createdSourceBuffers_=!1,this.initializedEme_=!1,this.triggeredReady_=!1}initializedEme(){this.initializedEme_=!0,this.triggerReady()}hasCreatedSourceBuffers(){return this.createdSourceBuffers_}hasInitializedAnyEme(){return this.initializedEme_}ready(){return this.hasCreatedSourceBuffers()&&this.hasInitializedAnyEme()}createSourceBuffers(e){this.hasCreatedSourceBuffers()||(this.addOrChangeSourceBuffers(e),this.createdSourceBuffers_=!0,this.trigger("createdsourcebuffers"),this.triggerReady())}triggerReady(){this.ready()&&!this.triggeredReady_&&(this.triggeredReady_=!0,this.trigger("ready"))}addSourceBuffer(e,t){Mi({type:"mediaSource",sourceUpdater:this,action:Di.addSourceBuffer(e,t),name:"addSourceBuffer"})}abort(e){Mi({type:e,sourceUpdater:this,action:Di.abort(e),name:"abort"})}removeSourceBuffer(e){if(!this.canRemoveSourceBuffer()){H.log.error("removeSourceBuffer is not supported!");return}Mi({type:"mediaSource",sourceUpdater:this,action:Di.removeSourceBuffer(e),name:"removeSourceBuffer"})}canRemoveSourceBuffer(){return!H.browser.IS_FIREFOX&&U.MediaSource&&U.MediaSource.prototype&&typeof U.MediaSource.prototype.removeSourceBuffer=="function"}static canChangeType(){return U.SourceBuffer&&U.SourceBuffer.prototype&&typeof U.SourceBuffer.prototype.changeType=="function"}canChangeType(){return this.constructor.canChangeType()}changeType(e,t){if(!this.canChangeType()){H.log.error("changeType is not supported!");return}Mi({type:e,sourceUpdater:this,action:Di.changeType(t),name:"changeType"})}addOrChangeSourceBuffers(e){if(!e||typeof e!="object"||Object.keys(e).length===0)throw new Error("Cannot addOrChangeSourceBuffers to undefined codecs");Object.keys(e).forEach(t=>{const i=e[t];if(!this.hasCreatedSourceBuffers())return this.addSourceBuffer(t,i);this.canChangeType()&&this.changeType(t,i)})}appendBuffer(e,t){const{segmentInfo:i,type:s,bytes:n}=e;if(this.processedAppend_=!0,s==="audio"&&this.videoBuffer&&!this.videoAppendQueued_){this.delayedAudioAppendQueue_.push([e,t]),this.logger_(`delayed audio append of ${n.length} until video append`);return}const a=t;if(Mi({type:s,sourceUpdater:this,action:Di.appendBuffer(n,i||{mediaIndex:-1},a),doneFn:t,name:"appendBuffer"}),s==="video"){if(this.videoAppendQueued_=!0,!this.delayedAudioAppendQueue_.length)return;const o=this.delayedAudioAppendQueue_.slice();this.logger_(`queuing delayed audio ${o.length} appendBuffers`),this.delayedAudioAppendQueue_.length=0,o.forEach(l=>{this.appendBuffer.apply(this,l)})}}audioBuffered(){return Rr(this.mediaSource,this.audioBuffer)&&this.audioBuffer.buffered?this.audioBuffer.buffered:Xt()}videoBuffered(){return Rr(this.mediaSource,this.videoBuffer)&&this.videoBuffer.buffered?this.videoBuffer.buffered:Xt()}buffered(){const e=Rr(this.mediaSource,this.videoBuffer)?this.videoBuffer:null,t=Rr(this.mediaSource,this.audioBuffer)?this.audioBuffer:null;return t&&!e?this.audioBuffered():e&&!t?this.videoBuffered():MQ(this.audioBuffered(),this.videoBuffered())}setDuration(e,t=ds){Mi({type:"mediaSource",sourceUpdater:this,action:Di.duration(e),name:"duration",doneFn:t})}endOfStream(e=null,t=ds){typeof e!="string"&&(e=void 0),Mi({type:"mediaSource",sourceUpdater:this,action:Di.endOfStream(e),name:"endOfStream",doneFn:t})}removeAudio(e,t,i=ds){if(!this.audioBuffered().length||this.audioBuffered().end(0)===0){i();return}Mi({type:"audio",sourceUpdater:this,action:Di.remove(e,t),doneFn:i,name:"remove"})}removeVideo(e,t,i=ds){if(!this.videoBuffered().length||this.videoBuffered().end(0)===0){i();return}Mi({type:"video",sourceUpdater:this,action:Di.remove(e,t),doneFn:i,name:"remove"})}updating(){return!!(Bp("audio",this)||Bp("video",this))}audioTimestampOffset(e){return typeof e<"u"&&this.audioBuffer&&this.audioTimestampOffset_!==e&&(Mi({type:"audio",sourceUpdater:this,action:Di.timestampOffset(e),name:"timestampOffset"}),this.audioTimestampOffset_=e),this.audioTimestampOffset_}videoTimestampOffset(e){return typeof e<"u"&&this.videoBuffer&&this.videoTimestampOffset_!==e&&(Mi({type:"video",sourceUpdater:this,action:Di.timestampOffset(e),name:"timestampOffset"}),this.videoTimestampOffset_=e),this.videoTimestampOffset_}audioQueueCallback(e){this.audioBuffer&&Mi({type:"audio",sourceUpdater:this,action:Di.callback(e),name:"callback"})}videoQueueCallback(e){this.videoBuffer&&Mi({type:"video",sourceUpdater:this,action:Di.callback(e),name:"callback"})}dispose(){this.trigger("dispose"),g5.forEach(e=>{this.abort(e),this.canRemoveSourceBuffer()?this.removeSourceBuffer(e):this[`${e}QueueCallback`](()=>Sx(e,this))}),this.videoAppendQueued_=!1,this.delayedAudioAppendQueue_.length=0,this.sourceopenListener_&&this.mediaSource.removeEventListener("sourceopen",this.sourceopenListener_),this.off()}}const Ob=r=>decodeURIComponent(escape(String.fromCharCode.apply(null,r))),y5=r=>{const e=new Uint8Array(r);return Array.from(e).map(t=>t.toString(16).padStart(2,"0")).join("")},yb=new Uint8Array(`

`.split("").map(r=>r.charCodeAt(0)));class b5 extends Error{constructor(){super("Trying to parse received VTT cues, but there is no WebVTT. Make sure vtt.js is loaded.")}}class v5 extends $p{constructor(e,t={}){super(e,t),this.mediaSource_=null,this.subtitlesTrack_=null,this.featuresNativeTextTracks_=e.featuresNativeTextTracks,this.loadVttJs=e.loadVttJs,this.shouldSaveSegmentTimingInfo_=!1}buffered_(){if(!this.subtitlesTrack_||!this.subtitlesTrack_.cues||!this.subtitlesTrack_.cues.length)return Xt();const e=this.subtitlesTrack_.cues,t=e[0].startTime,i=e[e.length-1].startTime;return Xt([[t,i]])}initSegmentForMap(e,t=!1){if(!e)return null;const i=eh(e);let s=this.initSegments_[i];if(t&&!s&&e.bytes){const n=yb.byteLength+e.bytes.byteLength,a=new Uint8Array(n);a.set(e.bytes),a.set(yb,e.bytes.byteLength),this.initSegments_[i]=s={resolvedUri:e.resolvedUri,byterange:e.byterange,bytes:a}}return s||e}couldBeginLoading_(){return this.playlist_&&this.subtitlesTrack_&&!this.paused()}init_(){return this.state="READY",this.resetEverything(),this.monitorBuffer_()}track(e){return typeof e>"u"?this.subtitlesTrack_:(this.subtitlesTrack_=e,this.state==="INIT"&&this.couldBeginLoading_()&&this.init_(),this.subtitlesTrack_)}remove(e,t){Fo(e,t,this.subtitlesTrack_)}fillBuffer_(){const e=this.chooseNextRequest_();if(e){if(this.syncController_.timestampOffsetForTimeline(e.timeline)===null){const t=()=>{this.state="READY",this.paused()||this.monitorBuffer_()};this.syncController_.one("timestampoffset",t),this.state="WAITING_ON_TIMELINE";return}this.loadSegment_(e)}}timestampOffsetForSegment_(){return null}chooseNextRequest_(){return this.skipEmptySegments_(super.chooseNextRequest_())}skipEmptySegments_(e){for(;e&&e.segment.empty;){if(e.mediaIndex+1>=e.playlist.segments.length){e=null;break}e=this.generateSegmentInfo_({playlist:e.playlist,mediaIndex:e.mediaIndex+1,startOfSegment:e.startOfSegment+e.duration,isSyncRequest:e.isSyncRequest})}return e}stopForError(e){this.error(e),this.state="READY",this.pause(),this.trigger("error")}segmentRequestFinished_(e,t,i){if(!this.subtitlesTrack_){this.state="READY";return}if(this.saveTransferStats_(t.stats),!this.pendingSegment_){this.state="READY",this.mediaRequestsAborted+=1;return}if(e){e.code===Ur.TIMEOUT&&this.handleTimeout_(),e.code===Ur.ABORTED?this.mediaRequestsAborted+=1:this.mediaRequestsErrored+=1,this.stopForError(e);return}const s=this.pendingSegment_,n=i.mp4VttCues&&i.mp4VttCues.length;n&&(s.mp4VttCues=i.mp4VttCues),this.saveBandwidthRelatedStats_(s.duration,t.stats),t.key&&this.segmentKey(t.key,!0),this.state="APPENDING",this.trigger("appending");const a=s.segment;if(a.map&&(a.map.bytes=t.map.bytes),s.bytes=t.bytes,typeof U.WebVTT!="function"&&typeof this.loadVttJs=="function"){this.state="WAITING_ON_VTTJS",this.loadVttJs().then(()=>this.segmentRequestFinished_(e,t,i),()=>this.stopForError({message:"Error loading vtt.js"}));return}a.requested=!0;try{this.parseVTTCues_(s)}catch(o){this.stopForError({message:o.message,metadata:{errorType:H.Error.StreamingVttParserError,error:o}});return}if(n||this.updateTimeMapping_(s,this.syncController_.timelines[s.timeline],this.playlist_),s.cues.length?s.timingInfo={start:s.cues[0].startTime,end:s.cues[s.cues.length-1].endTime}:s.timingInfo={start:s.startOfSegment,end:s.startOfSegment+s.duration},s.isSyncRequest){this.trigger("syncinfoupdate"),this.pendingSegment_=null,this.state="READY";return}s.byteLength=s.bytes.byteLength,this.mediaSecondsLoaded+=a.duration,s.cues.forEach(o=>{this.subtitlesTrack_.addCue(this.featuresNativeTextTracks_?new U.VTTCue(o.startTime,o.endTime,o.text):o)}),i5(this.subtitlesTrack_),this.handleAppendsDone_()}handleData_(e,t){const i=e&&e.type==="vtt",s=t&&t.type==="text";i&&s&&super.handleData_(e,t)}updateTimingInfoEnd_(){}parseMp4VttCues_(e){const t=this.sourceUpdater_.videoTimestampOffset()===null?this.sourceUpdater_.audioTimestampOffset():this.sourceUpdater_.videoTimestampOffset();e.mp4VttCues.forEach(i=>{const s=i.start+t,n=i.end+t,a=new U.VTTCue(s,n,i.cueText);i.settings&&i.settings.split(" ").forEach(o=>{const l=o.split(":"),u=l[0],c=l[1];a[u]=isNaN(c)?c:Number(c)}),e.cues.push(a)})}parseVTTCues_(e){let t,i=!1;if(typeof U.WebVTT!="function")throw new b5;if(e.cues=[],e.timestampmap={MPEGTS:0,LOCAL:0},e.mp4VttCues){this.parseMp4VttCues_(e);return}typeof U.TextDecoder=="function"?t=new U.TextDecoder("utf8"):(t=U.WebVTT.StringDecoder(),i=!0);const s=new U.WebVTT.Parser(U,U.vttjs,t);if(s.oncue=e.cues.push.bind(e.cues),s.ontimestampmap=a=>{e.timestampmap=a},s.onparsingerror=a=>{H.log.warn("Error encountered when parsing cues: "+a.message)},e.segment.map){let a=e.segment.map.bytes;i&&(a=Ob(a)),s.parse(a)}let n=e.bytes;i&&(n=Ob(n)),s.parse(n),s.flush()}updateTimeMapping_(e,t,i){const s=e.segment;if(!t)return;if(!e.cues.length){s.empty=!0;return}const{MPEGTS:n,LOCAL:a}=e.timestampmap,l=n/yn.ONE_SECOND_IN_TS-a+t.mapping;if(e.cues.forEach(u=>{const c=u.endTime-u.startTime,h=this.handleRollover_(u.startTime+l,t.time);u.startTime=Math.max(h,0),u.endTime=Math.max(h+c,0)}),!i.syncInfo){const u=e.cues[0].startTime,c=e.cues[e.cues.length-1].startTime;i.syncInfo={mediaSequence:i.mediaSequence+e.mediaIndex,time:Math.min(u,c-s.duration)}}}handleRollover_(e,t){if(t===null)return e;let i=e*yn.ONE_SECOND_IN_TS;const s=t*yn.ONE_SECOND_IN_TS;let n;for(s<i?n=-8589934592:n=8589934592;Math.abs(i-s)>4294967296;)i+=n;return i/yn.ONE_SECOND_IN_TS}}const S5=function(r,e){const t=r.cues;for(let i=0;i<t.length;i++){const s=t[i];if(e>=s.adStartTime&&e<=s.adEndTime)return s}return null},T5=function(r,e,t=0){if(!r.segments)return;let i=t,s;for(let n=0;n<r.segments.length;n++){const a=r.segments[n];if(s||(s=S5(e,i+a.duration/2)),s){if("cueIn"in a){s.endTime=i,s.adEndTime=i,i+=a.duration,s=null;continue}if(i<s.endTime){i+=a.duration;continue}s.endTime+=a.duration}else if("cueOut"in a&&(s=new U.VTTCue(i,i+a.duration,a.cueOut),s.adStartTime=i,s.adEndTime=i+parseFloat(a.cueOut),e.addCue(s)),"cueOutCont"in a){const[o,l]=a.cueOutCont.split("/").map(parseFloat);s=new U.VTTCue(i,i+a.duration,""),s.adStartTime=i-o,s.adEndTime=s.adStartTime+l,e.addCue(s)}i+=a.duration}};class bb{constructor({start:e,end:t,segmentIndex:i,partIndex:s=null,appended:n=!1}){this.start_=e,this.end_=t,this.segmentIndex_=i,this.partIndex_=s,this.appended_=n}isInRange(e){return e>=this.start&&e<this.end}markAppended(){this.appended_=!0}resetAppendedStatus(){this.appended_=!1}get isAppended(){return this.appended_}get start(){return this.start_}get end(){return this.end_}get segmentIndex(){return this.segmentIndex_}get partIndex(){return this.partIndex_}}class _5{constructor(e,t=[]){this.segmentSyncInfo_=e,this.partsSyncInfo_=t}get segmentSyncInfo(){return this.segmentSyncInfo_}get partsSyncInfo(){return this.partsSyncInfo_}get hasPartsSyncInfo(){return this.partsSyncInfo_.length>0}resetAppendStatus(){this.segmentSyncInfo_.resetAppendedStatus(),this.partsSyncInfo_.forEach(e=>e.resetAppendedStatus())}}class _x{constructor(){this.storage_=new Map,this.diagnostics_="",this.isReliable_=!1,this.start_=-1/0,this.end_=1/0}get start(){return this.start_}get end(){return this.end_}get diagnostics(){return this.diagnostics_}get isReliable(){return this.isReliable_}resetAppendedStatus(){this.storage_.forEach(e=>e.resetAppendStatus())}update(e,t){const{mediaSequence:i,segments:s}=e;if(this.isReliable_=this.isReliablePlaylist_(i,s),!!this.isReliable_)return this.updateStorage_(s,i,this.calculateBaseTime_(i,s,t))}getSyncInfoForTime(e){for(const{segmentSyncInfo:t,partsSyncInfo:i}of this.storage_.values())if(i.length){for(const s of i)if(s.isInRange(e))return s}else if(t.isInRange(e))return t;return null}getSyncInfoForMediaSequence(e){return this.storage_.get(e)}updateStorage_(e,t,i){const s=new Map;let n=`
`,a=i,o=t;this.start_=a,e.forEach((l,u)=>{const c=this.storage_.get(o),h=a,f=h+l.duration,m=!!(c&&c.segmentSyncInfo&&c.segmentSyncInfo.isAppended),S=new bb({start:h,end:f,appended:m,segmentIndex:u});l.syncInfo=S;let y=a;const E=(l.parts||[]).map((C,_)=>{const v=y,T=y+C.duration,w=!!(c&&c.partsSyncInfo&&c.partsSyncInfo[_]&&c.partsSyncInfo[_].isAppended),A=new bb({start:v,end:T,appended:w,segmentIndex:u,partIndex:_});return y=T,n+=`Media Sequence: ${o}.${_} | Range: ${v} --> ${T} | Appended: ${w}
`,C.syncInfo=A,A});s.set(o,new _5(S,E)),n+=`${bx(l.resolvedUri)} | Media Sequence: ${o} | Range: ${h} --> ${f} | Appended: ${m}
`,o++,a=f}),this.end_=a,this.storage_=s,this.diagnostics_=n}calculateBaseTime_(e,t,i){if(!this.storage_.size)return 0;if(this.storage_.has(e))return this.storage_.get(e).segmentSyncInfo.start;const s=Math.min(...this.storage_.keys());if(e<s){const n=s-e;let a=this.storage_.get(s).segmentSyncInfo.start;for(let o=0;o<n;o++){const l=t[o];a-=l.duration}return a}return i}isReliablePlaylist_(e,t){return e!=null&&Array.isArray(t)&&t.length}}class vb extends _x{constructor(e){super(),this.parent_=e}calculateBaseTime_(e,t,i){if(!this.storage_.size){const s=this.parent_.getSyncInfoForMediaSequence(e);return s?s.segmentSyncInfo.start:0}return super.calculateBaseTime_(e,t,i)}}const x5=86400,gf=[{name:"VOD",run:(r,e,t,i,s)=>t!==1/0?{time:0,segmentIndex:0,partIndex:null}:null},{name:"MediaSequence",run:(r,e,t,i,s,n)=>{const a=r.getMediaSequenceSync(n);if(!a||!a.isReliable)return null;const o=a.getSyncInfoForTime(s);return o?{time:o.start,partIndex:o.partIndex,segmentIndex:o.segmentIndex}:null}},{name:"ProgramDateTime",run:(r,e,t,i,s)=>{if(!Object.keys(r.timelineToDatetimeMappings).length)return null;let n=null,a=null;const o=Ep(e);s=s||0;for(let l=0;l<o.length;l++){const u=e.endList||s===0?l:o.length-(l+1),c=o[u],h=c.segment,f=r.timelineToDatetimeMappings[h.timeline];if(!f||!h.dateTimeObject)continue;let S=h.dateTimeObject.getTime()/1e3+f;if(h.parts&&typeof c.partIndex=="number")for(let E=0;E<c.partIndex;E++)S+=h.parts[E].duration;const y=Math.abs(s-S);if(a!==null&&(y===0||a<y))break;a=y,n={time:S,segmentIndex:c.segmentIndex,partIndex:c.partIndex}}return n}},{name:"Segment",run:(r,e,t,i,s)=>{let n=null,a=null;s=s||0;const o=Ep(e);for(let l=0;l<o.length;l++){const u=e.endList||s===0?l:o.length-(l+1),c=o[u],h=c.segment,f=c.part&&c.part.start||h&&h.start;if(h.timeline===i&&typeof f<"u"){const m=Math.abs(s-f);if(a!==null&&a<m)break;(!n||a===null||a>=m)&&(a=m,n={time:f,segmentIndex:c.segmentIndex,partIndex:c.partIndex})}}return n}},{name:"Discontinuity",run:(r,e,t,i,s)=>{let n=null;if(s=s||0,e.discontinuityStarts&&e.discontinuityStarts.length){let a=null;for(let o=0;o<e.discontinuityStarts.length;o++){const l=e.discontinuityStarts[o],u=e.discontinuitySequence+o+1,c=r.discontinuities[u];if(c){const h=Math.abs(s-c.time);if(a!==null&&a<h)break;(!n||a===null||a>=h)&&(a=h,n={time:c.time,segmentIndex:l,partIndex:null})}}}return n}},{name:"Playlist",run:(r,e,t,i,s)=>e.syncInfo?{time:e.syncInfo.time,segmentIndex:e.syncInfo.mediaSequence-e.mediaSequence,partIndex:null}:null}];class w5 extends H.EventTarget{constructor(e={}){super(),this.timelines=[],this.discontinuities=[],this.timelineToDatetimeMappings={};const t=new _x,i=new vb(t),s=new vb(t);this.mediaSequenceStorage_={main:t,audio:i,vtt:s},this.logger_=ar("SyncController")}getMediaSequenceSync(e){return this.mediaSequenceStorage_[e]||null}getSyncPoint(e,t,i,s,n){if(t!==1/0)return gf.find(({name:l})=>l==="VOD").run(this,e,t);const a=this.runStrategies_(e,t,i,s,n);if(!a.length)return null;for(const o of a){const{syncPoint:l,strategy:u}=o,{segmentIndex:c,time:h}=l;if(c<0)continue;const f=e.segments[c],m=h,S=m+f.duration;if(this.logger_(`Strategy: ${u}. Current time: ${s}. selected segment: ${c}. Time: [${m} -> ${S}]}`),s>=m&&s<S)return this.logger_("Found sync point with exact match: ",l),l}return this.selectSyncPoint_(a,{key:"time",value:s})}getExpiredTime(e,t){if(!e||!e.segments)return null;const i=this.runStrategies_(e,t,e.discontinuitySequence,0);if(!i.length)return null;const s=this.selectSyncPoint_(i,{key:"segmentIndex",value:0});return s.segmentIndex>0&&(s.time*=-1),Math.abs(s.time+Ko({defaultDuration:e.targetDuration,durationList:e.segments,startIndex:s.segmentIndex,endIndex:0}))}runStrategies_(e,t,i,s,n){const a=[];for(let o=0;o<gf.length;o++){const l=gf[o],u=l.run(this,e,t,i,s,n);u&&(u.strategy=l.name,a.push({strategy:l.name,syncPoint:u}))}return a}selectSyncPoint_(e,t){let i=e[0].syncPoint,s=Math.abs(e[0].syncPoint[t.key]-t.value),n=e[0].strategy;for(let a=1;a<e.length;a++){const o=Math.abs(e[a].syncPoint[t.key]-t.value);o<s&&(s=o,i=e[a].syncPoint,n=e[a].strategy)}return this.logger_(`syncPoint for [${t.key}: ${t.value}] chosen with strategy [${n}]: [time:${i.time}, segmentIndex:${i.segmentIndex}`+(typeof i.partIndex=="number"?`,partIndex:${i.partIndex}`:"")+"]"),i}saveExpiredSegmentInfo(e,t){const i=t.mediaSequence-e.mediaSequence;if(i>x5){H.log.warn(`Not saving expired segment info. Media sequence gap ${i} is too large.`);return}for(let s=i-1;s>=0;s--){const n=e.segments[s];if(n&&typeof n.start<"u"){t.syncInfo={mediaSequence:e.mediaSequence+s,time:n.start},this.logger_(`playlist refresh sync: [time:${t.syncInfo.time}, mediaSequence: ${t.syncInfo.mediaSequence}]`),this.trigger("syncinfoupdate");break}}}setDateTimeMappingForStart(e){if(this.timelineToDatetimeMappings={},e.segments&&e.segments.length&&e.segments[0].dateTimeObject){const t=e.segments[0],i=t.dateTimeObject.getTime()/1e3;this.timelineToDatetimeMappings[t.timeline]=-i}}saveSegmentTimingInfo({segmentInfo:e,shouldSaveTimelineMapping:t}){const i=this.calculateSegmentTimeMapping_(e,e.timingInfo,t),s=e.segment;i&&(this.saveDiscontinuitySyncInfo_(e),e.playlist.syncInfo||(e.playlist.syncInfo={mediaSequence:e.playlist.mediaSequence+e.mediaIndex,time:s.start}));const n=s.dateTimeObject;s.discontinuity&&t&&n&&(this.timelineToDatetimeMappings[s.timeline]=-(n.getTime()/1e3))}timestampOffsetForTimeline(e){return typeof this.timelines[e]>"u"?null:this.timelines[e].time}mappingForTimeline(e){return typeof this.timelines[e]>"u"?null:this.timelines[e].mapping}calculateSegmentTimeMapping_(e,t,i){const s=e.segment,n=e.part;let a=this.timelines[e.timeline],o,l;if(typeof e.timestampOffset=="number")a={time:e.startOfSegment,mapping:e.startOfSegment-t.start},i&&(this.timelines[e.timeline]=a,this.trigger("timestampoffset"),this.logger_(`time mapping for timeline ${e.timeline}: [time: ${a.time}] [mapping: ${a.mapping}]`)),o=e.startOfSegment,l=t.end+a.mapping;else if(a)o=t.start+a.mapping,l=t.end+a.mapping;else return!1;return n&&(n.start=o,n.end=l),(!s.start||o<s.start)&&(s.start=o),s.end=l,!0}saveDiscontinuitySyncInfo_(e){const t=e.playlist,i=e.segment;if(i.discontinuity)this.discontinuities[i.timeline]={time:i.start,accuracy:0};else if(t.discontinuityStarts&&t.discontinuityStarts.length)for(let s=0;s<t.discontinuityStarts.length;s++){const n=t.discontinuityStarts[s],a=t.discontinuitySequence+s+1,o=n-e.mediaIndex,l=Math.abs(o);if(!this.discontinuities[a]||this.discontinuities[a].accuracy>l){let u;o<0?u=i.start-Ko({defaultDuration:t.targetDuration,durationList:t.segments,startIndex:e.mediaIndex,endIndex:n}):u=i.end+Ko({defaultDuration:t.targetDuration,durationList:t.segments,startIndex:e.mediaIndex+1,endIndex:n}),this.discontinuities[a]={time:u,accuracy:l}}}}dispose(){this.trigger("dispose"),this.off()}}class C5 extends H.EventTarget{constructor(){super(),this.pendingTimelineChanges_={},this.lastTimelineChanges_={}}clearPendingTimelineChange(e){this.pendingTimelineChanges_[e]=null,this.trigger("pendingtimelinechange")}pendingTimelineChange({type:e,from:t,to:i}){return typeof t=="number"&&typeof i=="number"&&(this.pendingTimelineChanges_[e]={type:e,from:t,to:i},this.trigger("pendingtimelinechange")),this.pendingTimelineChanges_[e]}lastTimelineChange({type:e,from:t,to:i}){if(typeof t=="number"&&typeof i=="number"){this.lastTimelineChanges_[e]={type:e,from:t,to:i},delete this.pendingTimelineChanges_[e];const s={timelineChangeInfo:{from:t,to:i}};this.trigger({type:"timelinechange",metadata:s})}return this.lastTimelineChanges_[e]}dispose(){this.trigger("dispose"),this.pendingTimelineChanges_={},this.lastTimelineChanges_={},this.off()}}const k5=lx(ux(function(){var r=(function(){function y(){this.listeners={}}var E=y.prototype;return E.on=function(_,v){this.listeners[_]||(this.listeners[_]=[]),this.listeners[_].push(v)},E.off=function(_,v){if(!this.listeners[_])return!1;var T=this.listeners[_].indexOf(v);return this.listeners[_]=this.listeners[_].slice(0),this.listeners[_].splice(T,1),T>-1},E.trigger=function(_){var v=this.listeners[_];if(v)if(arguments.length===2)for(var T=v.length,w=0;w<T;++w)v[w].call(this,arguments[1]);else for(var A=Array.prototype.slice.call(arguments,1),I=v.length,N=0;N<I;++N)v[N].apply(this,A)},E.dispose=function(){this.listeners={}},E.pipe=function(_){this.on("data",function(v){_.push(v)})},y})();/*! @name pkcs7 @version 1.0.4 @license Apache-2.0 */function e(y){return y.subarray(0,y.byteLength-y[y.byteLength-1])}/*! @name aes-decrypter @version 4.0.2 @license Apache-2.0 */const t=function(){const y=[[[],[],[],[],[]],[[],[],[],[],[]]],E=y[0],C=y[1],_=E[4],v=C[4];let T,w,A;const I=[],N=[];let P,R,X,j,Z,Y;for(T=0;T<256;T++)N[(I[T]=T<<1^(T>>7)*283)^T]=T;for(w=A=0;!_[w];w^=P||1,A=N[A]||1)for(j=A^A<<1^A<<2^A<<3^A<<4,j=j>>8^j&255^99,_[w]=j,v[j]=w,X=I[R=I[P=I[w]]],Y=X*16843009^R*65537^P*257^w*16843008,Z=I[j]*257^j*16843008,T=0;T<4;T++)E[T][w]=Z=Z<<24^Z>>>8,C[T][j]=Y=Y<<24^Y>>>8;for(T=0;T<5;T++)E[T]=E[T].slice(0),C[T]=C[T].slice(0);return y};let i=null;class s{constructor(E){i||(i=t()),this._tables=[[i[0][0].slice(),i[0][1].slice(),i[0][2].slice(),i[0][3].slice(),i[0][4].slice()],[i[1][0].slice(),i[1][1].slice(),i[1][2].slice(),i[1][3].slice(),i[1][4].slice()]];let C,_,v;const T=this._tables[0][4],w=this._tables[1],A=E.length;let I=1;if(A!==4&&A!==6&&A!==8)throw new Error("Invalid aes key size");const N=E.slice(0),P=[];for(this._key=[N,P],C=A;C<4*A+28;C++)v=N[C-1],(C%A===0||A===8&&C%A===4)&&(v=T[v>>>24]<<24^T[v>>16&255]<<16^T[v>>8&255]<<8^T[v&255],C%A===0&&(v=v<<8^v>>>24^I<<24,I=I<<1^(I>>7)*283)),N[C]=N[C-A]^v;for(_=0;C;_++,C--)v=N[_&3?C:C-4],C<=4||_<4?P[_]=v:P[_]=w[0][T[v>>>24]]^w[1][T[v>>16&255]]^w[2][T[v>>8&255]]^w[3][T[v&255]]}decrypt(E,C,_,v,T,w){const A=this._key[1];let I=E^A[0],N=v^A[1],P=_^A[2],R=C^A[3],X,j,Z;const Y=A.length/4-2;let te,le=4;const G=this._tables[1],re=G[0],J=G[1],ne=G[2],ae=G[3],ve=G[4];for(te=0;te<Y;te++)X=re[I>>>24]^J[N>>16&255]^ne[P>>8&255]^ae[R&255]^A[le],j=re[N>>>24]^J[P>>16&255]^ne[R>>8&255]^ae[I&255]^A[le+1],Z=re[P>>>24]^J[R>>16&255]^ne[I>>8&255]^ae[N&255]^A[le+2],R=re[R>>>24]^J[I>>16&255]^ne[N>>8&255]^ae[P&255]^A[le+3],le+=4,I=X,N=j,P=Z;for(te=0;te<4;te++)T[(3&-te)+w]=ve[I>>>24]<<24^ve[N>>16&255]<<16^ve[P>>8&255]<<8^ve[R&255]^A[le++],X=I,I=N,N=P,P=R,R=X}}class n extends r{constructor(){super(r),this.jobs=[],this.delay=1,this.timeout_=null}processJob_(){this.jobs.shift()(),this.jobs.length?this.timeout_=setTimeout(this.processJob_.bind(this),this.delay):this.timeout_=null}push(E){this.jobs.push(E),this.timeout_||(this.timeout_=setTimeout(this.processJob_.bind(this),this.delay))}}const a=function(y){return y<<24|(y&65280)<<8|(y&16711680)>>8|y>>>24},o=function(y,E,C){const _=new Int32Array(y.buffer,y.byteOffset,y.byteLength>>2),v=new s(Array.prototype.slice.call(E)),T=new Uint8Array(y.byteLength),w=new Int32Array(T.buffer);let A,I,N,P,R,X,j,Z,Y;for(A=C[0],I=C[1],N=C[2],P=C[3],Y=0;Y<_.length;Y+=4)R=a(_[Y]),X=a(_[Y+1]),j=a(_[Y+2]),Z=a(_[Y+3]),v.decrypt(R,X,j,Z,w,Y),w[Y]=a(w[Y]^A),w[Y+1]=a(w[Y+1]^I),w[Y+2]=a(w[Y+2]^N),w[Y+3]=a(w[Y+3]^P),A=R,I=X,N=j,P=Z;return T};class l{constructor(E,C,_,v){const T=l.STEP,w=new Int32Array(E.buffer),A=new Uint8Array(E.byteLength);let I=0;for(this.asyncStream_=new n,this.asyncStream_.push(this.decryptChunk_(w.subarray(I,I+T),C,_,A)),I=T;I<w.length;I+=T)_=new Uint32Array([a(w[I-4]),a(w[I-3]),a(w[I-2]),a(w[I-1])]),this.asyncStream_.push(this.decryptChunk_(w.subarray(I,I+T),C,_,A));this.asyncStream_.push(function(){v(null,e(A))})}static get STEP(){return 32e3}decryptChunk_(E,C,_,v){return function(){const T=o(E,C,_);v.set(T,E.byteOffset)}}}var u=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},c;typeof window<"u"?c=window:typeof u<"u"?c=u:typeof self<"u"?c=self:c={};var h=c,f=function(E){return ArrayBuffer.isView==="function"?ArrayBuffer.isView(E):E&&E.buffer instanceof ArrayBuffer},m=h.BigInt||Number;m("0x1"),m("0x100"),m("0x10000"),m("0x1000000"),m("0x100000000"),m("0x10000000000"),m("0x1000000000000"),m("0x100000000000000"),m("0x10000000000000000"),(function(){var y=new Uint16Array([65484]),E=new Uint8Array(y.buffer,y.byteOffset,y.byteLength);return E[0]===255?"big":E[0]===204?"little":"unknown"})();const S=function(y){const E={};return Object.keys(y).forEach(C=>{const _=y[C];f(_)?E[C]={bytes:_.buffer,byteOffset:_.byteOffset,byteLength:_.byteLength}:E[C]=_}),E};self.onmessage=function(y){const E=y.data,C=new Uint8Array(E.encrypted.bytes,E.encrypted.byteOffset,E.encrypted.byteLength),_=new Uint32Array(E.key.bytes,E.key.byteOffset,E.key.byteLength/4),v=new Uint32Array(E.iv.bytes,E.iv.byteOffset,E.iv.byteLength/4);new l(C,_,v,function(T,w){self.postMessage(S({source:E.source,decrypted:w}),[w.buffer])})}}));var E5=ox(k5);const A5=r=>{let e=r.default?"main":"alternative";return r.characteristics&&r.characteristics.indexOf("public.accessibility.describes-video")>=0&&(e="main-desc"),e},xx=(r,e)=>{r.abort(),r.pause(),e&&e.activePlaylistLoader&&(e.activePlaylistLoader.pause(),e.activePlaylistLoader=null)},Np=(r,e)=>{e.activePlaylistLoader=r,r.load()},P5=(r,e)=>()=>{const{segmentLoaders:{[r]:t,main:i},mediaTypes:{[r]:s}}=e,n=s.activeTrack(),a=s.getActiveGroup(),o=s.activePlaylistLoader,l=s.lastGroup_;if(!(a&&l&&a.id===l.id)&&(s.lastGroup_=a,s.lastTrack_=n,xx(t,s),!(!a||a.isMainPlaylist))){if(!a.playlistLoader){o&&i.resetEverything();return}t.resyncLoader(),Np(a.playlistLoader,s)}},D5=(r,e)=>()=>{const{segmentLoaders:{[r]:t},mediaTypes:{[r]:i}}=e;i.lastGroup_=null,t.abort(),t.pause()},M5=(r,e)=>()=>{const{mainPlaylistLoader:t,segmentLoaders:{[r]:i,main:s},mediaTypes:{[r]:n}}=e,a=n.activeTrack(),o=n.getActiveGroup(),l=n.activePlaylistLoader,u=n.lastTrack_;if(!(u&&a&&u.id===a.id)&&(n.lastGroup_=o,n.lastTrack_=a,xx(i,n),!!o)){if(o.isMainPlaylist){if(!a||!u||a.id===u.id)return;const c=e.vhs.playlistController_,h=c.selectPlaylist();if(c.media()===h)return;n.logger_(`track change. Switching main audio from ${u.id} to ${a.id}`),t.pause(),s.resetEverything(),c.fastQualityChange_(h);return}if(r==="AUDIO"){if(!o.playlistLoader){s.setAudio(!0),s.resetEverything();return}i.setAudio(!0),s.setAudio(!1)}if(l===o.playlistLoader){Np(o.playlistLoader,n);return}i.track&&i.track(a),i.resetEverything(),Np(o.playlistLoader,n)}},th={AUDIO:(r,e)=>()=>{const{mediaTypes:{[r]:t},excludePlaylist:i}=e,s=t.activeTrack(),n=t.activeGroup(),a=(n.filter(l=>l.default)[0]||n[0]).id,o=t.tracks[a];if(s===o){i({error:{message:"Problem encountered loading the default audio track."}});return}H.log.warn("Problem encountered loading the alternate audio track.Switching back to default.");for(const l in t.tracks)t.tracks[l].enabled=t.tracks[l]===o;t.onTrackChanged()},SUBTITLES:(r,e)=>()=>{const{mediaTypes:{[r]:t}}=e;H.log.warn("Problem encountered loading the subtitle track.Disabling subtitle track.");const i=t.activeTrack();i&&(i.mode="disabled"),t.onTrackChanged()}},Sb={AUDIO:(r,e,t)=>{if(!e)return;const{tech:i,requestOptions:s,segmentLoaders:{[r]:n}}=t;e.on("loadedmetadata",()=>{const a=e.media();n.playlist(a,s),(!i.paused()||a.endList&&i.preload()!=="none")&&n.load()}),e.on("loadedplaylist",()=>{n.playlist(e.media(),s),i.paused()||n.load()}),e.on("error",th[r](r,t))},SUBTITLES:(r,e,t)=>{const{tech:i,requestOptions:s,segmentLoaders:{[r]:n},mediaTypes:{[r]:a}}=t;e.on("loadedmetadata",()=>{const o=e.media();n.playlist(o,s),n.track(a.activeTrack()),(!i.paused()||o.endList&&i.preload()!=="none")&&n.load()}),e.on("loadedplaylist",()=>{n.playlist(e.media(),s),i.paused()||n.load()}),e.on("error",th[r](r,t))}},I5={AUDIO:(r,e)=>{const{vhs:t,sourceType:i,segmentLoaders:{[r]:s},requestOptions:n,main:{mediaGroups:a},mediaTypes:{[r]:{groups:o,tracks:l,logger_:u}},mainPlaylistLoader:c}=e,h=Gl(c.main);(!a[r]||Object.keys(a[r]).length===0)&&(a[r]={main:{default:{default:!0}}},h&&(a[r].main.default.playlists=c.main.playlists));for(const f in a[r]){o[f]||(o[f]=[]);for(const m in a[r][f]){let S=a[r][f][m],y;if(h?(u(`AUDIO group '${f}' label '${m}' is a main playlist`),S.isMainPlaylist=!0,y=null):i==="vhs-json"&&S.playlists?y=new sa(S.playlists[0],t,n):S.resolvedUri?y=new sa(S.resolvedUri,t,n):S.playlists&&i==="dash"?y=new Rp(S.playlists[0],t,n,c):y=null,S=We({id:m,playlistLoader:y},S),Sb[r](r,S.playlistLoader,e),o[f].push(S),typeof l[m]>"u"){const E=new H.AudioTrack({id:m,kind:A5(S),enabled:!1,language:S.language,default:S.default,label:m});l[m]=E}}}s.on("error",th[r](r,e))},SUBTITLES:(r,e)=>{const{tech:t,vhs:i,sourceType:s,segmentLoaders:{[r]:n},requestOptions:a,main:{mediaGroups:o},mediaTypes:{[r]:{groups:l,tracks:u}},mainPlaylistLoader:c}=e;for(const h in o[r]){l[h]||(l[h]=[]);for(const f in o[r][h]){if(!i.options_.useForcedSubtitles&&o[r][h][f].forced)continue;let m=o[r][h][f],S;if(s==="hls")S=new sa(m.resolvedUri,i,a);else if(s==="dash"){if(!m.playlists.filter(E=>E.excludeUntil!==1/0).length)return;S=new Rp(m.playlists[0],i,a,c)}else s==="vhs-json"&&(S=new sa(m.playlists?m.playlists[0]:m.resolvedUri,i,a));if(m=We({id:f,playlistLoader:S},m),Sb[r](r,m.playlistLoader,e),l[h].push(m),typeof u[f]>"u"){const y=t.addRemoteTextTrack({id:f,kind:"subtitles",default:m.default&&m.autoselect,language:m.language,label:f},!1).track;u[f]=y}}}n.on("error",th[r](r,e))},"CLOSED-CAPTIONS":(r,e)=>{const{tech:t,main:{mediaGroups:i},mediaTypes:{[r]:{groups:s,tracks:n}}}=e;for(const a in i[r]){s[a]||(s[a]=[]);for(const o in i[r][a]){const l=i[r][a][o];if(!/^(?:CC|SERVICE)/.test(l.instreamId))continue;const u=t.options_.vhs&&t.options_.vhs.captionServices||{};let c={label:o,language:l.language,instreamId:l.instreamId,default:l.default&&l.autoselect};if(u[c.instreamId]&&(c=We(c,u[c.instreamId])),c.default===void 0&&delete c.default,s[a].push(We({id:o},l)),typeof n[o]>"u"){const h=t.addRemoteTextTrack({id:c.instreamId,kind:"captions",default:c.default,language:c.language,label:c.label},!1).track;n[o]=h}}}}},wx=(r,e)=>{for(let t=0;t<r.length;t++)if(Xg(e,r[t])||r[t].playlists&&wx(r[t].playlists,e))return!0;return!1},R5=(r,e)=>t=>{const{mainPlaylistLoader:i,mediaTypes:{[r]:{groups:s}}}=e,n=i.media();if(!n)return null;let a=null;n.attributes[r]&&(a=s[n.attributes[r]]);const o=Object.keys(s);if(!a)if(r==="AUDIO"&&o.length>1&&Gl(e.main))for(let l=0;l<o.length;l++){const u=s[o[l]];if(wx(u,n)){a=u;break}}else s.main?a=s.main:o.length===1&&(a=s[o[0]]);return typeof t>"u"?a:t===null||!a?null:a.filter(l=>l.id===t.id)[0]||null},L5={AUDIO:(r,e)=>()=>{const{mediaTypes:{[r]:{tracks:t}}}=e;for(const i in t)if(t[i].enabled)return t[i];return null},SUBTITLES:(r,e)=>()=>{const{mediaTypes:{[r]:{tracks:t}}}=e;for(const i in t)if(t[i].mode==="showing"||t[i].mode==="hidden")return t[i];return null}},Q5=(r,{mediaTypes:e})=>()=>{const t=e[r].activeTrack();return t?e[r].activeGroup(t):null},$5=r=>{["AUDIO","SUBTITLES","CLOSED-CAPTIONS"].forEach(u=>{I5[u](u,r)});const{mediaTypes:e,mainPlaylistLoader:t,tech:i,vhs:s,segmentLoaders:{["AUDIO"]:n,main:a}}=r;["AUDIO","SUBTITLES"].forEach(u=>{e[u].activeGroup=R5(u,r),e[u].activeTrack=L5[u](u,r),e[u].onGroupChanged=P5(u,r),e[u].onGroupChanging=D5(u,r),e[u].onTrackChanged=M5(u,r),e[u].getActiveGroup=Q5(u,r)});const o=e.AUDIO.activeGroup();if(o){const u=(o.filter(h=>h.default)[0]||o[0]).id;e.AUDIO.tracks[u].enabled=!0,e.AUDIO.onGroupChanged(),e.AUDIO.onTrackChanged(),e.AUDIO.getActiveGroup().playlistLoader?(a.setAudio(!1),n.setAudio(!0)):a.setAudio(!0)}t.on("mediachange",()=>{["AUDIO","SUBTITLES"].forEach(u=>e[u].onGroupChanged())}),t.on("mediachanging",()=>{["AUDIO","SUBTITLES"].forEach(u=>e[u].onGroupChanging())});const l=()=>{e.AUDIO.onTrackChanged(),i.trigger({type:"usage",name:"vhs-audio-change"})};i.audioTracks().addEventListener("change",l),i.remoteTextTracks().addEventListener("change",e.SUBTITLES.onTrackChanged),s.on("dispose",()=>{i.audioTracks().removeEventListener("change",l),i.remoteTextTracks().removeEventListener("change",e.SUBTITLES.onTrackChanged)}),i.clearTracks("audio");for(const u in e.AUDIO.tracks)i.audioTracks().addTrack(e.AUDIO.tracks[u])},B5=()=>{const r={};return["AUDIO","SUBTITLES","CLOSED-CAPTIONS"].forEach(e=>{r[e]={groups:{},tracks:{},activePlaylistLoader:null,activeGroup:ds,activeTrack:ds,getActiveGroup:ds,onGroupChanged:ds,onTrackChanged:ds,lastTrack_:null,logger_:ar(`MediaGroups[${e}]`)}}),r};class Tb{constructor(){this.priority_=[],this.pathwayClones_=new Map}set version(e){e===1&&(this.version_=e)}set ttl(e){this.ttl_=e||300}set reloadUri(e){e&&(this.reloadUri_=_i(this.reloadUri_,e))}set priority(e){e&&e.length&&(this.priority_=e)}set pathwayClones(e){e&&e.length&&(this.pathwayClones_=new Map(e.map(t=>[t.ID,t])))}get version(){return this.version_}get ttl(){return this.ttl_}get reloadUri(){return this.reloadUri_}get priority(){return this.priority_}get pathwayClones(){return this.pathwayClones_}}class N5 extends H.EventTarget{constructor(e,t){super(),this.currentPathway=null,this.defaultPathway=null,this.queryBeforeStart=!1,this.availablePathways_=new Set,this.steeringManifest=new Tb,this.proxyServerUrl_=null,this.manifestType_=null,this.ttlTimeout_=null,this.request_=null,this.currentPathwayClones=new Map,this.nextPathwayClones=new Map,this.excludedSteeringManifestURLs=new Set,this.logger_=ar("Content Steering"),this.xhr_=e,this.getBandwidth_=t}assignTagProperties(e,t){this.manifestType_=t.serverUri?"HLS":"DASH";const i=t.serverUri||t.serverURL;if(!i){this.logger_(`steering manifest URL is ${i}, cannot request steering manifest.`),this.trigger("error");return}if(i.startsWith("data:")){this.decodeDataUriManifest_(i.substring(i.indexOf(",")+1));return}this.steeringManifest.reloadUri=_i(e,i),this.defaultPathway=t.pathwayId||t.defaultServiceLocation,this.queryBeforeStart=t.queryBeforeStart,this.proxyServerUrl_=t.proxyServerURL,this.defaultPathway&&!this.queryBeforeStart&&this.trigger("content-steering")}requestSteeringManifest(e){const t=this.steeringManifest.reloadUri;if(!t)return;const i=e?t:this.getRequestURI(t);if(!i){this.logger_("No valid content steering manifest URIs. Stopping content steering."),this.trigger("error"),this.dispose();return}const s={contentSteeringInfo:{uri:i}};this.trigger({type:"contentsteeringloadstart",metadata:s}),this.request_=this.xhr_({uri:i,requestType:"content-steering-manifest"},(n,a)=>{if(n){if(a.status===410){this.logger_(`manifest request 410 ${n}.`),this.logger_(`There will be no more content steering requests to ${i} this session.`),this.excludedSteeringManifestURLs.add(i);return}if(a.status===429){const u=a.responseHeaders["retry-after"];this.logger_(`manifest request 429 ${n}.`),this.logger_(`content steering will retry in ${u} seconds.`),this.startTTLTimeout_(parseInt(u,10));return}this.logger_(`manifest failed to load ${n}.`),this.startTTLTimeout_();return}this.trigger({type:"contentsteeringloadcomplete",metadata:s});let o;try{o=JSON.parse(this.request_.responseText)}catch(u){const c={errorType:H.Error.StreamingContentSteeringParserError,error:u};this.trigger({type:"error",metadata:c})}this.assignSteeringProperties_(o);const l={contentSteeringInfo:s.contentSteeringInfo,contentSteeringManifest:{version:this.steeringManifest.version,reloadUri:this.steeringManifest.reloadUri,priority:this.steeringManifest.priority}};this.trigger({type:"contentsteeringparsed",metadata:l}),this.startTTLTimeout_()})}setProxyServerUrl_(e){const t=new U.URL(e),i=new U.URL(this.proxyServerUrl_);return i.searchParams.set("url",encodeURI(t.toString())),this.setSteeringParams_(i.toString())}decodeDataUriManifest_(e){const t=JSON.parse(U.atob(e));this.assignSteeringProperties_(t)}setSteeringParams_(e){const t=new U.URL(e),i=this.getPathway(),s=this.getBandwidth_();if(i){const n=`_${this.manifestType_}_pathway`;t.searchParams.set(n,i)}if(s){const n=`_${this.manifestType_}_throughput`;t.searchParams.set(n,s)}return t.toString()}assignSteeringProperties_(e){if(this.steeringManifest.version=e.VERSION,!this.steeringManifest.version){this.logger_(`manifest version is ${e.VERSION}, which is not supported.`),this.trigger("error");return}this.steeringManifest.ttl=e.TTL,this.steeringManifest.reloadUri=e["RELOAD-URI"],this.steeringManifest.priority=e["PATHWAY-PRIORITY"]||e["SERVICE-LOCATION-PRIORITY"],this.steeringManifest.pathwayClones=e["PATHWAY-CLONES"],this.nextPathwayClones=this.steeringManifest.pathwayClones,this.availablePathways_.size||(this.logger_("There are no available pathways for content steering. Ending content steering."),this.trigger("error"),this.dispose());const i=(s=>{for(const n of s)if(this.availablePathways_.has(n))return n;return[...this.availablePathways_][0]})(this.steeringManifest.priority);this.currentPathway!==i&&(this.currentPathway=i,this.trigger("content-steering"))}getPathway(){return this.currentPathway||this.defaultPathway}getRequestURI(e){if(!e)return null;const t=s=>this.excludedSteeringManifestURLs.has(s);if(this.proxyServerUrl_){const s=this.setProxyServerUrl_(e);if(!t(s))return s}const i=this.setSteeringParams_(e);return t(i)?null:i}startTTLTimeout_(e=this.steeringManifest.ttl){const t=e*1e3;this.ttlTimeout_=U.setTimeout(()=>{this.requestSteeringManifest()},t)}clearTTLTimeout_(){U.clearTimeout(this.ttlTimeout_),this.ttlTimeout_=null}abort(){this.request_&&this.request_.abort(),this.request_=null}dispose(){this.off("content-steering"),this.off("error"),this.abort(),this.clearTTLTimeout_(),this.currentPathway=null,this.defaultPathway=null,this.queryBeforeStart=null,this.proxyServerUrl_=null,this.manifestType_=null,this.ttlTimeout_=null,this.request_=null,this.excludedSteeringManifestURLs=new Set,this.availablePathways_=new Set,this.steeringManifest=new Tb}addAvailablePathway(e){e&&this.availablePathways_.add(e)}clearAvailablePathways(){this.availablePathways_.clear()}excludePathway(e){return this.availablePathways_.delete(e)}didDASHTagChange(e,t){return!t&&this.steeringManifest.reloadUri||t&&(_i(e,t.serverURL)!==this.steeringManifest.reloadUri||t.defaultServiceLocation!==this.defaultPathway||t.queryBeforeStart!==this.queryBeforeStart||t.proxyServerURL!==this.proxyServerUrl_)}getAvailablePathways(){return this.availablePathways_}}const F5=(r,e)=>{let t=null;return(...i)=>{clearTimeout(t),t=setTimeout(()=>{r.apply(null,i)},e)}},U5=10;let Is;const q5=["mediaRequests","mediaRequestsAborted","mediaRequestsTimedout","mediaRequestsErrored","mediaTransferDuration","mediaBytesTransferred","mediaAppends"],V5=function(r){return this.audioSegmentLoader_[r]+this.mainSegmentLoader_[r]},X5=function({currentPlaylist:r,buffered:e,currentTime:t,nextPlaylist:i,bufferLowWaterLine:s,bufferHighWaterLine:n,duration:a,bufferBasedABR:o,log:l}){if(!i)return H.log.warn("We received no playlist to switch to. Please check your stream."),!1;const u=`allowing switch ${r&&r.id||"null"} -> ${i.id}`;if(!r)return l(`${u} as current playlist is not set`),!0;if(i.id===r.id)return!1;const c=!!ra(e,t).length;if(!r.endList)return!c&&typeof r.partTargetDuration=="number"?(l(`not ${u} as current playlist is live llhls, but currentTime isn't in buffered.`),!1):(l(`${u} as current playlist is live`),!0);const h=Ug(e,t),f=o?Ut.EXPERIMENTAL_MAX_BUFFER_LOW_WATER_LINE:Ut.MAX_BUFFER_LOW_WATER_LINE;if(a<f)return l(`${u} as duration < max low water line (${a} < ${f})`),!0;const m=i.attributes.BANDWIDTH,S=r.attributes.BANDWIDTH;if(m<S&&(!o||h<n)){let y=`${u} as next bandwidth < current bandwidth (${m} < ${S})`;return o&&(y+=` and forwardBuffer < bufferHighWaterLine (${h} < ${n})`),l(y),!0}if((!o||m>S)&&h>=s){let y=`${u} as forwardBuffer >= bufferLowWaterLine (${h} >= ${s})`;return o&&(y+=` and next bandwidth > current bandwidth (${m} > ${S})`),l(y),!0}return l(`not ${u} as no switching criteria met`),!1};class j5 extends H.EventTarget{constructor(e){super(),this.fastQualityChange_=F5(this.fastQualityChange_.bind(this),100);const{src:t,withCredentials:i,tech:s,bandwidth:n,externVhs:a,useCueTags:o,playlistExclusionDuration:l,enableLowInitialPlaylist:u,sourceType:c,cacheEncryptionKeys:h,bufferBasedABR:f,leastPixelDiffSelector:m,captionServices:S,experimentalUseMMS:y}=e;if(!t)throw new Error("A non-empty playlist URL or JSON manifest string is required");let{maxPlaylistRetries:E}=e;(E===null||typeof E>"u")&&(E=1/0),Is=a,this.bufferBasedABR=!!f,this.leastPixelDiffSelector=!!m,this.withCredentials=i,this.tech_=s,this.vhs_=s.vhs,this.player_=e.player_,this.sourceType_=c,this.useCueTags_=o,this.playlistExclusionDuration=l,this.maxPlaylistRetries=E,this.enableLowInitialPlaylist=u,this.usingManagedMediaSource_=!1,this.useCueTags_&&(this.cueTagsTrack_=this.tech_.addTextTrack("metadata","ad-cues"),this.cueTagsTrack_.inBandMetadataTrackDispatchType=""),this.requestOptions_={withCredentials:i,maxPlaylistRetries:E,timeout:null},this.on("error",this.pauseLoading),this.mediaTypes_=B5(),y&&U.ManagedMediaSource?(this.tech_.el_.disableRemotePlayback=!0,this.mediaSource=new U.ManagedMediaSource,this.usingManagedMediaSource_=!0,H.log("Using ManagedMediaSource")):U.MediaSource&&(this.mediaSource=new U.MediaSource),this.handleDurationChange_=this.handleDurationChange_.bind(this),this.handleSourceOpen_=this.handleSourceOpen_.bind(this),this.handleSourceEnded_=this.handleSourceEnded_.bind(this),this.load=this.load.bind(this),this.pause=this.pause.bind(this),this.mediaSource.addEventListener("durationchange",this.handleDurationChange_),this.mediaSource.addEventListener("sourceopen",this.handleSourceOpen_),this.mediaSource.addEventListener("sourceended",this.handleSourceEnded_),this.mediaSource.addEventListener("startstreaming",this.load),this.mediaSource.addEventListener("endstreaming",this.pause),this.seekable_=Xt(),this.hasPlayed_=!1,this.syncController_=new w5(e),this.segmentMetadataTrack_=s.addRemoteTextTrack({kind:"metadata",label:"segment-metadata"},!1).track,this.segmentMetadataTrack_.mode="hidden",this.decrypter_=new E5,this.sourceUpdater_=new Tx(this.mediaSource),this.inbandTextTracks_={},this.timelineChangeController_=new C5,this.keyStatusMap_=new Map;const C={vhs:this.vhs_,parse708captions:e.parse708captions,useDtsForTimestampOffset:e.useDtsForTimestampOffset,captionServices:S,mediaSource:this.mediaSource,currentTime:this.tech_.currentTime.bind(this.tech_),seekable:()=>this.seekable(),seeking:()=>this.tech_.seeking(),duration:()=>this.duration(),hasPlayed:()=>this.hasPlayed_,goalBufferLength:()=>this.goalBufferLength(),bandwidth:n,syncController:this.syncController_,decrypter:this.decrypter_,sourceType:this.sourceType_,inbandTextTracks:this.inbandTextTracks_,cacheEncryptionKeys:h,sourceUpdater:this.sourceUpdater_,timelineChangeController:this.timelineChangeController_,exactManifestTimings:e.exactManifestTimings,addMetadataToTextTrack:this.addMetadataToTextTrack.bind(this)};this.mainPlaylistLoader_=this.sourceType_==="dash"?new Rp(t,this.vhs_,We(this.requestOptions_,{addMetadataToTextTrack:this.addMetadataToTextTrack.bind(this)})):new sa(t,this.vhs_,We(this.requestOptions_,{addDateRangesToTextTrack:this.addDateRangesToTextTrack_.bind(this)})),this.setupMainPlaylistLoaderListeners_(),this.mainSegmentLoader_=new $p(We(C,{segmentMetadataTrack:this.segmentMetadataTrack_,loaderType:"main"}),e),this.audioSegmentLoader_=new $p(We(C,{loaderType:"audio"}),e),this.subtitleSegmentLoader_=new v5(We(C,{loaderType:"vtt",featuresNativeTextTracks:this.tech_.featuresNativeTextTracks,loadVttJs:()=>new Promise((T,w)=>{function A(){s.off("vttjserror",I),T()}function I(){s.off("vttjsloaded",A),w()}s.one("vttjsloaded",A),s.one("vttjserror",I),s.addWebVttScript_()})}),e);const _=()=>this.mainSegmentLoader_.bandwidth;this.contentSteeringController_=new N5(this.vhs_.xhr,_),this.setupSegmentLoaderListeners_(),this.bufferBasedABR&&(this.mainPlaylistLoader_.one("loadedplaylist",()=>this.startABRTimer_()),this.tech_.on("pause",()=>this.stopABRTimer_()),this.tech_.on("play",()=>this.startABRTimer_())),q5.forEach(T=>{this[T+"_"]=V5.bind(this,T)}),this.logger_=ar("pc"),this.triggeredFmp4Usage=!1,this.tech_.preload()==="none"?(this.loadOnPlay_=()=>{this.loadOnPlay_=null,this.mainPlaylistLoader_.load()},this.tech_.one("play",this.loadOnPlay_)):this.mainPlaylistLoader_.load(),this.timeToLoadedData__=-1,this.mainAppendsToLoadedData__=-1,this.audioAppendsToLoadedData__=-1;const v=this.tech_.preload()==="none"?"play":"loadstart";this.tech_.one(v,()=>{const T=Date.now();this.tech_.one("loadeddata",()=>{this.timeToLoadedData__=Date.now()-T,this.mainAppendsToLoadedData__=this.mainSegmentLoader_.mediaAppends,this.audioAppendsToLoadedData__=this.audioSegmentLoader_.mediaAppends})})}mainAppendsToLoadedData_(){return this.mainAppendsToLoadedData__}audioAppendsToLoadedData_(){return this.audioAppendsToLoadedData__}appendsToLoadedData_(){const e=this.mainAppendsToLoadedData_(),t=this.audioAppendsToLoadedData_();return e===-1||t===-1?-1:e+t}timeToLoadedData_(){return this.timeToLoadedData__}checkABR_(e="abr"){const t=this.selectPlaylist();t&&this.shouldSwitchToMedia_(t)&&this.switchMedia_(t,e)}switchMedia_(e,t,i){const s=this.media(),n=s&&(s.id||s.uri),a=e&&(e.id||e.uri);if(n&&n!==a){this.logger_(`switch media ${n} -> ${a} from ${t}`);const o={renditionInfo:{id:a,bandwidth:e.attributes.BANDWIDTH,resolution:e.attributes.RESOLUTION,codecs:e.attributes.CODECS},cause:t};this.trigger({type:"renditionselected",metadata:o}),this.tech_.trigger({type:"usage",name:`vhs-rendition-change-${t}`})}this.mainPlaylistLoader_.media(e,i)}switchMediaForDASHContentSteering_(){["AUDIO","SUBTITLES","CLOSED-CAPTIONS"].forEach(e=>{const t=this.mediaTypes_[e],i=t?t.activeGroup():null,s=this.contentSteeringController_.getPathway();if(i&&s){const a=(i.length?i[0].playlists:i.playlists).filter(o=>o.attributes.serviceLocation===s);a.length&&this.mediaTypes_[e].activePlaylistLoader.media(a[0])}})}startABRTimer_(){this.stopABRTimer_(),this.abrTimer_=U.setInterval(()=>this.checkABR_(),250)}stopABRTimer_(){this.tech_.scrubbing&&this.tech_.scrubbing()||(U.clearInterval(this.abrTimer_),this.abrTimer_=null)}getAudioTrackPlaylists_(){const e=this.main(),t=e&&e.playlists||[];if(!e||!e.mediaGroups||!e.mediaGroups.AUDIO)return t;const i=e.mediaGroups.AUDIO,s=Object.keys(i);let n;if(Object.keys(this.mediaTypes_.AUDIO.groups).length)n=this.mediaTypes_.AUDIO.activeTrack();else{const o=i.main||s.length&&i[s[0]];for(const l in o)if(o[l].default){n={label:l};break}}if(!n)return t;const a=[];for(const o in i)if(i[o][n.label]){const l=i[o][n.label];if(l.playlists&&l.playlists.length)a.push.apply(a,l.playlists);else if(l.uri)a.push(l);else if(e.playlists.length)for(let u=0;u<e.playlists.length;u++){const c=e.playlists[u];c.attributes&&c.attributes.AUDIO&&c.attributes.AUDIO===o&&a.push(c)}}return a.length?a:t}setupMainPlaylistLoaderListeners_(){this.mainPlaylistLoader_.on("loadedmetadata",()=>{const t=this.mainPlaylistLoader_.media(),i=t.targetDuration*1.5*1e3;Ap(this.mainPlaylistLoader_.main,this.mainPlaylistLoader_.media())?this.requestOptions_.timeout=0:this.requestOptions_.timeout=i,t.endList&&this.tech_.preload()!=="none"&&(this.mainSegmentLoader_.playlist(t,this.requestOptions_),this.mainSegmentLoader_.load()),$5({sourceType:this.sourceType_,segmentLoaders:{AUDIO:this.audioSegmentLoader_,SUBTITLES:this.subtitleSegmentLoader_,main:this.mainSegmentLoader_},tech:this.tech_,requestOptions:this.requestOptions_,mainPlaylistLoader:this.mainPlaylistLoader_,vhs:this.vhs_,main:this.main(),mediaTypes:this.mediaTypes_,excludePlaylist:this.excludePlaylist.bind(this)}),this.triggerPresenceUsage_(this.main(),t),this.setupFirstPlay(),!this.mediaTypes_.AUDIO.activePlaylistLoader||this.mediaTypes_.AUDIO.activePlaylistLoader.media()?this.trigger("selectedinitialmedia"):this.mediaTypes_.AUDIO.activePlaylistLoader.one("loadedmetadata",()=>{this.trigger("selectedinitialmedia")})}),this.mainPlaylistLoader_.on("loadedplaylist",()=>{this.loadOnPlay_&&this.tech_.off("play",this.loadOnPlay_);let t=this.mainPlaylistLoader_.media();if(!t){this.attachContentSteeringListeners_(),this.initContentSteeringController_(),this.excludeUnsupportedVariants_();let i;if(this.enableLowInitialPlaylist&&(i=this.selectInitialPlaylist()),i||(i=this.selectPlaylist()),!i||!this.shouldSwitchToMedia_(i)||(this.initialMedia_=i,this.switchMedia_(this.initialMedia_,"initial"),!(this.sourceType_==="vhs-json"&&this.initialMedia_.segments)))return;t=this.initialMedia_}this.handleUpdatedMediaPlaylist(t)}),this.mainPlaylistLoader_.on("error",()=>{const t=this.mainPlaylistLoader_.error;this.excludePlaylist({playlistToExclude:t.playlist,error:t})}),this.mainPlaylistLoader_.on("mediachanging",()=>{this.mainSegmentLoader_.abort(),this.mainSegmentLoader_.pause()}),this.mainPlaylistLoader_.on("mediachange",()=>{const t=this.mainPlaylistLoader_.media(),i=t.targetDuration*1.5*1e3;Ap(this.mainPlaylistLoader_.main,this.mainPlaylistLoader_.media())?this.requestOptions_.timeout=0:this.requestOptions_.timeout=i,this.sourceType_==="dash"&&this.mainPlaylistLoader_.isPaused&&this.mainPlaylistLoader_.load(),this.mainSegmentLoader_.pause(),this.mainSegmentLoader_.playlist(t,this.requestOptions_),this.waitingForFastQualityPlaylistReceived_?this.runFastQualitySwitch_():this.mainSegmentLoader_.load(),this.tech_.trigger({type:"mediachange",bubbles:!0})}),this.mainPlaylistLoader_.on("playlistunchanged",()=>{const t=this.mainPlaylistLoader_.media();if(t.lastExcludeReason_==="playlist-unchanged")return;this.stuckAtPlaylistEnd_(t)&&(this.excludePlaylist({error:{message:"Playlist no longer updating.",reason:"playlist-unchanged"}}),this.tech_.trigger("playliststuck"))}),this.mainPlaylistLoader_.on("renditiondisabled",()=>{this.tech_.trigger({type:"usage",name:"vhs-rendition-disabled"})}),this.mainPlaylistLoader_.on("renditionenabled",()=>{this.tech_.trigger({type:"usage",name:"vhs-rendition-enabled"})}),["manifestrequeststart","manifestrequestcomplete","manifestparsestart","manifestparsecomplete","playlistrequeststart","playlistrequestcomplete","playlistparsestart","playlistparsecomplete","renditiondisabled","renditionenabled"].forEach(t=>{this.mainPlaylistLoader_.on(t,i=>{this.player_.trigger(At({},i))})})}handleUpdatedMediaPlaylist(e){this.useCueTags_&&this.updateAdCues_(e),this.mainSegmentLoader_.pause(),this.mainSegmentLoader_.playlist(e,this.requestOptions_),this.waitingForFastQualityPlaylistReceived_&&this.runFastQualitySwitch_(),this.updateDuration(!e.endList),this.tech_.paused()||(this.mainSegmentLoader_.load(),this.audioSegmentLoader_&&this.audioSegmentLoader_.load())}triggerPresenceUsage_(e,t){const i=e.mediaGroups||{};let s=!0;const n=Object.keys(i.AUDIO);for(const a in i.AUDIO)for(const o in i.AUDIO[a])i.AUDIO[a][o].uri||(s=!1);s&&this.tech_.trigger({type:"usage",name:"vhs-demuxed"}),Object.keys(i.SUBTITLES).length&&this.tech_.trigger({type:"usage",name:"vhs-webvtt"}),Is.Playlist.isAes(t)&&this.tech_.trigger({type:"usage",name:"vhs-aes"}),n.length&&Object.keys(i.AUDIO[n[0]]).length>1&&this.tech_.trigger({type:"usage",name:"vhs-alternate-audio"}),this.useCueTags_&&this.tech_.trigger({type:"usage",name:"vhs-playlist-cue-tags"})}shouldSwitchToMedia_(e){const t=this.mainPlaylistLoader_.media()||this.mainPlaylistLoader_.pendingMedia_,i=this.tech_.currentTime(),s=this.bufferLowWaterLine(),n=this.bufferHighWaterLine(),a=this.tech_.buffered();return X5({buffered:a,currentTime:i,currentPlaylist:t,nextPlaylist:e,bufferLowWaterLine:s,bufferHighWaterLine:n,duration:this.duration(),bufferBasedABR:this.bufferBasedABR,log:this.logger_})}setupSegmentLoaderListeners_(){this.mainSegmentLoader_.on("bandwidthupdate",()=>{this.checkABR_("bandwidthupdate"),this.tech_.trigger("bandwidthupdate")}),this.mainSegmentLoader_.on("timeout",()=>{this.bufferBasedABR&&this.mainSegmentLoader_.load()}),this.bufferBasedABR||this.mainSegmentLoader_.on("progress",()=>{this.trigger("progress")}),this.mainSegmentLoader_.on("error",()=>{const i=this.mainSegmentLoader_.error();this.excludePlaylist({playlistToExclude:i.playlist,error:i})}),this.mainSegmentLoader_.on("appenderror",()=>{this.error=this.mainSegmentLoader_.error_,this.trigger("error")}),this.mainSegmentLoader_.on("syncinfoupdate",()=>{this.onSyncInfoUpdate_()}),this.mainSegmentLoader_.on("timestampoffset",()=>{this.tech_.trigger({type:"usage",name:"vhs-timestamp-offset"})}),this.audioSegmentLoader_.on("syncinfoupdate",()=>{this.onSyncInfoUpdate_()}),this.audioSegmentLoader_.on("appenderror",()=>{this.error=this.audioSegmentLoader_.error_,this.trigger("error")}),this.mainSegmentLoader_.on("ended",()=>{this.logger_("main segment loader ended"),this.onEndOfStream()}),this.timelineChangeController_.on("audioTimelineBehind",()=>{const i=this.audioSegmentLoader_.pendingSegment_;if(!i||!i.segment||!i.segment.syncInfo)return;const s=i.segment.syncInfo.end+.01;this.tech_.setCurrentTime(s)}),this.timelineChangeController_.on("fixBadTimelineChange",()=>{this.logger_("Fix bad timeline change. Restarting al segment loaders..."),this.mainSegmentLoader_.pause(),this.mainSegmentLoader_.resetEverything(),this.mediaTypes_.AUDIO.activePlaylistLoader&&(this.audioSegmentLoader_.pause(),this.audioSegmentLoader_.resetEverything()),this.mediaTypes_.SUBTITLES.activePlaylistLoader&&(this.subtitleSegmentLoader_.pause(),this.subtitleSegmentLoader_.resetEverything()),this.load()}),this.mainSegmentLoader_.on("earlyabort",i=>{this.bufferBasedABR||(this.delegateLoaders_("all",["abort"]),this.excludePlaylist({error:{message:"Aborted early because there isn't enough bandwidth to complete the request without rebuffering."},playlistExclusionDuration:U5}))});const e=()=>{if(!this.sourceUpdater_.hasCreatedSourceBuffers())return this.tryToCreateSourceBuffers_();const i=this.getCodecsOrExclude_();i&&this.sourceUpdater_.addOrChangeSourceBuffers(i)};this.mainSegmentLoader_.on("trackinfo",e),this.audioSegmentLoader_.on("trackinfo",e),this.mainSegmentLoader_.on("fmp4",()=>{this.triggeredFmp4Usage||(this.tech_.trigger({type:"usage",name:"vhs-fmp4"}),this.triggeredFmp4Usage=!0)}),this.audioSegmentLoader_.on("fmp4",()=>{this.triggeredFmp4Usage||(this.tech_.trigger({type:"usage",name:"vhs-fmp4"}),this.triggeredFmp4Usage=!0)}),this.audioSegmentLoader_.on("ended",()=>{this.logger_("audioSegmentLoader ended"),this.onEndOfStream()}),["segmentselected","segmentloadstart","segmentloaded","segmentkeyloadstart","segmentkeyloadcomplete","segmentdecryptionstart","segmentdecryptioncomplete","segmenttransmuxingstart","segmenttransmuxingcomplete","segmenttransmuxingtrackinfoavailable","segmenttransmuxingtiminginfoavailable","segmentappendstart","appendsdone","bandwidthupdated","timelinechange","codecschange"].forEach(i=>{this.mainSegmentLoader_.on(i,s=>{this.player_.trigger(At({},s))}),this.audioSegmentLoader_.on(i,s=>{this.player_.trigger(At({},s))}),this.subtitleSegmentLoader_.on(i,s=>{this.player_.trigger(At({},s))})})}mediaSecondsLoaded_(){return Math.max(this.audioSegmentLoader_.mediaSecondsLoaded+this.mainSegmentLoader_.mediaSecondsLoaded)}load(){this.mainSegmentLoader_.load(),this.mediaTypes_.AUDIO.activePlaylistLoader&&this.audioSegmentLoader_.load(),this.mediaTypes_.SUBTITLES.activePlaylistLoader&&this.subtitleSegmentLoader_.load()}pause(){this.mainSegmentLoader_.pause(),this.mediaTypes_.AUDIO.activePlaylistLoader&&this.audioSegmentLoader_.pause(),this.mediaTypes_.SUBTITLES.activePlaylistLoader&&this.subtitleSegmentLoader_.pause()}fastQualityChange_(e=this.selectPlaylist()){if(e&&e===this.mainPlaylistLoader_.media()){this.logger_("skipping fastQualityChange because new media is same as old");return}this.switchMedia_(e,"fast-quality"),this.waitingForFastQualityPlaylistReceived_=!0}runFastQualitySwitch_(){this.waitingForFastQualityPlaylistReceived_=!1,this.mainSegmentLoader_.pause(),this.mainSegmentLoader_.resetEverything(),this.mediaTypes_.AUDIO.activePlaylistLoader&&(this.audioSegmentLoader_.pause(),this.audioSegmentLoader_.resetEverything()),this.mediaTypes_.SUBTITLES.activePlaylistLoader&&(this.subtitleSegmentLoader_.pause(),this.subtitleSegmentLoader_.resetEverything()),this.load()}play(){if(this.setupFirstPlay())return;this.tech_.ended()&&this.tech_.setCurrentTime(0),this.hasPlayed_&&this.load();const e=this.tech_.seekable();if(this.tech_.duration()===1/0&&this.tech_.currentTime()<e.start(0))return this.tech_.setCurrentTime(e.end(e.length-1))}setupFirstPlay(){const e=this.mainPlaylistLoader_.media();if(!e||this.tech_.paused()||this.hasPlayed_)return!1;if(!e.endList||e.start){const t=this.seekable();if(!t.length)return!1;const i=t.end(0);let s=i;if(e.start){const n=e.start.timeOffset;n<0?s=Math.max(i+n,t.start(0)):s=Math.min(i,n)}this.trigger("firstplay"),this.tech_.setCurrentTime(s)}return this.hasPlayed_=!0,this.load(),!0}handleSourceOpen_(){if(this.tryToCreateSourceBuffers_(),this.tech_.autoplay()){const e=this.tech_.play();typeof e<"u"&&typeof e.then=="function"&&e.then(null,t=>{})}this.trigger("sourceopen")}handleSourceEnded_(){if(!this.inbandTextTracks_.metadataTrack_)return;const e=this.inbandTextTracks_.metadataTrack_.cues;if(!e||!e.length)return;const t=this.duration();e[e.length-1].endTime=isNaN(t)||Math.abs(t)===1/0?Number.MAX_VALUE:t}handleDurationChange_(){this.tech_.trigger("durationchange")}onEndOfStream(){let e=this.mainSegmentLoader_.ended_;if(this.mediaTypes_.AUDIO.activePlaylistLoader){const t=this.mainSegmentLoader_.getCurrentMediaInfo_();!t||t.hasVideo?e=e&&this.audioSegmentLoader_.ended_:e=this.audioSegmentLoader_.ended_}e&&(this.stopABRTimer_(),this.sourceUpdater_.endOfStream())}stuckAtPlaylistEnd_(e){if(!this.seekable().length)return!1;const i=this.syncController_.getExpiredTime(e,this.duration());if(i===null)return!1;const s=Is.Playlist.playlistEnd(e,i),n=this.tech_.currentTime(),a=this.tech_.buffered();if(!a.length)return s-n<=Fr;const o=a.end(a.length-1);return o-n<=Fr&&s-o<=Fr}excludePlaylist({playlistToExclude:e=this.mainPlaylistLoader_.media(),error:t={},playlistExclusionDuration:i}){if(e=e||this.mainPlaylistLoader_.media(),i=i||t.playlistExclusionDuration||this.playlistExclusionDuration,!e){this.error=t,this.mediaSource.readyState!=="open"?this.trigger("error"):this.sourceUpdater_.endOfStream("network");return}e.playlistErrors_++;const s=this.mainPlaylistLoader_.main.playlists,n=s.filter(sd),a=n.length===1&&n[0]===e;if(s.length===1&&i!==1/0)return H.log.warn(`Problem encountered with playlist ${e.id}. Trying again since it is the only playlist.`),this.tech_.trigger("retryplaylist"),this.mainPlaylistLoader_.load(a);if(a){if(this.main().contentSteering){const S=this.pathwayAttribute_(e),y=this.contentSteeringController_.steeringManifest.ttl*1e3;this.contentSteeringController_.excludePathway(S),this.excludeThenChangePathway_(),setTimeout(()=>{this.contentSteeringController_.addAvailablePathway(S)},y);return}let m=!1;s.forEach(S=>{if(S===e)return;const y=S.excludeUntil;typeof y<"u"&&y!==1/0&&(m=!0,delete S.excludeUntil)}),m&&(H.log.warn("Removing other playlists from the exclusion list because the last rendition is about to be excluded."),this.tech_.trigger("retryplaylist"))}let o;e.playlistErrors_>this.maxPlaylistRetries?o=1/0:o=Date.now()+i*1e3,e.excludeUntil=o,t.reason&&(e.lastExcludeReason_=t.reason),this.tech_.trigger("excludeplaylist"),this.tech_.trigger({type:"usage",name:"vhs-rendition-excluded"});const l=this.selectPlaylist();if(!l){this.error="Playback cannot continue. No available working or supported playlists.",this.trigger("error");return}const u=t.internal?this.logger_:H.log.warn,c=t.message?" "+t.message:"";u(`${t.internal?"Internal problem":"Problem"} encountered with playlist ${e.id}.${c} Switching to playlist ${l.id}.`),l.attributes.AUDIO!==e.attributes.AUDIO&&this.delegateLoaders_("audio",["abort","pause"]),l.attributes.SUBTITLES!==e.attributes.SUBTITLES&&this.delegateLoaders_("subtitle",["abort","pause"]),this.delegateLoaders_("main",["abort","pause"]);const h=l.targetDuration/2*1e3||5*1e3,f=typeof l.lastRequest=="number"&&Date.now()-l.lastRequest<=h;return this.switchMedia_(l,"exclude",a||f)}pauseLoading(){this.delegateLoaders_("all",["abort","pause"]),this.stopABRTimer_()}delegateLoaders_(e,t){const i=[],s=e==="all";(s||e==="main")&&i.push(this.mainPlaylistLoader_);const n=[];(s||e==="audio")&&n.push("AUDIO"),(s||e==="subtitle")&&(n.push("CLOSED-CAPTIONS"),n.push("SUBTITLES")),n.forEach(a=>{const o=this.mediaTypes_[a]&&this.mediaTypes_[a].activePlaylistLoader;o&&i.push(o)}),["main","audio","subtitle"].forEach(a=>{const o=this[`${a}SegmentLoader_`];o&&(e===a||e==="all")&&i.push(o)}),i.forEach(a=>t.forEach(o=>{typeof a[o]=="function"&&a[o]()}))}setCurrentTime(e){const t=ra(this.tech_.buffered(),e);if(!(this.mainPlaylistLoader_&&this.mainPlaylistLoader_.media())||!this.mainPlaylistLoader_.media().segments)return 0;if(t&&t.length)return e;this.mainSegmentLoader_.pause(),this.mainSegmentLoader_.resetEverything(),this.mediaTypes_.AUDIO.activePlaylistLoader&&(this.audioSegmentLoader_.pause(),this.audioSegmentLoader_.resetEverything()),this.mediaTypes_.SUBTITLES.activePlaylistLoader&&(this.subtitleSegmentLoader_.pause(),this.subtitleSegmentLoader_.resetEverything()),this.load()}duration(){if(!this.mainPlaylistLoader_)return 0;const e=this.mainPlaylistLoader_.media();return e?e.endList?this.mediaSource?this.mediaSource.duration:Is.Playlist.duration(e):1/0:0}seekable(){return this.seekable_}getSeekableRange_(e,t){const i=e.media();if(!i)return null;const s=this.syncController_.getMediaSequenceSync(t);if(s&&s.isReliable){const o=s.start,l=s.end;if(!isFinite(o)||!isFinite(l))return null;const u=Is.Playlist.liveEdgeDelay(this.mainPlaylistLoader_.main,i),c=Math.max(o,l-u);return Xt([[o,c]])}const n=this.syncController_.getExpiredTime(i,this.duration());if(n===null)return null;const a=Is.Playlist.seekable(i,n,Is.Playlist.liveEdgeDelay(this.mainPlaylistLoader_.main,i));return a.length?a:null}computeFinalSeekable_(e,t){if(!t)return e;const i=e.start(0),s=e.end(0),n=t.start(0),a=t.end(0);return n>s||i>a?e:Xt([[Math.max(i,n),Math.min(s,a)]])}onSyncInfoUpdate_(){if(!this.mainPlaylistLoader_)return;const e=this.getSeekableRange_(this.mainPlaylistLoader_,"main");if(!e)return;let t;if(this.mediaTypes_.AUDIO.activePlaylistLoader&&(t=this.getSeekableRange_(this.mediaTypes_.AUDIO.activePlaylistLoader,"audio"),!t))return;const i=this.seekable_;if(this.seekable_=this.computeFinalSeekable_(e,t),!this.seekable_||i&&i.length&&this.seekable_.length&&i.start(0)===this.seekable_.start(0)&&i.end(0)===this.seekable_.end(0))return;this.logger_(`seekable updated [${L_(this.seekable_)}]`);const s={seekableRanges:this.seekable_};this.trigger({type:"seekablerangeschanged",metadata:s}),this.tech_.trigger("seekablechanged")}updateDuration(e){if(this.updateDuration_&&(this.mediaSource.removeEventListener("sourceopen",this.updateDuration_),this.updateDuration_=null),this.mediaSource.readyState!=="open"){this.updateDuration_=this.updateDuration.bind(this,e),this.mediaSource.addEventListener("sourceopen",this.updateDuration_);return}if(e){const s=this.seekable();if(!s.length)return;(isNaN(this.mediaSource.duration)||this.mediaSource.duration<s.end(s.length-1))&&this.sourceUpdater_.setDuration(s.end(s.length-1));return}const t=this.tech_.buffered();let i=Is.Playlist.duration(this.mainPlaylistLoader_.media());t.length>0&&(i=Math.max(i,t.end(t.length-1))),this.mediaSource.duration!==i&&this.sourceUpdater_.setDuration(i)}dispose(){this.trigger("dispose"),this.decrypter_.terminate(),this.mainPlaylistLoader_.dispose(),this.mainSegmentLoader_.dispose(),this.contentSteeringController_.dispose(),this.keyStatusMap_.clear(),this.loadOnPlay_&&this.tech_.off("play",this.loadOnPlay_),["AUDIO","SUBTITLES"].forEach(e=>{const t=this.mediaTypes_[e].groups;for(const i in t)t[i].forEach(s=>{s.playlistLoader&&s.playlistLoader.dispose()})}),this.audioSegmentLoader_.dispose(),this.subtitleSegmentLoader_.dispose(),this.sourceUpdater_.dispose(),this.timelineChangeController_.dispose(),this.stopABRTimer_(),this.updateDuration_&&this.mediaSource.removeEventListener("sourceopen",this.updateDuration_),this.mediaSource.removeEventListener("durationchange",this.handleDurationChange_),this.mediaSource.removeEventListener("sourceopen",this.handleSourceOpen_),this.mediaSource.removeEventListener("sourceended",this.handleSourceEnded_),this.off()}main(){return this.mainPlaylistLoader_.main}media(){return this.mainPlaylistLoader_.media()||this.initialMedia_}areMediaTypesKnown_(){const e=!!this.mediaTypes_.AUDIO.activePlaylistLoader,t=!!this.mainSegmentLoader_.getCurrentMediaInfo_(),i=e?!!this.audioSegmentLoader_.getCurrentMediaInfo_():!0;return!(!t||!i)}getCodecsOrExclude_(){const e={main:this.mainSegmentLoader_.getCurrentMediaInfo_()||{},audio:this.audioSegmentLoader_.getCurrentMediaInfo_()||{}},t=this.mainSegmentLoader_.getPendingSegmentPlaylist()||this.media();e.video=e.main;const i=Jo(this.main(),t),s={},n=!!this.mediaTypes_.AUDIO.activePlaylistLoader;if(e.main.hasVideo&&(s.video=i.video||e.main.videoCodec||II),e.main.isMuxed&&(s.video+=`,${i.audio||e.main.audioCodec||hy}`),(e.main.hasAudio&&!e.main.isMuxed||e.audio.hasAudio||n)&&(s.audio=i.audio||e.main.audioCodec||e.audio.audioCodec||hy,e.audio.isFmp4=e.main.hasAudio&&!e.main.isMuxed?e.main.isFmp4:e.audio.isFmp4),!s.audio&&!s.video){this.excludePlaylist({playlistToExclude:t,error:{message:"Could not determine codecs for playlist."},playlistExclusionDuration:1/0});return}const a=(u,c)=>u?Wo(c,this.usingManagedMediaSource_):Hd(c),o={};let l;if(["video","audio"].forEach(function(u){if(s.hasOwnProperty(u)&&!a(e[u].isFmp4,s[u])){const c=e[u].isFmp4?"browser":"muxer";o[c]=o[c]||[],o[c].push(s[u]),u==="audio"&&(l=c)}}),n&&l&&t.attributes.AUDIO){const u=t.attributes.AUDIO;this.main().playlists.forEach(c=>{(c.attributes&&c.attributes.AUDIO)===u&&c!==t&&(c.excludeUntil=1/0)}),this.logger_(`excluding audio group ${u} as ${l} does not support codec(s): "${s.audio}"`)}if(Object.keys(o).length){const u=Object.keys(o).reduce((c,h)=>(c&&(c+=", "),c+=`${h} does not support codec(s): "${o[h].join(",")}"`,c),"")+".";this.excludePlaylist({playlistToExclude:t,error:{internal:!0,message:u},playlistExclusionDuration:1/0});return}if(this.sourceUpdater_.hasCreatedSourceBuffers()&&!this.sourceUpdater_.canChangeType()){const u=[];if(["video","audio"].forEach(c=>{const h=(Ir(this.sourceUpdater_.codecs[c]||"")[0]||{}).type,f=(Ir(s[c]||"")[0]||{}).type;h&&f&&h.toLowerCase()!==f.toLowerCase()&&u.push(`"${this.sourceUpdater_.codecs[c]}" -> "${s[c]}"`)}),u.length){this.excludePlaylist({playlistToExclude:t,error:{message:`Codec switching not supported: ${u.join(", ")}.`,internal:!0},playlistExclusionDuration:1/0});return}}return s}tryToCreateSourceBuffers_(){if(this.mediaSource.readyState!=="open"||this.sourceUpdater_.hasCreatedSourceBuffers()||!this.areMediaTypesKnown_())return;const e=this.getCodecsOrExclude_();if(!e)return;this.sourceUpdater_.createSourceBuffers(e);const t=[e.video,e.audio].filter(Boolean).join(",");this.excludeIncompatibleVariants_(t)}excludeUnsupportedVariants_(){const e=this.main().playlists,t=[];Object.keys(e).forEach(i=>{const s=e[i];if(t.indexOf(s.id)!==-1)return;t.push(s.id);const n=Jo(this.main,s),a=[];n.audio&&!Hd(n.audio)&&!Wo(n.audio,this.usingManagedMediaSource_)&&a.push(`audio codec ${n.audio}`),n.video&&!Hd(n.video)&&!Wo(n.video,this.usingManagedMediaSource_)&&a.push(`video codec ${n.video}`),n.text&&n.text==="stpp.ttml.im1t"&&a.push(`text codec ${n.text}`),a.length&&(s.excludeUntil=1/0,this.logger_(`excluding ${s.id} for unsupported: ${a.join(", ")}`))})}excludeIncompatibleVariants_(e){const t=[],i=this.main().playlists,s=gl(Ir(e)),n=sb(s),a=s.video&&Ir(s.video)[0]||null,o=s.audio&&Ir(s.audio)[0]||null;Object.keys(i).forEach(l=>{const u=i[l];if(t.indexOf(u.id)!==-1||u.excludeUntil===1/0)return;t.push(u.id);const c=[],h=Jo(this.mainPlaylistLoader_.main,u),f=sb(h);if(!(!h.audio&&!h.video)){if(f!==n&&c.push(`codec count "${f}" !== "${n}"`),!this.sourceUpdater_.canChangeType()){const m=h.video&&Ir(h.video)[0]||null,S=h.audio&&Ir(h.audio)[0]||null;m&&a&&m.type.toLowerCase()!==a.type.toLowerCase()&&c.push(`video codec "${m.type}" !== "${a.type}"`),S&&o&&S.type.toLowerCase()!==o.type.toLowerCase()&&c.push(`audio codec "${S.type}" !== "${o.type}"`)}c.length&&(u.excludeUntil=1/0,this.logger_(`excluding ${u.id}: ${c.join(" && ")}`))}})}updateAdCues_(e){let t=0;const i=this.seekable();i.length&&(t=i.start(0)),T5(e,this.cueTagsTrack_,t)}goalBufferLength(){const e=this.tech_.currentTime(),t=Ut.GOAL_BUFFER_LENGTH,i=Ut.GOAL_BUFFER_LENGTH_RATE,s=Math.max(t,Ut.MAX_GOAL_BUFFER_LENGTH);return Math.min(t+e*i,s)}bufferLowWaterLine(){const e=this.tech_.currentTime(),t=Ut.BUFFER_LOW_WATER_LINE,i=Ut.BUFFER_LOW_WATER_LINE_RATE,s=Math.max(t,Ut.MAX_BUFFER_LOW_WATER_LINE),n=Math.max(t,Ut.EXPERIMENTAL_MAX_BUFFER_LOW_WATER_LINE);return Math.min(t+e*i,this.bufferBasedABR?n:s)}bufferHighWaterLine(){return Ut.BUFFER_HIGH_WATER_LINE}addDateRangesToTextTrack_(e){db(this.inbandTextTracks_,"com.apple.streaming",this.tech_),t5({inbandTextTracks:this.inbandTextTracks_,dateRanges:e})}addMetadataToTextTrack(e,t,i){const s=this.sourceUpdater_.videoBuffer?this.sourceUpdater_.videoTimestampOffset():this.sourceUpdater_.audioTimestampOffset();db(this.inbandTextTracks_,e,this.tech_),K$({inbandTextTracks:this.inbandTextTracks_,metadataArray:t,timestampOffset:s,videoDuration:i})}pathwayAttribute_(e){return e.attributes["PATHWAY-ID"]||e.attributes.serviceLocation}initContentSteeringController_(){const e=this.main();if(e.contentSteering){for(const t of e.playlists)this.contentSteeringController_.addAvailablePathway(this.pathwayAttribute_(t));if(this.contentSteeringController_.assignTagProperties(e.uri,e.contentSteering),this.contentSteeringController_.queryBeforeStart){this.contentSteeringController_.requestSteeringManifest(!0);return}this.tech_.one("canplay",()=>{this.contentSteeringController_.requestSteeringManifest()})}}resetContentSteeringController_(){this.contentSteeringController_.clearAvailablePathways(),this.contentSteeringController_.dispose(),this.initContentSteeringController_()}attachContentSteeringListeners_(){this.contentSteeringController_.on("content-steering",this.excludeThenChangePathway_.bind(this)),["contentsteeringloadstart","contentsteeringloadcomplete","contentsteeringparsed"].forEach(t=>{this.contentSteeringController_.on(t,i=>{this.trigger(At({},i))})}),this.sourceType_==="dash"&&this.mainPlaylistLoader_.on("loadedplaylist",()=>{const t=this.main();(this.contentSteeringController_.didDASHTagChange(t.uri,t.contentSteering)||(()=>{const n=this.contentSteeringController_.getAvailablePathways(),a=[];for(const o of t.playlists){const l=o.attributes.serviceLocation;if(l&&(a.push(l),!n.has(l)))return!0}return!!(!a.length&&n.size)})())&&this.resetContentSteeringController_()})}excludeThenChangePathway_(){const e=this.contentSteeringController_.getPathway();if(!e)return;this.handlePathwayClones_();const i=this.main().playlists,s=new Set;let n=!1;Object.keys(i).forEach(a=>{const o=i[a],l=this.pathwayAttribute_(o),u=l&&e!==l;o.excludeUntil===1/0&&o.lastExcludeReason_==="content-steering"&&!u&&(delete o.excludeUntil,delete o.lastExcludeReason_,n=!0);const h=!o.excludeUntil&&o.excludeUntil!==1/0;!s.has(o.id)&&u&&h&&(s.add(o.id),o.excludeUntil=1/0,o.lastExcludeReason_="content-steering",this.logger_(`excluding ${o.id} for ${o.lastExcludeReason_}`))}),this.contentSteeringController_.manifestType_==="DASH"&&Object.keys(this.mediaTypes_).forEach(a=>{const o=this.mediaTypes_[a];if(o.activePlaylistLoader){const l=o.activePlaylistLoader.media_;l&&l.attributes.serviceLocation!==e&&(n=!0)}}),n&&this.changeSegmentPathway_()}handlePathwayClones_(){const t=this.main().playlists,i=this.contentSteeringController_.currentPathwayClones,s=this.contentSteeringController_.nextPathwayClones;if(i&&i.size||s&&s.size){for(const[a,o]of i.entries())s.get(a)||(this.mainPlaylistLoader_.updateOrDeleteClone(o),this.contentSteeringController_.excludePathway(a));for(const[a,o]of s.entries()){const l=i.get(a);if(!l){t.filter(c=>c.attributes["PATHWAY-ID"]===o["BASE-ID"]).forEach(c=>{this.mainPlaylistLoader_.addClonePathway(o,c)}),this.contentSteeringController_.addAvailablePathway(a);continue}this.equalPathwayClones_(l,o)||(this.mainPlaylistLoader_.updateOrDeleteClone(o,!0),this.contentSteeringController_.addAvailablePathway(a))}this.contentSteeringController_.currentPathwayClones=new Map(JSON.parse(JSON.stringify([...s])))}}equalPathwayClones_(e,t){if(e["BASE-ID"]!==t["BASE-ID"]||e.ID!==t.ID||e["URI-REPLACEMENT"].HOST!==t["URI-REPLACEMENT"].HOST)return!1;const i=e["URI-REPLACEMENT"].PARAMS,s=t["URI-REPLACEMENT"].PARAMS;for(const n in i)if(i[n]!==s[n])return!1;for(const n in s)if(i[n]!==s[n])return!1;return!0}changeSegmentPathway_(){const e=this.selectPlaylist();this.pauseLoading(),this.contentSteeringController_.manifestType_==="DASH"&&this.switchMediaForDASHContentSteering_(),this.switchMedia_(e,"content-steering")}excludeNonUsablePlaylistsByKeyId_(){if(!this.mainPlaylistLoader_||!this.mainPlaylistLoader_.main)return;let e=0;const t="non-usable";this.mainPlaylistLoader_.main.playlists.forEach(i=>{const s=this.mainPlaylistLoader_.getKeyIdSet(i);!s||!s.size||s.forEach(n=>{const a="usable",o=this.keyStatusMap_.has(n)&&this.keyStatusMap_.get(n)===a,l=i.lastExcludeReason_===t&&i.excludeUntil===1/0;o?o&&l&&(delete i.excludeUntil,delete i.lastExcludeReason_,this.logger_(`enabling playlist ${i.id} because key ID ${n} is ${a}`)):(i.excludeUntil!==1/0&&i.lastExcludeReason_!==t&&(i.excludeUntil=1/0,i.lastExcludeReason_=t,this.logger_(`excluding playlist ${i.id} because the key ID ${n} doesn't exist in the keyStatusMap or is not ${a}`)),e++)})}),e>=this.mainPlaylistLoader_.main.playlists.length&&this.mainPlaylistLoader_.main.playlists.forEach(i=>{const s=i&&i.attributes&&i.attributes.RESOLUTION&&i.attributes.RESOLUTION.height<720,n=i.excludeUntil===1/0&&i.lastExcludeReason_===t;s&&n&&(delete i.excludeUntil,H.log.warn(`enabling non-HD playlist ${i.id} because all playlists were excluded due to ${t} key IDs`))})}addKeyStatus_(e,t){const n=(typeof e=="string"?e:y5(e)).slice(0,32).toLowerCase();this.logger_(`KeyStatus '${t}' with key ID ${n} added to the keyStatusMap`),this.keyStatusMap_.set(n,t)}updatePlaylistByKeyStatus(e,t){this.addKeyStatus_(e,t),this.waitingForFastQualityPlaylistReceived_||this.excludeNonUsableThenChangePlaylist_(),this.mainPlaylistLoader_.off("loadedplaylist",this.excludeNonUsableThenChangePlaylist_.bind(this)),this.mainPlaylistLoader_.on("loadedplaylist",this.excludeNonUsableThenChangePlaylist_.bind(this))}excludeNonUsableThenChangePlaylist_(){this.excludeNonUsablePlaylistsByKeyId_(),this.fastQualityChange_()}}const z5=(r,e,t)=>i=>{const s=r.main.playlists[e],n=Vg(s),a=sd(s);if(typeof i>"u")return a;i?delete s.disabled:s.disabled=!0;const o={renditionInfo:{id:e,bandwidth:s.attributes.BANDWIDTH,resolution:s.attributes.RESOLUTION,codecs:s.attributes.CODECS},cause:"fast-quality"};return i!==a&&!n&&(i?(t(s),r.trigger({type:"renditionenabled",metadata:o})):r.trigger({type:"renditiondisabled",metadata:o})),i};class Z5{constructor(e,t,i){const{playlistController_:s}=e,n=s.fastQualityChange_.bind(s);if(t.attributes){const a=t.attributes.RESOLUTION;this.width=a&&a.width,this.height=a&&a.height,this.bandwidth=t.attributes.BANDWIDTH,this.frameRate=t.attributes["FRAME-RATE"]}this.codecs=Jo(s.main(),t),this.playlist=t,this.id=i,this.enabled=z5(e.playlists,t.id,n)}}const W5=function(r){r.representations=()=>{const e=r.playlistController_.main(),t=Gl(e)?r.playlistController_.getAudioTrackPlaylists_():e.playlists;return t?t.filter(i=>!Vg(i)).map((i,s)=>new Z5(r,i,i.id)):[]}},_b=["seeking","seeked","pause","playing","error"];class H5 extends H.EventTarget{constructor(e){super(),this.playlistController_=e.playlistController,this.tech_=e.tech,this.seekable=e.seekable,this.allowSeeksWithinUnsafeLiveWindow=e.allowSeeksWithinUnsafeLiveWindow,this.liveRangeSafeTimeDelta=e.liveRangeSafeTimeDelta,this.media=e.media,this.playedRanges_=[],this.consecutiveUpdates=0,this.lastRecordedTime=null,this.checkCurrentTimeTimeout_=null,this.logger_=ar("PlaybackWatcher"),this.logger_("initialize");const t=()=>this.monitorCurrentTime_(),i=()=>this.monitorCurrentTime_(),s=()=>this.techWaiting_(),n=()=>this.resetTimeUpdate_(),a=this.playlistController_,o=["main","subtitle","audio"],l={};o.forEach(c=>{l[c]={reset:()=>this.resetSegmentDownloads_(c),updateend:()=>this.checkSegmentDownloads_(c)},a[`${c}SegmentLoader_`].on("appendsdone",l[c].updateend),a[`${c}SegmentLoader_`].on("playlistupdate",l[c].reset),this.tech_.on(["seeked","seeking"],l[c].reset)});const u=c=>{["main","audio"].forEach(h=>{a[`${h}SegmentLoader_`][c]("appended",this.seekingAppendCheck_)})};this.seekingAppendCheck_=()=>{this.fixesBadSeeks_()&&(this.consecutiveUpdates=0,this.lastRecordedTime=this.tech_.currentTime(),u("off"))},this.clearSeekingAppendCheck_=()=>u("off"),this.watchForBadSeeking_=()=>{this.clearSeekingAppendCheck_(),u("on")},this.tech_.on("seeked",this.clearSeekingAppendCheck_),this.tech_.on("seeking",this.watchForBadSeeking_),this.tech_.on("waiting",s),this.tech_.on(_b,n),this.tech_.on("canplay",i),this.tech_.one("play",t),this.dispose=()=>{this.clearSeekingAppendCheck_(),this.logger_("dispose"),this.tech_.off("waiting",s),this.tech_.off(_b,n),this.tech_.off("canplay",i),this.tech_.off("play",t),this.tech_.off("seeking",this.watchForBadSeeking_),this.tech_.off("seeked",this.clearSeekingAppendCheck_),o.forEach(c=>{a[`${c}SegmentLoader_`].off("appendsdone",l[c].updateend),a[`${c}SegmentLoader_`].off("playlistupdate",l[c].reset),this.tech_.off(["seeked","seeking"],l[c].reset)}),this.checkCurrentTimeTimeout_&&U.clearTimeout(this.checkCurrentTimeTimeout_),this.resetTimeUpdate_()}}monitorCurrentTime_(){this.checkCurrentTime_(),this.checkCurrentTimeTimeout_&&U.clearTimeout(this.checkCurrentTimeTimeout_),this.checkCurrentTimeTimeout_=U.setTimeout(this.monitorCurrentTime_.bind(this),250)}resetSegmentDownloads_(e){const t=this.playlistController_[`${e}SegmentLoader_`];this[`${e}StalledDownloads_`]>0&&this.logger_(`resetting possible stalled download count for ${e} loader`),this[`${e}StalledDownloads_`]=0,this[`${e}Buffered_`]=t.buffered_()}checkSegmentDownloads_(e){const t=this.playlistController_,i=t[`${e}SegmentLoader_`],s=i.buffered_(),n=RQ(this[`${e}Buffered_`],s);if(this[`${e}Buffered_`]=s,n){const a={bufferedRanges:s};t.trigger({type:"bufferedrangeschanged",metadata:a}),this.resetSegmentDownloads_(e);return}this[`${e}StalledDownloads_`]++,this.logger_(`found #${this[`${e}StalledDownloads_`]} ${e} appends that did not increase buffer (possible stalled download)`,{playlistId:i.playlist_&&i.playlist_.id,buffered:bn(s)}),!(this[`${e}StalledDownloads_`]<10)&&(this.logger_(`${e} loader stalled download exclusion`),this.resetSegmentDownloads_(e),this.tech_.trigger({type:"usage",name:`vhs-${e}-download-exclusion`}),e!=="subtitle"&&t.excludePlaylist({error:{message:`Excessive ${e} segment downloading detected.`},playlistExclusionDuration:1/0}))}checkCurrentTime_(){if(this.tech_.paused()||this.tech_.seeking())return;const e=this.tech_.currentTime(),t=this.tech_.buffered();if(this.lastRecordedTime===e&&(!t.length||e+Fr>=t.end(t.length-1)))return this.techWaiting_();if(this.consecutiveUpdates>=5&&e===this.lastRecordedTime)this.consecutiveUpdates++,this.waiting_();else if(e===this.lastRecordedTime)this.consecutiveUpdates++;else{this.playedRanges_.push(Xt([this.lastRecordedTime,e]));const i={playedRanges:this.playedRanges_};this.playlistController_.trigger({type:"playedrangeschanged",metadata:i}),this.consecutiveUpdates=0,this.lastRecordedTime=e}}resetTimeUpdate_(){this.consecutiveUpdates=0}fixesBadSeeks_(){if(!this.tech_.seeking())return!1;const t=this.seekable(),i=this.tech_.currentTime(),s=this.afterSeekableWindow_(t,i,this.media(),this.allowSeeksWithinUnsafeLiveWindow);let n;if(s&&(n=t.end(t.length-1)),this.beforeSeekableWindow_(t,i)){const S=t.start(0);n=S+(S===t.end(0)?0:Fr)}if(typeof n<"u")return this.logger_(`Trying to seek outside of seekable at time ${i} with seekable range ${L_(t)}. Seeking to ${n}.`),this.tech_.setCurrentTime(n),!0;const a=this.playlistController_.sourceUpdater_,o=this.tech_.buffered(),l=a.audioBuffer?a.audioBuffered():null,u=a.videoBuffer?a.videoBuffered():null,c=this.media(),h=c.partTargetDuration?c.partTargetDuration:(c.targetDuration-Nr)*2,f=[l,u];for(let S=0;S<f.length;S++){if(!f[S])continue;if(Ug(f[S],i)<h)return!1}const m=Nu(o,i);return m.length===0?!1:(n=m.start(0)+Fr,this.logger_(`Buffered region starts (${m.start(0)})  just beyond seek point (${i}). Seeking to ${n}.`),this.tech_.setCurrentTime(n),!0)}waiting_(){if(this.techWaiting_())return;const e=this.tech_.currentTime(),t=this.tech_.buffered(),i=ra(t,e);if(i.length&&e+3<=i.end(0)){this.resetTimeUpdate_(),this.tech_.setCurrentTime(e),this.logger_(`Stopped at ${e} while inside a buffered region [${i.start(0)} -> ${i.end(0)}]. Attempting to resume playback by seeking to the current time.`),this.tech_.trigger({type:"usage",name:"vhs-unknown-waiting"});return}}techWaiting_(){const e=this.seekable(),t=this.tech_.currentTime();if(this.tech_.seeking())return!0;if(this.beforeSeekableWindow_(e,t)){const o=e.end(e.length-1);return this.logger_(`Fell out of live window at time ${t}. Seeking to live point (seekable end) ${o}`),this.resetTimeUpdate_(),this.tech_.setCurrentTime(o),this.tech_.trigger({type:"usage",name:"vhs-live-resync"}),!0}const i=this.tech_.vhs.playlistController_.sourceUpdater_,s=this.tech_.buffered();if(this.videoUnderflow_({audioBuffered:i.audioBuffered(),videoBuffered:i.videoBuffered(),currentTime:t}))return this.resetTimeUpdate_(),this.tech_.setCurrentTime(t),this.tech_.trigger({type:"usage",name:"vhs-video-underflow"}),!0;const a=Nu(s,t);return a.length>0?(this.logger_(`Stopped at ${t} and seeking to ${a.start(0)}`),this.resetTimeUpdate_(),this.skipTheGap_(t),!0):!1}afterSeekableWindow_(e,t,i,s=!1){if(!e.length)return!1;let n=e.end(e.length-1)+Fr;const a=!i.endList,o=typeof i.partTargetDuration=="number";return a&&(o||s)&&(n=e.end(e.length-1)+i.targetDuration*3),t>n}beforeSeekableWindow_(e,t){return!!(e.length&&e.start(0)>0&&t<e.start(0)-this.liveRangeSafeTimeDelta)}videoUnderflow_({videoBuffered:e,audioBuffered:t,currentTime:i}){if(!e)return;let s;if(e.length&&t.length){const n=ra(e,i-3),a=ra(e,i),o=ra(t,i);o.length&&!a.length&&n.length&&(s={start:n.end(0),end:o.end(0)})}else Nu(e,i).length||(s=this.gapFromVideoUnderflow_(e,i));return s?(this.logger_(`Encountered a gap in video from ${s.start} to ${s.end}. Seeking to current time ${i}`),!0):!1}skipTheGap_(e){const t=this.tech_.buffered(),i=this.tech_.currentTime(),s=Nu(t,i);if(this.resetTimeUpdate_(),s.length===0||i!==e)return;this.logger_("skipTheGap_:","currentTime:",i,"scheduled currentTime:",e,"nextRange start:",s.start(0)),this.tech_.setCurrentTime(s.start(0)+Nr);const n={gapInfo:{from:i,to:s.start(0)}};this.playlistController_.trigger({type:"gapjumped",metadata:n}),this.tech_.trigger({type:"usage",name:"vhs-gap-skip"})}gapFromVideoUnderflow_(e,t){const i=DQ(e);for(let s=0;s<i.length;s++){const n=i.start(s),a=i.end(s);if(t-n<4&&t-n>2)return{start:n,end:a}}return null}}const Y5={errorInterval:30,getSource(r){const t=this.tech({IWillNotUseThisInPlugins:!0}).currentSource_||this.currentSource();return r(t)}},Cx=function(r,e){let t=0,i=0;const s=We(Y5,e);r.ready(()=>{r.trigger({type:"usage",name:"vhs-error-reload-initialized"})});const n=function(){i&&r.currentTime(i)},a=function(c){c!=null&&(i=r.duration()!==1/0&&r.currentTime()||0,r.one("loadedmetadata",n),r.src(c),r.trigger({type:"usage",name:"vhs-error-reload"}),r.play())},o=function(){if(Date.now()-t<s.errorInterval*1e3){r.trigger({type:"usage",name:"vhs-error-reload-canceled"});return}if(!s.getSource||typeof s.getSource!="function"){H.log.error("ERROR: reloadSourceOnError - The option getSource must be a function!");return}return t=Date.now(),s.getSource.call(r,a)},l=function(){r.off("loadedmetadata",n),r.off("error",o),r.off("dispose",l)},u=function(c){l(),Cx(r,c)};r.on("error",o),r.on("dispose",l),r.reloadSourceOnError=u},G5=function(r){Cx(this,r)};var kx="3.17.2",K5="7.1.0",J5="1.3.1",e3="7.2.0",t3="4.0.2";const vt={PlaylistLoader:sa,Playlist:Ci,utils:a$,STANDARD_PLAYLIST_SELECTOR:hb,INITIAL_PLAYLIST_SELECTOR:Z$,lastBandwidthSelector:hb,movingAverageBandwidthSelector:j$,comparePlaylistBandwidth:zg,comparePlaylistResolution:X$,xhr:ex()};Object.keys(Ut).forEach(r=>{Object.defineProperty(vt,r,{get(){return H.log.warn(`using Vhs.${r} is UNSAFE be sure you know what you are doing`),Ut[r]},set(e){if(H.log.warn(`using Vhs.${r} is UNSAFE be sure you know what you are doing`),typeof e!="number"||e<0){H.log.warn(`value of Vhs.${r} must be greater than or equal to 0`);return}Ut[r]=e}})});const Ex="videojs-vhs",Ax=function(r,e){const t=e.media();let i=-1;for(let s=0;s<r.length;s++)if(r[s].id===t.id){i=s;break}r.selectedIndex_=i,r.trigger({selectedIndex:i,type:"change"})},i3=function(r,e){e.representations().forEach(t=>{r.addQualityLevel(t)}),Ax(r,e.playlists)};vt.canPlaySource=function(){return H.log.warn("VHS is no longer a tech. Please remove it from your player's techOrder.")};const r3=(r,e,t)=>{if(!r)return r;let i={};e&&e.attributes&&e.attributes.CODECS&&(i=gl(Ir(e.attributes.CODECS))),t&&t.attributes&&t.attributes.CODECS&&(i.audio=t.attributes.CODECS);const s=ka(i.video),n=ka(i.audio),a={};for(const o in r)a[o]={},n&&(a[o].audioContentType=n),s&&(a[o].videoContentType=s),e.contentProtection&&e.contentProtection[o]&&e.contentProtection[o].pssh&&(a[o].pssh=e.contentProtection[o].pssh),typeof r[o]=="string"&&(a[o].url=r[o]);return We(r,a)},s3=(r,e)=>r.reduce((t,i)=>{if(!i.contentProtection)return t;const s=e.reduce((n,a)=>{const o=i.contentProtection[a];return o&&o.pssh&&(n[a]={pssh:o.pssh}),n},{});return Object.keys(s).length&&t.push(s),t},[]),n3=({player:r,sourceKeySystems:e,audioMedia:t,mainPlaylists:i})=>{if(!r.eme.initializeMediaKeys)return Promise.resolve();const s=t?i.concat([t]):i,n=s3(s,Object.keys(e)),a=[],o=[];return n.forEach(l=>{o.push(new Promise((u,c)=>{r.tech_.one("keysessioncreated",u)})),a.push(new Promise((u,c)=>{r.eme.initializeMediaKeys({keySystems:l},h=>{if(h){c(h);return}u()})}))}),Promise.race([Promise.all(a),Promise.race(o)])},a3=({player:r,sourceKeySystems:e,media:t,audioMedia:i})=>{const s=r3(e,t,i);return s?(r.currentSource().keySystems=s,s&&!r.eme?(H.log.warn("DRM encrypted source cannot be decrypted without a DRM plugin"),!1):!0):!1},Px=()=>{if(!U.localStorage)return null;const r=U.localStorage.getItem(Ex);if(!r)return null;try{return JSON.parse(r)}catch{return null}},o3=r=>{if(!U.localStorage)return!1;let e=Px();e=e?We(e,r):r;try{U.localStorage.setItem(Ex,JSON.stringify(e))}catch{return!1}return e},l3=r=>r.toLowerCase().indexOf("data:application/vnd.videojs.vhs+json,")===0?JSON.parse(r.substring(r.indexOf(",")+1)):r,Dx=(r,e)=>{r._requestCallbackSet||(r._requestCallbackSet=new Set),r._requestCallbackSet.add(e)},Mx=(r,e)=>{r._responseCallbackSet||(r._responseCallbackSet=new Set),r._responseCallbackSet.add(e)},Ix=(r,e)=>{r._requestCallbackSet&&(r._requestCallbackSet.delete(e),r._requestCallbackSet.size||delete r._requestCallbackSet)},Rx=(r,e)=>{r._responseCallbackSet&&(r._responseCallbackSet.delete(e),r._responseCallbackSet.size||delete r._responseCallbackSet)};vt.supportsNativeHls=(function(){if(!ue||!ue.createElement)return!1;const r=ue.createElement("video");return H.getTech("Html5").isSupported()?["application/vnd.apple.mpegurl","audio/mpegurl","audio/x-mpegurl","application/x-mpegurl","video/x-mpegurl","video/mpegurl","application/mpegurl"].some(function(t){return/maybe|probably/i.test(r.canPlayType(t))}):!1})();vt.supportsNativeDash=(function(){return!ue||!ue.createElement||!H.getTech("Html5").isSupported()?!1:/maybe|probably/i.test(ue.createElement("video").canPlayType("application/dash+xml"))})();vt.supportsTypeNatively=r=>r==="hls"?vt.supportsNativeHls:r==="dash"?vt.supportsNativeDash:!1;vt.isSupported=function(){return H.log.warn("VHS is no longer a tech. Please remove it from your player's techOrder.")};vt.xhr.onRequest=function(r){Dx(vt.xhr,r)};vt.xhr.onResponse=function(r){Mx(vt.xhr,r)};vt.xhr.offRequest=function(r){Ix(vt.xhr,r)};vt.xhr.offResponse=function(r){Rx(vt.xhr,r)};const u3=H.getComponent("Component");class Lx extends u3{constructor(e,t,i){if(super(t,i.vhs),typeof i.initialBandwidth=="number"&&(this.options_.bandwidth=i.initialBandwidth),this.logger_=ar("VhsHandler"),t.options_&&t.options_.playerId){const s=H.getPlayer(t.options_.playerId);this.player_=s}if(this.tech_=t,this.source_=e,this.stats={},this.ignoreNextSeekingEvent_=!1,this.setOptions_(),this.options_.overrideNative&&t.overrideNativeAudioTracks&&t.overrideNativeVideoTracks)t.overrideNativeAudioTracks(!0),t.overrideNativeVideoTracks(!0);else if(this.options_.overrideNative&&(t.featuresNativeVideoTracks||t.featuresNativeAudioTracks))throw new Error("Overriding native VHS requires emulated tracks. See https://git.io/vMpjB");this.on(ue,["fullscreenchange","webkitfullscreenchange","mozfullscreenchange","MSFullscreenChange"],s=>{const n=ue.fullscreenElement||ue.webkitFullscreenElement||ue.mozFullScreenElement||ue.msFullscreenElement;n&&n.contains(this.tech_.el())?this.playlistController_.fastQualityChange_():this.playlistController_.checkABR_()}),this.on(this.tech_,"seeking",function(){if(this.ignoreNextSeekingEvent_){this.ignoreNextSeekingEvent_=!1;return}this.setCurrentTime(this.tech_.currentTime())}),this.on(this.tech_,"error",function(){this.tech_.error()&&this.playlistController_&&this.playlistController_.pauseLoading()}),this.on(this.tech_,"play",this.play)}setOptions_(e={}){if(this.options_=We(this.options_,e),this.options_.withCredentials=this.options_.withCredentials||!1,this.options_.limitRenditionByPlayerDimensions=this.options_.limitRenditionByPlayerDimensions!==!1,this.options_.useDevicePixelRatio=this.options_.useDevicePixelRatio||!1,this.options_.usePlayerObjectFit=this.options_.usePlayerObjectFit||!1,this.options_.useBandwidthFromLocalStorage=typeof this.source_.useBandwidthFromLocalStorage<"u"?this.source_.useBandwidthFromLocalStorage:this.options_.useBandwidthFromLocalStorage||!1,this.options_.useForcedSubtitles=this.options_.useForcedSubtitles||!1,this.options_.useNetworkInformationApi=typeof this.options_.useNetworkInformationApi<"u"?this.options_.useNetworkInformationApi:!0,this.options_.useDtsForTimestampOffset=this.options_.useDtsForTimestampOffset||!1,this.options_.customTagParsers=this.options_.customTagParsers||[],this.options_.customTagMappers=this.options_.customTagMappers||[],this.options_.cacheEncryptionKeys=this.options_.cacheEncryptionKeys||!1,this.options_.llhls=this.options_.llhls!==!1,this.options_.bufferBasedABR=this.options_.bufferBasedABR||!1,typeof this.options_.playlistExclusionDuration!="number"&&(this.options_.playlistExclusionDuration=60),typeof this.options_.bandwidth!="number"&&this.options_.useBandwidthFromLocalStorage){const i=Px();i&&i.bandwidth&&(this.options_.bandwidth=i.bandwidth,this.tech_.trigger({type:"usage",name:"vhs-bandwidth-from-local-storage"})),i&&i.throughput&&(this.options_.throughput=i.throughput,this.tech_.trigger({type:"usage",name:"vhs-throughput-from-local-storage"}))}typeof this.options_.bandwidth!="number"&&(this.options_.bandwidth=Ut.INITIAL_BANDWIDTH),this.options_.enableLowInitialPlaylist=this.options_.enableLowInitialPlaylist&&this.options_.bandwidth===Ut.INITIAL_BANDWIDTH,["withCredentials","useDevicePixelRatio","usePlayerObjectFit","customPixelRatio","limitRenditionByPlayerDimensions","bandwidth","customTagParsers","customTagMappers","cacheEncryptionKeys","playlistSelector","initialPlaylistSelector","bufferBasedABR","liveRangeSafeTimeDelta","llhls","useForcedSubtitles","useNetworkInformationApi","useDtsForTimestampOffset","exactManifestTimings","leastPixelDiffSelector"].forEach(i=>{typeof this.source_[i]<"u"&&(this.options_[i]=this.source_[i])}),this.limitRenditionByPlayerDimensions=this.options_.limitRenditionByPlayerDimensions,this.useDevicePixelRatio=this.options_.useDevicePixelRatio,this.usePlayerObjectFit=this.options_.usePlayerObjectFit;const t=this.options_.customPixelRatio;typeof t=="number"&&t>=0&&(this.customPixelRatio=t)}setOptions(e={}){this.setOptions_(e)}src(e,t){if(!e)return;this.setOptions_(),this.options_.src=l3(this.source_.src),this.options_.tech=this.tech_,this.options_.externVhs=vt,this.options_.sourceType=iT(t),this.options_.seekTo=n=>{this.tech_.setCurrentTime(n)},this.options_.player_=this.player_,this.playlistController_=new j5(this.options_);const i=We({liveRangeSafeTimeDelta:Fr},this.options_,{seekable:()=>this.seekable(),media:()=>this.playlistController_.media(),playlistController:this.playlistController_});this.playbackWatcher_=new H5(i),this.attachStreamingEventListeners_(),this.playlistController_.on("error",()=>{const n=H.players[this.tech_.options_.playerId];let a=this.playlistController_.error;typeof a=="object"&&!a.code?a.code=3:typeof a=="string"&&(a={message:a,code:3}),n.error(a)});const s=this.options_.bufferBasedABR?vt.movingAverageBandwidthSelector(.55):vt.STANDARD_PLAYLIST_SELECTOR;this.playlistController_.selectPlaylist=this.selectPlaylist?this.selectPlaylist.bind(this):s.bind(this),this.playlistController_.selectInitialPlaylist=vt.INITIAL_PLAYLIST_SELECTOR.bind(this),this.playlists=this.playlistController_.mainPlaylistLoader_,this.mediaSource=this.playlistController_.mediaSource,Object.defineProperties(this,{selectPlaylist:{get(){return this.playlistController_.selectPlaylist},set(n){this.playlistController_.selectPlaylist=n.bind(this)}},throughput:{get(){return this.playlistController_.mainSegmentLoader_.throughput.rate},set(n){this.playlistController_.mainSegmentLoader_.throughput.rate=n,this.playlistController_.mainSegmentLoader_.throughput.count=1}},bandwidth:{get(){let n=this.playlistController_.mainSegmentLoader_.bandwidth;const a=U.navigator.connection||U.navigator.mozConnection||U.navigator.webkitConnection,o=1e7;if(this.options_.useNetworkInformationApi&&a){const l=a.downlink*1e3*1e3;l>=o&&n>=o?n=Math.max(n,l):n=l}return n},set(n){this.playlistController_.mainSegmentLoader_.bandwidth=n,this.playlistController_.mainSegmentLoader_.throughput={rate:0,count:0}}},systemBandwidth:{get(){const n=1/(this.bandwidth||1);let a;return this.throughput>0?a=1/this.throughput:a=0,Math.floor(1/(n+a))},set(){H.log.error('The "systemBandwidth" property is read-only')}}}),this.options_.bandwidth&&(this.bandwidth=this.options_.bandwidth),this.options_.throughput&&(this.throughput=this.options_.throughput),Object.defineProperties(this.stats,{bandwidth:{get:()=>this.bandwidth||0,enumerable:!0},mediaRequests:{get:()=>this.playlistController_.mediaRequests_()||0,enumerable:!0},mediaRequestsAborted:{get:()=>this.playlistController_.mediaRequestsAborted_()||0,enumerable:!0},mediaRequestsTimedout:{get:()=>this.playlistController_.mediaRequestsTimedout_()||0,enumerable:!0},mediaRequestsErrored:{get:()=>this.playlistController_.mediaRequestsErrored_()||0,enumerable:!0},mediaTransferDuration:{get:()=>this.playlistController_.mediaTransferDuration_()||0,enumerable:!0},mediaBytesTransferred:{get:()=>this.playlistController_.mediaBytesTransferred_()||0,enumerable:!0},mediaSecondsLoaded:{get:()=>this.playlistController_.mediaSecondsLoaded_()||0,enumerable:!0},mediaAppends:{get:()=>this.playlistController_.mediaAppends_()||0,enumerable:!0},mainAppendsToLoadedData:{get:()=>this.playlistController_.mainAppendsToLoadedData_()||0,enumerable:!0},audioAppendsToLoadedData:{get:()=>this.playlistController_.audioAppendsToLoadedData_()||0,enumerable:!0},appendsToLoadedData:{get:()=>this.playlistController_.appendsToLoadedData_()||0,enumerable:!0},timeToLoadedData:{get:()=>this.playlistController_.timeToLoadedData_()||0,enumerable:!0},buffered:{get:()=>bn(this.tech_.buffered()),enumerable:!0},currentTime:{get:()=>this.tech_.currentTime(),enumerable:!0},currentSource:{get:()=>this.tech_.currentSource_,enumerable:!0},currentTech:{get:()=>this.tech_.name_,enumerable:!0},duration:{get:()=>this.tech_.duration(),enumerable:!0},main:{get:()=>this.playlists.main,enumerable:!0},playerDimensions:{get:()=>this.tech_.currentDimensions(),enumerable:!0},seekable:{get:()=>bn(this.tech_.seekable()),enumerable:!0},timestamp:{get:()=>Date.now(),enumerable:!0},videoPlaybackQuality:{get:()=>this.tech_.getVideoPlaybackQuality(),enumerable:!0}}),this.tech_.one("canplay",this.playlistController_.setupFirstPlay.bind(this.playlistController_)),this.tech_.on("bandwidthupdate",()=>{this.options_.useBandwidthFromLocalStorage&&o3({bandwidth:this.bandwidth,throughput:Math.round(this.throughput)})}),this.playlistController_.on("selectedinitialmedia",()=>{W5(this)}),this.playlistController_.sourceUpdater_.on("createdsourcebuffers",()=>{this.setupEme_()}),this.on(this.playlistController_,"progress",function(){this.tech_.trigger("progress")}),this.on(this.playlistController_,"firstplay",function(){this.ignoreNextSeekingEvent_=!0}),this.setupQualityLevels_(),this.tech_.el()&&(this.mediaSourceUrl_=U.URL.createObjectURL(this.playlistController_.mediaSource),(H.browser.IS_ANY_SAFARI||H.browser.IS_IOS)&&this.options_.overrideNative&&this.options_.sourceType==="hls"&&typeof this.tech_.addSourceElement=="function"?(this.tech_.addSourceElement(this.mediaSourceUrl_),this.tech_.addSourceElement(this.source_.src)):this.tech_.src(this.mediaSourceUrl_))}createKeySessions_(){const e=this.playlistController_.mediaTypes_.AUDIO.activePlaylistLoader;this.logger_("waiting for EME key session creation"),n3({player:this.player_,sourceKeySystems:this.source_.keySystems,audioMedia:e&&e.media(),mainPlaylists:this.playlists.main.playlists}).then(()=>{this.logger_("created EME key session"),this.playlistController_.sourceUpdater_.initializedEme()}).catch(t=>{this.logger_("error while creating EME key session",t),this.player_.error({message:"Failed to initialize media keys for EME",code:3})})}handleWaitingForKey_(){this.logger_("waitingforkey fired, attempting to create any new key sessions"),this.createKeySessions_()}setupEme_(){const e=this.playlistController_.mediaTypes_.AUDIO.activePlaylistLoader,t=a3({player:this.player_,sourceKeySystems:this.source_.keySystems,media:this.playlists.media(),audioMedia:e&&e.media()});if(this.player_.tech_.on("keystatuschange",i=>{this.playlistController_.updatePlaylistByKeyStatus(i.keyId,i.status)}),this.handleWaitingForKey_=this.handleWaitingForKey_.bind(this),this.player_.tech_.on("waitingforkey",this.handleWaitingForKey_),!t){this.playlistController_.sourceUpdater_.initializedEme();return}this.createKeySessions_()}setupQualityLevels_(){const e=H.players[this.tech_.options_.playerId];!e||!e.qualityLevels||this.qualityLevels_||(this.qualityLevels_=e.qualityLevels(),this.playlistController_.on("selectedinitialmedia",()=>{i3(this.qualityLevels_,this)}),this.playlists.on("mediachange",()=>{Ax(this.qualityLevels_,this.playlists)}))}static version(){return{"@videojs/http-streaming":kx,"mux.js":K5,"mpd-parser":J5,"m3u8-parser":e3,"aes-decrypter":t3}}version(){return this.constructor.version()}canChangeType(){return Tx.canChangeType()}play(){this.playlistController_.play()}setCurrentTime(e){this.playlistController_.setCurrentTime(e)}duration(){return this.playlistController_.duration()}seekable(){return this.playlistController_.seekable()}dispose(){this.playbackWatcher_&&this.playbackWatcher_.dispose(),this.playlistController_&&this.playlistController_.dispose(),this.qualityLevels_&&this.qualityLevels_.dispose(),this.tech_&&this.tech_.vhs&&delete this.tech_.vhs,this.mediaSourceUrl_&&U.URL.revokeObjectURL&&(U.URL.revokeObjectURL(this.mediaSourceUrl_),this.mediaSourceUrl_=null),this.tech_&&this.tech_.off("waitingforkey",this.handleWaitingForKey_),super.dispose()}convertToProgramTime(e,t){return f$({playlist:this.playlistController_.media(),time:e,callback:t})}seekToProgramTime(e,t,i=!0,s=2){return nx({programTime:e,playlist:this.playlistController_.media(),retryCount:s,pauseAfterSeek:i,seekTo:this.options_.seekTo,tech:this.options_.tech,callback:t})}setupXhrHooks_(){this.xhr.onRequest=e=>{Dx(this.xhr,e)},this.xhr.onResponse=e=>{Mx(this.xhr,e)},this.xhr.offRequest=e=>{Ix(this.xhr,e)},this.xhr.offResponse=e=>{Rx(this.xhr,e)},this.player_.trigger("xhr-hooks-ready")}attachStreamingEventListeners_(){const e=["seekablerangeschanged","bufferedrangeschanged","contentsteeringloadstart","contentsteeringloadcomplete","contentsteeringparsed"],t=["gapjumped","playedrangeschanged"];e.forEach(i=>{this.playlistController_.on(i,s=>{this.player_.trigger(At({},s))})}),t.forEach(i=>{this.playbackWatcher_.on(i,s=>{this.player_.trigger(At({},s))})})}}const ih={name:"videojs-http-streaming",VERSION:kx,canHandleSource(r,e={}){const t=We(H.options,e);return!t.vhs.experimentalUseMMS&&!Wo("avc1.4d400d,mp4a.40.2",!1)?!1:ih.canPlayType(r.type,t)},handleSource(r,e,t={}){const i=We(H.options,t);return e.vhs=new Lx(r,e,i),e.vhs.xhr=ex(),e.vhs.setupXhrHooks_(),e.vhs.src(r.src,r.type),e.vhs},canPlayType(r,e){const t=iT(r);if(!t)return"";const i=ih.getOverrideNative(e);return!vt.supportsTypeNatively(t)||i?"maybe":""},getOverrideNative(r={}){const{vhs:e={}}=r,t=!(H.browser.IS_ANY_SAFARI||H.browser.IS_IOS),{overrideNative:i=t}=e;return i}},c3=()=>Wo("avc1.4d400d,mp4a.40.2",!0);c3()&&H.getTech("Html5").registerSourceHandler(ih,0);H.VhsHandler=Lx;H.VhsSourceHandler=ih;H.Vhs=vt;H.use||H.registerComponent("Vhs",vt);H.options.vhs=H.options.vhs||{};(!H.getPlugin||!H.getPlugin("reloadSourceOnError"))&&H.registerPlugin("reloadSourceOnError",G5);var Of=["onChange","onClose","onDayCreate","onDestroy","onKeyDown","onMonthChange","onOpen","onParseConfig","onReady","onValueUpdate","onYearChange","onPreCalendarPosition"],ba={_disable:[],allowInput:!1,allowInvalidPreload:!1,altFormat:"F j, Y",altInput:!1,altInputClass:"form-control input",animate:typeof window=="object"&&window.navigator.userAgent.indexOf("MSIE")===-1,ariaDateFormat:"F j, Y",autoFillDefaultTime:!0,clickOpens:!0,closeOnSelect:!0,conjunction:", ",dateFormat:"Y-m-d",defaultHour:12,defaultMinute:0,defaultSeconds:0,disable:[],disableMobile:!1,enableSeconds:!1,enableTime:!1,errorHandler:function(r){return typeof console<"u"&&console.warn(r)},getWeek:function(r){var e=new Date(r.getTime());e.setHours(0,0,0,0),e.setDate(e.getDate()+3-(e.getDay()+6)%7);var t=new Date(e.getFullYear(),0,4);return 1+Math.round(((e.getTime()-t.getTime())/864e5-3+(t.getDay()+6)%7)/7)},hourIncrement:1,ignoredFocusElements:[],inline:!1,locale:"default",minuteIncrement:5,mode:"single",monthSelectorType:"dropdown",nextArrow:"<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 17 17'><g></g><path d='M13.207 8.472l-7.854 7.854-0.707-0.707 7.146-7.146-7.146-7.148 0.707-0.707 7.854 7.854z' /></svg>",noCalendar:!1,now:new Date,onChange:[],onClose:[],onDayCreate:[],onDestroy:[],onKeyDown:[],onMonthChange:[],onOpen:[],onParseConfig:[],onReady:[],onValueUpdate:[],onYearChange:[],onPreCalendarPosition:[],plugins:[],position:"auto",positionElement:void 0,prevArrow:"<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 17 17'><g></g><path d='M5.207 8.471l7.146 7.147-0.707 0.707-7.853-7.854 7.854-7.853 0.707 0.707-7.147 7.146z' /></svg>",shorthandCurrentMonth:!1,showMonths:1,static:!1,time_24hr:!1,weekNumbers:!1,wrap:!1},Ol={weekdays:{shorthand:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],longhand:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},months:{shorthand:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],longhand:["January","February","March","April","May","June","July","August","September","October","November","December"]},daysInMonth:[31,28,31,30,31,30,31,31,30,31,30,31],firstDayOfWeek:0,ordinal:function(r){var e=r%100;if(e>3&&e<21)return"th";switch(e%10){case 1:return"st";case 2:return"nd";case 3:return"rd";default:return"th"}},rangeSeparator:" to ",weekAbbreviation:"Wk",scrollTitle:"Scroll to increment",toggleTitle:"Click to toggle",amPM:["AM","PM"],yearAriaLabel:"Year",monthAriaLabel:"Month",hourAriaLabel:"Hour",minuteAriaLabel:"Minute",time_24hr:!1},Ti=function(r,e){return e===void 0&&(e=2),("000"+r).slice(e*-1)},Wi=function(r){return r===!0?1:0};function xb(r,e){var t;return function(){var i=this,s=arguments;clearTimeout(t),t=setTimeout(function(){return r.apply(i,s)},e)}}var yf=function(r){return r instanceof Array?r:[r]};function di(r,e,t){if(t===!0)return r.classList.add(e);r.classList.remove(e)}function ze(r,e,t){var i=window.document.createElement(r);return e=e||"",t=t||"",i.className=e,t!==void 0&&(i.textContent=t),i}function qu(r){for(;r.firstChild;)r.removeChild(r.firstChild)}function Qx(r,e){if(e(r))return r;if(r.parentNode)return Qx(r.parentNode,e)}function Vu(r,e){var t=ze("div","numInputWrapper"),i=ze("input","numInput "+r),s=ze("span","arrowUp"),n=ze("span","arrowDown");if(navigator.userAgent.indexOf("MSIE 9.0")===-1?i.type="number":(i.type="text",i.pattern="\\d*"),e!==void 0)for(var a in e)i.setAttribute(a,e[a]);return t.appendChild(i),t.appendChild(s),t.appendChild(n),t}function Ii(r){try{if(typeof r.composedPath=="function"){var e=r.composedPath();return e[0]}return r.target}catch{return r.target}}var bf=function(){},rh=function(r,e,t){return t.months[e?"shorthand":"longhand"][r]},h3={D:bf,F:function(r,e,t){r.setMonth(t.months.longhand.indexOf(e))},G:function(r,e){r.setHours((r.getHours()>=12?12:0)+parseFloat(e))},H:function(r,e){r.setHours(parseFloat(e))},J:function(r,e){r.setDate(parseFloat(e))},K:function(r,e,t){r.setHours(r.getHours()%12+12*Wi(new RegExp(t.amPM[1],"i").test(e)))},M:function(r,e,t){r.setMonth(t.months.shorthand.indexOf(e))},S:function(r,e){r.setSeconds(parseFloat(e))},U:function(r,e){return new Date(parseFloat(e)*1e3)},W:function(r,e,t){var i=parseInt(e),s=new Date(r.getFullYear(),0,2+(i-1)*7,0,0,0,0);return s.setDate(s.getDate()-s.getDay()+t.firstDayOfWeek),s},Y:function(r,e){r.setFullYear(parseFloat(e))},Z:function(r,e){return new Date(e)},d:function(r,e){r.setDate(parseFloat(e))},h:function(r,e){r.setHours((r.getHours()>=12?12:0)+parseFloat(e))},i:function(r,e){r.setMinutes(parseFloat(e))},j:function(r,e){r.setDate(parseFloat(e))},l:bf,m:function(r,e){r.setMonth(parseFloat(e)-1)},n:function(r,e){r.setMonth(parseFloat(e)-1)},s:function(r,e){r.setSeconds(parseFloat(e))},u:function(r,e){return new Date(parseFloat(e))},w:bf,y:function(r,e){r.setFullYear(2e3+parseFloat(e))}},mn={D:"",F:"",G:"(\\d\\d|\\d)",H:"(\\d\\d|\\d)",J:"(\\d\\d|\\d)\\w+",K:"",M:"",S:"(\\d\\d|\\d)",U:"(.+)",W:"(\\d\\d|\\d)",Y:"(\\d{4})",Z:"(.+)",d:"(\\d\\d|\\d)",h:"(\\d\\d|\\d)",i:"(\\d\\d|\\d)",j:"(\\d\\d|\\d)",l:"",m:"(\\d\\d|\\d)",n:"(\\d\\d|\\d)",s:"(\\d\\d|\\d)",u:"(.+)",w:"(\\d\\d|\\d)",y:"(\\d{2})"},el={Z:function(r){return r.toISOString()},D:function(r,e,t){return e.weekdays.shorthand[el.w(r,e,t)]},F:function(r,e,t){return rh(el.n(r,e,t)-1,!1,e)},G:function(r,e,t){return Ti(el.h(r,e,t))},H:function(r){return Ti(r.getHours())},J:function(r,e){return e.ordinal!==void 0?r.getDate()+e.ordinal(r.getDate()):r.getDate()},K:function(r,e){return e.amPM[Wi(r.getHours()>11)]},M:function(r,e){return rh(r.getMonth(),!0,e)},S:function(r){return Ti(r.getSeconds())},U:function(r){return r.getTime()/1e3},W:function(r,e,t){return t.getWeek(r)},Y:function(r){return Ti(r.getFullYear(),4)},d:function(r){return Ti(r.getDate())},h:function(r){return r.getHours()%12?r.getHours()%12:12},i:function(r){return Ti(r.getMinutes())},j:function(r){return r.getDate()},l:function(r,e){return e.weekdays.longhand[r.getDay()]},m:function(r){return Ti(r.getMonth()+1)},n:function(r){return r.getMonth()+1},s:function(r){return r.getSeconds()},u:function(r){return r.getTime()},w:function(r){return r.getDay()},y:function(r){return String(r.getFullYear()).substring(2)}},$x=function(r){var e=r.config,t=e===void 0?ba:e,i=r.l10n,s=i===void 0?Ol:i,n=r.isMobile,a=n===void 0?!1:n;return function(o,l,u){var c=u||s;return t.formatDate!==void 0&&!a?t.formatDate(o,l,c):l.split("").map(function(h,f,m){return el[h]&&m[f-1]!=="\\"?el[h](o,c,t):h!=="\\"?h:""}).join("")}},Fp=function(r){var e=r.config,t=e===void 0?ba:e,i=r.l10n,s=i===void 0?Ol:i;return function(n,a,o,l){if(!(n!==0&&!n)){var u=l||s,c,h=n;if(n instanceof Date)c=new Date(n.getTime());else if(typeof n!="string"&&n.toFixed!==void 0)c=new Date(n);else if(typeof n=="string"){var f=a||(t||ba).dateFormat,m=String(n).trim();if(m==="today")c=new Date,o=!0;else if(t&&t.parseDate)c=t.parseDate(n,f);else if(/Z$/.test(m)||/GMT$/.test(m))c=new Date(n);else{for(var S=void 0,y=[],E=0,C=0,_="";E<f.length;E++){var v=f[E],T=v==="\\",w=f[E-1]==="\\"||T;if(mn[v]&&!w){_+=mn[v];var A=new RegExp(_).exec(n);A&&(S=!0)&&y[v!=="Y"?"push":"unshift"]({fn:h3[v],val:A[++C]})}else T||(_+=".")}c=!t||!t.noCalendar?new Date(new Date().getFullYear(),0,1,0,0,0,0):new Date(new Date().setHours(0,0,0,0)),y.forEach(function(I){var N=I.fn,P=I.val;return c=N(c,P,u)||c}),c=S?c:void 0}}if(!(c instanceof Date&&!isNaN(c.getTime()))){t.errorHandler(new Error("Invalid date provided: "+h));return}return o===!0&&c.setHours(0,0,0,0),c}}};function $i(r,e,t){return t===void 0&&(t=!0),t!==!1?new Date(r.getTime()).setHours(0,0,0,0)-new Date(e.getTime()).setHours(0,0,0,0):r.getTime()-e.getTime()}var d3=function(r,e,t){return r>Math.min(e,t)&&r<Math.max(e,t)},vf=function(r,e,t){return r*3600+e*60+t},f3=function(r){var e=Math.floor(r/3600),t=(r-e*3600)/60;return[e,t,r-e*3600-t*60]},p3={DAY:864e5};function Sf(r){var e=r.defaultHour,t=r.defaultMinute,i=r.defaultSeconds;if(r.minDate!==void 0){var s=r.minDate.getHours(),n=r.minDate.getMinutes(),a=r.minDate.getSeconds();e<s&&(e=s),e===s&&t<n&&(t=n),e===s&&t===n&&i<a&&(i=r.minDate.getSeconds())}if(r.maxDate!==void 0){var o=r.maxDate.getHours(),l=r.maxDate.getMinutes();e=Math.min(e,o),e===o&&(t=Math.min(l,t)),e===o&&t===l&&(i=r.maxDate.getSeconds())}return{hours:e,minutes:t,seconds:i}}typeof Object.assign!="function"&&(Object.assign=function(r){for(var e=[],t=1;t<arguments.length;t++)e[t-1]=arguments[t];if(!r)throw TypeError("Cannot convert undefined or null to object");for(var i=function(o){o&&Object.keys(o).forEach(function(l){return r[l]=o[l]})},s=0,n=e;s<n.length;s++){var a=n[s];i(a)}return r});var ti=function(){return ti=Object.assign||function(r){for(var e,t=1,i=arguments.length;t<i;t++){e=arguments[t];for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&(r[s]=e[s])}return r},ti.apply(this,arguments)},wb=function(){for(var r=0,e=0,t=arguments.length;e<t;e++)r+=arguments[e].length;for(var i=Array(r),s=0,e=0;e<t;e++)for(var n=arguments[e],a=0,o=n.length;a<o;a++,s++)i[s]=n[a];return i},m3=300;function g3(r,e){var t={config:ti(ti({},ba),Et.defaultConfig),l10n:Ol};t.parseDate=Fp({config:t.config,l10n:t.l10n}),t._handlers=[],t.pluginElements=[],t.loadedPlugins=[],t._bind=y,t._setHoursFromDate=f,t._positionCalendar=zt,t.changeMonth=ae,t.changeYear=ft,t.clear=ve,t.close=xe,t.onMouseOver=Dt,t._createElement=ze,t.createDay=A,t.destroy=Pe,t.isEnabled=Ge,t.jumpToDate=_,t.updateValue=bi,t.open=Mt,t.redraw=it,t.set=Jr,t.setDate=wr,t.toggle=es;function i(){t.utils={getDaysInMonth:function(x,D){return x===void 0&&(x=t.currentMonth),D===void 0&&(D=t.currentYear),x===1&&(D%4===0&&D%100!==0||D%400===0)?29:t.l10n.daysInMonth[x]}}}function s(){t.element=t.input=r,t.isOpen=!1,xt(),Jt(),ws(),tn(),i(),t.isMobile||w(),C(),(t.selectedDates.length||t.config.noCalendar)&&(t.config.enableTime&&f(t.config.noCalendar?t.latestSelectedDateObj:void 0),bi(!1)),o();var x=/^((?!chrome|android).)*safari/i.test(navigator.userAgent);!t.isMobile&&x&&zt(),Ke("onReady")}function n(){var x;return((x=t.calendarContainer)===null||x===void 0?void 0:x.getRootNode()).activeElement||document.activeElement}function a(x){return x.bind(t)}function o(){var x=t.config;x.weekNumbers===!1&&x.showMonths===1||x.noCalendar!==!0&&window.requestAnimationFrame(function(){if(t.calendarContainer!==void 0&&(t.calendarContainer.style.visibility="hidden",t.calendarContainer.style.display="block"),t.daysContainer!==void 0){var D=(t.days.offsetWidth+1)*x.showMonths;t.daysContainer.style.width=D+"px",t.calendarContainer.style.width=D+(t.weekWrapper!==void 0?t.weekWrapper.offsetWidth:0)+"px",t.calendarContainer.style.removeProperty("visibility"),t.calendarContainer.style.removeProperty("display")}})}function l(x){if(t.selectedDates.length===0){var D=t.config.minDate===void 0||$i(new Date,t.config.minDate)>=0?new Date:new Date(t.config.minDate.getTime()),B=Sf(t.config);D.setHours(B.hours,B.minutes,B.seconds,D.getMilliseconds()),t.selectedDates=[D],t.latestSelectedDateObj=D}x!==void 0&&x.type!=="blur"&&L(x);var W=t._input.value;h(),bi(),t._input.value!==W&&t._debouncedChange()}function u(x,D){return x%12+12*Wi(D===t.l10n.amPM[1])}function c(x){switch(x%24){case 0:case 12:return 12;default:return x%12}}function h(){if(!(t.hourElement===void 0||t.minuteElement===void 0)){var x=(parseInt(t.hourElement.value.slice(-2),10)||0)%24,D=(parseInt(t.minuteElement.value,10)||0)%60,B=t.secondElement!==void 0?(parseInt(t.secondElement.value,10)||0)%60:0;t.amPM!==void 0&&(x=u(x,t.amPM.textContent));var W=t.config.minTime!==void 0||t.config.minDate&&t.minDateHasTime&&t.latestSelectedDateObj&&$i(t.latestSelectedDateObj,t.config.minDate,!0)===0,oe=t.config.maxTime!==void 0||t.config.maxDate&&t.maxDateHasTime&&t.latestSelectedDateObj&&$i(t.latestSelectedDateObj,t.config.maxDate,!0)===0;if(t.config.maxTime!==void 0&&t.config.minTime!==void 0&&t.config.minTime>t.config.maxTime){var he=vf(t.config.minTime.getHours(),t.config.minTime.getMinutes(),t.config.minTime.getSeconds()),we=vf(t.config.maxTime.getHours(),t.config.maxTime.getMinutes(),t.config.maxTime.getSeconds()),Oe=vf(x,D,B);if(Oe>we&&Oe<he){var Ae=f3(he);x=Ae[0],D=Ae[1],B=Ae[2]}}else{if(oe){var pe=t.config.maxTime!==void 0?t.config.maxTime:t.config.maxDate;x=Math.min(x,pe.getHours()),x===pe.getHours()&&(D=Math.min(D,pe.getMinutes())),D===pe.getMinutes()&&(B=Math.min(B,pe.getSeconds()))}if(W){var Te=t.config.minTime!==void 0?t.config.minTime:t.config.minDate;x=Math.max(x,Te.getHours()),x===Te.getHours()&&D<Te.getMinutes()&&(D=Te.getMinutes()),D===Te.getMinutes()&&(B=Math.max(B,Te.getSeconds()))}}m(x,D,B)}}function f(x){var D=x||t.latestSelectedDateObj;D&&D instanceof Date&&m(D.getHours(),D.getMinutes(),D.getSeconds())}function m(x,D,B){t.latestSelectedDateObj!==void 0&&t.latestSelectedDateObj.setHours(x%24,D,B||0,0),!(!t.hourElement||!t.minuteElement||t.isMobile)&&(t.hourElement.value=Ti(t.config.time_24hr?x:(12+x)%12+12*Wi(x%12===0)),t.minuteElement.value=Ti(D),t.amPM!==void 0&&(t.amPM.textContent=t.l10n.amPM[Wi(x>=12)]),t.secondElement!==void 0&&(t.secondElement.value=Ti(B)))}function S(x){var D=Ii(x),B=parseInt(D.value)+(x.delta||0);(B/1e3>1||x.key==="Enter"&&!/[^\d]/.test(B.toString()))&&ft(B)}function y(x,D,B,W){if(D instanceof Array)return D.forEach(function(oe){return y(x,oe,B,W)});if(x instanceof Array)return x.forEach(function(oe){return y(oe,D,B,W)});x.addEventListener(D,B,W),t._handlers.push({remove:function(){return x.removeEventListener(D,B,W)}})}function E(){Ke("onChange")}function C(){if(t.config.wrap&&["open","close","toggle","clear"].forEach(function(B){Array.prototype.forEach.call(t.element.querySelectorAll("[data-"+B+"]"),function(W){return y(W,"click",t[B])})}),t.isMobile){rn();return}var x=xb(xr,50);if(t._debouncedChange=xb(E,m3),t.daysContainer&&!/iPhone|iPad|iPod/i.test(navigator.userAgent)&&y(t.daysContainer,"mouseover",function(B){t.config.mode==="range"&&Dt(Ii(B))}),y(t._input,"keydown",Pt),t.calendarContainer!==void 0&&y(t.calendarContainer,"keydown",Pt),!t.config.inline&&!t.config.static&&y(window,"resize",x),window.ontouchstart!==void 0?y(window.document,"touchstart",at):y(window.document,"mousedown",at),y(window.document,"focus",at,{capture:!0}),t.config.clickOpens===!0&&(y(t._input,"focus",t.open),y(t._input,"click",t.open)),t.daysContainer!==void 0&&(y(t.monthNav,"click",M),y(t.monthNav,["keyup","increment"],S),y(t.daysContainer,"click",ji)),t.timeContainer!==void 0&&t.minuteElement!==void 0&&t.hourElement!==void 0){var D=function(B){return Ii(B).select()};y(t.timeContainer,["increment"],l),y(t.timeContainer,"blur",l,{capture:!0}),y(t.timeContainer,"click",v),y([t.hourElement,t.minuteElement],["focus","click"],D),t.secondElement!==void 0&&y(t.secondElement,"focus",function(){return t.secondElement&&t.secondElement.select()}),t.amPM!==void 0&&y(t.amPM,"click",function(B){l(B)})}t.config.allowInput&&y(t._input,"blur",yi)}function _(x,D){var B=x!==void 0?t.parseDate(x):t.latestSelectedDateObj||(t.config.minDate&&t.config.minDate>t.now?t.config.minDate:t.config.maxDate&&t.config.maxDate<t.now?t.config.maxDate:t.now),W=t.currentYear,oe=t.currentMonth;try{B!==void 0&&(t.currentYear=B.getFullYear(),t.currentMonth=B.getMonth())}catch(he){he.message="Invalid date supplied: "+B,t.config.errorHandler(he)}D&&t.currentYear!==W&&(Ke("onYearChange"),Z()),D&&(t.currentYear!==W||t.currentMonth!==oe)&&Ke("onMonthChange"),t.redraw()}function v(x){var D=Ii(x);~D.className.indexOf("arrow")&&T(x,D.classList.contains("arrowUp")?1:-1)}function T(x,D,B){var W=x&&Ii(x),oe=B||W&&W.parentNode&&W.parentNode.firstChild,he=Cs("increment");he.delta=D,oe&&oe.dispatchEvent(he)}function w(){var x=window.document.createDocumentFragment();if(t.calendarContainer=ze("div","flatpickr-calendar"),t.calendarContainer.tabIndex=-1,!t.config.noCalendar){if(x.appendChild(le()),t.innerContainer=ze("div","flatpickr-innerContainer"),t.config.weekNumbers){var D=ne(),B=D.weekWrapper,W=D.weekNumbers;t.innerContainer.appendChild(B),t.weekNumbers=W,t.weekWrapper=B}t.rContainer=ze("div","flatpickr-rContainer"),t.rContainer.appendChild(re()),t.daysContainer||(t.daysContainer=ze("div","flatpickr-days"),t.daysContainer.tabIndex=-1),j(),t.rContainer.appendChild(t.daysContainer),t.innerContainer.appendChild(t.rContainer),x.appendChild(t.innerContainer)}t.config.enableTime&&x.appendChild(G()),di(t.calendarContainer,"rangeMode",t.config.mode==="range"),di(t.calendarContainer,"animate",t.config.animate===!0),di(t.calendarContainer,"multiMonth",t.config.showMonths>1),t.calendarContainer.appendChild(x);var oe=t.config.appendTo!==void 0&&t.config.appendTo.nodeType!==void 0;if((t.config.inline||t.config.static)&&(t.calendarContainer.classList.add(t.config.inline?"inline":"static"),t.config.inline&&(!oe&&t.element.parentNode?t.element.parentNode.insertBefore(t.calendarContainer,t._input.nextSibling):t.config.appendTo!==void 0&&t.config.appendTo.appendChild(t.calendarContainer)),t.config.static)){var he=ze("div","flatpickr-wrapper");t.element.parentNode&&t.element.parentNode.insertBefore(he,t.element),he.appendChild(t.element),t.altInput&&he.appendChild(t.altInput),he.appendChild(t.calendarContainer)}!t.config.static&&!t.config.inline&&(t.config.appendTo!==void 0?t.config.appendTo:window.document.body).appendChild(t.calendarContainer)}function A(x,D,B,W){var oe=Ge(D,!0),he=ze("span",x,D.getDate().toString());return he.dateObj=D,he.$i=W,he.setAttribute("aria-label",t.formatDate(D,t.config.ariaDateFormat)),x.indexOf("hidden")===-1&&$i(D,t.now)===0&&(t.todayDateElem=he,he.classList.add("today"),he.setAttribute("aria-current","date")),oe?(he.tabIndex=-1,ts(D)&&(he.classList.add("selected"),t.selectedDateElem=he,t.config.mode==="range"&&(di(he,"startRange",t.selectedDates[0]&&$i(D,t.selectedDates[0],!0)===0),di(he,"endRange",t.selectedDates[1]&&$i(D,t.selectedDates[1],!0)===0),x==="nextMonthDay"&&he.classList.add("inRange")))):he.classList.add("flatpickr-disabled"),t.config.mode==="range"&&Cr(D)&&!ts(D)&&he.classList.add("inRange"),t.weekNumbers&&t.config.showMonths===1&&x!=="prevMonthDay"&&W%7===6&&t.weekNumbers.insertAdjacentHTML("beforeend","<span class='flatpickr-day'>"+t.config.getWeek(D)+"</span>"),Ke("onDayCreate",he),he}function I(x){x.focus(),t.config.mode==="range"&&Dt(x)}function N(x){for(var D=x>0?0:t.config.showMonths-1,B=x>0?t.config.showMonths:-1,W=D;W!=B;W+=x)for(var oe=t.daysContainer.children[W],he=x>0?0:oe.children.length-1,we=x>0?oe.children.length:-1,Oe=he;Oe!=we;Oe+=x){var Ae=oe.children[Oe];if(Ae.className.indexOf("hidden")===-1&&Ge(Ae.dateObj))return Ae}}function P(x,D){for(var B=x.className.indexOf("Month")===-1?x.dateObj.getMonth():t.currentMonth,W=D>0?t.config.showMonths:-1,oe=D>0?1:-1,he=B-t.currentMonth;he!=W;he+=oe)for(var we=t.daysContainer.children[he],Oe=B-t.currentMonth===he?x.$i+D:D<0?we.children.length-1:0,Ae=we.children.length,pe=Oe;pe>=0&&pe<Ae&&pe!=(D>0?Ae:-1);pe+=oe){var Te=we.children[pe];if(Te.className.indexOf("hidden")===-1&&Ge(Te.dateObj)&&Math.abs(x.$i-pe)>=Math.abs(D))return I(Te)}t.changeMonth(oe),R(N(oe),0)}function R(x,D){var B=n(),W=_t(B||document.body),oe=x!==void 0?x:W?B:t.selectedDateElem!==void 0&&_t(t.selectedDateElem)?t.selectedDateElem:t.todayDateElem!==void 0&&_t(t.todayDateElem)?t.todayDateElem:N(D>0?1:-1);oe===void 0?t._input.focus():W?P(oe,D):I(oe)}function X(x,D){for(var B=(new Date(x,D,1).getDay()-t.l10n.firstDayOfWeek+7)%7,W=t.utils.getDaysInMonth((D-1+12)%12,x),oe=t.utils.getDaysInMonth(D,x),he=window.document.createDocumentFragment(),we=t.config.showMonths>1,Oe=we?"prevMonthDay hidden":"prevMonthDay",Ae=we?"nextMonthDay hidden":"nextMonthDay",pe=W+1-B,Te=0;pe<=W;pe++,Te++)he.appendChild(A("flatpickr-day "+Oe,new Date(x,D-1,pe),pe,Te));for(pe=1;pe<=oe;pe++,Te++)he.appendChild(A("flatpickr-day",new Date(x,D,pe),pe,Te));for(var De=oe+1;De<=42-B&&(t.config.showMonths===1||Te%7!==0);De++,Te++)he.appendChild(A("flatpickr-day "+Ae,new Date(x,D+1,De%oe),De,Te));var Ot=ze("div","dayContainer");return Ot.appendChild(he),Ot}function j(){if(t.daysContainer!==void 0){qu(t.daysContainer),t.weekNumbers&&qu(t.weekNumbers);for(var x=document.createDocumentFragment(),D=0;D<t.config.showMonths;D++){var B=new Date(t.currentYear,t.currentMonth,1);B.setMonth(t.currentMonth+D),x.appendChild(X(B.getFullYear(),B.getMonth()))}t.daysContainer.appendChild(x),t.days=t.daysContainer.firstChild,t.config.mode==="range"&&t.selectedDates.length===1&&Dt()}}function Z(){if(!(t.config.showMonths>1||t.config.monthSelectorType!=="dropdown")){var x=function(W){return t.config.minDate!==void 0&&t.currentYear===t.config.minDate.getFullYear()&&W<t.config.minDate.getMonth()?!1:!(t.config.maxDate!==void 0&&t.currentYear===t.config.maxDate.getFullYear()&&W>t.config.maxDate.getMonth())};t.monthsDropdownContainer.tabIndex=-1,t.monthsDropdownContainer.innerHTML="";for(var D=0;D<12;D++)if(x(D)){var B=ze("option","flatpickr-monthDropdown-month");B.value=new Date(t.currentYear,D).getMonth().toString(),B.textContent=rh(D,t.config.shorthandCurrentMonth,t.l10n),B.tabIndex=-1,t.currentMonth===D&&(B.selected=!0),t.monthsDropdownContainer.appendChild(B)}}}function Y(){var x=ze("div","flatpickr-month"),D=window.document.createDocumentFragment(),B;t.config.showMonths>1||t.config.monthSelectorType==="static"?B=ze("span","cur-month"):(t.monthsDropdownContainer=ze("select","flatpickr-monthDropdown-months"),t.monthsDropdownContainer.setAttribute("aria-label",t.l10n.monthAriaLabel),y(t.monthsDropdownContainer,"change",function(we){var Oe=Ii(we),Ae=parseInt(Oe.value,10);t.changeMonth(Ae-t.currentMonth),Ke("onMonthChange")}),Z(),B=t.monthsDropdownContainer);var W=Vu("cur-year",{tabindex:"-1"}),oe=W.getElementsByTagName("input")[0];oe.setAttribute("aria-label",t.l10n.yearAriaLabel),t.config.minDate&&oe.setAttribute("min",t.config.minDate.getFullYear().toString()),t.config.maxDate&&(oe.setAttribute("max",t.config.maxDate.getFullYear().toString()),oe.disabled=!!t.config.minDate&&t.config.minDate.getFullYear()===t.config.maxDate.getFullYear());var he=ze("div","flatpickr-current-month");return he.appendChild(B),he.appendChild(W),D.appendChild(he),x.appendChild(D),{container:x,yearElement:oe,monthElement:B}}function te(){qu(t.monthNav),t.monthNav.appendChild(t.prevMonthNav),t.config.showMonths&&(t.yearElements=[],t.monthElements=[]);for(var x=t.config.showMonths;x--;){var D=Y();t.yearElements.push(D.yearElement),t.monthElements.push(D.monthElement),t.monthNav.appendChild(D.container)}t.monthNav.appendChild(t.nextMonthNav)}function le(){return t.monthNav=ze("div","flatpickr-months"),t.yearElements=[],t.monthElements=[],t.prevMonthNav=ze("span","flatpickr-prev-month"),t.prevMonthNav.innerHTML=t.config.prevArrow,t.nextMonthNav=ze("span","flatpickr-next-month"),t.nextMonthNav.innerHTML=t.config.nextArrow,te(),Object.defineProperty(t,"_hidePrevMonthArrow",{get:function(){return t.__hidePrevMonthArrow},set:function(x){t.__hidePrevMonthArrow!==x&&(di(t.prevMonthNav,"flatpickr-disabled",x),t.__hidePrevMonthArrow=x)}}),Object.defineProperty(t,"_hideNextMonthArrow",{get:function(){return t.__hideNextMonthArrow},set:function(x){t.__hideNextMonthArrow!==x&&(di(t.nextMonthNav,"flatpickr-disabled",x),t.__hideNextMonthArrow=x)}}),t.currentYearElement=t.yearElements[0],is(),t.monthNav}function G(){t.calendarContainer.classList.add("hasTime"),t.config.noCalendar&&t.calendarContainer.classList.add("noCalendar");var x=Sf(t.config);t.timeContainer=ze("div","flatpickr-time"),t.timeContainer.tabIndex=-1;var D=ze("span","flatpickr-time-separator",":"),B=Vu("flatpickr-hour",{"aria-label":t.l10n.hourAriaLabel});t.hourElement=B.getElementsByTagName("input")[0];var W=Vu("flatpickr-minute",{"aria-label":t.l10n.minuteAriaLabel});if(t.minuteElement=W.getElementsByTagName("input")[0],t.hourElement.tabIndex=t.minuteElement.tabIndex=-1,t.hourElement.value=Ti(t.latestSelectedDateObj?t.latestSelectedDateObj.getHours():t.config.time_24hr?x.hours:c(x.hours)),t.minuteElement.value=Ti(t.latestSelectedDateObj?t.latestSelectedDateObj.getMinutes():x.minutes),t.hourElement.setAttribute("step",t.config.hourIncrement.toString()),t.minuteElement.setAttribute("step",t.config.minuteIncrement.toString()),t.hourElement.setAttribute("min",t.config.time_24hr?"0":"1"),t.hourElement.setAttribute("max",t.config.time_24hr?"23":"12"),t.hourElement.setAttribute("maxlength","2"),t.minuteElement.setAttribute("min","0"),t.minuteElement.setAttribute("max","59"),t.minuteElement.setAttribute("maxlength","2"),t.timeContainer.appendChild(B),t.timeContainer.appendChild(D),t.timeContainer.appendChild(W),t.config.time_24hr&&t.timeContainer.classList.add("time24hr"),t.config.enableSeconds){t.timeContainer.classList.add("hasSeconds");var oe=Vu("flatpickr-second");t.secondElement=oe.getElementsByTagName("input")[0],t.secondElement.value=Ti(t.latestSelectedDateObj?t.latestSelectedDateObj.getSeconds():x.seconds),t.secondElement.setAttribute("step",t.minuteElement.getAttribute("step")),t.secondElement.setAttribute("min","0"),t.secondElement.setAttribute("max","59"),t.secondElement.setAttribute("maxlength","2"),t.timeContainer.appendChild(ze("span","flatpickr-time-separator",":")),t.timeContainer.appendChild(oe)}return t.config.time_24hr||(t.amPM=ze("span","flatpickr-am-pm",t.l10n.amPM[Wi((t.latestSelectedDateObj?t.hourElement.value:t.config.defaultHour)>11)]),t.amPM.title=t.l10n.toggleTitle,t.amPM.tabIndex=-1,t.timeContainer.appendChild(t.amPM)),t.timeContainer}function re(){t.weekdayContainer?qu(t.weekdayContainer):t.weekdayContainer=ze("div","flatpickr-weekdays");for(var x=t.config.showMonths;x--;){var D=ze("div","flatpickr-weekdaycontainer");t.weekdayContainer.appendChild(D)}return J(),t.weekdayContainer}function J(){if(t.weekdayContainer){var x=t.l10n.firstDayOfWeek,D=wb(t.l10n.weekdays.shorthand);x>0&&x<D.length&&(D=wb(D.splice(x,D.length),D.splice(0,x)));for(var B=t.config.showMonths;B--;)t.weekdayContainer.children[B].innerHTML=`
      <span class='flatpickr-weekday'>
        `+D.join("</span><span class='flatpickr-weekday'>")+`
      </span>
      `}}function ne(){t.calendarContainer.classList.add("hasWeeks");var x=ze("div","flatpickr-weekwrapper");x.appendChild(ze("span","flatpickr-weekday",t.l10n.weekAbbreviation));var D=ze("div","flatpickr-weeks");return x.appendChild(D),{weekWrapper:x,weekNumbers:D}}function ae(x,D){D===void 0&&(D=!0);var B=D?x:x-t.currentMonth;B<0&&t._hidePrevMonthArrow===!0||B>0&&t._hideNextMonthArrow===!0||(t.currentMonth+=B,(t.currentMonth<0||t.currentMonth>11)&&(t.currentYear+=t.currentMonth>11?1:-1,t.currentMonth=(t.currentMonth+12)%12,Ke("onYearChange"),Z()),j(),Ke("onMonthChange"),is())}function ve(x,D){if(x===void 0&&(x=!0),D===void 0&&(D=!0),t.input.value="",t.altInput!==void 0&&(t.altInput.value=""),t.mobileInput!==void 0&&(t.mobileInput.value=""),t.selectedDates=[],t.latestSelectedDateObj=void 0,D===!0&&(t.currentYear=t._initialDate.getFullYear(),t.currentMonth=t._initialDate.getMonth()),t.config.enableTime===!0){var B=Sf(t.config),W=B.hours,oe=B.minutes,he=B.seconds;m(W,oe,he)}t.redraw(),x&&Ke("onChange")}function xe(){t.isOpen=!1,t.isMobile||(t.calendarContainer!==void 0&&t.calendarContainer.classList.remove("open"),t._input!==void 0&&t._input.classList.remove("active")),Ke("onClose")}function Pe(){t.config!==void 0&&Ke("onDestroy");for(var x=t._handlers.length;x--;)t._handlers[x].remove();if(t._handlers=[],t.mobileInput)t.mobileInput.parentNode&&t.mobileInput.parentNode.removeChild(t.mobileInput),t.mobileInput=void 0;else if(t.calendarContainer&&t.calendarContainer.parentNode)if(t.config.static&&t.calendarContainer.parentNode){var D=t.calendarContainer.parentNode;if(D.lastChild&&D.removeChild(D.lastChild),D.parentNode){for(;D.firstChild;)D.parentNode.insertBefore(D.firstChild,D);D.parentNode.removeChild(D)}}else t.calendarContainer.parentNode.removeChild(t.calendarContainer);t.altInput&&(t.input.type="text",t.altInput.parentNode&&t.altInput.parentNode.removeChild(t.altInput),delete t.altInput),t.input&&(t.input.type=t.input._type,t.input.classList.remove("flatpickr-input"),t.input.removeAttribute("readonly")),["_showTimeInput","latestSelectedDateObj","_hideNextMonthArrow","_hidePrevMonthArrow","__hideNextMonthArrow","__hidePrevMonthArrow","isMobile","isOpen","selectedDateElem","minDateHasTime","maxDateHasTime","days","daysContainer","_input","_positionElement","innerContainer","rContainer","monthNav","todayDateElem","calendarContainer","weekdayContainer","prevMonthNav","nextMonthNav","monthsDropdownContainer","currentMonthElement","currentYearElement","navigationCurrentMonth","selectedDateElem","config"].forEach(function(B){try{delete t[B]}catch{}})}function Se(x){return t.calendarContainer.contains(x)}function at(x){if(t.isOpen&&!t.config.inline){var D=Ii(x),B=Se(D),W=D===t.input||D===t.altInput||t.element.contains(D)||x.path&&x.path.indexOf&&(~x.path.indexOf(t.input)||~x.path.indexOf(t.altInput)),oe=!W&&!B&&!Se(x.relatedTarget),he=!t.config.ignoredFocusElements.some(function(we){return we.contains(D)});oe&&he&&(t.config.allowInput&&t.setDate(t._input.value,!1,t.config.altInput?t.config.altFormat:t.config.dateFormat),t.timeContainer!==void 0&&t.minuteElement!==void 0&&t.hourElement!==void 0&&t.input.value!==""&&t.input.value!==void 0&&l(),t.close(),t.config&&t.config.mode==="range"&&t.selectedDates.length===1&&t.clear(!1))}}function ft(x){if(!(!x||t.config.minDate&&x<t.config.minDate.getFullYear()||t.config.maxDate&&x>t.config.maxDate.getFullYear())){var D=x,B=t.currentYear!==D;t.currentYear=D||t.currentYear,t.config.maxDate&&t.currentYear===t.config.maxDate.getFullYear()?t.currentMonth=Math.min(t.config.maxDate.getMonth(),t.currentMonth):t.config.minDate&&t.currentYear===t.config.minDate.getFullYear()&&(t.currentMonth=Math.max(t.config.minDate.getMonth(),t.currentMonth)),B&&(t.redraw(),Ke("onYearChange"),Z())}}function Ge(x,D){var B;D===void 0&&(D=!0);var W=t.parseDate(x,void 0,D);if(t.config.minDate&&W&&$i(W,t.config.minDate,D!==void 0?D:!t.minDateHasTime)<0||t.config.maxDate&&W&&$i(W,t.config.maxDate,D!==void 0?D:!t.maxDateHasTime)>0)return!1;if(!t.config.enable&&t.config.disable.length===0)return!0;if(W===void 0)return!1;for(var oe=!!t.config.enable,he=(B=t.config.enable)!==null&&B!==void 0?B:t.config.disable,we=0,Oe=void 0;we<he.length;we++){if(Oe=he[we],typeof Oe=="function"&&Oe(W))return oe;if(Oe instanceof Date&&W!==void 0&&Oe.getTime()===W.getTime())return oe;if(typeof Oe=="string"){var Ae=t.parseDate(Oe,void 0,!0);return Ae&&Ae.getTime()===W.getTime()?oe:!oe}else if(typeof Oe=="object"&&W!==void 0&&Oe.from&&Oe.to&&W.getTime()>=Oe.from.getTime()&&W.getTime()<=Oe.to.getTime())return oe}return!oe}function _t(x){return t.daysContainer!==void 0?x.className.indexOf("hidden")===-1&&x.className.indexOf("flatpickr-disabled")===-1&&t.daysContainer.contains(x):!1}function yi(x){var D=x.target===t._input,B=t._input.value.trimEnd()!==rs();D&&B&&!(x.relatedTarget&&Se(x.relatedTarget))&&t.setDate(t._input.value,!0,x.target===t.altInput?t.config.altFormat:t.config.dateFormat)}function Pt(x){var D=Ii(x),B=t.config.wrap?r.contains(D):D===t._input,W=t.config.allowInput,oe=t.isOpen&&(!W||!B),he=t.config.inline&&B&&!W;if(x.keyCode===13&&B){if(W)return t.setDate(t._input.value,!0,D===t.altInput?t.config.altFormat:t.config.dateFormat),t.close(),D.blur();t.open()}else if(Se(D)||oe||he){var we=!!t.timeContainer&&t.timeContainer.contains(D);switch(x.keyCode){case 13:we?(x.preventDefault(),l(),Xi()):ji(x);break;case 27:x.preventDefault(),Xi();break;case 8:case 46:B&&!t.config.allowInput&&(x.preventDefault(),t.clear());break;case 37:case 39:if(!we&&!B){x.preventDefault();var Oe=n();if(t.daysContainer!==void 0&&(W===!1||Oe&&_t(Oe))){var Ae=x.keyCode===39?1:-1;x.ctrlKey?(x.stopPropagation(),ae(Ae),R(N(1),0)):R(void 0,Ae)}}else t.hourElement&&t.hourElement.focus();break;case 38:case 40:x.preventDefault();var pe=x.keyCode===40?1:-1;t.daysContainer&&D.$i!==void 0||D===t.input||D===t.altInput?x.ctrlKey?(x.stopPropagation(),ft(t.currentYear-pe),R(N(1),0)):we||R(void 0,pe*7):D===t.currentYearElement?ft(t.currentYear-pe):t.config.enableTime&&(!we&&t.hourElement&&t.hourElement.focus(),l(x),t._debouncedChange());break;case 9:if(we){var Te=[t.hourElement,t.minuteElement,t.secondElement,t.amPM].concat(t.pluginElements).filter(function(yt){return yt}),De=Te.indexOf(D);if(De!==-1){var Ot=Te[De+(x.shiftKey?-1:1)];x.preventDefault(),(Ot||t._input).focus()}}else!t.config.noCalendar&&t.daysContainer&&t.daysContainer.contains(D)&&x.shiftKey&&(x.preventDefault(),t._input.focus());break}}if(t.amPM!==void 0&&D===t.amPM)switch(x.key){case t.l10n.amPM[0].charAt(0):case t.l10n.amPM[0].charAt(0).toLowerCase():t.amPM.textContent=t.l10n.amPM[0],h(),bi();break;case t.l10n.amPM[1].charAt(0):case t.l10n.amPM[1].charAt(0).toLowerCase():t.amPM.textContent=t.l10n.amPM[1],h(),bi();break}(B||Se(D))&&Ke("onKeyDown",x)}function Dt(x,D){if(D===void 0&&(D="flatpickr-day"),!(t.selectedDates.length!==1||x&&(!x.classList.contains(D)||x.classList.contains("flatpickr-disabled")))){for(var B=x?x.dateObj.getTime():t.days.firstElementChild.dateObj.getTime(),W=t.parseDate(t.selectedDates[0],void 0,!0).getTime(),oe=Math.min(B,t.selectedDates[0].getTime()),he=Math.max(B,t.selectedDates[0].getTime()),we=!1,Oe=0,Ae=0,pe=oe;pe<he;pe+=p3.DAY)Ge(new Date(pe),!0)||(we=we||pe>oe&&pe<he,pe<W&&(!Oe||pe>Oe)?Oe=pe:pe>W&&(!Ae||pe<Ae)&&(Ae=pe));var Te=Array.from(t.rContainer.querySelectorAll("*:nth-child(-n+"+t.config.showMonths+") > ."+D));Te.forEach(function(De){var Ot=De.dateObj,yt=Ot.getTime(),ei=Oe>0&&yt<Oe||Ae>0&&yt>Ae;if(ei){De.classList.add("notAllowed"),["inRange","startRange","endRange"].forEach(function(Ve){De.classList.remove(Ve)});return}else if(we&&!ei)return;["startRange","inRange","endRange","notAllowed"].forEach(function(Ve){De.classList.remove(Ve)}),x!==void 0&&(x.classList.add(B<=t.selectedDates[0].getTime()?"startRange":"endRange"),W<B&&yt===W?De.classList.add("startRange"):W>B&&yt===W&&De.classList.add("endRange"),yt>=Oe&&(Ae===0||yt<=Ae)&&d3(yt,W,B)&&De.classList.add("inRange"))})}}function xr(){t.isOpen&&!t.config.static&&!t.config.inline&&zt()}function Mt(x,D){if(D===void 0&&(D=t._positionElement),t.isMobile===!0){if(x){x.preventDefault();var B=Ii(x);B&&B.blur()}t.mobileInput!==void 0&&(t.mobileInput.focus(),t.mobileInput.click()),Ke("onOpen");return}else if(t._input.disabled||t.config.inline)return;var W=t.isOpen;t.isOpen=!0,W||(t.calendarContainer.classList.add("open"),t._input.classList.add("active"),Ke("onOpen"),zt(D)),t.config.enableTime===!0&&t.config.noCalendar===!0&&t.config.allowInput===!1&&(x===void 0||!t.timeContainer.contains(x.relatedTarget))&&setTimeout(function(){return t.hourElement.select()},50)}function ur(x){return function(D){var B=t.config["_"+x+"Date"]=t.parseDate(D,t.config.dateFormat),W=t.config["_"+(x==="min"?"max":"min")+"Date"];B!==void 0&&(t[x==="min"?"minDateHasTime":"maxDateHasTime"]=B.getHours()>0||B.getMinutes()>0||B.getSeconds()>0),t.selectedDates&&(t.selectedDates=t.selectedDates.filter(function(oe){return Ge(oe)}),!t.selectedDates.length&&x==="min"&&f(B),bi()),t.daysContainer&&(it(),B!==void 0?t.currentYearElement[x]=B.getFullYear().toString():t.currentYearElement.removeAttribute(x),t.currentYearElement.disabled=!!W&&B!==void 0&&W.getFullYear()===B.getFullYear())}}function xt(){var x=["wrap","weekNumbers","allowInput","allowInvalidPreload","clickOpens","time_24hr","enableTime","noCalendar","altInput","shorthandCurrentMonth","inline","static","enableSeconds","disableMobile"],D=ti(ti({},JSON.parse(JSON.stringify(r.dataset||{}))),e),B={};t.config.parseDate=D.parseDate,t.config.formatDate=D.formatDate,Object.defineProperty(t.config,"enable",{get:function(){return t.config._enable},set:function(Te){t.config._enable=xs(Te)}}),Object.defineProperty(t.config,"disable",{get:function(){return t.config._disable},set:function(Te){t.config._disable=xs(Te)}});var W=D.mode==="time";if(!D.dateFormat&&(D.enableTime||W)){var oe=Et.defaultConfig.dateFormat||ba.dateFormat;B.dateFormat=D.noCalendar||W?"H:i"+(D.enableSeconds?":S":""):oe+" H:i"+(D.enableSeconds?":S":"")}if(D.altInput&&(D.enableTime||W)&&!D.altFormat){var he=Et.defaultConfig.altFormat||ba.altFormat;B.altFormat=D.noCalendar||W?"h:i"+(D.enableSeconds?":S K":" K"):he+(" h:i"+(D.enableSeconds?":S":"")+" K")}Object.defineProperty(t.config,"minDate",{get:function(){return t.config._minDate},set:ur("min")}),Object.defineProperty(t.config,"maxDate",{get:function(){return t.config._maxDate},set:ur("max")});var we=function(Te){return function(De){t.config[Te==="min"?"_minTime":"_maxTime"]=t.parseDate(De,"H:i:S")}};Object.defineProperty(t.config,"minTime",{get:function(){return t.config._minTime},set:we("min")}),Object.defineProperty(t.config,"maxTime",{get:function(){return t.config._maxTime},set:we("max")}),D.mode==="time"&&(t.config.noCalendar=!0,t.config.enableTime=!0),Object.assign(t.config,B,D);for(var Oe=0;Oe<x.length;Oe++)t.config[x[Oe]]=t.config[x[Oe]]===!0||t.config[x[Oe]]==="true";Of.filter(function(Te){return t.config[Te]!==void 0}).forEach(function(Te){t.config[Te]=yf(t.config[Te]||[]).map(a)}),t.isMobile=!t.config.disableMobile&&!t.config.inline&&t.config.mode==="single"&&!t.config.disable.length&&!t.config.enable&&!t.config.weekNumbers&&/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);for(var Oe=0;Oe<t.config.plugins.length;Oe++){var Ae=t.config.plugins[Oe](t)||{};for(var pe in Ae)Of.indexOf(pe)>-1?t.config[pe]=yf(Ae[pe]).map(a).concat(t.config[pe]):typeof D[pe]>"u"&&(t.config[pe]=Ae[pe])}D.altInputClass||(t.config.altInputClass=Kr().className+" "+t.config.altInputClass),Ke("onParseConfig")}function Kr(){return t.config.wrap?r.querySelector("[data-input]"):r}function Jt(){typeof t.config.locale!="object"&&typeof Et.l10ns[t.config.locale]>"u"&&t.config.errorHandler(new Error("flatpickr: invalid locale "+t.config.locale)),t.l10n=ti(ti({},Et.l10ns.default),typeof t.config.locale=="object"?t.config.locale:t.config.locale!=="default"?Et.l10ns[t.config.locale]:void 0),mn.D="("+t.l10n.weekdays.shorthand.join("|")+")",mn.l="("+t.l10n.weekdays.longhand.join("|")+")",mn.M="("+t.l10n.months.shorthand.join("|")+")",mn.F="("+t.l10n.months.longhand.join("|")+")",mn.K="("+t.l10n.amPM[0]+"|"+t.l10n.amPM[1]+"|"+t.l10n.amPM[0].toLowerCase()+"|"+t.l10n.amPM[1].toLowerCase()+")";var x=ti(ti({},e),JSON.parse(JSON.stringify(r.dataset||{})));x.time_24hr===void 0&&Et.defaultConfig.time_24hr===void 0&&(t.config.time_24hr=t.l10n.time_24hr),t.formatDate=$x(t),t.parseDate=Fp({config:t.config,l10n:t.l10n})}function zt(x){if(typeof t.config.position=="function")return void t.config.position(t,x);if(t.calendarContainer!==void 0){Ke("onPreCalendarPosition");var D=x||t._positionElement,B=Array.prototype.reduce.call(t.calendarContainer.children,(function(hu,Vn){return hu+Vn.offsetHeight}),0),W=t.calendarContainer.offsetWidth,oe=t.config.position.split(" "),he=oe[0],we=oe.length>1?oe[1]:null,Oe=D.getBoundingClientRect(),Ae=window.innerHeight-Oe.bottom,pe=he==="above"||he!=="below"&&Ae<B&&Oe.top>B,Te=window.pageYOffset+Oe.top+(pe?-B-2:D.offsetHeight+2);if(di(t.calendarContainer,"arrowTop",!pe),di(t.calendarContainer,"arrowBottom",pe),!t.config.inline){var De=window.pageXOffset+Oe.left,Ot=!1,yt=!1;we==="center"?(De-=(W-Oe.width)/2,Ot=!0):we==="right"&&(De-=W-Oe.width,yt=!0),di(t.calendarContainer,"arrowLeft",!Ot&&!yt),di(t.calendarContainer,"arrowCenter",Ot),di(t.calendarContainer,"arrowRight",yt);var ei=window.document.body.offsetWidth-(window.pageXOffset+Oe.right),Ve=De+W>window.document.body.offsetWidth,ss=ei+W>window.document.body.offsetWidth;if(di(t.calendarContainer,"rightMost",Ve),!t.config.static)if(t.calendarContainer.style.top=Te+"px",!Ve)t.calendarContainer.style.left=De+"px",t.calendarContainer.style.right="auto";else if(!ss)t.calendarContainer.style.left="auto",t.calendarContainer.style.right=ei+"px";else{var Ne=$e();if(Ne===void 0)return;var Fn=window.document.body.offsetWidth,Un=Math.max(0,Fn/2-W/2),qn=".flatpickr-calendar.centerMost:before",bd=".flatpickr-calendar.centerMost:after",ns=Ne.cssRules.length,ot="{left:"+Oe.left+"px;right:auto;}";di(t.calendarContainer,"rightMost",!1),di(t.calendarContainer,"centerMost",!0),Ne.insertRule(qn+","+bd+ot,ns),t.calendarContainer.style.left=Un+"px",t.calendarContainer.style.right="auto"}}}}function $e(){for(var x=null,D=0;D<document.styleSheets.length;D++){var B=document.styleSheets[D];if(B.cssRules){try{B.cssRules}catch{continue}x=B;break}}return x??tt()}function tt(){var x=document.createElement("style");return document.head.appendChild(x),x.sheet}function it(){t.config.noCalendar||t.isMobile||(Z(),is(),j())}function Xi(){t._input.focus(),window.navigator.userAgent.indexOf("MSIE")!==-1||navigator.msMaxTouchPoints!==void 0?setTimeout(t.close,0):t.close()}function ji(x){x.preventDefault(),x.stopPropagation();var D=function(Te){return Te.classList&&Te.classList.contains("flatpickr-day")&&!Te.classList.contains("flatpickr-disabled")&&!Te.classList.contains("notAllowed")},B=Qx(Ii(x),D);if(B!==void 0){var W=B,oe=t.latestSelectedDateObj=new Date(W.dateObj.getTime()),he=(oe.getMonth()<t.currentMonth||oe.getMonth()>t.currentMonth+t.config.showMonths-1)&&t.config.mode!=="range";if(t.selectedDateElem=W,t.config.mode==="single")t.selectedDates=[oe];else if(t.config.mode==="multiple"){var we=ts(oe);we?t.selectedDates.splice(parseInt(we),1):t.selectedDates.push(oe)}else t.config.mode==="range"&&(t.selectedDates.length===2&&t.clear(!1,!1),t.latestSelectedDateObj=oe,t.selectedDates.push(oe),$i(oe,t.selectedDates[0],!0)!==0&&t.selectedDates.sort(function(Te,De){return Te.getTime()-De.getTime()}));if(h(),he){var Oe=t.currentYear!==oe.getFullYear();t.currentYear=oe.getFullYear(),t.currentMonth=oe.getMonth(),Oe&&(Ke("onYearChange"),Z()),Ke("onMonthChange")}if(is(),j(),bi(),!he&&t.config.mode!=="range"&&t.config.showMonths===1?I(W):t.selectedDateElem!==void 0&&t.hourElement===void 0&&t.selectedDateElem&&t.selectedDateElem.focus(),t.hourElement!==void 0&&t.hourElement!==void 0&&t.hourElement.focus(),t.config.closeOnSelect){var Ae=t.config.mode==="single"&&!t.config.enableTime,pe=t.config.mode==="range"&&t.selectedDates.length===2&&!t.config.enableTime;(Ae||pe)&&Xi()}E()}}var zi={locale:[Jt,J],showMonths:[te,o,re],minDate:[_],maxDate:[_],positionElement:[qe],clickOpens:[function(){t.config.clickOpens===!0?(y(t._input,"focus",t.open),y(t._input,"click",t.open)):(t._input.removeEventListener("focus",t.open),t._input.removeEventListener("click",t.open))}]};function Jr(x,D){if(x!==null&&typeof x=="object"){Object.assign(t.config,x);for(var B in x)zi[B]!==void 0&&zi[B].forEach(function(W){return W()})}else t.config[x]=D,zi[x]!==void 0?zi[x].forEach(function(W){return W()}):Of.indexOf(x)>-1&&(t.config[x]=yf(D));t.redraw(),bi(!0)}function cr(x,D){var B=[];if(x instanceof Array)B=x.map(function(W){return t.parseDate(W,D)});else if(x instanceof Date||typeof x=="number")B=[t.parseDate(x,D)];else if(typeof x=="string")switch(t.config.mode){case"single":case"time":B=[t.parseDate(x,D)];break;case"multiple":B=x.split(t.config.conjunction).map(function(W){return t.parseDate(W,D)});break;case"range":B=x.split(t.l10n.rangeSeparator).map(function(W){return t.parseDate(W,D)});break}else t.config.errorHandler(new Error("Invalid date supplied: "+JSON.stringify(x)));t.selectedDates=t.config.allowInvalidPreload?B:B.filter(function(W){return W instanceof Date&&Ge(W,!1)}),t.config.mode==="range"&&t.selectedDates.sort(function(W,oe){return W.getTime()-oe.getTime()})}function wr(x,D,B){if(D===void 0&&(D=!1),B===void 0&&(B=t.config.dateFormat),x!==0&&!x||x instanceof Array&&x.length===0)return t.clear(D);cr(x,B),t.latestSelectedDateObj=t.selectedDates[t.selectedDates.length-1],t.redraw(),_(void 0,D),f(),t.selectedDates.length===0&&t.clear(!1),bi(D),D&&Ke("onChange")}function xs(x){return x.slice().map(function(D){return typeof D=="string"||typeof D=="number"||D instanceof Date?t.parseDate(D,void 0,!0):D&&typeof D=="object"&&D.from&&D.to?{from:t.parseDate(D.from,void 0),to:t.parseDate(D.to,void 0)}:D}).filter(function(D){return D})}function tn(){t.selectedDates=[],t.now=t.parseDate(t.config.now)||new Date;var x=t.config.defaultDate||((t.input.nodeName==="INPUT"||t.input.nodeName==="TEXTAREA")&&t.input.placeholder&&t.input.value===t.input.placeholder?null:t.input.value);x&&cr(x,t.config.dateFormat),t._initialDate=t.selectedDates.length>0?t.selectedDates[0]:t.config.minDate&&t.config.minDate.getTime()>t.now.getTime()?t.config.minDate:t.config.maxDate&&t.config.maxDate.getTime()<t.now.getTime()?t.config.maxDate:t.now,t.currentYear=t._initialDate.getFullYear(),t.currentMonth=t._initialDate.getMonth(),t.selectedDates.length>0&&(t.latestSelectedDateObj=t.selectedDates[0]),t.config.minTime!==void 0&&(t.config.minTime=t.parseDate(t.config.minTime,"H:i")),t.config.maxTime!==void 0&&(t.config.maxTime=t.parseDate(t.config.maxTime,"H:i")),t.minDateHasTime=!!t.config.minDate&&(t.config.minDate.getHours()>0||t.config.minDate.getMinutes()>0||t.config.minDate.getSeconds()>0),t.maxDateHasTime=!!t.config.maxDate&&(t.config.maxDate.getHours()>0||t.config.maxDate.getMinutes()>0||t.config.maxDate.getSeconds()>0)}function ws(){if(t.input=Kr(),!t.input){t.config.errorHandler(new Error("Invalid input element specified"));return}t.input._type=t.input.type,t.input.type="text",t.input.classList.add("flatpickr-input"),t._input=t.input,t.config.altInput&&(t.altInput=ze(t.input.nodeName,t.config.altInputClass),t._input=t.altInput,t.altInput.placeholder=t.input.placeholder,t.altInput.disabled=t.input.disabled,t.altInput.required=t.input.required,t.altInput.tabIndex=t.input.tabIndex,t.altInput.type="text",t.input.setAttribute("type","hidden"),!t.config.static&&t.input.parentNode&&t.input.parentNode.insertBefore(t.altInput,t.input.nextSibling)),t.config.allowInput||t._input.setAttribute("readonly","readonly"),qe()}function qe(){t._positionElement=t.config.positionElement||t._input}function rn(){var x=t.config.enableTime?t.config.noCalendar?"time":"datetime-local":"date";t.mobileInput=ze("input",t.input.className+" flatpickr-mobile"),t.mobileInput.tabIndex=1,t.mobileInput.type=x,t.mobileInput.disabled=t.input.disabled,t.mobileInput.required=t.input.required,t.mobileInput.placeholder=t.input.placeholder,t.mobileFormatStr=x==="datetime-local"?"Y-m-d\\TH:i:S":x==="date"?"Y-m-d":"H:i:S",t.selectedDates.length>0&&(t.mobileInput.defaultValue=t.mobileInput.value=t.formatDate(t.selectedDates[0],t.mobileFormatStr)),t.config.minDate&&(t.mobileInput.min=t.formatDate(t.config.minDate,"Y-m-d")),t.config.maxDate&&(t.mobileInput.max=t.formatDate(t.config.maxDate,"Y-m-d")),t.input.getAttribute("step")&&(t.mobileInput.step=String(t.input.getAttribute("step"))),t.input.type="hidden",t.altInput!==void 0&&(t.altInput.type="hidden");try{t.input.parentNode&&t.input.parentNode.insertBefore(t.mobileInput,t.input.nextSibling)}catch{}y(t.mobileInput,"change",function(D){t.setDate(Ii(D).value,!1,t.mobileFormatStr),Ke("onChange"),Ke("onClose")})}function es(x){if(t.isOpen===!0)return t.close();t.open(x)}function Ke(x,D){if(t.config!==void 0){var B=t.config[x];if(B!==void 0&&B.length>0)for(var W=0;B[W]&&W<B.length;W++)B[W](t.selectedDates,t.input.value,t,D);x==="onChange"&&(t.input.dispatchEvent(Cs("change")),t.input.dispatchEvent(Cs("input")))}}function Cs(x){var D=document.createEvent("Event");return D.initEvent(x,!0,!0),D}function ts(x){for(var D=0;D<t.selectedDates.length;D++){var B=t.selectedDates[D];if(B instanceof Date&&$i(B,x)===0)return""+D}return!1}function Cr(x){return t.config.mode!=="range"||t.selectedDates.length<2?!1:$i(x,t.selectedDates[0])>=0&&$i(x,t.selectedDates[1])<=0}function is(){t.config.noCalendar||t.isMobile||!t.monthNav||(t.yearElements.forEach(function(x,D){var B=new Date(t.currentYear,t.currentMonth,1);B.setMonth(t.currentMonth+D),t.config.showMonths>1||t.config.monthSelectorType==="static"?t.monthElements[D].textContent=rh(B.getMonth(),t.config.shorthandCurrentMonth,t.l10n)+" ":t.monthsDropdownContainer.value=B.getMonth().toString(),x.value=B.getFullYear().toString()}),t._hidePrevMonthArrow=t.config.minDate!==void 0&&(t.currentYear===t.config.minDate.getFullYear()?t.currentMonth<=t.config.minDate.getMonth():t.currentYear<t.config.minDate.getFullYear()),t._hideNextMonthArrow=t.config.maxDate!==void 0&&(t.currentYear===t.config.maxDate.getFullYear()?t.currentMonth+1>t.config.maxDate.getMonth():t.currentYear>t.config.maxDate.getFullYear()))}function rs(x){var D=x||(t.config.altInput?t.config.altFormat:t.config.dateFormat);return t.selectedDates.map(function(B){return t.formatDate(B,D)}).filter(function(B,W,oe){return t.config.mode!=="range"||t.config.enableTime||oe.indexOf(B)===W}).join(t.config.mode!=="range"?t.config.conjunction:t.l10n.rangeSeparator)}function bi(x){x===void 0&&(x=!0),t.mobileInput!==void 0&&t.mobileFormatStr&&(t.mobileInput.value=t.latestSelectedDateObj!==void 0?t.formatDate(t.latestSelectedDateObj,t.mobileFormatStr):""),t.input.value=rs(t.config.dateFormat),t.altInput!==void 0&&(t.altInput.value=rs(t.config.altFormat)),x!==!1&&Ke("onValueUpdate")}function M(x){var D=Ii(x),B=t.prevMonthNav.contains(D),W=t.nextMonthNav.contains(D);B||W?ae(B?-1:1):t.yearElements.indexOf(D)>=0?D.select():D.classList.contains("arrowUp")?t.changeYear(t.currentYear+1):D.classList.contains("arrowDown")&&t.changeYear(t.currentYear-1)}function L(x){x.preventDefault();var D=x.type==="keydown",B=Ii(x),W=B;t.amPM!==void 0&&B===t.amPM&&(t.amPM.textContent=t.l10n.amPM[Wi(t.amPM.textContent===t.l10n.amPM[0])]);var oe=parseFloat(W.getAttribute("min")),he=parseFloat(W.getAttribute("max")),we=parseFloat(W.getAttribute("step")),Oe=parseInt(W.value,10),Ae=x.delta||(D?x.which===38?1:-1:0),pe=Oe+we*Ae;if(typeof W.value<"u"&&W.value.length===2){var Te=W===t.hourElement,De=W===t.minuteElement;pe<oe?(pe=he+pe+Wi(!Te)+(Wi(Te)&&Wi(!t.amPM)),De&&T(void 0,-1,t.hourElement)):pe>he&&(pe=W===t.hourElement?pe-he-Wi(!t.amPM):oe,De&&T(void 0,1,t.hourElement)),t.amPM&&Te&&(we===1?pe+Oe===23:Math.abs(pe-Oe)>we)&&(t.amPM.textContent=t.l10n.amPM[Wi(t.amPM.textContent===t.l10n.amPM[0])]),W.value=Ti(pe)}}return s(),t}function va(r,e){for(var t=Array.prototype.slice.call(r).filter(function(a){return a instanceof HTMLElement}),i=[],s=0;s<t.length;s++){var n=t[s];try{if(n.getAttribute("data-fp-omit")!==null)continue;n._flatpickr!==void 0&&(n._flatpickr.destroy(),n._flatpickr=void 0),n._flatpickr=g3(n,e||{}),i.push(n._flatpickr)}catch(a){console.error(a)}}return i.length===1?i[0]:i}typeof HTMLElement<"u"&&typeof HTMLCollection<"u"&&typeof NodeList<"u"&&(HTMLCollection.prototype.flatpickr=NodeList.prototype.flatpickr=function(r){return va(this,r)},HTMLElement.prototype.flatpickr=function(r){return va([this],r)});var Et=function(r,e){return typeof r=="string"?va(window.document.querySelectorAll(r),e):r instanceof Node?va([r],e):va(r,e)};Et.defaultConfig={};Et.l10ns={en:ti({},Ol),default:ti({},Ol)};Et.localize=function(r){Et.l10ns.default=ti(ti({},Et.l10ns.default),r)};Et.setDefaults=function(r){Et.defaultConfig=ti(ti({},Et.defaultConfig),r)};Et.parseDate=Fp({});Et.formatDate=$x({});Et.compareDates=$i;typeof jQuery<"u"&&typeof jQuery.fn<"u"&&(jQuery.fn.flatpickr=function(r){return va(this,r)});Date.prototype.fp_incr=function(r){return new Date(this.getFullYear(),this.getMonth(),this.getDate()+(typeof r=="string"?parseInt(r,10):r))};typeof window<"u"&&(window.flatpickr=Et);let Up=[],Bx=[];(()=>{let r="lc,34,7n,7,7b,19,,,,2,,2,,,20,b,1c,l,g,,2t,7,2,6,2,2,,4,z,,u,r,2j,b,1m,9,9,,o,4,,9,,3,,5,17,3,3b,f,,w,1j,,,,4,8,4,,3,7,a,2,t,,1m,,,,2,4,8,,9,,a,2,q,,2,2,1l,,4,2,4,2,2,3,3,,u,2,3,,b,2,1l,,4,5,,2,4,,k,2,m,6,,,1m,,,2,,4,8,,7,3,a,2,u,,1n,,,,c,,9,,14,,3,,1l,3,5,3,,4,7,2,b,2,t,,1m,,2,,2,,3,,5,2,7,2,b,2,s,2,1l,2,,,2,4,8,,9,,a,2,t,,20,,4,,2,3,,,8,,29,,2,7,c,8,2q,,2,9,b,6,22,2,r,,,,,,1j,e,,5,,2,5,b,,10,9,,2u,4,,6,,2,2,2,p,2,4,3,g,4,d,,2,2,6,,f,,jj,3,qa,3,t,3,t,2,u,2,1s,2,,7,8,,2,b,9,,19,3,3b,2,y,,3a,3,4,2,9,,6,3,63,2,2,,1m,,,7,,,,,2,8,6,a,2,,1c,h,1r,4,1c,7,,,5,,14,9,c,2,w,4,2,2,,3,1k,,,2,3,,,3,1m,8,2,2,48,3,,d,,7,4,,6,,3,2,5i,1m,,5,ek,,5f,x,2da,3,3x,,2o,w,fe,6,2x,2,n9w,4,,a,w,2,28,2,7k,,3,,4,,p,2,5,,47,2,q,i,d,,12,8,p,b,1a,3,1c,,2,4,2,2,13,,1v,6,2,2,2,2,c,,8,,1b,,1f,,,3,2,2,5,2,,,16,2,8,,6m,,2,,4,,fn4,,kh,g,g,g,a6,2,gt,,6a,,45,5,1ae,3,,2,5,4,14,3,4,,4l,2,fx,4,ar,2,49,b,4w,,1i,f,1k,3,1d,4,2,2,1x,3,10,5,,8,1q,,c,2,1g,9,a,4,2,,2n,3,2,,,2,6,,4g,,3,8,l,2,1l,2,,,,,m,,e,7,3,5,5f,8,2,3,,,n,,29,,2,6,,,2,,,2,,2,6j,,2,4,6,2,,2,r,2,2d,8,2,,,2,2y,,,,2,6,,,2t,3,2,4,,5,77,9,,2,6t,,a,2,,,4,,40,4,2,2,4,,w,a,14,6,2,4,8,,9,6,2,3,1a,d,,2,ba,7,,6,,,2a,m,2,7,,2,,2,3e,6,3,,,2,,7,,,20,2,3,,,,9n,2,f0b,5,1n,7,t4,,1r,4,29,,f5k,2,43q,,,3,4,5,8,8,2,7,u,4,44,3,1iz,1j,4,1e,8,,e,,m,5,,f,11s,7,,h,2,7,,2,,5,79,7,c5,4,15s,7,31,7,240,5,gx7k,2o,3k,6o".split(",").map(e=>e?parseInt(e,36):1);for(let e=0,t=0;e<r.length;e++)(e%2?Bx:Up).push(t=t+r[e])})();function O3(r){if(r<768)return!1;for(let e=0,t=Up.length;;){let i=e+t>>1;if(r<Up[i])t=i;else if(r>=Bx[i])e=i+1;else return!0;if(e==t)return!1}}function Cb(r){return r>=127462&&r<=127487}const kb=8205;function y3(r,e,t=!0,i=!0){return(t?Nx:b3)(r,e,i)}function Nx(r,e,t){if(e==r.length)return e;e&&Fx(r.charCodeAt(e))&&Ux(r.charCodeAt(e-1))&&e--;let i=Tf(r,e);for(e+=Eb(i);e<r.length;){let s=Tf(r,e);if(i==kb||s==kb||t&&O3(s))e+=Eb(s),i=s;else if(Cb(s)){let n=0,a=e-2;for(;a>=0&&Cb(Tf(r,a));)n++,a-=2;if(n%2==0)break;e+=2}else break}return e}function b3(r,e,t){for(;e>0;){let i=Nx(r,e-2,t);if(i<e)return i;e--}return 0}function Tf(r,e){let t=r.charCodeAt(e);if(!Ux(t)||e+1==r.length)return t;let i=r.charCodeAt(e+1);return Fx(i)?(t-55296<<10)+(i-56320)+65536:t}function Fx(r){return r>=56320&&r<57344}function Ux(r){return r>=55296&&r<56320}function Eb(r){return r<65536?1:2}class Ue{lineAt(e){if(e<0||e>this.length)throw new RangeError(`Invalid position ${e} in document of length ${this.length}`);return this.lineInner(e,!1,1,0)}line(e){if(e<1||e>this.lines)throw new RangeError(`Invalid line number ${e} in ${this.lines}-line document`);return this.lineInner(e,!0,1,0)}replace(e,t,i){[e,t]=Qa(this,e,t);let s=[];return this.decompose(0,e,s,2),i.length&&i.decompose(0,i.length,s,3),this.decompose(t,this.length,s,1),Lr.from(s,this.length-(t-e)+i.length)}append(e){return this.replace(this.length,this.length,e)}slice(e,t=this.length){[e,t]=Qa(this,e,t);let i=[];return this.decompose(e,t,i,0),Lr.from(i,t-e)}eq(e){if(e==this)return!0;if(e.length!=this.length||e.lines!=this.lines)return!1;let t=this.scanIdentical(e,1),i=this.length-this.scanIdentical(e,-1),s=new tl(this),n=new tl(e);for(let a=t,o=t;;){if(s.next(a),n.next(a),a=0,s.lineBreak!=n.lineBreak||s.done!=n.done||s.value!=n.value)return!1;if(o+=s.value.length,s.done||o>=i)return!0}}iter(e=1){return new tl(this,e)}iterRange(e,t=this.length){return new qx(this,e,t)}iterLines(e,t){let i;if(e==null)i=this.iter();else{t==null&&(t=this.lines+1);let s=this.line(e).from;i=this.iterRange(s,Math.max(s,t==this.lines+1?this.length:t<=1?0:this.line(t-1).to))}return new Vx(i)}toString(){return this.sliceString(0)}toJSON(){let e=[];return this.flatten(e),e}constructor(){}static of(e){if(e.length==0)throw new RangeError("A document must have at least one line");return e.length==1&&!e[0]?Ue.empty:e.length<=32?new kt(e):Lr.from(kt.split(e,[]))}}class kt extends Ue{constructor(e,t=v3(e)){super(),this.text=e,this.length=t}get lines(){return this.text.length}get children(){return null}lineInner(e,t,i,s){for(let n=0;;n++){let a=this.text[n],o=s+a.length;if((t?i:o)>=e)return new S3(s,o,i,a);s=o+1,i++}}decompose(e,t,i,s){let n=e<=0&&t>=this.length?this:new kt(Ab(this.text,e,t),Math.min(t,this.length)-Math.max(0,e));if(s&1){let a=i.pop(),o=yc(n.text,a.text.slice(),0,n.length);if(o.length<=32)i.push(new kt(o,a.length+n.length));else{let l=o.length>>1;i.push(new kt(o.slice(0,l)),new kt(o.slice(l)))}}else i.push(n)}replace(e,t,i){if(!(i instanceof kt))return super.replace(e,t,i);[e,t]=Qa(this,e,t);let s=yc(this.text,yc(i.text,Ab(this.text,0,e)),t),n=this.length+i.length-(t-e);return s.length<=32?new kt(s,n):Lr.from(kt.split(s,[]),n)}sliceString(e,t=this.length,i=`
`){[e,t]=Qa(this,e,t);let s="";for(let n=0,a=0;n<=t&&a<this.text.length;a++){let o=this.text[a],l=n+o.length;n>e&&a&&(s+=i),e<l&&t>n&&(s+=o.slice(Math.max(0,e-n),t-n)),n=l+1}return s}flatten(e){for(let t of this.text)e.push(t)}scanIdentical(){return 0}static split(e,t){let i=[],s=-1;for(let n of e)i.push(n),s+=n.length+1,i.length==32&&(t.push(new kt(i,s)),i=[],s=-1);return s>-1&&t.push(new kt(i,s)),t}}class Lr extends Ue{constructor(e,t){super(),this.children=e,this.length=t,this.lines=0;for(let i of e)this.lines+=i.lines}lineInner(e,t,i,s){for(let n=0;;n++){let a=this.children[n],o=s+a.length,l=i+a.lines-1;if((t?l:o)>=e)return a.lineInner(e,t,i,s);s=o+1,i=l+1}}decompose(e,t,i,s){for(let n=0,a=0;a<=t&&n<this.children.length;n++){let o=this.children[n],l=a+o.length;if(e<=l&&t>=a){let u=s&((a<=e?1:0)|(l>=t?2:0));a>=e&&l<=t&&!u?i.push(o):o.decompose(e-a,t-a,i,u)}a=l+1}}replace(e,t,i){if([e,t]=Qa(this,e,t),i.lines<this.lines)for(let s=0,n=0;s<this.children.length;s++){let a=this.children[s],o=n+a.length;if(e>=n&&t<=o){let l=a.replace(e-n,t-n,i),u=this.lines-a.lines+l.lines;if(l.lines<u>>4&&l.lines>u>>6){let c=this.children.slice();return c[s]=l,new Lr(c,this.length-(t-e)+i.length)}return super.replace(n,o,l)}n=o+1}return super.replace(e,t,i)}sliceString(e,t=this.length,i=`
`){[e,t]=Qa(this,e,t);let s="";for(let n=0,a=0;n<this.children.length&&a<=t;n++){let o=this.children[n],l=a+o.length;a>e&&n&&(s+=i),e<l&&t>a&&(s+=o.sliceString(e-a,t-a,i)),a=l+1}return s}flatten(e){for(let t of this.children)t.flatten(e)}scanIdentical(e,t){if(!(e instanceof Lr))return 0;let i=0,[s,n,a,o]=t>0?[0,0,this.children.length,e.children.length]:[this.children.length-1,e.children.length-1,-1,-1];for(;;s+=t,n+=t){if(s==a||n==o)return i;let l=this.children[s],u=e.children[n];if(l!=u)return i+l.scanIdentical(u,t);i+=l.length+1}}static from(e,t=e.reduce((i,s)=>i+s.length+1,-1)){let i=0;for(let m of e)i+=m.lines;if(i<32){let m=[];for(let S of e)S.flatten(m);return new kt(m,t)}let s=Math.max(32,i>>5),n=s<<1,a=s>>1,o=[],l=0,u=-1,c=[];function h(m){let S;if(m.lines>n&&m instanceof Lr)for(let y of m.children)h(y);else m.lines>a&&(l>a||!l)?(f(),o.push(m)):m instanceof kt&&l&&(S=c[c.length-1])instanceof kt&&m.lines+S.lines<=32?(l+=m.lines,u+=m.length+1,c[c.length-1]=new kt(S.text.concat(m.text),S.length+1+m.length)):(l+m.lines>s&&f(),l+=m.lines,u+=m.length+1,c.push(m))}function f(){l!=0&&(o.push(c.length==1?c[0]:Lr.from(c,u)),u=-1,l=c.length=0)}for(let m of e)h(m);return f(),o.length==1?o[0]:new Lr(o,t)}}Ue.empty=new kt([""],0);function v3(r){let e=-1;for(let t of r)e+=t.length+1;return e}function yc(r,e,t=0,i=1e9){for(let s=0,n=0,a=!0;n<r.length&&s<=i;n++){let o=r[n],l=s+o.length;l>=t&&(l>i&&(o=o.slice(0,i-s)),s<t&&(o=o.slice(t-s)),a?(e[e.length-1]+=o,a=!1):e.push(o)),s=l+1}return e}function Ab(r,e,t){return yc(r,[""],e,t)}class tl{constructor(e,t=1){this.dir=t,this.done=!1,this.lineBreak=!1,this.value="",this.nodes=[e],this.offsets=[t>0?1:(e instanceof kt?e.text.length:e.children.length)<<1]}nextInner(e,t){for(this.done=this.lineBreak=!1;;){let i=this.nodes.length-1,s=this.nodes[i],n=this.offsets[i],a=n>>1,o=s instanceof kt?s.text.length:s.children.length;if(a==(t>0?o:0)){if(i==0)return this.done=!0,this.value="",this;t>0&&this.offsets[i-1]++,this.nodes.pop(),this.offsets.pop()}else if((n&1)==(t>0?0:1)){if(this.offsets[i]+=t,e==0)return this.lineBreak=!0,this.value=`
`,this;e--}else if(s instanceof kt){let l=s.text[a+(t<0?-1:0)];if(this.offsets[i]+=t,l.length>Math.max(0,e))return this.value=e==0?l:t>0?l.slice(e):l.slice(0,l.length-e),this;e-=l.length}else{let l=s.children[a+(t<0?-1:0)];e>l.length?(e-=l.length,this.offsets[i]+=t):(t<0&&this.offsets[i]--,this.nodes.push(l),this.offsets.push(t>0?1:(l instanceof kt?l.text.length:l.children.length)<<1))}}}next(e=0){return e<0&&(this.nextInner(-e,-this.dir),e=this.value.length),this.nextInner(e,this.dir)}}class qx{constructor(e,t,i){this.value="",this.done=!1,this.cursor=new tl(e,t>i?-1:1),this.pos=t>i?e.length:0,this.from=Math.min(t,i),this.to=Math.max(t,i)}nextInner(e,t){if(t<0?this.pos<=this.from:this.pos>=this.to)return this.value="",this.done=!0,this;e+=Math.max(0,t<0?this.pos-this.to:this.from-this.pos);let i=t<0?this.pos-this.from:this.to-this.pos;e>i&&(e=i),i-=e;let{value:s}=this.cursor.next(e);return this.pos+=(s.length+e)*t,this.value=s.length<=i?s:t<0?s.slice(s.length-i):s.slice(0,i),this.done=!this.value,this}next(e=0){return e<0?e=Math.max(e,this.from-this.pos):e>0&&(e=Math.min(e,this.to-this.pos)),this.nextInner(e,this.cursor.dir)}get lineBreak(){return this.cursor.lineBreak&&this.value!=""}}class Vx{constructor(e){this.inner=e,this.afterBreak=!0,this.value="",this.done=!1}next(e=0){let{done:t,lineBreak:i,value:s}=this.inner.next(e);return t&&this.afterBreak?(this.value="",this.afterBreak=!1):t?(this.done=!0,this.value=""):i?this.afterBreak?this.value="":(this.afterBreak=!0,this.next()):(this.value=s,this.afterBreak=!1),this}get lineBreak(){return!1}}typeof Symbol<"u"&&(Ue.prototype[Symbol.iterator]=function(){return this.iter()},tl.prototype[Symbol.iterator]=qx.prototype[Symbol.iterator]=Vx.prototype[Symbol.iterator]=function(){return this});let S3=class{constructor(e,t,i,s){this.from=e,this.to=t,this.number=i,this.text=s}get length(){return this.to-this.from}};function Qa(r,e,t){return e=Math.max(0,Math.min(r.length,e)),[e,Math.max(e,Math.min(r.length,t))]}function Kt(r,e,t=!0,i=!0){return y3(r,e,t,i)}function T3(r){return r>=56320&&r<57344}function _3(r){return r>=55296&&r<56320}function xi(r,e){let t=r.charCodeAt(e);if(!_3(t)||e+1==r.length)return t;let i=r.charCodeAt(e+1);return T3(i)?(t-55296<<10)+(i-56320)+65536:t}function Zg(r){return r<=65535?String.fromCharCode(r):(r-=65536,String.fromCharCode((r>>10)+55296,(r&1023)+56320))}function Qr(r){return r<65536?1:2}const qp=/\r\n?|\n/;var Yt=(function(r){return r[r.Simple=0]="Simple",r[r.TrackDel=1]="TrackDel",r[r.TrackBefore=2]="TrackBefore",r[r.TrackAfter=3]="TrackAfter",r})(Yt||(Yt={}));class jr{constructor(e){this.sections=e}get length(){let e=0;for(let t=0;t<this.sections.length;t+=2)e+=this.sections[t];return e}get newLength(){let e=0;for(let t=0;t<this.sections.length;t+=2){let i=this.sections[t+1];e+=i<0?this.sections[t]:i}return e}get empty(){return this.sections.length==0||this.sections.length==2&&this.sections[1]<0}iterGaps(e){for(let t=0,i=0,s=0;t<this.sections.length;){let n=this.sections[t++],a=this.sections[t++];a<0?(e(i,s,n),s+=n):s+=a,i+=n}}iterChangedRanges(e,t=!1){Vp(this,e,t)}get invertedDesc(){let e=[];for(let t=0;t<this.sections.length;){let i=this.sections[t++],s=this.sections[t++];s<0?e.push(i,s):e.push(s,i)}return new jr(e)}composeDesc(e){return this.empty?e:e.empty?this:Xx(this,e)}mapDesc(e,t=!1){return e.empty?this:Xp(this,e,t)}mapPos(e,t=-1,i=Yt.Simple){let s=0,n=0;for(let a=0;a<this.sections.length;){let o=this.sections[a++],l=this.sections[a++],u=s+o;if(l<0){if(u>e)return n+(e-s);n+=o}else{if(i!=Yt.Simple&&u>=e&&(i==Yt.TrackDel&&s<e&&u>e||i==Yt.TrackBefore&&s<e||i==Yt.TrackAfter&&u>e))return null;if(u>e||u==e&&t<0&&!o)return e==s||t<0?n:n+l;n+=l}s=u}if(e>s)throw new RangeError(`Position ${e} is out of range for changeset of length ${s}`);return n}touchesRange(e,t=e){for(let i=0,s=0;i<this.sections.length&&s<=t;){let n=this.sections[i++],a=this.sections[i++],o=s+n;if(a>=0&&s<=t&&o>=e)return s<e&&o>t?"cover":!0;s=o}return!1}toString(){let e="";for(let t=0;t<this.sections.length;){let i=this.sections[t++],s=this.sections[t++];e+=(e?" ":"")+i+(s>=0?":"+s:"")}return e}toJSON(){return this.sections}static fromJSON(e){if(!Array.isArray(e)||e.length%2||e.some(t=>typeof t!="number"))throw new RangeError("Invalid JSON representation of ChangeDesc");return new jr(e)}static create(e){return new jr(e)}}class $t extends jr{constructor(e,t){super(e),this.inserted=t}apply(e){if(this.length!=e.length)throw new RangeError("Applying change set to a document with the wrong length");return Vp(this,(t,i,s,n,a)=>e=e.replace(s,s+(i-t),a),!1),e}mapDesc(e,t=!1){return Xp(this,e,t,!0)}invert(e){let t=this.sections.slice(),i=[];for(let s=0,n=0;s<t.length;s+=2){let a=t[s],o=t[s+1];if(o>=0){t[s]=o,t[s+1]=a;let l=s>>1;for(;i.length<l;)i.push(Ue.empty);i.push(a?e.slice(n,n+a):Ue.empty)}n+=a}return new $t(t,i)}compose(e){return this.empty?e:e.empty?this:Xx(this,e,!0)}map(e,t=!1){return e.empty?this:Xp(this,e,t,!0)}iterChanges(e,t=!1){Vp(this,e,t)}get desc(){return jr.create(this.sections)}filter(e){let t=[],i=[],s=[],n=new yl(this);e:for(let a=0,o=0;;){let l=a==e.length?1e9:e[a++];for(;o<l||o==l&&n.len==0;){if(n.done)break e;let c=Math.min(n.len,l-o);ii(s,c,-1);let h=n.ins==-1?-1:n.off==0?n.ins:0;ii(t,c,h),h>0&&Us(i,t,n.text),n.forward(c),o+=c}let u=e[a++];for(;o<u;){if(n.done)break e;let c=Math.min(n.len,u-o);ii(t,c,-1),ii(s,c,n.ins==-1?-1:n.off==0?n.ins:0),n.forward(c),o+=c}}return{changes:new $t(t,i),filtered:jr.create(s)}}toJSON(){let e=[];for(let t=0;t<this.sections.length;t+=2){let i=this.sections[t],s=this.sections[t+1];s<0?e.push(i):s==0?e.push([i]):e.push([i].concat(this.inserted[t>>1].toJSON()))}return e}static of(e,t,i){let s=[],n=[],a=0,o=null;function l(c=!1){if(!c&&!s.length)return;a<t&&ii(s,t-a,-1);let h=new $t(s,n);o=o?o.compose(h.map(o)):h,s=[],n=[],a=0}function u(c){if(Array.isArray(c))for(let h of c)u(h);else if(c instanceof $t){if(c.length!=t)throw new RangeError(`Mismatched change set length (got ${c.length}, expected ${t})`);l(),o=o?o.compose(c.map(o)):c}else{let{from:h,to:f=h,insert:m}=c;if(h>f||h<0||f>t)throw new RangeError(`Invalid change range ${h} to ${f} (in doc of length ${t})`);let S=m?typeof m=="string"?Ue.of(m.split(i||qp)):m:Ue.empty,y=S.length;if(h==f&&y==0)return;h<a&&l(),h>a&&ii(s,h-a,-1),ii(s,f-h,y),Us(n,s,S),a=f}}return u(e),l(!o),o}static empty(e){return new $t(e?[e,-1]:[],[])}static fromJSON(e){if(!Array.isArray(e))throw new RangeError("Invalid JSON representation of ChangeSet");let t=[],i=[];for(let s=0;s<e.length;s++){let n=e[s];if(typeof n=="number")t.push(n,-1);else{if(!Array.isArray(n)||typeof n[0]!="number"||n.some((a,o)=>o&&typeof a!="string"))throw new RangeError("Invalid JSON representation of ChangeSet");if(n.length==1)t.push(n[0],0);else{for(;i.length<s;)i.push(Ue.empty);i[s]=Ue.of(n.slice(1)),t.push(n[0],i[s].length)}}}return new $t(t,i)}static createSet(e,t){return new $t(e,t)}}function ii(r,e,t,i=!1){if(e==0&&t<=0)return;let s=r.length-2;s>=0&&t<=0&&t==r[s+1]?r[s]+=e:s>=0&&e==0&&r[s]==0?r[s+1]+=t:i?(r[s]+=e,r[s+1]+=t):r.push(e,t)}function Us(r,e,t){if(t.length==0)return;let i=e.length-2>>1;if(i<r.length)r[r.length-1]=r[r.length-1].append(t);else{for(;r.length<i;)r.push(Ue.empty);r.push(t)}}function Vp(r,e,t){let i=r.inserted;for(let s=0,n=0,a=0;a<r.sections.length;){let o=r.sections[a++],l=r.sections[a++];if(l<0)s+=o,n+=o;else{let u=s,c=n,h=Ue.empty;for(;u+=o,c+=l,l&&i&&(h=h.append(i[a-2>>1])),!(t||a==r.sections.length||r.sections[a+1]<0);)o=r.sections[a++],l=r.sections[a++];e(s,u,n,c,h),s=u,n=c}}}function Xp(r,e,t,i=!1){let s=[],n=i?[]:null,a=new yl(r),o=new yl(e);for(let l=-1;;){if(a.done&&o.len||o.done&&a.len)throw new Error("Mismatched change set lengths");if(a.ins==-1&&o.ins==-1){let u=Math.min(a.len,o.len);ii(s,u,-1),a.forward(u),o.forward(u)}else if(o.ins>=0&&(a.ins<0||l==a.i||a.off==0&&(o.len<a.len||o.len==a.len&&!t))){let u=o.len;for(ii(s,o.ins,-1);u;){let c=Math.min(a.len,u);a.ins>=0&&l<a.i&&a.len<=c&&(ii(s,0,a.ins),n&&Us(n,s,a.text),l=a.i),a.forward(c),u-=c}o.next()}else if(a.ins>=0){let u=0,c=a.len;for(;c;)if(o.ins==-1){let h=Math.min(c,o.len);u+=h,c-=h,o.forward(h)}else if(o.ins==0&&o.len<c)c-=o.len,o.next();else break;ii(s,u,l<a.i?a.ins:0),n&&l<a.i&&Us(n,s,a.text),l=a.i,a.forward(a.len-c)}else{if(a.done&&o.done)return n?$t.createSet(s,n):jr.create(s);throw new Error("Mismatched change set lengths")}}}function Xx(r,e,t=!1){let i=[],s=t?[]:null,n=new yl(r),a=new yl(e);for(let o=!1;;){if(n.done&&a.done)return s?$t.createSet(i,s):jr.create(i);if(n.ins==0)ii(i,n.len,0,o),n.next();else if(a.len==0&&!a.done)ii(i,0,a.ins,o),s&&Us(s,i,a.text),a.next();else{if(n.done||a.done)throw new Error("Mismatched change set lengths");{let l=Math.min(n.len2,a.len),u=i.length;if(n.ins==-1){let c=a.ins==-1?-1:a.off?0:a.ins;ii(i,l,c,o),s&&c&&Us(s,i,a.text)}else a.ins==-1?(ii(i,n.off?0:n.len,l,o),s&&Us(s,i,n.textBit(l))):(ii(i,n.off?0:n.len,a.off?0:a.ins,o),s&&!a.off&&Us(s,i,a.text));o=(n.ins>l||a.ins>=0&&a.len>l)&&(o||i.length>u),n.forward2(l),a.forward(l)}}}}class yl{constructor(e){this.set=e,this.i=0,this.next()}next(){let{sections:e}=this.set;this.i<e.length?(this.len=e[this.i++],this.ins=e[this.i++]):(this.len=0,this.ins=-2),this.off=0}get done(){return this.ins==-2}get len2(){return this.ins<0?this.len:this.ins}get text(){let{inserted:e}=this.set,t=this.i-2>>1;return t>=e.length?Ue.empty:e[t]}textBit(e){let{inserted:t}=this.set,i=this.i-2>>1;return i>=t.length&&!e?Ue.empty:t[i].slice(this.off,e==null?void 0:this.off+e)}forward(e){e==this.len?this.next():(this.len-=e,this.off+=e)}forward2(e){this.ins==-1?this.forward(e):e==this.ins?this.next():(this.ins-=e,this.off+=e)}}class vn{constructor(e,t,i){this.from=e,this.to=t,this.flags=i}get anchor(){return this.flags&32?this.to:this.from}get head(){return this.flags&32?this.from:this.to}get empty(){return this.from==this.to}get assoc(){return this.flags&8?-1:this.flags&16?1:0}get bidiLevel(){let e=this.flags&7;return e==7?null:e}get goalColumn(){let e=this.flags>>6;return e==16777215?void 0:e}map(e,t=-1){let i,s;return this.empty?i=s=e.mapPos(this.from,t):(i=e.mapPos(this.from,1),s=e.mapPos(this.to,-1)),i==this.from&&s==this.to?this:new vn(i,s,this.flags)}extend(e,t=e){if(e<=this.anchor&&t>=this.anchor)return ie.range(e,t);let i=Math.abs(e-this.anchor)>Math.abs(t-this.anchor)?e:t;return ie.range(this.anchor,i)}eq(e,t=!1){return this.anchor==e.anchor&&this.head==e.head&&(!t||!this.empty||this.assoc==e.assoc)}toJSON(){return{anchor:this.anchor,head:this.head}}static fromJSON(e){if(!e||typeof e.anchor!="number"||typeof e.head!="number")throw new RangeError("Invalid JSON representation for SelectionRange");return ie.range(e.anchor,e.head)}static create(e,t,i){return new vn(e,t,i)}}class ie{constructor(e,t){this.ranges=e,this.mainIndex=t}map(e,t=-1){return e.empty?this:ie.create(this.ranges.map(i=>i.map(e,t)),this.mainIndex)}eq(e,t=!1){if(this.ranges.length!=e.ranges.length||this.mainIndex!=e.mainIndex)return!1;for(let i=0;i<this.ranges.length;i++)if(!this.ranges[i].eq(e.ranges[i],t))return!1;return!0}get main(){return this.ranges[this.mainIndex]}asSingle(){return this.ranges.length==1?this:new ie([this.main],0)}addRange(e,t=!0){return ie.create([e].concat(this.ranges),t?0:this.mainIndex+1)}replaceRange(e,t=this.mainIndex){let i=this.ranges.slice();return i[t]=e,ie.create(i,this.mainIndex)}toJSON(){return{ranges:this.ranges.map(e=>e.toJSON()),main:this.mainIndex}}static fromJSON(e){if(!e||!Array.isArray(e.ranges)||typeof e.main!="number"||e.main>=e.ranges.length)throw new RangeError("Invalid JSON representation for EditorSelection");return new ie(e.ranges.map(t=>vn.fromJSON(t)),e.main)}static single(e,t=e){return new ie([ie.range(e,t)],0)}static create(e,t=0){if(e.length==0)throw new RangeError("A selection needs at least one range");for(let i=0,s=0;s<e.length;s++){let n=e[s];if(n.empty?n.from<=i:n.from<i)return ie.normalized(e.slice(),t);i=n.to}return new ie(e,t)}static cursor(e,t=0,i,s){return vn.create(e,e,(t==0?0:t<0?8:16)|(i==null?7:Math.min(6,i))|(s??16777215)<<6)}static range(e,t,i,s){let n=(i??16777215)<<6|(s==null?7:Math.min(6,s));return t<e?vn.create(t,e,48|n):vn.create(e,t,(t>e?8:0)|n)}static normalized(e,t=0){let i=e[t];e.sort((s,n)=>s.from-n.from),t=e.indexOf(i);for(let s=1;s<e.length;s++){let n=e[s],a=e[s-1];if(n.empty?n.from<=a.to:n.from<a.to){let o=a.from,l=Math.max(n.to,a.to);s<=t&&t--,e.splice(--s,2,n.anchor>n.head?ie.range(l,o):ie.range(o,l))}}return new ie(e,t)}}function jx(r,e){for(let t of r.ranges)if(t.to>e)throw new RangeError("Selection points outside of document")}let Wg=0;class be{constructor(e,t,i,s,n){this.combine=e,this.compareInput=t,this.compare=i,this.isStatic=s,this.id=Wg++,this.default=e([]),this.extensions=typeof n=="function"?n(this):n}get reader(){return this}static define(e={}){return new be(e.combine||(t=>t),e.compareInput||((t,i)=>t===i),e.compare||(e.combine?(t,i)=>t===i:Hg),!!e.static,e.enables)}of(e){return new bc([],this,0,e)}compute(e,t){if(this.isStatic)throw new Error("Can't compute a static facet");return new bc(e,this,1,t)}computeN(e,t){if(this.isStatic)throw new Error("Can't compute a static facet");return new bc(e,this,2,t)}from(e,t){return t||(t=i=>i),this.compute([e],i=>t(i.field(e)))}}function Hg(r,e){return r==e||r.length==e.length&&r.every((t,i)=>t===e[i])}class bc{constructor(e,t,i,s){this.dependencies=e,this.facet=t,this.type=i,this.value=s,this.id=Wg++}dynamicSlot(e){var t;let i=this.value,s=this.facet.compareInput,n=this.id,a=e[n]>>1,o=this.type==2,l=!1,u=!1,c=[];for(let h of this.dependencies)h=="doc"?l=!0:h=="selection"?u=!0:(((t=e[h.id])!==null&&t!==void 0?t:1)&1)==0&&c.push(e[h.id]);return{create(h){return h.values[a]=i(h),1},update(h,f){if(l&&f.docChanged||u&&(f.docChanged||f.selection)||jp(h,c)){let m=i(h);if(o?!Pb(m,h.values[a],s):!s(m,h.values[a]))return h.values[a]=m,1}return 0},reconfigure:(h,f)=>{let m,S=f.config.address[n];if(S!=null){let y=nh(f,S);if(this.dependencies.every(E=>E instanceof be?f.facet(E)===h.facet(E):E instanceof jt?f.field(E,!1)==h.field(E,!1):!0)||(o?Pb(m=i(h),y,s):s(m=i(h),y)))return h.values[a]=y,0}else m=i(h);return h.values[a]=m,1}}}}function Pb(r,e,t){if(r.length!=e.length)return!1;for(let i=0;i<r.length;i++)if(!t(r[i],e[i]))return!1;return!0}function jp(r,e){let t=!1;for(let i of e)il(r,i)&1&&(t=!0);return t}function x3(r,e,t){let i=t.map(l=>r[l.id]),s=t.map(l=>l.type),n=i.filter(l=>!(l&1)),a=r[e.id]>>1;function o(l){let u=[];for(let c=0;c<i.length;c++){let h=nh(l,i[c]);if(s[c]==2)for(let f of h)u.push(f);else u.push(h)}return e.combine(u)}return{create(l){for(let u of i)il(l,u);return l.values[a]=o(l),1},update(l,u){if(!jp(l,n))return 0;let c=o(l);return e.compare(c,l.values[a])?0:(l.values[a]=c,1)},reconfigure(l,u){let c=jp(l,i),h=u.config.facets[e.id],f=u.facet(e);if(h&&!c&&Hg(t,h))return l.values[a]=f,0;let m=o(l);return e.compare(m,f)?(l.values[a]=f,0):(l.values[a]=m,1)}}}const Xu=be.define({static:!0});class jt{constructor(e,t,i,s,n){this.id=e,this.createF=t,this.updateF=i,this.compareF=s,this.spec=n,this.provides=void 0}static define(e){let t=new jt(Wg++,e.create,e.update,e.compare||((i,s)=>i===s),e);return e.provide&&(t.provides=e.provide(t)),t}create(e){let t=e.facet(Xu).find(i=>i.field==this);return(t?.create||this.createF)(e)}slot(e){let t=e[this.id]>>1;return{create:i=>(i.values[t]=this.create(i),1),update:(i,s)=>{let n=i.values[t],a=this.updateF(n,s);return this.compareF(n,a)?0:(i.values[t]=a,1)},reconfigure:(i,s)=>{let n=i.facet(Xu),a=s.facet(Xu),o;return(o=n.find(l=>l.field==this))&&o!=a.find(l=>l.field==this)?(i.values[t]=o.create(i),1):s.config.address[this.id]!=null?(i.values[t]=s.field(this),0):(i.values[t]=this.create(i),1)}}}init(e){return[this,Xu.of({field:this,create:e})]}get extension(){return this}}const gn={lowest:4,low:3,default:2,high:1,highest:0};function Ao(r){return e=>new zx(e,r)}const Ss={highest:Ao(gn.highest),high:Ao(gn.high),default:Ao(gn.default),low:Ao(gn.low),lowest:Ao(gn.lowest)};class zx{constructor(e,t){this.inner=e,this.prec=t}}class nd{of(e){return new zp(this,e)}reconfigure(e){return nd.reconfigure.of({compartment:this,extension:e})}get(e){return e.config.compartments.get(this)}}class zp{constructor(e,t){this.compartment=e,this.inner=t}}class sh{constructor(e,t,i,s,n,a){for(this.base=e,this.compartments=t,this.dynamicSlots=i,this.address=s,this.staticValues=n,this.facets=a,this.statusTemplate=[];this.statusTemplate.length<i.length;)this.statusTemplate.push(0)}staticFacet(e){let t=this.address[e.id];return t==null?e.default:this.staticValues[t>>1]}static resolve(e,t,i){let s=[],n=Object.create(null),a=new Map;for(let f of w3(e,t,a))f instanceof jt?s.push(f):(n[f.facet.id]||(n[f.facet.id]=[])).push(f);let o=Object.create(null),l=[],u=[];for(let f of s)o[f.id]=u.length<<1,u.push(m=>f.slot(m));let c=i?.config.facets;for(let f in n){let m=n[f],S=m[0].facet,y=c&&c[f]||[];if(m.every(E=>E.type==0))if(o[S.id]=l.length<<1|1,Hg(y,m))l.push(i.facet(S));else{let E=S.combine(m.map(C=>C.value));l.push(i&&S.compare(E,i.facet(S))?i.facet(S):E)}else{for(let E of m)E.type==0?(o[E.id]=l.length<<1|1,l.push(E.value)):(o[E.id]=u.length<<1,u.push(C=>E.dynamicSlot(C)));o[S.id]=u.length<<1,u.push(E=>x3(E,S,m))}}let h=u.map(f=>f(o));return new sh(e,a,h,o,l,n)}}function w3(r,e,t){let i=[[],[],[],[],[]],s=new Map;function n(a,o){let l=s.get(a);if(l!=null){if(l<=o)return;let u=i[l].indexOf(a);u>-1&&i[l].splice(u,1),a instanceof zp&&t.delete(a.compartment)}if(s.set(a,o),Array.isArray(a))for(let u of a)n(u,o);else if(a instanceof zp){if(t.has(a.compartment))throw new RangeError("Duplicate use of compartment in extensions");let u=e.get(a.compartment)||a.inner;t.set(a.compartment,u),n(u,o)}else if(a instanceof zx)n(a.inner,a.prec);else if(a instanceof jt)i[o].push(a),a.provides&&n(a.provides,o);else if(a instanceof bc)i[o].push(a),a.facet.extensions&&n(a.facet.extensions,gn.default);else{let u=a.extension;if(!u)throw new Error(`Unrecognized extension value in extension set (${a}). This sometimes happens because multiple instances of @codemirror/state are loaded, breaking instanceof checks.`);n(u,o)}}return n(r,gn.default),i.reduce((a,o)=>a.concat(o))}function il(r,e){if(e&1)return 2;let t=e>>1,i=r.status[t];if(i==4)throw new Error("Cyclic dependency between fields and/or facets");if(i&2)return i;r.status[t]=4;let s=r.computeSlot(r,r.config.dynamicSlots[t]);return r.status[t]=2|s}function nh(r,e){return e&1?r.config.staticValues[e>>1]:r.values[e>>1]}const Zx=be.define(),Zp=be.define({combine:r=>r.some(e=>e),static:!0}),Wx=be.define({combine:r=>r.length?r[0]:void 0,static:!0}),Hx=be.define(),Yx=be.define(),Gx=be.define(),Kx=be.define({combine:r=>r.length?r[0]:!1});class Ts{constructor(e,t){this.type=e,this.value=t}static define(){return new C3}}class C3{of(e){return new Ts(this,e)}}class k3{constructor(e){this.map=e}of(e){return new Re(this,e)}}class Re{constructor(e,t){this.type=e,this.value=t}map(e){let t=this.type.map(this.value,e);return t===void 0?void 0:t==this.value?this:new Re(this.type,t)}is(e){return this.type==e}static define(e={}){return new k3(e.map||(t=>t))}static mapEffects(e,t){if(!e.length)return e;let i=[];for(let s of e){let n=s.map(t);n&&i.push(n)}return i}}Re.reconfigure=Re.define();Re.appendConfig=Re.define();class Lt{constructor(e,t,i,s,n,a){this.startState=e,this.changes=t,this.selection=i,this.effects=s,this.annotations=n,this.scrollIntoView=a,this._doc=null,this._state=null,i&&jx(i,t.newLength),n.some(o=>o.type==Lt.time)||(this.annotations=n.concat(Lt.time.of(Date.now())))}static create(e,t,i,s,n,a){return new Lt(e,t,i,s,n,a)}get newDoc(){return this._doc||(this._doc=this.changes.apply(this.startState.doc))}get newSelection(){return this.selection||this.startState.selection.map(this.changes)}get state(){return this._state||this.startState.applyTransaction(this),this._state}annotation(e){for(let t of this.annotations)if(t.type==e)return t.value}get docChanged(){return!this.changes.empty}get reconfigured(){return this.startState.config!=this.state.config}isUserEvent(e){let t=this.annotation(Lt.userEvent);return!!(t&&(t==e||t.length>e.length&&t.slice(0,e.length)==e&&t[e.length]=="."))}}Lt.time=Ts.define();Lt.userEvent=Ts.define();Lt.addToHistory=Ts.define();Lt.remote=Ts.define();function E3(r,e){let t=[];for(let i=0,s=0;;){let n,a;if(i<r.length&&(s==e.length||e[s]>=r[i]))n=r[i++],a=r[i++];else if(s<e.length)n=e[s++],a=e[s++];else return t;!t.length||t[t.length-1]<n?t.push(n,a):t[t.length-1]<a&&(t[t.length-1]=a)}}function Jx(r,e,t){var i;let s,n,a;return t?(s=e.changes,n=$t.empty(e.changes.length),a=r.changes.compose(e.changes)):(s=e.changes.map(r.changes),n=r.changes.mapDesc(e.changes,!0),a=r.changes.compose(s)),{changes:a,selection:e.selection?e.selection.map(n):(i=r.selection)===null||i===void 0?void 0:i.map(s),effects:Re.mapEffects(r.effects,s).concat(Re.mapEffects(e.effects,n)),annotations:r.annotations.length?r.annotations.concat(e.annotations):e.annotations,scrollIntoView:r.scrollIntoView||e.scrollIntoView}}function Wp(r,e,t){let i=e.selection,s=Sa(e.annotations);return e.userEvent&&(s=s.concat(Lt.userEvent.of(e.userEvent))),{changes:e.changes instanceof $t?e.changes:$t.of(e.changes||[],t,r.facet(Wx)),selection:i&&(i instanceof ie?i:ie.single(i.anchor,i.head)),effects:Sa(e.effects),annotations:s,scrollIntoView:!!e.scrollIntoView}}function ew(r,e,t){let i=Wp(r,e.length?e[0]:{},r.doc.length);e.length&&e[0].filter===!1&&(t=!1);for(let n=1;n<e.length;n++){e[n].filter===!1&&(t=!1);let a=!!e[n].sequential;i=Jx(i,Wp(r,e[n],a?i.changes.newLength:r.doc.length),a)}let s=Lt.create(r,i.changes,i.selection,i.effects,i.annotations,i.scrollIntoView);return P3(t?A3(s):s)}function A3(r){let e=r.startState,t=!0;for(let s of e.facet(Hx)){let n=s(r);if(n===!1){t=!1;break}Array.isArray(n)&&(t=t===!0?n:E3(t,n))}if(t!==!0){let s,n;if(t===!1)n=r.changes.invertedDesc,s=$t.empty(e.doc.length);else{let a=r.changes.filter(t);s=a.changes,n=a.filtered.mapDesc(a.changes).invertedDesc}r=Lt.create(e,s,r.selection&&r.selection.map(n),Re.mapEffects(r.effects,n),r.annotations,r.scrollIntoView)}let i=e.facet(Yx);for(let s=i.length-1;s>=0;s--){let n=i[s](r);n instanceof Lt?r=n:Array.isArray(n)&&n.length==1&&n[0]instanceof Lt?r=n[0]:r=ew(e,Sa(n),!1)}return r}function P3(r){let e=r.startState,t=e.facet(Gx),i=r;for(let s=t.length-1;s>=0;s--){let n=t[s](r);n&&Object.keys(n).length&&(i=Jx(i,Wp(e,n,r.changes.newLength),!0))}return i==r?r:Lt.create(e,r.changes,r.selection,i.effects,i.annotations,i.scrollIntoView)}const D3=[];function Sa(r){return r==null?D3:Array.isArray(r)?r:[r]}var gt=(function(r){return r[r.Word=0]="Word",r[r.Space=1]="Space",r[r.Other=2]="Other",r})(gt||(gt={}));const M3=/[\u00df\u0587\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/;let Hp;try{Hp=new RegExp("[\\p{Alphabetic}\\p{Number}_]","u")}catch{}function I3(r){if(Hp)return Hp.test(r);for(let e=0;e<r.length;e++){let t=r[e];if(/\w/.test(t)||t>""&&(t.toUpperCase()!=t.toLowerCase()||M3.test(t)))return!0}return!1}function R3(r){return e=>{if(!/\S/.test(e))return gt.Space;if(I3(e))return gt.Word;for(let t=0;t<r.length;t++)if(e.indexOf(r[t])>-1)return gt.Word;return gt.Other}}class Xe{constructor(e,t,i,s,n,a){this.config=e,this.doc=t,this.selection=i,this.values=s,this.status=e.statusTemplate.slice(),this.computeSlot=n,a&&(a._state=this);for(let o=0;o<this.config.dynamicSlots.length;o++)il(this,o<<1);this.computeSlot=null}field(e,t=!0){let i=this.config.address[e.id];if(i==null){if(t)throw new RangeError("Field is not present in this state");return}return il(this,i),nh(this,i)}update(...e){return ew(this,e,!0)}applyTransaction(e){let t=this.config,{base:i,compartments:s}=t;for(let o of e.effects)o.is(nd.reconfigure)?(t&&(s=new Map,t.compartments.forEach((l,u)=>s.set(u,l)),t=null),s.set(o.value.compartment,o.value.extension)):o.is(Re.reconfigure)?(t=null,i=o.value):o.is(Re.appendConfig)&&(t=null,i=Sa(i).concat(o.value));let n;t?n=e.startState.values.slice():(t=sh.resolve(i,s,this),n=new Xe(t,this.doc,this.selection,t.dynamicSlots.map(()=>null),(l,u)=>u.reconfigure(l,this),null).values);let a=e.startState.facet(Zp)?e.newSelection:e.newSelection.asSingle();new Xe(t,e.newDoc,a,n,(o,l)=>l.update(o,e),e)}replaceSelection(e){return typeof e=="string"&&(e=this.toText(e)),this.changeByRange(t=>({changes:{from:t.from,to:t.to,insert:e},range:ie.cursor(t.from+e.length)}))}changeByRange(e){let t=this.selection,i=e(t.ranges[0]),s=this.changes(i.changes),n=[i.range],a=Sa(i.effects);for(let o=1;o<t.ranges.length;o++){let l=e(t.ranges[o]),u=this.changes(l.changes),c=u.map(s);for(let f=0;f<o;f++)n[f]=n[f].map(c);let h=s.mapDesc(u,!0);n.push(l.range.map(h)),s=s.compose(c),a=Re.mapEffects(a,c).concat(Re.mapEffects(Sa(l.effects),h))}return{changes:s,selection:ie.create(n,t.mainIndex),effects:a}}changes(e=[]){return e instanceof $t?e:$t.of(e,this.doc.length,this.facet(Xe.lineSeparator))}toText(e){return Ue.of(e.split(this.facet(Xe.lineSeparator)||qp))}sliceDoc(e=0,t=this.doc.length){return this.doc.sliceString(e,t,this.lineBreak)}facet(e){let t=this.config.address[e.id];return t==null?e.default:(il(this,t),nh(this,t))}toJSON(e){let t={doc:this.sliceDoc(),selection:this.selection.toJSON()};if(e)for(let i in e){let s=e[i];s instanceof jt&&this.config.address[s.id]!=null&&(t[i]=s.spec.toJSON(this.field(e[i]),this))}return t}static fromJSON(e,t={},i){if(!e||typeof e.doc!="string")throw new RangeError("Invalid JSON representation for EditorState");let s=[];if(i){for(let n in i)if(Object.prototype.hasOwnProperty.call(e,n)){let a=i[n],o=e[n];s.push(a.init(l=>a.spec.fromJSON(o,l)))}}return Xe.create({doc:e.doc,selection:ie.fromJSON(e.selection),extensions:t.extensions?s.concat([t.extensions]):s})}static create(e={}){let t=sh.resolve(e.extensions||[],new Map),i=e.doc instanceof Ue?e.doc:Ue.of((e.doc||"").split(t.staticFacet(Xe.lineSeparator)||qp)),s=e.selection?e.selection instanceof ie?e.selection:ie.single(e.selection.anchor,e.selection.head):ie.single(0);return jx(s,i.length),t.staticFacet(Zp)||(s=s.asSingle()),new Xe(t,i,s,t.dynamicSlots.map(()=>null),(n,a)=>a.create(n),null)}get tabSize(){return this.facet(Xe.tabSize)}get lineBreak(){return this.facet(Xe.lineSeparator)||`
`}get readOnly(){return this.facet(Kx)}phrase(e,...t){for(let i of this.facet(Xe.phrases))if(Object.prototype.hasOwnProperty.call(i,e)){e=i[e];break}return t.length&&(e=e.replace(/\$(\$|\d*)/g,(i,s)=>{if(s=="$")return"$";let n=+(s||1);return!n||n>t.length?i:t[n-1]})),e}languageDataAt(e,t,i=-1){let s=[];for(let n of this.facet(Zx))for(let a of n(this,t,i))Object.prototype.hasOwnProperty.call(a,e)&&s.push(a[e]);return s}charCategorizer(e){return R3(this.languageDataAt("wordChars",e).join(""))}wordAt(e){let{text:t,from:i,length:s}=this.doc.lineAt(e),n=this.charCategorizer(e),a=e-i,o=e-i;for(;a>0;){let l=Kt(t,a,!1);if(n(t.slice(l,a))!=gt.Word)break;a=l}for(;o<s;){let l=Kt(t,o);if(n(t.slice(o,l))!=gt.Word)break;o=l}return a==o?null:ie.range(a+i,o+i)}}Xe.allowMultipleSelections=Zp;Xe.tabSize=be.define({combine:r=>r.length?r[0]:4});Xe.lineSeparator=Wx;Xe.readOnly=Kx;Xe.phrases=be.define({compare(r,e){let t=Object.keys(r),i=Object.keys(e);return t.length==i.length&&t.every(s=>r[s]==e[s])}});Xe.languageData=Zx;Xe.changeFilter=Hx;Xe.transactionFilter=Yx;Xe.transactionExtender=Gx;nd.reconfigure=Re.define();function Gr(r,e,t={}){let i={};for(let s of r)for(let n of Object.keys(s)){let a=s[n],o=i[n];if(o===void 0)i[n]=a;else if(!(o===a||a===void 0))if(Object.hasOwnProperty.call(t,n))i[n]=t[n](o,a);else throw new Error("Config merge conflict for field "+n)}for(let s in e)i[s]===void 0&&(i[s]=e[s]);return i}class Rn{eq(e){return this==e}range(e,t=e){return Yp.create(e,t,this)}}Rn.prototype.startSide=Rn.prototype.endSide=0;Rn.prototype.point=!1;Rn.prototype.mapMode=Yt.TrackDel;let Yp=class tw{constructor(e,t,i){this.from=e,this.to=t,this.value=i}static create(e,t,i){return new tw(e,t,i)}};function Gp(r,e){return r.from-e.from||r.value.startSide-e.value.startSide}class Yg{constructor(e,t,i,s){this.from=e,this.to=t,this.value=i,this.maxPoint=s}get length(){return this.to[this.to.length-1]}findIndex(e,t,i,s=0){let n=i?this.to:this.from;for(let a=s,o=n.length;;){if(a==o)return a;let l=a+o>>1,u=n[l]-e||(i?this.value[l].endSide:this.value[l].startSide)-t;if(l==a)return u>=0?a:o;u>=0?o=l:a=l+1}}between(e,t,i,s){for(let n=this.findIndex(t,-1e9,!0),a=this.findIndex(i,1e9,!1,n);n<a;n++)if(s(this.from[n]+e,this.to[n]+e,this.value[n])===!1)return!1}map(e,t){let i=[],s=[],n=[],a=-1,o=-1;for(let l=0;l<this.value.length;l++){let u=this.value[l],c=this.from[l]+e,h=this.to[l]+e,f,m;if(c==h){let S=t.mapPos(c,u.startSide,u.mapMode);if(S==null||(f=m=S,u.startSide!=u.endSide&&(m=t.mapPos(c,u.endSide),m<f)))continue}else if(f=t.mapPos(c,u.startSide),m=t.mapPos(h,u.endSide),f>m||f==m&&u.startSide>0&&u.endSide<=0)continue;(m-f||u.endSide-u.startSide)<0||(a<0&&(a=f),u.point&&(o=Math.max(o,m-f)),i.push(u),s.push(f-a),n.push(m-a))}return{mapped:i.length?new Yg(s,n,i,o):null,pos:a}}}class je{constructor(e,t,i,s){this.chunkPos=e,this.chunk=t,this.nextLayer=i,this.maxPoint=s}static create(e,t,i,s){return new je(e,t,i,s)}get length(){let e=this.chunk.length-1;return e<0?0:Math.max(this.chunkEnd(e),this.nextLayer.length)}get size(){if(this.isEmpty)return 0;let e=this.nextLayer.size;for(let t of this.chunk)e+=t.value.length;return e}chunkEnd(e){return this.chunkPos[e]+this.chunk[e].length}update(e){let{add:t=[],sort:i=!1,filterFrom:s=0,filterTo:n=this.length}=e,a=e.filter;if(t.length==0&&!a)return this;if(i&&(t=t.slice().sort(Gp)),this.isEmpty)return t.length?je.of(t):this;let o=new iw(this,null,-1).goto(0),l=0,u=[],c=new ys;for(;o.value||l<t.length;)if(l<t.length&&(o.from-t[l].from||o.startSide-t[l].value.startSide)>=0){let h=t[l++];c.addInner(h.from,h.to,h.value)||u.push(h)}else o.rangeIndex==1&&o.chunkIndex<this.chunk.length&&(l==t.length||this.chunkEnd(o.chunkIndex)<t[l].from)&&(!a||s>this.chunkEnd(o.chunkIndex)||n<this.chunkPos[o.chunkIndex])&&c.addChunk(this.chunkPos[o.chunkIndex],this.chunk[o.chunkIndex])?o.nextChunk():((!a||s>o.to||n<o.from||a(o.from,o.to,o.value))&&(c.addInner(o.from,o.to,o.value)||u.push(Yp.create(o.from,o.to,o.value))),o.next());return c.finishInner(this.nextLayer.isEmpty&&!u.length?je.empty:this.nextLayer.update({add:u,filter:a,filterFrom:s,filterTo:n}))}map(e){if(e.empty||this.isEmpty)return this;let t=[],i=[],s=-1;for(let a=0;a<this.chunk.length;a++){let o=this.chunkPos[a],l=this.chunk[a],u=e.touchesRange(o,o+l.length);if(u===!1)s=Math.max(s,l.maxPoint),t.push(l),i.push(e.mapPos(o));else if(u===!0){let{mapped:c,pos:h}=l.map(o,e);c&&(s=Math.max(s,c.maxPoint),t.push(c),i.push(h))}}let n=this.nextLayer.map(e);return t.length==0?n:new je(i,t,n||je.empty,s)}between(e,t,i){if(!this.isEmpty){for(let s=0;s<this.chunk.length;s++){let n=this.chunkPos[s],a=this.chunk[s];if(t>=n&&e<=n+a.length&&a.between(n,e-n,t-n,i)===!1)return}this.nextLayer.between(e,t,i)}}iter(e=0){return bl.from([this]).goto(e)}get isEmpty(){return this.nextLayer==this}static iter(e,t=0){return bl.from(e).goto(t)}static compare(e,t,i,s,n=-1){let a=e.filter(h=>h.maxPoint>0||!h.isEmpty&&h.maxPoint>=n),o=t.filter(h=>h.maxPoint>0||!h.isEmpty&&h.maxPoint>=n),l=Db(a,o,i),u=new Po(a,l,n),c=new Po(o,l,n);i.iterGaps((h,f,m)=>Mb(u,h,c,f,m,s)),i.empty&&i.length==0&&Mb(u,0,c,0,0,s)}static eq(e,t,i=0,s){s==null&&(s=999999999);let n=e.filter(c=>!c.isEmpty&&t.indexOf(c)<0),a=t.filter(c=>!c.isEmpty&&e.indexOf(c)<0);if(n.length!=a.length)return!1;if(!n.length)return!0;let o=Db(n,a),l=new Po(n,o,0).goto(i),u=new Po(a,o,0).goto(i);for(;;){if(l.to!=u.to||!Kp(l.active,u.active)||l.point&&(!u.point||!l.point.eq(u.point)))return!1;if(l.to>s)return!0;l.next(),u.next()}}static spans(e,t,i,s,n=-1){let a=new Po(e,null,n).goto(t),o=t,l=a.openStart;for(;;){let u=Math.min(a.to,i);if(a.point){let c=a.activeForPoint(a.to),h=a.pointFrom<t?c.length+1:a.point.startSide<0?c.length:Math.min(c.length,l);s.point(o,u,a.point,c,h,a.pointRank),l=Math.min(a.openEnd(u),c.length)}else u>o&&(s.span(o,u,a.active,l),l=a.openEnd(u));if(a.to>i)return l+(a.point&&a.to>i?1:0);o=a.to,a.next()}}static of(e,t=!1){let i=new ys;for(let s of e instanceof Yp?[e]:t?L3(e):e)i.add(s.from,s.to,s.value);return i.finish()}static join(e){if(!e.length)return je.empty;let t=e[e.length-1];for(let i=e.length-2;i>=0;i--)for(let s=e[i];s!=je.empty;s=s.nextLayer)t=new je(s.chunkPos,s.chunk,t,Math.max(s.maxPoint,t.maxPoint));return t}}je.empty=new je([],[],null,-1);function L3(r){if(r.length>1)for(let e=r[0],t=1;t<r.length;t++){let i=r[t];if(Gp(e,i)>0)return r.slice().sort(Gp);e=i}return r}je.empty.nextLayer=je.empty;class ys{finishChunk(e){this.chunks.push(new Yg(this.from,this.to,this.value,this.maxPoint)),this.chunkPos.push(this.chunkStart),this.chunkStart=-1,this.setMaxPoint=Math.max(this.setMaxPoint,this.maxPoint),this.maxPoint=-1,e&&(this.from=[],this.to=[],this.value=[])}constructor(){this.chunks=[],this.chunkPos=[],this.chunkStart=-1,this.last=null,this.lastFrom=-1e9,this.lastTo=-1e9,this.from=[],this.to=[],this.value=[],this.maxPoint=-1,this.setMaxPoint=-1,this.nextLayer=null}add(e,t,i){this.addInner(e,t,i)||(this.nextLayer||(this.nextLayer=new ys)).add(e,t,i)}addInner(e,t,i){let s=e-this.lastTo||i.startSide-this.last.endSide;if(s<=0&&(e-this.lastFrom||i.startSide-this.last.startSide)<0)throw new Error("Ranges must be added sorted by `from` position and `startSide`");return s<0?!1:(this.from.length==250&&this.finishChunk(!0),this.chunkStart<0&&(this.chunkStart=e),this.from.push(e-this.chunkStart),this.to.push(t-this.chunkStart),this.last=i,this.lastFrom=e,this.lastTo=t,this.value.push(i),i.point&&(this.maxPoint=Math.max(this.maxPoint,t-e)),!0)}addChunk(e,t){if((e-this.lastTo||t.value[0].startSide-this.last.endSide)<0)return!1;this.from.length&&this.finishChunk(!0),this.setMaxPoint=Math.max(this.setMaxPoint,t.maxPoint),this.chunks.push(t),this.chunkPos.push(e);let i=t.value.length-1;return this.last=t.value[i],this.lastFrom=t.from[i]+e,this.lastTo=t.to[i]+e,!0}finish(){return this.finishInner(je.empty)}finishInner(e){if(this.from.length&&this.finishChunk(!1),this.chunks.length==0)return e;let t=je.create(this.chunkPos,this.chunks,this.nextLayer?this.nextLayer.finishInner(e):e,this.setMaxPoint);return this.from=null,t}}function Db(r,e,t){let i=new Map;for(let n of r)for(let a=0;a<n.chunk.length;a++)n.chunk[a].maxPoint<=0&&i.set(n.chunk[a],n.chunkPos[a]);let s=new Set;for(let n of e)for(let a=0;a<n.chunk.length;a++){let o=i.get(n.chunk[a]);o!=null&&(t?t.mapPos(o):o)==n.chunkPos[a]&&!t?.touchesRange(o,o+n.chunk[a].length)&&s.add(n.chunk[a])}return s}class iw{constructor(e,t,i,s=0){this.layer=e,this.skip=t,this.minPoint=i,this.rank=s}get startSide(){return this.value?this.value.startSide:0}get endSide(){return this.value?this.value.endSide:0}goto(e,t=-1e9){return this.chunkIndex=this.rangeIndex=0,this.gotoInner(e,t,!1),this}gotoInner(e,t,i){for(;this.chunkIndex<this.layer.chunk.length;){let s=this.layer.chunk[this.chunkIndex];if(!(this.skip&&this.skip.has(s)||this.layer.chunkEnd(this.chunkIndex)<e||s.maxPoint<this.minPoint))break;this.chunkIndex++,i=!1}if(this.chunkIndex<this.layer.chunk.length){let s=this.layer.chunk[this.chunkIndex].findIndex(e-this.layer.chunkPos[this.chunkIndex],t,!0);(!i||this.rangeIndex<s)&&this.setRangeIndex(s)}this.next()}forward(e,t){(this.to-e||this.endSide-t)<0&&this.gotoInner(e,t,!0)}next(){for(;;)if(this.chunkIndex==this.layer.chunk.length){this.from=this.to=1e9,this.value=null;break}else{let e=this.layer.chunkPos[this.chunkIndex],t=this.layer.chunk[this.chunkIndex],i=e+t.from[this.rangeIndex];if(this.from=i,this.to=e+t.to[this.rangeIndex],this.value=t.value[this.rangeIndex],this.setRangeIndex(this.rangeIndex+1),this.minPoint<0||this.value.point&&this.to-this.from>=this.minPoint)break}}setRangeIndex(e){if(e==this.layer.chunk[this.chunkIndex].value.length){if(this.chunkIndex++,this.skip)for(;this.chunkIndex<this.layer.chunk.length&&this.skip.has(this.layer.chunk[this.chunkIndex]);)this.chunkIndex++;this.rangeIndex=0}else this.rangeIndex=e}nextChunk(){this.chunkIndex++,this.rangeIndex=0,this.next()}compare(e){return this.from-e.from||this.startSide-e.startSide||this.rank-e.rank||this.to-e.to||this.endSide-e.endSide}}class bl{constructor(e){this.heap=e}static from(e,t=null,i=-1){let s=[];for(let n=0;n<e.length;n++)for(let a=e[n];!a.isEmpty;a=a.nextLayer)a.maxPoint>=i&&s.push(new iw(a,t,i,n));return s.length==1?s[0]:new bl(s)}get startSide(){return this.value?this.value.startSide:0}goto(e,t=-1e9){for(let i of this.heap)i.goto(e,t);for(let i=this.heap.length>>1;i>=0;i--)_f(this.heap,i);return this.next(),this}forward(e,t){for(let i of this.heap)i.forward(e,t);for(let i=this.heap.length>>1;i>=0;i--)_f(this.heap,i);(this.to-e||this.value.endSide-t)<0&&this.next()}next(){if(this.heap.length==0)this.from=this.to=1e9,this.value=null,this.rank=-1;else{let e=this.heap[0];this.from=e.from,this.to=e.to,this.value=e.value,this.rank=e.rank,e.value&&e.next(),_f(this.heap,0)}}}function _f(r,e){for(let t=r[e];;){let i=(e<<1)+1;if(i>=r.length)break;let s=r[i];if(i+1<r.length&&s.compare(r[i+1])>=0&&(s=r[i+1],i++),t.compare(s)<0)break;r[i]=t,r[e]=s,e=i}}class Po{constructor(e,t,i){this.minPoint=i,this.active=[],this.activeTo=[],this.activeRank=[],this.minActive=-1,this.point=null,this.pointFrom=0,this.pointRank=0,this.to=-1e9,this.endSide=0,this.openStart=-1,this.cursor=bl.from(e,t,i)}goto(e,t=-1e9){return this.cursor.goto(e,t),this.active.length=this.activeTo.length=this.activeRank.length=0,this.minActive=-1,this.to=e,this.endSide=t,this.openStart=-1,this.next(),this}forward(e,t){for(;this.minActive>-1&&(this.activeTo[this.minActive]-e||this.active[this.minActive].endSide-t)<0;)this.removeActive(this.minActive);this.cursor.forward(e,t)}removeActive(e){ju(this.active,e),ju(this.activeTo,e),ju(this.activeRank,e),this.minActive=Ib(this.active,this.activeTo)}addActive(e){let t=0,{value:i,to:s,rank:n}=this.cursor;for(;t<this.activeRank.length&&(n-this.activeRank[t]||s-this.activeTo[t])>0;)t++;zu(this.active,t,i),zu(this.activeTo,t,s),zu(this.activeRank,t,n),e&&zu(e,t,this.cursor.from),this.minActive=Ib(this.active,this.activeTo)}next(){let e=this.to,t=this.point;this.point=null;let i=this.openStart<0?[]:null;for(;;){let s=this.minActive;if(s>-1&&(this.activeTo[s]-this.cursor.from||this.active[s].endSide-this.cursor.startSide)<0){if(this.activeTo[s]>e){this.to=this.activeTo[s],this.endSide=this.active[s].endSide;break}this.removeActive(s),i&&ju(i,s)}else if(this.cursor.value)if(this.cursor.from>e){this.to=this.cursor.from,this.endSide=this.cursor.startSide;break}else{let n=this.cursor.value;if(!n.point)this.addActive(i),this.cursor.next();else if(t&&this.cursor.to==this.to&&this.cursor.from<this.cursor.to)this.cursor.next();else{this.point=n,this.pointFrom=this.cursor.from,this.pointRank=this.cursor.rank,this.to=this.cursor.to,this.endSide=n.endSide,this.cursor.next(),this.forward(this.to,this.endSide);break}}else{this.to=this.endSide=1e9;break}}if(i){this.openStart=0;for(let s=i.length-1;s>=0&&i[s]<e;s--)this.openStart++}}activeForPoint(e){if(!this.active.length)return this.active;let t=[];for(let i=this.active.length-1;i>=0&&!(this.activeRank[i]<this.pointRank);i--)(this.activeTo[i]>e||this.activeTo[i]==e&&this.active[i].endSide>=this.point.endSide)&&t.push(this.active[i]);return t.reverse()}openEnd(e){let t=0;for(let i=this.activeTo.length-1;i>=0&&this.activeTo[i]>e;i--)t++;return t}}function Mb(r,e,t,i,s,n){r.goto(e),t.goto(i);let a=i+s,o=i,l=i-e;for(;;){let u=r.to+l-t.to,c=u||r.endSide-t.endSide,h=c<0?r.to+l:t.to,f=Math.min(h,a);if(r.point||t.point?r.point&&t.point&&(r.point==t.point||r.point.eq(t.point))&&Kp(r.activeForPoint(r.to),t.activeForPoint(t.to))||n.comparePoint(o,f,r.point,t.point):f>o&&!Kp(r.active,t.active)&&n.compareRange(o,f,r.active,t.active),h>a)break;(u||r.openEnd!=t.openEnd)&&n.boundChange&&n.boundChange(h),o=h,c<=0&&r.next(),c>=0&&t.next()}}function Kp(r,e){if(r.length!=e.length)return!1;for(let t=0;t<r.length;t++)if(r[t]!=e[t]&&!r[t].eq(e[t]))return!1;return!0}function ju(r,e){for(let t=e,i=r.length-1;t<i;t++)r[t]=r[t+1];r.pop()}function zu(r,e,t){for(let i=r.length-1;i>=e;i--)r[i+1]=r[i];r[e]=t}function Ib(r,e){let t=-1,i=1e9;for(let s=0;s<e.length;s++)(e[s]-i||r[s].endSide-r[t].endSide)<0&&(t=s,i=e[s]);return t}function yr(r,e,t=r.length){let i=0;for(let s=0;s<t&&s<r.length;)r.charCodeAt(s)==9?(i+=e-i%e,s++):(i++,s=Kt(r,s));return i}function Jp(r,e,t,i){for(let s=0,n=0;;){if(n>=e)return s;if(s==r.length)break;n+=r.charCodeAt(s)==9?t-n%t:1,s=Kt(r,s)}return i===!0?-1:r.length}const em="ͼ",Rb=typeof Symbol>"u"?"__"+em:Symbol.for(em),tm=typeof Symbol>"u"?"__styleSet"+Math.floor(Math.random()*1e8):Symbol("styleSet"),Lb=typeof globalThis<"u"?globalThis:typeof window<"u"?window:{};class Ws{constructor(e,t){this.rules=[];let{finish:i}=t||{};function s(a){return/^@/.test(a)?[a]:a.split(/,\s*/)}function n(a,o,l,u){let c=[],h=/^@(\w+)\b/.exec(a[0]),f=h&&h[1]=="keyframes";if(h&&o==null)return l.push(a[0]+";");for(let m in o){let S=o[m];if(/&/.test(m))n(m.split(/,\s*/).map(y=>a.map(E=>y.replace(/&/,E))).reduce((y,E)=>y.concat(E)),S,l);else if(S&&typeof S=="object"){if(!h)throw new RangeError("The value of a property ("+m+") should be a primitive value.");n(s(m),S,c,f)}else S!=null&&c.push(m.replace(/_.*/,"").replace(/[A-Z]/g,y=>"-"+y.toLowerCase())+": "+S+";")}(c.length||f)&&l.push((i&&!h&&!u?a.map(i):a).join(", ")+" {"+c.join(" ")+"}")}for(let a in e)n(s(a),e[a],this.rules)}getRules(){return this.rules.join(`
`)}static newName(){let e=Lb[Rb]||1;return Lb[Rb]=e+1,em+e.toString(36)}static mount(e,t,i){let s=e[tm],n=i&&i.nonce;s?n&&s.setNonce(n):s=new Q3(e,n),s.mount(Array.isArray(t)?t:[t],e)}}let Qb=new Map;class Q3{constructor(e,t){let i=e.ownerDocument||e,s=i.defaultView;if(!e.head&&e.adoptedStyleSheets&&s.CSSStyleSheet){let n=Qb.get(i);if(n)return e[tm]=n;this.sheet=new s.CSSStyleSheet,Qb.set(i,this)}else this.styleTag=i.createElement("style"),t&&this.styleTag.setAttribute("nonce",t);this.modules=[],e[tm]=this}mount(e,t){let i=this.sheet,s=0,n=0;for(let a=0;a<e.length;a++){let o=e[a],l=this.modules.indexOf(o);if(l<n&&l>-1&&(this.modules.splice(l,1),n--,l=-1),l==-1){if(this.modules.splice(n++,0,o),i)for(let u=0;u<o.rules.length;u++)i.insertRule(o.rules[u],s++)}else{for(;n<l;)s+=this.modules[n++].rules.length;s+=o.rules.length,n++}}if(i)t.adoptedStyleSheets.indexOf(this.sheet)<0&&(t.adoptedStyleSheets=[this.sheet,...t.adoptedStyleSheets]);else{let a="";for(let l=0;l<this.modules.length;l++)a+=this.modules[l].getRules()+`
`;this.styleTag.textContent=a;let o=t.head||t;this.styleTag.parentNode!=o&&o.insertBefore(this.styleTag,o.firstChild)}}setNonce(e){this.styleTag&&this.styleTag.getAttribute("nonce")!=e&&this.styleTag.setAttribute("nonce",e)}}var Hs={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},vl={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},$3=typeof navigator<"u"&&/Mac/.test(navigator.platform),B3=typeof navigator<"u"&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent);for(var Ht=0;Ht<10;Ht++)Hs[48+Ht]=Hs[96+Ht]=String(Ht);for(var Ht=1;Ht<=24;Ht++)Hs[Ht+111]="F"+Ht;for(var Ht=65;Ht<=90;Ht++)Hs[Ht]=String.fromCharCode(Ht+32),vl[Ht]=String.fromCharCode(Ht);for(var xf in Hs)vl.hasOwnProperty(xf)||(vl[xf]=Hs[xf]);function N3(r){var e=$3&&r.metaKey&&r.shiftKey&&!r.ctrlKey&&!r.altKey||B3&&r.shiftKey&&r.key&&r.key.length==1||r.key=="Unidentified",t=!e&&r.key||(r.shiftKey?vl:Hs)[r.keyCode]||r.key||"Unidentified";return t=="Esc"&&(t="Escape"),t=="Del"&&(t="Delete"),t=="Left"&&(t="ArrowLeft"),t=="Up"&&(t="ArrowUp"),t=="Right"&&(t="ArrowRight"),t=="Down"&&(t="ArrowDown"),t}function rt(){var r=arguments[0];typeof r=="string"&&(r=document.createElement(r));var e=1,t=arguments[1];if(t&&typeof t=="object"&&t.nodeType==null&&!Array.isArray(t)){for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)){var s=t[i];typeof s=="string"?r.setAttribute(i,s):s!=null&&(r[i]=s)}e++}for(;e<arguments.length;e++)rw(r,arguments[e]);return r}function rw(r,e){if(typeof e=="string")r.appendChild(document.createTextNode(e));else if(e!=null)if(e.nodeType!=null)r.appendChild(e);else if(Array.isArray(e))for(var t=0;t<e.length;t++)rw(r,e[t]);else throw new RangeError("Unsupported child node: "+e)}let fi=typeof navigator<"u"?navigator:{userAgent:"",vendor:"",platform:""},im=typeof document<"u"?document:{documentElement:{style:{}}};const rm=/Edge\/(\d+)/.exec(fi.userAgent),sw=/MSIE \d/.test(fi.userAgent),sm=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(fi.userAgent),ad=!!(sw||sm||rm),$b=!ad&&/gecko\/(\d+)/i.test(fi.userAgent),wf=!ad&&/Chrome\/(\d+)/.exec(fi.userAgent),F3="webkitFontSmoothing"in im.documentElement.style,nm=!ad&&/Apple Computer/.test(fi.vendor),Bb=nm&&(/Mobile\/\w+/.test(fi.userAgent)||fi.maxTouchPoints>2);var me={mac:Bb||/Mac/.test(fi.platform),windows:/Win/.test(fi.platform),linux:/Linux|X11/.test(fi.platform),ie:ad,ie_version:sw?im.documentMode||6:sm?+sm[1]:rm?+rm[1]:0,gecko:$b,gecko_version:$b?+(/Firefox\/(\d+)/.exec(fi.userAgent)||[0,0])[1]:0,chrome:!!wf,chrome_version:wf?+wf[1]:0,ios:Bb,android:/Android\b/.test(fi.userAgent),webkit_version:F3?+(/\bAppleWebKit\/(\d+)/.exec(fi.userAgent)||[0,0])[1]:0,safari:nm,safari_version:nm?+(/\bVersion\/(\d+(\.\d+)?)/.exec(fi.userAgent)||[0,0])[1]:0,tabSize:im.documentElement.style.tabSize!=null?"tab-size":"-moz-tab-size"};function Sl(r){let e;return r.nodeType==11?e=r.getSelection?r:r.ownerDocument:e=r,e.getSelection()}function am(r,e){return e?r==e||r.contains(e.nodeType!=1?e.parentNode:e):!1}function vc(r,e){if(!e.anchorNode)return!1;try{return am(r,e.anchorNode)}catch{return!1}}function Tl(r){return r.nodeType==3?Qn(r,0,r.nodeValue.length).getClientRects():r.nodeType==1?r.getClientRects():[]}function rl(r,e,t,i){return t?Nb(r,e,t,i,-1)||Nb(r,e,t,i,1):!1}function Ln(r){for(var e=0;;e++)if(r=r.previousSibling,!r)return e}function ah(r){return r.nodeType==1&&/^(DIV|P|LI|UL|OL|BLOCKQUOTE|DD|DT|H\d|SECTION|PRE)$/.test(r.nodeName)}function Nb(r,e,t,i,s){for(;;){if(r==t&&e==i)return!0;if(e==(s<0?0:Yr(r))){if(r.nodeName=="DIV")return!1;let n=r.parentNode;if(!n||n.nodeType!=1)return!1;e=Ln(r)+(s<0?0:1),r=n}else if(r.nodeType==1){if(r=r.childNodes[e+(s<0?-1:0)],r.nodeType==1&&r.contentEditable=="false")return!1;e=s<0?Yr(r):0}else return!1}}function Yr(r){return r.nodeType==3?r.nodeValue.length:r.childNodes.length}function od(r,e){let t=e?r.left:r.right;return{left:t,right:t,top:r.top,bottom:r.bottom}}function U3(r){let e=r.visualViewport;return e?{left:0,right:e.width,top:0,bottom:e.height}:{left:0,right:r.innerWidth,top:0,bottom:r.innerHeight}}function nw(r,e){let t=e.width/r.offsetWidth,i=e.height/r.offsetHeight;return(t>.995&&t<1.005||!isFinite(t)||Math.abs(e.width-r.offsetWidth)<1)&&(t=1),(i>.995&&i<1.005||!isFinite(i)||Math.abs(e.height-r.offsetHeight)<1)&&(i=1),{scaleX:t,scaleY:i}}function q3(r,e,t,i,s,n,a,o){let l=r.ownerDocument,u=l.defaultView||window;for(let c=r,h=!1;c&&!h;)if(c.nodeType==1){let f,m=c==l.body,S=1,y=1;if(m)f=U3(u);else{if(/^(fixed|sticky)$/.test(getComputedStyle(c).position)&&(h=!0),c.scrollHeight<=c.clientHeight&&c.scrollWidth<=c.clientWidth){c=c.assignedSlot||c.parentNode;continue}let _=c.getBoundingClientRect();({scaleX:S,scaleY:y}=nw(c,_)),f={left:_.left,right:_.left+c.clientWidth*S,top:_.top,bottom:_.top+c.clientHeight*y}}let E=0,C=0;if(s=="nearest")e.top<f.top?(C=e.top-(f.top+a),t>0&&e.bottom>f.bottom+C&&(C=e.bottom-f.bottom+a)):e.bottom>f.bottom&&(C=e.bottom-f.bottom+a,t<0&&e.top-C<f.top&&(C=e.top-(f.top+a)));else{let _=e.bottom-e.top,v=f.bottom-f.top;C=(s=="center"&&_<=v?e.top+_/2-v/2:s=="start"||s=="center"&&t<0?e.top-a:e.bottom-v+a)-f.top}if(i=="nearest"?e.left<f.left?(E=e.left-(f.left+n),t>0&&e.right>f.right+E&&(E=e.right-f.right+n)):e.right>f.right&&(E=e.right-f.right+n,t<0&&e.left<f.left+E&&(E=e.left-(f.left+n))):E=(i=="center"?e.left+(e.right-e.left)/2-(f.right-f.left)/2:i=="start"==o?e.left-n:e.right-(f.right-f.left)+n)-f.left,E||C)if(m)u.scrollBy(E,C);else{let _=0,v=0;if(C){let T=c.scrollTop;c.scrollTop+=C/y,v=(c.scrollTop-T)*y}if(E){let T=c.scrollLeft;c.scrollLeft+=E/S,_=(c.scrollLeft-T)*S}e={left:e.left-_,top:e.top-v,right:e.right-_,bottom:e.bottom-v},_&&Math.abs(_-E)<1&&(i="nearest"),v&&Math.abs(v-C)<1&&(s="nearest")}if(m)break;(e.top<f.top||e.bottom>f.bottom||e.left<f.left||e.right>f.right)&&(e={left:Math.max(e.left,f.left),right:Math.min(e.right,f.right),top:Math.max(e.top,f.top),bottom:Math.min(e.bottom,f.bottom)}),c=c.assignedSlot||c.parentNode}else if(c.nodeType==11)c=c.host;else break}function V3(r){let e=r.ownerDocument,t,i;for(let s=r.parentNode;s&&!(s==e.body||t&&i);)if(s.nodeType==1)!i&&s.scrollHeight>s.clientHeight&&(i=s),!t&&s.scrollWidth>s.clientWidth&&(t=s),s=s.assignedSlot||s.parentNode;else if(s.nodeType==11)s=s.host;else break;return{x:t,y:i}}class X3{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}eq(e){return this.anchorNode==e.anchorNode&&this.anchorOffset==e.anchorOffset&&this.focusNode==e.focusNode&&this.focusOffset==e.focusOffset}setRange(e){let{anchorNode:t,focusNode:i}=e;this.set(t,Math.min(e.anchorOffset,t?Yr(t):0),i,Math.min(e.focusOffset,i?Yr(i):0))}set(e,t,i,s){this.anchorNode=e,this.anchorOffset=t,this.focusNode=i,this.focusOffset=s}}let dn=null;me.safari&&me.safari_version>=26&&(dn=!1);function aw(r){if(r.setActive)return r.setActive();if(dn)return r.focus(dn);let e=[];for(let t=r;t&&(e.push(t,t.scrollTop,t.scrollLeft),t!=t.ownerDocument);t=t.parentNode);if(r.focus(dn==null?{get preventScroll(){return dn={preventScroll:!0},!0}}:void 0),!dn){dn=!1;for(let t=0;t<e.length;){let i=e[t++],s=e[t++],n=e[t++];i.scrollTop!=s&&(i.scrollTop=s),i.scrollLeft!=n&&(i.scrollLeft=n)}}}let Fb;function Qn(r,e,t=e){let i=Fb||(Fb=document.createRange());return i.setEnd(r,t),i.setStart(r,e),i}function Ta(r,e,t,i){let s={key:e,code:e,keyCode:t,which:t,cancelable:!0};i&&({altKey:s.altKey,ctrlKey:s.ctrlKey,shiftKey:s.shiftKey,metaKey:s.metaKey}=i);let n=new KeyboardEvent("keydown",s);n.synthetic=!0,r.dispatchEvent(n);let a=new KeyboardEvent("keyup",s);return a.synthetic=!0,r.dispatchEvent(a),n.defaultPrevented||a.defaultPrevented}function j3(r){for(;r;){if(r&&(r.nodeType==9||r.nodeType==11&&r.host))return r;r=r.assignedSlot||r.parentNode}return null}function ow(r){for(;r.attributes.length;)r.removeAttributeNode(r.attributes[0])}function z3(r,e){let t=e.focusNode,i=e.focusOffset;if(!t||e.anchorNode!=t||e.anchorOffset!=i)return!1;for(i=Math.min(i,Yr(t));;)if(i){if(t.nodeType!=1)return!1;let s=t.childNodes[i-1];s.contentEditable=="false"?i--:(t=s,i=Yr(t))}else{if(t==r)return!0;i=Ln(t),t=t.parentNode}}function lw(r){return r.scrollTop>Math.max(1,r.scrollHeight-r.clientHeight-4)}function uw(r,e){for(let t=r,i=e;;){if(t.nodeType==3&&i>0)return{node:t,offset:i};if(t.nodeType==1&&i>0){if(t.contentEditable=="false")return null;t=t.childNodes[i-1],i=Yr(t)}else if(t.parentNode&&!ah(t))i=Ln(t),t=t.parentNode;else return null}}function cw(r,e){for(let t=r,i=e;;){if(t.nodeType==3&&i<t.nodeValue.length)return{node:t,offset:i};if(t.nodeType==1&&i<t.childNodes.length){if(t.contentEditable=="false")return null;t=t.childNodes[i],i=0}else if(t.parentNode&&!ah(t))i=Ln(t)+1,t=t.parentNode;else return null}}class ri{constructor(e,t,i=!0){this.node=e,this.offset=t,this.precise=i}static before(e,t){return new ri(e.parentNode,Ln(e),t)}static after(e,t){return new ri(e.parentNode,Ln(e)+1,t)}}const Gg=[];class et{constructor(){this.parent=null,this.dom=null,this.flags=2}get overrideDOMText(){return null}get posAtStart(){return this.parent?this.parent.posBefore(this):0}get posAtEnd(){return this.posAtStart+this.length}posBefore(e){let t=this.posAtStart;for(let i of this.children){if(i==e)return t;t+=i.length+i.breakAfter}throw new RangeError("Invalid child in posBefore")}posAfter(e){return this.posBefore(e)+e.length}sync(e,t){if(this.flags&2){let i=this.dom,s=null,n;for(let a of this.children){if(a.flags&7){if(!a.dom&&(n=s?s.nextSibling:i.firstChild)){let o=et.get(n);(!o||!o.parent&&o.canReuseDOM(a))&&a.reuseDOM(n)}a.sync(e,t),a.flags&=-8}if(n=s?s.nextSibling:i.firstChild,t&&!t.written&&t.node==i&&n!=a.dom&&(t.written=!0),a.dom.parentNode==i)for(;n&&n!=a.dom;)n=Ub(n);else i.insertBefore(a.dom,n);s=a.dom}for(n=s?s.nextSibling:i.firstChild,n&&t&&t.node==i&&(t.written=!0);n;)n=Ub(n)}else if(this.flags&1)for(let i of this.children)i.flags&7&&(i.sync(e,t),i.flags&=-8)}reuseDOM(e){}localPosFromDOM(e,t){let i;if(e==this.dom)i=this.dom.childNodes[t];else{let s=Yr(e)==0?0:t==0?-1:1;for(;;){let n=e.parentNode;if(n==this.dom)break;s==0&&n.firstChild!=n.lastChild&&(e==n.firstChild?s=-1:s=1),e=n}s<0?i=e:i=e.nextSibling}if(i==this.dom.firstChild)return 0;for(;i&&!et.get(i);)i=i.nextSibling;if(!i)return this.length;for(let s=0,n=0;;s++){let a=this.children[s];if(a.dom==i)return n;n+=a.length+a.breakAfter}}domBoundsAround(e,t,i=0){let s=-1,n=-1,a=-1,o=-1;for(let l=0,u=i,c=i;l<this.children.length;l++){let h=this.children[l],f=u+h.length;if(u<e&&f>t)return h.domBoundsAround(e,t,u);if(f>=e&&s==-1&&(s=l,n=u),u>t&&h.dom.parentNode==this.dom){a=l,o=c;break}c=f,u=f+h.breakAfter}return{from:n,to:o<0?i+this.length:o,startDOM:(s?this.children[s-1].dom.nextSibling:null)||this.dom.firstChild,endDOM:a<this.children.length&&a>=0?this.children[a].dom:null}}markDirty(e=!1){this.flags|=2,this.markParentsDirty(e)}markParentsDirty(e){for(let t=this.parent;t;t=t.parent){if(e&&(t.flags|=2),t.flags&1)return;t.flags|=1,e=!1}}setParent(e){this.parent!=e&&(this.parent=e,this.flags&7&&this.markParentsDirty(!0))}setDOM(e){this.dom!=e&&(this.dom&&(this.dom.cmView=null),this.dom=e,e.cmView=this)}get rootView(){for(let e=this;;){let t=e.parent;if(!t)return e;e=t}}replaceChildren(e,t,i=Gg){this.markDirty();for(let s=e;s<t;s++){let n=this.children[s];n.parent==this&&i.indexOf(n)<0&&n.destroy()}i.length<250?this.children.splice(e,t-e,...i):this.children=[].concat(this.children.slice(0,e),i,this.children.slice(t));for(let s=0;s<i.length;s++)i[s].setParent(this)}ignoreMutation(e){return!1}ignoreEvent(e){return!1}childCursor(e=this.length){return new hw(this.children,e,this.children.length)}childPos(e,t=1){return this.childCursor().findPos(e,t)}toString(){let e=this.constructor.name.replace("View","");return e+(this.children.length?"("+this.children.join()+")":this.length?"["+(e=="Text"?this.text:this.length)+"]":"")+(this.breakAfter?"#":"")}static get(e){return e.cmView}get isEditable(){return!0}get isWidget(){return!1}get isHidden(){return!1}merge(e,t,i,s,n,a){return!1}become(e){return!1}canReuseDOM(e){return e.constructor==this.constructor&&!((this.flags|e.flags)&8)}getSide(){return 0}destroy(){for(let e of this.children)e.parent==this&&e.destroy();this.parent=null}}et.prototype.breakAfter=0;function Ub(r){let e=r.nextSibling;return r.parentNode.removeChild(r),e}class hw{constructor(e,t,i){this.children=e,this.pos=t,this.i=i,this.off=0}findPos(e,t=1){for(;;){if(e>this.pos||e==this.pos&&(t>0||this.i==0||this.children[this.i-1].breakAfter))return this.off=e-this.pos,this;let i=this.children[--this.i];this.pos-=i.length+i.breakAfter}}}function dw(r,e,t,i,s,n,a,o,l){let{children:u}=r,c=u.length?u[e]:null,h=n.length?n[n.length-1]:null,f=h?h.breakAfter:a;if(!(e==i&&c&&!a&&!f&&n.length<2&&c.merge(t,s,n.length?h:null,t==0,o,l))){if(i<u.length){let m=u[i];m&&(s<m.length||m.breakAfter&&h?.breakAfter)?(e==i&&(m=m.split(s),s=0),!f&&h&&m.merge(0,s,h,!0,0,l)?n[n.length-1]=m:((s||m.children.length&&!m.children[0].length)&&m.merge(0,s,null,!1,0,l),n.push(m))):m?.breakAfter&&(h?h.breakAfter=1:a=1),i++}for(c&&(c.breakAfter=a,t>0&&(!a&&n.length&&c.merge(t,c.length,n[0],!1,o,0)?c.breakAfter=n.shift().breakAfter:(t<c.length||c.children.length&&c.children[c.children.length-1].length==0)&&c.merge(t,c.length,null,!1,o,0),e++));e<i&&n.length;)if(u[i-1].become(n[n.length-1]))i--,n.pop(),l=n.length?0:o;else if(u[e].become(n[0]))e++,n.shift(),o=n.length?0:l;else break;!n.length&&e&&i<u.length&&!u[e-1].breakAfter&&u[i].merge(0,0,u[e-1],!1,o,l)&&e--,(e<i||n.length)&&r.replaceChildren(e,i,n)}}function fw(r,e,t,i,s,n){let a=r.childCursor(),{i:o,off:l}=a.findPos(t,1),{i:u,off:c}=a.findPos(e,-1),h=e-t;for(let f of i)h+=f.length;r.length+=h,dw(r,u,c,o,l,i,0,s,n)}const Z3=256;class br extends et{constructor(e){super(),this.text=e}get length(){return this.text.length}createDOM(e){this.setDOM(e||document.createTextNode(this.text))}sync(e,t){this.dom||this.createDOM(),this.dom.nodeValue!=this.text&&(t&&t.node==this.dom&&(t.written=!0),this.dom.nodeValue=this.text)}reuseDOM(e){e.nodeType==3&&this.createDOM(e)}merge(e,t,i){return this.flags&8||i&&(!(i instanceof br)||this.length-(t-e)+i.length>Z3||i.flags&8)?!1:(this.text=this.text.slice(0,e)+(i?i.text:"")+this.text.slice(t),this.markDirty(),!0)}split(e){let t=new br(this.text.slice(e));return this.text=this.text.slice(0,e),this.markDirty(),t.flags|=this.flags&8,t}localPosFromDOM(e,t){return e==this.dom?t:t?this.text.length:0}domAtPos(e){return new ri(this.dom,e)}domBoundsAround(e,t,i){return{from:i,to:i+this.length,startDOM:this.dom,endDOM:this.dom.nextSibling}}coordsAt(e,t){return W3(this.dom,e,t)}}class bs extends et{constructor(e,t=[],i=0){super(),this.mark=e,this.children=t,this.length=i;for(let s of t)s.setParent(this)}setAttrs(e){if(ow(e),this.mark.class&&(e.className=this.mark.class),this.mark.attrs)for(let t in this.mark.attrs)e.setAttribute(t,this.mark.attrs[t]);return e}canReuseDOM(e){return super.canReuseDOM(e)&&!((this.flags|e.flags)&8)}reuseDOM(e){e.nodeName==this.mark.tagName.toUpperCase()&&(this.setDOM(e),this.flags|=6)}sync(e,t){this.dom?this.flags&4&&this.setAttrs(this.dom):this.setDOM(this.setAttrs(document.createElement(this.mark.tagName))),super.sync(e,t)}merge(e,t,i,s,n,a){return i&&(!(i instanceof bs&&i.mark.eq(this.mark))||e&&n<=0||t<this.length&&a<=0)?!1:(fw(this,e,t,i?i.children.slice():[],n-1,a-1),this.markDirty(),!0)}split(e){let t=[],i=0,s=-1,n=0;for(let o of this.children){let l=i+o.length;l>e&&t.push(i<e?o.split(e-i):o),s<0&&i>=e&&(s=n),i=l,n++}let a=this.length-e;return this.length=e,s>-1&&(this.children.length=s,this.markDirty()),new bs(this.mark,t,a)}domAtPos(e){return pw(this,e)}coordsAt(e,t){return gw(this,e,t)}}function W3(r,e,t){let i=r.nodeValue.length;e>i&&(e=i);let s=e,n=e,a=0;e==0&&t<0||e==i&&t>=0?me.chrome||me.gecko||(e?(s--,a=1):n<i&&(n++,a=-1)):t<0?s--:n<i&&n++;let o=Qn(r,s,n).getClientRects();if(!o.length)return null;let l=o[(a?a<0:t>=0)?0:o.length-1];return me.safari&&!a&&l.width==0&&(l=Array.prototype.find.call(o,u=>u.width)||l),a?od(l,a<0):l||null}class qs extends et{static create(e,t,i){return new qs(e,t,i)}constructor(e,t,i){super(),this.widget=e,this.length=t,this.side=i,this.prevWidget=null}split(e){let t=qs.create(this.widget,this.length-e,this.side);return this.length-=e,t}sync(e){(!this.dom||!this.widget.updateDOM(this.dom,e))&&(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(e)),this.widget.editable||(this.dom.contentEditable="false"))}getSide(){return this.side}merge(e,t,i,s,n,a){return i&&(!(i instanceof qs)||!this.widget.compare(i.widget)||e>0&&n<=0||t<this.length&&a<=0)?!1:(this.length=e+(i?i.length:0)+(this.length-t),!0)}become(e){return e instanceof qs&&e.side==this.side&&this.widget.constructor==e.widget.constructor?(this.widget.compare(e.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=e.widget,this.length=e.length,!0):!1}ignoreMutation(){return!0}ignoreEvent(e){return this.widget.ignoreEvent(e)}get overrideDOMText(){if(this.length==0)return Ue.empty;let e=this;for(;e.parent;)e=e.parent;let{view:t}=e,i=t&&t.state.doc,s=this.posAtStart;return i?i.slice(s,s+this.length):Ue.empty}domAtPos(e){return(this.length?e==0:this.side>0)?ri.before(this.dom):ri.after(this.dom,e==this.length)}domBoundsAround(){return null}coordsAt(e,t){let i=this.widget.coordsAt(this.dom,e,t);if(i)return i;let s=this.dom.getClientRects(),n=null;if(!s.length)return null;let a=this.side?this.side<0:e>0;for(let o=a?s.length-1:0;n=s[o],!(e>0?o==0:o==s.length-1||n.top<n.bottom);o+=a?-1:1);return od(n,!a)}get isEditable(){return!1}get isWidget(){return!0}get isHidden(){return this.widget.isHidden}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}}class $a extends et{constructor(e){super(),this.side=e}get length(){return 0}merge(){return!1}become(e){return e instanceof $a&&e.side==this.side}split(){return new $a(this.side)}sync(){if(!this.dom){let e=document.createElement("img");e.className="cm-widgetBuffer",e.setAttribute("aria-hidden","true"),this.setDOM(e)}}getSide(){return this.side}domAtPos(e){return this.side>0?ri.before(this.dom):ri.after(this.dom)}localPosFromDOM(){return 0}domBoundsAround(){return null}coordsAt(e){return this.dom.getBoundingClientRect()}get overrideDOMText(){return Ue.empty}get isHidden(){return!0}}br.prototype.children=qs.prototype.children=$a.prototype.children=Gg;function pw(r,e){let t=r.dom,{children:i}=r,s=0;for(let n=0;s<i.length;s++){let a=i[s],o=n+a.length;if(!(o==n&&a.getSide()<=0)){if(e>n&&e<o&&a.dom.parentNode==t)return a.domAtPos(e-n);if(e<=n)break;n=o}}for(let n=s;n>0;n--){let a=i[n-1];if(a.dom.parentNode==t)return a.domAtPos(a.length)}for(let n=s;n<i.length;n++){let a=i[n];if(a.dom.parentNode==t)return a.domAtPos(0)}return new ri(t,0)}function mw(r,e,t){let i,{children:s}=r;t>0&&e instanceof bs&&s.length&&(i=s[s.length-1])instanceof bs&&i.mark.eq(e.mark)?mw(i,e.children[0],t-1):(s.push(e),e.setParent(r)),r.length+=e.length}function gw(r,e,t){let i=null,s=-1,n=null,a=-1;function o(u,c){for(let h=0,f=0;h<u.children.length&&f<=c;h++){let m=u.children[h],S=f+m.length;S>=c&&(m.children.length?o(m,c-f):(!n||n.isHidden&&(t>0||Y3(n,m)))&&(S>c||f==S&&m.getSide()>0)?(n=m,a=c-f):(f<c||f==S&&m.getSide()<0&&!m.isHidden)&&(i=m,s=c-f)),f=S}}o(r,e);let l=(t<0?i:n)||i||n;return l?l.coordsAt(Math.max(0,l==i?s:a),t):H3(r)}function H3(r){let e=r.dom.lastChild;if(!e)return r.dom.getBoundingClientRect();let t=Tl(e);return t[t.length-1]||null}function Y3(r,e){let t=r.coordsAt(0,1),i=e.coordsAt(0,1);return t&&i&&i.top<t.bottom}function om(r,e){for(let t in r)t=="class"&&e.class?e.class+=" "+r.class:t=="style"&&e.style?e.style+=";"+r.style:e[t]=r[t];return e}const qb=Object.create(null);function oh(r,e,t){if(r==e)return!0;r||(r=qb),e||(e=qb);let i=Object.keys(r),s=Object.keys(e);if(i.length-(t&&i.indexOf(t)>-1?1:0)!=s.length-(t&&s.indexOf(t)>-1?1:0))return!1;for(let n of i)if(n!=t&&(s.indexOf(n)==-1||r[n]!==e[n]))return!1;return!0}function lm(r,e,t){let i=!1;if(e)for(let s in e)t&&s in t||(i=!0,s=="style"?r.style.cssText="":r.removeAttribute(s));if(t)for(let s in t)e&&e[s]==t[s]||(i=!0,s=="style"?r.style.cssText=t[s]:r.setAttribute(s,t[s]));return i}function G3(r){let e=Object.create(null);for(let t=0;t<r.attributes.length;t++){let i=r.attributes[t];e[i.name]=i.value}return e}class _s{eq(e){return!1}updateDOM(e,t){return!1}compare(e){return this==e||this.constructor==e.constructor&&this.eq(e)}get estimatedHeight(){return-1}get lineBreaks(){return 0}ignoreEvent(e){return!0}coordsAt(e,t,i){return null}get isHidden(){return!1}get editable(){return!1}destroy(e){}}var gi=(function(r){return r[r.Text=0]="Text",r[r.WidgetBefore=1]="WidgetBefore",r[r.WidgetAfter=2]="WidgetAfter",r[r.WidgetRange=3]="WidgetRange",r})(gi||(gi={}));class Ee extends Rn{constructor(e,t,i,s){super(),this.startSide=e,this.endSide=t,this.widget=i,this.spec=s}get heightRelevant(){return!1}static mark(e){return new Kl(e)}static widget(e){let t=Math.max(-1e4,Math.min(1e4,e.side||0)),i=!!e.block;return t+=i&&!e.inlineOrder?t>0?3e8:-4e8:t>0?1e8:-1e8,new Ys(e,t,t,i,e.widget||null,!1)}static replace(e){let t=!!e.block,i,s;if(e.isBlockGap)i=-5e8,s=4e8;else{let{start:n,end:a}=Ow(e,t);i=(n?t?-3e8:-1:5e8)-1,s=(a?t?2e8:1:-6e8)+1}return new Ys(e,i,s,t,e.widget||null,!0)}static line(e){return new Jl(e)}static set(e,t=!1){return je.of(e,t)}hasHeight(){return this.widget?this.widget.estimatedHeight>-1:!1}}Ee.none=je.empty;class Kl extends Ee{constructor(e){let{start:t,end:i}=Ow(e);super(t?-1:5e8,i?1:-6e8,null,e),this.tagName=e.tagName||"span",this.class=e.class||"",this.attrs=e.attributes||null}eq(e){var t,i;return this==e||e instanceof Kl&&this.tagName==e.tagName&&(this.class||((t=this.attrs)===null||t===void 0?void 0:t.class))==(e.class||((i=e.attrs)===null||i===void 0?void 0:i.class))&&oh(this.attrs,e.attrs,"class")}range(e,t=e){if(e>=t)throw new RangeError("Mark decorations may not be empty");return super.range(e,t)}}Kl.prototype.point=!1;class Jl extends Ee{constructor(e){super(-2e8,-2e8,null,e)}eq(e){return e instanceof Jl&&this.spec.class==e.spec.class&&oh(this.spec.attributes,e.spec.attributes)}range(e,t=e){if(t!=e)throw new RangeError("Line decoration ranges must be zero-length");return super.range(e,t)}}Jl.prototype.mapMode=Yt.TrackBefore;Jl.prototype.point=!0;class Ys extends Ee{constructor(e,t,i,s,n,a){super(t,i,n,e),this.block=s,this.isReplace=a,this.mapMode=s?t<=0?Yt.TrackBefore:Yt.TrackAfter:Yt.TrackDel}get type(){return this.startSide!=this.endSide?gi.WidgetRange:this.startSide<=0?gi.WidgetBefore:gi.WidgetAfter}get heightRelevant(){return this.block||!!this.widget&&(this.widget.estimatedHeight>=5||this.widget.lineBreaks>0)}eq(e){return e instanceof Ys&&K3(this.widget,e.widget)&&this.block==e.block&&this.startSide==e.startSide&&this.endSide==e.endSide}range(e,t=e){if(this.isReplace&&(e>t||e==t&&this.startSide>0&&this.endSide<=0))throw new RangeError("Invalid range for replacement decoration");if(!this.isReplace&&t!=e)throw new RangeError("Widget decorations can only have zero-length ranges");return super.range(e,t)}}Ys.prototype.point=!0;function Ow(r,e=!1){let{inclusiveStart:t,inclusiveEnd:i}=r;return t==null&&(t=r.inclusive),i==null&&(i=r.inclusive),{start:t??e,end:i??e}}function K3(r,e){return r==e||!!(r&&e&&r.compare(e))}function Sc(r,e,t,i=0){let s=t.length-1;s>=0&&t[s]+i>=r?t[s]=Math.max(t[s],e):t.push(r,e)}class It extends et{constructor(){super(...arguments),this.children=[],this.length=0,this.prevAttrs=void 0,this.attrs=null,this.breakAfter=0}merge(e,t,i,s,n,a){if(i){if(!(i instanceof It))return!1;this.dom||i.transferDOM(this)}return s&&this.setDeco(i?i.attrs:null),fw(this,e,t,i?i.children.slice():[],n,a),!0}split(e){let t=new It;if(t.breakAfter=this.breakAfter,this.length==0)return t;let{i,off:s}=this.childPos(e);s&&(t.append(this.children[i].split(s),0),this.children[i].merge(s,this.children[i].length,null,!1,0,0),i++);for(let n=i;n<this.children.length;n++)t.append(this.children[n],0);for(;i>0&&this.children[i-1].length==0;)this.children[--i].destroy();return this.children.length=i,this.markDirty(),this.length=e,t}transferDOM(e){this.dom&&(this.markDirty(),e.setDOM(this.dom),e.prevAttrs=this.prevAttrs===void 0?this.attrs:this.prevAttrs,this.prevAttrs=void 0,this.dom=null)}setDeco(e){oh(this.attrs,e)||(this.dom&&(this.prevAttrs=this.attrs,this.markDirty()),this.attrs=e)}append(e,t){mw(this,e,t)}addLineDeco(e){let t=e.spec.attributes,i=e.spec.class;t&&(this.attrs=om(t,this.attrs||{})),i&&(this.attrs=om({class:i},this.attrs||{}))}domAtPos(e){return pw(this,e)}reuseDOM(e){e.nodeName=="DIV"&&(this.setDOM(e),this.flags|=6)}sync(e,t){var i;this.dom?this.flags&4&&(ow(this.dom),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0):(this.setDOM(document.createElement("div")),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0),this.prevAttrs!==void 0&&(lm(this.dom,this.prevAttrs,this.attrs),this.dom.classList.add("cm-line"),this.prevAttrs=void 0),super.sync(e,t);let s=this.dom.lastChild;for(;s&&et.get(s)instanceof bs;)s=s.lastChild;if(!s||!this.length||s.nodeName!="BR"&&((i=et.get(s))===null||i===void 0?void 0:i.isEditable)==!1&&(!me.ios||!this.children.some(n=>n instanceof br))){let n=document.createElement("BR");n.cmIgnore=!0,this.dom.appendChild(n)}}measureTextSize(){if(this.children.length==0||this.length>20)return null;let e=0,t;for(let i of this.children){if(!(i instanceof br)||/[^ -~]/.test(i.text))return null;let s=Tl(i.dom);if(s.length!=1)return null;e+=s[0].width,t=s[0].height}return e?{lineHeight:this.dom.getBoundingClientRect().height,charWidth:e/this.length,textHeight:t}:null}coordsAt(e,t){let i=gw(this,e,t);if(!this.children.length&&i&&this.parent){let{heightOracle:s}=this.parent.view.viewState,n=i.bottom-i.top;if(Math.abs(n-s.lineHeight)<2&&s.textHeight<n){let a=(n-s.textHeight)/2;return{top:i.top+a,bottom:i.bottom-a,left:i.left,right:i.left}}}return i}become(e){return e instanceof It&&this.children.length==0&&e.children.length==0&&oh(this.attrs,e.attrs)&&this.breakAfter==e.breakAfter}covers(){return!0}static find(e,t){for(let i=0,s=0;i<e.children.length;i++){let n=e.children[i],a=s+n.length;if(a>=t){if(n instanceof It)return n;if(a>t)break}s=a+n.breakAfter}return null}}class ms extends et{constructor(e,t,i){super(),this.widget=e,this.length=t,this.deco=i,this.breakAfter=0,this.prevWidget=null}merge(e,t,i,s,n,a){return i&&(!(i instanceof ms)||!this.widget.compare(i.widget)||e>0&&n<=0||t<this.length&&a<=0)?!1:(this.length=e+(i?i.length:0)+(this.length-t),!0)}domAtPos(e){return e==0?ri.before(this.dom):ri.after(this.dom,e==this.length)}split(e){let t=this.length-e;this.length=e;let i=new ms(this.widget,t,this.deco);return i.breakAfter=this.breakAfter,i}get children(){return Gg}sync(e){(!this.dom||!this.widget.updateDOM(this.dom,e))&&(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(e)),this.widget.editable||(this.dom.contentEditable="false"))}get overrideDOMText(){return this.parent?this.parent.view.state.doc.slice(this.posAtStart,this.posAtEnd):Ue.empty}domBoundsAround(){return null}become(e){return e instanceof ms&&e.widget.constructor==this.widget.constructor?(e.widget.compare(this.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=e.widget,this.length=e.length,this.deco=e.deco,this.breakAfter=e.breakAfter,!0):!1}ignoreMutation(){return!0}ignoreEvent(e){return this.widget.ignoreEvent(e)}get isEditable(){return!1}get isWidget(){return!0}coordsAt(e,t){let i=this.widget.coordsAt(this.dom,e,t);return i||(this.widget instanceof um?null:od(this.dom.getBoundingClientRect(),this.length?e==0:t<=0))}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}covers(e){let{startSide:t,endSide:i}=this.deco;return t==i?!1:e<0?t<0:i>0}}class um extends _s{constructor(e){super(),this.height=e}toDOM(){let e=document.createElement("div");return e.className="cm-gap",this.updateDOM(e),e}eq(e){return e.height==this.height}updateDOM(e){return e.style.height=this.height+"px",!0}get editable(){return!0}get estimatedHeight(){return this.height}ignoreEvent(){return!1}}class sl{constructor(e,t,i,s){this.doc=e,this.pos=t,this.end=i,this.disallowBlockEffectsFor=s,this.content=[],this.curLine=null,this.breakAtStart=0,this.pendingBuffer=0,this.bufferMarks=[],this.atCursorPos=!0,this.openStart=-1,this.openEnd=-1,this.text="",this.textOff=0,this.cursor=e.iter(),this.skip=t}posCovered(){if(this.content.length==0)return!this.breakAtStart&&this.doc.lineAt(this.pos).from!=this.pos;let e=this.content[this.content.length-1];return!(e.breakAfter||e instanceof ms&&e.deco.endSide<0)}getLine(){return this.curLine||(this.content.push(this.curLine=new It),this.atCursorPos=!0),this.curLine}flushBuffer(e=this.bufferMarks){this.pendingBuffer&&(this.curLine.append(Zu(new $a(-1),e),e.length),this.pendingBuffer=0)}addBlockWidget(e){this.flushBuffer(),this.curLine=null,this.content.push(e)}finish(e){this.pendingBuffer&&e<=this.bufferMarks.length?this.flushBuffer():this.pendingBuffer=0,!this.posCovered()&&!(e&&this.content.length&&this.content[this.content.length-1]instanceof ms)&&this.getLine()}buildText(e,t,i){for(;e>0;){if(this.textOff==this.text.length){let{value:a,lineBreak:o,done:l}=this.cursor.next(this.skip);if(this.skip=0,l)throw new Error("Ran out of text content when drawing inline views");if(o){this.posCovered()||this.getLine(),this.content.length?this.content[this.content.length-1].breakAfter=1:this.breakAtStart=1,this.flushBuffer(),this.curLine=null,this.atCursorPos=!0,e--;continue}else this.text=a,this.textOff=0}let s=Math.min(this.text.length-this.textOff,e),n=Math.min(s,512);this.flushBuffer(t.slice(t.length-i)),this.getLine().append(Zu(new br(this.text.slice(this.textOff,this.textOff+n)),t),i),this.atCursorPos=!0,this.textOff+=n,e-=n,i=s<=n?0:t.length}}span(e,t,i,s){this.buildText(t-e,i,s),this.pos=t,this.openStart<0&&(this.openStart=s)}point(e,t,i,s,n,a){if(this.disallowBlockEffectsFor[a]&&i instanceof Ys){if(i.block)throw new RangeError("Block decorations may not be specified via plugins");if(t>this.doc.lineAt(this.pos).to)throw new RangeError("Decorations that replace line breaks may not be specified via plugins")}let o=t-e;if(i instanceof Ys)if(i.block)i.startSide>0&&!this.posCovered()&&this.getLine(),this.addBlockWidget(new ms(i.widget||Ba.block,o,i));else{let l=qs.create(i.widget||Ba.inline,o,o?0:i.startSide),u=this.atCursorPos&&!l.isEditable&&n<=s.length&&(e<t||i.startSide>0),c=!l.isEditable&&(e<t||n>s.length||i.startSide<=0),h=this.getLine();this.pendingBuffer==2&&!u&&!l.isEditable&&(this.pendingBuffer=0),this.flushBuffer(s),u&&(h.append(Zu(new $a(1),s),n),n=s.length+Math.max(0,n-s.length)),h.append(Zu(l,s),n),this.atCursorPos=c,this.pendingBuffer=c?e<t||n>s.length?1:2:0,this.pendingBuffer&&(this.bufferMarks=s.slice())}else this.doc.lineAt(this.pos).from==this.pos&&this.getLine().addLineDeco(i);o&&(this.textOff+o<=this.text.length?this.textOff+=o:(this.skip+=o-(this.text.length-this.textOff),this.text="",this.textOff=0),this.pos=t),this.openStart<0&&(this.openStart=n)}static build(e,t,i,s,n){let a=new sl(e,t,i,n);return a.openEnd=je.spans(s,t,i,a),a.openStart<0&&(a.openStart=a.openEnd),a.finish(a.openEnd),a}}function Zu(r,e){for(let t of e)r=new bs(t,[r],r.length);return r}class Ba extends _s{constructor(e){super(),this.tag=e}eq(e){return e.tag==this.tag}toDOM(){return document.createElement(this.tag)}updateDOM(e){return e.nodeName.toLowerCase()==this.tag}get isHidden(){return!0}}Ba.inline=new Ba("span");Ba.block=new Ba("div");var dt=(function(r){return r[r.LTR=0]="LTR",r[r.RTL=1]="RTL",r})(dt||(dt={}));const $n=dt.LTR,Kg=dt.RTL;function yw(r){let e=[];for(let t=0;t<r.length;t++)e.push(1<<+r[t]);return e}const J3=yw("88888888888888888888888888888888888666888888787833333333337888888000000000000000000000000008888880000000000000000000000000088888888888888888888888888888888888887866668888088888663380888308888800000000000000000000000800000000000000000000000000000008"),e4=yw("4444448826627288999999999992222222222222222222222222222222222222222222222229999999999999999999994444444444644222822222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222999999949999999229989999223333333333"),cm=Object.create(null),Ar=[];for(let r of["()","[]","{}"]){let e=r.charCodeAt(0),t=r.charCodeAt(1);cm[e]=t,cm[t]=-e}function bw(r){return r<=247?J3[r]:1424<=r&&r<=1524?2:1536<=r&&r<=1785?e4[r-1536]:1774<=r&&r<=2220?4:8192<=r&&r<=8204?256:64336<=r&&r<=65023?4:1}const t4=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac\ufb50-\ufdff]/;class Vs{get dir(){return this.level%2?Kg:$n}constructor(e,t,i){this.from=e,this.to=t,this.level=i}side(e,t){return this.dir==t==e?this.to:this.from}forward(e,t){return e==(this.dir==t)}static find(e,t,i,s){let n=-1;for(let a=0;a<e.length;a++){let o=e[a];if(o.from<=t&&o.to>=t){if(o.level==i)return a;(n<0||(s!=0?s<0?o.from<t:o.to>t:e[n].level>o.level))&&(n=a)}}if(n<0)throw new RangeError("Index out of range");return n}}function vw(r,e){if(r.length!=e.length)return!1;for(let t=0;t<r.length;t++){let i=r[t],s=e[t];if(i.from!=s.from||i.to!=s.to||i.direction!=s.direction||!vw(i.inner,s.inner))return!1}return!0}const st=[];function i4(r,e,t,i,s){for(let n=0;n<=i.length;n++){let a=n?i[n-1].to:e,o=n<i.length?i[n].from:t,l=n?256:s;for(let u=a,c=l,h=l;u<o;u++){let f=bw(r.charCodeAt(u));f==512?f=c:f==8&&h==4&&(f=16),st[u]=f==4?2:f,f&7&&(h=f),c=f}for(let u=a,c=l,h=l;u<o;u++){let f=st[u];if(f==128)u<o-1&&c==st[u+1]&&c&24?f=st[u]=c:st[u]=256;else if(f==64){let m=u+1;for(;m<o&&st[m]==64;)m++;let S=u&&c==8||m<t&&st[m]==8?h==1?1:8:256;for(let y=u;y<m;y++)st[y]=S;u=m-1}else f==8&&h==1&&(st[u]=1);c=f,f&7&&(h=f)}}}function r4(r,e,t,i,s){let n=s==1?2:1;for(let a=0,o=0,l=0;a<=i.length;a++){let u=a?i[a-1].to:e,c=a<i.length?i[a].from:t;for(let h=u,f,m,S;h<c;h++)if(m=cm[f=r.charCodeAt(h)])if(m<0){for(let y=o-3;y>=0;y-=3)if(Ar[y+1]==-m){let E=Ar[y+2],C=E&2?s:E&4?E&1?n:s:0;C&&(st[h]=st[Ar[y]]=C),o=y;break}}else{if(Ar.length==189)break;Ar[o++]=h,Ar[o++]=f,Ar[o++]=l}else if((S=st[h])==2||S==1){let y=S==s;l=y?0:1;for(let E=o-3;E>=0;E-=3){let C=Ar[E+2];if(C&2)break;if(y)Ar[E+2]|=2;else{if(C&4)break;Ar[E+2]|=4}}}}}function s4(r,e,t,i){for(let s=0,n=i;s<=t.length;s++){let a=s?t[s-1].to:r,o=s<t.length?t[s].from:e;for(let l=a;l<o;){let u=st[l];if(u==256){let c=l+1;for(;;)if(c==o){if(s==t.length)break;c=t[s++].to,o=s<t.length?t[s].from:e}else if(st[c]==256)c++;else break;let h=n==1,f=(c<e?st[c]:i)==1,m=h==f?h?1:2:i;for(let S=c,y=s,E=y?t[y-1].to:r;S>l;)S==E&&(S=t[--y].from,E=y?t[y-1].to:r),st[--S]=m;l=c}else n=u,l++}}}function hm(r,e,t,i,s,n,a){let o=i%2?2:1;if(i%2==s%2)for(let l=e,u=0;l<t;){let c=!0,h=!1;if(u==n.length||l<n[u].from){let y=st[l];y!=o&&(c=!1,h=y==16)}let f=!c&&o==1?[]:null,m=c?i:i+1,S=l;e:for(;;)if(u<n.length&&S==n[u].from){if(h)break e;let y=n[u];if(!c)for(let E=y.to,C=u+1;;){if(E==t)break e;if(C<n.length&&n[C].from==E)E=n[C++].to;else{if(st[E]==o)break e;break}}if(u++,f)f.push(y);else{y.from>l&&a.push(new Vs(l,y.from,m));let E=y.direction==$n!=!(m%2);dm(r,E?i+1:i,s,y.inner,y.from,y.to,a),l=y.to}S=y.to}else{if(S==t||(c?st[S]!=o:st[S]==o))break;S++}f?hm(r,l,S,i+1,s,f,a):l<S&&a.push(new Vs(l,S,m)),l=S}else for(let l=t,u=n.length;l>e;){let c=!0,h=!1;if(!u||l>n[u-1].to){let y=st[l-1];y!=o&&(c=!1,h=y==16)}let f=!c&&o==1?[]:null,m=c?i:i+1,S=l;e:for(;;)if(u&&S==n[u-1].to){if(h)break e;let y=n[--u];if(!c)for(let E=y.from,C=u;;){if(E==e)break e;if(C&&n[C-1].to==E)E=n[--C].from;else{if(st[E-1]==o)break e;break}}if(f)f.push(y);else{y.to<l&&a.push(new Vs(y.to,l,m));let E=y.direction==$n!=!(m%2);dm(r,E?i+1:i,s,y.inner,y.from,y.to,a),l=y.from}S=y.from}else{if(S==e||(c?st[S-1]!=o:st[S-1]==o))break;S--}f?hm(r,S,l,i+1,s,f,a):S<l&&a.push(new Vs(S,l,m)),l=S}}function dm(r,e,t,i,s,n,a){let o=e%2?2:1;i4(r,s,n,i,o),r4(r,s,n,i,o),s4(s,n,i,o),hm(r,s,n,e,t,i,a)}function n4(r,e,t){if(!r)return[new Vs(0,0,e==Kg?1:0)];if(e==$n&&!t.length&&!t4.test(r))return Sw(r.length);if(t.length)for(;r.length>st.length;)st[st.length]=256;let i=[],s=e==$n?0:1;return dm(r,s,s,t,0,r.length,i),i}function Sw(r){return[new Vs(0,r,0)]}let Tw="";function a4(r,e,t,i,s){var n;let a=i.head-r.from,o=Vs.find(e,a,(n=i.bidiLevel)!==null&&n!==void 0?n:-1,i.assoc),l=e[o],u=l.side(s,t);if(a==u){let f=o+=s?1:-1;if(f<0||f>=e.length)return null;l=e[o=f],a=l.side(!s,t),u=l.side(s,t)}let c=Kt(r.text,a,l.forward(s,t));(c<l.from||c>l.to)&&(c=u),Tw=r.text.slice(Math.min(a,c),Math.max(a,c));let h=o==(s?e.length-1:0)?null:e[o+(s?1:-1)];return h&&c==u&&h.level+(s?0:1)<l.level?ie.cursor(h.side(!s,t)+r.from,h.forward(s,t)?1:-1,h.level):ie.cursor(c+r.from,l.forward(s,t)?-1:1,l.level)}function o4(r,e,t){for(let i=e;i<t;i++){let s=bw(r.charCodeAt(i));if(s==1)return $n;if(s==2||s==4)return Kg}return $n}const _w=be.define(),xw=be.define(),ww=be.define(),Cw=be.define(),fm=be.define(),kw=be.define(),Ew=be.define(),Jg=be.define(),e0=be.define(),Aw=be.define({combine:r=>r.some(e=>e)}),Pw=be.define({combine:r=>r.some(e=>e)}),Dw=be.define();class _a{constructor(e,t="nearest",i="nearest",s=5,n=5,a=!1){this.range=e,this.y=t,this.x=i,this.yMargin=s,this.xMargin=n,this.isSnapshot=a}map(e){return e.empty?this:new _a(this.range.map(e),this.y,this.x,this.yMargin,this.xMargin,this.isSnapshot)}clip(e){return this.range.to<=e.doc.length?this:new _a(ie.cursor(e.doc.length),this.y,this.x,this.yMargin,this.xMargin,this.isSnapshot)}}const Wu=Re.define({map:(r,e)=>r.map(e)}),Mw=Re.define();function ki(r,e,t){let i=r.facet(Cw);i.length?i[0](e):window.onerror&&window.onerror(String(e),t,void 0,void 0,e)||(t?console.error(t+":",e):console.error(e))}const fs=be.define({combine:r=>r.length?r[0]:!0});let l4=0;const na=be.define({combine(r){return r.filter((e,t)=>{for(let i=0;i<t;i++)if(r[i].plugin==e.plugin)return!1;return!0})}});class Qt{constructor(e,t,i,s,n){this.id=e,this.create=t,this.domEventHandlers=i,this.domEventObservers=s,this.baseExtensions=n(this),this.extension=this.baseExtensions.concat(na.of({plugin:this,arg:void 0}))}of(e){return this.baseExtensions.concat(na.of({plugin:this,arg:e}))}static define(e,t){const{eventHandlers:i,eventObservers:s,provide:n,decorations:a}=t||{};return new Qt(l4++,e,i,s,o=>{let l=[];return a&&l.push(_l.of(u=>{let c=u.plugin(o);return c?a(c):Ee.none})),n&&l.push(n(o)),l})}static fromClass(e,t){return Qt.define((i,s)=>new e(i,s),t)}}class Cf{constructor(e){this.spec=e,this.mustUpdate=null,this.value=null}get plugin(){return this.spec&&this.spec.plugin}update(e){if(this.value){if(this.mustUpdate){let t=this.mustUpdate;if(this.mustUpdate=null,this.value.update)try{this.value.update(t)}catch(i){if(ki(t.state,i,"CodeMirror plugin crashed"),this.value.destroy)try{this.value.destroy()}catch{}this.deactivate()}}}else if(this.spec)try{this.value=this.spec.plugin.create(e,this.spec.arg)}catch(t){ki(e.state,t,"CodeMirror plugin crashed"),this.deactivate()}return this}destroy(e){var t;if(!((t=this.value)===null||t===void 0)&&t.destroy)try{this.value.destroy()}catch(i){ki(e.state,i,"CodeMirror plugin crashed")}}deactivate(){this.spec=this.value=null}}const Iw=be.define(),t0=be.define(),_l=be.define(),Rw=be.define(),eu=be.define(),Lw=be.define();function Vb(r,e){let t=r.state.facet(Lw);if(!t.length)return t;let i=t.map(n=>n instanceof Function?n(r):n),s=[];return je.spans(i,e.from,e.to,{point(){},span(n,a,o,l){let u=n-e.from,c=a-e.from,h=s;for(let f=o.length-1;f>=0;f--,l--){let m=o[f].spec.bidiIsolate,S;if(m==null&&(m=o4(e.text,u,c)),l>0&&h.length&&(S=h[h.length-1]).to==u&&S.direction==m)S.to=c,h=S.inner;else{let y={from:u,to:c,direction:m,inner:[]};h.push(y),h=y.inner}}}}),s}const Qw=be.define();function i0(r){let e=0,t=0,i=0,s=0;for(let n of r.state.facet(Qw)){let a=n(r);a&&(a.left!=null&&(e=Math.max(e,a.left)),a.right!=null&&(t=Math.max(t,a.right)),a.top!=null&&(i=Math.max(i,a.top)),a.bottom!=null&&(s=Math.max(s,a.bottom)))}return{left:e,right:t,top:i,bottom:s}}const Uo=be.define();class ir{constructor(e,t,i,s){this.fromA=e,this.toA=t,this.fromB=i,this.toB=s}join(e){return new ir(Math.min(this.fromA,e.fromA),Math.max(this.toA,e.toA),Math.min(this.fromB,e.fromB),Math.max(this.toB,e.toB))}addToSet(e){let t=e.length,i=this;for(;t>0;t--){let s=e[t-1];if(!(s.fromA>i.toA)){if(s.toA<i.fromA)break;i=i.join(s),e.splice(t-1,1)}}return e.splice(t,0,i),e}static extendWithRanges(e,t){if(t.length==0)return e;let i=[];for(let s=0,n=0,a=0,o=0;;s++){let l=s==e.length?null:e[s],u=a-o,c=l?l.fromB:1e9;for(;n<t.length&&t[n]<c;){let h=t[n],f=t[n+1],m=Math.max(o,h),S=Math.min(c,f);if(m<=S&&new ir(m+u,S+u,m,S).addToSet(i),f>c)break;n+=2}if(!l)return i;new ir(l.fromA,l.toA,l.fromB,l.toB).addToSet(i),a=l.toA,o=l.toB}}}class lh{constructor(e,t,i){this.view=e,this.state=t,this.transactions=i,this.flags=0,this.startState=e.state,this.changes=$t.empty(this.startState.doc.length);for(let n of i)this.changes=this.changes.compose(n.changes);let s=[];this.changes.iterChangedRanges((n,a,o,l)=>s.push(new ir(n,a,o,l))),this.changedRanges=s}static create(e,t,i){return new lh(e,t,i)}get viewportChanged(){return(this.flags&4)>0}get viewportMoved(){return(this.flags&8)>0}get heightChanged(){return(this.flags&2)>0}get geometryChanged(){return this.docChanged||(this.flags&18)>0}get focusChanged(){return(this.flags&1)>0}get docChanged(){return!this.changes.empty}get selectionSet(){return this.transactions.some(e=>e.selection)}get empty(){return this.flags==0&&this.transactions.length==0}}class Xb extends et{get length(){return this.view.state.doc.length}constructor(e){super(),this.view=e,this.decorations=[],this.dynamicDecorationMap=[!1],this.domChanged=null,this.hasComposition=null,this.markedForComposition=new Set,this.editContextFormatting=Ee.none,this.lastCompositionAfterCursor=!1,this.minWidth=0,this.minWidthFrom=0,this.minWidthTo=0,this.impreciseAnchor=null,this.impreciseHead=null,this.forceSelection=!1,this.lastUpdate=Date.now(),this.setDOM(e.contentDOM),this.children=[new It],this.children[0].setParent(this),this.updateDeco(),this.updateInner([new ir(0,0,0,e.state.doc.length)],0,null)}update(e){var t;let i=e.changedRanges;this.minWidth>0&&i.length&&(i.every(({fromA:u,toA:c})=>c<this.minWidthFrom||u>this.minWidthTo)?(this.minWidthFrom=e.changes.mapPos(this.minWidthFrom,1),this.minWidthTo=e.changes.mapPos(this.minWidthTo,1)):this.minWidth=this.minWidthFrom=this.minWidthTo=0),this.updateEditContextFormatting(e);let s=-1;this.view.inputState.composing>=0&&!this.view.observer.editContext&&(!((t=this.domChanged)===null||t===void 0)&&t.newSel?s=this.domChanged.newSel.head:!m4(e.changes,this.hasComposition)&&!e.selectionSet&&(s=e.state.selection.main.head));let n=s>-1?c4(this.view,e.changes,s):null;if(this.domChanged=null,this.hasComposition){this.markedForComposition.clear();let{from:u,to:c}=this.hasComposition;i=new ir(u,c,e.changes.mapPos(u,-1),e.changes.mapPos(c,1)).addToSet(i.slice())}this.hasComposition=n?{from:n.range.fromB,to:n.range.toB}:null,(me.ie||me.chrome)&&!n&&e&&e.state.doc.lines!=e.startState.doc.lines&&(this.forceSelection=!0);let a=this.decorations,o=this.updateDeco(),l=f4(a,o,e.changes);return i=ir.extendWithRanges(i,l),!(this.flags&7)&&i.length==0?!1:(this.updateInner(i,e.startState.doc.length,n),e.transactions.length&&(this.lastUpdate=Date.now()),!0)}updateInner(e,t,i){this.view.viewState.mustMeasureContent=!0,this.updateChildren(e,t,i);let{observer:s}=this.view;s.ignore(()=>{this.dom.style.height=this.view.viewState.contentHeight/this.view.scaleY+"px",this.dom.style.flexBasis=this.minWidth?this.minWidth+"px":"";let a=me.chrome||me.ios?{node:s.selectionRange.focusNode,written:!1}:void 0;this.sync(this.view,a),this.flags&=-8,a&&(a.written||s.selectionRange.focusNode!=a.node)&&(this.forceSelection=!0),this.dom.style.height=""}),this.markedForComposition.forEach(a=>a.flags&=-9);let n=[];if(this.view.viewport.from||this.view.viewport.to<this.view.state.doc.length)for(let a of this.children)a instanceof ms&&a.widget instanceof um&&n.push(a.dom);s.updateGaps(n)}updateChildren(e,t,i){let s=i?i.range.addToSet(e.slice()):e,n=this.childCursor(t);for(let a=s.length-1;;a--){let o=a>=0?s[a]:null;if(!o)break;let{fromA:l,toA:u,fromB:c,toB:h}=o,f,m,S,y;if(i&&i.range.fromB<h&&i.range.toB>c){let T=sl.build(this.view.state.doc,c,i.range.fromB,this.decorations,this.dynamicDecorationMap),w=sl.build(this.view.state.doc,i.range.toB,h,this.decorations,this.dynamicDecorationMap);m=T.breakAtStart,S=T.openStart,y=w.openEnd;let A=this.compositionView(i);w.breakAtStart?A.breakAfter=1:w.content.length&&A.merge(A.length,A.length,w.content[0],!1,w.openStart,0)&&(A.breakAfter=w.content[0].breakAfter,w.content.shift()),T.content.length&&A.merge(0,0,T.content[T.content.length-1],!0,0,T.openEnd)&&T.content.pop(),f=T.content.concat(A).concat(w.content)}else({content:f,breakAtStart:m,openStart:S,openEnd:y}=sl.build(this.view.state.doc,c,h,this.decorations,this.dynamicDecorationMap));let{i:E,off:C}=n.findPos(u,1),{i:_,off:v}=n.findPos(l,-1);dw(this,_,v,E,C,f,m,S,y)}i&&this.fixCompositionDOM(i)}updateEditContextFormatting(e){this.editContextFormatting=this.editContextFormatting.map(e.changes);for(let t of e.transactions)for(let i of t.effects)i.is(Mw)&&(this.editContextFormatting=i.value)}compositionView(e){let t=new br(e.text.nodeValue);t.flags|=8;for(let{deco:s}of e.marks)t=new bs(s,[t],t.length);let i=new It;return i.append(t,0),i}fixCompositionDOM(e){let t=(n,a)=>{a.flags|=8|(a.children.some(l=>l.flags&7)?1:0),this.markedForComposition.add(a);let o=et.get(n);o&&o!=a&&(o.dom=null),a.setDOM(n)},i=this.childPos(e.range.fromB,1),s=this.children[i.i];t(e.line,s);for(let n=e.marks.length-1;n>=-1;n--)i=s.childPos(i.off,1),s=s.children[i.i],t(n>=0?e.marks[n].node:e.text,s)}updateSelection(e=!1,t=!1){(e||!this.view.observer.selectionRange.focusNode)&&this.view.observer.readSelectionRange();let i=this.view.root.activeElement,s=i==this.dom,n=!s&&!(this.view.state.facet(fs)||this.dom.tabIndex>-1)&&vc(this.dom,this.view.observer.selectionRange)&&!(i&&this.dom.contains(i));if(!(s||t||n))return;let a=this.forceSelection;this.forceSelection=!1;let o=this.view.state.selection.main,l=this.moveToLine(this.domAtPos(o.anchor)),u=o.empty?l:this.moveToLine(this.domAtPos(o.head));if(me.gecko&&o.empty&&!this.hasComposition&&u4(l)){let h=document.createTextNode("");this.view.observer.ignore(()=>l.node.insertBefore(h,l.node.childNodes[l.offset]||null)),l=u=new ri(h,0),a=!0}let c=this.view.observer.selectionRange;(a||!c.focusNode||(!rl(l.node,l.offset,c.anchorNode,c.anchorOffset)||!rl(u.node,u.offset,c.focusNode,c.focusOffset))&&!this.suppressWidgetCursorChange(c,o))&&(this.view.observer.ignore(()=>{me.android&&me.chrome&&this.dom.contains(c.focusNode)&&p4(c.focusNode,this.dom)&&(this.dom.blur(),this.dom.focus({preventScroll:!0}));let h=Sl(this.view.root);if(h)if(o.empty){if(me.gecko){let f=h4(l.node,l.offset);if(f&&f!=3){let m=(f==1?uw:cw)(l.node,l.offset);m&&(l=new ri(m.node,m.offset))}}h.collapse(l.node,l.offset),o.bidiLevel!=null&&h.caretBidiLevel!==void 0&&(h.caretBidiLevel=o.bidiLevel)}else if(h.extend){h.collapse(l.node,l.offset);try{h.extend(u.node,u.offset)}catch{}}else{let f=document.createRange();o.anchor>o.head&&([l,u]=[u,l]),f.setEnd(u.node,u.offset),f.setStart(l.node,l.offset),h.removeAllRanges(),h.addRange(f)}n&&this.view.root.activeElement==this.dom&&(this.dom.blur(),i&&i.focus())}),this.view.observer.setSelectionRange(l,u)),this.impreciseAnchor=l.precise?null:new ri(c.anchorNode,c.anchorOffset),this.impreciseHead=u.precise?null:new ri(c.focusNode,c.focusOffset)}suppressWidgetCursorChange(e,t){return this.hasComposition&&t.empty&&rl(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset)&&this.posFromDOM(e.focusNode,e.focusOffset)==t.head}enforceCursorAssoc(){if(this.hasComposition)return;let{view:e}=this,t=e.state.selection.main,i=Sl(e.root),{anchorNode:s,anchorOffset:n}=e.observer.selectionRange;if(!i||!t.empty||!t.assoc||!i.modify)return;let a=It.find(this,t.head);if(!a)return;let o=a.posAtStart;if(t.head==o||t.head==o+a.length)return;let l=this.coordsAt(t.head,-1),u=this.coordsAt(t.head,1);if(!l||!u||l.bottom>u.top)return;let c=this.domAtPos(t.head+t.assoc);i.collapse(c.node,c.offset),i.modify("move",t.assoc<0?"forward":"backward","lineboundary"),e.observer.readSelectionRange();let h=e.observer.selectionRange;e.docView.posFromDOM(h.anchorNode,h.anchorOffset)!=t.from&&i.collapse(s,n)}moveToLine(e){let t=this.dom,i;if(e.node!=t)return e;for(let s=e.offset;!i&&s<t.childNodes.length;s++){let n=et.get(t.childNodes[s]);n instanceof It&&(i=n.domAtPos(0))}for(let s=e.offset-1;!i&&s>=0;s--){let n=et.get(t.childNodes[s]);n instanceof It&&(i=n.domAtPos(n.length))}return i?new ri(i.node,i.offset,!0):e}nearest(e){for(let t=e;t;){let i=et.get(t);if(i&&i.rootView==this)return i;t=t.parentNode}return null}posFromDOM(e,t){let i=this.nearest(e);if(!i)throw new RangeError("Trying to find position for a DOM position outside of the document");return i.localPosFromDOM(e,t)+i.posAtStart}domAtPos(e){let{i:t,off:i}=this.childCursor().findPos(e,-1);for(;t<this.children.length-1;){let s=this.children[t];if(i<s.length||s instanceof It)break;t++,i=0}return this.children[t].domAtPos(i)}coordsAt(e,t){let i=null,s=0;for(let n=this.length,a=this.children.length-1;a>=0;a--){let o=this.children[a],l=n-o.breakAfter,u=l-o.length;if(l<e)break;if(u<=e&&(u<e||o.covers(-1))&&(l>e||o.covers(1))&&(!i||o instanceof It&&!(i instanceof It&&t>=0)))i=o,s=u;else if(i&&u==e&&l==e&&o instanceof ms&&Math.abs(t)<2){if(o.deco.startSide<0)break;a&&(i=null)}n=u}return i?i.coordsAt(e-s,t):null}coordsForChar(e){let{i:t,off:i}=this.childPos(e,1),s=this.children[t];if(!(s instanceof It))return null;for(;s.children.length;){let{i:o,off:l}=s.childPos(i,1);for(;;o++){if(o==s.children.length)return null;if((s=s.children[o]).length)break}i=l}if(!(s instanceof br))return null;let n=Kt(s.text,i);if(n==i)return null;let a=Qn(s.dom,i,n).getClientRects();for(let o=0;o<a.length;o++){let l=a[o];if(o==a.length-1||l.top<l.bottom&&l.left<l.right)return l}return null}measureVisibleLineHeights(e){let t=[],{from:i,to:s}=e,n=this.view.contentDOM.clientWidth,a=n>Math.max(this.view.scrollDOM.clientWidth,this.minWidth)+1,o=-1,l=this.view.textDirection==dt.LTR;for(let u=0,c=0;c<this.children.length;c++){let h=this.children[c],f=u+h.length;if(f>s)break;if(u>=i){let m=h.dom.getBoundingClientRect();if(t.push(m.height),a){let S=h.dom.lastChild,y=S?Tl(S):[];if(y.length){let E=y[y.length-1],C=l?E.right-m.left:m.right-E.left;C>o&&(o=C,this.minWidth=n,this.minWidthFrom=u,this.minWidthTo=f)}}}u=f+h.breakAfter}return t}textDirectionAt(e){let{i:t}=this.childPos(e,1);return getComputedStyle(this.children[t].dom).direction=="rtl"?dt.RTL:dt.LTR}measureTextSize(){for(let n of this.children)if(n instanceof It){let a=n.measureTextSize();if(a)return a}let e=document.createElement("div"),t,i,s;return e.className="cm-line",e.style.width="99999px",e.style.position="absolute",e.textContent="abc def ghi jkl mno pqr stu",this.view.observer.ignore(()=>{this.dom.appendChild(e);let n=Tl(e.firstChild)[0];t=e.getBoundingClientRect().height,i=n?n.width/27:7,s=n?n.height:t,e.remove()}),{lineHeight:t,charWidth:i,textHeight:s}}childCursor(e=this.length){let t=this.children.length;return t&&(e-=this.children[--t].length),new hw(this.children,e,t)}computeBlockGapDeco(){let e=[],t=this.view.viewState;for(let i=0,s=0;;s++){let n=s==t.viewports.length?null:t.viewports[s],a=n?n.from-1:this.length;if(a>i){let o=(t.lineBlockAt(a).bottom-t.lineBlockAt(i).top)/this.view.scaleY;e.push(Ee.replace({widget:new um(o),block:!0,inclusive:!0,isBlockGap:!0}).range(i,a))}if(!n)break;i=n.to+1}return Ee.set(e)}updateDeco(){let e=1,t=this.view.state.facet(_l).map(n=>(this.dynamicDecorationMap[e++]=typeof n=="function")?n(this.view):n),i=!1,s=this.view.state.facet(Rw).map((n,a)=>{let o=typeof n=="function";return o&&(i=!0),o?n(this.view):n});for(s.length&&(this.dynamicDecorationMap[e++]=i,t.push(je.join(s))),this.decorations=[this.editContextFormatting,...t,this.computeBlockGapDeco(),this.view.viewState.lineGapDeco];e<this.decorations.length;)this.dynamicDecorationMap[e++]=!1;return this.decorations}scrollIntoView(e){if(e.isSnapshot){let u=this.view.viewState.lineBlockAt(e.range.head);this.view.scrollDOM.scrollTop=u.top-e.yMargin,this.view.scrollDOM.scrollLeft=e.xMargin;return}for(let u of this.view.state.facet(Dw))try{if(u(this.view,e.range,e))return!0}catch(c){ki(this.view.state,c,"scroll handler")}let{range:t}=e,i=this.coordsAt(t.head,t.empty?t.assoc:t.head>t.anchor?-1:1),s;if(!i)return;!t.empty&&(s=this.coordsAt(t.anchor,t.anchor>t.head?-1:1))&&(i={left:Math.min(i.left,s.left),top:Math.min(i.top,s.top),right:Math.max(i.right,s.right),bottom:Math.max(i.bottom,s.bottom)});let n=i0(this.view),a={left:i.left-n.left,top:i.top-n.top,right:i.right+n.right,bottom:i.bottom+n.bottom},{offsetWidth:o,offsetHeight:l}=this.view.scrollDOM;q3(this.view.scrollDOM,a,t.head<t.anchor?-1:1,e.x,e.y,Math.max(Math.min(e.xMargin,o),-o),Math.max(Math.min(e.yMargin,l),-l),this.view.textDirection==dt.LTR)}}function u4(r){return r.node.nodeType==1&&r.node.firstChild&&(r.offset==0||r.node.childNodes[r.offset-1].contentEditable=="false")&&(r.offset==r.node.childNodes.length||r.node.childNodes[r.offset].contentEditable=="false")}function $w(r,e){let t=r.observer.selectionRange;if(!t.focusNode)return null;let i=uw(t.focusNode,t.focusOffset),s=cw(t.focusNode,t.focusOffset),n=i||s;if(s&&i&&s.node!=i.node){let o=et.get(s.node);if(!o||o instanceof br&&o.text!=s.node.nodeValue)n=s;else if(r.docView.lastCompositionAfterCursor){let l=et.get(i.node);!l||l instanceof br&&l.text!=i.node.nodeValue||(n=s)}}if(r.docView.lastCompositionAfterCursor=n!=i,!n)return null;let a=e-n.offset;return{from:a,to:a+n.node.nodeValue.length,node:n.node}}function c4(r,e,t){let i=$w(r,t);if(!i)return null;let{node:s,from:n,to:a}=i,o=s.nodeValue;if(/[\n\r]/.test(o)||r.state.doc.sliceString(i.from,i.to)!=o)return null;let l=e.invertedDesc,u=new ir(l.mapPos(n),l.mapPos(a),n,a),c=[];for(let h=s.parentNode;;h=h.parentNode){let f=et.get(h);if(f instanceof bs)c.push({node:h,deco:f.mark});else{if(f instanceof It||h.nodeName=="DIV"&&h.parentNode==r.contentDOM)return{range:u,text:s,marks:c,line:h};if(h!=r.contentDOM)c.push({node:h,deco:new Kl({inclusive:!0,attributes:G3(h),tagName:h.tagName.toLowerCase()})});else return null}}}function h4(r,e){return r.nodeType!=1?0:(e&&r.childNodes[e-1].contentEditable=="false"?1:0)|(e<r.childNodes.length&&r.childNodes[e].contentEditable=="false"?2:0)}let d4=class{constructor(){this.changes=[]}compareRange(e,t){Sc(e,t,this.changes)}comparePoint(e,t){Sc(e,t,this.changes)}boundChange(e){Sc(e,e,this.changes)}};function f4(r,e,t){let i=new d4;return je.compare(r,e,t,i),i.changes}function p4(r,e){for(let t=r;t&&t!=e;t=t.assignedSlot||t.parentNode)if(t.nodeType==1&&t.contentEditable=="false")return!0;return!1}function m4(r,e){let t=!1;return e&&r.iterChangedRanges((i,s)=>{i<e.to&&s>e.from&&(t=!0)}),t}function g4(r,e,t=1){let i=r.charCategorizer(e),s=r.doc.lineAt(e),n=e-s.from;if(s.length==0)return ie.cursor(e);n==0?t=1:n==s.length&&(t=-1);let a=n,o=n;t<0?a=Kt(s.text,n,!1):o=Kt(s.text,n);let l=i(s.text.slice(a,o));for(;a>0;){let u=Kt(s.text,a,!1);if(i(s.text.slice(u,a))!=l)break;a=u}for(;o<s.length;){let u=Kt(s.text,o);if(i(s.text.slice(o,u))!=l)break;o=u}return ie.range(a+s.from,o+s.from)}function O4(r,e){return e.left>r?e.left-r:Math.max(0,r-e.right)}function y4(r,e){return e.top>r?e.top-r:Math.max(0,r-e.bottom)}function kf(r,e){return r.top<e.bottom-1&&r.bottom>e.top+1}function jb(r,e){return e<r.top?{top:e,left:r.left,right:r.right,bottom:r.bottom}:r}function zb(r,e){return e>r.bottom?{top:r.top,left:r.left,right:r.right,bottom:e}:r}function pm(r,e,t){let i,s,n,a,o=!1,l,u,c,h;for(let S=r.firstChild;S;S=S.nextSibling){let y=Tl(S);for(let E=0;E<y.length;E++){let C=y[E];s&&kf(s,C)&&(C=jb(zb(C,s.bottom),s.top));let _=O4(e,C),v=y4(t,C);if(_==0&&v==0)return S.nodeType==3?Zb(S,e,t):pm(S,e,t);(!i||a>v||a==v&&n>_)&&(i=S,s=C,n=_,a=v,o=_?e<C.left?E>0:E<y.length-1:!0),_==0?t>C.bottom&&(!c||c.bottom<C.bottom)?(l=S,c=C):t<C.top&&(!h||h.top>C.top)&&(u=S,h=C):c&&kf(c,C)?c=zb(c,C.bottom):h&&kf(h,C)&&(h=jb(h,C.top))}}if(c&&c.bottom>=t?(i=l,s=c):h&&h.top<=t&&(i=u,s=h),!i)return{node:r,offset:0};let f=Math.max(s.left,Math.min(s.right,e));if(i.nodeType==3)return Zb(i,f,t);if(o&&i.contentEditable!="false")return pm(i,f,t);let m=Array.prototype.indexOf.call(r.childNodes,i)+(e>=(s.left+s.right)/2?1:0);return{node:r,offset:m}}function Zb(r,e,t){let i=r.nodeValue.length,s=-1,n=1e9,a=0;for(let o=0;o<i;o++){let l=Qn(r,o,o+1).getClientRects();for(let u=0;u<l.length;u++){let c=l[u];if(c.top==c.bottom)continue;a||(a=e-c.left);let h=(c.top>t?c.top-t:t-c.bottom)-1;if(c.left-1<=e&&c.right+1>=e&&h<n){let f=e>=(c.left+c.right)/2,m=f;if((me.chrome||me.gecko)&&Qn(r,o).getBoundingClientRect().left==c.right&&(m=!f),h<=0)return{node:r,offset:o+(m?1:0)};s=o+(m?1:0),n=h}}}return{node:r,offset:s>-1?s:a>0?r.nodeValue.length:0}}function Bw(r,e,t,i=-1){var s,n;let a=r.contentDOM.getBoundingClientRect(),o=a.top+r.viewState.paddingTop,l,{docHeight:u}=r.viewState,{x:c,y:h}=e,f=h-o;if(f<0)return 0;if(f>u)return r.state.doc.length;for(let T=r.viewState.heightOracle.textHeight/2,w=!1;l=r.elementAtHeight(f),l.type!=gi.Text;)for(;f=i>0?l.bottom+T:l.top-T,!(f>=0&&f<=u);){if(w)return t?null:0;w=!0,i=-i}h=o+f;let m=l.from;if(m<r.viewport.from)return r.viewport.from==0?0:t?null:Wb(r,a,l,c,h);if(m>r.viewport.to)return r.viewport.to==r.state.doc.length?r.state.doc.length:t?null:Wb(r,a,l,c,h);let S=r.dom.ownerDocument,y=r.root.elementFromPoint?r.root:S,E=y.elementFromPoint(c,h);E&&!r.contentDOM.contains(E)&&(E=null),E||(c=Math.max(a.left+1,Math.min(a.right-1,c)),E=y.elementFromPoint(c,h),E&&!r.contentDOM.contains(E)&&(E=null));let C,_=-1;if(E&&((s=r.docView.nearest(E))===null||s===void 0?void 0:s.isEditable)!=!1){if(S.caretPositionFromPoint){let T=S.caretPositionFromPoint(c,h);T&&({offsetNode:C,offset:_}=T)}else if(S.caretRangeFromPoint){let T=S.caretRangeFromPoint(c,h);T&&({startContainer:C,startOffset:_}=T)}C&&(!r.contentDOM.contains(C)||me.safari&&b4(C,_,c)||me.chrome&&v4(C,_,c))&&(C=void 0),C&&(_=Math.min(Yr(C),_))}if(!C||!r.docView.dom.contains(C)){let T=It.find(r.docView,m);if(!T)return f>l.top+l.height/2?l.to:l.from;({node:C,offset:_}=pm(T.dom,c,h))}let v=r.docView.nearest(C);if(!v)return null;if(v.isWidget&&((n=v.dom)===null||n===void 0?void 0:n.nodeType)==1){let T=v.dom.getBoundingClientRect();return e.y<T.top||e.y<=T.bottom&&e.x<=(T.left+T.right)/2?v.posAtStart:v.posAtEnd}else return v.localPosFromDOM(C,_)+v.posAtStart}function Wb(r,e,t,i,s){let n=Math.round((i-e.left)*r.defaultCharacterWidth);if(r.lineWrapping&&t.height>r.defaultLineHeight*1.5){let o=r.viewState.heightOracle.textHeight,l=Math.floor((s-t.top-(r.defaultLineHeight-o)*.5)/o);n+=l*r.viewState.heightOracle.lineLength}let a=r.state.sliceDoc(t.from,t.to);return t.from+Jp(a,n,r.state.tabSize)}function Nw(r,e,t){let i,s=r;if(r.nodeType!=3||e!=(i=r.nodeValue.length))return!1;for(;;){let n=s.nextSibling;if(n){if(n.nodeName=="BR")break;return!1}else{let a=s.parentNode;if(!a||a.nodeName=="DIV")break;s=a}}return Qn(r,i-1,i).getBoundingClientRect().right>t}function b4(r,e,t){return Nw(r,e,t)}function v4(r,e,t){if(e!=0)return Nw(r,e,t);for(let s=r;;){let n=s.parentNode;if(!n||n.nodeType!=1||n.firstChild!=s)return!1;if(n.classList.contains("cm-line"))break;s=n}let i=r.nodeType==1?r.getBoundingClientRect():Qn(r,0,Math.max(r.nodeValue.length,1)).getBoundingClientRect();return t-i.left>5}function mm(r,e,t){let i=r.lineBlockAt(e);if(Array.isArray(i.type)){let s;for(let n of i.type){if(n.from>e)break;if(!(n.to<e)){if(n.from<e&&n.to>e)return n;(!s||n.type==gi.Text&&(s.type!=n.type||(t<0?n.from<e:n.to>e)))&&(s=n)}}return s||i}return i}function S4(r,e,t,i){let s=mm(r,e.head,e.assoc||-1),n=!i||s.type!=gi.Text||!(r.lineWrapping||s.widgetLineBreaks)?null:r.coordsAtPos(e.assoc<0&&e.head>s.from?e.head-1:e.head);if(n){let a=r.dom.getBoundingClientRect(),o=r.textDirectionAt(s.from),l=r.posAtCoords({x:t==(o==dt.LTR)?a.right-1:a.left+1,y:(n.top+n.bottom)/2});if(l!=null)return ie.cursor(l,t?-1:1)}return ie.cursor(t?s.to:s.from,t?-1:1)}function Hb(r,e,t,i){let s=r.state.doc.lineAt(e.head),n=r.bidiSpans(s),a=r.textDirectionAt(s.from);for(let o=e,l=null;;){let u=a4(s,n,a,o,t),c=Tw;if(!u){if(s.number==(t?r.state.doc.lines:1))return o;c=`
`,s=r.state.doc.line(s.number+(t?1:-1)),n=r.bidiSpans(s),u=r.visualLineSide(s,!t)}if(l){if(!l(c))return o}else{if(!i)return u;l=i(c)}o=u}}function T4(r,e,t){let i=r.state.charCategorizer(e),s=i(t);return n=>{let a=i(n);return s==gt.Space&&(s=a),s==a}}function _4(r,e,t,i){let s=e.head,n=t?1:-1;if(s==(t?r.state.doc.length:0))return ie.cursor(s,e.assoc);let a=e.goalColumn,o,l=r.contentDOM.getBoundingClientRect(),u=r.coordsAtPos(s,e.assoc||-1),c=r.documentTop;if(u)a==null&&(a=u.left-l.left),o=n<0?u.top:u.bottom;else{let m=r.viewState.lineBlockAt(s);a==null&&(a=Math.min(l.right-l.left,r.defaultCharacterWidth*(s-m.from))),o=(n<0?m.top:m.bottom)+c}let h=l.left+a,f=i??r.viewState.heightOracle.textHeight>>1;for(let m=0;;m+=10){let S=o+(f+m)*n,y=Bw(r,{x:h,y:S},!1,n);if(S<l.top||S>l.bottom||(n<0?y<s:y>s)){let E=r.docView.coordsForChar(y),C=!E||S<E.top?-1:1;return ie.cursor(y,C,void 0,a)}}}function nl(r,e,t){for(;;){let i=0;for(let s of r)s.between(e-1,e+1,(n,a,o)=>{if(e>n&&e<a){let l=i||t||(e-n<a-e?-1:1);e=l<0?n:a,i=l}});if(!i)return e}}function Fw(r,e){let t=null;for(let i=0;i<e.ranges.length;i++){let s=e.ranges[i],n=null;if(s.empty){let a=nl(r,s.from,0);a!=s.from&&(n=ie.cursor(a,-1))}else{let a=nl(r,s.from,-1),o=nl(r,s.to,1);(a!=s.from||o!=s.to)&&(n=ie.range(s.from==s.anchor?a:o,s.from==s.head?a:o))}n&&(t||(t=e.ranges.slice()),t[i]=n)}return t?ie.create(t,e.mainIndex):e}function Ef(r,e,t){let i=nl(r.state.facet(eu).map(s=>s(r)),t.from,e.head>t.from?-1:1);return i==t.from?t:ie.cursor(i,i<t.from?1:-1)}const qo="￿";class x4{constructor(e,t){this.points=e,this.text="",this.lineSeparator=t.facet(Xe.lineSeparator)}append(e){this.text+=e}lineBreak(){this.text+=qo}readRange(e,t){if(!e)return this;let i=e.parentNode;for(let s=e;;){this.findPointBefore(i,s);let n=this.text.length;this.readNode(s);let a=s.nextSibling;if(a==t)break;let o=et.get(s),l=et.get(a);(o&&l?o.breakAfter:(o?o.breakAfter:ah(s))||ah(a)&&(s.nodeName!="BR"||s.cmIgnore)&&this.text.length>n)&&!C4(a,t)&&this.lineBreak(),s=a}return this.findPointBefore(i,t),this}readTextNode(e){let t=e.nodeValue;for(let i of this.points)i.node==e&&(i.pos=this.text.length+Math.min(i.offset,t.length));for(let i=0,s=this.lineSeparator?null:/\r\n?|\n/g;;){let n=-1,a=1,o;if(this.lineSeparator?(n=t.indexOf(this.lineSeparator,i),a=this.lineSeparator.length):(o=s.exec(t))&&(n=o.index,a=o[0].length),this.append(t.slice(i,n<0?t.length:n)),n<0)break;if(this.lineBreak(),a>1)for(let l of this.points)l.node==e&&l.pos>this.text.length&&(l.pos-=a-1);i=n+a}}readNode(e){if(e.cmIgnore)return;let t=et.get(e),i=t&&t.overrideDOMText;if(i!=null){this.findPointInside(e,i.length);for(let s=i.iter();!s.next().done;)s.lineBreak?this.lineBreak():this.append(s.value)}else e.nodeType==3?this.readTextNode(e):e.nodeName=="BR"?e.nextSibling&&this.lineBreak():e.nodeType==1&&this.readRange(e.firstChild,null)}findPointBefore(e,t){for(let i of this.points)i.node==e&&e.childNodes[i.offset]==t&&(i.pos=this.text.length)}findPointInside(e,t){for(let i of this.points)(e.nodeType==3?i.node==e:e.contains(i.node))&&(i.pos=this.text.length+(w4(e,i.node,i.offset)?t:0))}}function w4(r,e,t){for(;;){if(!e||t<Yr(e))return!1;if(e==r)return!0;t=Ln(e)+1,e=e.parentNode}}function C4(r,e){let t;for(;!(r==e||!r);r=r.nextSibling){let i=et.get(r);if(!(i?.isWidget||r.cmIgnore))return!1;i&&(t||(t=[])).push(i)}if(t)for(let i of t){let s=i.overrideDOMText;if(s?.length)return!1}return!0}class Yb{constructor(e,t){this.node=e,this.offset=t,this.pos=-1}}class k4{constructor(e,t,i,s){this.typeOver=s,this.bounds=null,this.text="",this.domChanged=t>-1;let{impreciseHead:n,impreciseAnchor:a}=e.docView;if(e.state.readOnly&&t>-1)this.newSel=null;else if(t>-1&&(this.bounds=e.docView.domBoundsAround(t,i,0))){let o=n||a?[]:A4(e),l=new x4(o,e.state);l.readRange(this.bounds.startDOM,this.bounds.endDOM),this.text=l.text,this.newSel=P4(o,this.bounds.from)}else{let o=e.observer.selectionRange,l=n&&n.node==o.focusNode&&n.offset==o.focusOffset||!am(e.contentDOM,o.focusNode)?e.state.selection.main.head:e.docView.posFromDOM(o.focusNode,o.focusOffset),u=a&&a.node==o.anchorNode&&a.offset==o.anchorOffset||!am(e.contentDOM,o.anchorNode)?e.state.selection.main.anchor:e.docView.posFromDOM(o.anchorNode,o.anchorOffset),c=e.viewport;if((me.ios||me.chrome)&&e.state.selection.main.empty&&l!=u&&(c.from>0||c.to<e.state.doc.length)){let h=Math.min(l,u),f=Math.max(l,u),m=c.from-h,S=c.to-f;(m==0||m==1||h==0)&&(S==0||S==-1||f==e.state.doc.length)&&(l=0,u=e.state.doc.length)}this.newSel=ie.single(u,l)}}}function Uw(r,e){let t,{newSel:i}=e,s=r.state.selection.main,n=r.inputState.lastKeyTime>Date.now()-100?r.inputState.lastKeyCode:-1;if(e.bounds){let{from:a,to:o}=e.bounds,l=s.from,u=null;(n===8||me.android&&e.text.length<o-a)&&(l=s.to,u="end");let c=qw(r.state.doc.sliceString(a,o,qo),e.text,l-a,u);c&&(me.chrome&&n==13&&c.toB==c.from+2&&e.text.slice(c.from,c.toB)==qo+qo&&c.toB--,t={from:a+c.from,to:a+c.toA,insert:Ue.of(e.text.slice(c.from,c.toB).split(qo))})}else i&&(!r.hasFocus&&r.state.facet(fs)||i.main.eq(s))&&(i=null);if(!t&&!i)return!1;if(!t&&e.typeOver&&!s.empty&&i&&i.main.empty?t={from:s.from,to:s.to,insert:r.state.doc.slice(s.from,s.to)}:(me.mac||me.android)&&t&&t.from==t.to&&t.from==s.head-1&&/^\. ?$/.test(t.insert.toString())&&r.contentDOM.getAttribute("autocorrect")=="off"?(i&&t.insert.length==2&&(i=ie.single(i.main.anchor-1,i.main.head-1)),t={from:t.from,to:t.to,insert:Ue.of([t.insert.toString().replace("."," ")])}):t&&t.from>=s.from&&t.to<=s.to&&(t.from!=s.from||t.to!=s.to)&&s.to-s.from-(t.to-t.from)<=4?t={from:s.from,to:s.to,insert:r.state.doc.slice(s.from,t.from).append(t.insert).append(r.state.doc.slice(t.to,s.to))}:me.chrome&&t&&t.from==t.to&&t.from==s.head&&t.insert.toString()==`
 `&&r.lineWrapping&&(i&&(i=ie.single(i.main.anchor-1,i.main.head-1)),t={from:s.from,to:s.to,insert:Ue.of([" "])}),t)return r0(r,t,i,n);if(i&&!i.main.eq(s)){let a=!1,o="select";return r.inputState.lastSelectionTime>Date.now()-50&&(r.inputState.lastSelectionOrigin=="select"&&(a=!0),o=r.inputState.lastSelectionOrigin,o=="select.pointer"&&(i=Fw(r.state.facet(eu).map(l=>l(r)),i))),r.dispatch({selection:i,scrollIntoView:a,userEvent:o}),!0}else return!1}function r0(r,e,t,i=-1){if(me.ios&&r.inputState.flushIOSKey(e))return!0;let s=r.state.selection.main;if(me.android&&(e.to==s.to&&(e.from==s.from||e.from==s.from-1&&r.state.sliceDoc(e.from,s.from)==" ")&&e.insert.length==1&&e.insert.lines==2&&Ta(r.contentDOM,"Enter",13)||(e.from==s.from-1&&e.to==s.to&&e.insert.length==0||i==8&&e.insert.length<e.to-e.from&&e.to>s.head)&&Ta(r.contentDOM,"Backspace",8)||e.from==s.from&&e.to==s.to+1&&e.insert.length==0&&Ta(r.contentDOM,"Delete",46)))return!0;let n=e.insert.toString();r.inputState.composing>=0&&r.inputState.composing++;let a,o=()=>a||(a=E4(r,e,t));return r.state.facet(kw).some(l=>l(r,e.from,e.to,n,o))||r.dispatch(o()),!0}function E4(r,e,t){let i,s=r.state,n=s.selection.main,a=-1;if(e.from==e.to&&e.from<n.from||e.from>n.to){let l=e.from<n.from?-1:1,u=l<0?n.from:n.to,c=nl(s.facet(eu).map(h=>h(r)),u,l);e.from==c&&(a=c)}if(a>-1)i={changes:e,selection:ie.cursor(e.from+e.insert.length,-1)};else if(e.from>=n.from&&e.to<=n.to&&e.to-e.from>=(n.to-n.from)/3&&(!t||t.main.empty&&t.main.from==e.from+e.insert.length)&&r.inputState.composing<0){let l=n.from<e.from?s.sliceDoc(n.from,e.from):"",u=n.to>e.to?s.sliceDoc(e.to,n.to):"";i=s.replaceSelection(r.state.toText(l+e.insert.sliceString(0,void 0,r.state.lineBreak)+u))}else{let l=s.changes(e),u=t&&t.main.to<=l.newLength?t.main:void 0;if(s.selection.ranges.length>1&&r.inputState.composing>=0&&e.to<=n.to&&e.to>=n.to-10){let c=r.state.sliceDoc(e.from,e.to),h,f=t&&$w(r,t.main.head);if(f){let y=e.insert.length-(e.to-e.from);h={from:f.from,to:f.to-y}}else h=r.state.doc.lineAt(n.head);let m=n.to-e.to,S=n.to-n.from;i=s.changeByRange(y=>{if(y.from==n.from&&y.to==n.to)return{changes:l,range:u||y.map(l)};let E=y.to-m,C=E-c.length;if(y.to-y.from!=S||r.state.sliceDoc(C,E)!=c||y.to>=h.from&&y.from<=h.to)return{range:y};let _=s.changes({from:C,to:E,insert:e.insert}),v=y.to-n.to;return{changes:_,range:u?ie.range(Math.max(0,u.anchor+v),Math.max(0,u.head+v)):y.map(_)}})}else i={changes:l,selection:u&&s.selection.replaceRange(u)}}let o="input.type";return(r.composing||r.inputState.compositionPendingChange&&r.inputState.compositionEndedAt>Date.now()-50)&&(r.inputState.compositionPendingChange=!1,o+=".compose",r.inputState.compositionFirstChange&&(o+=".start",r.inputState.compositionFirstChange=!1)),s.update(i,{userEvent:o,scrollIntoView:!0})}function qw(r,e,t,i){let s=Math.min(r.length,e.length),n=0;for(;n<s&&r.charCodeAt(n)==e.charCodeAt(n);)n++;if(n==s&&r.length==e.length)return null;let a=r.length,o=e.length;for(;a>0&&o>0&&r.charCodeAt(a-1)==e.charCodeAt(o-1);)a--,o--;if(i=="end"){let l=Math.max(0,n-Math.min(a,o));t-=a+l-n}if(a<n&&r.length<e.length){let l=t<=n&&t>=a?n-t:0;n-=l,o=n+(o-a),a=n}else if(o<n){let l=t<=n&&t>=o?n-t:0;n-=l,a=n+(a-o),o=n}return{from:n,toA:a,toB:o}}function A4(r){let e=[];if(r.root.activeElement!=r.contentDOM)return e;let{anchorNode:t,anchorOffset:i,focusNode:s,focusOffset:n}=r.observer.selectionRange;return t&&(e.push(new Yb(t,i)),(s!=t||n!=i)&&e.push(new Yb(s,n))),e}function P4(r,e){if(r.length==0)return null;let t=r[0].pos,i=r.length==2?r[1].pos:t;return t>-1&&i>-1?ie.single(t+e,i+e):null}class D4{setSelectionOrigin(e){this.lastSelectionOrigin=e,this.lastSelectionTime=Date.now()}constructor(e){this.view=e,this.lastKeyCode=0,this.lastKeyTime=0,this.lastTouchTime=0,this.lastFocusTime=0,this.lastScrollTop=0,this.lastScrollLeft=0,this.pendingIOSKey=void 0,this.tabFocusMode=-1,this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastContextMenu=0,this.scrollHandlers=[],this.handlers=Object.create(null),this.composing=-1,this.compositionFirstChange=null,this.compositionEndedAt=0,this.compositionPendingKey=!1,this.compositionPendingChange=!1,this.mouseSelection=null,this.draggedContent=null,this.handleEvent=this.handleEvent.bind(this),this.notifiedFocused=e.hasFocus,me.safari&&e.contentDOM.addEventListener("input",()=>null),me.gecko&&Z4(e.contentDOM.ownerDocument)}handleEvent(e){!N4(this.view,e)||this.ignoreDuringComposition(e)||e.type=="keydown"&&this.keydown(e)||(this.view.updateState!=0?Promise.resolve().then(()=>this.runHandlers(e.type,e)):this.runHandlers(e.type,e))}runHandlers(e,t){let i=this.handlers[e];if(i){for(let s of i.observers)s(this.view,t);for(let s of i.handlers){if(t.defaultPrevented)break;if(s(this.view,t)){t.preventDefault();break}}}}ensureHandlers(e){let t=M4(e),i=this.handlers,s=this.view.contentDOM;for(let n in t)if(n!="scroll"){let a=!t[n].handlers.length,o=i[n];o&&a!=!o.handlers.length&&(s.removeEventListener(n,this.handleEvent),o=null),o||s.addEventListener(n,this.handleEvent,{passive:a})}for(let n in i)n!="scroll"&&!t[n]&&s.removeEventListener(n,this.handleEvent);this.handlers=t}keydown(e){if(this.lastKeyCode=e.keyCode,this.lastKeyTime=Date.now(),e.keyCode==9&&this.tabFocusMode>-1&&(!this.tabFocusMode||Date.now()<=this.tabFocusMode))return!0;if(this.tabFocusMode>0&&e.keyCode!=27&&Xw.indexOf(e.keyCode)<0&&(this.tabFocusMode=-1),me.android&&me.chrome&&!e.synthetic&&(e.keyCode==13||e.keyCode==8))return this.view.observer.delayAndroidKey(e.key,e.keyCode),!0;let t;return me.ios&&!e.synthetic&&!e.altKey&&!e.metaKey&&((t=Vw.find(i=>i.keyCode==e.keyCode))&&!e.ctrlKey||I4.indexOf(e.key)>-1&&e.ctrlKey&&!e.shiftKey)?(this.pendingIOSKey=t||e,setTimeout(()=>this.flushIOSKey(),250),!0):(e.keyCode!=229&&this.view.observer.forceFlush(),!1)}flushIOSKey(e){let t=this.pendingIOSKey;return!t||t.key=="Enter"&&e&&e.from<e.to&&/^\S+$/.test(e.insert.toString())?!1:(this.pendingIOSKey=void 0,Ta(this.view.contentDOM,t.key,t.keyCode,t instanceof KeyboardEvent?t:void 0))}ignoreDuringComposition(e){return!/^key/.test(e.type)||e.synthetic?!1:this.composing>0?!0:me.safari&&!me.ios&&this.compositionPendingKey&&Date.now()-this.compositionEndedAt<100?(this.compositionPendingKey=!1,!0):!1}startMouseSelection(e){this.mouseSelection&&this.mouseSelection.destroy(),this.mouseSelection=e}update(e){this.view.observer.update(e),this.mouseSelection&&this.mouseSelection.update(e),this.draggedContent&&e.docChanged&&(this.draggedContent=this.draggedContent.map(e.changes)),e.transactions.length&&(this.lastKeyCode=this.lastSelectionTime=0)}destroy(){this.mouseSelection&&this.mouseSelection.destroy()}}function Gb(r,e){return(t,i)=>{try{return e.call(r,i,t)}catch(s){ki(t.state,s)}}}function M4(r){let e=Object.create(null);function t(i){return e[i]||(e[i]={observers:[],handlers:[]})}for(let i of r){let s=i.spec,n=s&&s.plugin.domEventHandlers,a=s&&s.plugin.domEventObservers;if(n)for(let o in n){let l=n[o];l&&t(o).handlers.push(Gb(i.value,l))}if(a)for(let o in a){let l=a[o];l&&t(o).observers.push(Gb(i.value,l))}}for(let i in vr)t(i).handlers.push(vr[i]);for(let i in nr)t(i).observers.push(nr[i]);return e}const Vw=[{key:"Backspace",keyCode:8,inputType:"deleteContentBackward"},{key:"Enter",keyCode:13,inputType:"insertParagraph"},{key:"Enter",keyCode:13,inputType:"insertLineBreak"},{key:"Delete",keyCode:46,inputType:"deleteContentForward"}],I4="dthko",Xw=[16,17,18,20,91,92,224,225],Hu=6;function Yu(r){return Math.max(0,r)*.7+8}function R4(r,e){return Math.max(Math.abs(r.clientX-e.clientX),Math.abs(r.clientY-e.clientY))}class L4{constructor(e,t,i,s){this.view=e,this.startEvent=t,this.style=i,this.mustSelect=s,this.scrollSpeed={x:0,y:0},this.scrolling=-1,this.lastEvent=t,this.scrollParents=V3(e.contentDOM),this.atoms=e.state.facet(eu).map(a=>a(e));let n=e.contentDOM.ownerDocument;n.addEventListener("mousemove",this.move=this.move.bind(this)),n.addEventListener("mouseup",this.up=this.up.bind(this)),this.extend=t.shiftKey,this.multiple=e.state.facet(Xe.allowMultipleSelections)&&Q4(e,t),this.dragging=B4(e,t)&&Zw(t)==1?null:!1}start(e){this.dragging===!1&&this.select(e)}move(e){if(e.buttons==0)return this.destroy();if(this.dragging||this.dragging==null&&R4(this.startEvent,e)<10)return;this.select(this.lastEvent=e);let t=0,i=0,s=0,n=0,a=this.view.win.innerWidth,o=this.view.win.innerHeight;this.scrollParents.x&&({left:s,right:a}=this.scrollParents.x.getBoundingClientRect()),this.scrollParents.y&&({top:n,bottom:o}=this.scrollParents.y.getBoundingClientRect());let l=i0(this.view);e.clientX-l.left<=s+Hu?t=-Yu(s-e.clientX):e.clientX+l.right>=a-Hu&&(t=Yu(e.clientX-a)),e.clientY-l.top<=n+Hu?i=-Yu(n-e.clientY):e.clientY+l.bottom>=o-Hu&&(i=Yu(e.clientY-o)),this.setScrollSpeed(t,i)}up(e){this.dragging==null&&this.select(this.lastEvent),this.dragging||e.preventDefault(),this.destroy()}destroy(){this.setScrollSpeed(0,0);let e=this.view.contentDOM.ownerDocument;e.removeEventListener("mousemove",this.move),e.removeEventListener("mouseup",this.up),this.view.inputState.mouseSelection=this.view.inputState.draggedContent=null}setScrollSpeed(e,t){this.scrollSpeed={x:e,y:t},e||t?this.scrolling<0&&(this.scrolling=setInterval(()=>this.scroll(),50)):this.scrolling>-1&&(clearInterval(this.scrolling),this.scrolling=-1)}scroll(){let{x:e,y:t}=this.scrollSpeed;e&&this.scrollParents.x&&(this.scrollParents.x.scrollLeft+=e,e=0),t&&this.scrollParents.y&&(this.scrollParents.y.scrollTop+=t,t=0),(e||t)&&this.view.win.scrollBy(e,t),this.dragging===!1&&this.select(this.lastEvent)}select(e){let{view:t}=this,i=Fw(this.atoms,this.style.get(e,this.extend,this.multiple));(this.mustSelect||!i.eq(t.state.selection,this.dragging===!1))&&this.view.dispatch({selection:i,userEvent:"select.pointer"}),this.mustSelect=!1}update(e){e.transactions.some(t=>t.isUserEvent("input.type"))?this.destroy():this.style.update(e)&&setTimeout(()=>this.select(this.lastEvent),20)}}function Q4(r,e){let t=r.state.facet(_w);return t.length?t[0](e):me.mac?e.metaKey:e.ctrlKey}function $4(r,e){let t=r.state.facet(xw);return t.length?t[0](e):me.mac?!e.altKey:!e.ctrlKey}function B4(r,e){let{main:t}=r.state.selection;if(t.empty)return!1;let i=Sl(r.root);if(!i||i.rangeCount==0)return!0;let s=i.getRangeAt(0).getClientRects();for(let n=0;n<s.length;n++){let a=s[n];if(a.left<=e.clientX&&a.right>=e.clientX&&a.top<=e.clientY&&a.bottom>=e.clientY)return!0}return!1}function N4(r,e){if(!e.bubbles)return!0;if(e.defaultPrevented)return!1;for(let t=e.target,i;t!=r.contentDOM;t=t.parentNode)if(!t||t.nodeType==11||(i=et.get(t))&&i.ignoreEvent(e))return!1;return!0}const vr=Object.create(null),nr=Object.create(null),jw=me.ie&&me.ie_version<15||me.ios&&me.webkit_version<604;function F4(r){let e=r.dom.parentNode;if(!e)return;let t=e.appendChild(document.createElement("textarea"));t.style.cssText="position: fixed; left: -10000px; top: 10px",t.focus(),setTimeout(()=>{r.focus(),t.remove(),zw(r,t.value)},50)}function ld(r,e,t){for(let i of r.facet(e))t=i(t,r);return t}function zw(r,e){e=ld(r.state,Jg,e);let{state:t}=r,i,s=1,n=t.toText(e),a=n.lines==t.selection.ranges.length;if(gm!=null&&t.selection.ranges.every(l=>l.empty)&&gm==n.toString()){let l=-1;i=t.changeByRange(u=>{let c=t.doc.lineAt(u.from);if(c.from==l)return{range:u};l=c.from;let h=t.toText((a?n.line(s++).text:e)+t.lineBreak);return{changes:{from:c.from,insert:h},range:ie.cursor(u.from+h.length)}})}else a?i=t.changeByRange(l=>{let u=n.line(s++);return{changes:{from:l.from,to:l.to,insert:u.text},range:ie.cursor(l.from+u.length)}}):i=t.replaceSelection(n);r.dispatch(i,{userEvent:"input.paste",scrollIntoView:!0})}nr.scroll=r=>{r.inputState.lastScrollTop=r.scrollDOM.scrollTop,r.inputState.lastScrollLeft=r.scrollDOM.scrollLeft};vr.keydown=(r,e)=>(r.inputState.setSelectionOrigin("select"),e.keyCode==27&&r.inputState.tabFocusMode!=0&&(r.inputState.tabFocusMode=Date.now()+2e3),!1);nr.touchstart=(r,e)=>{r.inputState.lastTouchTime=Date.now(),r.inputState.setSelectionOrigin("select.pointer")};nr.touchmove=r=>{r.inputState.setSelectionOrigin("select.pointer")};vr.mousedown=(r,e)=>{if(r.observer.flush(),r.inputState.lastTouchTime>Date.now()-2e3)return!1;let t=null;for(let i of r.state.facet(ww))if(t=i(r,e),t)break;if(!t&&e.button==0&&(t=V4(r,e)),t){let i=!r.hasFocus;r.inputState.startMouseSelection(new L4(r,e,t,i)),i&&r.observer.ignore(()=>{aw(r.contentDOM);let n=r.root.activeElement;n&&!n.contains(r.contentDOM)&&n.blur()});let s=r.inputState.mouseSelection;if(s)return s.start(e),s.dragging===!1}else r.inputState.setSelectionOrigin("select.pointer");return!1};function Kb(r,e,t,i){if(i==1)return ie.cursor(e,t);if(i==2)return g4(r.state,e,t);{let s=It.find(r.docView,e),n=r.state.doc.lineAt(s?s.posAtEnd:e),a=s?s.posAtStart:n.from,o=s?s.posAtEnd:n.to;return o<r.state.doc.length&&o==n.to&&o++,ie.range(a,o)}}let Jb=(r,e,t)=>e>=t.top&&e<=t.bottom&&r>=t.left&&r<=t.right;function U4(r,e,t,i){let s=It.find(r.docView,e);if(!s)return 1;let n=e-s.posAtStart;if(n==0)return 1;if(n==s.length)return-1;let a=s.coordsAt(n,-1);if(a&&Jb(t,i,a))return-1;let o=s.coordsAt(n,1);return o&&Jb(t,i,o)?1:a&&a.bottom>=i?-1:1}function ev(r,e){let t=r.posAtCoords({x:e.clientX,y:e.clientY},!1);return{pos:t,bias:U4(r,t,e.clientX,e.clientY)}}const q4=me.ie&&me.ie_version<=11;let tv=null,iv=0,rv=0;function Zw(r){if(!q4)return r.detail;let e=tv,t=rv;return tv=r,rv=Date.now(),iv=!e||t>Date.now()-400&&Math.abs(e.clientX-r.clientX)<2&&Math.abs(e.clientY-r.clientY)<2?(iv+1)%3:1}function V4(r,e){let t=ev(r,e),i=Zw(e),s=r.state.selection;return{update(n){n.docChanged&&(t.pos=n.changes.mapPos(t.pos),s=s.map(n.changes))},get(n,a,o){let l=ev(r,n),u,c=Kb(r,l.pos,l.bias,i);if(t.pos!=l.pos&&!a){let h=Kb(r,t.pos,t.bias,i),f=Math.min(h.from,c.from),m=Math.max(h.to,c.to);c=f<c.from?ie.range(f,m):ie.range(m,f)}return a?s.replaceRange(s.main.extend(c.from,c.to)):o&&i==1&&s.ranges.length>1&&(u=X4(s,l.pos))?u:o?s.addRange(c):ie.create([c])}}}function X4(r,e){for(let t=0;t<r.ranges.length;t++){let{from:i,to:s}=r.ranges[t];if(i<=e&&s>=e)return ie.create(r.ranges.slice(0,t).concat(r.ranges.slice(t+1)),r.mainIndex==t?0:r.mainIndex-(r.mainIndex>t?1:0))}return null}vr.dragstart=(r,e)=>{let{selection:{main:t}}=r.state;if(e.target.draggable){let s=r.docView.nearest(e.target);if(s&&s.isWidget){let n=s.posAtStart,a=n+s.length;(n>=t.to||a<=t.from)&&(t=ie.range(n,a))}}let{inputState:i}=r;return i.mouseSelection&&(i.mouseSelection.dragging=!0),i.draggedContent=t,e.dataTransfer&&(e.dataTransfer.setData("Text",ld(r.state,e0,r.state.sliceDoc(t.from,t.to))),e.dataTransfer.effectAllowed="copyMove"),!1};vr.dragend=r=>(r.inputState.draggedContent=null,!1);function sv(r,e,t,i){if(t=ld(r.state,Jg,t),!t)return;let s=r.posAtCoords({x:e.clientX,y:e.clientY},!1),{draggedContent:n}=r.inputState,a=i&&n&&$4(r,e)?{from:n.from,to:n.to}:null,o={from:s,insert:t},l=r.state.changes(a?[a,o]:o);r.focus(),r.dispatch({changes:l,selection:{anchor:l.mapPos(s,-1),head:l.mapPos(s,1)},userEvent:a?"move.drop":"input.drop"}),r.inputState.draggedContent=null}vr.drop=(r,e)=>{if(!e.dataTransfer)return!1;if(r.state.readOnly)return!0;let t=e.dataTransfer.files;if(t&&t.length){let i=Array(t.length),s=0,n=()=>{++s==t.length&&sv(r,e,i.filter(a=>a!=null).join(r.state.lineBreak),!1)};for(let a=0;a<t.length;a++){let o=new FileReader;o.onerror=n,o.onload=()=>{/[\x00-\x08\x0e-\x1f]{2}/.test(o.result)||(i[a]=o.result),n()},o.readAsText(t[a])}return!0}else{let i=e.dataTransfer.getData("Text");if(i)return sv(r,e,i,!0),!0}return!1};vr.paste=(r,e)=>{if(r.state.readOnly)return!0;r.observer.flush();let t=jw?null:e.clipboardData;return t?(zw(r,t.getData("text/plain")||t.getData("text/uri-list")),!0):(F4(r),!1)};function j4(r,e){let t=r.dom.parentNode;if(!t)return;let i=t.appendChild(document.createElement("textarea"));i.style.cssText="position: fixed; left: -10000px; top: 10px",i.value=e,i.focus(),i.selectionEnd=e.length,i.selectionStart=0,setTimeout(()=>{i.remove(),r.focus()},50)}function z4(r){let e=[],t=[],i=!1;for(let s of r.selection.ranges)s.empty||(e.push(r.sliceDoc(s.from,s.to)),t.push(s));if(!e.length){let s=-1;for(let{from:n}of r.selection.ranges){let a=r.doc.lineAt(n);a.number>s&&(e.push(a.text),t.push({from:a.from,to:Math.min(r.doc.length,a.to+1)})),s=a.number}i=!0}return{text:ld(r,e0,e.join(r.lineBreak)),ranges:t,linewise:i}}let gm=null;vr.copy=vr.cut=(r,e)=>{let{text:t,ranges:i,linewise:s}=z4(r.state);if(!t&&!s)return!1;gm=s?t:null,e.type=="cut"&&!r.state.readOnly&&r.dispatch({changes:i,scrollIntoView:!0,userEvent:"delete.cut"});let n=jw?null:e.clipboardData;return n?(n.clearData(),n.setData("text/plain",t),!0):(j4(r,t),!1)};const Ww=Ts.define();function Hw(r,e){let t=[];for(let i of r.facet(Ew)){let s=i(r,e);s&&t.push(s)}return t.length?r.update({effects:t,annotations:Ww.of(!0)}):null}function Yw(r){setTimeout(()=>{let e=r.hasFocus;if(e!=r.inputState.notifiedFocused){let t=Hw(r.state,e);t?r.dispatch(t):r.update([])}},10)}nr.focus=r=>{r.inputState.lastFocusTime=Date.now(),!r.scrollDOM.scrollTop&&(r.inputState.lastScrollTop||r.inputState.lastScrollLeft)&&(r.scrollDOM.scrollTop=r.inputState.lastScrollTop,r.scrollDOM.scrollLeft=r.inputState.lastScrollLeft),Yw(r)};nr.blur=r=>{r.observer.clearSelectionRange(),Yw(r)};nr.compositionstart=nr.compositionupdate=r=>{r.observer.editContext||(r.inputState.compositionFirstChange==null&&(r.inputState.compositionFirstChange=!0),r.inputState.composing<0&&(r.inputState.composing=0))};nr.compositionend=r=>{r.observer.editContext||(r.inputState.composing=-1,r.inputState.compositionEndedAt=Date.now(),r.inputState.compositionPendingKey=!0,r.inputState.compositionPendingChange=r.observer.pendingRecords().length>0,r.inputState.compositionFirstChange=null,me.chrome&&me.android?r.observer.flushSoon():r.inputState.compositionPendingChange?Promise.resolve().then(()=>r.observer.flush()):setTimeout(()=>{r.inputState.composing<0&&r.docView.hasComposition&&r.update([])},50))};nr.contextmenu=r=>{r.inputState.lastContextMenu=Date.now()};vr.beforeinput=(r,e)=>{var t,i;if(e.inputType=="insertReplacementText"&&r.observer.editContext){let n=(t=e.dataTransfer)===null||t===void 0?void 0:t.getData("text/plain"),a=e.getTargetRanges();if(n&&a.length){let o=a[0],l=r.posAtDOM(o.startContainer,o.startOffset),u=r.posAtDOM(o.endContainer,o.endOffset);return r0(r,{from:l,to:u,insert:r.state.toText(n)},null),!0}}let s;if(me.chrome&&me.android&&(s=Vw.find(n=>n.inputType==e.inputType))&&(r.observer.delayAndroidKey(s.key,s.keyCode),s.key=="Backspace"||s.key=="Delete")){let n=((i=window.visualViewport)===null||i===void 0?void 0:i.height)||0;setTimeout(()=>{var a;(((a=window.visualViewport)===null||a===void 0?void 0:a.height)||0)>n+10&&r.hasFocus&&(r.contentDOM.blur(),r.focus())},100)}return me.ios&&e.inputType=="deleteContentForward"&&r.observer.flushSoon(),me.safari&&e.inputType=="insertText"&&r.inputState.composing>=0&&setTimeout(()=>nr.compositionend(r,e),20),!1};const nv=new Set;function Z4(r){nv.has(r)||(nv.add(r),r.addEventListener("copy",()=>{}),r.addEventListener("cut",()=>{}))}const av=["pre-wrap","normal","pre-line","break-spaces"];let Na=!1;function ov(){Na=!1}class W4{constructor(e){this.lineWrapping=e,this.doc=Ue.empty,this.heightSamples={},this.lineHeight=14,this.charWidth=7,this.textHeight=14,this.lineLength=30}heightForGap(e,t){let i=this.doc.lineAt(t).number-this.doc.lineAt(e).number+1;return this.lineWrapping&&(i+=Math.max(0,Math.ceil((t-e-i*this.lineLength*.5)/this.lineLength))),this.lineHeight*i}heightForLine(e){return this.lineWrapping?(1+Math.max(0,Math.ceil((e-this.lineLength)/Math.max(1,this.lineLength-5))))*this.lineHeight:this.lineHeight}setDoc(e){return this.doc=e,this}mustRefreshForWrapping(e){return av.indexOf(e)>-1!=this.lineWrapping}mustRefreshForHeights(e){let t=!1;for(let i=0;i<e.length;i++){let s=e[i];s<0?i++:this.heightSamples[Math.floor(s*10)]||(t=!0,this.heightSamples[Math.floor(s*10)]=!0)}return t}refresh(e,t,i,s,n,a){let o=av.indexOf(e)>-1,l=Math.round(t)!=Math.round(this.lineHeight)||this.lineWrapping!=o;if(this.lineWrapping=o,this.lineHeight=t,this.charWidth=i,this.textHeight=s,this.lineLength=n,l){this.heightSamples={};for(let u=0;u<a.length;u++){let c=a[u];c<0?u++:this.heightSamples[Math.floor(c*10)]=!0}}return l}}class H4{constructor(e,t){this.from=e,this.heights=t,this.index=0}get more(){return this.index<this.heights.length}}class $r{constructor(e,t,i,s,n){this.from=e,this.length=t,this.top=i,this.height=s,this._content=n}get type(){return typeof this._content=="number"?gi.Text:Array.isArray(this._content)?this._content:this._content.type}get to(){return this.from+this.length}get bottom(){return this.top+this.height}get widget(){return this._content instanceof Ys?this._content.widget:null}get widgetLineBreaks(){return typeof this._content=="number"?this._content:0}join(e){let t=(Array.isArray(this._content)?this._content:[this]).concat(Array.isArray(e._content)?e._content:[e]);return new $r(this.from,this.length+e.length,this.top,this.height+e.height,t)}}var ht=(function(r){return r[r.ByPos=0]="ByPos",r[r.ByHeight=1]="ByHeight",r[r.ByPosNoHeight=2]="ByPosNoHeight",r})(ht||(ht={}));const Tc=.001;class Oi{constructor(e,t,i=2){this.length=e,this.height=t,this.flags=i}get outdated(){return(this.flags&2)>0}set outdated(e){this.flags=(e?2:0)|this.flags&-3}setHeight(e){this.height!=e&&(Math.abs(this.height-e)>Tc&&(Na=!0),this.height=e)}replace(e,t,i){return Oi.of(i)}decomposeLeft(e,t){t.push(this)}decomposeRight(e,t){t.push(this)}applyChanges(e,t,i,s){let n=this,a=i.doc;for(let o=s.length-1;o>=0;o--){let{fromA:l,toA:u,fromB:c,toB:h}=s[o],f=n.lineAt(l,ht.ByPosNoHeight,i.setDoc(t),0,0),m=f.to>=u?f:n.lineAt(u,ht.ByPosNoHeight,i,0,0);for(h+=m.to-u,u=m.to;o>0&&f.from<=s[o-1].toA;)l=s[o-1].fromA,c=s[o-1].fromB,o--,l<f.from&&(f=n.lineAt(l,ht.ByPosNoHeight,i,0,0));c+=f.from-l,l=f.from;let S=s0.build(i.setDoc(a),e,c,h);n=uh(n,n.replace(l,u,S))}return n.updateHeight(i,0)}static empty(){return new Bi(0,0)}static of(e){if(e.length==1)return e[0];let t=0,i=e.length,s=0,n=0;for(;;)if(t==i)if(s>n*2){let o=e[t-1];o.break?e.splice(--t,1,o.left,null,o.right):e.splice(--t,1,o.left,o.right),i+=1+o.break,s-=o.size}else if(n>s*2){let o=e[i];o.break?e.splice(i,1,o.left,null,o.right):e.splice(i,1,o.left,o.right),i+=2+o.break,n-=o.size}else break;else if(s<n){let o=e[t++];o&&(s+=o.size)}else{let o=e[--i];o&&(n+=o.size)}let a=0;return e[t-1]==null?(a=1,t--):e[t]==null&&(a=1,i++),new Y4(Oi.of(e.slice(0,t)),a,Oi.of(e.slice(i)))}}function uh(r,e){return r==e?r:(r.constructor!=e.constructor&&(Na=!0),e)}Oi.prototype.size=1;class Gw extends Oi{constructor(e,t,i){super(e,t),this.deco=i}blockAt(e,t,i,s){return new $r(s,this.length,i,this.height,this.deco||0)}lineAt(e,t,i,s,n){return this.blockAt(0,i,s,n)}forEachLine(e,t,i,s,n,a){e<=n+this.length&&t>=n&&a(this.blockAt(0,i,s,n))}updateHeight(e,t=0,i=!1,s){return s&&s.from<=t&&s.more&&this.setHeight(s.heights[s.index++]),this.outdated=!1,this}toString(){return`block(${this.length})`}}class Bi extends Gw{constructor(e,t){super(e,t,null),this.collapsed=0,this.widgetHeight=0,this.breaks=0}blockAt(e,t,i,s){return new $r(s,this.length,i,this.height,this.breaks)}replace(e,t,i){let s=i[0];return i.length==1&&(s instanceof Bi||s instanceof Zt&&s.flags&4)&&Math.abs(this.length-s.length)<10?(s instanceof Zt?s=new Bi(s.length,this.height):s.height=this.height,this.outdated||(s.outdated=!1),s):Oi.of(i)}updateHeight(e,t=0,i=!1,s){return s&&s.from<=t&&s.more?this.setHeight(s.heights[s.index++]):(i||this.outdated)&&this.setHeight(Math.max(this.widgetHeight,e.heightForLine(this.length-this.collapsed))+this.breaks*e.lineHeight),this.outdated=!1,this}toString(){return`line(${this.length}${this.collapsed?-this.collapsed:""}${this.widgetHeight?":"+this.widgetHeight:""})`}}class Zt extends Oi{constructor(e){super(e,0)}heightMetrics(e,t){let i=e.doc.lineAt(t).number,s=e.doc.lineAt(t+this.length).number,n=s-i+1,a,o=0;if(e.lineWrapping){let l=Math.min(this.height,e.lineHeight*n);a=l/n,this.length>n+1&&(o=(this.height-l)/(this.length-n-1))}else a=this.height/n;return{firstLine:i,lastLine:s,perLine:a,perChar:o}}blockAt(e,t,i,s){let{firstLine:n,lastLine:a,perLine:o,perChar:l}=this.heightMetrics(t,s);if(t.lineWrapping){let u=s+(e<t.lineHeight?0:Math.round(Math.max(0,Math.min(1,(e-i)/this.height))*this.length)),c=t.doc.lineAt(u),h=o+c.length*l,f=Math.max(i,e-h/2);return new $r(c.from,c.length,f,h,0)}else{let u=Math.max(0,Math.min(a-n,Math.floor((e-i)/o))),{from:c,length:h}=t.doc.line(n+u);return new $r(c,h,i+o*u,o,0)}}lineAt(e,t,i,s,n){if(t==ht.ByHeight)return this.blockAt(e,i,s,n);if(t==ht.ByPosNoHeight){let{from:m,to:S}=i.doc.lineAt(e);return new $r(m,S-m,0,0,0)}let{firstLine:a,perLine:o,perChar:l}=this.heightMetrics(i,n),u=i.doc.lineAt(e),c=o+u.length*l,h=u.number-a,f=s+o*h+l*(u.from-n-h);return new $r(u.from,u.length,Math.max(s,Math.min(f,s+this.height-c)),c,0)}forEachLine(e,t,i,s,n,a){e=Math.max(e,n),t=Math.min(t,n+this.length);let{firstLine:o,perLine:l,perChar:u}=this.heightMetrics(i,n);for(let c=e,h=s;c<=t;){let f=i.doc.lineAt(c);if(c==e){let S=f.number-o;h+=l*S+u*(e-n-S)}let m=l+u*f.length;a(new $r(f.from,f.length,h,m,0)),h+=m,c=f.to+1}}replace(e,t,i){let s=this.length-t;if(s>0){let n=i[i.length-1];n instanceof Zt?i[i.length-1]=new Zt(n.length+s):i.push(null,new Zt(s-1))}if(e>0){let n=i[0];n instanceof Zt?i[0]=new Zt(e+n.length):i.unshift(new Zt(e-1),null)}return Oi.of(i)}decomposeLeft(e,t){t.push(new Zt(e-1),null)}decomposeRight(e,t){t.push(null,new Zt(this.length-e-1))}updateHeight(e,t=0,i=!1,s){let n=t+this.length;if(s&&s.from<=t+this.length&&s.more){let a=[],o=Math.max(t,s.from),l=-1;for(s.from>t&&a.push(new Zt(s.from-t-1).updateHeight(e,t));o<=n&&s.more;){let c=e.doc.lineAt(o).length;a.length&&a.push(null);let h=s.heights[s.index++];l==-1?l=h:Math.abs(h-l)>=Tc&&(l=-2);let f=new Bi(c,h);f.outdated=!1,a.push(f),o+=c+1}o<=n&&a.push(null,new Zt(n-o).updateHeight(e,o));let u=Oi.of(a);return(l<0||Math.abs(u.height-this.height)>=Tc||Math.abs(l-this.heightMetrics(e,t).perLine)>=Tc)&&(Na=!0),uh(this,u)}else(i||this.outdated)&&(this.setHeight(e.heightForGap(t,t+this.length)),this.outdated=!1);return this}toString(){return`gap(${this.length})`}}class Y4 extends Oi{constructor(e,t,i){super(e.length+t+i.length,e.height+i.height,t|(e.outdated||i.outdated?2:0)),this.left=e,this.right=i,this.size=e.size+i.size}get break(){return this.flags&1}blockAt(e,t,i,s){let n=i+this.left.height;return e<n?this.left.blockAt(e,t,i,s):this.right.blockAt(e,t,n,s+this.left.length+this.break)}lineAt(e,t,i,s,n){let a=s+this.left.height,o=n+this.left.length+this.break,l=t==ht.ByHeight?e<a:e<o,u=l?this.left.lineAt(e,t,i,s,n):this.right.lineAt(e,t,i,a,o);if(this.break||(l?u.to<o:u.from>o))return u;let c=t==ht.ByPosNoHeight?ht.ByPosNoHeight:ht.ByPos;return l?u.join(this.right.lineAt(o,c,i,a,o)):this.left.lineAt(o,c,i,s,n).join(u)}forEachLine(e,t,i,s,n,a){let o=s+this.left.height,l=n+this.left.length+this.break;if(this.break)e<l&&this.left.forEachLine(e,t,i,s,n,a),t>=l&&this.right.forEachLine(e,t,i,o,l,a);else{let u=this.lineAt(l,ht.ByPos,i,s,n);e<u.from&&this.left.forEachLine(e,u.from-1,i,s,n,a),u.to>=e&&u.from<=t&&a(u),t>u.to&&this.right.forEachLine(u.to+1,t,i,o,l,a)}}replace(e,t,i){let s=this.left.length+this.break;if(t<s)return this.balanced(this.left.replace(e,t,i),this.right);if(e>this.left.length)return this.balanced(this.left,this.right.replace(e-s,t-s,i));let n=[];e>0&&this.decomposeLeft(e,n);let a=n.length;for(let o of i)n.push(o);if(e>0&&lv(n,a-1),t<this.length){let o=n.length;this.decomposeRight(t,n),lv(n,o)}return Oi.of(n)}decomposeLeft(e,t){let i=this.left.length;if(e<=i)return this.left.decomposeLeft(e,t);t.push(this.left),this.break&&(i++,e>=i&&t.push(null)),e>i&&this.right.decomposeLeft(e-i,t)}decomposeRight(e,t){let i=this.left.length,s=i+this.break;if(e>=s)return this.right.decomposeRight(e-s,t);e<i&&this.left.decomposeRight(e,t),this.break&&e<s&&t.push(null),t.push(this.right)}balanced(e,t){return e.size>2*t.size||t.size>2*e.size?Oi.of(this.break?[e,null,t]:[e,t]):(this.left=uh(this.left,e),this.right=uh(this.right,t),this.setHeight(e.height+t.height),this.outdated=e.outdated||t.outdated,this.size=e.size+t.size,this.length=e.length+this.break+t.length,this)}updateHeight(e,t=0,i=!1,s){let{left:n,right:a}=this,o=t+n.length+this.break,l=null;return s&&s.from<=t+n.length&&s.more?l=n=n.updateHeight(e,t,i,s):n.updateHeight(e,t,i),s&&s.from<=o+a.length&&s.more?l=a=a.updateHeight(e,o,i,s):a.updateHeight(e,o,i),l?this.balanced(n,a):(this.height=this.left.height+this.right.height,this.outdated=!1,this)}toString(){return this.left+(this.break?" ":"-")+this.right}}function lv(r,e){let t,i;r[e]==null&&(t=r[e-1])instanceof Zt&&(i=r[e+1])instanceof Zt&&r.splice(e-1,3,new Zt(t.length+1+i.length))}const G4=5;class s0{constructor(e,t){this.pos=e,this.oracle=t,this.nodes=[],this.lineStart=-1,this.lineEnd=-1,this.covering=null,this.writtenTo=e}get isCovered(){return this.covering&&this.nodes[this.nodes.length-1]==this.covering}span(e,t){if(this.lineStart>-1){let i=Math.min(t,this.lineEnd),s=this.nodes[this.nodes.length-1];s instanceof Bi?s.length+=i-this.pos:(i>this.pos||!this.isCovered)&&this.nodes.push(new Bi(i-this.pos,-1)),this.writtenTo=i,t>i&&(this.nodes.push(null),this.writtenTo++,this.lineStart=-1)}this.pos=t}point(e,t,i){if(e<t||i.heightRelevant){let s=i.widget?i.widget.estimatedHeight:0,n=i.widget?i.widget.lineBreaks:0;s<0&&(s=this.oracle.lineHeight);let a=t-e;i.block?this.addBlock(new Gw(a,s,i)):(a||n||s>=G4)&&this.addLineDeco(s,n,a)}else t>e&&this.span(e,t);this.lineEnd>-1&&this.lineEnd<this.pos&&(this.lineEnd=this.oracle.doc.lineAt(this.pos).to)}enterLine(){if(this.lineStart>-1)return;let{from:e,to:t}=this.oracle.doc.lineAt(this.pos);this.lineStart=e,this.lineEnd=t,this.writtenTo<e&&((this.writtenTo<e-1||this.nodes[this.nodes.length-1]==null)&&this.nodes.push(this.blankContent(this.writtenTo,e-1)),this.nodes.push(null)),this.pos>e&&this.nodes.push(new Bi(this.pos-e,-1)),this.writtenTo=this.pos}blankContent(e,t){let i=new Zt(t-e);return this.oracle.doc.lineAt(e).to==t&&(i.flags|=4),i}ensureLine(){this.enterLine();let e=this.nodes.length?this.nodes[this.nodes.length-1]:null;if(e instanceof Bi)return e;let t=new Bi(0,-1);return this.nodes.push(t),t}addBlock(e){this.enterLine();let t=e.deco;t&&t.startSide>0&&!this.isCovered&&this.ensureLine(),this.nodes.push(e),this.writtenTo=this.pos=this.pos+e.length,t&&t.endSide>0&&(this.covering=e)}addLineDeco(e,t,i){let s=this.ensureLine();s.length+=i,s.collapsed+=i,s.widgetHeight=Math.max(s.widgetHeight,e),s.breaks+=t,this.writtenTo=this.pos=this.pos+i}finish(e){let t=this.nodes.length==0?null:this.nodes[this.nodes.length-1];this.lineStart>-1&&!(t instanceof Bi)&&!this.isCovered?this.nodes.push(new Bi(0,-1)):(this.writtenTo<this.pos||t==null)&&this.nodes.push(this.blankContent(this.writtenTo,this.pos));let i=e;for(let s of this.nodes)s instanceof Bi&&s.updateHeight(this.oracle,i),i+=s?s.length:1;return this.nodes}static build(e,t,i,s){let n=new s0(i,e);return je.spans(t,i,s,n,0),n.finish(i)}}function K4(r,e,t){let i=new J4;return je.compare(r,e,t,i,0),i.changes}class J4{constructor(){this.changes=[]}compareRange(){}comparePoint(e,t,i,s){(e<t||i&&i.heightRelevant||s&&s.heightRelevant)&&Sc(e,t,this.changes,5)}}function eB(r,e){let t=r.getBoundingClientRect(),i=r.ownerDocument,s=i.defaultView||window,n=Math.max(0,t.left),a=Math.min(s.innerWidth,t.right),o=Math.max(0,t.top),l=Math.min(s.innerHeight,t.bottom);for(let u=r.parentNode;u&&u!=i.body;)if(u.nodeType==1){let c=u,h=window.getComputedStyle(c);if((c.scrollHeight>c.clientHeight||c.scrollWidth>c.clientWidth)&&h.overflow!="visible"){let f=c.getBoundingClientRect();n=Math.max(n,f.left),a=Math.min(a,f.right),o=Math.max(o,f.top),l=Math.min(u==r.parentNode?s.innerHeight:l,f.bottom)}u=h.position=="absolute"||h.position=="fixed"?c.offsetParent:c.parentNode}else if(u.nodeType==11)u=u.host;else break;return{left:n-t.left,right:Math.max(n,a)-t.left,top:o-(t.top+e),bottom:Math.max(o,l)-(t.top+e)}}function tB(r){let e=r.getBoundingClientRect(),t=r.ownerDocument.defaultView||window;return e.left<t.innerWidth&&e.right>0&&e.top<t.innerHeight&&e.bottom>0}function iB(r,e){let t=r.getBoundingClientRect();return{left:0,right:t.right-t.left,top:e,bottom:t.bottom-(t.top+e)}}class Af{constructor(e,t,i,s){this.from=e,this.to=t,this.size=i,this.displaySize=s}static same(e,t){if(e.length!=t.length)return!1;for(let i=0;i<e.length;i++){let s=e[i],n=t[i];if(s.from!=n.from||s.to!=n.to||s.size!=n.size)return!1}return!0}draw(e,t){return Ee.replace({widget:new rB(this.displaySize*(t?e.scaleY:e.scaleX),t)}).range(this.from,this.to)}}class rB extends _s{constructor(e,t){super(),this.size=e,this.vertical=t}eq(e){return e.size==this.size&&e.vertical==this.vertical}toDOM(){let e=document.createElement("div");return this.vertical?e.style.height=this.size+"px":(e.style.width=this.size+"px",e.style.height="2px",e.style.display="inline-block"),e}get estimatedHeight(){return this.vertical?this.size:-1}}class uv{constructor(e){this.state=e,this.pixelViewport={left:0,right:window.innerWidth,top:0,bottom:0},this.inView=!0,this.paddingTop=0,this.paddingBottom=0,this.contentDOMWidth=0,this.contentDOMHeight=0,this.editorHeight=0,this.editorWidth=0,this.scrollTop=0,this.scrolledToBottom=!1,this.scaleX=1,this.scaleY=1,this.scrollAnchorPos=0,this.scrollAnchorHeight=-1,this.scaler=cv,this.scrollTarget=null,this.printing=!1,this.mustMeasureContent=!0,this.defaultTextDirection=dt.LTR,this.visibleRanges=[],this.mustEnforceCursorAssoc=!1;let t=e.facet(t0).some(i=>typeof i!="function"&&i.class=="cm-lineWrapping");this.heightOracle=new W4(t),this.stateDeco=e.facet(_l).filter(i=>typeof i!="function"),this.heightMap=Oi.empty().applyChanges(this.stateDeco,Ue.empty,this.heightOracle.setDoc(e.doc),[new ir(0,0,0,e.doc.length)]);for(let i=0;i<2&&(this.viewport=this.getViewport(0,null),!!this.updateForViewport());i++);this.updateViewportLines(),this.lineGaps=this.ensureLineGaps([]),this.lineGapDeco=Ee.set(this.lineGaps.map(i=>i.draw(this,!1))),this.computeVisibleRanges()}updateForViewport(){let e=[this.viewport],{main:t}=this.state.selection;for(let i=0;i<=1;i++){let s=i?t.head:t.anchor;if(!e.some(({from:n,to:a})=>s>=n&&s<=a)){let{from:n,to:a}=this.lineBlockAt(s);e.push(new Gu(n,a))}}return this.viewports=e.sort((i,s)=>i.from-s.from),this.updateScaler()}updateScaler(){let e=this.scaler;return this.scaler=this.heightMap.height<=7e6?cv:new n0(this.heightOracle,this.heightMap,this.viewports),e.eq(this.scaler)?0:2}updateViewportLines(){this.viewportLines=[],this.heightMap.forEachLine(this.viewport.from,this.viewport.to,this.heightOracle.setDoc(this.state.doc),0,0,e=>{this.viewportLines.push(Vo(e,this.scaler))})}update(e,t=null){this.state=e.state;let i=this.stateDeco;this.stateDeco=this.state.facet(_l).filter(c=>typeof c!="function");let s=e.changedRanges,n=ir.extendWithRanges(s,K4(i,this.stateDeco,e?e.changes:$t.empty(this.state.doc.length))),a=this.heightMap.height,o=this.scrolledToBottom?null:this.scrollAnchorAt(this.scrollTop);ov(),this.heightMap=this.heightMap.applyChanges(this.stateDeco,e.startState.doc,this.heightOracle.setDoc(this.state.doc),n),(this.heightMap.height!=a||Na)&&(e.flags|=2),o?(this.scrollAnchorPos=e.changes.mapPos(o.from,-1),this.scrollAnchorHeight=o.top):(this.scrollAnchorPos=-1,this.scrollAnchorHeight=a);let l=n.length?this.mapViewport(this.viewport,e.changes):this.viewport;(t&&(t.range.head<l.from||t.range.head>l.to)||!this.viewportIsAppropriate(l))&&(l=this.getViewport(0,t));let u=l.from!=this.viewport.from||l.to!=this.viewport.to;this.viewport=l,e.flags|=this.updateForViewport(),(u||!e.changes.empty||e.flags&2)&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(this.mapLineGaps(this.lineGaps,e.changes))),e.flags|=this.computeVisibleRanges(e.changes),t&&(this.scrollTarget=t),!this.mustEnforceCursorAssoc&&e.selectionSet&&e.view.lineWrapping&&e.state.selection.main.empty&&e.state.selection.main.assoc&&!e.state.facet(Pw)&&(this.mustEnforceCursorAssoc=!0)}measure(e){let t=e.contentDOM,i=window.getComputedStyle(t),s=this.heightOracle,n=i.whiteSpace;this.defaultTextDirection=i.direction=="rtl"?dt.RTL:dt.LTR;let a=this.heightOracle.mustRefreshForWrapping(n),o=t.getBoundingClientRect(),l=a||this.mustMeasureContent||this.contentDOMHeight!=o.height;this.contentDOMHeight=o.height,this.mustMeasureContent=!1;let u=0,c=0;if(o.width&&o.height){let{scaleX:T,scaleY:w}=nw(t,o);(T>.005&&Math.abs(this.scaleX-T)>.005||w>.005&&Math.abs(this.scaleY-w)>.005)&&(this.scaleX=T,this.scaleY=w,u|=16,a=l=!0)}let h=(parseInt(i.paddingTop)||0)*this.scaleY,f=(parseInt(i.paddingBottom)||0)*this.scaleY;(this.paddingTop!=h||this.paddingBottom!=f)&&(this.paddingTop=h,this.paddingBottom=f,u|=18),this.editorWidth!=e.scrollDOM.clientWidth&&(s.lineWrapping&&(l=!0),this.editorWidth=e.scrollDOM.clientWidth,u|=16);let m=e.scrollDOM.scrollTop*this.scaleY;this.scrollTop!=m&&(this.scrollAnchorHeight=-1,this.scrollTop=m),this.scrolledToBottom=lw(e.scrollDOM);let S=(this.printing?iB:eB)(t,this.paddingTop),y=S.top-this.pixelViewport.top,E=S.bottom-this.pixelViewport.bottom;this.pixelViewport=S;let C=this.pixelViewport.bottom>this.pixelViewport.top&&this.pixelViewport.right>this.pixelViewport.left;if(C!=this.inView&&(this.inView=C,C&&(l=!0)),!this.inView&&!this.scrollTarget&&!tB(e.dom))return 0;let _=o.width;if((this.contentDOMWidth!=_||this.editorHeight!=e.scrollDOM.clientHeight)&&(this.contentDOMWidth=o.width,this.editorHeight=e.scrollDOM.clientHeight,u|=16),l){let T=e.docView.measureVisibleLineHeights(this.viewport);if(s.mustRefreshForHeights(T)&&(a=!0),a||s.lineWrapping&&Math.abs(_-this.contentDOMWidth)>s.charWidth){let{lineHeight:w,charWidth:A,textHeight:I}=e.docView.measureTextSize();a=w>0&&s.refresh(n,w,A,I,Math.max(5,_/A),T),a&&(e.docView.minWidth=0,u|=16)}y>0&&E>0?c=Math.max(y,E):y<0&&E<0&&(c=Math.min(y,E)),ov();for(let w of this.viewports){let A=w.from==this.viewport.from?T:e.docView.measureVisibleLineHeights(w);this.heightMap=(a?Oi.empty().applyChanges(this.stateDeco,Ue.empty,this.heightOracle,[new ir(0,0,0,e.state.doc.length)]):this.heightMap).updateHeight(s,0,a,new H4(w.from,A))}Na&&(u|=2)}let v=!this.viewportIsAppropriate(this.viewport,c)||this.scrollTarget&&(this.scrollTarget.range.head<this.viewport.from||this.scrollTarget.range.head>this.viewport.to);return v&&(u&2&&(u|=this.updateScaler()),this.viewport=this.getViewport(c,this.scrollTarget),u|=this.updateForViewport()),(u&2||v)&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(a?[]:this.lineGaps,e)),u|=this.computeVisibleRanges(),this.mustEnforceCursorAssoc&&(this.mustEnforceCursorAssoc=!1,e.docView.enforceCursorAssoc()),u}get visibleTop(){return this.scaler.fromDOM(this.pixelViewport.top)}get visibleBottom(){return this.scaler.fromDOM(this.pixelViewport.bottom)}getViewport(e,t){let i=.5-Math.max(-.5,Math.min(.5,e/1e3/2)),s=this.heightMap,n=this.heightOracle,{visibleTop:a,visibleBottom:o}=this,l=new Gu(s.lineAt(a-i*1e3,ht.ByHeight,n,0,0).from,s.lineAt(o+(1-i)*1e3,ht.ByHeight,n,0,0).to);if(t){let{head:u}=t.range;if(u<l.from||u>l.to){let c=Math.min(this.editorHeight,this.pixelViewport.bottom-this.pixelViewport.top),h=s.lineAt(u,ht.ByPos,n,0,0),f;t.y=="center"?f=(h.top+h.bottom)/2-c/2:t.y=="start"||t.y=="nearest"&&u<l.from?f=h.top:f=h.bottom-c,l=new Gu(s.lineAt(f-1e3/2,ht.ByHeight,n,0,0).from,s.lineAt(f+c+1e3/2,ht.ByHeight,n,0,0).to)}}return l}mapViewport(e,t){let i=t.mapPos(e.from,-1),s=t.mapPos(e.to,1);return new Gu(this.heightMap.lineAt(i,ht.ByPos,this.heightOracle,0,0).from,this.heightMap.lineAt(s,ht.ByPos,this.heightOracle,0,0).to)}viewportIsAppropriate({from:e,to:t},i=0){if(!this.inView)return!0;let{top:s}=this.heightMap.lineAt(e,ht.ByPos,this.heightOracle,0,0),{bottom:n}=this.heightMap.lineAt(t,ht.ByPos,this.heightOracle,0,0),{visibleTop:a,visibleBottom:o}=this;return(e==0||s<=a-Math.max(10,Math.min(-i,250)))&&(t==this.state.doc.length||n>=o+Math.max(10,Math.min(i,250)))&&s>a-2*1e3&&n<o+2*1e3}mapLineGaps(e,t){if(!e.length||t.empty)return e;let i=[];for(let s of e)t.touchesRange(s.from,s.to)||i.push(new Af(t.mapPos(s.from),t.mapPos(s.to),s.size,s.displaySize));return i}ensureLineGaps(e,t){let i=this.heightOracle.lineWrapping,s=i?1e4:2e3,n=s>>1,a=s<<1;if(this.defaultTextDirection!=dt.LTR&&!i)return[];let o=[],l=(c,h,f,m)=>{if(h-c<n)return;let S=this.state.selection.main,y=[S.from];S.empty||y.push(S.to);for(let C of y)if(C>c&&C<h){l(c,C-10,f,m),l(C+10,h,f,m);return}let E=nB(e,C=>C.from>=f.from&&C.to<=f.to&&Math.abs(C.from-c)<n&&Math.abs(C.to-h)<n&&!y.some(_=>C.from<_&&C.to>_));if(!E){if(h<f.to&&t&&i&&t.visibleRanges.some(v=>v.from<=h&&v.to>=h)){let v=t.moveToLineBoundary(ie.cursor(h),!1,!0).head;v>c&&(h=v)}let C=this.gapSize(f,c,h,m),_=i||C<2e6?C:2e6;E=new Af(c,h,C,_)}o.push(E)},u=c=>{if(c.length<a||c.type!=gi.Text)return;let h=sB(c.from,c.to,this.stateDeco);if(h.total<a)return;let f=this.scrollTarget?this.scrollTarget.range.head:null,m,S;if(i){let y=s/this.heightOracle.lineLength*this.heightOracle.lineHeight,E,C;if(f!=null){let _=Ju(h,f),v=((this.visibleBottom-this.visibleTop)/2+y)/c.height;E=_-v,C=_+v}else E=(this.visibleTop-c.top-y)/c.height,C=(this.visibleBottom-c.top+y)/c.height;m=Ku(h,E),S=Ku(h,C)}else{let y=h.total*this.heightOracle.charWidth,E=s*this.heightOracle.charWidth,C=0;if(y>2e6)for(let A of e)A.from>=c.from&&A.from<c.to&&A.size!=A.displaySize&&A.from*this.heightOracle.charWidth+C<this.pixelViewport.left&&(C=A.size-A.displaySize);let _=this.pixelViewport.left+C,v=this.pixelViewport.right+C,T,w;if(f!=null){let A=Ju(h,f),I=((v-_)/2+E)/y;T=A-I,w=A+I}else T=(_-E)/y,w=(v+E)/y;m=Ku(h,T),S=Ku(h,w)}m>c.from&&l(c.from,m,c,h),S<c.to&&l(S,c.to,c,h)};for(let c of this.viewportLines)Array.isArray(c.type)?c.type.forEach(u):u(c);return o}gapSize(e,t,i,s){let n=Ju(s,i)-Ju(s,t);return this.heightOracle.lineWrapping?e.height*n:s.total*this.heightOracle.charWidth*n}updateLineGaps(e){Af.same(e,this.lineGaps)||(this.lineGaps=e,this.lineGapDeco=Ee.set(e.map(t=>t.draw(this,this.heightOracle.lineWrapping))))}computeVisibleRanges(e){let t=this.stateDeco;this.lineGaps.length&&(t=t.concat(this.lineGapDeco));let i=[];je.spans(t,this.viewport.from,this.viewport.to,{span(n,a){i.push({from:n,to:a})},point(){}},20);let s=0;if(i.length!=this.visibleRanges.length)s=12;else for(let n=0;n<i.length&&!(s&8);n++){let a=this.visibleRanges[n],o=i[n];(a.from!=o.from||a.to!=o.to)&&(s|=4,e&&e.mapPos(a.from,-1)==o.from&&e.mapPos(a.to,1)==o.to||(s|=8))}return this.visibleRanges=i,s}lineBlockAt(e){return e>=this.viewport.from&&e<=this.viewport.to&&this.viewportLines.find(t=>t.from<=e&&t.to>=e)||Vo(this.heightMap.lineAt(e,ht.ByPos,this.heightOracle,0,0),this.scaler)}lineBlockAtHeight(e){return e>=this.viewportLines[0].top&&e<=this.viewportLines[this.viewportLines.length-1].bottom&&this.viewportLines.find(t=>t.top<=e&&t.bottom>=e)||Vo(this.heightMap.lineAt(this.scaler.fromDOM(e),ht.ByHeight,this.heightOracle,0,0),this.scaler)}scrollAnchorAt(e){let t=this.lineBlockAtHeight(e+8);return t.from>=this.viewport.from||this.viewportLines[0].top-e>200?t:this.viewportLines[0]}elementAtHeight(e){return Vo(this.heightMap.blockAt(this.scaler.fromDOM(e),this.heightOracle,0,0),this.scaler)}get docHeight(){return this.scaler.toDOM(this.heightMap.height)}get contentHeight(){return this.docHeight+this.paddingTop+this.paddingBottom}}class Gu{constructor(e,t){this.from=e,this.to=t}}function sB(r,e,t){let i=[],s=r,n=0;return je.spans(t,r,e,{span(){},point(a,o){a>s&&(i.push({from:s,to:a}),n+=a-s),s=o}},20),s<e&&(i.push({from:s,to:e}),n+=e-s),{total:n,ranges:i}}function Ku({total:r,ranges:e},t){if(t<=0)return e[0].from;if(t>=1)return e[e.length-1].to;let i=Math.floor(r*t);for(let s=0;;s++){let{from:n,to:a}=e[s],o=a-n;if(i<=o)return n+i;i-=o}}function Ju(r,e){let t=0;for(let{from:i,to:s}of r.ranges){if(e<=s){t+=e-i;break}t+=s-i}return t/r.total}function nB(r,e){for(let t of r)if(e(t))return t}const cv={toDOM(r){return r},fromDOM(r){return r},scale:1,eq(r){return r==this}};class n0{constructor(e,t,i){let s=0,n=0,a=0;this.viewports=i.map(({from:o,to:l})=>{let u=t.lineAt(o,ht.ByPos,e,0,0).top,c=t.lineAt(l,ht.ByPos,e,0,0).bottom;return s+=c-u,{from:o,to:l,top:u,bottom:c,domTop:0,domBottom:0}}),this.scale=(7e6-s)/(t.height-s);for(let o of this.viewports)o.domTop=a+(o.top-n)*this.scale,a=o.domBottom=o.domTop+(o.bottom-o.top),n=o.bottom}toDOM(e){for(let t=0,i=0,s=0;;t++){let n=t<this.viewports.length?this.viewports[t]:null;if(!n||e<n.top)return s+(e-i)*this.scale;if(e<=n.bottom)return n.domTop+(e-n.top);i=n.bottom,s=n.domBottom}}fromDOM(e){for(let t=0,i=0,s=0;;t++){let n=t<this.viewports.length?this.viewports[t]:null;if(!n||e<n.domTop)return i+(e-s)/this.scale;if(e<=n.domBottom)return n.top+(e-n.domTop);i=n.bottom,s=n.domBottom}}eq(e){return e instanceof n0?this.scale==e.scale&&this.viewports.length==e.viewports.length&&this.viewports.every((t,i)=>t.from==e.viewports[i].from&&t.to==e.viewports[i].to):!1}}function Vo(r,e){if(e.scale==1)return r;let t=e.toDOM(r.top),i=e.toDOM(r.bottom);return new $r(r.from,r.length,t,i-t,Array.isArray(r._content)?r._content.map(s=>Vo(s,e)):r._content)}const ec=be.define({combine:r=>r.join(" ")}),Om=be.define({combine:r=>r.indexOf(!0)>-1}),ym=Ws.newName(),Kw=Ws.newName(),Jw=Ws.newName(),e2={"&light":"."+Kw,"&dark":"."+Jw};function bm(r,e,t){return new Ws(e,{finish(i){return/&/.test(i)?i.replace(/&\w*/,s=>{if(s=="&")return r;if(!t||!t[s])throw new RangeError(`Unsupported selector: ${s}`);return t[s]}):r+" "+i}})}const aB=bm("."+ym,{"&":{position:"relative !important",boxSizing:"border-box","&.cm-focused":{outline:"1px dotted #212121"},display:"flex !important",flexDirection:"column"},".cm-scroller":{display:"flex !important",alignItems:"flex-start !important",fontFamily:"monospace",lineHeight:1.4,height:"100%",overflowX:"auto",position:"relative",zIndex:0,overflowAnchor:"none"},".cm-content":{margin:0,flexGrow:2,flexShrink:0,display:"block",whiteSpace:"pre",wordWrap:"normal",boxSizing:"border-box",minHeight:"100%",padding:"4px 0",outline:"none","&[contenteditable=true]":{WebkitUserModify:"read-write-plaintext-only"}},".cm-lineWrapping":{whiteSpace_fallback:"pre-wrap",whiteSpace:"break-spaces",wordBreak:"break-word",overflowWrap:"anywhere",flexShrink:1},"&light .cm-content":{caretColor:"black"},"&dark .cm-content":{caretColor:"white"},".cm-line":{display:"block",padding:"0 2px 0 6px"},".cm-layer":{position:"absolute",left:0,top:0,contain:"size style","& > *":{position:"absolute"}},"&light .cm-selectionBackground":{background:"#d9d9d9"},"&dark .cm-selectionBackground":{background:"#222"},"&light.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#d7d4f0"},"&dark.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#233"},".cm-cursorLayer":{pointerEvents:"none"},"&.cm-focused > .cm-scroller > .cm-cursorLayer":{animation:"steps(1) cm-blink 1.2s infinite"},"@keyframes cm-blink":{"0%":{},"50%":{opacity:0},"100%":{}},"@keyframes cm-blink2":{"0%":{},"50%":{opacity:0},"100%":{}},".cm-cursor, .cm-dropCursor":{borderLeft:"1.2px solid black",marginLeft:"-0.6px",pointerEvents:"none"},".cm-cursor":{display:"none"},"&dark .cm-cursor":{borderLeftColor:"#ddd"},".cm-dropCursor":{position:"absolute"},"&.cm-focused > .cm-scroller > .cm-cursorLayer .cm-cursor":{display:"block"},".cm-iso":{unicodeBidi:"isolate"},".cm-announced":{position:"fixed",top:"-10000px"},"@media print":{".cm-announced":{display:"none"}},"&light .cm-activeLine":{backgroundColor:"#cceeff44"},"&dark .cm-activeLine":{backgroundColor:"#99eeff33"},"&light .cm-specialChar":{color:"red"},"&dark .cm-specialChar":{color:"#f78"},".cm-gutters":{flexShrink:0,display:"flex",height:"100%",boxSizing:"border-box",zIndex:200},".cm-gutters-before":{insetInlineStart:0},".cm-gutters-after":{insetInlineEnd:0},"&light .cm-gutters":{backgroundColor:"#f5f5f5",color:"#6c6c6c",border:"0px solid #ddd","&.cm-gutters-before":{borderRightWidth:"1px"},"&.cm-gutters-after":{borderLeftWidth:"1px"}},"&dark .cm-gutters":{backgroundColor:"#333338",color:"#ccc"},".cm-gutter":{display:"flex !important",flexDirection:"column",flexShrink:0,boxSizing:"border-box",minHeight:"100%",overflow:"hidden"},".cm-gutterElement":{boxSizing:"border-box"},".cm-lineNumbers .cm-gutterElement":{padding:"0 3px 0 5px",minWidth:"20px",textAlign:"right",whiteSpace:"nowrap"},"&light .cm-activeLineGutter":{backgroundColor:"#e2f2ff"},"&dark .cm-activeLineGutter":{backgroundColor:"#222227"},".cm-panels":{boxSizing:"border-box",position:"sticky",left:0,right:0,zIndex:300},"&light .cm-panels":{backgroundColor:"#f5f5f5",color:"black"},"&light .cm-panels-top":{borderBottom:"1px solid #ddd"},"&light .cm-panels-bottom":{borderTop:"1px solid #ddd"},"&dark .cm-panels":{backgroundColor:"#333338",color:"white"},".cm-dialog":{padding:"2px 19px 4px 6px",position:"relative","& label":{fontSize:"80%"}},".cm-dialog-close":{position:"absolute",top:"3px",right:"4px",backgroundColor:"inherit",border:"none",font:"inherit",fontSize:"14px",padding:"0"},".cm-tab":{display:"inline-block",overflow:"hidden",verticalAlign:"bottom"},".cm-widgetBuffer":{verticalAlign:"text-top",height:"1em",width:0,display:"inline"},".cm-placeholder":{color:"#888",display:"inline-block",verticalAlign:"top",userSelect:"none"},".cm-highlightSpace":{backgroundImage:"radial-gradient(circle at 50% 55%, #aaa 20%, transparent 5%)",backgroundPosition:"center"},".cm-highlightTab":{backgroundImage:`url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="200" height="20"><path stroke="%23888" stroke-width="1" fill="none" d="M1 10H196L190 5M190 15L196 10M197 4L197 16"/></svg>')`,backgroundSize:"auto 100%",backgroundPosition:"right 90%",backgroundRepeat:"no-repeat"},".cm-trailingSpace":{backgroundColor:"#ff332255"},".cm-button":{verticalAlign:"middle",color:"inherit",fontSize:"70%",padding:".2em 1em",borderRadius:"1px"},"&light .cm-button":{backgroundImage:"linear-gradient(#eff1f5, #d9d9df)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#b4b4b4, #d0d3d6)"}},"&dark .cm-button":{backgroundImage:"linear-gradient(#393939, #111)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#111, #333)"}},".cm-textfield":{verticalAlign:"middle",color:"inherit",fontSize:"70%",border:"1px solid silver",padding:".2em .5em"},"&light .cm-textfield":{backgroundColor:"white"},"&dark .cm-textfield":{border:"1px solid #555",backgroundColor:"inherit"}},e2),oB={childList:!0,characterData:!0,subtree:!0,attributes:!0,characterDataOldValue:!0},Pf=me.ie&&me.ie_version<=11;class lB{constructor(e){this.view=e,this.active=!1,this.editContext=null,this.selectionRange=new X3,this.selectionChanged=!1,this.delayedFlush=-1,this.resizeTimeout=-1,this.queue=[],this.delayedAndroidKey=null,this.flushingAndroidKey=-1,this.lastChange=0,this.scrollTargets=[],this.intersection=null,this.resizeScroll=null,this.intersecting=!1,this.gapIntersection=null,this.gaps=[],this.printQuery=null,this.parentCheck=-1,this.dom=e.contentDOM,this.observer=new MutationObserver(t=>{for(let i of t)this.queue.push(i);(me.ie&&me.ie_version<=11||me.ios&&e.composing)&&t.some(i=>i.type=="childList"&&i.removedNodes.length||i.type=="characterData"&&i.oldValue.length>i.target.nodeValue.length)?this.flushSoon():this.flush()}),window.EditContext&&me.android&&e.constructor.EDIT_CONTEXT!==!1&&!(me.chrome&&me.chrome_version<126)&&(this.editContext=new cB(e),e.state.facet(fs)&&(e.contentDOM.editContext=this.editContext.editContext)),Pf&&(this.onCharData=t=>{this.queue.push({target:t.target,type:"characterData",oldValue:t.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this),this.onResize=this.onResize.bind(this),this.onPrint=this.onPrint.bind(this),this.onScroll=this.onScroll.bind(this),window.matchMedia&&(this.printQuery=window.matchMedia("print")),typeof ResizeObserver=="function"&&(this.resizeScroll=new ResizeObserver(()=>{var t;((t=this.view.docView)===null||t===void 0?void 0:t.lastUpdate)<Date.now()-75&&this.onResize()}),this.resizeScroll.observe(e.scrollDOM)),this.addWindowListeners(this.win=e.win),this.start(),typeof IntersectionObserver=="function"&&(this.intersection=new IntersectionObserver(t=>{this.parentCheck<0&&(this.parentCheck=setTimeout(this.listenForScroll.bind(this),1e3)),t.length>0&&t[t.length-1].intersectionRatio>0!=this.intersecting&&(this.intersecting=!this.intersecting,this.intersecting!=this.view.inView&&this.onScrollChanged(document.createEvent("Event")))},{threshold:[0,.001]}),this.intersection.observe(this.dom),this.gapIntersection=new IntersectionObserver(t=>{t.length>0&&t[t.length-1].intersectionRatio>0&&this.onScrollChanged(document.createEvent("Event"))},{})),this.listenForScroll(),this.readSelectionRange()}onScrollChanged(e){this.view.inputState.runHandlers("scroll",e),this.intersecting&&this.view.measure()}onScroll(e){this.intersecting&&this.flush(!1),this.editContext&&this.view.requestMeasure(this.editContext.measureReq),this.onScrollChanged(e)}onResize(){this.resizeTimeout<0&&(this.resizeTimeout=setTimeout(()=>{this.resizeTimeout=-1,this.view.requestMeasure()},50))}onPrint(e){(e.type=="change"||!e.type)&&!e.matches||(this.view.viewState.printing=!0,this.view.measure(),setTimeout(()=>{this.view.viewState.printing=!1,this.view.requestMeasure()},500))}updateGaps(e){if(this.gapIntersection&&(e.length!=this.gaps.length||this.gaps.some((t,i)=>t!=e[i]))){this.gapIntersection.disconnect();for(let t of e)this.gapIntersection.observe(t);this.gaps=e}}onSelectionChange(e){let t=this.selectionChanged;if(!this.readSelectionRange()||this.delayedAndroidKey)return;let{view:i}=this,s=this.selectionRange;if(i.state.facet(fs)?i.root.activeElement!=this.dom:!vc(this.dom,s))return;let n=s.anchorNode&&i.docView.nearest(s.anchorNode);if(n&&n.ignoreEvent(e)){t||(this.selectionChanged=!1);return}(me.ie&&me.ie_version<=11||me.android&&me.chrome)&&!i.state.selection.main.empty&&s.focusNode&&rl(s.focusNode,s.focusOffset,s.anchorNode,s.anchorOffset)?this.flushSoon():this.flush(!1)}readSelectionRange(){let{view:e}=this,t=Sl(e.root);if(!t)return!1;let i=me.safari&&e.root.nodeType==11&&e.root.activeElement==this.dom&&uB(this.view,t)||t;if(!i||this.selectionRange.eq(i))return!1;let s=vc(this.dom,i);return s&&!this.selectionChanged&&e.inputState.lastFocusTime>Date.now()-200&&e.inputState.lastTouchTime<Date.now()-300&&z3(this.dom,i)?(this.view.inputState.lastFocusTime=0,e.docView.updateSelection(),!1):(this.selectionRange.setRange(i),s&&(this.selectionChanged=!0),!0)}setSelectionRange(e,t){this.selectionRange.set(e.node,e.offset,t.node,t.offset),this.selectionChanged=!1}clearSelectionRange(){this.selectionRange.set(null,0,null,0)}listenForScroll(){this.parentCheck=-1;let e=0,t=null;for(let i=this.dom;i;)if(i.nodeType==1)!t&&e<this.scrollTargets.length&&this.scrollTargets[e]==i?e++:t||(t=this.scrollTargets.slice(0,e)),t&&t.push(i),i=i.assignedSlot||i.parentNode;else if(i.nodeType==11)i=i.host;else break;if(e<this.scrollTargets.length&&!t&&(t=this.scrollTargets.slice(0,e)),t){for(let i of this.scrollTargets)i.removeEventListener("scroll",this.onScroll);for(let i of this.scrollTargets=t)i.addEventListener("scroll",this.onScroll)}}ignore(e){if(!this.active)return e();try{return this.stop(),e()}finally{this.start(),this.clear()}}start(){this.active||(this.observer.observe(this.dom,oB),Pf&&this.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.active=!0)}stop(){this.active&&(this.active=!1,this.observer.disconnect(),Pf&&this.dom.removeEventListener("DOMCharacterDataModified",this.onCharData))}clear(){this.processRecords(),this.queue.length=0,this.selectionChanged=!1}delayAndroidKey(e,t){var i;if(!this.delayedAndroidKey){let s=()=>{let n=this.delayedAndroidKey;n&&(this.clearDelayedAndroidKey(),this.view.inputState.lastKeyCode=n.keyCode,this.view.inputState.lastKeyTime=Date.now(),!this.flush()&&n.force&&Ta(this.dom,n.key,n.keyCode))};this.flushingAndroidKey=this.view.win.requestAnimationFrame(s)}(!this.delayedAndroidKey||e=="Enter")&&(this.delayedAndroidKey={key:e,keyCode:t,force:this.lastChange<Date.now()-50||!!(!((i=this.delayedAndroidKey)===null||i===void 0)&&i.force)})}clearDelayedAndroidKey(){this.win.cancelAnimationFrame(this.flushingAndroidKey),this.delayedAndroidKey=null,this.flushingAndroidKey=-1}flushSoon(){this.delayedFlush<0&&(this.delayedFlush=this.view.win.requestAnimationFrame(()=>{this.delayedFlush=-1,this.flush()}))}forceFlush(){this.delayedFlush>=0&&(this.view.win.cancelAnimationFrame(this.delayedFlush),this.delayedFlush=-1),this.flush()}pendingRecords(){for(let e of this.observer.takeRecords())this.queue.push(e);return this.queue}processRecords(){let e=this.pendingRecords();e.length&&(this.queue=[]);let t=-1,i=-1,s=!1;for(let n of e){let a=this.readMutation(n);a&&(a.typeOver&&(s=!0),t==-1?{from:t,to:i}=a:(t=Math.min(a.from,t),i=Math.max(a.to,i)))}return{from:t,to:i,typeOver:s}}readChange(){let{from:e,to:t,typeOver:i}=this.processRecords(),s=this.selectionChanged&&vc(this.dom,this.selectionRange);if(e<0&&!s)return null;e>-1&&(this.lastChange=Date.now()),this.view.inputState.lastFocusTime=0,this.selectionChanged=!1;let n=new k4(this.view,e,t,i);return this.view.docView.domChanged={newSel:n.newSel?n.newSel.main:null},n}flush(e=!0){if(this.delayedFlush>=0||this.delayedAndroidKey)return!1;e&&this.readSelectionRange();let t=this.readChange();if(!t)return this.view.requestMeasure(),!1;let i=this.view.state,s=Uw(this.view,t);return this.view.state==i&&(t.domChanged||t.newSel&&!t.newSel.main.eq(this.view.state.selection.main))&&this.view.update([]),s}readMutation(e){let t=this.view.docView.nearest(e.target);if(!t||t.ignoreMutation(e))return null;if(t.markDirty(e.type=="attributes"),e.type=="attributes"&&(t.flags|=4),e.type=="childList"){let i=hv(t,e.previousSibling||e.target.previousSibling,-1),s=hv(t,e.nextSibling||e.target.nextSibling,1);return{from:i?t.posAfter(i):t.posAtStart,to:s?t.posBefore(s):t.posAtEnd,typeOver:!1}}else return e.type=="characterData"?{from:t.posAtStart,to:t.posAtEnd,typeOver:e.target.nodeValue==e.oldValue}:null}setWindow(e){e!=this.win&&(this.removeWindowListeners(this.win),this.win=e,this.addWindowListeners(this.win))}addWindowListeners(e){e.addEventListener("resize",this.onResize),this.printQuery?this.printQuery.addEventListener?this.printQuery.addEventListener("change",this.onPrint):this.printQuery.addListener(this.onPrint):e.addEventListener("beforeprint",this.onPrint),e.addEventListener("scroll",this.onScroll),e.document.addEventListener("selectionchange",this.onSelectionChange)}removeWindowListeners(e){e.removeEventListener("scroll",this.onScroll),e.removeEventListener("resize",this.onResize),this.printQuery?this.printQuery.removeEventListener?this.printQuery.removeEventListener("change",this.onPrint):this.printQuery.removeListener(this.onPrint):e.removeEventListener("beforeprint",this.onPrint),e.document.removeEventListener("selectionchange",this.onSelectionChange)}update(e){this.editContext&&(this.editContext.update(e),e.startState.facet(fs)!=e.state.facet(fs)&&(e.view.contentDOM.editContext=e.state.facet(fs)?this.editContext.editContext:null))}destroy(){var e,t,i;this.stop(),(e=this.intersection)===null||e===void 0||e.disconnect(),(t=this.gapIntersection)===null||t===void 0||t.disconnect(),(i=this.resizeScroll)===null||i===void 0||i.disconnect();for(let s of this.scrollTargets)s.removeEventListener("scroll",this.onScroll);this.removeWindowListeners(this.win),clearTimeout(this.parentCheck),clearTimeout(this.resizeTimeout),this.win.cancelAnimationFrame(this.delayedFlush),this.win.cancelAnimationFrame(this.flushingAndroidKey),this.editContext&&(this.view.contentDOM.editContext=null,this.editContext.destroy())}}function hv(r,e,t){for(;e;){let i=et.get(e);if(i&&i.parent==r)return i;let s=e.parentNode;e=s!=r.dom?s:t>0?e.nextSibling:e.previousSibling}return null}function dv(r,e){let t=e.startContainer,i=e.startOffset,s=e.endContainer,n=e.endOffset,a=r.docView.domAtPos(r.state.selection.main.anchor);return rl(a.node,a.offset,s,n)&&([t,i,s,n]=[s,n,t,i]),{anchorNode:t,anchorOffset:i,focusNode:s,focusOffset:n}}function uB(r,e){if(e.getComposedRanges){let s=e.getComposedRanges(r.root)[0];if(s)return dv(r,s)}let t=null;function i(s){s.preventDefault(),s.stopImmediatePropagation(),t=s.getTargetRanges()[0]}return r.contentDOM.addEventListener("beforeinput",i,!0),r.dom.ownerDocument.execCommand("indent"),r.contentDOM.removeEventListener("beforeinput",i,!0),t?dv(r,t):null}class cB{constructor(e){this.from=0,this.to=0,this.pendingContextChange=null,this.handlers=Object.create(null),this.composing=null,this.resetRange(e.state);let t=this.editContext=new window.EditContext({text:e.state.doc.sliceString(this.from,this.to),selectionStart:this.toContextPos(Math.max(this.from,Math.min(this.to,e.state.selection.main.anchor))),selectionEnd:this.toContextPos(e.state.selection.main.head)});this.handlers.textupdate=i=>{let s=e.state.selection.main,{anchor:n,head:a}=s,o=this.toEditorPos(i.updateRangeStart),l=this.toEditorPos(i.updateRangeEnd);e.inputState.composing>=0&&!this.composing&&(this.composing={contextBase:i.updateRangeStart,editorBase:o,drifted:!1});let u=l-o>i.text.length;o==this.from&&n<this.from?o=n:l==this.to&&n>this.to&&(l=n);let c=qw(e.state.sliceDoc(o,l),i.text,(u?s.from:s.to)-o,u?"end":null);if(!c){let f=ie.single(this.toEditorPos(i.selectionStart),this.toEditorPos(i.selectionEnd));f.main.eq(s)||e.dispatch({selection:f,userEvent:"select"});return}let h={from:c.from+o,to:c.toA+o,insert:Ue.of(i.text.slice(c.from,c.toB).split(`
`))};if((me.mac||me.android)&&h.from==a-1&&/^\. ?$/.test(i.text)&&e.contentDOM.getAttribute("autocorrect")=="off"&&(h={from:o,to:l,insert:Ue.of([i.text.replace("."," ")])}),this.pendingContextChange=h,!e.state.readOnly){let f=this.to-this.from+(h.to-h.from+h.insert.length);r0(e,h,ie.single(this.toEditorPos(i.selectionStart,f),this.toEditorPos(i.selectionEnd,f)))}this.pendingContextChange&&(this.revertPending(e.state),this.setSelection(e.state)),h.from<h.to&&!h.insert.length&&e.inputState.composing>=0&&!/[\\p{Alphabetic}\\p{Number}_]/.test(t.text.slice(Math.max(0,i.updateRangeStart-1),Math.min(t.text.length,i.updateRangeStart+1)))&&this.handlers.compositionend(i)},this.handlers.characterboundsupdate=i=>{let s=[],n=null;for(let a=this.toEditorPos(i.rangeStart),o=this.toEditorPos(i.rangeEnd);a<o;a++){let l=e.coordsForChar(a);n=l&&new DOMRect(l.left,l.top,l.right-l.left,l.bottom-l.top)||n||new DOMRect,s.push(n)}t.updateCharacterBounds(i.rangeStart,s)},this.handlers.textformatupdate=i=>{let s=[];for(let n of i.getTextFormats()){let a=n.underlineStyle,o=n.underlineThickness;if(!/none/i.test(a)&&!/none/i.test(o)){let l=this.toEditorPos(n.rangeStart),u=this.toEditorPos(n.rangeEnd);if(l<u){let c=`text-decoration: underline ${/^[a-z]/.test(a)?a+" ":a=="Dashed"?"dashed ":a=="Squiggle"?"wavy ":""}${/thin/i.test(o)?1:2}px`;s.push(Ee.mark({attributes:{style:c}}).range(l,u))}}}e.dispatch({effects:Mw.of(Ee.set(s))})},this.handlers.compositionstart=()=>{e.inputState.composing<0&&(e.inputState.composing=0,e.inputState.compositionFirstChange=!0)},this.handlers.compositionend=()=>{if(e.inputState.composing=-1,e.inputState.compositionFirstChange=null,this.composing){let{drifted:i}=this.composing;this.composing=null,i&&this.reset(e.state)}};for(let i in this.handlers)t.addEventListener(i,this.handlers[i]);this.measureReq={read:i=>{this.editContext.updateControlBounds(i.contentDOM.getBoundingClientRect());let s=Sl(i.root);s&&s.rangeCount&&this.editContext.updateSelectionBounds(s.getRangeAt(0).getBoundingClientRect())}}}applyEdits(e){let t=0,i=!1,s=this.pendingContextChange;return e.changes.iterChanges((n,a,o,l,u)=>{if(i)return;let c=u.length-(a-n);if(s&&a>=s.to)if(s.from==n&&s.to==a&&s.insert.eq(u)){s=this.pendingContextChange=null,t+=c,this.to+=c;return}else s=null,this.revertPending(e.state);if(n+=t,a+=t,a<=this.from)this.from+=c,this.to+=c;else if(n<this.to){if(n<this.from||a>this.to||this.to-this.from+u.length>3e4){i=!0;return}this.editContext.updateText(this.toContextPos(n),this.toContextPos(a),u.toString()),this.to+=c}t+=c}),s&&!i&&this.revertPending(e.state),!i}update(e){let t=this.pendingContextChange,i=e.startState.selection.main;this.composing&&(this.composing.drifted||!e.changes.touchesRange(i.from,i.to)&&e.transactions.some(s=>!s.isUserEvent("input.type")&&s.changes.touchesRange(this.from,this.to)))?(this.composing.drifted=!0,this.composing.editorBase=e.changes.mapPos(this.composing.editorBase)):!this.applyEdits(e)||!this.rangeIsValid(e.state)?(this.pendingContextChange=null,this.reset(e.state)):(e.docChanged||e.selectionSet||t)&&this.setSelection(e.state),(e.geometryChanged||e.docChanged||e.selectionSet)&&e.view.requestMeasure(this.measureReq)}resetRange(e){let{head:t}=e.selection.main;this.from=Math.max(0,t-1e4),this.to=Math.min(e.doc.length,t+1e4)}reset(e){this.resetRange(e),this.editContext.updateText(0,this.editContext.text.length,e.doc.sliceString(this.from,this.to)),this.setSelection(e)}revertPending(e){let t=this.pendingContextChange;this.pendingContextChange=null,this.editContext.updateText(this.toContextPos(t.from),this.toContextPos(t.from+t.insert.length),e.doc.sliceString(t.from,t.to))}setSelection(e){let{main:t}=e.selection,i=this.toContextPos(Math.max(this.from,Math.min(this.to,t.anchor))),s=this.toContextPos(t.head);(this.editContext.selectionStart!=i||this.editContext.selectionEnd!=s)&&this.editContext.updateSelection(i,s)}rangeIsValid(e){let{head:t}=e.selection.main;return!(this.from>0&&t-this.from<500||this.to<e.doc.length&&this.to-t<500||this.to-this.from>1e4*3)}toEditorPos(e,t=this.to-this.from){e=Math.min(e,t);let i=this.composing;return i&&i.drifted?i.editorBase+(e-i.contextBase):e+this.from}toContextPos(e){let t=this.composing;return t&&t.drifted?t.contextBase+(e-t.editorBase):e-this.from}destroy(){for(let e in this.handlers)this.editContext.removeEventListener(e,this.handlers[e])}}class ge{get state(){return this.viewState.state}get viewport(){return this.viewState.viewport}get visibleRanges(){return this.viewState.visibleRanges}get inView(){return this.viewState.inView}get composing(){return!!this.inputState&&this.inputState.composing>0}get compositionStarted(){return!!this.inputState&&this.inputState.composing>=0}get root(){return this._root}get win(){return this.dom.ownerDocument.defaultView||window}constructor(e={}){var t;this.plugins=[],this.pluginMap=new Map,this.editorAttrs={},this.contentAttrs={},this.bidiCache=[],this.destroyed=!1,this.updateState=2,this.measureScheduled=-1,this.measureRequests=[],this.contentDOM=document.createElement("div"),this.scrollDOM=document.createElement("div"),this.scrollDOM.tabIndex=-1,this.scrollDOM.className="cm-scroller",this.scrollDOM.appendChild(this.contentDOM),this.announceDOM=document.createElement("div"),this.announceDOM.className="cm-announced",this.announceDOM.setAttribute("aria-live","polite"),this.dom=document.createElement("div"),this.dom.appendChild(this.announceDOM),this.dom.appendChild(this.scrollDOM),e.parent&&e.parent.appendChild(this.dom);let{dispatch:i}=e;this.dispatchTransactions=e.dispatchTransactions||i&&(s=>s.forEach(n=>i(n,this)))||(s=>this.update(s)),this.dispatch=this.dispatch.bind(this),this._root=e.root||j3(e.parent)||document,this.viewState=new uv(e.state||Xe.create(e)),e.scrollTo&&e.scrollTo.is(Wu)&&(this.viewState.scrollTarget=e.scrollTo.value.clip(this.viewState.state)),this.plugins=this.state.facet(na).map(s=>new Cf(s));for(let s of this.plugins)s.update(this);this.observer=new lB(this),this.inputState=new D4(this),this.inputState.ensureHandlers(this.plugins),this.docView=new Xb(this),this.mountStyles(),this.updateAttrs(),this.updateState=0,this.requestMeasure(),!((t=document.fonts)===null||t===void 0)&&t.ready&&document.fonts.ready.then(()=>this.requestMeasure())}dispatch(...e){let t=e.length==1&&e[0]instanceof Lt?e:e.length==1&&Array.isArray(e[0])?e[0]:[this.state.update(...e)];this.dispatchTransactions(t,this)}update(e){if(this.updateState!=0)throw new Error("Calls to EditorView.update are not allowed while an update is in progress");let t=!1,i=!1,s,n=this.state;for(let f of e){if(f.startState!=n)throw new RangeError("Trying to update state with a transaction that doesn't start from the previous state.");n=f.state}if(this.destroyed){this.viewState.state=n;return}let a=this.hasFocus,o=0,l=null;e.some(f=>f.annotation(Ww))?(this.inputState.notifiedFocused=a,o=1):a!=this.inputState.notifiedFocused&&(this.inputState.notifiedFocused=a,l=Hw(n,a),l||(o=1));let u=this.observer.delayedAndroidKey,c=null;if(u?(this.observer.clearDelayedAndroidKey(),c=this.observer.readChange(),(c&&!this.state.doc.eq(n.doc)||!this.state.selection.eq(n.selection))&&(c=null)):this.observer.clear(),n.facet(Xe.phrases)!=this.state.facet(Xe.phrases))return this.setState(n);s=lh.create(this,n,e),s.flags|=o;let h=this.viewState.scrollTarget;try{this.updateState=2;for(let f of e){if(h&&(h=h.map(f.changes)),f.scrollIntoView){let{main:m}=f.state.selection;h=new _a(m.empty?m:ie.cursor(m.head,m.head>m.anchor?-1:1))}for(let m of f.effects)m.is(Wu)&&(h=m.value.clip(this.state))}this.viewState.update(s,h),this.bidiCache=ch.update(this.bidiCache,s.changes),s.empty||(this.updatePlugins(s),this.inputState.update(s)),t=this.docView.update(s),this.state.facet(Uo)!=this.styleModules&&this.mountStyles(),i=this.updateAttrs(),this.showAnnouncements(e),this.docView.updateSelection(t,e.some(f=>f.isUserEvent("select.pointer")))}finally{this.updateState=0}if(s.startState.facet(ec)!=s.state.facet(ec)&&(this.viewState.mustMeasureContent=!0),(t||i||h||this.viewState.mustEnforceCursorAssoc||this.viewState.mustMeasureContent)&&this.requestMeasure(),t&&this.docViewUpdate(),!s.empty)for(let f of this.state.facet(fm))try{f(s)}catch(m){ki(this.state,m,"update listener")}(l||c)&&Promise.resolve().then(()=>{l&&this.state==l.startState&&this.dispatch(l),c&&!Uw(this,c)&&u.force&&Ta(this.contentDOM,u.key,u.keyCode)})}setState(e){if(this.updateState!=0)throw new Error("Calls to EditorView.setState are not allowed while an update is in progress");if(this.destroyed){this.viewState.state=e;return}this.updateState=2;let t=this.hasFocus;try{for(let i of this.plugins)i.destroy(this);this.viewState=new uv(e),this.plugins=e.facet(na).map(i=>new Cf(i)),this.pluginMap.clear();for(let i of this.plugins)i.update(this);this.docView.destroy(),this.docView=new Xb(this),this.inputState.ensureHandlers(this.plugins),this.mountStyles(),this.updateAttrs(),this.bidiCache=[]}finally{this.updateState=0}t&&this.focus(),this.requestMeasure()}updatePlugins(e){let t=e.startState.facet(na),i=e.state.facet(na);if(t!=i){let s=[];for(let n of i){let a=t.indexOf(n);if(a<0)s.push(new Cf(n));else{let o=this.plugins[a];o.mustUpdate=e,s.push(o)}}for(let n of this.plugins)n.mustUpdate!=e&&n.destroy(this);this.plugins=s,this.pluginMap.clear()}else for(let s of this.plugins)s.mustUpdate=e;for(let s=0;s<this.plugins.length;s++)this.plugins[s].update(this);t!=i&&this.inputState.ensureHandlers(this.plugins)}docViewUpdate(){for(let e of this.plugins){let t=e.value;if(t&&t.docViewUpdate)try{t.docViewUpdate(this)}catch(i){ki(this.state,i,"doc view update listener")}}}measure(e=!0){if(this.destroyed)return;if(this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.observer.delayedAndroidKey){this.measureScheduled=-1,this.requestMeasure();return}this.measureScheduled=0,e&&this.observer.forceFlush();let t=null,i=this.scrollDOM,s=i.scrollTop*this.scaleY,{scrollAnchorPos:n,scrollAnchorHeight:a}=this.viewState;Math.abs(s-this.viewState.scrollTop)>1&&(a=-1),this.viewState.scrollAnchorHeight=-1;try{for(let o=0;;o++){if(a<0)if(lw(i))n=-1,a=this.viewState.heightMap.height;else{let m=this.viewState.scrollAnchorAt(s);n=m.from,a=m.top}this.updateState=1;let l=this.viewState.measure(this);if(!l&&!this.measureRequests.length&&this.viewState.scrollTarget==null)break;if(o>5){console.warn(this.measureRequests.length?"Measure loop restarted more than 5 times":"Viewport failed to stabilize");break}let u=[];l&4||([this.measureRequests,u]=[u,this.measureRequests]);let c=u.map(m=>{try{return m.read(this)}catch(S){return ki(this.state,S),fv}}),h=lh.create(this,this.state,[]),f=!1;h.flags|=l,t?t.flags|=l:t=h,this.updateState=2,h.empty||(this.updatePlugins(h),this.inputState.update(h),this.updateAttrs(),f=this.docView.update(h),f&&this.docViewUpdate());for(let m=0;m<u.length;m++)if(c[m]!=fv)try{let S=u[m];S.write&&S.write(c[m],this)}catch(S){ki(this.state,S)}if(f&&this.docView.updateSelection(!0),!h.viewportChanged&&this.measureRequests.length==0){if(this.viewState.editorHeight)if(this.viewState.scrollTarget){this.docView.scrollIntoView(this.viewState.scrollTarget),this.viewState.scrollTarget=null,a=-1;continue}else{let S=(n<0?this.viewState.heightMap.height:this.viewState.lineBlockAt(n).top)-a;if(S>1||S<-1){s=s+S,i.scrollTop=s/this.scaleY,a=-1;continue}}break}}}finally{this.updateState=0,this.measureScheduled=-1}if(t&&!t.empty)for(let o of this.state.facet(fm))o(t)}get themeClasses(){return ym+" "+(this.state.facet(Om)?Jw:Kw)+" "+this.state.facet(ec)}updateAttrs(){let e=pv(this,Iw,{class:"cm-editor"+(this.hasFocus?" cm-focused ":" ")+this.themeClasses}),t={spellcheck:"false",autocorrect:"off",autocapitalize:"off",writingsuggestions:"false",translate:"no",contenteditable:this.state.facet(fs)?"true":"false",class:"cm-content",style:`${me.tabSize}: ${this.state.tabSize}`,role:"textbox","aria-multiline":"true"};this.state.readOnly&&(t["aria-readonly"]="true"),pv(this,t0,t);let i=this.observer.ignore(()=>{let s=lm(this.contentDOM,this.contentAttrs,t),n=lm(this.dom,this.editorAttrs,e);return s||n});return this.editorAttrs=e,this.contentAttrs=t,i}showAnnouncements(e){let t=!0;for(let i of e)for(let s of i.effects)if(s.is(ge.announce)){t&&(this.announceDOM.textContent=""),t=!1;let n=this.announceDOM.appendChild(document.createElement("div"));n.textContent=s.value}}mountStyles(){this.styleModules=this.state.facet(Uo);let e=this.state.facet(ge.cspNonce);Ws.mount(this.root,this.styleModules.concat(aB).reverse(),e?{nonce:e}:void 0)}readMeasured(){if(this.updateState==2)throw new Error("Reading the editor layout isn't allowed during an update");this.updateState==0&&this.measureScheduled>-1&&this.measure(!1)}requestMeasure(e){if(this.measureScheduled<0&&(this.measureScheduled=this.win.requestAnimationFrame(()=>this.measure())),e){if(this.measureRequests.indexOf(e)>-1)return;if(e.key!=null){for(let t=0;t<this.measureRequests.length;t++)if(this.measureRequests[t].key===e.key){this.measureRequests[t]=e;return}}this.measureRequests.push(e)}}plugin(e){let t=this.pluginMap.get(e);return(t===void 0||t&&t.plugin!=e)&&this.pluginMap.set(e,t=this.plugins.find(i=>i.plugin==e)||null),t&&t.update(this).value}get documentTop(){return this.contentDOM.getBoundingClientRect().top+this.viewState.paddingTop}get documentPadding(){return{top:this.viewState.paddingTop,bottom:this.viewState.paddingBottom}}get scaleX(){return this.viewState.scaleX}get scaleY(){return this.viewState.scaleY}elementAtHeight(e){return this.readMeasured(),this.viewState.elementAtHeight(e)}lineBlockAtHeight(e){return this.readMeasured(),this.viewState.lineBlockAtHeight(e)}get viewportLineBlocks(){return this.viewState.viewportLines}lineBlockAt(e){return this.viewState.lineBlockAt(e)}get contentHeight(){return this.viewState.contentHeight}moveByChar(e,t,i){return Ef(this,e,Hb(this,e,t,i))}moveByGroup(e,t){return Ef(this,e,Hb(this,e,t,i=>T4(this,e.head,i)))}visualLineSide(e,t){let i=this.bidiSpans(e),s=this.textDirectionAt(e.from),n=i[t?i.length-1:0];return ie.cursor(n.side(t,s)+e.from,n.forward(!t,s)?1:-1)}moveToLineBoundary(e,t,i=!0){return S4(this,e,t,i)}moveVertically(e,t,i){return Ef(this,e,_4(this,e,t,i))}domAtPos(e){return this.docView.domAtPos(e)}posAtDOM(e,t=0){return this.docView.posFromDOM(e,t)}posAtCoords(e,t=!0){return this.readMeasured(),Bw(this,e,t)}coordsAtPos(e,t=1){this.readMeasured();let i=this.docView.coordsAt(e,t);if(!i||i.left==i.right)return i;let s=this.state.doc.lineAt(e),n=this.bidiSpans(s),a=n[Vs.find(n,e-s.from,-1,t)];return od(i,a.dir==dt.LTR==t>0)}coordsForChar(e){return this.readMeasured(),this.docView.coordsForChar(e)}get defaultCharacterWidth(){return this.viewState.heightOracle.charWidth}get defaultLineHeight(){return this.viewState.heightOracle.lineHeight}get textDirection(){return this.viewState.defaultTextDirection}textDirectionAt(e){return!this.state.facet(Aw)||e<this.viewport.from||e>this.viewport.to?this.textDirection:(this.readMeasured(),this.docView.textDirectionAt(e))}get lineWrapping(){return this.viewState.heightOracle.lineWrapping}bidiSpans(e){if(e.length>hB)return Sw(e.length);let t=this.textDirectionAt(e.from),i;for(let n of this.bidiCache)if(n.from==e.from&&n.dir==t&&(n.fresh||vw(n.isolates,i=Vb(this,e))))return n.order;i||(i=Vb(this,e));let s=n4(e.text,t,i);return this.bidiCache.push(new ch(e.from,e.to,t,i,!0,s)),s}get hasFocus(){var e;return(this.dom.ownerDocument.hasFocus()||me.safari&&((e=this.inputState)===null||e===void 0?void 0:e.lastContextMenu)>Date.now()-3e4)&&this.root.activeElement==this.contentDOM}focus(){this.observer.ignore(()=>{aw(this.contentDOM),this.docView.updateSelection()})}setRoot(e){this._root!=e&&(this._root=e,this.observer.setWindow((e.nodeType==9?e:e.ownerDocument).defaultView||window),this.mountStyles())}destroy(){this.root.activeElement==this.contentDOM&&this.contentDOM.blur();for(let e of this.plugins)e.destroy(this);this.plugins=[],this.inputState.destroy(),this.docView.destroy(),this.dom.remove(),this.observer.destroy(),this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.destroyed=!0}static scrollIntoView(e,t={}){return Wu.of(new _a(typeof e=="number"?ie.cursor(e):e,t.y,t.x,t.yMargin,t.xMargin))}scrollSnapshot(){let{scrollTop:e,scrollLeft:t}=this.scrollDOM,i=this.viewState.scrollAnchorAt(e);return Wu.of(new _a(ie.cursor(i.from),"start","start",i.top-e,t,!0))}setTabFocusMode(e){e==null?this.inputState.tabFocusMode=this.inputState.tabFocusMode<0?0:-1:typeof e=="boolean"?this.inputState.tabFocusMode=e?0:-1:this.inputState.tabFocusMode!=0&&(this.inputState.tabFocusMode=Date.now()+e)}static domEventHandlers(e){return Qt.define(()=>({}),{eventHandlers:e})}static domEventObservers(e){return Qt.define(()=>({}),{eventObservers:e})}static theme(e,t){let i=Ws.newName(),s=[ec.of(i),Uo.of(bm(`.${i}`,e))];return t&&t.dark&&s.push(Om.of(!0)),s}static baseTheme(e){return Ss.lowest(Uo.of(bm("."+ym,e,e2)))}static findFromDOM(e){var t;let i=e.querySelector(".cm-content"),s=i&&et.get(i)||et.get(e);return((t=s?.rootView)===null||t===void 0?void 0:t.view)||null}}ge.styleModule=Uo;ge.inputHandler=kw;ge.clipboardInputFilter=Jg;ge.clipboardOutputFilter=e0;ge.scrollHandler=Dw;ge.focusChangeEffect=Ew;ge.perLineTextDirection=Aw;ge.exceptionSink=Cw;ge.updateListener=fm;ge.editable=fs;ge.mouseSelectionStyle=ww;ge.dragMovesSelection=xw;ge.clickAddsSelectionRange=_w;ge.decorations=_l;ge.outerDecorations=Rw;ge.atomicRanges=eu;ge.bidiIsolatedRanges=Lw;ge.scrollMargins=Qw;ge.darkTheme=Om;ge.cspNonce=be.define({combine:r=>r.length?r[0]:""});ge.contentAttributes=t0;ge.editorAttributes=Iw;ge.lineWrapping=ge.contentAttributes.of({class:"cm-lineWrapping"});ge.announce=Re.define();const hB=4096,fv={};class ch{constructor(e,t,i,s,n,a){this.from=e,this.to=t,this.dir=i,this.isolates=s,this.fresh=n,this.order=a}static update(e,t){if(t.empty&&!e.some(n=>n.fresh))return e;let i=[],s=e.length?e[e.length-1].dir:dt.LTR;for(let n=Math.max(0,e.length-10);n<e.length;n++){let a=e[n];a.dir==s&&!t.touchesRange(a.from,a.to)&&i.push(new ch(t.mapPos(a.from,1),t.mapPos(a.to,-1),a.dir,a.isolates,!1,a.order))}return i}}function pv(r,e,t){for(let i=r.state.facet(e),s=i.length-1;s>=0;s--){let n=i[s],a=typeof n=="function"?n(r):n;a&&om(a,t)}return t}const dB=me.mac?"mac":me.windows?"win":me.linux?"linux":"key";function fB(r,e){const t=r.split(/-(?!$)/);let i=t[t.length-1];i=="Space"&&(i=" ");let s,n,a,o;for(let l=0;l<t.length-1;++l){const u=t[l];if(/^(cmd|meta|m)$/i.test(u))o=!0;else if(/^a(lt)?$/i.test(u))s=!0;else if(/^(c|ctrl|control)$/i.test(u))n=!0;else if(/^s(hift)?$/i.test(u))a=!0;else if(/^mod$/i.test(u))e=="mac"?o=!0:n=!0;else throw new Error("Unrecognized modifier name: "+u)}return s&&(i="Alt-"+i),n&&(i="Ctrl-"+i),o&&(i="Meta-"+i),a&&(i="Shift-"+i),i}function tc(r,e,t){return e.altKey&&(r="Alt-"+r),e.ctrlKey&&(r="Ctrl-"+r),e.metaKey&&(r="Meta-"+r),t!==!1&&e.shiftKey&&(r="Shift-"+r),r}const pB=Ss.default(ge.domEventHandlers({keydown(r,e){return i2(t2(e.state),r,e,"editor")}})),tu=be.define({enables:pB}),mv=new WeakMap;function t2(r){let e=r.facet(tu),t=mv.get(e);return t||mv.set(e,t=OB(e.reduce((i,s)=>i.concat(s),[]))),t}function mB(r,e,t){return i2(t2(r.state),e,r,t)}let Fs=null;const gB=4e3;function OB(r,e=dB){let t=Object.create(null),i=Object.create(null),s=(a,o)=>{let l=i[a];if(l==null)i[a]=o;else if(l!=o)throw new Error("Key binding "+a+" is used both as a regular binding and as a multi-stroke prefix")},n=(a,o,l,u,c)=>{var h,f;let m=t[a]||(t[a]=Object.create(null)),S=o.split(/ (?!$)/).map(C=>fB(C,e));for(let C=1;C<S.length;C++){let _=S.slice(0,C).join(" ");s(_,!0),m[_]||(m[_]={preventDefault:!0,stopPropagation:!1,run:[v=>{let T=Fs={view:v,prefix:_,scope:a};return setTimeout(()=>{Fs==T&&(Fs=null)},gB),!0}]})}let y=S.join(" ");s(y,!1);let E=m[y]||(m[y]={preventDefault:!1,stopPropagation:!1,run:((f=(h=m._any)===null||h===void 0?void 0:h.run)===null||f===void 0?void 0:f.slice())||[]});l&&E.run.push(l),u&&(E.preventDefault=!0),c&&(E.stopPropagation=!0)};for(let a of r){let o=a.scope?a.scope.split(" "):["editor"];if(a.any)for(let u of o){let c=t[u]||(t[u]=Object.create(null));c._any||(c._any={preventDefault:!1,stopPropagation:!1,run:[]});let{any:h}=a;for(let f in c)c[f].run.push(m=>h(m,vm))}let l=a[e]||a.key;if(l)for(let u of o)n(u,l,a.run,a.preventDefault,a.stopPropagation),a.shift&&n(u,"Shift-"+l,a.shift,a.preventDefault,a.stopPropagation)}return t}let vm=null;function i2(r,e,t,i){vm=e;let s=N3(e),n=xi(s,0),a=Qr(n)==s.length&&s!=" ",o="",l=!1,u=!1,c=!1;Fs&&Fs.view==t&&Fs.scope==i&&(o=Fs.prefix+" ",Xw.indexOf(e.keyCode)<0&&(u=!0,Fs=null));let h=new Set,f=E=>{if(E){for(let C of E.run)if(!h.has(C)&&(h.add(C),C(t)))return E.stopPropagation&&(c=!0),!0;E.preventDefault&&(E.stopPropagation&&(c=!0),u=!0)}return!1},m=r[i],S,y;return m&&(f(m[o+tc(s,e,!a)])?l=!0:a&&(e.altKey||e.metaKey||e.ctrlKey)&&!(me.windows&&e.ctrlKey&&e.altKey)&&!(me.mac&&e.altKey&&!(e.ctrlKey||e.metaKey))&&(S=Hs[e.keyCode])&&S!=s?(f(m[o+tc(S,e,!0)])||e.shiftKey&&(y=vl[e.keyCode])!=s&&y!=S&&f(m[o+tc(y,e,!1)]))&&(l=!0):a&&e.shiftKey&&f(m[o+tc(s,e,!0)])&&(l=!0),!l&&f(m._any)&&(l=!0)),u&&(l=!0),l&&c&&e.stopPropagation(),vm=null,l}class iu{constructor(e,t,i,s,n){this.className=e,this.left=t,this.top=i,this.width=s,this.height=n}draw(){let e=document.createElement("div");return e.className=this.className,this.adjust(e),e}update(e,t){return t.className!=this.className?!1:(this.adjust(e),!0)}adjust(e){e.style.left=this.left+"px",e.style.top=this.top+"px",this.width!=null&&(e.style.width=this.width+"px"),e.style.height=this.height+"px"}eq(e){return this.left==e.left&&this.top==e.top&&this.width==e.width&&this.height==e.height&&this.className==e.className}static forRange(e,t,i){if(i.empty){let s=e.coordsAtPos(i.head,i.assoc||1);if(!s)return[];let n=r2(e);return[new iu(t,s.left-n.left,s.top-n.top,null,s.bottom-s.top)]}else return yB(e,t,i)}}function r2(r){let e=r.scrollDOM.getBoundingClientRect();return{left:(r.textDirection==dt.LTR?e.left:e.right-r.scrollDOM.clientWidth*r.scaleX)-r.scrollDOM.scrollLeft*r.scaleX,top:e.top-r.scrollDOM.scrollTop*r.scaleY}}function gv(r,e,t,i){let s=r.coordsAtPos(e,t*2);if(!s)return i;let n=r.dom.getBoundingClientRect(),a=(s.top+s.bottom)/2,o=r.posAtCoords({x:n.left+1,y:a}),l=r.posAtCoords({x:n.right-1,y:a});return o==null||l==null?i:{from:Math.max(i.from,Math.min(o,l)),to:Math.min(i.to,Math.max(o,l))}}function yB(r,e,t){if(t.to<=r.viewport.from||t.from>=r.viewport.to)return[];let i=Math.max(t.from,r.viewport.from),s=Math.min(t.to,r.viewport.to),n=r.textDirection==dt.LTR,a=r.contentDOM,o=a.getBoundingClientRect(),l=r2(r),u=a.querySelector(".cm-line"),c=u&&window.getComputedStyle(u),h=o.left+(c?parseInt(c.paddingLeft)+Math.min(0,parseInt(c.textIndent)):0),f=o.right-(c?parseInt(c.paddingRight):0),m=mm(r,i,1),S=mm(r,s,-1),y=m.type==gi.Text?m:null,E=S.type==gi.Text?S:null;if(y&&(r.lineWrapping||m.widgetLineBreaks)&&(y=gv(r,i,1,y)),E&&(r.lineWrapping||S.widgetLineBreaks)&&(E=gv(r,s,-1,E)),y&&E&&y.from==E.from&&y.to==E.to)return _(v(t.from,t.to,y));{let w=y?v(t.from,null,y):T(m,!1),A=E?v(null,t.to,E):T(S,!0),I=[];return(y||m).to<(E||S).from-(y&&E?1:0)||m.widgetLineBreaks>1&&w.bottom+r.defaultLineHeight/2<A.top?I.push(C(h,w.bottom,f,A.top)):w.bottom<A.top&&r.elementAtHeight((w.bottom+A.top)/2).type==gi.Text&&(w.bottom=A.top=(w.bottom+A.top)/2),_(w).concat(I).concat(_(A))}function C(w,A,I,N){return new iu(e,w-l.left,A-l.top,I-w,N-A)}function _({top:w,bottom:A,horizontal:I}){let N=[];for(let P=0;P<I.length;P+=2)N.push(C(I[P],w,I[P+1],A));return N}function v(w,A,I){let N=1e9,P=-1e9,R=[];function X(Y,te,le,G,re){let J=r.coordsAtPos(Y,Y==I.to?-2:2),ne=r.coordsAtPos(le,le==I.from?2:-2);!J||!ne||(N=Math.min(J.top,ne.top,N),P=Math.max(J.bottom,ne.bottom,P),re==dt.LTR?R.push(n&&te?h:J.left,n&&G?f:ne.right):R.push(!n&&G?h:ne.left,!n&&te?f:J.right))}let j=w??I.from,Z=A??I.to;for(let Y of r.visibleRanges)if(Y.to>j&&Y.from<Z)for(let te=Math.max(Y.from,j),le=Math.min(Y.to,Z);;){let G=r.state.doc.lineAt(te);for(let re of r.bidiSpans(G)){let J=re.from+G.from,ne=re.to+G.from;if(J>=le)break;ne>te&&X(Math.max(J,te),w==null&&J<=j,Math.min(ne,le),A==null&&ne>=Z,re.dir)}if(te=G.to+1,te>=le)break}return R.length==0&&X(j,w==null,Z,A==null,r.textDirection),{top:N,bottom:P,horizontal:R}}function T(w,A){let I=o.top+(A?w.top:w.bottom);return{top:I,bottom:I,horizontal:[]}}}function bB(r,e){return r.constructor==e.constructor&&r.eq(e)}class vB{constructor(e,t){this.view=e,this.layer=t,this.drawn=[],this.scaleX=1,this.scaleY=1,this.measureReq={read:this.measure.bind(this),write:this.draw.bind(this)},this.dom=e.scrollDOM.appendChild(document.createElement("div")),this.dom.classList.add("cm-layer"),t.above&&this.dom.classList.add("cm-layer-above"),t.class&&this.dom.classList.add(t.class),this.scale(),this.dom.setAttribute("aria-hidden","true"),this.setOrder(e.state),e.requestMeasure(this.measureReq),t.mount&&t.mount(this.dom,e)}update(e){e.startState.facet(_c)!=e.state.facet(_c)&&this.setOrder(e.state),(this.layer.update(e,this.dom)||e.geometryChanged)&&(this.scale(),e.view.requestMeasure(this.measureReq))}docViewUpdate(e){this.layer.updateOnDocViewUpdate!==!1&&e.requestMeasure(this.measureReq)}setOrder(e){let t=0,i=e.facet(_c);for(;t<i.length&&i[t]!=this.layer;)t++;this.dom.style.zIndex=String((this.layer.above?150:-1)-t)}measure(){return this.layer.markers(this.view)}scale(){let{scaleX:e,scaleY:t}=this.view;(e!=this.scaleX||t!=this.scaleY)&&(this.scaleX=e,this.scaleY=t,this.dom.style.transform=`scale(${1/e}, ${1/t})`)}draw(e){if(e.length!=this.drawn.length||e.some((t,i)=>!bB(t,this.drawn[i]))){let t=this.dom.firstChild,i=0;for(let s of e)s.update&&t&&s.constructor&&this.drawn[i].constructor&&s.update(t,this.drawn[i])?(t=t.nextSibling,i++):this.dom.insertBefore(s.draw(),t);for(;t;){let s=t.nextSibling;t.remove(),t=s}this.drawn=e,me.safari&&me.safari_version>=26&&(this.dom.style.display=this.dom.firstChild?"":"none")}}destroy(){this.layer.destroy&&this.layer.destroy(this.dom,this.view),this.dom.remove()}}const _c=be.define();function s2(r){return[Qt.define(e=>new vB(e,r)),_c.of(r)]}const xl=be.define({combine(r){return Gr(r,{cursorBlinkRate:1200,drawRangeCursor:!0},{cursorBlinkRate:(e,t)=>Math.min(e,t),drawRangeCursor:(e,t)=>e||t})}});function SB(r={}){return[xl.of(r),TB,_B,xB,Pw.of(!0)]}function n2(r){return r.startState.facet(xl)!=r.state.facet(xl)}const TB=s2({above:!0,markers(r){let{state:e}=r,t=e.facet(xl),i=[];for(let s of e.selection.ranges){let n=s==e.selection.main;if(s.empty||t.drawRangeCursor){let a=n?"cm-cursor cm-cursor-primary":"cm-cursor cm-cursor-secondary",o=s.empty?s:ie.cursor(s.head,s.head>s.anchor?-1:1);for(let l of iu.forRange(r,a,o))i.push(l)}}return i},update(r,e){r.transactions.some(i=>i.selection)&&(e.style.animationName=e.style.animationName=="cm-blink"?"cm-blink2":"cm-blink");let t=n2(r);return t&&Ov(r.state,e),r.docChanged||r.selectionSet||t},mount(r,e){Ov(e.state,r)},class:"cm-cursorLayer"});function Ov(r,e){e.style.animationDuration=r.facet(xl).cursorBlinkRate+"ms"}const _B=s2({above:!1,markers(r){return r.state.selection.ranges.map(e=>e.empty?[]:iu.forRange(r,"cm-selectionBackground",e)).reduce((e,t)=>e.concat(t))},update(r,e){return r.docChanged||r.selectionSet||r.viewportChanged||n2(r)},class:"cm-selectionLayer"}),xB=Ss.highest(ge.theme({".cm-line":{"& ::selection, &::selection":{backgroundColor:"transparent !important"},caretColor:"transparent !important"},".cm-content":{caretColor:"transparent !important","& :focus":{caretColor:"initial !important","&::selection, & ::selection":{backgroundColor:"Highlight !important"}}}})),a2=Re.define({map(r,e){return r==null?null:e.mapPos(r)}}),Xo=jt.define({create(){return null},update(r,e){return r!=null&&(r=e.changes.mapPos(r)),e.effects.reduce((t,i)=>i.is(a2)?i.value:t,r)}}),wB=Qt.fromClass(class{constructor(r){this.view=r,this.cursor=null,this.measureReq={read:this.readPos.bind(this),write:this.drawCursor.bind(this)}}update(r){var e;let t=r.state.field(Xo);t==null?this.cursor!=null&&((e=this.cursor)===null||e===void 0||e.remove(),this.cursor=null):(this.cursor||(this.cursor=this.view.scrollDOM.appendChild(document.createElement("div")),this.cursor.className="cm-dropCursor"),(r.startState.field(Xo)!=t||r.docChanged||r.geometryChanged)&&this.view.requestMeasure(this.measureReq))}readPos(){let{view:r}=this,e=r.state.field(Xo),t=e!=null&&r.coordsAtPos(e);if(!t)return null;let i=r.scrollDOM.getBoundingClientRect();return{left:t.left-i.left+r.scrollDOM.scrollLeft*r.scaleX,top:t.top-i.top+r.scrollDOM.scrollTop*r.scaleY,height:t.bottom-t.top}}drawCursor(r){if(this.cursor){let{scaleX:e,scaleY:t}=this.view;r?(this.cursor.style.left=r.left/e+"px",this.cursor.style.top=r.top/t+"px",this.cursor.style.height=r.height/t+"px"):this.cursor.style.left="-100000px"}}destroy(){this.cursor&&this.cursor.remove()}setDropPos(r){this.view.state.field(Xo)!=r&&this.view.dispatch({effects:a2.of(r)})}},{eventObservers:{dragover(r){this.setDropPos(this.view.posAtCoords({x:r.clientX,y:r.clientY}))},dragleave(r){(r.target==this.view.contentDOM||!this.view.contentDOM.contains(r.relatedTarget))&&this.setDropPos(null)},dragend(){this.setDropPos(null)},drop(){this.setDropPos(null)}}});function CB(){return[Xo,wB]}function yv(r,e,t,i,s){e.lastIndex=0;for(let n=r.iterRange(t,i),a=t,o;!n.next().done;a+=n.value.length)if(!n.lineBreak)for(;o=e.exec(n.value);)s(a+o.index,o)}function kB(r,e){let t=r.visibleRanges;if(t.length==1&&t[0].from==r.viewport.from&&t[0].to==r.viewport.to)return t;let i=[];for(let{from:s,to:n}of t)s=Math.max(r.state.doc.lineAt(s).from,s-e),n=Math.min(r.state.doc.lineAt(n).to,n+e),i.length&&i[i.length-1].to>=s?i[i.length-1].to=n:i.push({from:s,to:n});return i}class EB{constructor(e){const{regexp:t,decoration:i,decorate:s,boundary:n,maxLength:a=1e3}=e;if(!t.global)throw new RangeError("The regular expression given to MatchDecorator should have its 'g' flag set");if(this.regexp=t,s)this.addMatch=(o,l,u,c)=>s(c,u,u+o[0].length,o,l);else if(typeof i=="function")this.addMatch=(o,l,u,c)=>{let h=i(o,l,u);h&&c(u,u+o[0].length,h)};else if(i)this.addMatch=(o,l,u,c)=>c(u,u+o[0].length,i);else throw new RangeError("Either 'decorate' or 'decoration' should be provided to MatchDecorator");this.boundary=n,this.maxLength=a}createDeco(e){let t=new ys,i=t.add.bind(t);for(let{from:s,to:n}of kB(e,this.maxLength))yv(e.state.doc,this.regexp,s,n,(a,o)=>this.addMatch(o,e,a,i));return t.finish()}updateDeco(e,t){let i=1e9,s=-1;return e.docChanged&&e.changes.iterChanges((n,a,o,l)=>{l>=e.view.viewport.from&&o<=e.view.viewport.to&&(i=Math.min(o,i),s=Math.max(l,s))}),e.viewportMoved||s-i>1e3?this.createDeco(e.view):s>-1?this.updateRange(e.view,t.map(e.changes),i,s):t}updateRange(e,t,i,s){for(let n of e.visibleRanges){let a=Math.max(n.from,i),o=Math.min(n.to,s);if(o>=a){let l=e.state.doc.lineAt(a),u=l.to<o?e.state.doc.lineAt(o):l,c=Math.max(n.from,l.from),h=Math.min(n.to,u.to);if(this.boundary){for(;a>l.from;a--)if(this.boundary.test(l.text[a-1-l.from])){c=a;break}for(;o<u.to;o++)if(this.boundary.test(u.text[o-u.from])){h=o;break}}let f=[],m,S=(y,E,C)=>f.push(C.range(y,E));if(l==u)for(this.regexp.lastIndex=c-l.from;(m=this.regexp.exec(l.text))&&m.index<h-l.from;)this.addMatch(m,e,m.index+l.from,S);else yv(e.state.doc,this.regexp,c,h,(y,E)=>this.addMatch(E,e,y,S));t=t.update({filterFrom:c,filterTo:h,filter:(y,E)=>y<c||E>h,add:f})}}return t}}const Sm=/x/.unicode!=null?"gu":"g",AB=new RegExp(`[\0-\b
--­؜​‎‏\u2028\u2029‭‮⁦⁧⁩\uFEFF￹-￼]`,Sm),PB={0:"null",7:"bell",8:"backspace",10:"newline",11:"vertical tab",13:"carriage return",27:"escape",8203:"zero width space",8204:"zero width non-joiner",8205:"zero width joiner",8206:"left-to-right mark",8207:"right-to-left mark",8232:"line separator",8237:"left-to-right override",8238:"right-to-left override",8294:"left-to-right isolate",8295:"right-to-left isolate",8297:"pop directional isolate",8233:"paragraph separator",65279:"zero width no-break space",65532:"object replacement"};let Df=null;function DB(){var r;if(Df==null&&typeof document<"u"&&document.body){let e=document.body.style;Df=((r=e.tabSize)!==null&&r!==void 0?r:e.MozTabSize)!=null}return Df||!1}const xc=be.define({combine(r){let e=Gr(r,{render:null,specialChars:AB,addSpecialChars:null});return(e.replaceTabs=!DB())&&(e.specialChars=new RegExp("	|"+e.specialChars.source,Sm)),e.addSpecialChars&&(e.specialChars=new RegExp(e.specialChars.source+"|"+e.addSpecialChars.source,Sm)),e}});function MB(r={}){return[xc.of(r),IB()]}let bv=null;function IB(){return bv||(bv=Qt.fromClass(class{constructor(r){this.view=r,this.decorations=Ee.none,this.decorationCache=Object.create(null),this.decorator=this.makeDecorator(r.state.facet(xc)),this.decorations=this.decorator.createDeco(r)}makeDecorator(r){return new EB({regexp:r.specialChars,decoration:(e,t,i)=>{let{doc:s}=t.state,n=xi(e[0],0);if(n==9){let a=s.lineAt(i),o=t.state.tabSize,l=yr(a.text,o,i-a.from);return Ee.replace({widget:new $B((o-l%o)*this.view.defaultCharacterWidth/this.view.scaleX)})}return this.decorationCache[n]||(this.decorationCache[n]=Ee.replace({widget:new QB(r,n)}))},boundary:r.replaceTabs?void 0:/[^]/})}update(r){let e=r.state.facet(xc);r.startState.facet(xc)!=e?(this.decorator=this.makeDecorator(e),this.decorations=this.decorator.createDeco(r.view)):this.decorations=this.decorator.updateDeco(r,this.decorations)}},{decorations:r=>r.decorations}))}const RB="•";function LB(r){return r>=32?RB:r==10?"␤":String.fromCharCode(9216+r)}class QB extends _s{constructor(e,t){super(),this.options=e,this.code=t}eq(e){return e.code==this.code}toDOM(e){let t=LB(this.code),i=e.state.phrase("Control character")+" "+(PB[this.code]||"0x"+this.code.toString(16)),s=this.options.render&&this.options.render(this.code,i,t);if(s)return s;let n=document.createElement("span");return n.textContent=t,n.title=i,n.setAttribute("aria-label",i),n.className="cm-specialChar",n}ignoreEvent(){return!1}}class $B extends _s{constructor(e){super(),this.width=e}eq(e){return e.width==this.width}toDOM(){let e=document.createElement("span");return e.textContent="	",e.className="cm-tab",e.style.width=this.width+"px",e}ignoreEvent(){return!1}}function BB(){return FB}const NB=Ee.line({class:"cm-activeLine"}),FB=Qt.fromClass(class{constructor(r){this.decorations=this.getDeco(r)}update(r){(r.docChanged||r.selectionSet)&&(this.decorations=this.getDeco(r.view))}getDeco(r){let e=-1,t=[];for(let i of r.state.selection.ranges){let s=r.lineBlockAt(i.head);s.from>e&&(t.push(NB.range(s.from)),e=s.from)}return Ee.set(t)}},{decorations:r=>r.decorations}),Tm=2e3;function UB(r,e,t){let i=Math.min(e.line,t.line),s=Math.max(e.line,t.line),n=[];if(e.off>Tm||t.off>Tm||e.col<0||t.col<0){let a=Math.min(e.off,t.off),o=Math.max(e.off,t.off);for(let l=i;l<=s;l++){let u=r.doc.line(l);u.length<=o&&n.push(ie.range(u.from+a,u.to+o))}}else{let a=Math.min(e.col,t.col),o=Math.max(e.col,t.col);for(let l=i;l<=s;l++){let u=r.doc.line(l),c=Jp(u.text,a,r.tabSize,!0);if(c<0)n.push(ie.cursor(u.to));else{let h=Jp(u.text,o,r.tabSize);n.push(ie.range(u.from+c,u.from+h))}}}return n}function qB(r,e){let t=r.coordsAtPos(r.viewport.from);return t?Math.round(Math.abs((t.left-e)/r.defaultCharacterWidth)):-1}function vv(r,e){let t=r.posAtCoords({x:e.clientX,y:e.clientY},!1),i=r.state.doc.lineAt(t),s=t-i.from,n=s>Tm?-1:s==i.length?qB(r,e.clientX):yr(i.text,r.state.tabSize,t-i.from);return{line:i.number,col:n,off:s}}function VB(r,e){let t=vv(r,e),i=r.state.selection;return t?{update(s){if(s.docChanged){let n=s.changes.mapPos(s.startState.doc.line(t.line).from),a=s.state.doc.lineAt(n);t={line:a.number,col:t.col,off:Math.min(t.off,a.length)},i=i.map(s.changes)}},get(s,n,a){let o=vv(r,s);if(!o)return i;let l=UB(r.state,t,o);return l.length?a?ie.create(l.concat(i.ranges)):ie.create(l):i}}:null}function XB(r){let e=(t=>t.altKey&&t.button==0);return ge.mouseSelectionStyle.of((t,i)=>e(i)?VB(t,i):null)}const jB={Alt:[18,r=>!!r.altKey],Control:[17,r=>!!r.ctrlKey],Shift:[16,r=>!!r.shiftKey],Meta:[91,r=>!!r.metaKey]},zB={style:"cursor: crosshair"};function ZB(r={}){let[e,t]=jB[r.key||"Alt"],i=Qt.fromClass(class{constructor(s){this.view=s,this.isDown=!1}set(s){this.isDown!=s&&(this.isDown=s,this.view.update([]))}},{eventObservers:{keydown(s){this.set(s.keyCode==e||t(s))},keyup(s){(s.keyCode==e||!t(s))&&this.set(!1)},mousemove(s){this.set(t(s))}}});return[i,ge.contentAttributes.of(s=>{var n;return!((n=s.plugin(i))===null||n===void 0)&&n.isDown?zB:null})]}const Do="-10000px";class o2{constructor(e,t,i,s){this.facet=t,this.createTooltipView=i,this.removeTooltipView=s,this.input=e.state.facet(t),this.tooltips=this.input.filter(a=>a);let n=null;this.tooltipViews=this.tooltips.map(a=>n=i(a,n))}update(e,t){var i;let s=e.state.facet(this.facet),n=s.filter(l=>l);if(s===this.input){for(let l of this.tooltipViews)l.update&&l.update(e);return!1}let a=[],o=t?[]:null;for(let l=0;l<n.length;l++){let u=n[l],c=-1;if(u){for(let h=0;h<this.tooltips.length;h++){let f=this.tooltips[h];f&&f.create==u.create&&(c=h)}if(c<0)a[l]=this.createTooltipView(u,l?a[l-1]:null),o&&(o[l]=!!u.above);else{let h=a[l]=this.tooltipViews[c];o&&(o[l]=t[c]),h.update&&h.update(e)}}}for(let l of this.tooltipViews)a.indexOf(l)<0&&(this.removeTooltipView(l),(i=l.destroy)===null||i===void 0||i.call(l));return t&&(o.forEach((l,u)=>t[u]=l),t.length=o.length),this.input=s,this.tooltips=n,this.tooltipViews=a,!0}}function WB(r){let e=r.dom.ownerDocument.documentElement;return{top:0,left:0,bottom:e.clientHeight,right:e.clientWidth}}const Mf=be.define({combine:r=>{var e,t,i;return{position:me.ios?"absolute":((e=r.find(s=>s.position))===null||e===void 0?void 0:e.position)||"fixed",parent:((t=r.find(s=>s.parent))===null||t===void 0?void 0:t.parent)||null,tooltipSpace:((i=r.find(s=>s.tooltipSpace))===null||i===void 0?void 0:i.tooltipSpace)||WB}}}),Sv=new WeakMap,a0=Qt.fromClass(class{constructor(r){this.view=r,this.above=[],this.inView=!0,this.madeAbsolute=!1,this.lastTransaction=0,this.measureTimeout=-1;let e=r.state.facet(Mf);this.position=e.position,this.parent=e.parent,this.classes=r.themeClasses,this.createContainer(),this.measureReq={read:this.readMeasure.bind(this),write:this.writeMeasure.bind(this),key:this},this.resizeObserver=typeof ResizeObserver=="function"?new ResizeObserver(()=>this.measureSoon()):null,this.manager=new o2(r,o0,(t,i)=>this.createTooltip(t,i),t=>{this.resizeObserver&&this.resizeObserver.unobserve(t.dom),t.dom.remove()}),this.above=this.manager.tooltips.map(t=>!!t.above),this.intersectionObserver=typeof IntersectionObserver=="function"?new IntersectionObserver(t=>{Date.now()>this.lastTransaction-50&&t.length>0&&t[t.length-1].intersectionRatio<1&&this.measureSoon()},{threshold:[1]}):null,this.observeIntersection(),r.win.addEventListener("resize",this.measureSoon=this.measureSoon.bind(this)),this.maybeMeasure()}createContainer(){this.parent?(this.container=document.createElement("div"),this.container.style.position="relative",this.container.className=this.view.themeClasses,this.parent.appendChild(this.container)):this.container=this.view.dom}observeIntersection(){if(this.intersectionObserver){this.intersectionObserver.disconnect();for(let r of this.manager.tooltipViews)this.intersectionObserver.observe(r.dom)}}measureSoon(){this.measureTimeout<0&&(this.measureTimeout=setTimeout(()=>{this.measureTimeout=-1,this.maybeMeasure()},50))}update(r){r.transactions.length&&(this.lastTransaction=Date.now());let e=this.manager.update(r,this.above);e&&this.observeIntersection();let t=e||r.geometryChanged,i=r.state.facet(Mf);if(i.position!=this.position&&!this.madeAbsolute){this.position=i.position;for(let s of this.manager.tooltipViews)s.dom.style.position=this.position;t=!0}if(i.parent!=this.parent){this.parent&&this.container.remove(),this.parent=i.parent,this.createContainer();for(let s of this.manager.tooltipViews)this.container.appendChild(s.dom);t=!0}else this.parent&&this.view.themeClasses!=this.classes&&(this.classes=this.container.className=this.view.themeClasses);t&&this.maybeMeasure()}createTooltip(r,e){let t=r.create(this.view),i=e?e.dom:null;if(t.dom.classList.add("cm-tooltip"),r.arrow&&!t.dom.querySelector(".cm-tooltip > .cm-tooltip-arrow")){let s=document.createElement("div");s.className="cm-tooltip-arrow",t.dom.appendChild(s)}return t.dom.style.position=this.position,t.dom.style.top=Do,t.dom.style.left="0px",this.container.insertBefore(t.dom,i),t.mount&&t.mount(this.view),this.resizeObserver&&this.resizeObserver.observe(t.dom),t}destroy(){var r,e,t;this.view.win.removeEventListener("resize",this.measureSoon);for(let i of this.manager.tooltipViews)i.dom.remove(),(r=i.destroy)===null||r===void 0||r.call(i);this.parent&&this.container.remove(),(e=this.resizeObserver)===null||e===void 0||e.disconnect(),(t=this.intersectionObserver)===null||t===void 0||t.disconnect(),clearTimeout(this.measureTimeout)}readMeasure(){let r=1,e=1,t=!1;if(this.position=="fixed"&&this.manager.tooltipViews.length){let{dom:n}=this.manager.tooltipViews[0];if(me.gecko)t=n.offsetParent!=this.container.ownerDocument.body;else if(n.style.top==Do&&n.style.left=="0px"){let a=n.getBoundingClientRect();t=Math.abs(a.top+1e4)>1||Math.abs(a.left)>1}}if(t||this.position=="absolute")if(this.parent){let n=this.parent.getBoundingClientRect();n.width&&n.height&&(r=n.width/this.parent.offsetWidth,e=n.height/this.parent.offsetHeight)}else({scaleX:r,scaleY:e}=this.view.viewState);let i=this.view.scrollDOM.getBoundingClientRect(),s=i0(this.view);return{visible:{left:i.left+s.left,top:i.top+s.top,right:i.right-s.right,bottom:i.bottom-s.bottom},parent:this.parent?this.container.getBoundingClientRect():this.view.dom.getBoundingClientRect(),pos:this.manager.tooltips.map((n,a)=>{let o=this.manager.tooltipViews[a];return o.getCoords?o.getCoords(n.pos):this.view.coordsAtPos(n.pos)}),size:this.manager.tooltipViews.map(({dom:n})=>n.getBoundingClientRect()),space:this.view.state.facet(Mf).tooltipSpace(this.view),scaleX:r,scaleY:e,makeAbsolute:t}}writeMeasure(r){var e;if(r.makeAbsolute){this.madeAbsolute=!0,this.position="absolute";for(let o of this.manager.tooltipViews)o.dom.style.position="absolute"}let{visible:t,space:i,scaleX:s,scaleY:n}=r,a=[];for(let o=0;o<this.manager.tooltips.length;o++){let l=this.manager.tooltips[o],u=this.manager.tooltipViews[o],{dom:c}=u,h=r.pos[o],f=r.size[o];if(!h||l.clip!==!1&&(h.bottom<=Math.max(t.top,i.top)||h.top>=Math.min(t.bottom,i.bottom)||h.right<Math.max(t.left,i.left)-.1||h.left>Math.min(t.right,i.right)+.1)){c.style.top=Do;continue}let m=l.arrow?u.dom.querySelector(".cm-tooltip-arrow"):null,S=m?7:0,y=f.right-f.left,E=(e=Sv.get(u))!==null&&e!==void 0?e:f.bottom-f.top,C=u.offset||YB,_=this.view.textDirection==dt.LTR,v=f.width>i.right-i.left?_?i.left:i.right-f.width:_?Math.max(i.left,Math.min(h.left-(m?14:0)+C.x,i.right-y)):Math.min(Math.max(i.left,h.left-y+(m?14:0)-C.x),i.right-y),T=this.above[o];!l.strictSide&&(T?h.top-E-S-C.y<i.top:h.bottom+E+S+C.y>i.bottom)&&T==i.bottom-h.bottom>h.top-i.top&&(T=this.above[o]=!T);let w=(T?h.top-i.top:i.bottom-h.bottom)-S;if(w<E&&u.resize!==!1){if(w<this.view.defaultLineHeight){c.style.top=Do;continue}Sv.set(u,E),c.style.height=(E=w)/n+"px"}else c.style.height&&(c.style.height="");let A=T?h.top-E-S-C.y:h.bottom+S+C.y,I=v+y;if(u.overlap!==!0)for(let N of a)N.left<I&&N.right>v&&N.top<A+E&&N.bottom>A&&(A=T?N.top-E-2-S:N.bottom+S+2);if(this.position=="absolute"?(c.style.top=(A-r.parent.top)/n+"px",Tv(c,(v-r.parent.left)/s)):(c.style.top=A/n+"px",Tv(c,v/s)),m){let N=h.left+(_?C.x:-C.x)-(v+14-7);m.style.left=N/s+"px"}u.overlap!==!0&&a.push({left:v,top:A,right:I,bottom:A+E}),c.classList.toggle("cm-tooltip-above",T),c.classList.toggle("cm-tooltip-below",!T),u.positioned&&u.positioned(r.space)}}maybeMeasure(){if(this.manager.tooltips.length&&(this.view.inView&&this.view.requestMeasure(this.measureReq),this.inView!=this.view.inView&&(this.inView=this.view.inView,!this.inView)))for(let r of this.manager.tooltipViews)r.dom.style.top=Do}},{eventObservers:{scroll(){this.maybeMeasure()}}});function Tv(r,e){let t=parseInt(r.style.left,10);(isNaN(t)||Math.abs(e-t)>1)&&(r.style.left=e+"px")}const HB=ge.baseTheme({".cm-tooltip":{zIndex:500,boxSizing:"border-box"},"&light .cm-tooltip":{border:"1px solid #bbb",backgroundColor:"#f5f5f5"},"&light .cm-tooltip-section:not(:first-child)":{borderTop:"1px solid #bbb"},"&dark .cm-tooltip":{backgroundColor:"#333338",color:"white"},".cm-tooltip-arrow":{height:"7px",width:"14px",position:"absolute",zIndex:-1,overflow:"hidden","&:before, &:after":{content:"''",position:"absolute",width:0,height:0,borderLeft:"7px solid transparent",borderRight:"7px solid transparent"},".cm-tooltip-above &":{bottom:"-7px","&:before":{borderTop:"7px solid #bbb"},"&:after":{borderTop:"7px solid #f5f5f5",bottom:"1px"}},".cm-tooltip-below &":{top:"-7px","&:before":{borderBottom:"7px solid #bbb"},"&:after":{borderBottom:"7px solid #f5f5f5",top:"1px"}}},"&dark .cm-tooltip .cm-tooltip-arrow":{"&:before":{borderTopColor:"#333338",borderBottomColor:"#333338"},"&:after":{borderTopColor:"transparent",borderBottomColor:"transparent"}}}),YB={x:0,y:0},o0=be.define({enables:[a0,HB]}),hh=be.define({combine:r=>r.reduce((e,t)=>e.concat(t),[])});class ud{static create(e){return new ud(e)}constructor(e){this.view=e,this.mounted=!1,this.dom=document.createElement("div"),this.dom.classList.add("cm-tooltip-hover"),this.manager=new o2(e,hh,(t,i)=>this.createHostedView(t,i),t=>t.dom.remove())}createHostedView(e,t){let i=e.create(this.view);return i.dom.classList.add("cm-tooltip-section"),this.dom.insertBefore(i.dom,t?t.dom.nextSibling:this.dom.firstChild),this.mounted&&i.mount&&i.mount(this.view),i}mount(e){for(let t of this.manager.tooltipViews)t.mount&&t.mount(e);this.mounted=!0}positioned(e){for(let t of this.manager.tooltipViews)t.positioned&&t.positioned(e)}update(e){this.manager.update(e)}destroy(){var e;for(let t of this.manager.tooltipViews)(e=t.destroy)===null||e===void 0||e.call(t)}passProp(e){let t;for(let i of this.manager.tooltipViews){let s=i[e];if(s!==void 0){if(t===void 0)t=s;else if(t!==s)return}}return t}get offset(){return this.passProp("offset")}get getCoords(){return this.passProp("getCoords")}get overlap(){return this.passProp("overlap")}get resize(){return this.passProp("resize")}}const GB=o0.compute([hh],r=>{let e=r.facet(hh);return e.length===0?null:{pos:Math.min(...e.map(t=>t.pos)),end:Math.max(...e.map(t=>{var i;return(i=t.end)!==null&&i!==void 0?i:t.pos})),create:ud.create,above:e[0].above,arrow:e.some(t=>t.arrow)}});class KB{constructor(e,t,i,s,n){this.view=e,this.source=t,this.field=i,this.setHover=s,this.hoverTime=n,this.hoverTimeout=-1,this.restartTimeout=-1,this.pending=null,this.lastMove={x:0,y:0,target:e.dom,time:0},this.checkHover=this.checkHover.bind(this),e.dom.addEventListener("mouseleave",this.mouseleave=this.mouseleave.bind(this)),e.dom.addEventListener("mousemove",this.mousemove=this.mousemove.bind(this))}update(){this.pending&&(this.pending=null,clearTimeout(this.restartTimeout),this.restartTimeout=setTimeout(()=>this.startHover(),20))}get active(){return this.view.state.field(this.field)}checkHover(){if(this.hoverTimeout=-1,this.active.length)return;let e=Date.now()-this.lastMove.time;e<this.hoverTime?this.hoverTimeout=setTimeout(this.checkHover,this.hoverTime-e):this.startHover()}startHover(){clearTimeout(this.restartTimeout);let{view:e,lastMove:t}=this,i=e.docView.nearest(t.target);if(!i)return;let s,n=1;if(i instanceof qs)s=i.posAtStart;else{if(s=e.posAtCoords(t),s==null)return;let o=e.coordsAtPos(s);if(!o||t.y<o.top||t.y>o.bottom||t.x<o.left-e.defaultCharacterWidth||t.x>o.right+e.defaultCharacterWidth)return;let l=e.bidiSpans(e.state.doc.lineAt(s)).find(c=>c.from<=s&&c.to>=s),u=l&&l.dir==dt.RTL?-1:1;n=t.x<o.left?-u:u}let a=this.source(e,s,n);if(a?.then){let o=this.pending={pos:s};a.then(l=>{this.pending==o&&(this.pending=null,l&&!(Array.isArray(l)&&!l.length)&&e.dispatch({effects:this.setHover.of(Array.isArray(l)?l:[l])}))},l=>ki(e.state,l,"hover tooltip"))}else a&&!(Array.isArray(a)&&!a.length)&&e.dispatch({effects:this.setHover.of(Array.isArray(a)?a:[a])})}get tooltip(){let e=this.view.plugin(a0),t=e?e.manager.tooltips.findIndex(i=>i.create==ud.create):-1;return t>-1?e.manager.tooltipViews[t]:null}mousemove(e){var t,i;this.lastMove={x:e.clientX,y:e.clientY,target:e.target,time:Date.now()},this.hoverTimeout<0&&(this.hoverTimeout=setTimeout(this.checkHover,this.hoverTime));let{active:s,tooltip:n}=this;if(s.length&&n&&!JB(n.dom,e)||this.pending){let{pos:a}=s[0]||this.pending,o=(i=(t=s[0])===null||t===void 0?void 0:t.end)!==null&&i!==void 0?i:a;(a==o?this.view.posAtCoords(this.lastMove)!=a:!eN(this.view,a,o,e.clientX,e.clientY))&&(this.view.dispatch({effects:this.setHover.of([])}),this.pending=null)}}mouseleave(e){clearTimeout(this.hoverTimeout),this.hoverTimeout=-1;let{active:t}=this;if(t.length){let{tooltip:i}=this;i&&i.dom.contains(e.relatedTarget)?this.watchTooltipLeave(i.dom):this.view.dispatch({effects:this.setHover.of([])})}}watchTooltipLeave(e){let t=i=>{e.removeEventListener("mouseleave",t),this.active.length&&!this.view.dom.contains(i.relatedTarget)&&this.view.dispatch({effects:this.setHover.of([])})};e.addEventListener("mouseleave",t)}destroy(){clearTimeout(this.hoverTimeout),this.view.dom.removeEventListener("mouseleave",this.mouseleave),this.view.dom.removeEventListener("mousemove",this.mousemove)}}const ic=4;function JB(r,e){let{left:t,right:i,top:s,bottom:n}=r.getBoundingClientRect(),a;if(a=r.querySelector(".cm-tooltip-arrow")){let o=a.getBoundingClientRect();s=Math.min(o.top,s),n=Math.max(o.bottom,n)}return e.clientX>=t-ic&&e.clientX<=i+ic&&e.clientY>=s-ic&&e.clientY<=n+ic}function eN(r,e,t,i,s,n){let a=r.scrollDOM.getBoundingClientRect(),o=r.documentTop+r.documentPadding.top+r.contentHeight;if(a.left>i||a.right<i||a.top>s||Math.min(a.bottom,o)<s)return!1;let l=r.posAtCoords({x:i,y:s},!1);return l>=e&&l<=t}function tN(r,e={}){let t=Re.define(),i=jt.define({create(){return[]},update(s,n){if(s.length&&(e.hideOnChange&&(n.docChanged||n.selection)?s=[]:e.hideOn&&(s=s.filter(a=>!e.hideOn(n,a))),n.docChanged)){let a=[];for(let o of s){let l=n.changes.mapPos(o.pos,-1,Yt.TrackDel);if(l!=null){let u=Object.assign(Object.create(null),o);u.pos=l,u.end!=null&&(u.end=n.changes.mapPos(u.end)),a.push(u)}}s=a}for(let a of n.effects)a.is(t)&&(s=a.value),a.is(iN)&&(s=[]);return s},provide:s=>hh.from(s)});return{active:i,extension:[i,Qt.define(s=>new KB(s,r,i,t,e.hoverTime||300)),GB]}}function l2(r,e){let t=r.plugin(a0);if(!t)return null;let i=t.manager.tooltips.indexOf(e);return i<0?null:t.manager.tooltipViews[i]}const iN=Re.define(),_v=be.define({combine(r){let e,t;for(let i of r)e=e||i.topContainer,t=t||i.bottomContainer;return{topContainer:e,bottomContainer:t}}});function wl(r,e){let t=r.plugin(u2),i=t?t.specs.indexOf(e):-1;return i>-1?t.panels[i]:null}const u2=Qt.fromClass(class{constructor(r){this.input=r.state.facet(Cl),this.specs=this.input.filter(t=>t),this.panels=this.specs.map(t=>t(r));let e=r.state.facet(_v);this.top=new rc(r,!0,e.topContainer),this.bottom=new rc(r,!1,e.bottomContainer),this.top.sync(this.panels.filter(t=>t.top)),this.bottom.sync(this.panels.filter(t=>!t.top));for(let t of this.panels)t.dom.classList.add("cm-panel"),t.mount&&t.mount()}update(r){let e=r.state.facet(_v);this.top.container!=e.topContainer&&(this.top.sync([]),this.top=new rc(r.view,!0,e.topContainer)),this.bottom.container!=e.bottomContainer&&(this.bottom.sync([]),this.bottom=new rc(r.view,!1,e.bottomContainer)),this.top.syncClasses(),this.bottom.syncClasses();let t=r.state.facet(Cl);if(t!=this.input){let i=t.filter(l=>l),s=[],n=[],a=[],o=[];for(let l of i){let u=this.specs.indexOf(l),c;u<0?(c=l(r.view),o.push(c)):(c=this.panels[u],c.update&&c.update(r)),s.push(c),(c.top?n:a).push(c)}this.specs=i,this.panels=s,this.top.sync(n),this.bottom.sync(a);for(let l of o)l.dom.classList.add("cm-panel"),l.mount&&l.mount()}else for(let i of this.panels)i.update&&i.update(r)}destroy(){this.top.sync([]),this.bottom.sync([])}},{provide:r=>ge.scrollMargins.of(e=>{let t=e.plugin(r);return t&&{top:t.top.scrollMargin(),bottom:t.bottom.scrollMargin()}})});class rc{constructor(e,t,i){this.view=e,this.top=t,this.container=i,this.dom=void 0,this.classes="",this.panels=[],this.syncClasses()}sync(e){for(let t of this.panels)t.destroy&&e.indexOf(t)<0&&t.destroy();this.panels=e,this.syncDOM()}syncDOM(){if(this.panels.length==0){this.dom&&(this.dom.remove(),this.dom=void 0);return}if(!this.dom){this.dom=document.createElement("div"),this.dom.className=this.top?"cm-panels cm-panels-top":"cm-panels cm-panels-bottom",this.dom.style[this.top?"top":"bottom"]="0";let t=this.container||this.view.dom;t.insertBefore(this.dom,this.top?t.firstChild:null)}let e=this.dom.firstChild;for(let t of this.panels)if(t.dom.parentNode==this.dom){for(;e!=t.dom;)e=xv(e);e=e.nextSibling}else this.dom.insertBefore(t.dom,e);for(;e;)e=xv(e)}scrollMargin(){return!this.dom||this.container?0:Math.max(0,this.top?this.dom.getBoundingClientRect().bottom-Math.max(0,this.view.scrollDOM.getBoundingClientRect().top):Math.min(innerHeight,this.view.scrollDOM.getBoundingClientRect().bottom)-this.dom.getBoundingClientRect().top)}syncClasses(){if(!(!this.container||this.classes==this.view.themeClasses)){for(let e of this.classes.split(" "))e&&this.container.classList.remove(e);for(let e of(this.classes=this.view.themeClasses).split(" "))e&&this.container.classList.add(e)}}}function xv(r){let e=r.nextSibling;return r.remove(),e}const Cl=be.define({enables:u2});class vs extends Rn{compare(e){return this==e||this.constructor==e.constructor&&this.eq(e)}eq(e){return!1}destroy(e){}}vs.prototype.elementClass="";vs.prototype.toDOM=void 0;vs.prototype.mapMode=Yt.TrackBefore;vs.prototype.startSide=vs.prototype.endSide=-1;vs.prototype.point=!0;const wc=be.define(),rN=be.define(),sN={class:"",renderEmptyElements:!1,elementStyle:"",markers:()=>je.empty,lineMarker:()=>null,widgetMarker:()=>null,lineMarkerChange:null,initialSpacer:null,updateSpacer:null,domEventHandlers:{},side:"before"},al=be.define();function nN(r){return[c2(),al.of({...sN,...r})]}const wv=be.define({combine:r=>r.some(e=>e)});function c2(r){return[aN]}const aN=Qt.fromClass(class{constructor(r){this.view=r,this.domAfter=null,this.prevViewport=r.viewport,this.dom=document.createElement("div"),this.dom.className="cm-gutters cm-gutters-before",this.dom.setAttribute("aria-hidden","true"),this.dom.style.minHeight=this.view.contentHeight/this.view.scaleY+"px",this.gutters=r.state.facet(al).map(e=>new kv(r,e)),this.fixed=!r.state.facet(wv);for(let e of this.gutters)e.config.side=="after"?this.getDOMAfter().appendChild(e.dom):this.dom.appendChild(e.dom);this.fixed&&(this.dom.style.position="sticky"),this.syncGutters(!1),r.scrollDOM.insertBefore(this.dom,r.contentDOM)}getDOMAfter(){return this.domAfter||(this.domAfter=document.createElement("div"),this.domAfter.className="cm-gutters cm-gutters-after",this.domAfter.setAttribute("aria-hidden","true"),this.domAfter.style.minHeight=this.view.contentHeight/this.view.scaleY+"px",this.domAfter.style.position=this.fixed?"sticky":"",this.view.scrollDOM.appendChild(this.domAfter)),this.domAfter}update(r){if(this.updateGutters(r)){let e=this.prevViewport,t=r.view.viewport,i=Math.min(e.to,t.to)-Math.max(e.from,t.from);this.syncGutters(i<(t.to-t.from)*.8)}if(r.geometryChanged){let e=this.view.contentHeight/this.view.scaleY+"px";this.dom.style.minHeight=e,this.domAfter&&(this.domAfter.style.minHeight=e)}this.view.state.facet(wv)!=!this.fixed&&(this.fixed=!this.fixed,this.dom.style.position=this.fixed?"sticky":"",this.domAfter&&(this.domAfter.style.position=this.fixed?"sticky":"")),this.prevViewport=r.view.viewport}syncGutters(r){let e=this.dom.nextSibling;r&&(this.dom.remove(),this.domAfter&&this.domAfter.remove());let t=je.iter(this.view.state.facet(wc),this.view.viewport.from),i=[],s=this.gutters.map(n=>new oN(n,this.view.viewport,-this.view.documentPadding.top));for(let n of this.view.viewportLineBlocks)if(i.length&&(i=[]),Array.isArray(n.type)){let a=!0;for(let o of n.type)if(o.type==gi.Text&&a){_m(t,i,o.from);for(let l of s)l.line(this.view,o,i);a=!1}else if(o.widget)for(let l of s)l.widget(this.view,o)}else if(n.type==gi.Text){_m(t,i,n.from);for(let a of s)a.line(this.view,n,i)}else if(n.widget)for(let a of s)a.widget(this.view,n);for(let n of s)n.finish();r&&(this.view.scrollDOM.insertBefore(this.dom,e),this.domAfter&&this.view.scrollDOM.appendChild(this.domAfter))}updateGutters(r){let e=r.startState.facet(al),t=r.state.facet(al),i=r.docChanged||r.heightChanged||r.viewportChanged||!je.eq(r.startState.facet(wc),r.state.facet(wc),r.view.viewport.from,r.view.viewport.to);if(e==t)for(let s of this.gutters)s.update(r)&&(i=!0);else{i=!0;let s=[];for(let n of t){let a=e.indexOf(n);a<0?s.push(new kv(this.view,n)):(this.gutters[a].update(r),s.push(this.gutters[a]))}for(let n of this.gutters)n.dom.remove(),s.indexOf(n)<0&&n.destroy();for(let n of s)n.config.side=="after"?this.getDOMAfter().appendChild(n.dom):this.dom.appendChild(n.dom);this.gutters=s}return i}destroy(){for(let r of this.gutters)r.destroy();this.dom.remove(),this.domAfter&&this.domAfter.remove()}},{provide:r=>ge.scrollMargins.of(e=>{let t=e.plugin(r);if(!t||t.gutters.length==0||!t.fixed)return null;let i=t.dom.offsetWidth*e.scaleX,s=t.domAfter?t.domAfter.offsetWidth*e.scaleX:0;return e.textDirection==dt.LTR?{left:i,right:s}:{right:i,left:s}})});function Cv(r){return Array.isArray(r)?r:[r]}function _m(r,e,t){for(;r.value&&r.from<=t;)r.from==t&&e.push(r.value),r.next()}class oN{constructor(e,t,i){this.gutter=e,this.height=i,this.i=0,this.cursor=je.iter(e.markers,t.from)}addElement(e,t,i){let{gutter:s}=this,n=(t.top-this.height)/e.scaleY,a=t.height/e.scaleY;if(this.i==s.elements.length){let o=new h2(e,a,n,i);s.elements.push(o),s.dom.appendChild(o.dom)}else s.elements[this.i].update(e,a,n,i);this.height=t.bottom,this.i++}line(e,t,i){let s=[];_m(this.cursor,s,t.from),i.length&&(s=s.concat(i));let n=this.gutter.config.lineMarker(e,t,s);n&&s.unshift(n);let a=this.gutter;s.length==0&&!a.config.renderEmptyElements||this.addElement(e,t,s)}widget(e,t){let i=this.gutter.config.widgetMarker(e,t.widget,t),s=i?[i]:null;for(let n of e.state.facet(rN)){let a=n(e,t.widget,t);a&&(s||(s=[])).push(a)}s&&this.addElement(e,t,s)}finish(){let e=this.gutter;for(;e.elements.length>this.i;){let t=e.elements.pop();e.dom.removeChild(t.dom),t.destroy()}}}class kv{constructor(e,t){this.view=e,this.config=t,this.elements=[],this.spacer=null,this.dom=document.createElement("div"),this.dom.className="cm-gutter"+(this.config.class?" "+this.config.class:"");for(let i in t.domEventHandlers)this.dom.addEventListener(i,s=>{let n=s.target,a;if(n!=this.dom&&this.dom.contains(n)){for(;n.parentNode!=this.dom;)n=n.parentNode;let l=n.getBoundingClientRect();a=(l.top+l.bottom)/2}else a=s.clientY;let o=e.lineBlockAtHeight(a-e.documentTop);t.domEventHandlers[i](e,o,s)&&s.preventDefault()});this.markers=Cv(t.markers(e)),t.initialSpacer&&(this.spacer=new h2(e,0,0,[t.initialSpacer(e)]),this.dom.appendChild(this.spacer.dom),this.spacer.dom.style.cssText+="visibility: hidden; pointer-events: none")}update(e){let t=this.markers;if(this.markers=Cv(this.config.markers(e.view)),this.spacer&&this.config.updateSpacer){let s=this.config.updateSpacer(this.spacer.markers[0],e);s!=this.spacer.markers[0]&&this.spacer.update(e.view,0,0,[s])}let i=e.view.viewport;return!je.eq(this.markers,t,i.from,i.to)||(this.config.lineMarkerChange?this.config.lineMarkerChange(e):!1)}destroy(){for(let e of this.elements)e.destroy()}}class h2{constructor(e,t,i,s){this.height=-1,this.above=0,this.markers=[],this.dom=document.createElement("div"),this.dom.className="cm-gutterElement",this.update(e,t,i,s)}update(e,t,i,s){this.height!=t&&(this.height=t,this.dom.style.height=t+"px"),this.above!=i&&(this.dom.style.marginTop=(this.above=i)?i+"px":""),lN(this.markers,s)||this.setMarkers(e,s)}setMarkers(e,t){let i="cm-gutterElement",s=this.dom.firstChild;for(let n=0,a=0;;){let o=a,l=n<t.length?t[n++]:null,u=!1;if(l){let c=l.elementClass;c&&(i+=" "+c);for(let h=a;h<this.markers.length;h++)if(this.markers[h].compare(l)){o=h,u=!0;break}}else o=this.markers.length;for(;a<o;){let c=this.markers[a++];if(c.toDOM){c.destroy(s);let h=s.nextSibling;s.remove(),s=h}}if(!l)break;l.toDOM&&(u?s=s.nextSibling:this.dom.insertBefore(l.toDOM(e),s)),u&&a++}this.dom.className=i,this.markers=t}destroy(){this.setMarkers(null,[])}}function lN(r,e){if(r.length!=e.length)return!1;for(let t=0;t<r.length;t++)if(!r[t].compare(e[t]))return!1;return!0}const uN=be.define(),cN=be.define(),aa=be.define({combine(r){return Gr(r,{formatNumber:String,domEventHandlers:{}},{domEventHandlers(e,t){let i=Object.assign({},e);for(let s in t){let n=i[s],a=t[s];i[s]=n?(o,l,u)=>n(o,l,u)||a(o,l,u):a}return i}})}});class If extends vs{constructor(e){super(),this.number=e}eq(e){return this.number==e.number}toDOM(){return document.createTextNode(this.number)}}function Rf(r,e){return r.state.facet(aa).formatNumber(e,r.state)}const hN=al.compute([aa],r=>({class:"cm-lineNumbers",renderEmptyElements:!1,markers(e){return e.state.facet(uN)},lineMarker(e,t,i){return i.some(s=>s.toDOM)?null:new If(Rf(e,e.state.doc.lineAt(t.from).number))},widgetMarker:(e,t,i)=>{for(let s of e.state.facet(cN)){let n=s(e,t,i);if(n)return n}return null},lineMarkerChange:e=>e.startState.facet(aa)!=e.state.facet(aa),initialSpacer(e){return new If(Rf(e,Ev(e.state.doc.lines)))},updateSpacer(e,t){let i=Rf(t.view,Ev(t.view.state.doc.lines));return i==e.number?e:new If(i)},domEventHandlers:r.facet(aa).domEventHandlers,side:"before"}));function dN(r={}){return[aa.of(r),c2(),hN]}function Ev(r){let e=9;for(;e<r;)e=e*10+9;return e}const fN=new class extends vs{constructor(){super(...arguments),this.elementClass="cm-activeLineGutter"}},pN=wc.compute(["selection"],r=>{let e=[],t=-1;for(let i of r.selection.ranges){let s=r.doc.lineAt(i.head).from;s>t&&(t=s,e.push(fN.range(s)))}return je.of(e)});function mN(){return pN}const d2=1024;let gN=0;class Gi{constructor(e,t){this.from=e,this.to=t}}class Ie{constructor(e={}){this.id=gN++,this.perNode=!!e.perNode,this.deserialize=e.deserialize||(()=>{throw new Error("This node type doesn't define a deserialize function")})}add(e){if(this.perNode)throw new RangeError("Can't add per-node props to node types");return typeof e!="function"&&(e=Bt.match(e)),t=>{let i=e(t);return i===void 0?null:[this,i]}}}Ie.closedBy=new Ie({deserialize:r=>r.split(" ")});Ie.openedBy=new Ie({deserialize:r=>r.split(" ")});Ie.group=new Ie({deserialize:r=>r.split(" ")});Ie.isolate=new Ie({deserialize:r=>{if(r&&r!="rtl"&&r!="ltr"&&r!="auto")throw new RangeError("Invalid value for isolate: "+r);return r||"auto"}});Ie.contextHash=new Ie({perNode:!0});Ie.lookAhead=new Ie({perNode:!0});Ie.mounted=new Ie({perNode:!0});class kl{constructor(e,t,i){this.tree=e,this.overlay=t,this.parser=i}static get(e){return e&&e.props&&e.props[Ie.mounted.id]}}const ON=Object.create(null);class Bt{constructor(e,t,i,s=0){this.name=e,this.props=t,this.id=i,this.flags=s}static define(e){let t=e.props&&e.props.length?Object.create(null):ON,i=(e.top?1:0)|(e.skipped?2:0)|(e.error?4:0)|(e.name==null?8:0),s=new Bt(e.name||"",t,e.id,i);if(e.props){for(let n of e.props)if(Array.isArray(n)||(n=n(s)),n){if(n[0].perNode)throw new RangeError("Can't store a per-node prop on a node type");t[n[0].id]=n[1]}}return s}prop(e){return this.props[e.id]}get isTop(){return(this.flags&1)>0}get isSkipped(){return(this.flags&2)>0}get isError(){return(this.flags&4)>0}get isAnonymous(){return(this.flags&8)>0}is(e){if(typeof e=="string"){if(this.name==e)return!0;let t=this.prop(Ie.group);return t?t.indexOf(e)>-1:!1}return this.id==e}static match(e){let t=Object.create(null);for(let i in e)for(let s of i.split(" "))t[s]=e[i];return i=>{for(let s=i.prop(Ie.group),n=-1;n<(s?s.length:0);n++){let a=t[n<0?i.name:s[n]];if(a)return a}}}}Bt.none=new Bt("",Object.create(null),0,8);class ru{constructor(e){this.types=e;for(let t=0;t<e.length;t++)if(e[t].id!=t)throw new RangeError("Node type ids should correspond to array positions when creating a node set")}extend(...e){let t=[];for(let i of this.types){let s=null;for(let n of e){let a=n(i);a&&(s||(s=Object.assign({},i.props)),s[a[0].id]=a[1])}t.push(s?new Bt(i.name,s,i.id,i.flags):i)}return new ru(t)}}const sc=new WeakMap,Av=new WeakMap;var lt;(function(r){r[r.ExcludeBuffers=1]="ExcludeBuffers",r[r.IncludeAnonymous=2]="IncludeAnonymous",r[r.IgnoreMounts=4]="IgnoreMounts",r[r.IgnoreOverlays=8]="IgnoreOverlays"})(lt||(lt={}));class He{constructor(e,t,i,s,n){if(this.type=e,this.children=t,this.positions=i,this.length=s,this.props=null,n&&n.length){this.props=Object.create(null);for(let[a,o]of n)this.props[typeof a=="number"?a:a.id]=o}}toString(){let e=kl.get(this);if(e&&!e.overlay)return e.tree.toString();let t="";for(let i of this.children){let s=i.toString();s&&(t&&(t+=","),t+=s)}return this.type.name?(/\W/.test(this.type.name)&&!this.type.isError?JSON.stringify(this.type.name):this.type.name)+(t.length?"("+t+")":""):t}cursor(e=0){return new dh(this.topNode,e)}cursorAt(e,t=0,i=0){let s=sc.get(this)||this.topNode,n=new dh(s);return n.moveTo(e,t),sc.set(this,n._tree),n}get topNode(){return new oi(this,0,0,null)}resolve(e,t=0){let i=El(sc.get(this)||this.topNode,e,t,!1);return sc.set(this,i),i}resolveInner(e,t=0){let i=El(Av.get(this)||this.topNode,e,t,!0);return Av.set(this,i),i}resolveStack(e,t=0){return vN(this,e,t)}iterate(e){let{enter:t,leave:i,from:s=0,to:n=this.length}=e,a=e.mode||0,o=(a&lt.IncludeAnonymous)>0;for(let l=this.cursor(a|lt.IncludeAnonymous);;){let u=!1;if(l.from<=n&&l.to>=s&&(!o&&l.type.isAnonymous||t(l)!==!1)){if(l.firstChild())continue;u=!0}for(;u&&i&&(o||!l.type.isAnonymous)&&i(l),!l.nextSibling();){if(!l.parent())return;u=!0}}}prop(e){return e.perNode?this.props?this.props[e.id]:void 0:this.type.prop(e)}get propValues(){let e=[];if(this.props)for(let t in this.props)e.push([+t,this.props[t]]);return e}balance(e={}){return this.children.length<=8?this:c0(Bt.none,this.children,this.positions,0,this.children.length,0,this.length,(t,i,s)=>new He(this.type,t,i,s,this.propValues),e.makeTree||((t,i,s)=>new He(Bt.none,t,i,s)))}static build(e){return SN(e)}}He.empty=new He(Bt.none,[],[],0);class l0{constructor(e,t){this.buffer=e,this.index=t}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}get pos(){return this.index}next(){this.index-=4}fork(){return new l0(this.buffer,this.index)}}class Gs{constructor(e,t,i){this.buffer=e,this.length=t,this.set=i}get type(){return Bt.none}toString(){let e=[];for(let t=0;t<this.buffer.length;)e.push(this.childString(t)),t=this.buffer[t+3];return e.join(",")}childString(e){let t=this.buffer[e],i=this.buffer[e+3],s=this.set.types[t],n=s.name;if(/\W/.test(n)&&!s.isError&&(n=JSON.stringify(n)),e+=4,i==e)return n;let a=[];for(;e<i;)a.push(this.childString(e)),e=this.buffer[e+3];return n+"("+a.join(",")+")"}findChild(e,t,i,s,n){let{buffer:a}=this,o=-1;for(let l=e;l!=t&&!(f2(n,s,a[l+1],a[l+2])&&(o=l,i>0));l=a[l+3]);return o}slice(e,t,i){let s=this.buffer,n=new Uint16Array(t-e),a=0;for(let o=e,l=0;o<t;){n[l++]=s[o++],n[l++]=s[o++]-i;let u=n[l++]=s[o++]-i;n[l++]=s[o++]-e,a=Math.max(a,u)}return new Gs(n,a,this.set)}}function f2(r,e,t,i){switch(r){case-2:return t<e;case-1:return i>=e&&t<e;case 0:return t<e&&i>e;case 1:return t<=e&&i>e;case 2:return i>e;case 4:return!0}}function El(r,e,t,i){for(var s;r.from==r.to||(t<1?r.from>=e:r.from>e)||(t>-1?r.to<=e:r.to<e);){let a=!i&&r instanceof oi&&r.index<0?null:r.parent;if(!a)return r;r=a}let n=i?0:lt.IgnoreOverlays;if(i)for(let a=r,o=a.parent;o;a=o,o=a.parent)a instanceof oi&&a.index<0&&((s=o.enter(e,t,n))===null||s===void 0?void 0:s.from)!=a.from&&(r=o);for(;;){let a=r.enter(e,t,n);if(!a)return r;r=a}}class p2{cursor(e=0){return new dh(this,e)}getChild(e,t=null,i=null){let s=Pv(this,e,t,i);return s.length?s[0]:null}getChildren(e,t=null,i=null){return Pv(this,e,t,i)}resolve(e,t=0){return El(this,e,t,!1)}resolveInner(e,t=0){return El(this,e,t,!0)}matchContext(e){return xm(this.parent,e)}enterUnfinishedNodesBefore(e){let t=this.childBefore(e),i=this;for(;t;){let s=t.lastChild;if(!s||s.to!=t.to)break;s.type.isError&&s.from==s.to?(i=t,t=s.prevSibling):t=s}return i}get node(){return this}get next(){return this.parent}}class oi extends p2{constructor(e,t,i,s){super(),this._tree=e,this.from=t,this.index=i,this._parent=s}get type(){return this._tree.type}get name(){return this._tree.type.name}get to(){return this.from+this._tree.length}nextChild(e,t,i,s,n=0){for(let a=this;;){for(let{children:o,positions:l}=a._tree,u=t>0?o.length:-1;e!=u;e+=t){let c=o[e],h=l[e]+a.from;if(f2(s,i,h,h+c.length)){if(c instanceof Gs){if(n&lt.ExcludeBuffers)continue;let f=c.findChild(0,c.buffer.length,t,i-h,s);if(f>-1)return new qr(new yN(a,c,e,h),null,f)}else if(n&lt.IncludeAnonymous||!c.type.isAnonymous||u0(c)){let f;if(!(n&lt.IgnoreMounts)&&(f=kl.get(c))&&!f.overlay)return new oi(f.tree,h,e,a);let m=new oi(c,h,e,a);return n&lt.IncludeAnonymous||!m.type.isAnonymous?m:m.nextChild(t<0?c.children.length-1:0,t,i,s)}}}if(n&lt.IncludeAnonymous||!a.type.isAnonymous||(a.index>=0?e=a.index+t:e=t<0?-1:a._parent._tree.children.length,a=a._parent,!a))return null}}get firstChild(){return this.nextChild(0,1,0,4)}get lastChild(){return this.nextChild(this._tree.children.length-1,-1,0,4)}childAfter(e){return this.nextChild(0,1,e,2)}childBefore(e){return this.nextChild(this._tree.children.length-1,-1,e,-2)}enter(e,t,i=0){let s;if(!(i&lt.IgnoreOverlays)&&(s=kl.get(this._tree))&&s.overlay){let n=e-this.from;for(let{from:a,to:o}of s.overlay)if((t>0?a<=n:a<n)&&(t<0?o>=n:o>n))return new oi(s.tree,s.overlay[0].from+this.from,-1,this)}return this.nextChild(0,1,e,t,i)}nextSignificantParent(){let e=this;for(;e.type.isAnonymous&&e._parent;)e=e._parent;return e}get parent(){return this._parent?this._parent.nextSignificantParent():null}get nextSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index+1,1,0,4):null}get prevSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index-1,-1,0,4):null}get tree(){return this._tree}toTree(){return this._tree}toString(){return this._tree.toString()}}function Pv(r,e,t,i){let s=r.cursor(),n=[];if(!s.firstChild())return n;if(t!=null){for(let a=!1;!a;)if(a=s.type.is(t),!s.nextSibling())return n}for(;;){if(i!=null&&s.type.is(i))return n;if(s.type.is(e)&&n.push(s.node),!s.nextSibling())return i==null?n:[]}}function xm(r,e,t=e.length-1){for(let i=r;t>=0;i=i.parent){if(!i)return!1;if(!i.type.isAnonymous){if(e[t]&&e[t]!=i.name)return!1;t--}}return!0}class yN{constructor(e,t,i,s){this.parent=e,this.buffer=t,this.index=i,this.start=s}}class qr extends p2{get name(){return this.type.name}get from(){return this.context.start+this.context.buffer.buffer[this.index+1]}get to(){return this.context.start+this.context.buffer.buffer[this.index+2]}constructor(e,t,i){super(),this.context=e,this._parent=t,this.index=i,this.type=e.buffer.set.types[e.buffer.buffer[i]]}child(e,t,i){let{buffer:s}=this.context,n=s.findChild(this.index+4,s.buffer[this.index+3],e,t-this.context.start,i);return n<0?null:new qr(this.context,this,n)}get firstChild(){return this.child(1,0,4)}get lastChild(){return this.child(-1,0,4)}childAfter(e){return this.child(1,e,2)}childBefore(e){return this.child(-1,e,-2)}enter(e,t,i=0){if(i&lt.ExcludeBuffers)return null;let{buffer:s}=this.context,n=s.findChild(this.index+4,s.buffer[this.index+3],t>0?1:-1,e-this.context.start,t);return n<0?null:new qr(this.context,this,n)}get parent(){return this._parent||this.context.parent.nextSignificantParent()}externalSibling(e){return this._parent?null:this.context.parent.nextChild(this.context.index+e,e,0,4)}get nextSibling(){let{buffer:e}=this.context,t=e.buffer[this.index+3];return t<(this._parent?e.buffer[this._parent.index+3]:e.buffer.length)?new qr(this.context,this._parent,t):this.externalSibling(1)}get prevSibling(){let{buffer:e}=this.context,t=this._parent?this._parent.index+4:0;return this.index==t?this.externalSibling(-1):new qr(this.context,this._parent,e.findChild(t,this.index,-1,0,4))}get tree(){return null}toTree(){let e=[],t=[],{buffer:i}=this.context,s=this.index+4,n=i.buffer[this.index+3];if(n>s){let a=i.buffer[this.index+1];e.push(i.slice(s,n,a)),t.push(0)}return new He(this.type,e,t,this.to-this.from)}toString(){return this.context.buffer.childString(this.index)}}function m2(r){if(!r.length)return null;let e=0,t=r[0];for(let n=1;n<r.length;n++){let a=r[n];(a.from>t.from||a.to<t.to)&&(t=a,e=n)}let i=t instanceof oi&&t.index<0?null:t.parent,s=r.slice();return i?s[e]=i:s.splice(e,1),new bN(s,t)}class bN{constructor(e,t){this.heads=e,this.node=t}get next(){return m2(this.heads)}}function vN(r,e,t){let i=r.resolveInner(e,t),s=null;for(let n=i instanceof oi?i:i.context.parent;n;n=n.parent)if(n.index<0){let a=n.parent;(s||(s=[i])).push(a.resolve(e,t)),n=a}else{let a=kl.get(n.tree);if(a&&a.overlay&&a.overlay[0].from<=e&&a.overlay[a.overlay.length-1].to>=e){let o=new oi(a.tree,a.overlay[0].from+n.from,-1,n);(s||(s=[i])).push(El(o,e,t,!1))}}return s?m2(s):i}class dh{get name(){return this.type.name}constructor(e,t=0){if(this.mode=t,this.buffer=null,this.stack=[],this.index=0,this.bufferNode=null,e instanceof oi)this.yieldNode(e);else{this._tree=e.context.parent,this.buffer=e.context;for(let i=e._parent;i;i=i._parent)this.stack.unshift(i.index);this.bufferNode=e,this.yieldBuf(e.index)}}yieldNode(e){return e?(this._tree=e,this.type=e.type,this.from=e.from,this.to=e.to,!0):!1}yieldBuf(e,t){this.index=e;let{start:i,buffer:s}=this.buffer;return this.type=t||s.set.types[s.buffer[e]],this.from=i+s.buffer[e+1],this.to=i+s.buffer[e+2],!0}yield(e){return e?e instanceof oi?(this.buffer=null,this.yieldNode(e)):(this.buffer=e.context,this.yieldBuf(e.index,e.type)):!1}toString(){return this.buffer?this.buffer.buffer.childString(this.index):this._tree.toString()}enterChild(e,t,i){if(!this.buffer)return this.yield(this._tree.nextChild(e<0?this._tree._tree.children.length-1:0,e,t,i,this.mode));let{buffer:s}=this.buffer,n=s.findChild(this.index+4,s.buffer[this.index+3],e,t-this.buffer.start,i);return n<0?!1:(this.stack.push(this.index),this.yieldBuf(n))}firstChild(){return this.enterChild(1,0,4)}lastChild(){return this.enterChild(-1,0,4)}childAfter(e){return this.enterChild(1,e,2)}childBefore(e){return this.enterChild(-1,e,-2)}enter(e,t,i=this.mode){return this.buffer?i&lt.ExcludeBuffers?!1:this.enterChild(1,e,t):this.yield(this._tree.enter(e,t,i))}parent(){if(!this.buffer)return this.yieldNode(this.mode&lt.IncludeAnonymous?this._tree._parent:this._tree.parent);if(this.stack.length)return this.yieldBuf(this.stack.pop());let e=this.mode&lt.IncludeAnonymous?this.buffer.parent:this.buffer.parent.nextSignificantParent();return this.buffer=null,this.yieldNode(e)}sibling(e){if(!this.buffer)return this._tree._parent?this.yield(this._tree.index<0?null:this._tree._parent.nextChild(this._tree.index+e,e,0,4,this.mode)):!1;let{buffer:t}=this.buffer,i=this.stack.length-1;if(e<0){let s=i<0?0:this.stack[i]+4;if(this.index!=s)return this.yieldBuf(t.findChild(s,this.index,-1,0,4))}else{let s=t.buffer[this.index+3];if(s<(i<0?t.buffer.length:t.buffer[this.stack[i]+3]))return this.yieldBuf(s)}return i<0?this.yield(this.buffer.parent.nextChild(this.buffer.index+e,e,0,4,this.mode)):!1}nextSibling(){return this.sibling(1)}prevSibling(){return this.sibling(-1)}atLastNode(e){let t,i,{buffer:s}=this;if(s){if(e>0){if(this.index<s.buffer.buffer.length)return!1}else for(let n=0;n<this.index;n++)if(s.buffer.buffer[n+3]<this.index)return!1;({index:t,parent:i}=s)}else({index:t,_parent:i}=this._tree);for(;i;{index:t,_parent:i}=i)if(t>-1)for(let n=t+e,a=e<0?-1:i._tree.children.length;n!=a;n+=e){let o=i._tree.children[n];if(this.mode&lt.IncludeAnonymous||o instanceof Gs||!o.type.isAnonymous||u0(o))return!1}return!0}move(e,t){if(t&&this.enterChild(e,0,4))return!0;for(;;){if(this.sibling(e))return!0;if(this.atLastNode(e)||!this.parent())return!1}}next(e=!0){return this.move(1,e)}prev(e=!0){return this.move(-1,e)}moveTo(e,t=0){for(;(this.from==this.to||(t<1?this.from>=e:this.from>e)||(t>-1?this.to<=e:this.to<e))&&this.parent(););for(;this.enterChild(1,e,t););return this}get node(){if(!this.buffer)return this._tree;let e=this.bufferNode,t=null,i=0;if(e&&e.context==this.buffer)e:for(let s=this.index,n=this.stack.length;n>=0;){for(let a=e;a;a=a._parent)if(a.index==s){if(s==this.index)return a;t=a,i=n+1;break e}s=this.stack[--n]}for(let s=i;s<this.stack.length;s++)t=new qr(this.buffer,t,this.stack[s]);return this.bufferNode=new qr(this.buffer,t,this.index)}get tree(){return this.buffer?null:this._tree._tree}iterate(e,t){for(let i=0;;){let s=!1;if(this.type.isAnonymous||e(this)!==!1){if(this.firstChild()){i++;continue}this.type.isAnonymous||(s=!0)}for(;;){if(s&&t&&t(this),s=this.type.isAnonymous,!i)return;if(this.nextSibling())break;this.parent(),i--,s=!0}}}matchContext(e){if(!this.buffer)return xm(this.node.parent,e);let{buffer:t}=this.buffer,{types:i}=t.set;for(let s=e.length-1,n=this.stack.length-1;s>=0;n--){if(n<0)return xm(this._tree,e,s);let a=i[t.buffer[this.stack[n]]];if(!a.isAnonymous){if(e[s]&&e[s]!=a.name)return!1;s--}}return!0}}function u0(r){return r.children.some(e=>e instanceof Gs||!e.type.isAnonymous||u0(e))}function SN(r){var e;let{buffer:t,nodeSet:i,maxBufferLength:s=d2,reused:n=[],minRepeatType:a=i.types.length}=r,o=Array.isArray(t)?new l0(t,t.length):t,l=i.types,u=0,c=0;function h(w,A,I,N,P,R){let{id:X,start:j,end:Z,size:Y}=o,te=c,le=u;for(;Y<0;)if(o.next(),Y==-1){let ae=n[X];I.push(ae),N.push(j-w);return}else if(Y==-3){u=X;return}else if(Y==-4){c=X;return}else throw new RangeError(`Unrecognized record size: ${Y}`);let G=l[X],re,J,ne=j-w;if(Z-j<=s&&(J=E(o.pos-A,P))){let ae=new Uint16Array(J.size-J.skip),ve=o.pos-J.size,xe=ae.length;for(;o.pos>ve;)xe=C(J.start,ae,xe);re=new Gs(ae,Z-J.start,i),ne=J.start-w}else{let ae=o.pos-Y;o.next();let ve=[],xe=[],Pe=X>=a?X:-1,Se=0,at=Z;for(;o.pos>ae;)Pe>=0&&o.id==Pe&&o.size>=0?(o.end<=at-s&&(S(ve,xe,j,Se,o.end,at,Pe,te,le),Se=ve.length,at=o.end),o.next()):R>2500?f(j,ae,ve,xe):h(j,ae,ve,xe,Pe,R+1);if(Pe>=0&&Se>0&&Se<ve.length&&S(ve,xe,j,Se,j,at,Pe,te,le),ve.reverse(),xe.reverse(),Pe>-1&&Se>0){let ft=m(G,le);re=c0(G,ve,xe,0,ve.length,0,Z-j,ft,ft)}else re=y(G,ve,xe,Z-j,te-Z,le)}I.push(re),N.push(ne)}function f(w,A,I,N){let P=[],R=0,X=-1;for(;o.pos>A;){let{id:j,start:Z,end:Y,size:te}=o;if(te>4)o.next();else{if(X>-1&&Z<X)break;X<0&&(X=Y-s),P.push(j,Z,Y),R++,o.next()}}if(R){let j=new Uint16Array(R*4),Z=P[P.length-2];for(let Y=P.length-3,te=0;Y>=0;Y-=3)j[te++]=P[Y],j[te++]=P[Y+1]-Z,j[te++]=P[Y+2]-Z,j[te++]=te;I.push(new Gs(j,P[2]-Z,i)),N.push(Z-w)}}function m(w,A){return(I,N,P)=>{let R=0,X=I.length-1,j,Z;if(X>=0&&(j=I[X])instanceof He){if(!X&&j.type==w&&j.length==P)return j;(Z=j.prop(Ie.lookAhead))&&(R=N[X]+j.length+Z)}return y(w,I,N,P,R,A)}}function S(w,A,I,N,P,R,X,j,Z){let Y=[],te=[];for(;w.length>N;)Y.push(w.pop()),te.push(A.pop()+I-P);w.push(y(i.types[X],Y,te,R-P,j-R,Z)),A.push(P-I)}function y(w,A,I,N,P,R,X){if(R){let j=[Ie.contextHash,R];X=X?[j].concat(X):[j]}if(P>25){let j=[Ie.lookAhead,P];X=X?[j].concat(X):[j]}return new He(w,A,I,N,X)}function E(w,A){let I=o.fork(),N=0,P=0,R=0,X=I.end-s,j={size:0,start:0,skip:0};e:for(let Z=I.pos-w;I.pos>Z;){let Y=I.size;if(I.id==A&&Y>=0){j.size=N,j.start=P,j.skip=R,R+=4,N+=4,I.next();continue}let te=I.pos-Y;if(Y<0||te<Z||I.start<X)break;let le=I.id>=a?4:0,G=I.start;for(I.next();I.pos>te;){if(I.size<0)if(I.size==-3)le+=4;else break e;else I.id>=a&&(le+=4);I.next()}P=G,N+=Y,R+=le}return(A<0||N==w)&&(j.size=N,j.start=P,j.skip=R),j.size>4?j:void 0}function C(w,A,I){let{id:N,start:P,end:R,size:X}=o;if(o.next(),X>=0&&N<a){let j=I;if(X>4){let Z=o.pos-(X-4);for(;o.pos>Z;)I=C(w,A,I)}A[--I]=j,A[--I]=R-w,A[--I]=P-w,A[--I]=N}else X==-3?u=N:X==-4&&(c=N);return I}let _=[],v=[];for(;o.pos>0;)h(r.start||0,r.bufferStart||0,_,v,-1,0);let T=(e=r.length)!==null&&e!==void 0?e:_.length?v[0]+_[0].length:0;return new He(l[r.topID],_.reverse(),v.reverse(),T)}const Dv=new WeakMap;function Cc(r,e){if(!r.isAnonymous||e instanceof Gs||e.type!=r)return 1;let t=Dv.get(e);if(t==null){t=1;for(let i of e.children){if(i.type!=r||!(i instanceof He)){t=1;break}t+=Cc(r,i)}Dv.set(e,t)}return t}function c0(r,e,t,i,s,n,a,o,l){let u=0;for(let S=i;S<s;S++)u+=Cc(r,e[S]);let c=Math.ceil(u*1.5/8),h=[],f=[];function m(S,y,E,C,_){for(let v=E;v<C;){let T=v,w=y[v],A=Cc(r,S[v]);for(v++;v<C;v++){let I=Cc(r,S[v]);if(A+I>=c)break;A+=I}if(v==T+1){if(A>c){let I=S[T];m(I.children,I.positions,0,I.children.length,y[T]+_);continue}h.push(S[T])}else{let I=y[v-1]+S[v-1].length-w;h.push(c0(r,S,y,T,v,w,I,null,l))}f.push(w+_-n)}}return m(e,t,i,s,0),(o||l)(h,f,a)}class g2{constructor(){this.map=new WeakMap}setBuffer(e,t,i){let s=this.map.get(e);s||this.map.set(e,s=new Map),s.set(t,i)}getBuffer(e,t){let i=this.map.get(e);return i&&i.get(t)}set(e,t){e instanceof qr?this.setBuffer(e.context.buffer,e.index,t):e instanceof oi&&this.map.set(e.tree,t)}get(e){return e instanceof qr?this.getBuffer(e.context.buffer,e.index):e instanceof oi?this.map.get(e.tree):void 0}cursorSet(e,t){e.buffer?this.setBuffer(e.buffer.buffer,e.index,t):this.map.set(e.tree,t)}cursorGet(e){return e.buffer?this.getBuffer(e.buffer.buffer,e.index):this.map.get(e.tree)}}class gs{constructor(e,t,i,s,n=!1,a=!1){this.from=e,this.to=t,this.tree=i,this.offset=s,this.open=(n?1:0)|(a?2:0)}get openStart(){return(this.open&1)>0}get openEnd(){return(this.open&2)>0}static addTree(e,t=[],i=!1){let s=[new gs(0,e.length,e,0,!1,i)];for(let n of t)n.to>e.length&&s.push(n);return s}static applyChanges(e,t,i=128){if(!t.length)return e;let s=[],n=1,a=e.length?e[0]:null;for(let o=0,l=0,u=0;;o++){let c=o<t.length?t[o]:null,h=c?c.fromA:1e9;if(h-l>=i)for(;a&&a.from<h;){let f=a;if(l>=f.from||h<=f.to||u){let m=Math.max(f.from,l)-u,S=Math.min(f.to,h)-u;f=m>=S?null:new gs(m,S,f.tree,f.offset+u,o>0,!!c)}if(f&&s.push(f),a.to>h)break;a=n<e.length?e[n++]:null}if(!c)break;l=c.toA,u=c.toA-c.toB}return s}}class h0{startParse(e,t,i){return typeof e=="string"&&(e=new TN(e)),i=i?i.length?i.map(s=>new Gi(s.from,s.to)):[new Gi(0,0)]:[new Gi(0,e.length)],this.createParse(e,t||[],i)}parse(e,t,i){let s=this.startParse(e,t,i);for(;;){let n=s.advance();if(n)return n}}}class TN{constructor(e){this.string=e}get length(){return this.string.length}chunk(e){return this.string.slice(e)}get lineChunks(){return!1}read(e,t){return this.string.slice(e,t)}}function O2(r){return(e,t,i,s)=>new xN(e,r,t,i,s)}class Mv{constructor(e,t,i,s,n){this.parser=e,this.parse=t,this.overlay=i,this.target=s,this.from=n}}function Iv(r){if(!r.length||r.some(e=>e.from>=e.to))throw new RangeError("Invalid inner parse ranges given: "+JSON.stringify(r))}class _N{constructor(e,t,i,s,n,a,o){this.parser=e,this.predicate=t,this.mounts=i,this.index=s,this.start=n,this.target=a,this.prev=o,this.depth=0,this.ranges=[]}}const wm=new Ie({perNode:!0});class xN{constructor(e,t,i,s,n){this.nest=t,this.input=i,this.fragments=s,this.ranges=n,this.inner=[],this.innerDone=0,this.baseTree=null,this.stoppedAt=null,this.baseParse=e}advance(){if(this.baseParse){let i=this.baseParse.advance();if(!i)return null;if(this.baseParse=null,this.baseTree=i,this.startInner(),this.stoppedAt!=null)for(let s of this.inner)s.parse.stopAt(this.stoppedAt)}if(this.innerDone==this.inner.length){let i=this.baseTree;return this.stoppedAt!=null&&(i=new He(i.type,i.children,i.positions,i.length,i.propValues.concat([[wm,this.stoppedAt]]))),i}let e=this.inner[this.innerDone],t=e.parse.advance();if(t){this.innerDone++;let i=Object.assign(Object.create(null),e.target.props);i[Ie.mounted.id]=new kl(t,e.overlay,e.parser),e.target.props=i}return null}get parsedPos(){if(this.baseParse)return 0;let e=this.input.length;for(let t=this.innerDone;t<this.inner.length;t++)this.inner[t].from<e&&(e=Math.min(e,this.inner[t].parse.parsedPos));return e}stopAt(e){if(this.stoppedAt=e,this.baseParse)this.baseParse.stopAt(e);else for(let t=this.innerDone;t<this.inner.length;t++)this.inner[t].parse.stopAt(e)}startInner(){let e=new kN(this.fragments),t=null,i=null,s=new dh(new oi(this.baseTree,this.ranges[0].from,0,null),lt.IncludeAnonymous|lt.IgnoreMounts);e:for(let n,a;;){let o=!0,l;if(this.stoppedAt!=null&&s.from>=this.stoppedAt)o=!1;else if(e.hasNode(s)){if(t){let u=t.mounts.find(c=>c.frag.from<=s.from&&c.frag.to>=s.to&&c.mount.overlay);if(u)for(let c of u.mount.overlay){let h=c.from+u.pos,f=c.to+u.pos;h>=s.from&&f<=s.to&&!t.ranges.some(m=>m.from<f&&m.to>h)&&t.ranges.push({from:h,to:f})}}o=!1}else if(i&&(a=wN(i.ranges,s.from,s.to)))o=a!=2;else if(!s.type.isAnonymous&&(n=this.nest(s,this.input))&&(s.from<s.to||!n.overlay)){s.tree||CN(s);let u=e.findMounts(s.from,n.parser);if(typeof n.overlay=="function")t=new _N(n.parser,n.overlay,u,this.inner.length,s.from,s.tree,t);else{let c=Qv(this.ranges,n.overlay||(s.from<s.to?[new Gi(s.from,s.to)]:[]));c.length&&Iv(c),(c.length||!n.overlay)&&this.inner.push(new Mv(n.parser,c.length?n.parser.startParse(this.input,$v(u,c),c):n.parser.startParse(""),n.overlay?n.overlay.map(h=>new Gi(h.from-s.from,h.to-s.from)):null,s.tree,c.length?c[0].from:s.from)),n.overlay?c.length&&(i={ranges:c,depth:0,prev:i}):o=!1}}else if(t&&(l=t.predicate(s))&&(l===!0&&(l=new Gi(s.from,s.to)),l.from<l.to)){let u=t.ranges.length-1;u>=0&&t.ranges[u].to==l.from?t.ranges[u]={from:t.ranges[u].from,to:l.to}:t.ranges.push(l)}if(o&&s.firstChild())t&&t.depth++,i&&i.depth++;else for(;!s.nextSibling();){if(!s.parent())break e;if(t&&!--t.depth){let u=Qv(this.ranges,t.ranges);u.length&&(Iv(u),this.inner.splice(t.index,0,new Mv(t.parser,t.parser.startParse(this.input,$v(t.mounts,u),u),t.ranges.map(c=>new Gi(c.from-t.start,c.to-t.start)),t.target,u[0].from))),t=t.prev}i&&!--i.depth&&(i=i.prev)}}}}function wN(r,e,t){for(let i of r){if(i.from>=t)break;if(i.to>e)return i.from<=e&&i.to>=t?2:1}return 0}function Rv(r,e,t,i,s,n){if(e<t){let a=r.buffer[e+1];i.push(r.slice(e,t,a)),s.push(a-n)}}function CN(r){let{node:e}=r,t=[],i=e.context.buffer;do t.push(r.index),r.parent();while(!r.tree);let s=r.tree,n=s.children.indexOf(i),a=s.children[n],o=a.buffer,l=[n];function u(c,h,f,m,S,y){let E=t[y],C=[],_=[];Rv(a,c,E,C,_,m);let v=o[E+1],T=o[E+2];l.push(C.length);let w=y?u(E+4,o[E+3],a.set.types[o[E]],v,T-v,y-1):e.toTree();return C.push(w),_.push(v-m),Rv(a,o[E+3],h,C,_,m),new He(f,C,_,S)}s.children[n]=u(0,o.length,Bt.none,0,a.length,t.length-1);for(let c of l){let h=r.tree.children[c],f=r.tree.positions[c];r.yield(new oi(h,f+r.from,c,r._tree))}}class Lv{constructor(e,t){this.offset=t,this.done=!1,this.cursor=e.cursor(lt.IncludeAnonymous|lt.IgnoreMounts)}moveTo(e){let{cursor:t}=this,i=e-this.offset;for(;!this.done&&t.from<i;)t.to>=e&&t.enter(i,1,lt.IgnoreOverlays|lt.ExcludeBuffers)||t.next(!1)||(this.done=!0)}hasNode(e){if(this.moveTo(e.from),!this.done&&this.cursor.from+this.offset==e.from&&this.cursor.tree)for(let t=this.cursor.tree;;){if(t==e.tree)return!0;if(t.children.length&&t.positions[0]==0&&t.children[0]instanceof He)t=t.children[0];else break}return!1}}let kN=class{constructor(e){var t;if(this.fragments=e,this.curTo=0,this.fragI=0,e.length){let i=this.curFrag=e[0];this.curTo=(t=i.tree.prop(wm))!==null&&t!==void 0?t:i.to,this.inner=new Lv(i.tree,-i.offset)}else this.curFrag=this.inner=null}hasNode(e){for(;this.curFrag&&e.from>=this.curTo;)this.nextFrag();return this.curFrag&&this.curFrag.from<=e.from&&this.curTo>=e.to&&this.inner.hasNode(e)}nextFrag(){var e;if(this.fragI++,this.fragI==this.fragments.length)this.curFrag=this.inner=null;else{let t=this.curFrag=this.fragments[this.fragI];this.curTo=(e=t.tree.prop(wm))!==null&&e!==void 0?e:t.to,this.inner=new Lv(t.tree,-t.offset)}}findMounts(e,t){var i;let s=[];if(this.inner){this.inner.cursor.moveTo(e,1);for(let n=this.inner.cursor.node;n;n=n.parent){let a=(i=n.tree)===null||i===void 0?void 0:i.prop(Ie.mounted);if(a&&a.parser==t)for(let o=this.fragI;o<this.fragments.length;o++){let l=this.fragments[o];if(l.from>=n.to)break;l.tree==this.curFrag.tree&&s.push({frag:l,pos:n.from-l.offset,mount:a})}}}return s}};function Qv(r,e){let t=null,i=e;for(let s=1,n=0;s<r.length;s++){let a=r[s-1].to,o=r[s].from;for(;n<i.length;n++){let l=i[n];if(l.from>=o)break;l.to<=a||(t||(i=t=e.slice()),l.from<a?(t[n]=new Gi(l.from,a),l.to>o&&t.splice(n+1,0,new Gi(o,l.to))):l.to>o?t[n--]=new Gi(o,l.to):t.splice(n--,1))}}return i}function EN(r,e,t,i){let s=0,n=0,a=!1,o=!1,l=-1e9,u=[];for(;;){let c=s==r.length?1e9:a?r[s].to:r[s].from,h=n==e.length?1e9:o?e[n].to:e[n].from;if(a!=o){let f=Math.max(l,t),m=Math.min(c,h,i);f<m&&u.push(new Gi(f,m))}if(l=Math.min(c,h),l==1e9)break;c==l&&(a?(a=!1,s++):a=!0),h==l&&(o?(o=!1,n++):o=!0)}return u}function $v(r,e){let t=[];for(let{pos:i,mount:s,frag:n}of r){let a=i+(s.overlay?s.overlay[0].from:0),o=a+s.tree.length,l=Math.max(n.from,a),u=Math.min(n.to,o);if(s.overlay){let c=s.overlay.map(f=>new Gi(f.from+i,f.to+i)),h=EN(e,c,l,u);for(let f=0,m=l;;f++){let S=f==h.length,y=S?u:h[f].from;if(y>m&&t.push(new gs(m,y,s.tree,-a,n.from>=m||n.openStart,n.to<=y||n.openEnd)),S)break;m=h[f].to}}else t.push(new gs(l,u,s.tree,-a,n.from>=a||n.openStart,n.to<=o||n.openEnd))}return t}let AN=0;class Ni{constructor(e,t,i,s){this.name=e,this.set=t,this.base=i,this.modified=s,this.id=AN++}toString(){let{name:e}=this;for(let t of this.modified)t.name&&(e=`${t.name}(${e})`);return e}static define(e,t){let i=typeof e=="string"?e:"?";if(e instanceof Ni&&(t=e),t?.base)throw new Error("Can not derive from a modified tag");let s=new Ni(i,[],null,[]);if(s.set.push(s),t)for(let n of t.set)s.set.push(n);return s}static defineModifier(e){let t=new fh(e);return i=>i.modified.indexOf(t)>-1?i:fh.get(i.base||i,i.modified.concat(t).sort((s,n)=>s.id-n.id))}}let PN=0;class fh{constructor(e){this.name=e,this.instances=[],this.id=PN++}static get(e,t){if(!t.length)return e;let i=t[0].instances.find(o=>o.base==e&&DN(t,o.modified));if(i)return i;let s=[],n=new Ni(e.name,s,e,t);for(let o of t)o.instances.push(n);let a=MN(t);for(let o of e.set)if(!o.modified.length)for(let l of a)s.push(fh.get(o,l));return n}}function DN(r,e){return r.length==e.length&&r.every((t,i)=>t==e[i])}function MN(r){let e=[[]];for(let t=0;t<r.length;t++)for(let i=0,s=e.length;i<s;i++)e.push(e[i].concat(r[t]));return e.sort((t,i)=>i.length-t.length)}function io(r){let e=Object.create(null);for(let t in r){let i=r[t];Array.isArray(i)||(i=[i]);for(let s of t.split(" "))if(s){let n=[],a=2,o=s;for(let h=0;;){if(o=="..."&&h>0&&h+3==s.length){a=1;break}let f=/^"(?:[^"\\]|\\.)*?"|[^\/!]+/.exec(o);if(!f)throw new RangeError("Invalid path: "+s);if(n.push(f[0]=="*"?"":f[0][0]=='"'?JSON.parse(f[0]):f[0]),h+=f[0].length,h==s.length)break;let m=s[h++];if(h==s.length&&m=="!"){a=0;break}if(m!="/")throw new RangeError("Invalid path: "+s);o=s.slice(h)}let l=n.length-1,u=n[l];if(!u)throw new RangeError("Invalid path: "+s);let c=new ph(i,a,l>0?n.slice(0,l):null);e[u]=c.sort(e[u])}}return y2.add(e)}const y2=new Ie;class ph{constructor(e,t,i,s){this.tags=e,this.mode=t,this.context=i,this.next=s}get opaque(){return this.mode==0}get inherit(){return this.mode==1}sort(e){return!e||e.depth<this.depth?(this.next=e,this):(e.next=this.sort(e.next),e)}get depth(){return this.context?this.context.length:0}}ph.empty=new ph([],2,null);function b2(r,e){let t=Object.create(null);for(let n of r)if(!Array.isArray(n.tag))t[n.tag.id]=n.class;else for(let a of n.tag)t[a.id]=n.class;let{scope:i,all:s=null}=e||{};return{style:n=>{let a=s;for(let o of n)for(let l of o.set){let u=t[l.id];if(u){a=a?a+" "+u:u;break}}return a},scope:i}}function IN(r,e){let t=null;for(let i of r){let s=i.style(e);s&&(t=t?t+" "+s:s)}return t}function RN(r,e,t,i=0,s=r.length){let n=new LN(i,Array.isArray(e)?e:[e],t);n.highlightRange(r.cursor(),i,s,"",n.highlighters),n.flush(s)}class LN{constructor(e,t,i){this.at=e,this.highlighters=t,this.span=i,this.class=""}startSpan(e,t){t!=this.class&&(this.flush(e),e>this.at&&(this.at=e),this.class=t)}flush(e){e>this.at&&this.class&&this.span(this.at,e,this.class)}highlightRange(e,t,i,s,n){let{type:a,from:o,to:l}=e;if(o>=i||l<=t)return;a.isTop&&(n=this.highlighters.filter(m=>!m.scope||m.scope(a)));let u=s,c=QN(e)||ph.empty,h=IN(n,c.tags);if(h&&(u&&(u+=" "),u+=h,c.mode==1&&(s+=(s?" ":"")+h)),this.startSpan(Math.max(t,o),u),c.opaque)return;let f=e.tree&&e.tree.prop(Ie.mounted);if(f&&f.overlay){let m=e.node.enter(f.overlay[0].from+o,1),S=this.highlighters.filter(E=>!E.scope||E.scope(f.tree.type)),y=e.firstChild();for(let E=0,C=o;;E++){let _=E<f.overlay.length?f.overlay[E]:null,v=_?_.from+o:l,T=Math.max(t,C),w=Math.min(i,v);if(T<w&&y)for(;e.from<w&&(this.highlightRange(e,T,w,s,n),this.startSpan(Math.min(w,e.to),u),!(e.to>=v||!e.nextSibling())););if(!_||v>i)break;C=_.to+o,C>t&&(this.highlightRange(m.cursor(),Math.max(t,_.from+o),Math.min(i,C),"",S),this.startSpan(Math.min(i,C),u))}y&&e.parent()}else if(e.firstChild()){f&&(s="");do if(!(e.to<=t)){if(e.from>=i)break;this.highlightRange(e,t,i,s,n),this.startSpan(Math.min(i,e.to),u)}while(e.nextSibling());e.parent()}}}function QN(r){let e=r.type.prop(y2);for(;e&&e.context&&!r.matchContext(e.context);)e=e.next;return e||null}const fe=Ni.define,nc=fe(),$s=fe(),Bv=fe($s),Nv=fe($s),Bs=fe(),ac=fe(Bs),Lf=fe(Bs),Mr=fe(),un=fe(Mr),Pr=fe(),Dr=fe(),Cm=fe(),Mo=fe(Cm),oc=fe(),V={comment:nc,lineComment:fe(nc),blockComment:fe(nc),docComment:fe(nc),name:$s,variableName:fe($s),typeName:Bv,tagName:fe(Bv),propertyName:Nv,attributeName:fe(Nv),className:fe($s),labelName:fe($s),namespace:fe($s),macroName:fe($s),literal:Bs,string:ac,docString:fe(ac),character:fe(ac),attributeValue:fe(ac),number:Lf,integer:fe(Lf),float:fe(Lf),bool:fe(Bs),regexp:fe(Bs),escape:fe(Bs),color:fe(Bs),url:fe(Bs),keyword:Pr,self:fe(Pr),null:fe(Pr),atom:fe(Pr),unit:fe(Pr),modifier:fe(Pr),operatorKeyword:fe(Pr),controlKeyword:fe(Pr),definitionKeyword:fe(Pr),moduleKeyword:fe(Pr),operator:Dr,derefOperator:fe(Dr),arithmeticOperator:fe(Dr),logicOperator:fe(Dr),bitwiseOperator:fe(Dr),compareOperator:fe(Dr),updateOperator:fe(Dr),definitionOperator:fe(Dr),typeOperator:fe(Dr),controlOperator:fe(Dr),punctuation:Cm,separator:fe(Cm),bracket:Mo,angleBracket:fe(Mo),squareBracket:fe(Mo),paren:fe(Mo),brace:fe(Mo),content:Mr,heading:un,heading1:fe(un),heading2:fe(un),heading3:fe(un),heading4:fe(un),heading5:fe(un),heading6:fe(un),contentSeparator:fe(Mr),list:fe(Mr),quote:fe(Mr),emphasis:fe(Mr),strong:fe(Mr),link:fe(Mr),monospace:fe(Mr),strikethrough:fe(Mr),inserted:fe(),deleted:fe(),changed:fe(),invalid:fe(),meta:oc,documentMeta:fe(oc),annotation:fe(oc),processingInstruction:fe(oc),definition:Ni.defineModifier("definition"),constant:Ni.defineModifier("constant"),function:Ni.defineModifier("function"),standard:Ni.defineModifier("standard"),local:Ni.defineModifier("local"),special:Ni.defineModifier("special")};for(let r in V){let e=V[r];e instanceof Ni&&(e.name=r)}b2([{tag:V.link,class:"tok-link"},{tag:V.heading,class:"tok-heading"},{tag:V.emphasis,class:"tok-emphasis"},{tag:V.strong,class:"tok-strong"},{tag:V.keyword,class:"tok-keyword"},{tag:V.atom,class:"tok-atom"},{tag:V.bool,class:"tok-bool"},{tag:V.url,class:"tok-url"},{tag:V.labelName,class:"tok-labelName"},{tag:V.inserted,class:"tok-inserted"},{tag:V.deleted,class:"tok-deleted"},{tag:V.literal,class:"tok-literal"},{tag:V.string,class:"tok-string"},{tag:V.number,class:"tok-number"},{tag:[V.regexp,V.escape,V.special(V.string)],class:"tok-string2"},{tag:V.variableName,class:"tok-variableName"},{tag:V.local(V.variableName),class:"tok-variableName tok-local"},{tag:V.definition(V.variableName),class:"tok-variableName tok-definition"},{tag:V.special(V.variableName),class:"tok-variableName2"},{tag:V.definition(V.propertyName),class:"tok-propertyName tok-definition"},{tag:V.typeName,class:"tok-typeName"},{tag:V.namespace,class:"tok-namespace"},{tag:V.className,class:"tok-className"},{tag:V.macroName,class:"tok-macroName"},{tag:V.propertyName,class:"tok-propertyName"},{tag:V.operator,class:"tok-operator"},{tag:V.comment,class:"tok-comment"},{tag:V.meta,class:"tok-meta"},{tag:V.invalid,class:"tok-invalid"},{tag:V.punctuation,class:"tok-punctuation"}]);var Qf;const Sn=new Ie;function d0(r){return be.define({combine:r?e=>e.concat(r):void 0})}const f0=new Ie;class Ki{constructor(e,t,i=[],s=""){this.data=e,this.name=s,Xe.prototype.hasOwnProperty("tree")||Object.defineProperty(Xe.prototype,"tree",{get(){return nt(this)}}),this.parser=t,this.extension=[Ks.of(this),Xe.languageData.of((n,a,o)=>{let l=Fv(n,a,o),u=l.type.prop(Sn);if(!u)return[];let c=n.facet(u),h=l.type.prop(f0);if(h){let f=l.resolve(a-l.from,o);for(let m of h)if(m.test(f,n)){let S=n.facet(m.facet);return m.type=="replace"?S:S.concat(c)}}return c})].concat(i)}isActiveAt(e,t,i=-1){return Fv(e,t,i).type.prop(Sn)==this.data}findRegions(e){let t=e.facet(Ks);if(t?.data==this.data)return[{from:0,to:e.doc.length}];if(!t||!t.allowsNesting)return[];let i=[],s=(n,a)=>{if(n.prop(Sn)==this.data){i.push({from:a,to:a+n.length});return}let o=n.prop(Ie.mounted);if(o){if(o.tree.prop(Sn)==this.data){if(o.overlay)for(let l of o.overlay)i.push({from:l.from+a,to:l.to+a});else i.push({from:a,to:a+n.length});return}else if(o.overlay){let l=i.length;if(s(o.tree,o.overlay[0].from+a),i.length>l)return}}for(let l=0;l<n.children.length;l++){let u=n.children[l];u instanceof He&&s(u,n.positions[l]+a)}};return s(nt(e),0),i}get allowsNesting(){return!0}}Ki.setState=Re.define();function Fv(r,e,t){let i=r.facet(Ks),s=nt(r).topNode;if(!i||i.allowsNesting)for(let n=s;n;n=n.enter(e,t,lt.ExcludeBuffers))n.type.isTop&&(s=n);return s}class Fa extends Ki{constructor(e,t,i){super(e,t,[],i),this.parser=t}static define(e){let t=d0(e.languageData);return new Fa(t,e.parser.configure({props:[Sn.add(i=>i.isTop?t:void 0)]}),e.name)}configure(e,t){return new Fa(this.data,this.parser.configure(e),t||this.name)}get allowsNesting(){return this.parser.hasWrappers()}}function nt(r){let e=r.field(Ki.state,!1);return e?e.tree:He.empty}class $N{constructor(e){this.doc=e,this.cursorPos=0,this.string="",this.cursor=e.iter()}get length(){return this.doc.length}syncTo(e){return this.string=this.cursor.next(e-this.cursorPos).value,this.cursorPos=e+this.string.length,this.cursorPos-this.string.length}chunk(e){return this.syncTo(e),this.string}get lineChunks(){return!0}read(e,t){let i=this.cursorPos-this.string.length;return e<i||t>=this.cursorPos?this.doc.sliceString(e,t):this.string.slice(e-i,t-i)}}let Io=null;class Al{constructor(e,t,i=[],s,n,a,o,l){this.parser=e,this.state=t,this.fragments=i,this.tree=s,this.treeLen=n,this.viewport=a,this.skipped=o,this.scheduleOn=l,this.parse=null,this.tempSkipped=[]}static create(e,t,i){return new Al(e,t,[],He.empty,0,i,[],null)}startParse(){return this.parser.startParse(new $N(this.state.doc),this.fragments)}work(e,t){return t!=null&&t>=this.state.doc.length&&(t=void 0),this.tree!=He.empty&&this.isDone(t??this.state.doc.length)?(this.takeTree(),!0):this.withContext(()=>{var i;if(typeof e=="number"){let s=Date.now()+e;e=()=>Date.now()>s}for(this.parse||(this.parse=this.startParse()),t!=null&&(this.parse.stoppedAt==null||this.parse.stoppedAt>t)&&t<this.state.doc.length&&this.parse.stopAt(t);;){let s=this.parse.advance();if(s)if(this.fragments=this.withoutTempSkipped(gs.addTree(s,this.fragments,this.parse.stoppedAt!=null)),this.treeLen=(i=this.parse.stoppedAt)!==null&&i!==void 0?i:this.state.doc.length,this.tree=s,this.parse=null,this.treeLen<(t??this.state.doc.length))this.parse=this.startParse();else return!0;if(e())return!1}})}takeTree(){let e,t;this.parse&&(e=this.parse.parsedPos)>=this.treeLen&&((this.parse.stoppedAt==null||this.parse.stoppedAt>e)&&this.parse.stopAt(e),this.withContext(()=>{for(;!(t=this.parse.advance()););}),this.treeLen=e,this.tree=t,this.fragments=this.withoutTempSkipped(gs.addTree(this.tree,this.fragments,!0)),this.parse=null)}withContext(e){let t=Io;Io=this;try{return e()}finally{Io=t}}withoutTempSkipped(e){for(let t;t=this.tempSkipped.pop();)e=Uv(e,t.from,t.to);return e}changes(e,t){let{fragments:i,tree:s,treeLen:n,viewport:a,skipped:o}=this;if(this.takeTree(),!e.empty){let l=[];if(e.iterChangedRanges((u,c,h,f)=>l.push({fromA:u,toA:c,fromB:h,toB:f})),i=gs.applyChanges(i,l),s=He.empty,n=0,a={from:e.mapPos(a.from,-1),to:e.mapPos(a.to,1)},this.skipped.length){o=[];for(let u of this.skipped){let c=e.mapPos(u.from,1),h=e.mapPos(u.to,-1);c<h&&o.push({from:c,to:h})}}}return new Al(this.parser,t,i,s,n,a,o,this.scheduleOn)}updateViewport(e){if(this.viewport.from==e.from&&this.viewport.to==e.to)return!1;this.viewport=e;let t=this.skipped.length;for(let i=0;i<this.skipped.length;i++){let{from:s,to:n}=this.skipped[i];s<e.to&&n>e.from&&(this.fragments=Uv(this.fragments,s,n),this.skipped.splice(i--,1))}return this.skipped.length>=t?!1:(this.reset(),!0)}reset(){this.parse&&(this.takeTree(),this.parse=null)}skipUntilInView(e,t){this.skipped.push({from:e,to:t})}static getSkippingParser(e){return new class extends h0{createParse(t,i,s){let n=s[0].from,a=s[s.length-1].to;return{parsedPos:n,advance(){let l=Io;if(l){for(let u of s)l.tempSkipped.push(u);e&&(l.scheduleOn=l.scheduleOn?Promise.all([l.scheduleOn,e]):e)}return this.parsedPos=a,new He(Bt.none,[],[],a-n)},stoppedAt:null,stopAt(){}}}}}isDone(e){e=Math.min(e,this.state.doc.length);let t=this.fragments;return this.treeLen>=e&&t.length&&t[0].from==0&&t[0].to>=e}static get(){return Io}}function Uv(r,e,t){return gs.applyChanges(r,[{fromA:e,toA:t,fromB:e,toB:t}])}class Ua{constructor(e){this.context=e,this.tree=e.tree}apply(e){if(!e.docChanged&&this.tree==this.context.tree)return this;let t=this.context.changes(e.changes,e.state),i=this.context.treeLen==e.startState.doc.length?void 0:Math.max(e.changes.mapPos(this.context.treeLen),t.viewport.to);return t.work(20,i)||t.takeTree(),new Ua(t)}static init(e){let t=Math.min(3e3,e.doc.length),i=Al.create(e.facet(Ks).parser,e,{from:0,to:t});return i.work(20,t)||i.takeTree(),new Ua(i)}}Ki.state=jt.define({create:Ua.init,update(r,e){for(let t of e.effects)if(t.is(Ki.setState))return t.value;return e.startState.facet(Ks)!=e.state.facet(Ks)?Ua.init(e.state):r.apply(e)}});let v2=r=>{let e=setTimeout(()=>r(),500);return()=>clearTimeout(e)};typeof requestIdleCallback<"u"&&(v2=r=>{let e=-1,t=setTimeout(()=>{e=requestIdleCallback(r,{timeout:400})},100);return()=>e<0?clearTimeout(t):cancelIdleCallback(e)});const $f=typeof navigator<"u"&&(!((Qf=navigator.scheduling)===null||Qf===void 0)&&Qf.isInputPending)?()=>navigator.scheduling.isInputPending():null,BN=Qt.fromClass(class{constructor(e){this.view=e,this.working=null,this.workScheduled=0,this.chunkEnd=-1,this.chunkBudget=-1,this.work=this.work.bind(this),this.scheduleWork()}update(e){let t=this.view.state.field(Ki.state).context;(t.updateViewport(e.view.viewport)||this.view.viewport.to>t.treeLen)&&this.scheduleWork(),(e.docChanged||e.selectionSet)&&(this.view.hasFocus&&(this.chunkBudget+=50),this.scheduleWork()),this.checkAsyncSchedule(t)}scheduleWork(){if(this.working)return;let{state:e}=this.view,t=e.field(Ki.state);(t.tree!=t.context.tree||!t.context.isDone(e.doc.length))&&(this.working=v2(this.work))}work(e){this.working=null;let t=Date.now();if(this.chunkEnd<t&&(this.chunkEnd<0||this.view.hasFocus)&&(this.chunkEnd=t+3e4,this.chunkBudget=3e3),this.chunkBudget<=0)return;let{state:i,viewport:{to:s}}=this.view,n=i.field(Ki.state);if(n.tree==n.context.tree&&n.context.isDone(s+1e5))return;let a=Date.now()+Math.min(this.chunkBudget,100,e&&!$f?Math.max(25,e.timeRemaining()-5):1e9),o=n.context.treeLen<s&&i.doc.length>s+1e3,l=n.context.work(()=>$f&&$f()||Date.now()>a,s+(o?0:1e5));this.chunkBudget-=Date.now()-t,(l||this.chunkBudget<=0)&&(n.context.takeTree(),this.view.dispatch({effects:Ki.setState.of(new Ua(n.context))})),this.chunkBudget>0&&!(l&&!o)&&this.scheduleWork(),this.checkAsyncSchedule(n.context)}checkAsyncSchedule(e){e.scheduleOn&&(this.workScheduled++,e.scheduleOn.then(()=>this.scheduleWork()).catch(t=>ki(this.view.state,t)).then(()=>this.workScheduled--),e.scheduleOn=null)}destroy(){this.working&&this.working()}isWorking(){return!!(this.working||this.workScheduled>0)}},{eventHandlers:{focus(){this.scheduleWork()}}}),Ks=be.define({combine(r){return r.length?r[0]:null},enables:r=>[Ki.state,BN,ge.contentAttributes.compute([r],e=>{let t=e.facet(r);return t&&t.name?{"data-language":t.name}:{}})]});class Pl{constructor(e,t=[]){this.language=e,this.support=t,this.extension=[e,t]}}class mh{constructor(e,t,i,s,n,a=void 0){this.name=e,this.alias=t,this.extensions=i,this.filename=s,this.loadFunc=n,this.support=a,this.loading=null}load(){return this.loading||(this.loading=this.loadFunc().then(e=>this.support=e,e=>{throw this.loading=null,e}))}static of(e){let{load:t,support:i}=e;if(!t){if(!i)throw new RangeError("Must pass either 'load' or 'support' to LanguageDescription.of");t=()=>Promise.resolve(i)}return new mh(e.name,(e.alias||[]).concat(e.name).map(s=>s.toLowerCase()),e.extensions||[],e.filename,t,i)}static matchFilename(e,t){for(let s of e)if(s.filename&&s.filename.test(t))return s;let i=/\.([^.]+)$/.exec(t);if(i){for(let s of e)if(s.extensions.indexOf(i[1])>-1)return s}return null}static matchLanguageName(e,t,i=!0){t=t.toLowerCase();for(let s of e)if(s.alias.some(n=>n==t))return s;if(i)for(let s of e)for(let n of s.alias){let a=t.indexOf(n);if(a>-1&&(n.length>2||!/\w/.test(t[a-1])&&!/\w/.test(t[a+n.length])))return s}return null}}const NN=be.define(),su=be.define({combine:r=>{if(!r.length)return"  ";let e=r[0];if(!e||/\S/.test(e)||Array.from(e).some(t=>t!=e[0]))throw new Error("Invalid indent unit: "+JSON.stringify(r[0]));return e}});function gh(r){let e=r.facet(su);return e.charCodeAt(0)==9?r.tabSize*e.length:e.length}function Dl(r,e){let t="",i=r.tabSize,s=r.facet(su)[0];if(s=="	"){for(;e>=i;)t+="	",e-=i;s=" "}for(let n=0;n<e;n++)t+=s;return t}function p0(r,e){r instanceof Xe&&(r=new cd(r));for(let i of r.state.facet(NN)){let s=i(r,e);if(s!==void 0)return s}let t=nt(r.state);return t.length>=e?FN(r,t,e):null}class cd{constructor(e,t={}){this.state=e,this.options=t,this.unit=gh(e)}lineAt(e,t=1){let i=this.state.doc.lineAt(e),{simulateBreak:s,simulateDoubleBreak:n}=this.options;return s!=null&&s>=i.from&&s<=i.to?n&&s==e?{text:"",from:e}:(t<0?s<e:s<=e)?{text:i.text.slice(s-i.from),from:s}:{text:i.text.slice(0,s-i.from),from:i.from}:i}textAfterPos(e,t=1){if(this.options.simulateDoubleBreak&&e==this.options.simulateBreak)return"";let{text:i,from:s}=this.lineAt(e,t);return i.slice(e-s,Math.min(i.length,e+100-s))}column(e,t=1){let{text:i,from:s}=this.lineAt(e,t),n=this.countColumn(i,e-s),a=this.options.overrideIndentation?this.options.overrideIndentation(s):-1;return a>-1&&(n+=a-this.countColumn(i,i.search(/\S|$/))),n}countColumn(e,t=e.length){return yr(e,this.state.tabSize,t)}lineIndent(e,t=1){let{text:i,from:s}=this.lineAt(e,t),n=this.options.overrideIndentation;if(n){let a=n(s);if(a>-1)return a}return this.countColumn(i,i.search(/\S|$/))}get simulatedBreak(){return this.options.simulateBreak||null}}const nu=new Ie;function FN(r,e,t){let i=e.resolveStack(t),s=e.resolveInner(t,-1).resolve(t,0).enterUnfinishedNodesBefore(t);if(s!=i.node){let n=[];for(let a=s;a&&!(a.from<i.node.from||a.to>i.node.to||a.from==i.node.from&&a.type==i.node.type);a=a.parent)n.push(a);for(let a=n.length-1;a>=0;a--)i={node:n[a],next:i}}return S2(i,r,t)}function S2(r,e,t){for(let i=r;i;i=i.next){let s=qN(i.node);if(s)return s(m0.create(e,t,i))}return 0}function UN(r){return r.pos==r.options.simulateBreak&&r.options.simulateDoubleBreak}function qN(r){let e=r.type.prop(nu);if(e)return e;let t=r.firstChild,i;if(t&&(i=t.type.prop(Ie.closedBy))){let s=r.lastChild,n=s&&i.indexOf(s.name)>-1;return a=>T2(a,!0,1,void 0,n&&!UN(a)?s.from:void 0)}return r.parent==null?VN:null}function VN(){return 0}class m0 extends cd{constructor(e,t,i){super(e.state,e.options),this.base=e,this.pos=t,this.context=i}get node(){return this.context.node}static create(e,t,i){return new m0(e,t,i)}get textAfter(){return this.textAfterPos(this.pos)}get baseIndent(){return this.baseIndentFor(this.node)}baseIndentFor(e){let t=this.state.doc.lineAt(e.from);for(;;){let i=e.resolve(t.from);for(;i.parent&&i.parent.from==i.from;)i=i.parent;if(XN(i,e))break;t=this.state.doc.lineAt(i.from)}return this.lineIndent(t.from)}continue(){return S2(this.context.next,this.base,this.pos)}}function XN(r,e){for(let t=e;t;t=t.parent)if(r==t)return!0;return!1}function jN(r){let e=r.node,t=e.childAfter(e.from),i=e.lastChild;if(!t)return null;let s=r.options.simulateBreak,n=r.state.doc.lineAt(t.from),a=s==null||s<=n.from?n.to:Math.min(n.to,s);for(let o=t.to;;){let l=e.childAfter(o);if(!l||l==i)return null;if(!l.type.isSkipped){if(l.from>=a)return null;let u=/^ */.exec(n.text.slice(t.to-n.from))[0].length;return{from:t.from,to:t.to+u}}o=l.to}}function zN({closing:r,align:e=!0,units:t=1}){return i=>T2(i,e,t,r)}function T2(r,e,t,i,s){let n=r.textAfter,a=n.match(/^\s*/)[0].length,o=i&&n.slice(a,a+i.length)==i||s==r.pos+a,l=e?jN(r):null;return l?o?r.column(l.from):r.column(l.to):r.baseIndent+(o?0:r.unit*t)}const ZN=r=>r.baseIndent;function kc({except:r,units:e=1}={}){return t=>{let i=r&&r.test(t.textAfter);return t.baseIndent+(i?0:e*t.unit)}}const WN=200;function HN(){return Xe.transactionFilter.of(r=>{if(!r.docChanged||!r.isUserEvent("input.type")&&!r.isUserEvent("input.complete"))return r;let e=r.startState.languageDataAt("indentOnInput",r.startState.selection.main.head);if(!e.length)return r;let t=r.newDoc,{head:i}=r.newSelection.main,s=t.lineAt(i);if(i>s.from+WN)return r;let n=t.sliceString(s.from,i);if(!e.some(u=>u.test(n)))return r;let{state:a}=r,o=-1,l=[];for(let{head:u}of a.selection.ranges){let c=a.doc.lineAt(u);if(c.from==o)continue;o=c.from;let h=p0(a,c.from);if(h==null)continue;let f=/^\s*/.exec(c.text)[0],m=Dl(a,h);f!=m&&l.push({from:c.from,to:c.from+f.length,insert:m})}return l.length?[r,{changes:l,sequential:!0}]:r})}const _2=be.define(),ro=new Ie;function x2(r){let e=r.firstChild,t=r.lastChild;return e&&e.to<t.from?{from:e.to,to:t.type.isError?r.to:t.from}:null}function YN(r,e,t){let i=nt(r);if(i.length<t)return null;let s=i.resolveStack(t,1),n=null;for(let a=s;a;a=a.next){let o=a.node;if(o.to<=t||o.from>t)continue;if(n&&o.from<e)break;let l=o.type.prop(ro);if(l&&(o.to<i.length-50||i.length==r.doc.length||!GN(o))){let u=l(o,r);u&&u.from<=t&&u.from>=e&&u.to>t&&(n=u)}}return n}function GN(r){let e=r.lastChild;return e&&e.to==r.to&&e.type.isError}function Oh(r,e,t){for(let i of r.facet(_2)){let s=i(r,e,t);if(s)return s}return YN(r,e,t)}function w2(r,e){let t=e.mapPos(r.from,1),i=e.mapPos(r.to,-1);return t>=i?void 0:{from:t,to:i}}const hd=Re.define({map:w2}),au=Re.define({map:w2});function C2(r){let e=[];for(let{head:t}of r.state.selection.ranges)e.some(i=>i.from<=t&&i.to>=t)||e.push(r.lineBlockAt(t));return e}const Bn=jt.define({create(){return Ee.none},update(r,e){e.isUserEvent("delete")&&e.changes.iterChangedRanges((t,i)=>r=qv(r,t,i)),r=r.map(e.changes);for(let t of e.effects)if(t.is(hd)&&!KN(r,t.value.from,t.value.to)){let{preparePlaceholder:i}=e.state.facet(A2),s=i?Ee.replace({widget:new n8(i(e.state,t.value))}):Vv;r=r.update({add:[s.range(t.value.from,t.value.to)]})}else t.is(au)&&(r=r.update({filter:(i,s)=>t.value.from!=i||t.value.to!=s,filterFrom:t.value.from,filterTo:t.value.to}));return e.selection&&(r=qv(r,e.selection.main.head)),r},provide:r=>ge.decorations.from(r),toJSON(r,e){let t=[];return r.between(0,e.doc.length,(i,s)=>{t.push(i,s)}),t},fromJSON(r){if(!Array.isArray(r)||r.length%2)throw new RangeError("Invalid JSON for fold state");let e=[];for(let t=0;t<r.length;){let i=r[t++],s=r[t++];if(typeof i!="number"||typeof s!="number")throw new RangeError("Invalid JSON for fold state");e.push(Vv.range(i,s))}return Ee.set(e,!0)}});function qv(r,e,t=e){let i=!1;return r.between(e,t,(s,n)=>{s<t&&n>e&&(i=!0)}),i?r.update({filterFrom:e,filterTo:t,filter:(s,n)=>s>=t||n<=e}):r}function yh(r,e,t){var i;let s=null;return(i=r.field(Bn,!1))===null||i===void 0||i.between(e,t,(n,a)=>{(!s||s.from>n)&&(s={from:n,to:a})}),s}function KN(r,e,t){let i=!1;return r.between(e,e,(s,n)=>{s==e&&n==t&&(i=!0)}),i}function k2(r,e){return r.field(Bn,!1)?e:e.concat(Re.appendConfig.of(P2()))}const JN=r=>{for(let e of C2(r)){let t=Oh(r.state,e.from,e.to);if(t)return r.dispatch({effects:k2(r.state,[hd.of(t),E2(r,t)])}),!0}return!1},e8=r=>{if(!r.state.field(Bn,!1))return!1;let e=[];for(let t of C2(r)){let i=yh(r.state,t.from,t.to);i&&e.push(au.of(i),E2(r,i,!1))}return e.length&&r.dispatch({effects:e}),e.length>0};function E2(r,e,t=!0){let i=r.state.doc.lineAt(e.from).number,s=r.state.doc.lineAt(e.to).number;return ge.announce.of(`${r.state.phrase(t?"Folded lines":"Unfolded lines")} ${i} ${r.state.phrase("to")} ${s}.`)}const t8=r=>{let{state:e}=r,t=[];for(let i=0;i<e.doc.length;){let s=r.lineBlockAt(i),n=Oh(e,s.from,s.to);n&&t.push(hd.of(n)),i=(n?r.lineBlockAt(n.to):s).to+1}return t.length&&r.dispatch({effects:k2(r.state,t)}),!!t.length},i8=r=>{let e=r.state.field(Bn,!1);if(!e||!e.size)return!1;let t=[];return e.between(0,r.state.doc.length,(i,s)=>{t.push(au.of({from:i,to:s}))}),r.dispatch({effects:t}),!0},r8=[{key:"Ctrl-Shift-[",mac:"Cmd-Alt-[",run:JN},{key:"Ctrl-Shift-]",mac:"Cmd-Alt-]",run:e8},{key:"Ctrl-Alt-[",run:t8},{key:"Ctrl-Alt-]",run:i8}],s8={placeholderDOM:null,preparePlaceholder:null,placeholderText:"…"},A2=be.define({combine(r){return Gr(r,s8)}});function P2(r){return[Bn,l8]}function D2(r,e){let{state:t}=r,i=t.facet(A2),s=a=>{let o=r.lineBlockAt(r.posAtDOM(a.target)),l=yh(r.state,o.from,o.to);l&&r.dispatch({effects:au.of(l)}),a.preventDefault()};if(i.placeholderDOM)return i.placeholderDOM(r,s,e);let n=document.createElement("span");return n.textContent=i.placeholderText,n.setAttribute("aria-label",t.phrase("folded code")),n.title=t.phrase("unfold"),n.className="cm-foldPlaceholder",n.onclick=s,n}const Vv=Ee.replace({widget:new class extends _s{toDOM(r){return D2(r,null)}}});class n8 extends _s{constructor(e){super(),this.value=e}eq(e){return this.value==e.value}toDOM(e){return D2(e,this.value)}}const a8={openText:"⌄",closedText:"›",markerDOM:null,domEventHandlers:{},foldingChanged:()=>!1};class Bf extends vs{constructor(e,t){super(),this.config=e,this.open=t}eq(e){return this.config==e.config&&this.open==e.open}toDOM(e){if(this.config.markerDOM)return this.config.markerDOM(this.open);let t=document.createElement("span");return t.textContent=this.open?this.config.openText:this.config.closedText,t.title=e.state.phrase(this.open?"Fold line":"Unfold line"),t}}function o8(r={}){let e={...a8,...r},t=new Bf(e,!0),i=new Bf(e,!1),s=Qt.fromClass(class{constructor(a){this.from=a.viewport.from,this.markers=this.buildMarkers(a)}update(a){(a.docChanged||a.viewportChanged||a.startState.facet(Ks)!=a.state.facet(Ks)||a.startState.field(Bn,!1)!=a.state.field(Bn,!1)||nt(a.startState)!=nt(a.state)||e.foldingChanged(a))&&(this.markers=this.buildMarkers(a.view))}buildMarkers(a){let o=new ys;for(let l of a.viewportLineBlocks){let u=yh(a.state,l.from,l.to)?i:Oh(a.state,l.from,l.to)?t:null;u&&o.add(l.from,l.from,u)}return o.finish()}}),{domEventHandlers:n}=e;return[s,nN({class:"cm-foldGutter",markers(a){var o;return((o=a.plugin(s))===null||o===void 0?void 0:o.markers)||je.empty},initialSpacer(){return new Bf(e,!1)},domEventHandlers:{...n,click:(a,o,l)=>{if(n.click&&n.click(a,o,l))return!0;let u=yh(a.state,o.from,o.to);if(u)return a.dispatch({effects:au.of(u)}),!0;let c=Oh(a.state,o.from,o.to);return c?(a.dispatch({effects:hd.of(c)}),!0):!1}}}),P2()]}const l8=ge.baseTheme({".cm-foldPlaceholder":{backgroundColor:"#eee",border:"1px solid #ddd",color:"#888",borderRadius:".2em",margin:"0 1px",padding:"0 1px",cursor:"pointer"},".cm-foldGutter span":{padding:"0 1px",cursor:"pointer"}});class ou{constructor(e,t){this.specs=e;let i;function s(o){let l=Ws.newName();return(i||(i=Object.create(null)))["."+l]=o,l}const n=typeof t.all=="string"?t.all:t.all?s(t.all):void 0,a=t.scope;this.scope=a instanceof Ki?o=>o.prop(Sn)==a.data:a?o=>o==a:void 0,this.style=b2(e.map(o=>({tag:o.tag,class:o.class||s(Object.assign({},o,{tag:null}))})),{all:n}).style,this.module=i?new Ws(i):null,this.themeType=t.themeType}static define(e,t){return new ou(e,t||{})}}const km=be.define(),M2=be.define({combine(r){return r.length?[r[0]]:null}});function Nf(r){let e=r.facet(km);return e.length?e:r.facet(M2)}function I2(r,e){let t=[c8],i;return r instanceof ou&&(r.module&&t.push(ge.styleModule.of(r.module)),i=r.themeType),e?.fallback?t.push(M2.of(r)):i?t.push(km.computeN([ge.darkTheme],s=>s.facet(ge.darkTheme)==(i=="dark")?[r]:[])):t.push(km.of(r)),t}class u8{constructor(e){this.markCache=Object.create(null),this.tree=nt(e.state),this.decorations=this.buildDeco(e,Nf(e.state)),this.decoratedTo=e.viewport.to}update(e){let t=nt(e.state),i=Nf(e.state),s=i!=Nf(e.startState),{viewport:n}=e.view,a=e.changes.mapPos(this.decoratedTo,1);t.length<n.to&&!s&&t.type==this.tree.type&&a>=n.to?(this.decorations=this.decorations.map(e.changes),this.decoratedTo=a):(t!=this.tree||e.viewportChanged||s)&&(this.tree=t,this.decorations=this.buildDeco(e.view,i),this.decoratedTo=n.to)}buildDeco(e,t){if(!t||!this.tree.length)return Ee.none;let i=new ys;for(let{from:s,to:n}of e.visibleRanges)RN(this.tree,t,(a,o,l)=>{i.add(a,o,this.markCache[l]||(this.markCache[l]=Ee.mark({class:l})))},s,n);return i.finish()}}const c8=Ss.high(Qt.fromClass(u8,{decorations:r=>r.decorations})),h8=ou.define([{tag:V.meta,color:"#404740"},{tag:V.link,textDecoration:"underline"},{tag:V.heading,textDecoration:"underline",fontWeight:"bold"},{tag:V.emphasis,fontStyle:"italic"},{tag:V.strong,fontWeight:"bold"},{tag:V.strikethrough,textDecoration:"line-through"},{tag:V.keyword,color:"#708"},{tag:[V.atom,V.bool,V.url,V.contentSeparator,V.labelName],color:"#219"},{tag:[V.literal,V.inserted],color:"#164"},{tag:[V.string,V.deleted],color:"#a11"},{tag:[V.regexp,V.escape,V.special(V.string)],color:"#e40"},{tag:V.definition(V.variableName),color:"#00f"},{tag:V.local(V.variableName),color:"#30a"},{tag:[V.typeName,V.namespace],color:"#085"},{tag:V.className,color:"#167"},{tag:[V.special(V.variableName),V.macroName],color:"#256"},{tag:V.definition(V.propertyName),color:"#00c"},{tag:V.comment,color:"#940"},{tag:V.invalid,color:"#f00"}]),d8=ge.baseTheme({"&.cm-focused .cm-matchingBracket":{backgroundColor:"#328c8252"},"&.cm-focused .cm-nonmatchingBracket":{backgroundColor:"#bb555544"}}),R2=1e4,L2="()[]{}",Q2=be.define({combine(r){return Gr(r,{afterCursor:!0,brackets:L2,maxScanDistance:R2,renderMatch:m8})}}),f8=Ee.mark({class:"cm-matchingBracket"}),p8=Ee.mark({class:"cm-nonmatchingBracket"});function m8(r){let e=[],t=r.matched?f8:p8;return e.push(t.range(r.start.from,r.start.to)),r.end&&e.push(t.range(r.end.from,r.end.to)),e}const g8=jt.define({create(){return Ee.none},update(r,e){if(!e.docChanged&&!e.selection)return r;let t=[],i=e.state.facet(Q2);for(let s of e.state.selection.ranges){if(!s.empty)continue;let n=Vr(e.state,s.head,-1,i)||s.head>0&&Vr(e.state,s.head-1,1,i)||i.afterCursor&&(Vr(e.state,s.head,1,i)||s.head<e.state.doc.length&&Vr(e.state,s.head+1,-1,i));n&&(t=t.concat(i.renderMatch(n,e.state)))}return Ee.set(t,!0)},provide:r=>ge.decorations.from(r)}),O8=[g8,d8];function y8(r={}){return[Q2.of(r),O8]}const $2=new Ie;function Em(r,e,t){let i=r.prop(e<0?Ie.openedBy:Ie.closedBy);if(i)return i;if(r.name.length==1){let s=t.indexOf(r.name);if(s>-1&&s%2==(e<0?1:0))return[t[s+e]]}return null}function Am(r){let e=r.type.prop($2);return e?e(r.node):r}function Vr(r,e,t,i={}){let s=i.maxScanDistance||R2,n=i.brackets||L2,a=nt(r),o=a.resolveInner(e,t);for(let l=o;l;l=l.parent){let u=Em(l.type,t,n);if(u&&l.from<l.to){let c=Am(l);if(c&&(t>0?e>=c.from&&e<c.to:e>c.from&&e<=c.to))return b8(r,e,t,l,c,u,n)}}return v8(r,e,t,a,o.type,s,n)}function b8(r,e,t,i,s,n,a){let o=i.parent,l={from:s.from,to:s.to},u=0,c=o?.cursor();if(c&&(t<0?c.childBefore(i.from):c.childAfter(i.to)))do if(t<0?c.to<=i.from:c.from>=i.to){if(u==0&&n.indexOf(c.type.name)>-1&&c.from<c.to){let h=Am(c);return{start:l,end:h?{from:h.from,to:h.to}:void 0,matched:!0}}else if(Em(c.type,t,a))u++;else if(Em(c.type,-t,a)){if(u==0){let h=Am(c);return{start:l,end:h&&h.from<h.to?{from:h.from,to:h.to}:void 0,matched:!1}}u--}}while(t<0?c.prevSibling():c.nextSibling());return{start:l,matched:!1}}function v8(r,e,t,i,s,n,a){let o=t<0?r.sliceDoc(e-1,e):r.sliceDoc(e,e+1),l=a.indexOf(o);if(l<0||l%2==0!=t>0)return null;let u={from:t<0?e-1:e,to:t>0?e+1:e},c=r.doc.iterRange(e,t>0?r.doc.length:0),h=0;for(let f=0;!c.next().done&&f<=n;){let m=c.value;t<0&&(f+=m.length);let S=e+f*t;for(let y=t>0?0:m.length-1,E=t>0?m.length:-1;y!=E;y+=t){let C=a.indexOf(m[y]);if(!(C<0||i.resolveInner(S+y,1).type!=s))if(C%2==0==t>0)h++;else{if(h==1)return{start:u,end:{from:S+y,to:S+y+1},matched:C>>1==l>>1};h--}}t>0&&(f+=m.length)}return c.done?{start:u,matched:!1}:null}const S8=Object.create(null),Xv=[Bt.none],jv=[],zv=Object.create(null),T8=Object.create(null);for(let[r,e]of[["variable","variableName"],["variable-2","variableName.special"],["string-2","string.special"],["def","variableName.definition"],["tag","tagName"],["attribute","attributeName"],["type","typeName"],["builtin","variableName.standard"],["qualifier","modifier"],["error","invalid"],["header","heading"],["property","propertyName"]])T8[r]=_8(S8,e);function Ff(r,e){jv.indexOf(r)>-1||(jv.push(r),console.warn(e))}function _8(r,e){let t=[];for(let o of e.split(" ")){let l=[];for(let u of o.split(".")){let c=r[u]||V[u];c?typeof c=="function"?l.length?l=l.map(c):Ff(u,`Modifier ${u} used at start of tag`):l.length?Ff(u,`Tag ${u} used as modifier`):l=Array.isArray(c)?c:[c]:Ff(u,`Unknown highlighting tag ${u}`)}for(let u of l)t.push(u)}if(!t.length)return 0;let i=e.replace(/ /g,"_"),s=i+" "+t.map(o=>o.id),n=zv[s];if(n)return n.id;let a=zv[s]=Bt.define({id:Xv.length,name:i,props:[io({[i]:t})]});return Xv.push(a),a.id}dt.RTL,dt.LTR;const x8=r=>{let{state:e}=r,t=e.doc.lineAt(e.selection.main.from),i=O0(r.state,t.from);return i.line?w8(r):i.block?k8(r):!1};function g0(r,e){return({state:t,dispatch:i})=>{if(t.readOnly)return!1;let s=r(e,t);return s?(i(t.update(s)),!0):!1}}const w8=g0(P8,0),C8=g0(B2,0),k8=g0((r,e)=>B2(r,e,A8(e)),0);function O0(r,e){let t=r.languageDataAt("commentTokens",e,1);return t.length?t[0]:{}}const Ro=50;function E8(r,{open:e,close:t},i,s){let n=r.sliceDoc(i-Ro,i),a=r.sliceDoc(s,s+Ro),o=/\s*$/.exec(n)[0].length,l=/^\s*/.exec(a)[0].length,u=n.length-o;if(n.slice(u-e.length,u)==e&&a.slice(l,l+t.length)==t)return{open:{pos:i-o,margin:o&&1},close:{pos:s+l,margin:l&&1}};let c,h;s-i<=2*Ro?c=h=r.sliceDoc(i,s):(c=r.sliceDoc(i,i+Ro),h=r.sliceDoc(s-Ro,s));let f=/^\s*/.exec(c)[0].length,m=/\s*$/.exec(h)[0].length,S=h.length-m-t.length;return c.slice(f,f+e.length)==e&&h.slice(S,S+t.length)==t?{open:{pos:i+f+e.length,margin:/\s/.test(c.charAt(f+e.length))?1:0},close:{pos:s-m-t.length,margin:/\s/.test(h.charAt(S-1))?1:0}}:null}function A8(r){let e=[];for(let t of r.selection.ranges){let i=r.doc.lineAt(t.from),s=t.to<=i.to?i:r.doc.lineAt(t.to);s.from>i.from&&s.from==t.to&&(s=t.to==i.to+1?i:r.doc.lineAt(t.to-1));let n=e.length-1;n>=0&&e[n].to>i.from?e[n].to=s.to:e.push({from:i.from+/^\s*/.exec(i.text)[0].length,to:s.to})}return e}function B2(r,e,t=e.selection.ranges){let i=t.map(n=>O0(e,n.from).block);if(!i.every(n=>n))return null;let s=t.map((n,a)=>E8(e,i[a],n.from,n.to));if(r!=2&&!s.every(n=>n))return{changes:e.changes(t.map((n,a)=>s[a]?[]:[{from:n.from,insert:i[a].open+" "},{from:n.to,insert:" "+i[a].close}]))};if(r!=1&&s.some(n=>n)){let n=[];for(let a=0,o;a<s.length;a++)if(o=s[a]){let l=i[a],{open:u,close:c}=o;n.push({from:u.pos-l.open.length,to:u.pos+u.margin},{from:c.pos-c.margin,to:c.pos+l.close.length})}return{changes:n}}return null}function P8(r,e,t=e.selection.ranges){let i=[],s=-1;for(let{from:n,to:a}of t){let o=i.length,l=1e9,u=O0(e,n).line;if(u){for(let c=n;c<=a;){let h=e.doc.lineAt(c);if(h.from>s&&(n==a||a>h.from)){s=h.from;let f=/^\s*/.exec(h.text)[0].length,m=f==h.length,S=h.text.slice(f,f+u.length)==u?f:-1;f<h.text.length&&f<l&&(l=f),i.push({line:h,comment:S,token:u,indent:f,empty:m,single:!1})}c=h.to+1}if(l<1e9)for(let c=o;c<i.length;c++)i[c].indent<i[c].line.text.length&&(i[c].indent=l);i.length==o+1&&(i[o].single=!0)}}if(r!=2&&i.some(n=>n.comment<0&&(!n.empty||n.single))){let n=[];for(let{line:o,token:l,indent:u,empty:c,single:h}of i)(h||!c)&&n.push({from:o.from+u,insert:l+" "});let a=e.changes(n);return{changes:a,selection:e.selection.map(a,1)}}else if(r!=1&&i.some(n=>n.comment>=0)){let n=[];for(let{line:a,comment:o,token:l}of i)if(o>=0){let u=a.from+o,c=u+l.length;a.text[c-a.from]==" "&&c++,n.push({from:u,to:c})}return{changes:n}}return null}const Pm=Ts.define(),D8=Ts.define(),M8=be.define(),N2=be.define({combine(r){return Gr(r,{minDepth:100,newGroupDelay:500,joinToEvent:(e,t)=>t},{minDepth:Math.max,newGroupDelay:Math.min,joinToEvent:(e,t)=>(i,s)=>e(i,s)||t(i,s)})}}),F2=jt.define({create(){return Xr.empty},update(r,e){let t=e.state.facet(N2),i=e.annotation(Pm);if(i){let l=Ei.fromTransaction(e,i.selection),u=i.side,c=u==0?r.undone:r.done;return l?c=bh(c,c.length,t.minDepth,l):c=V2(c,e.startState.selection),new Xr(u==0?i.rest:c,u==0?c:i.rest)}let s=e.annotation(D8);if((s=="full"||s=="before")&&(r=r.isolate()),e.annotation(Lt.addToHistory)===!1)return e.changes.empty?r:r.addMapping(e.changes.desc);let n=Ei.fromTransaction(e),a=e.annotation(Lt.time),o=e.annotation(Lt.userEvent);return n?r=r.addChanges(n,a,o,t,e):e.selection&&(r=r.addSelection(e.startState.selection,a,o,t.newGroupDelay)),(s=="full"||s=="after")&&(r=r.isolate()),r},toJSON(r){return{done:r.done.map(e=>e.toJSON()),undone:r.undone.map(e=>e.toJSON())}},fromJSON(r){return new Xr(r.done.map(Ei.fromJSON),r.undone.map(Ei.fromJSON))}});function I8(r={}){return[F2,N2.of(r),ge.domEventHandlers({beforeinput(e,t){let i=e.inputType=="historyUndo"?U2:e.inputType=="historyRedo"?Dm:null;return i?(e.preventDefault(),i(t)):!1}})]}function dd(r,e){return function({state:t,dispatch:i}){if(!e&&t.readOnly)return!1;let s=t.field(F2,!1);if(!s)return!1;let n=s.pop(r,t,e);return n?(i(n),!0):!1}}const U2=dd(0,!1),Dm=dd(1,!1),R8=dd(0,!0),L8=dd(1,!0);class Ei{constructor(e,t,i,s,n){this.changes=e,this.effects=t,this.mapped=i,this.startSelection=s,this.selectionsAfter=n}setSelAfter(e){return new Ei(this.changes,this.effects,this.mapped,this.startSelection,e)}toJSON(){var e,t,i;return{changes:(e=this.changes)===null||e===void 0?void 0:e.toJSON(),mapped:(t=this.mapped)===null||t===void 0?void 0:t.toJSON(),startSelection:(i=this.startSelection)===null||i===void 0?void 0:i.toJSON(),selectionsAfter:this.selectionsAfter.map(s=>s.toJSON())}}static fromJSON(e){return new Ei(e.changes&&$t.fromJSON(e.changes),[],e.mapped&&jr.fromJSON(e.mapped),e.startSelection&&ie.fromJSON(e.startSelection),e.selectionsAfter.map(ie.fromJSON))}static fromTransaction(e,t){let i=Ji;for(let s of e.startState.facet(M8)){let n=s(e);n.length&&(i=i.concat(n))}return!i.length&&e.changes.empty?null:new Ei(e.changes.invert(e.startState.doc),i,void 0,t||e.startState.selection,Ji)}static selection(e){return new Ei(void 0,Ji,void 0,void 0,e)}}function bh(r,e,t,i){let s=e+1>t+20?e-t-1:0,n=r.slice(s,e);return n.push(i),n}function Q8(r,e){let t=[],i=!1;return r.iterChangedRanges((s,n)=>t.push(s,n)),e.iterChangedRanges((s,n,a,o)=>{for(let l=0;l<t.length;){let u=t[l++],c=t[l++];o>=u&&a<=c&&(i=!0)}}),i}function $8(r,e){return r.ranges.length==e.ranges.length&&r.ranges.filter((t,i)=>t.empty!=e.ranges[i].empty).length===0}function q2(r,e){return r.length?e.length?r.concat(e):r:e}const Ji=[],B8=200;function V2(r,e){if(r.length){let t=r[r.length-1],i=t.selectionsAfter.slice(Math.max(0,t.selectionsAfter.length-B8));return i.length&&i[i.length-1].eq(e)?r:(i.push(e),bh(r,r.length-1,1e9,t.setSelAfter(i)))}else return[Ei.selection([e])]}function N8(r){let e=r[r.length-1],t=r.slice();return t[r.length-1]=e.setSelAfter(e.selectionsAfter.slice(0,e.selectionsAfter.length-1)),t}function Uf(r,e){if(!r.length)return r;let t=r.length,i=Ji;for(;t;){let s=F8(r[t-1],e,i);if(s.changes&&!s.changes.empty||s.effects.length){let n=r.slice(0,t);return n[t-1]=s,n}else e=s.mapped,t--,i=s.selectionsAfter}return i.length?[Ei.selection(i)]:Ji}function F8(r,e,t){let i=q2(r.selectionsAfter.length?r.selectionsAfter.map(o=>o.map(e)):Ji,t);if(!r.changes)return Ei.selection(i);let s=r.changes.map(e),n=e.mapDesc(r.changes,!0),a=r.mapped?r.mapped.composeDesc(n):n;return new Ei(s,Re.mapEffects(r.effects,e),a,r.startSelection.map(n),i)}const U8=/^(input\.type|delete)($|\.)/;class Xr{constructor(e,t,i=0,s=void 0){this.done=e,this.undone=t,this.prevTime=i,this.prevUserEvent=s}isolate(){return this.prevTime?new Xr(this.done,this.undone):this}addChanges(e,t,i,s,n){let a=this.done,o=a[a.length-1];return o&&o.changes&&!o.changes.empty&&e.changes&&(!i||U8.test(i))&&(!o.selectionsAfter.length&&t-this.prevTime<s.newGroupDelay&&s.joinToEvent(n,Q8(o.changes,e.changes))||i=="input.type.compose")?a=bh(a,a.length-1,s.minDepth,new Ei(e.changes.compose(o.changes),q2(Re.mapEffects(e.effects,o.changes),o.effects),o.mapped,o.startSelection,Ji)):a=bh(a,a.length,s.minDepth,e),new Xr(a,Ji,t,i)}addSelection(e,t,i,s){let n=this.done.length?this.done[this.done.length-1].selectionsAfter:Ji;return n.length>0&&t-this.prevTime<s&&i==this.prevUserEvent&&i&&/^select($|\.)/.test(i)&&$8(n[n.length-1],e)?this:new Xr(V2(this.done,e),this.undone,t,i)}addMapping(e){return new Xr(Uf(this.done,e),Uf(this.undone,e),this.prevTime,this.prevUserEvent)}pop(e,t,i){let s=e==0?this.done:this.undone;if(s.length==0)return null;let n=s[s.length-1],a=n.selectionsAfter[0]||t.selection;if(i&&n.selectionsAfter.length)return t.update({selection:n.selectionsAfter[n.selectionsAfter.length-1],annotations:Pm.of({side:e,rest:N8(s),selection:a}),userEvent:e==0?"select.undo":"select.redo",scrollIntoView:!0});if(n.changes){let o=s.length==1?Ji:s.slice(0,s.length-1);return n.mapped&&(o=Uf(o,n.mapped)),t.update({changes:n.changes,selection:n.startSelection,effects:n.effects,annotations:Pm.of({side:e,rest:o,selection:a}),filter:!1,userEvent:e==0?"undo":"redo",scrollIntoView:!0})}else return null}}Xr.empty=new Xr(Ji,Ji);const q8=[{key:"Mod-z",run:U2,preventDefault:!0},{key:"Mod-y",mac:"Mod-Shift-z",run:Dm,preventDefault:!0},{linux:"Ctrl-Shift-z",run:Dm,preventDefault:!0},{key:"Mod-u",run:R8,preventDefault:!0},{key:"Alt-u",mac:"Mod-Shift-u",run:L8,preventDefault:!0}];function so(r,e){return ie.create(r.ranges.map(e),r.mainIndex)}function Tr(r,e){return r.update({selection:e,scrollIntoView:!0,userEvent:"select"})}function _r({state:r,dispatch:e},t){let i=so(r.selection,t);return i.eq(r.selection,!0)?!1:(e(Tr(r,i)),!0)}function fd(r,e){return ie.cursor(e?r.to:r.from)}function X2(r,e){return _r(r,t=>t.empty?r.moveByChar(t,e):fd(t,e))}function li(r){return r.textDirectionAt(r.state.selection.main.head)==dt.LTR}const j2=r=>X2(r,!li(r)),z2=r=>X2(r,li(r));function Z2(r,e){return _r(r,t=>t.empty?r.moveByGroup(t,e):fd(t,e))}const V8=r=>Z2(r,!li(r)),X8=r=>Z2(r,li(r));function j8(r,e,t){if(e.type.prop(t))return!0;let i=e.to-e.from;return i&&(i>2||/[^\s,.;:]/.test(r.sliceDoc(e.from,e.to)))||e.firstChild}function pd(r,e,t){let i=nt(r).resolveInner(e.head),s=t?Ie.closedBy:Ie.openedBy;for(let l=e.head;;){let u=t?i.childAfter(l):i.childBefore(l);if(!u)break;j8(r,u,s)?i=u:l=t?u.to:u.from}let n=i.type.prop(s),a,o;return n&&(a=t?Vr(r,i.from,1):Vr(r,i.to,-1))&&a.matched?o=t?a.end.to:a.end.from:o=t?i.to:i.from,ie.cursor(o,t?-1:1)}const z8=r=>_r(r,e=>pd(r.state,e,!li(r))),Z8=r=>_r(r,e=>pd(r.state,e,li(r)));function W2(r,e){return _r(r,t=>{if(!t.empty)return fd(t,e);let i=r.moveVertically(t,e);return i.head!=t.head?i:r.moveToLineBoundary(t,e)})}const H2=r=>W2(r,!1),Y2=r=>W2(r,!0);function G2(r){let e=r.scrollDOM.clientHeight<r.scrollDOM.scrollHeight-2,t=0,i=0,s;if(e){for(let n of r.state.facet(ge.scrollMargins)){let a=n(r);a?.top&&(t=Math.max(a?.top,t)),a?.bottom&&(i=Math.max(a?.bottom,i))}s=r.scrollDOM.clientHeight-t-i}else s=(r.dom.ownerDocument.defaultView||window).innerHeight;return{marginTop:t,marginBottom:i,selfScroll:e,height:Math.max(r.defaultLineHeight,s-5)}}function K2(r,e){let t=G2(r),{state:i}=r,s=so(i.selection,a=>a.empty?r.moveVertically(a,e,t.height):fd(a,e));if(s.eq(i.selection))return!1;let n;if(t.selfScroll){let a=r.coordsAtPos(i.selection.main.head),o=r.scrollDOM.getBoundingClientRect(),l=o.top+t.marginTop,u=o.bottom-t.marginBottom;a&&a.top>l&&a.bottom<u&&(n=ge.scrollIntoView(s.main.head,{y:"start",yMargin:a.top-l}))}return r.dispatch(Tr(i,s),{effects:n}),!0}const Zv=r=>K2(r,!1),Mm=r=>K2(r,!0);function en(r,e,t){let i=r.lineBlockAt(e.head),s=r.moveToLineBoundary(e,t);if(s.head==e.head&&s.head!=(t?i.to:i.from)&&(s=r.moveToLineBoundary(e,t,!1)),!t&&s.head==i.from&&i.length){let n=/^\s*/.exec(r.state.sliceDoc(i.from,Math.min(i.from+100,i.to)))[0].length;n&&e.head!=i.from+n&&(s=ie.cursor(i.from+n))}return s}const W8=r=>_r(r,e=>en(r,e,!0)),H8=r=>_r(r,e=>en(r,e,!1)),Y8=r=>_r(r,e=>en(r,e,!li(r))),G8=r=>_r(r,e=>en(r,e,li(r))),K8=r=>_r(r,e=>ie.cursor(r.lineBlockAt(e.head).from,1)),J8=r=>_r(r,e=>ie.cursor(r.lineBlockAt(e.head).to,-1));function eF(r,e,t){let i=!1,s=so(r.selection,n=>{let a=Vr(r,n.head,-1)||Vr(r,n.head,1)||n.head>0&&Vr(r,n.head-1,1)||n.head<r.doc.length&&Vr(r,n.head+1,-1);if(!a||!a.end)return n;i=!0;let o=a.start.from==n.head?a.end.to:a.end.from;return ie.cursor(o)});return i?(e(Tr(r,s)),!0):!1}const tF=({state:r,dispatch:e})=>eF(r,e);function or(r,e){let t=so(r.state.selection,i=>{let s=e(i);return ie.range(i.anchor,s.head,s.goalColumn,s.bidiLevel||void 0)});return t.eq(r.state.selection)?!1:(r.dispatch(Tr(r.state,t)),!0)}function J2(r,e){return or(r,t=>r.moveByChar(t,e))}const eC=r=>J2(r,!li(r)),tC=r=>J2(r,li(r));function iC(r,e){return or(r,t=>r.moveByGroup(t,e))}const iF=r=>iC(r,!li(r)),rF=r=>iC(r,li(r)),sF=r=>or(r,e=>pd(r.state,e,!li(r))),nF=r=>or(r,e=>pd(r.state,e,li(r)));function rC(r,e){return or(r,t=>r.moveVertically(t,e))}const sC=r=>rC(r,!1),nC=r=>rC(r,!0);function aC(r,e){return or(r,t=>r.moveVertically(t,e,G2(r).height))}const Wv=r=>aC(r,!1),Hv=r=>aC(r,!0),aF=r=>or(r,e=>en(r,e,!0)),oF=r=>or(r,e=>en(r,e,!1)),lF=r=>or(r,e=>en(r,e,!li(r))),uF=r=>or(r,e=>en(r,e,li(r))),cF=r=>or(r,e=>ie.cursor(r.lineBlockAt(e.head).from)),hF=r=>or(r,e=>ie.cursor(r.lineBlockAt(e.head).to)),Yv=({state:r,dispatch:e})=>(e(Tr(r,{anchor:0})),!0),Gv=({state:r,dispatch:e})=>(e(Tr(r,{anchor:r.doc.length})),!0),Kv=({state:r,dispatch:e})=>(e(Tr(r,{anchor:r.selection.main.anchor,head:0})),!0),Jv=({state:r,dispatch:e})=>(e(Tr(r,{anchor:r.selection.main.anchor,head:r.doc.length})),!0),dF=({state:r,dispatch:e})=>(e(r.update({selection:{anchor:0,head:r.doc.length},userEvent:"select"})),!0),fF=({state:r,dispatch:e})=>{let t=md(r).map(({from:i,to:s})=>ie.range(i,Math.min(s+1,r.doc.length)));return e(r.update({selection:ie.create(t),userEvent:"select"})),!0},pF=({state:r,dispatch:e})=>{let t=so(r.selection,i=>{let s=nt(r),n=s.resolveStack(i.from,1);if(i.empty){let a=s.resolveStack(i.from,-1);a.node.from>=n.node.from&&a.node.to<=n.node.to&&(n=a)}for(let a=n;a;a=a.next){let{node:o}=a;if((o.from<i.from&&o.to>=i.to||o.to>i.to&&o.from<=i.from)&&a.next)return ie.range(o.to,o.from)}return i});return t.eq(r.selection)?!1:(e(Tr(r,t)),!0)};function oC(r,e){let{state:t}=r,i=t.selection,s=t.selection.ranges.slice();for(let n of t.selection.ranges){let a=t.doc.lineAt(n.head);if(e?a.to<r.state.doc.length:a.from>0)for(let o=n;;){let l=r.moveVertically(o,e);if(l.head<a.from||l.head>a.to){s.some(u=>u.head==l.head)||s.push(l);break}else{if(l.head==o.head)break;o=l}}}return s.length==i.ranges.length?!1:(r.dispatch(Tr(t,ie.create(s,s.length-1))),!0)}const mF=r=>oC(r,!1),gF=r=>oC(r,!0),OF=({state:r,dispatch:e})=>{let t=r.selection,i=null;return t.ranges.length>1?i=ie.create([t.main]):t.main.empty||(i=ie.create([ie.cursor(t.main.head)])),i?(e(Tr(r,i)),!0):!1};function lu(r,e){if(r.state.readOnly)return!1;let t="delete.selection",{state:i}=r,s=i.changeByRange(n=>{let{from:a,to:o}=n;if(a==o){let l=e(n);l<a?(t="delete.backward",l=lc(r,l,!1)):l>a&&(t="delete.forward",l=lc(r,l,!0)),a=Math.min(a,l),o=Math.max(o,l)}else a=lc(r,a,!1),o=lc(r,o,!0);return a==o?{range:n}:{changes:{from:a,to:o},range:ie.cursor(a,a<n.head?-1:1)}});return s.changes.empty?!1:(r.dispatch(i.update(s,{scrollIntoView:!0,userEvent:t,effects:t=="delete.selection"?ge.announce.of(i.phrase("Selection deleted")):void 0})),!0)}function lc(r,e,t){if(r instanceof ge)for(let i of r.state.facet(ge.atomicRanges).map(s=>s(r)))i.between(e,e,(s,n)=>{s<e&&n>e&&(e=t?n:s)});return e}const lC=(r,e,t)=>lu(r,i=>{let s=i.from,{state:n}=r,a=n.doc.lineAt(s),o,l;if(t&&!e&&s>a.from&&s<a.from+200&&!/[^ \t]/.test(o=a.text.slice(0,s-a.from))){if(o[o.length-1]=="	")return s-1;let u=yr(o,n.tabSize),c=u%gh(n)||gh(n);for(let h=0;h<c&&o[o.length-1-h]==" ";h++)s--;l=s}else l=Kt(a.text,s-a.from,e,e)+a.from,l==s&&a.number!=(e?n.doc.lines:1)?l+=e?1:-1:!e&&/[\ufe00-\ufe0f]/.test(a.text.slice(l-a.from,s-a.from))&&(l=Kt(a.text,l-a.from,!1,!1)+a.from);return l}),Im=r=>lC(r,!1,!0),uC=r=>lC(r,!0,!1),cC=(r,e)=>lu(r,t=>{let i=t.head,{state:s}=r,n=s.doc.lineAt(i),a=s.charCategorizer(i);for(let o=null;;){if(i==(e?n.to:n.from)){i==t.head&&n.number!=(e?s.doc.lines:1)&&(i+=e?1:-1);break}let l=Kt(n.text,i-n.from,e)+n.from,u=n.text.slice(Math.min(i,l)-n.from,Math.max(i,l)-n.from),c=a(u);if(o!=null&&c!=o)break;(u!=" "||i!=t.head)&&(o=c),i=l}return i}),hC=r=>cC(r,!1),yF=r=>cC(r,!0),bF=r=>lu(r,e=>{let t=r.lineBlockAt(e.head).to;return e.head<t?t:Math.min(r.state.doc.length,e.head+1)}),vF=r=>lu(r,e=>{let t=r.moveToLineBoundary(e,!1).head;return e.head>t?t:Math.max(0,e.head-1)}),SF=r=>lu(r,e=>{let t=r.moveToLineBoundary(e,!0).head;return e.head<t?t:Math.min(r.state.doc.length,e.head+1)}),TF=({state:r,dispatch:e})=>{if(r.readOnly)return!1;let t=r.changeByRange(i=>({changes:{from:i.from,to:i.to,insert:Ue.of(["",""])},range:ie.cursor(i.from)}));return e(r.update(t,{scrollIntoView:!0,userEvent:"input"})),!0},_F=({state:r,dispatch:e})=>{if(r.readOnly)return!1;let t=r.changeByRange(i=>{if(!i.empty||i.from==0||i.from==r.doc.length)return{range:i};let s=i.from,n=r.doc.lineAt(s),a=s==n.from?s-1:Kt(n.text,s-n.from,!1)+n.from,o=s==n.to?s+1:Kt(n.text,s-n.from,!0)+n.from;return{changes:{from:a,to:o,insert:r.doc.slice(s,o).append(r.doc.slice(a,s))},range:ie.cursor(o)}});return t.changes.empty?!1:(e(r.update(t,{scrollIntoView:!0,userEvent:"move.character"})),!0)};function md(r){let e=[],t=-1;for(let i of r.selection.ranges){let s=r.doc.lineAt(i.from),n=r.doc.lineAt(i.to);if(!i.empty&&i.to==n.from&&(n=r.doc.lineAt(i.to-1)),t>=s.number){let a=e[e.length-1];a.to=n.to,a.ranges.push(i)}else e.push({from:s.from,to:n.to,ranges:[i]});t=n.number+1}return e}function dC(r,e,t){if(r.readOnly)return!1;let i=[],s=[];for(let n of md(r)){if(t?n.to==r.doc.length:n.from==0)continue;let a=r.doc.lineAt(t?n.to+1:n.from-1),o=a.length+1;if(t){i.push({from:n.to,to:a.to},{from:n.from,insert:a.text+r.lineBreak});for(let l of n.ranges)s.push(ie.range(Math.min(r.doc.length,l.anchor+o),Math.min(r.doc.length,l.head+o)))}else{i.push({from:a.from,to:n.from},{from:n.to,insert:r.lineBreak+a.text});for(let l of n.ranges)s.push(ie.range(l.anchor-o,l.head-o))}}return i.length?(e(r.update({changes:i,scrollIntoView:!0,selection:ie.create(s,r.selection.mainIndex),userEvent:"move.line"})),!0):!1}const xF=({state:r,dispatch:e})=>dC(r,e,!1),wF=({state:r,dispatch:e})=>dC(r,e,!0);function fC(r,e,t){if(r.readOnly)return!1;let i=[];for(let s of md(r))t?i.push({from:s.from,insert:r.doc.slice(s.from,s.to)+r.lineBreak}):i.push({from:s.to,insert:r.lineBreak+r.doc.slice(s.from,s.to)});return e(r.update({changes:i,scrollIntoView:!0,userEvent:"input.copyline"})),!0}const CF=({state:r,dispatch:e})=>fC(r,e,!1),kF=({state:r,dispatch:e})=>fC(r,e,!0),EF=r=>{if(r.state.readOnly)return!1;let{state:e}=r,t=e.changes(md(e).map(({from:s,to:n})=>(s>0?s--:n<e.doc.length&&n++,{from:s,to:n}))),i=so(e.selection,s=>{let n;if(r.lineWrapping){let a=r.lineBlockAt(s.head),o=r.coordsAtPos(s.head,s.assoc||1);o&&(n=a.bottom+r.documentTop-o.bottom+r.defaultLineHeight/2)}return r.moveVertically(s,!0,n)}).map(t);return r.dispatch({changes:t,selection:i,scrollIntoView:!0,userEvent:"delete.line"}),!0};function AF(r,e){if(/\(\)|\[\]|\{\}/.test(r.sliceDoc(e-1,e+1)))return{from:e,to:e};let t=nt(r).resolveInner(e),i=t.childBefore(e),s=t.childAfter(e),n;return i&&s&&i.to<=e&&s.from>=e&&(n=i.type.prop(Ie.closedBy))&&n.indexOf(s.name)>-1&&r.doc.lineAt(i.to).from==r.doc.lineAt(s.from).from&&!/\S/.test(r.sliceDoc(i.to,s.from))?{from:i.to,to:s.from}:null}const eS=pC(!1),PF=pC(!0);function pC(r){return({state:e,dispatch:t})=>{if(e.readOnly)return!1;let i=e.changeByRange(s=>{let{from:n,to:a}=s,o=e.doc.lineAt(n),l=!r&&n==a&&AF(e,n);r&&(n=a=(a<=o.to?o:e.doc.lineAt(a)).to);let u=new cd(e,{simulateBreak:n,simulateDoubleBreak:!!l}),c=p0(u,n);for(c==null&&(c=yr(/^\s*/.exec(e.doc.lineAt(n).text)[0],e.tabSize));a<o.to&&/\s/.test(o.text[a-o.from]);)a++;l?{from:n,to:a}=l:n>o.from&&n<o.from+100&&!/\S/.test(o.text.slice(0,n))&&(n=o.from);let h=["",Dl(e,c)];return l&&h.push(Dl(e,u.lineIndent(o.from,-1))),{changes:{from:n,to:a,insert:Ue.of(h)},range:ie.cursor(n+1+h[1].length)}});return t(e.update(i,{scrollIntoView:!0,userEvent:"input"})),!0}}function y0(r,e){let t=-1;return r.changeByRange(i=>{let s=[];for(let a=i.from;a<=i.to;){let o=r.doc.lineAt(a);o.number>t&&(i.empty||i.to>o.from)&&(e(o,s,i),t=o.number),a=o.to+1}let n=r.changes(s);return{changes:s,range:ie.range(n.mapPos(i.anchor,1),n.mapPos(i.head,1))}})}const DF=({state:r,dispatch:e})=>{if(r.readOnly)return!1;let t=Object.create(null),i=new cd(r,{overrideIndentation:n=>{let a=t[n];return a??-1}}),s=y0(r,(n,a,o)=>{let l=p0(i,n.from);if(l==null)return;/\S/.test(n.text)||(l=0);let u=/^\s*/.exec(n.text)[0],c=Dl(r,l);(u!=c||o.from<n.from+u.length)&&(t[n.from]=l,a.push({from:n.from,to:n.from+u.length,insert:c}))});return s.changes.empty||e(r.update(s,{userEvent:"indent"})),!0},MF=({state:r,dispatch:e})=>r.readOnly?!1:(e(r.update(y0(r,(t,i)=>{i.push({from:t.from,insert:r.facet(su)})}),{userEvent:"input.indent"})),!0),IF=({state:r,dispatch:e})=>r.readOnly?!1:(e(r.update(y0(r,(t,i)=>{let s=/^\s*/.exec(t.text)[0];if(!s)return;let n=yr(s,r.tabSize),a=0,o=Dl(r,Math.max(0,n-gh(r)));for(;a<s.length&&a<o.length&&s.charCodeAt(a)==o.charCodeAt(a);)a++;i.push({from:t.from+a,to:t.from+s.length,insert:o.slice(a)})}),{userEvent:"delete.dedent"})),!0),RF=r=>(r.setTabFocusMode(),!0),LF=[{key:"Ctrl-b",run:j2,shift:eC,preventDefault:!0},{key:"Ctrl-f",run:z2,shift:tC},{key:"Ctrl-p",run:H2,shift:sC},{key:"Ctrl-n",run:Y2,shift:nC},{key:"Ctrl-a",run:K8,shift:cF},{key:"Ctrl-e",run:J8,shift:hF},{key:"Ctrl-d",run:uC},{key:"Ctrl-h",run:Im},{key:"Ctrl-k",run:bF},{key:"Ctrl-Alt-h",run:hC},{key:"Ctrl-o",run:TF},{key:"Ctrl-t",run:_F},{key:"Ctrl-v",run:Mm}],QF=[{key:"ArrowLeft",run:j2,shift:eC,preventDefault:!0},{key:"Mod-ArrowLeft",mac:"Alt-ArrowLeft",run:V8,shift:iF,preventDefault:!0},{mac:"Cmd-ArrowLeft",run:Y8,shift:lF,preventDefault:!0},{key:"ArrowRight",run:z2,shift:tC,preventDefault:!0},{key:"Mod-ArrowRight",mac:"Alt-ArrowRight",run:X8,shift:rF,preventDefault:!0},{mac:"Cmd-ArrowRight",run:G8,shift:uF,preventDefault:!0},{key:"ArrowUp",run:H2,shift:sC,preventDefault:!0},{mac:"Cmd-ArrowUp",run:Yv,shift:Kv},{mac:"Ctrl-ArrowUp",run:Zv,shift:Wv},{key:"ArrowDown",run:Y2,shift:nC,preventDefault:!0},{mac:"Cmd-ArrowDown",run:Gv,shift:Jv},{mac:"Ctrl-ArrowDown",run:Mm,shift:Hv},{key:"PageUp",run:Zv,shift:Wv},{key:"PageDown",run:Mm,shift:Hv},{key:"Home",run:H8,shift:oF,preventDefault:!0},{key:"Mod-Home",run:Yv,shift:Kv},{key:"End",run:W8,shift:aF,preventDefault:!0},{key:"Mod-End",run:Gv,shift:Jv},{key:"Enter",run:eS,shift:eS},{key:"Mod-a",run:dF},{key:"Backspace",run:Im,shift:Im,preventDefault:!0},{key:"Delete",run:uC,preventDefault:!0},{key:"Mod-Backspace",mac:"Alt-Backspace",run:hC,preventDefault:!0},{key:"Mod-Delete",mac:"Alt-Delete",run:yF,preventDefault:!0},{mac:"Mod-Backspace",run:vF,preventDefault:!0},{mac:"Mod-Delete",run:SF,preventDefault:!0}].concat(LF.map(r=>({mac:r.key,run:r.run,shift:r.shift}))),$F=[{key:"Alt-ArrowLeft",mac:"Ctrl-ArrowLeft",run:z8,shift:sF},{key:"Alt-ArrowRight",mac:"Ctrl-ArrowRight",run:Z8,shift:nF},{key:"Alt-ArrowUp",run:xF},{key:"Shift-Alt-ArrowUp",run:CF},{key:"Alt-ArrowDown",run:wF},{key:"Shift-Alt-ArrowDown",run:kF},{key:"Mod-Alt-ArrowUp",run:mF},{key:"Mod-Alt-ArrowDown",run:gF},{key:"Escape",run:OF},{key:"Mod-Enter",run:PF},{key:"Alt-l",mac:"Ctrl-l",run:fF},{key:"Mod-i",run:pF,preventDefault:!0},{key:"Mod-[",run:IF},{key:"Mod-]",run:MF},{key:"Mod-Alt-\\",run:DF},{key:"Shift-Mod-k",run:EF},{key:"Shift-Mod-\\",run:tF},{key:"Mod-/",run:x8},{key:"Alt-A",run:C8},{key:"Ctrl-m",mac:"Shift-Alt-m",run:RF}].concat(QF),tS=typeof String.prototype.normalize=="function"?r=>r.normalize("NFKD"):r=>r;class qa{constructor(e,t,i=0,s=e.length,n,a){this.test=a,this.value={from:0,to:0},this.done=!1,this.matches=[],this.buffer="",this.bufferPos=0,this.iter=e.iterRange(i,s),this.bufferStart=i,this.normalize=n?o=>n(tS(o)):tS,this.query=this.normalize(t)}peek(){if(this.bufferPos==this.buffer.length){if(this.bufferStart+=this.buffer.length,this.iter.next(),this.iter.done)return-1;this.bufferPos=0,this.buffer=this.iter.value}return xi(this.buffer,this.bufferPos)}next(){for(;this.matches.length;)this.matches.pop();return this.nextOverlapping()}nextOverlapping(){for(;;){let e=this.peek();if(e<0)return this.done=!0,this;let t=Zg(e),i=this.bufferStart+this.bufferPos;this.bufferPos+=Qr(e);let s=this.normalize(t);if(s.length)for(let n=0,a=i;;n++){let o=s.charCodeAt(n),l=this.match(o,a,this.bufferPos+this.bufferStart);if(n==s.length-1){if(l)return this.value=l,this;break}a==i&&n<t.length&&t.charCodeAt(n)==o&&a++}}}match(e,t,i){let s=null;for(let n=0;n<this.matches.length;n+=2){let a=this.matches[n],o=!1;this.query.charCodeAt(a)==e&&(a==this.query.length-1?s={from:this.matches[n+1],to:i}:(this.matches[n]++,o=!0)),o||(this.matches.splice(n,2),n-=2)}return this.query.charCodeAt(0)==e&&(this.query.length==1?s={from:t,to:i}:this.matches.push(1,t)),s&&this.test&&!this.test(s.from,s.to,this.buffer,this.bufferStart)&&(s=null),s}}typeof Symbol<"u"&&(qa.prototype[Symbol.iterator]=function(){return this});const mC={from:-1,to:-1,match:/.*/.exec("")},b0="gm"+(/x/.unicode==null?"":"u");class gC{constructor(e,t,i,s=0,n=e.length){if(this.text=e,this.to=n,this.curLine="",this.done=!1,this.value=mC,/\\[sWDnr]|\n|\r|\[\^/.test(t))return new OC(e,t,i,s,n);this.re=new RegExp(t,b0+(i?.ignoreCase?"i":"")),this.test=i?.test,this.iter=e.iter();let a=e.lineAt(s);this.curLineStart=a.from,this.matchPos=vh(e,s),this.getLine(this.curLineStart)}getLine(e){this.iter.next(e),this.iter.lineBreak?this.curLine="":(this.curLine=this.iter.value,this.curLineStart+this.curLine.length>this.to&&(this.curLine=this.curLine.slice(0,this.to-this.curLineStart)),this.iter.next())}nextLine(){this.curLineStart=this.curLineStart+this.curLine.length+1,this.curLineStart>this.to?this.curLine="":this.getLine(0)}next(){for(let e=this.matchPos-this.curLineStart;;){this.re.lastIndex=e;let t=this.matchPos<=this.to&&this.re.exec(this.curLine);if(t){let i=this.curLineStart+t.index,s=i+t[0].length;if(this.matchPos=vh(this.text,s+(i==s?1:0)),i==this.curLineStart+this.curLine.length&&this.nextLine(),(i<s||i>this.value.to)&&(!this.test||this.test(i,s,t)))return this.value={from:i,to:s,match:t},this;e=this.matchPos-this.curLineStart}else if(this.curLineStart+this.curLine.length<this.to)this.nextLine(),e=0;else return this.done=!0,this}}}const qf=new WeakMap;class xa{constructor(e,t){this.from=e,this.text=t}get to(){return this.from+this.text.length}static get(e,t,i){let s=qf.get(e);if(!s||s.from>=i||s.to<=t){let o=new xa(t,e.sliceString(t,i));return qf.set(e,o),o}if(s.from==t&&s.to==i)return s;let{text:n,from:a}=s;return a>t&&(n=e.sliceString(t,a)+n,a=t),s.to<i&&(n+=e.sliceString(s.to,i)),qf.set(e,new xa(a,n)),new xa(t,n.slice(t-a,i-a))}}class OC{constructor(e,t,i,s,n){this.text=e,this.to=n,this.done=!1,this.value=mC,this.matchPos=vh(e,s),this.re=new RegExp(t,b0+(i?.ignoreCase?"i":"")),this.test=i?.test,this.flat=xa.get(e,s,this.chunkEnd(s+5e3))}chunkEnd(e){return e>=this.to?this.to:this.text.lineAt(e).to}next(){for(;;){let e=this.re.lastIndex=this.matchPos-this.flat.from,t=this.re.exec(this.flat.text);if(t&&!t[0]&&t.index==e&&(this.re.lastIndex=e+1,t=this.re.exec(this.flat.text)),t){let i=this.flat.from+t.index,s=i+t[0].length;if((this.flat.to>=this.to||t.index+t[0].length<=this.flat.text.length-10)&&(!this.test||this.test(i,s,t)))return this.value={from:i,to:s,match:t},this.matchPos=vh(this.text,s+(i==s?1:0)),this}if(this.flat.to==this.to)return this.done=!0,this;this.flat=xa.get(this.text,this.flat.from,this.chunkEnd(this.flat.from+this.flat.text.length*2))}}}typeof Symbol<"u"&&(gC.prototype[Symbol.iterator]=OC.prototype[Symbol.iterator]=function(){return this});function BF(r){try{return new RegExp(r,b0),!0}catch{return!1}}function vh(r,e){if(e>=r.length)return e;let t=r.lineAt(e),i;for(;e<t.to&&(i=t.text.charCodeAt(e-t.from))>=56320&&i<57344;)e++;return e}function Rm(r){let e=String(r.state.doc.lineAt(r.state.selection.main.head).number),t=rt("input",{class:"cm-textfield",name:"line",value:e}),i=rt("form",{class:"cm-gotoLine",onkeydown:n=>{n.keyCode==27?(n.preventDefault(),r.dispatch({effects:ol.of(!1)}),r.focus()):n.keyCode==13&&(n.preventDefault(),s())},onsubmit:n=>{n.preventDefault(),s()}},rt("label",r.state.phrase("Go to line"),": ",t)," ",rt("button",{class:"cm-button",type:"submit"},r.state.phrase("go")),rt("button",{name:"close",onclick:()=>{r.dispatch({effects:ol.of(!1)}),r.focus()},"aria-label":r.state.phrase("close"),type:"button"},["×"]));function s(){let n=/^([+-])?(\d+)?(:\d+)?(%)?$/.exec(t.value);if(!n)return;let{state:a}=r,o=a.doc.lineAt(a.selection.main.head),[,l,u,c,h]=n,f=c?+c.slice(1):0,m=u?+u:o.number;if(u&&h){let E=m/100;l&&(E=E*(l=="-"?-1:1)+o.number/a.doc.lines),m=Math.round(a.doc.lines*E)}else u&&l&&(m=m*(l=="-"?-1:1)+o.number);let S=a.doc.line(Math.max(1,Math.min(a.doc.lines,m))),y=ie.cursor(S.from+Math.max(0,Math.min(f,S.length)));r.dispatch({effects:[ol.of(!1),ge.scrollIntoView(y.from,{y:"center"})],selection:y}),r.focus()}return{dom:i}}const ol=Re.define(),iS=jt.define({create(){return!0},update(r,e){for(let t of e.effects)t.is(ol)&&(r=t.value);return r},provide:r=>Cl.from(r,e=>e?Rm:null)}),NF=r=>{let e=wl(r,Rm);if(!e){let t=[ol.of(!0)];r.state.field(iS,!1)==null&&t.push(Re.appendConfig.of([iS,FF])),r.dispatch({effects:t}),e=wl(r,Rm)}return e&&e.dom.querySelector("input").select(),!0},FF=ge.baseTheme({".cm-panel.cm-gotoLine":{padding:"2px 6px 4px",position:"relative","& label":{fontSize:"80%"},"& [name=close]":{position:"absolute",top:"0",bottom:"0",right:"4px",backgroundColor:"inherit",border:"none",font:"inherit",padding:"0"}}}),UF={highlightWordAroundCursor:!1,minSelectionLength:1,maxMatches:100,wholeWords:!1},qF=be.define({combine(r){return Gr(r,UF,{highlightWordAroundCursor:(e,t)=>e||t,minSelectionLength:Math.min,maxMatches:Math.min})}});function VF(r){return[WF,ZF]}const XF=Ee.mark({class:"cm-selectionMatch"}),jF=Ee.mark({class:"cm-selectionMatch cm-selectionMatch-main"});function rS(r,e,t,i){return(t==0||r(e.sliceDoc(t-1,t))!=gt.Word)&&(i==e.doc.length||r(e.sliceDoc(i,i+1))!=gt.Word)}function zF(r,e,t,i){return r(e.sliceDoc(t,t+1))==gt.Word&&r(e.sliceDoc(i-1,i))==gt.Word}const ZF=Qt.fromClass(class{constructor(r){this.decorations=this.getDeco(r)}update(r){(r.selectionSet||r.docChanged||r.viewportChanged)&&(this.decorations=this.getDeco(r.view))}getDeco(r){let e=r.state.facet(qF),{state:t}=r,i=t.selection;if(i.ranges.length>1)return Ee.none;let s=i.main,n,a=null;if(s.empty){if(!e.highlightWordAroundCursor)return Ee.none;let l=t.wordAt(s.head);if(!l)return Ee.none;a=t.charCategorizer(s.head),n=t.sliceDoc(l.from,l.to)}else{let l=s.to-s.from;if(l<e.minSelectionLength||l>200)return Ee.none;if(e.wholeWords){if(n=t.sliceDoc(s.from,s.to),a=t.charCategorizer(s.head),!(rS(a,t,s.from,s.to)&&zF(a,t,s.from,s.to)))return Ee.none}else if(n=t.sliceDoc(s.from,s.to),!n)return Ee.none}let o=[];for(let l of r.visibleRanges){let u=new qa(t.doc,n,l.from,l.to);for(;!u.next().done;){let{from:c,to:h}=u.value;if((!a||rS(a,t,c,h))&&(s.empty&&c<=s.from&&h>=s.to?o.push(jF.range(c,h)):(c>=s.to||h<=s.from)&&o.push(XF.range(c,h)),o.length>e.maxMatches))return Ee.none}}return Ee.set(o)}},{decorations:r=>r.decorations}),WF=ge.baseTheme({".cm-selectionMatch":{backgroundColor:"#99ff7780"},".cm-searchMatch .cm-selectionMatch":{backgroundColor:"transparent"}}),HF=({state:r,dispatch:e})=>{let{selection:t}=r,i=ie.create(t.ranges.map(s=>r.wordAt(s.head)||ie.cursor(s.head)),t.mainIndex);return i.eq(t)?!1:(e(r.update({selection:i})),!0)};function YF(r,e){let{main:t,ranges:i}=r.selection,s=r.wordAt(t.head),n=s&&s.from==t.from&&s.to==t.to;for(let a=!1,o=new qa(r.doc,e,i[i.length-1].to);;)if(o.next(),o.done){if(a)return null;o=new qa(r.doc,e,0,Math.max(0,i[i.length-1].from-1)),a=!0}else{if(a&&i.some(l=>l.from==o.value.from))continue;if(n){let l=r.wordAt(o.value.from);if(!l||l.from!=o.value.from||l.to!=o.value.to)continue}return o.value}}const GF=({state:r,dispatch:e})=>{let{ranges:t}=r.selection;if(t.some(n=>n.from===n.to))return HF({state:r,dispatch:e});let i=r.sliceDoc(t[0].from,t[0].to);if(r.selection.ranges.some(n=>r.sliceDoc(n.from,n.to)!=i))return!1;let s=YF(r,i);return s?(e(r.update({selection:r.selection.addRange(ie.range(s.from,s.to),!1),effects:ge.scrollIntoView(s.to)})),!0):!1},no=be.define({combine(r){return Gr(r,{top:!1,caseSensitive:!1,literal:!1,regexp:!1,wholeWord:!1,createPanel:e=>new u6(e),scrollToMatch:e=>ge.scrollIntoView(e)})}});class yC{constructor(e){this.search=e.search,this.caseSensitive=!!e.caseSensitive,this.literal=!!e.literal,this.regexp=!!e.regexp,this.replace=e.replace||"",this.valid=!!this.search&&(!this.regexp||BF(this.search)),this.unquoted=this.unquote(this.search),this.wholeWord=!!e.wholeWord}unquote(e){return this.literal?e:e.replace(/\\([nrt\\])/g,(t,i)=>i=="n"?`
`:i=="r"?"\r":i=="t"?"	":"\\")}eq(e){return this.search==e.search&&this.replace==e.replace&&this.caseSensitive==e.caseSensitive&&this.regexp==e.regexp&&this.wholeWord==e.wholeWord}create(){return this.regexp?new t6(this):new JF(this)}getCursor(e,t=0,i){let s=e.doc?e:Xe.create({doc:e});return i==null&&(i=s.doc.length),this.regexp?Kn(this,s,t,i):Gn(this,s,t,i)}}class bC{constructor(e){this.spec=e}}function Gn(r,e,t,i){return new qa(e.doc,r.unquoted,t,i,r.caseSensitive?void 0:s=>s.toLowerCase(),r.wholeWord?KF(e.doc,e.charCategorizer(e.selection.main.head)):void 0)}function KF(r,e){return(t,i,s,n)=>((n>t||n+s.length<i)&&(n=Math.max(0,t-2),s=r.sliceString(n,Math.min(r.length,i+2))),(e(Sh(s,t-n))!=gt.Word||e(Th(s,t-n))!=gt.Word)&&(e(Th(s,i-n))!=gt.Word||e(Sh(s,i-n))!=gt.Word))}class JF extends bC{constructor(e){super(e)}nextMatch(e,t,i){let s=Gn(this.spec,e,i,e.doc.length).nextOverlapping();if(s.done){let n=Math.min(e.doc.length,t+this.spec.unquoted.length);s=Gn(this.spec,e,0,n).nextOverlapping()}return s.done||s.value.from==t&&s.value.to==i?null:s.value}prevMatchInRange(e,t,i){for(let s=i;;){let n=Math.max(t,s-1e4-this.spec.unquoted.length),a=Gn(this.spec,e,n,s),o=null;for(;!a.nextOverlapping().done;)o=a.value;if(o)return o;if(n==t)return null;s-=1e4}}prevMatch(e,t,i){let s=this.prevMatchInRange(e,0,t);return s||(s=this.prevMatchInRange(e,Math.max(0,i-this.spec.unquoted.length),e.doc.length)),s&&(s.from!=t||s.to!=i)?s:null}getReplacement(e){return this.spec.unquote(this.spec.replace)}matchAll(e,t){let i=Gn(this.spec,e,0,e.doc.length),s=[];for(;!i.next().done;){if(s.length>=t)return null;s.push(i.value)}return s}highlight(e,t,i,s){let n=Gn(this.spec,e,Math.max(0,t-this.spec.unquoted.length),Math.min(i+this.spec.unquoted.length,e.doc.length));for(;!n.next().done;)s(n.value.from,n.value.to)}}function Kn(r,e,t,i){return new gC(e.doc,r.search,{ignoreCase:!r.caseSensitive,test:r.wholeWord?e6(e.charCategorizer(e.selection.main.head)):void 0},t,i)}function Sh(r,e){return r.slice(Kt(r,e,!1),e)}function Th(r,e){return r.slice(e,Kt(r,e))}function e6(r){return(e,t,i)=>!i[0].length||(r(Sh(i.input,i.index))!=gt.Word||r(Th(i.input,i.index))!=gt.Word)&&(r(Th(i.input,i.index+i[0].length))!=gt.Word||r(Sh(i.input,i.index+i[0].length))!=gt.Word)}class t6 extends bC{nextMatch(e,t,i){let s=Kn(this.spec,e,i,e.doc.length).next();return s.done&&(s=Kn(this.spec,e,0,t).next()),s.done?null:s.value}prevMatchInRange(e,t,i){for(let s=1;;s++){let n=Math.max(t,i-s*1e4),a=Kn(this.spec,e,n,i),o=null;for(;!a.next().done;)o=a.value;if(o&&(n==t||o.from>n+10))return o;if(n==t)return null}}prevMatch(e,t,i){return this.prevMatchInRange(e,0,t)||this.prevMatchInRange(e,i,e.doc.length)}getReplacement(e){return this.spec.unquote(this.spec.replace).replace(/\$([$&]|\d+)/g,(t,i)=>{if(i=="&")return e.match[0];if(i=="$")return"$";for(let s=i.length;s>0;s--){let n=+i.slice(0,s);if(n>0&&n<e.match.length)return e.match[n]+i.slice(s)}return t})}matchAll(e,t){let i=Kn(this.spec,e,0,e.doc.length),s=[];for(;!i.next().done;){if(s.length>=t)return null;s.push(i.value)}return s}highlight(e,t,i,s){let n=Kn(this.spec,e,Math.max(0,t-250),Math.min(i+250,e.doc.length));for(;!n.next().done;)s(n.value.from,n.value.to)}}const Ml=Re.define(),v0=Re.define(),Xs=jt.define({create(r){return new Vf(Lm(r).create(),null)},update(r,e){for(let t of e.effects)t.is(Ml)?r=new Vf(t.value.create(),r.panel):t.is(v0)&&(r=new Vf(r.query,t.value?S0:null));return r},provide:r=>Cl.from(r,e=>e.panel)});class Vf{constructor(e,t){this.query=e,this.panel=t}}const i6=Ee.mark({class:"cm-searchMatch"}),r6=Ee.mark({class:"cm-searchMatch cm-searchMatch-selected"}),s6=Qt.fromClass(class{constructor(r){this.view=r,this.decorations=this.highlight(r.state.field(Xs))}update(r){let e=r.state.field(Xs);(e!=r.startState.field(Xs)||r.docChanged||r.selectionSet||r.viewportChanged)&&(this.decorations=this.highlight(e))}highlight({query:r,panel:e}){if(!e||!r.spec.valid)return Ee.none;let{view:t}=this,i=new ys;for(let s=0,n=t.visibleRanges,a=n.length;s<a;s++){let{from:o,to:l}=n[s];for(;s<a-1&&l>n[s+1].from-500;)l=n[++s].to;r.highlight(t.state,o,l,(u,c)=>{let h=t.state.selection.ranges.some(f=>f.from==u&&f.to==c);i.add(u,c,h?r6:i6)})}return i.finish()}},{decorations:r=>r.decorations});function uu(r){return e=>{let t=e.state.field(Xs,!1);return t&&t.query.spec.valid?r(e,t):TC(e)}}const _h=uu((r,{query:e})=>{let{to:t}=r.state.selection.main,i=e.nextMatch(r.state,t,t);if(!i)return!1;let s=ie.single(i.from,i.to),n=r.state.facet(no);return r.dispatch({selection:s,effects:[T0(r,i),n.scrollToMatch(s.main,r)],userEvent:"select.search"}),SC(r),!0}),xh=uu((r,{query:e})=>{let{state:t}=r,{from:i}=t.selection.main,s=e.prevMatch(t,i,i);if(!s)return!1;let n=ie.single(s.from,s.to),a=r.state.facet(no);return r.dispatch({selection:n,effects:[T0(r,s),a.scrollToMatch(n.main,r)],userEvent:"select.search"}),SC(r),!0}),n6=uu((r,{query:e})=>{let t=e.matchAll(r.state,1e3);return!t||!t.length?!1:(r.dispatch({selection:ie.create(t.map(i=>ie.range(i.from,i.to))),userEvent:"select.search.matches"}),!0)}),a6=({state:r,dispatch:e})=>{let t=r.selection;if(t.ranges.length>1||t.main.empty)return!1;let{from:i,to:s}=t.main,n=[],a=0;for(let o=new qa(r.doc,r.sliceDoc(i,s));!o.next().done;){if(n.length>1e3)return!1;o.value.from==i&&(a=n.length),n.push(ie.range(o.value.from,o.value.to))}return e(r.update({selection:ie.create(n,a),userEvent:"select.search.matches"})),!0},sS=uu((r,{query:e})=>{let{state:t}=r,{from:i,to:s}=t.selection.main;if(t.readOnly)return!1;let n=e.nextMatch(t,i,i);if(!n)return!1;let a=n,o=[],l,u,c=[];a.from==i&&a.to==s&&(u=t.toText(e.getReplacement(a)),o.push({from:a.from,to:a.to,insert:u}),a=e.nextMatch(t,a.from,a.to),c.push(ge.announce.of(t.phrase("replaced match on line $",t.doc.lineAt(i).number)+".")));let h=r.state.changes(o);return a&&(l=ie.single(a.from,a.to).map(h),c.push(T0(r,a)),c.push(t.facet(no).scrollToMatch(l.main,r))),r.dispatch({changes:h,selection:l,effects:c,userEvent:"input.replace"}),!0}),o6=uu((r,{query:e})=>{if(r.state.readOnly)return!1;let t=e.matchAll(r.state,1e9).map(s=>{let{from:n,to:a}=s;return{from:n,to:a,insert:e.getReplacement(s)}});if(!t.length)return!1;let i=r.state.phrase("replaced $ matches",t.length)+".";return r.dispatch({changes:t,effects:ge.announce.of(i),userEvent:"input.replace.all"}),!0});function S0(r){return r.state.facet(no).createPanel(r)}function Lm(r,e){var t,i,s,n,a;let o=r.selection.main,l=o.empty||o.to>o.from+100?"":r.sliceDoc(o.from,o.to);if(e&&!l)return e;let u=r.facet(no);return new yC({search:((t=e?.literal)!==null&&t!==void 0?t:u.literal)?l:l.replace(/\n/g,"\\n"),caseSensitive:(i=e?.caseSensitive)!==null&&i!==void 0?i:u.caseSensitive,literal:(s=e?.literal)!==null&&s!==void 0?s:u.literal,regexp:(n=e?.regexp)!==null&&n!==void 0?n:u.regexp,wholeWord:(a=e?.wholeWord)!==null&&a!==void 0?a:u.wholeWord})}function vC(r){let e=wl(r,S0);return e&&e.dom.querySelector("[main-field]")}function SC(r){let e=vC(r);e&&e==r.root.activeElement&&e.select()}const TC=r=>{let e=r.state.field(Xs,!1);if(e&&e.panel){let t=vC(r);if(t&&t!=r.root.activeElement){let i=Lm(r.state,e.query.spec);i.valid&&r.dispatch({effects:Ml.of(i)}),t.focus(),t.select()}}else r.dispatch({effects:[v0.of(!0),e?Ml.of(Lm(r.state,e.query.spec)):Re.appendConfig.of(h6)]});return!0},_C=r=>{let e=r.state.field(Xs,!1);if(!e||!e.panel)return!1;let t=wl(r,S0);return t&&t.dom.contains(r.root.activeElement)&&r.focus(),r.dispatch({effects:v0.of(!1)}),!0},l6=[{key:"Mod-f",run:TC,scope:"editor search-panel"},{key:"F3",run:_h,shift:xh,scope:"editor search-panel",preventDefault:!0},{key:"Mod-g",run:_h,shift:xh,scope:"editor search-panel",preventDefault:!0},{key:"Escape",run:_C,scope:"editor search-panel"},{key:"Mod-Shift-l",run:a6},{key:"Mod-Alt-g",run:NF},{key:"Mod-d",run:GF,preventDefault:!0}];class u6{constructor(e){this.view=e;let t=this.query=e.state.field(Xs).query.spec;this.commit=this.commit.bind(this),this.searchField=rt("input",{value:t.search,placeholder:Ri(e,"Find"),"aria-label":Ri(e,"Find"),class:"cm-textfield",name:"search",form:"","main-field":"true",onchange:this.commit,onkeyup:this.commit}),this.replaceField=rt("input",{value:t.replace,placeholder:Ri(e,"Replace"),"aria-label":Ri(e,"Replace"),class:"cm-textfield",name:"replace",form:"",onchange:this.commit,onkeyup:this.commit}),this.caseField=rt("input",{type:"checkbox",name:"case",form:"",checked:t.caseSensitive,onchange:this.commit}),this.reField=rt("input",{type:"checkbox",name:"re",form:"",checked:t.regexp,onchange:this.commit}),this.wordField=rt("input",{type:"checkbox",name:"word",form:"",checked:t.wholeWord,onchange:this.commit});function i(s,n,a){return rt("button",{class:"cm-button",name:s,onclick:n,type:"button"},a)}this.dom=rt("div",{onkeydown:s=>this.keydown(s),class:"cm-search"},[this.searchField,i("next",()=>_h(e),[Ri(e,"next")]),i("prev",()=>xh(e),[Ri(e,"previous")]),i("select",()=>n6(e),[Ri(e,"all")]),rt("label",null,[this.caseField,Ri(e,"match case")]),rt("label",null,[this.reField,Ri(e,"regexp")]),rt("label",null,[this.wordField,Ri(e,"by word")]),...e.state.readOnly?[]:[rt("br"),this.replaceField,i("replace",()=>sS(e),[Ri(e,"replace")]),i("replaceAll",()=>o6(e),[Ri(e,"replace all")])],rt("button",{name:"close",onclick:()=>_C(e),"aria-label":Ri(e,"close"),type:"button"},["×"])])}commit(){let e=new yC({search:this.searchField.value,caseSensitive:this.caseField.checked,regexp:this.reField.checked,wholeWord:this.wordField.checked,replace:this.replaceField.value});e.eq(this.query)||(this.query=e,this.view.dispatch({effects:Ml.of(e)}))}keydown(e){mB(this.view,e,"search-panel")?e.preventDefault():e.keyCode==13&&e.target==this.searchField?(e.preventDefault(),(e.shiftKey?xh:_h)(this.view)):e.keyCode==13&&e.target==this.replaceField&&(e.preventDefault(),sS(this.view))}update(e){for(let t of e.transactions)for(let i of t.effects)i.is(Ml)&&!i.value.eq(this.query)&&this.setQuery(i.value)}setQuery(e){this.query=e,this.searchField.value=e.search,this.replaceField.value=e.replace,this.caseField.checked=e.caseSensitive,this.reField.checked=e.regexp,this.wordField.checked=e.wholeWord}mount(){this.searchField.select()}get pos(){return 80}get top(){return this.view.state.facet(no).top}}function Ri(r,e){return r.state.phrase(e)}const uc=30,cc=/[\s\.,:;?!]/;function T0(r,{from:e,to:t}){let i=r.state.doc.lineAt(e),s=r.state.doc.lineAt(t).to,n=Math.max(i.from,e-uc),a=Math.min(s,t+uc),o=r.state.sliceDoc(n,a);if(n!=i.from){for(let l=0;l<uc;l++)if(!cc.test(o[l+1])&&cc.test(o[l])){o=o.slice(l);break}}if(a!=s){for(let l=o.length-1;l>o.length-uc;l--)if(!cc.test(o[l-1])&&cc.test(o[l])){o=o.slice(0,l);break}}return ge.announce.of(`${r.state.phrase("current match")}. ${o} ${r.state.phrase("on line")} ${i.number}.`)}const c6=ge.baseTheme({".cm-panel.cm-search":{padding:"2px 6px 4px",position:"relative","& [name=close]":{position:"absolute",top:"0",right:"4px",backgroundColor:"inherit",border:"none",font:"inherit",padding:0,margin:0},"& input, & button, & label":{margin:".2em .6em .2em 0"},"& input[type=checkbox]":{marginRight:".2em"},"& label":{fontSize:"80%",whiteSpace:"pre"}},"&light .cm-searchMatch":{backgroundColor:"#ffff0054"},"&dark .cm-searchMatch":{backgroundColor:"#00ffff8a"},"&light .cm-searchMatch-selected":{backgroundColor:"#ff6a0054"},"&dark .cm-searchMatch-selected":{backgroundColor:"#ff00ff8a"}}),h6=[Xs,Ss.low(s6),c6];class _0{constructor(e,t,i,s){this.state=e,this.pos=t,this.explicit=i,this.view=s,this.abortListeners=[],this.abortOnDocChange=!1}tokenBefore(e){let t=nt(this.state).resolveInner(this.pos,-1);for(;t&&e.indexOf(t.name)<0;)t=t.parent;return t?{from:t.from,to:this.pos,text:this.state.sliceDoc(t.from,this.pos),type:t.type}:null}matchBefore(e){let t=this.state.doc.lineAt(this.pos),i=Math.max(t.from,this.pos-250),s=t.text.slice(i-t.from,this.pos-t.from),n=s.search(wC(e,!1));return n<0?null:{from:i+n,to:this.pos,text:s.slice(n)}}get aborted(){return this.abortListeners==null}addEventListener(e,t,i){e=="abort"&&this.abortListeners&&(this.abortListeners.push(t),i&&i.onDocChange&&(this.abortOnDocChange=!0))}}function nS(r){let e=Object.keys(r).join(""),t=/\w/.test(e);return t&&(e=e.replace(/\w/g,"")),`[${t?"\\w":""}${e.replace(/[^\w\s]/g,"\\$&")}]`}function d6(r){let e=Object.create(null),t=Object.create(null);for(let{label:s}of r){e[s[0]]=!0;for(let n=1;n<s.length;n++)t[s[n]]=!0}let i=nS(e)+nS(t)+"*$";return[new RegExp("^"+i),new RegExp(i)]}function xC(r){let e=r.map(s=>typeof s=="string"?{label:s}:s),[t,i]=e.every(s=>/^\w+$/.test(s.label))?[/\w*$/,/\w+$/]:d6(e);return s=>{let n=s.matchBefore(i);return n||s.explicit?{from:n?n.from:s.pos,options:e,validFor:t}:null}}function f6(r,e){return t=>{for(let i=nt(t.state).resolveInner(t.pos,-1);i;i=i.parent){if(r.indexOf(i.name)>-1)return null;if(i.type.isTop)break}return e(t)}}class aS{constructor(e,t,i,s){this.completion=e,this.source=t,this.match=i,this.score=s}}function Dn(r){return r.selection.main.from}function wC(r,e){var t;let{source:i}=r,s=e&&i[0]!="^",n=i[i.length-1]!="$";return!s&&!n?r:new RegExp(`${s?"^":""}(?:${i})${n?"$":""}`,(t=r.flags)!==null&&t!==void 0?t:r.ignoreCase?"i":"")}const x0=Ts.define();function p6(r,e,t,i){let{main:s}=r.selection,n=t-s.from,a=i-s.from;return{...r.changeByRange(o=>{if(o!=s&&t!=i&&r.sliceDoc(o.from+n,o.from+a)!=r.sliceDoc(t,i))return{range:o};let l=r.toText(e);return{changes:{from:o.from+n,to:i==s.from?o.to:o.from+a,insert:l},range:ie.cursor(o.from+n+l.length)}}),scrollIntoView:!0,userEvent:"input.complete"}}const oS=new WeakMap;function m6(r){if(!Array.isArray(r))return r;let e=oS.get(r);return e||oS.set(r,e=xC(r)),e}const wh=Re.define(),Il=Re.define();class g6{constructor(e){this.pattern=e,this.chars=[],this.folded=[],this.any=[],this.precise=[],this.byWord=[],this.score=0,this.matched=[];for(let t=0;t<e.length;){let i=xi(e,t),s=Qr(i);this.chars.push(i);let n=e.slice(t,t+s),a=n.toUpperCase();this.folded.push(xi(a==n?n.toLowerCase():a,0)),t+=s}this.astral=e.length!=this.chars.length}ret(e,t){return this.score=e,this.matched=t,this}match(e){if(this.pattern.length==0)return this.ret(-100,[]);if(e.length<this.pattern.length)return null;let{chars:t,folded:i,any:s,precise:n,byWord:a}=this;if(t.length==1){let _=xi(e,0),v=Qr(_),T=v==e.length?0:-100;if(_!=t[0])if(_==i[0])T+=-200;else return null;return this.ret(T,[0,v])}let o=e.indexOf(this.pattern);if(o==0)return this.ret(e.length==this.pattern.length?0:-100,[0,this.pattern.length]);let l=t.length,u=0;if(o<0){for(let _=0,v=Math.min(e.length,200);_<v&&u<l;){let T=xi(e,_);(T==t[u]||T==i[u])&&(s[u++]=_),_+=Qr(T)}if(u<l)return null}let c=0,h=0,f=!1,m=0,S=-1,y=-1,E=/[a-z]/.test(e),C=!0;for(let _=0,v=Math.min(e.length,200),T=0;_<v&&h<l;){let w=xi(e,_);o<0&&(c<l&&w==t[c]&&(n[c++]=_),m<l&&(w==t[m]||w==i[m]?(m==0&&(S=_),y=_+1,m++):m=0));let A,I=w<255?w>=48&&w<=57||w>=97&&w<=122?2:w>=65&&w<=90?1:0:(A=Zg(w))!=A.toLowerCase()?1:A!=A.toUpperCase()?2:0;(!_||I==1&&E||T==0&&I!=0)&&(t[h]==w||i[h]==w&&(f=!0)?a[h++]=_:a.length&&(C=!1)),T=I,_+=Qr(w)}return h==l&&a[0]==0&&C?this.result(-100+(f?-200:0),a,e):m==l&&S==0?this.ret(-200-e.length+(y==e.length?0:-100),[0,y]):o>-1?this.ret(-700-e.length,[o,o+this.pattern.length]):m==l?this.ret(-900-e.length,[S,y]):h==l?this.result(-100+(f?-200:0)+-700+(C?0:-1100),a,e):t.length==2?null:this.result((s[0]?-700:0)+-200+-1100,s,e)}result(e,t,i){let s=[],n=0;for(let a of t){let o=a+(this.astral?Qr(xi(i,a)):1);n&&s[n-1]==a?s[n-1]=o:(s[n++]=a,s[n++]=o)}return this.ret(e-i.length,s)}}class O6{constructor(e){this.pattern=e,this.matched=[],this.score=0,this.folded=e.toLowerCase()}match(e){if(e.length<this.pattern.length)return null;let t=e.slice(0,this.pattern.length),i=t==this.pattern?0:t.toLowerCase()==this.folded?-200:null;return i==null?null:(this.matched=[0,t.length],this.score=i+(e.length==this.pattern.length?0:-100),this)}}const Vt=be.define({combine(r){return Gr(r,{activateOnTyping:!0,activateOnCompletion:()=>!1,activateOnTypingDelay:100,selectOnOpen:!0,override:null,closeOnBlur:!0,maxRenderedOptions:100,defaultKeymap:!0,tooltipClass:()=>"",optionClass:()=>"",aboveCursor:!1,icons:!0,addToOptions:[],positionInfo:y6,filterStrict:!1,compareCompletions:(e,t)=>e.label.localeCompare(t.label),interactionDelay:75,updateSyncTime:100},{defaultKeymap:(e,t)=>e&&t,closeOnBlur:(e,t)=>e&&t,icons:(e,t)=>e&&t,tooltipClass:(e,t)=>i=>lS(e(i),t(i)),optionClass:(e,t)=>i=>lS(e(i),t(i)),addToOptions:(e,t)=>e.concat(t),filterStrict:(e,t)=>e||t})}});function lS(r,e){return r?e?r+" "+e:r:e}function y6(r,e,t,i,s,n){let a=r.textDirection==dt.RTL,o=a,l=!1,u="top",c,h,f=e.left-s.left,m=s.right-e.right,S=i.right-i.left,y=i.bottom-i.top;if(o&&f<Math.min(S,m)?o=!1:!o&&m<Math.min(S,f)&&(o=!0),S<=(o?f:m))c=Math.max(s.top,Math.min(t.top,s.bottom-y))-e.top,h=Math.min(400,o?f:m);else{l=!0,h=Math.min(400,(a?e.right:s.right-e.left)-30);let _=s.bottom-e.bottom;_>=y||_>e.top?c=t.bottom-e.top:(u="bottom",c=e.bottom-t.top)}let E=(e.bottom-e.top)/n.offsetHeight,C=(e.right-e.left)/n.offsetWidth;return{style:`${u}: ${c/E}px; max-width: ${h/C}px`,class:"cm-completionInfo-"+(l?a?"left-narrow":"right-narrow":o?"left":"right")}}function b6(r){let e=r.addToOptions.slice();return r.icons&&e.push({render(t){let i=document.createElement("div");return i.classList.add("cm-completionIcon"),t.type&&i.classList.add(...t.type.split(/\s+/g).map(s=>"cm-completionIcon-"+s)),i.setAttribute("aria-hidden","true"),i},position:20}),e.push({render(t,i,s,n){let a=document.createElement("span");a.className="cm-completionLabel";let o=t.displayLabel||t.label,l=0;for(let u=0;u<n.length;){let c=n[u++],h=n[u++];c>l&&a.appendChild(document.createTextNode(o.slice(l,c)));let f=a.appendChild(document.createElement("span"));f.appendChild(document.createTextNode(o.slice(c,h))),f.className="cm-completionMatchedText",l=h}return l<o.length&&a.appendChild(document.createTextNode(o.slice(l))),a},position:50},{render(t){if(!t.detail)return null;let i=document.createElement("span");return i.className="cm-completionDetail",i.textContent=t.detail,i},position:80}),e.sort((t,i)=>t.position-i.position).map(t=>t.render)}function Xf(r,e,t){if(r<=t)return{from:0,to:r};if(e<0&&(e=0),e<=r>>1){let s=Math.floor(e/t);return{from:s*t,to:(s+1)*t}}let i=Math.floor((r-e)/t);return{from:r-(i+1)*t,to:r-i*t}}class v6{constructor(e,t,i){this.view=e,this.stateField=t,this.applyCompletion=i,this.info=null,this.infoDestroy=null,this.placeInfoReq={read:()=>this.measureInfo(),write:l=>this.placeInfo(l),key:this},this.space=null,this.currentClass="";let s=e.state.field(t),{options:n,selected:a}=s.open,o=e.state.facet(Vt);this.optionContent=b6(o),this.optionClass=o.optionClass,this.tooltipClass=o.tooltipClass,this.range=Xf(n.length,a,o.maxRenderedOptions),this.dom=document.createElement("div"),this.dom.className="cm-tooltip-autocomplete",this.updateTooltipClass(e.state),this.dom.addEventListener("mousedown",l=>{let{options:u}=e.state.field(t).open;for(let c=l.target,h;c&&c!=this.dom;c=c.parentNode)if(c.nodeName=="LI"&&(h=/-(\d+)$/.exec(c.id))&&+h[1]<u.length){this.applyCompletion(e,u[+h[1]]),l.preventDefault();return}}),this.dom.addEventListener("focusout",l=>{let u=e.state.field(this.stateField,!1);u&&u.tooltip&&e.state.facet(Vt).closeOnBlur&&l.relatedTarget!=e.contentDOM&&e.dispatch({effects:Il.of(null)})}),this.showOptions(n,s.id)}mount(){this.updateSel()}showOptions(e,t){this.list&&this.list.remove(),this.list=this.dom.appendChild(this.createListBox(e,t,this.range)),this.list.addEventListener("scroll",()=>{this.info&&this.view.requestMeasure(this.placeInfoReq)})}update(e){var t;let i=e.state.field(this.stateField),s=e.startState.field(this.stateField);if(this.updateTooltipClass(e.state),i!=s){let{options:n,selected:a,disabled:o}=i.open;(!s.open||s.open.options!=n)&&(this.range=Xf(n.length,a,e.state.facet(Vt).maxRenderedOptions),this.showOptions(n,i.id)),this.updateSel(),o!=((t=s.open)===null||t===void 0?void 0:t.disabled)&&this.dom.classList.toggle("cm-tooltip-autocomplete-disabled",!!o)}}updateTooltipClass(e){let t=this.tooltipClass(e);if(t!=this.currentClass){for(let i of this.currentClass.split(" "))i&&this.dom.classList.remove(i);for(let i of t.split(" "))i&&this.dom.classList.add(i);this.currentClass=t}}positioned(e){this.space=e,this.info&&this.view.requestMeasure(this.placeInfoReq)}updateSel(){let e=this.view.state.field(this.stateField),t=e.open;if((t.selected>-1&&t.selected<this.range.from||t.selected>=this.range.to)&&(this.range=Xf(t.options.length,t.selected,this.view.state.facet(Vt).maxRenderedOptions),this.showOptions(t.options,e.id)),this.updateSelectedOption(t.selected)){this.destroyInfo();let{completion:i}=t.options[t.selected],{info:s}=i;if(!s)return;let n=typeof s=="string"?document.createTextNode(s):s(i);if(!n)return;"then"in n?n.then(a=>{a&&this.view.state.field(this.stateField,!1)==e&&this.addInfoPane(a,i)}).catch(a=>ki(this.view.state,a,"completion info")):this.addInfoPane(n,i)}}addInfoPane(e,t){this.destroyInfo();let i=this.info=document.createElement("div");if(i.className="cm-tooltip cm-completionInfo",e.nodeType!=null)i.appendChild(e),this.infoDestroy=null;else{let{dom:s,destroy:n}=e;i.appendChild(s),this.infoDestroy=n||null}this.dom.appendChild(i),this.view.requestMeasure(this.placeInfoReq)}updateSelectedOption(e){let t=null;for(let i=this.list.firstChild,s=this.range.from;i;i=i.nextSibling,s++)i.nodeName!="LI"||!i.id?s--:s==e?i.hasAttribute("aria-selected")||(i.setAttribute("aria-selected","true"),t=i):i.hasAttribute("aria-selected")&&i.removeAttribute("aria-selected");return t&&T6(this.list,t),t}measureInfo(){let e=this.dom.querySelector("[aria-selected]");if(!e||!this.info)return null;let t=this.dom.getBoundingClientRect(),i=this.info.getBoundingClientRect(),s=e.getBoundingClientRect(),n=this.space;if(!n){let a=this.dom.ownerDocument.documentElement;n={left:0,top:0,right:a.clientWidth,bottom:a.clientHeight}}return s.top>Math.min(n.bottom,t.bottom)-10||s.bottom<Math.max(n.top,t.top)+10?null:this.view.state.facet(Vt).positionInfo(this.view,t,s,i,n,this.dom)}placeInfo(e){this.info&&(e?(e.style&&(this.info.style.cssText=e.style),this.info.className="cm-tooltip cm-completionInfo "+(e.class||"")):this.info.style.cssText="top: -1e6px")}createListBox(e,t,i){const s=document.createElement("ul");s.id=t,s.setAttribute("role","listbox"),s.setAttribute("aria-expanded","true"),s.setAttribute("aria-label",this.view.state.phrase("Completions")),s.addEventListener("mousedown",a=>{a.target==s&&a.preventDefault()});let n=null;for(let a=i.from;a<i.to;a++){let{completion:o,match:l}=e[a],{section:u}=o;if(u){let f=typeof u=="string"?u:u.name;if(f!=n&&(a>i.from||i.from==0))if(n=f,typeof u!="string"&&u.header)s.appendChild(u.header(u));else{let m=s.appendChild(document.createElement("completion-section"));m.textContent=f}}const c=s.appendChild(document.createElement("li"));c.id=t+"-"+a,c.setAttribute("role","option");let h=this.optionClass(o);h&&(c.className=h);for(let f of this.optionContent){let m=f(o,this.view.state,this.view,l);m&&c.appendChild(m)}}return i.from&&s.classList.add("cm-completionListIncompleteTop"),i.to<e.length&&s.classList.add("cm-completionListIncompleteBottom"),s}destroyInfo(){this.info&&(this.infoDestroy&&this.infoDestroy(),this.info.remove(),this.info=null)}destroy(){this.destroyInfo()}}function S6(r,e){return t=>new v6(t,r,e)}function T6(r,e){let t=r.getBoundingClientRect(),i=e.getBoundingClientRect(),s=t.height/r.offsetHeight;i.top<t.top?r.scrollTop-=(t.top-i.top)/s:i.bottom>t.bottom&&(r.scrollTop+=(i.bottom-t.bottom)/s)}function uS(r){return(r.boost||0)*100+(r.apply?10:0)+(r.info?5:0)+(r.type?1:0)}function _6(r,e){let t=[],i=null,s=null,n=c=>{t.push(c);let{section:h}=c.completion;if(h){i||(i=[]);let f=typeof h=="string"?h:h.name;i.some(m=>m.name==f)||i.push(typeof h=="string"?{name:f}:h)}},a=e.facet(Vt);for(let c of r)if(c.hasResult()){let h=c.result.getMatch;if(c.result.filter===!1)for(let f of c.result.options)n(new aS(f,c.source,h?h(f):[],1e9-t.length));else{let f=e.sliceDoc(c.from,c.to),m,S=a.filterStrict?new O6(f):new g6(f);for(let y of c.result.options)if(m=S.match(y.label)){let E=y.displayLabel?h?h(y,m.matched):[]:m.matched,C=m.score+(y.boost||0);if(n(new aS(y,c.source,E,C)),typeof y.section=="object"&&y.section.rank==="dynamic"){let{name:_}=y.section;s||(s=Object.create(null)),s[_]=Math.max(C,s[_]||-1e9)}}}}if(i){let c=Object.create(null),h=0,f=(m,S)=>(m.rank==="dynamic"&&S.rank==="dynamic"?s[S.name]-s[m.name]:0)||(typeof m.rank=="number"?m.rank:1e9)-(typeof S.rank=="number"?S.rank:1e9)||(m.name<S.name?-1:1);for(let m of i.sort(f))h-=1e5,c[m.name]=h;for(let m of t){let{section:S}=m.completion;S&&(m.score+=c[typeof S=="string"?S:S.name])}}let o=[],l=null,u=a.compareCompletions;for(let c of t.sort((h,f)=>f.score-h.score||u(h.completion,f.completion))){let h=c.completion;!l||l.label!=h.label||l.detail!=h.detail||l.type!=null&&h.type!=null&&l.type!=h.type||l.apply!=h.apply||l.boost!=h.boost?o.push(c):uS(c.completion)>uS(l)&&(o[o.length-1]=c),l=c.completion}return o}class oa{constructor(e,t,i,s,n,a){this.options=e,this.attrs=t,this.tooltip=i,this.timestamp=s,this.selected=n,this.disabled=a}setSelected(e,t){return e==this.selected||e>=this.options.length?this:new oa(this.options,cS(t,e),this.tooltip,this.timestamp,e,this.disabled)}static build(e,t,i,s,n,a){if(s&&!a&&e.some(u=>u.isPending))return s.setDisabled();let o=_6(e,t);if(!o.length)return s&&e.some(u=>u.isPending)?s.setDisabled():null;let l=t.facet(Vt).selectOnOpen?0:-1;if(s&&s.selected!=l&&s.selected!=-1){let u=s.options[s.selected].completion;for(let c=0;c<o.length;c++)if(o[c].completion==u){l=c;break}}return new oa(o,cS(i,l),{pos:e.reduce((u,c)=>c.hasResult()?Math.min(u,c.from):u,1e8),create:A6,above:n.aboveCursor},s?s.timestamp:Date.now(),l,!1)}map(e){return new oa(this.options,this.attrs,{...this.tooltip,pos:e.mapPos(this.tooltip.pos)},this.timestamp,this.selected,this.disabled)}setDisabled(){return new oa(this.options,this.attrs,this.tooltip,this.timestamp,this.selected,!0)}}class Ch{constructor(e,t,i){this.active=e,this.id=t,this.open=i}static start(){return new Ch(k6,"cm-ac-"+Math.floor(Math.random()*2e6).toString(36),null)}update(e){let{state:t}=e,i=t.facet(Vt),n=(i.override||t.languageDataAt("autocomplete",Dn(t)).map(m6)).map(l=>(this.active.find(c=>c.source==l)||new er(l,this.active.some(c=>c.state!=0)?1:0)).update(e,i));n.length==this.active.length&&n.every((l,u)=>l==this.active[u])&&(n=this.active);let a=this.open,o=e.effects.some(l=>l.is(w0));a&&e.docChanged&&(a=a.map(e.changes)),e.selection||n.some(l=>l.hasResult()&&e.changes.touchesRange(l.from,l.to))||!x6(n,this.active)||o?a=oa.build(n,t,this.id,a,i,o):a&&a.disabled&&!n.some(l=>l.isPending)&&(a=null),!a&&n.every(l=>!l.isPending)&&n.some(l=>l.hasResult())&&(n=n.map(l=>l.hasResult()?new er(l.source,0):l));for(let l of e.effects)l.is(kC)&&(a=a&&a.setSelected(l.value,this.id));return n==this.active&&a==this.open?this:new Ch(n,this.id,a)}get tooltip(){return this.open?this.open.tooltip:null}get attrs(){return this.open?this.open.attrs:this.active.length?w6:C6}}function x6(r,e){if(r==e)return!0;for(let t=0,i=0;;){for(;t<r.length&&!r[t].hasResult();)t++;for(;i<e.length&&!e[i].hasResult();)i++;let s=t==r.length,n=i==e.length;if(s||n)return s==n;if(r[t++].result!=e[i++].result)return!1}}const w6={"aria-autocomplete":"list"},C6={};function cS(r,e){let t={"aria-autocomplete":"list","aria-haspopup":"listbox","aria-controls":r};return e>-1&&(t["aria-activedescendant"]=r+"-"+e),t}const k6=[];function CC(r,e){if(r.isUserEvent("input.complete")){let i=r.annotation(x0);if(i&&e.activateOnCompletion(i))return 12}let t=r.isUserEvent("input.type");return t&&e.activateOnTyping?5:t?1:r.isUserEvent("delete.backward")?2:r.selection?8:r.docChanged?16:0}class er{constructor(e,t,i=!1){this.source=e,this.state=t,this.explicit=i}hasResult(){return!1}get isPending(){return this.state==1}update(e,t){let i=CC(e,t),s=this;(i&8||i&16&&this.touches(e))&&(s=new er(s.source,0)),i&4&&s.state==0&&(s=new er(this.source,1)),s=s.updateFor(e,i);for(let n of e.effects)if(n.is(wh))s=new er(s.source,1,n.value);else if(n.is(Il))s=new er(s.source,0);else if(n.is(w0))for(let a of n.value)a.source==s.source&&(s=a);return s}updateFor(e,t){return this.map(e.changes)}map(e){return this}touches(e){return e.changes.touchesRange(Dn(e.state))}}class wa extends er{constructor(e,t,i,s,n,a){super(e,3,t),this.limit=i,this.result=s,this.from=n,this.to=a}hasResult(){return!0}updateFor(e,t){var i;if(!(t&3))return this.map(e.changes);let s=this.result;s.map&&!e.changes.empty&&(s=s.map(s,e.changes));let n=e.changes.mapPos(this.from),a=e.changes.mapPos(this.to,1),o=Dn(e.state);if(o>a||!s||t&2&&(Dn(e.startState)==this.from||o<this.limit))return new er(this.source,t&4?1:0);let l=e.changes.mapPos(this.limit);return E6(s.validFor,e.state,n,a)?new wa(this.source,this.explicit,l,s,n,a):s.update&&(s=s.update(s,n,a,new _0(e.state,o,!1)))?new wa(this.source,this.explicit,l,s,s.from,(i=s.to)!==null&&i!==void 0?i:Dn(e.state)):new er(this.source,1,this.explicit)}map(e){return e.empty?this:(this.result.map?this.result.map(this.result,e):this.result)?new wa(this.source,this.explicit,e.mapPos(this.limit),this.result,e.mapPos(this.from),e.mapPos(this.to,1)):new er(this.source,0)}touches(e){return e.changes.touchesRange(this.from,this.to)}}function E6(r,e,t,i){if(!r)return!1;let s=e.sliceDoc(t,i);return typeof r=="function"?r(s,t,i,e):wC(r,!0).test(s)}const w0=Re.define({map(r,e){return r.map(t=>t.map(e))}}),kC=Re.define(),wi=jt.define({create(){return Ch.start()},update(r,e){return r.update(e)},provide:r=>[o0.from(r,e=>e.tooltip),ge.contentAttributes.from(r,e=>e.attrs)]});function C0(r,e){const t=e.completion.apply||e.completion.label;let i=r.state.field(wi).active.find(s=>s.source==e.source);return i instanceof wa?(typeof t=="string"?r.dispatch({...p6(r.state,t,i.from,i.to),annotations:x0.of(e.completion)}):t(r,e.completion,i.from,i.to),!0):!1}const A6=S6(wi,C0);function hc(r,e="option"){return t=>{let i=t.state.field(wi,!1);if(!i||!i.open||i.open.disabled||Date.now()-i.open.timestamp<t.state.facet(Vt).interactionDelay)return!1;let s=1,n;e=="page"&&(n=l2(t,i.open.tooltip))&&(s=Math.max(2,Math.floor(n.dom.offsetHeight/n.dom.querySelector("li").offsetHeight)-1));let{length:a}=i.open.options,o=i.open.selected>-1?i.open.selected+s*(r?1:-1):r?0:a-1;return o<0?o=e=="page"?0:a-1:o>=a&&(o=e=="page"?a-1:0),t.dispatch({effects:kC.of(o)}),!0}}const P6=r=>{let e=r.state.field(wi,!1);return r.state.readOnly||!e||!e.open||e.open.selected<0||e.open.disabled||Date.now()-e.open.timestamp<r.state.facet(Vt).interactionDelay?!1:C0(r,e.open.options[e.open.selected])},jf=r=>r.state.field(wi,!1)?(r.dispatch({effects:wh.of(!0)}),!0):!1,D6=r=>{let e=r.state.field(wi,!1);return!e||!e.active.some(t=>t.state!=0)?!1:(r.dispatch({effects:Il.of(null)}),!0)};class M6{constructor(e,t){this.active=e,this.context=t,this.time=Date.now(),this.updates=[],this.done=void 0}}const I6=50,R6=1e3,L6=Qt.fromClass(class{constructor(r){this.view=r,this.debounceUpdate=-1,this.running=[],this.debounceAccept=-1,this.pendingStart=!1,this.composing=0;for(let e of r.state.field(wi).active)e.isPending&&this.startQuery(e)}update(r){let e=r.state.field(wi),t=r.state.facet(Vt);if(!r.selectionSet&&!r.docChanged&&r.startState.field(wi)==e)return;let i=r.transactions.some(n=>{let a=CC(n,t);return a&8||(n.selection||n.docChanged)&&!(a&3)});for(let n=0;n<this.running.length;n++){let a=this.running[n];if(i||a.context.abortOnDocChange&&r.docChanged||a.updates.length+r.transactions.length>I6&&Date.now()-a.time>R6){for(let o of a.context.abortListeners)try{o()}catch(l){ki(this.view.state,l)}a.context.abortListeners=null,this.running.splice(n--,1)}else a.updates.push(...r.transactions)}this.debounceUpdate>-1&&clearTimeout(this.debounceUpdate),r.transactions.some(n=>n.effects.some(a=>a.is(wh)))&&(this.pendingStart=!0);let s=this.pendingStart?50:t.activateOnTypingDelay;if(this.debounceUpdate=e.active.some(n=>n.isPending&&!this.running.some(a=>a.active.source==n.source))?setTimeout(()=>this.startUpdate(),s):-1,this.composing!=0)for(let n of r.transactions)n.isUserEvent("input.type")?this.composing=2:this.composing==2&&n.selection&&(this.composing=3)}startUpdate(){this.debounceUpdate=-1,this.pendingStart=!1;let{state:r}=this.view,e=r.field(wi);for(let t of e.active)t.isPending&&!this.running.some(i=>i.active.source==t.source)&&this.startQuery(t);this.running.length&&e.open&&e.open.disabled&&(this.debounceAccept=setTimeout(()=>this.accept(),this.view.state.facet(Vt).updateSyncTime))}startQuery(r){let{state:e}=this.view,t=Dn(e),i=new _0(e,t,r.explicit,this.view),s=new M6(r,i);this.running.push(s),Promise.resolve(r.source(i)).then(n=>{s.context.aborted||(s.done=n||null,this.scheduleAccept())},n=>{this.view.dispatch({effects:Il.of(null)}),ki(this.view.state,n)})}scheduleAccept(){this.running.every(r=>r.done!==void 0)?this.accept():this.debounceAccept<0&&(this.debounceAccept=setTimeout(()=>this.accept(),this.view.state.facet(Vt).updateSyncTime))}accept(){var r;this.debounceAccept>-1&&clearTimeout(this.debounceAccept),this.debounceAccept=-1;let e=[],t=this.view.state.facet(Vt),i=this.view.state.field(wi);for(let s=0;s<this.running.length;s++){let n=this.running[s];if(n.done===void 0)continue;if(this.running.splice(s--,1),n.done){let o=Dn(n.updates.length?n.updates[0].startState:this.view.state),l=Math.min(o,n.done.from+(n.active.explicit?0:1)),u=new wa(n.active.source,n.active.explicit,l,n.done,n.done.from,(r=n.done.to)!==null&&r!==void 0?r:o);for(let c of n.updates)u=u.update(c,t);if(u.hasResult()){e.push(u);continue}}let a=i.active.find(o=>o.source==n.active.source);if(a&&a.isPending)if(n.done==null){let o=new er(n.active.source,0);for(let l of n.updates)o=o.update(l,t);o.isPending||e.push(o)}else this.startQuery(a)}(e.length||i.open&&i.open.disabled)&&this.view.dispatch({effects:w0.of(e)})}},{eventHandlers:{blur(r){let e=this.view.state.field(wi,!1);if(e&&e.tooltip&&this.view.state.facet(Vt).closeOnBlur){let t=e.open&&l2(this.view,e.open.tooltip);(!t||!t.dom.contains(r.relatedTarget))&&setTimeout(()=>this.view.dispatch({effects:Il.of(null)}),10)}},compositionstart(){this.composing=1},compositionend(){this.composing==3&&setTimeout(()=>this.view.dispatch({effects:wh.of(!1)}),20),this.composing=0}}}),Q6=typeof navigator=="object"&&/Win/.test(navigator.platform),$6=Ss.highest(ge.domEventHandlers({keydown(r,e){let t=e.state.field(wi,!1);if(!t||!t.open||t.open.disabled||t.open.selected<0||r.key.length>1||r.ctrlKey&&!(Q6&&r.altKey)||r.metaKey)return!1;let i=t.open.options[t.open.selected],s=t.active.find(a=>a.source==i.source),n=i.completion.commitCharacters||s.result.commitCharacters;return n&&n.indexOf(r.key)>-1&&C0(e,i),!1}})),EC=ge.baseTheme({".cm-tooltip.cm-tooltip-autocomplete":{"& > ul":{fontFamily:"monospace",whiteSpace:"nowrap",overflow:"hidden auto",maxWidth_fallback:"700px",maxWidth:"min(700px, 95vw)",minWidth:"250px",maxHeight:"10em",height:"100%",listStyle:"none",margin:0,padding:0,"& > li, & > completion-section":{padding:"1px 3px",lineHeight:1.2},"& > li":{overflowX:"hidden",textOverflow:"ellipsis",cursor:"pointer"},"& > completion-section":{display:"list-item",borderBottom:"1px solid silver",paddingLeft:"0.5em",opacity:.7}}},"&light .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#17c",color:"white"},"&light .cm-tooltip-autocomplete-disabled ul li[aria-selected]":{background:"#777"},"&dark .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#347",color:"white"},"&dark .cm-tooltip-autocomplete-disabled ul li[aria-selected]":{background:"#444"},".cm-completionListIncompleteTop:before, .cm-completionListIncompleteBottom:after":{content:'"···"',opacity:.5,display:"block",textAlign:"center"},".cm-tooltip.cm-completionInfo":{position:"absolute",padding:"3px 9px",width:"max-content",maxWidth:"400px",boxSizing:"border-box",whiteSpace:"pre-line"},".cm-completionInfo.cm-completionInfo-left":{right:"100%"},".cm-completionInfo.cm-completionInfo-right":{left:"100%"},".cm-completionInfo.cm-completionInfo-left-narrow":{right:"30px"},".cm-completionInfo.cm-completionInfo-right-narrow":{left:"30px"},"&light .cm-snippetField":{backgroundColor:"#00000022"},"&dark .cm-snippetField":{backgroundColor:"#ffffff22"},".cm-snippetFieldPosition":{verticalAlign:"text-top",width:0,height:"1.15em",display:"inline-block",margin:"0 -0.7px -.7em",borderLeft:"1.4px dotted #888"},".cm-completionMatchedText":{textDecoration:"underline"},".cm-completionDetail":{marginLeft:"0.5em",fontStyle:"italic"},".cm-completionIcon":{fontSize:"90%",width:".8em",display:"inline-block",textAlign:"center",paddingRight:".6em",opacity:"0.6",boxSizing:"content-box"},".cm-completionIcon-function, .cm-completionIcon-method":{"&:after":{content:"'ƒ'"}},".cm-completionIcon-class":{"&:after":{content:"'○'"}},".cm-completionIcon-interface":{"&:after":{content:"'◌'"}},".cm-completionIcon-variable":{"&:after":{content:"'𝑥'"}},".cm-completionIcon-constant":{"&:after":{content:"'𝐶'"}},".cm-completionIcon-type":{"&:after":{content:"'𝑡'"}},".cm-completionIcon-enum":{"&:after":{content:"'∪'"}},".cm-completionIcon-property":{"&:after":{content:"'□'"}},".cm-completionIcon-keyword":{"&:after":{content:"'🔑︎'"}},".cm-completionIcon-namespace":{"&:after":{content:"'▢'"}},".cm-completionIcon-text":{"&:after":{content:"'abc'",fontSize:"50%",verticalAlign:"middle"}}});class B6{constructor(e,t,i,s){this.field=e,this.line=t,this.from=i,this.to=s}}class k0{constructor(e,t,i){this.field=e,this.from=t,this.to=i}map(e){let t=e.mapPos(this.from,-1,Yt.TrackDel),i=e.mapPos(this.to,1,Yt.TrackDel);return t==null||i==null?null:new k0(this.field,t,i)}}class E0{constructor(e,t){this.lines=e,this.fieldPositions=t}instantiate(e,t){let i=[],s=[t],n=e.doc.lineAt(t),a=/^\s*/.exec(n.text)[0];for(let l of this.lines){if(i.length){let u=a,c=/^\t*/.exec(l)[0].length;for(let h=0;h<c;h++)u+=e.facet(su);s.push(t+u.length-c),l=u+l.slice(c)}i.push(l),t+=l.length+1}let o=this.fieldPositions.map(l=>new k0(l.field,s[l.line]+l.from,s[l.line]+l.to));return{text:i,ranges:o}}static parse(e){let t=[],i=[],s=[],n;for(let a of e.split(/\r\n?|\n/)){for(;n=/[#$]\{(?:(\d+)(?::([^{}]*))?|((?:\\[{}]|[^{}])*))\}/.exec(a);){let o=n[1]?+n[1]:null,l=n[2]||n[3]||"",u=-1,c=l.replace(/\\[{}]/g,h=>h[1]);for(let h=0;h<t.length;h++)(o!=null?t[h].seq==o:c&&t[h].name==c)&&(u=h);if(u<0){let h=0;for(;h<t.length&&(o==null||t[h].seq!=null&&t[h].seq<o);)h++;t.splice(h,0,{seq:o,name:c}),u=h;for(let f of s)f.field>=u&&f.field++}for(let h of s)if(h.line==i.length&&h.from>n.index){let f=n[2]?3+(n[1]||"").length:2;h.from-=f,h.to-=f}s.push(new B6(u,i.length,n.index,n.index+c.length)),a=a.slice(0,n.index)+l+a.slice(n.index+n[0].length)}a=a.replace(/\\([{}])/g,(o,l,u)=>{for(let c of s)c.line==i.length&&c.from>u&&(c.from--,c.to--);return l}),i.push(a)}return new E0(i,s)}}let N6=Ee.widget({widget:new class extends _s{toDOM(){let r=document.createElement("span");return r.className="cm-snippetFieldPosition",r}ignoreEvent(){return!1}}}),F6=Ee.mark({class:"cm-snippetField"});class ao{constructor(e,t){this.ranges=e,this.active=t,this.deco=Ee.set(e.map(i=>(i.from==i.to?N6:F6).range(i.from,i.to)),!0)}map(e){let t=[];for(let i of this.ranges){let s=i.map(e);if(!s)return null;t.push(s)}return new ao(t,this.active)}selectionInsideField(e){return e.ranges.every(t=>this.ranges.some(i=>i.field==this.active&&i.from<=t.from&&i.to>=t.to))}}const cu=Re.define({map(r,e){return r&&r.map(e)}}),U6=Re.define(),Rl=jt.define({create(){return null},update(r,e){for(let t of e.effects){if(t.is(cu))return t.value;if(t.is(U6)&&r)return new ao(r.ranges,t.value)}return r&&e.docChanged&&(r=r.map(e.changes)),r&&e.selection&&!r.selectionInsideField(e.selection)&&(r=null),r},provide:r=>ge.decorations.from(r,e=>e?e.deco:Ee.none)});function A0(r,e){return ie.create(r.filter(t=>t.field==e).map(t=>ie.range(t.from,t.to)))}function q6(r){let e=E0.parse(r);return(t,i,s,n)=>{let{text:a,ranges:o}=e.instantiate(t.state,s),{main:l}=t.state.selection,u={changes:{from:s,to:n==l.from?l.to:n,insert:Ue.of(a)},scrollIntoView:!0,annotations:i?[x0.of(i),Lt.userEvent.of("input.complete")]:void 0};if(o.length&&(u.selection=A0(o,0)),o.some(c=>c.field>0)){let c=new ao(o,0),h=u.effects=[cu.of(c)];t.state.field(Rl,!1)===void 0&&h.push(Re.appendConfig.of([Rl,Z6,W6,EC]))}t.dispatch(t.state.update(u))}}function AC(r){return({state:e,dispatch:t})=>{let i=e.field(Rl,!1);if(!i||r<0&&i.active==0)return!1;let s=i.active+r,n=r>0&&!i.ranges.some(a=>a.field==s+r);return t(e.update({selection:A0(i.ranges,s),effects:cu.of(n?null:new ao(i.ranges,s)),scrollIntoView:!0})),!0}}const V6=({state:r,dispatch:e})=>r.field(Rl,!1)?(e(r.update({effects:cu.of(null)})),!0):!1,X6=AC(1),j6=AC(-1),z6=[{key:"Tab",run:X6,shift:j6},{key:"Escape",run:V6}],hS=be.define({combine(r){return r.length?r[0]:z6}}),Z6=Ss.highest(tu.compute([hS],r=>r.facet(hS)));function vi(r,e){return{...e,apply:q6(r)}}const W6=ge.domEventHandlers({mousedown(r,e){let t=e.state.field(Rl,!1),i;if(!t||(i=e.posAtCoords({x:r.clientX,y:r.clientY}))==null)return!1;let s=t.ranges.find(n=>n.from<=i&&n.to>=i);return!s||s.field==t.active?!1:(e.dispatch({selection:A0(t.ranges,s.field),effects:cu.of(t.ranges.some(n=>n.field>s.field)?new ao(t.ranges,s.field):null),scrollIntoView:!0}),!0)}}),Ll={brackets:["(","[","{","'",'"'],before:")]}:;>",stringPrefixes:[]},Tn=Re.define({map(r,e){let t=e.mapPos(r,-1,Yt.TrackAfter);return t??void 0}}),P0=new class extends Rn{};P0.startSide=1;P0.endSide=-1;const PC=jt.define({create(){return je.empty},update(r,e){if(r=r.map(e.changes),e.selection){let t=e.state.doc.lineAt(e.selection.main.head);r=r.update({filter:i=>i>=t.from&&i<=t.to})}for(let t of e.effects)t.is(Tn)&&(r=r.update({add:[P0.range(t.value,t.value+1)]}));return r}});function H6(){return[G6,PC]}const zf="()[]{}<>«»»«［］｛｝";function DC(r){for(let e=0;e<zf.length;e+=2)if(zf.charCodeAt(e)==r)return zf.charAt(e+1);return Zg(r<128?r:r+1)}function MC(r,e){return r.languageDataAt("closeBrackets",e)[0]||Ll}const Y6=typeof navigator=="object"&&/Android\b/.test(navigator.userAgent),G6=ge.inputHandler.of((r,e,t,i)=>{if((Y6?r.composing:r.compositionStarted)||r.state.readOnly)return!1;let s=r.state.selection.main;if(i.length>2||i.length==2&&Qr(xi(i,0))==1||e!=s.from||t!=s.to)return!1;let n=e7(r.state,i);return n?(r.dispatch(n),!0):!1}),K6=({state:r,dispatch:e})=>{if(r.readOnly)return!1;let i=MC(r,r.selection.main.head).brackets||Ll.brackets,s=null,n=r.changeByRange(a=>{if(a.empty){let o=t7(r.doc,a.head);for(let l of i)if(l==o&&gd(r.doc,a.head)==DC(xi(l,0)))return{changes:{from:a.head-l.length,to:a.head+l.length},range:ie.cursor(a.head-l.length)}}return{range:s=a}});return s||e(r.update(n,{scrollIntoView:!0,userEvent:"delete.backward"})),!s},J6=[{key:"Backspace",run:K6}];function e7(r,e){let t=MC(r,r.selection.main.head),i=t.brackets||Ll.brackets;for(let s of i){let n=DC(xi(s,0));if(e==s)return n==s?s7(r,s,i.indexOf(s+s+s)>-1,t):i7(r,s,n,t.before||Ll.before);if(e==n&&IC(r,r.selection.main.from))return r7(r,s,n)}return null}function IC(r,e){let t=!1;return r.field(PC).between(0,r.doc.length,i=>{i==e&&(t=!0)}),t}function gd(r,e){let t=r.sliceString(e,e+2);return t.slice(0,Qr(xi(t,0)))}function t7(r,e){let t=r.sliceString(e-2,e);return Qr(xi(t,0))==t.length?t:t.slice(1)}function i7(r,e,t,i){let s=null,n=r.changeByRange(a=>{if(!a.empty)return{changes:[{insert:e,from:a.from},{insert:t,from:a.to}],effects:Tn.of(a.to+e.length),range:ie.range(a.anchor+e.length,a.head+e.length)};let o=gd(r.doc,a.head);return!o||/\s/.test(o)||i.indexOf(o)>-1?{changes:{insert:e+t,from:a.head},effects:Tn.of(a.head+e.length),range:ie.cursor(a.head+e.length)}:{range:s=a}});return s?null:r.update(n,{scrollIntoView:!0,userEvent:"input.type"})}function r7(r,e,t){let i=null,s=r.changeByRange(n=>n.empty&&gd(r.doc,n.head)==t?{changes:{from:n.head,to:n.head+t.length,insert:t},range:ie.cursor(n.head+t.length)}:i={range:n});return i?null:r.update(s,{scrollIntoView:!0,userEvent:"input.type"})}function s7(r,e,t,i){let s=i.stringPrefixes||Ll.stringPrefixes,n=null,a=r.changeByRange(o=>{if(!o.empty)return{changes:[{insert:e,from:o.from},{insert:e,from:o.to}],effects:Tn.of(o.to+e.length),range:ie.range(o.anchor+e.length,o.head+e.length)};let l=o.head,u=gd(r.doc,l),c;if(u==e){if(dS(r,l))return{changes:{insert:e+e,from:l},effects:Tn.of(l+e.length),range:ie.cursor(l+e.length)};if(IC(r,l)){let f=t&&r.sliceDoc(l,l+e.length*3)==e+e+e?e+e+e:e;return{changes:{from:l,to:l+f.length,insert:f},range:ie.cursor(l+f.length)}}}else{if(t&&r.sliceDoc(l-2*e.length,l)==e+e&&(c=fS(r,l-2*e.length,s))>-1&&dS(r,c))return{changes:{insert:e+e+e+e,from:l},effects:Tn.of(l+e.length),range:ie.cursor(l+e.length)};if(r.charCategorizer(l)(u)!=gt.Word&&fS(r,l,s)>-1&&!n7(r,l,e,s))return{changes:{insert:e+e,from:l},effects:Tn.of(l+e.length),range:ie.cursor(l+e.length)}}return{range:n=o}});return n?null:r.update(a,{scrollIntoView:!0,userEvent:"input.type"})}function dS(r,e){let t=nt(r).resolveInner(e+1);return t.parent&&t.from==e}function n7(r,e,t,i){let s=nt(r).resolveInner(e,-1),n=i.reduce((a,o)=>Math.max(a,o.length),0);for(let a=0;a<5;a++){let o=r.sliceDoc(s.from,Math.min(s.to,s.from+t.length+n)),l=o.indexOf(t);if(!l||l>-1&&i.indexOf(o.slice(0,l))>-1){let c=s.firstChild;for(;c&&c.from==s.from&&c.to-c.from>t.length+l;){if(r.sliceDoc(c.to-t.length,c.to)==t)return!1;c=c.firstChild}return!0}let u=s.to==e&&s.parent;if(!u)break;s=u}return!1}function fS(r,e,t){let i=r.charCategorizer(e);if(i(r.sliceDoc(e-1,e))!=gt.Word)return e;for(let s of t){let n=e-s.length;if(r.sliceDoc(n,e)==s&&i(r.sliceDoc(n-1,n))!=gt.Word)return n}return-1}function a7(r={}){return[$6,wi,Vt.of(r),L6,o7,EC]}const RC=[{key:"Ctrl-Space",run:jf},{mac:"Alt-`",run:jf},{mac:"Alt-i",run:jf},{key:"Escape",run:D6},{key:"ArrowDown",run:hc(!0)},{key:"ArrowUp",run:hc(!1)},{key:"PageDown",run:hc(!0,"page")},{key:"PageUp",run:hc(!1,"page")},{key:"Enter",run:P6}],o7=Ss.highest(tu.computeN([Vt],r=>r.facet(Vt).defaultKeymap?[RC]:[]));class pS{constructor(e,t,i){this.from=e,this.to=t,this.diagnostic=i}}class On{constructor(e,t,i){this.diagnostics=e,this.panel=t,this.selected=i}static init(e,t,i){let s=i.facet(Ql).markerFilter;s&&(e=s(e,i));let n=e.slice().sort((c,h)=>c.from-h.from||c.to-h.to),a=new ys,o=[],l=0;for(let c=0;;){let h=c==n.length?null:n[c];if(!h&&!o.length)break;let f,m;for(o.length?(f=l,m=o.reduce((y,E)=>Math.min(y,E.to),h&&h.from>f?h.from:1e8)):(f=h.from,m=h.to,o.push(h),c++);c<n.length;){let y=n[c];if(y.from==f&&(y.to>y.from||y.to==f))o.push(y),c++,m=Math.min(y.to,m);else{m=Math.min(y.from,m);break}}let S=v7(o);if(o.some(y=>y.from==y.to||y.from==y.to-1&&i.doc.lineAt(y.from).to==y.from))a.add(f,f,Ee.widget({widget:new g7(S),diagnostics:o.slice()}));else{let y=o.reduce((E,C)=>C.markClass?E+" "+C.markClass:E,"");a.add(f,m,Ee.mark({class:"cm-lintRange cm-lintRange-"+S+y,diagnostics:o.slice(),inclusiveEnd:o.some(E=>E.to>m)}))}l=m;for(let y=0;y<o.length;y++)o[y].to<=l&&o.splice(y--,1)}let u=a.finish();return new On(u,t,Va(u))}}function Va(r,e=null,t=0){let i=null;return r.between(t,1e9,(s,n,{spec:a})=>{if(!(e&&a.diagnostics.indexOf(e)<0))if(!i)i=new pS(s,n,e||a.diagnostics[0]);else{if(a.diagnostics.indexOf(i.diagnostic)<0)return!1;i=new pS(i.from,n,i.diagnostic)}}),i}function l7(r,e){let t=e.pos,i=e.end||t,s=r.state.facet(Ql).hideOn(r,t,i);if(s!=null)return s;let n=r.startState.doc.lineAt(e.pos);return!!(r.effects.some(a=>a.is(LC))||r.changes.touchesRange(n.from,Math.max(n.to,i)))}function u7(r,e){return r.field(Fi,!1)?e:e.concat(Re.appendConfig.of(S7))}const LC=Re.define(),D0=Re.define(),QC=Re.define(),Fi=jt.define({create(){return new On(Ee.none,null,null)},update(r,e){if(e.docChanged&&r.diagnostics.size){let t=r.diagnostics.map(e.changes),i=null,s=r.panel;if(r.selected){let n=e.changes.mapPos(r.selected.from,1);i=Va(t,r.selected.diagnostic,n)||Va(t,null,n)}!t.size&&s&&e.state.facet(Ql).autoPanel&&(s=null),r=new On(t,s,i)}for(let t of e.effects)if(t.is(LC)){let i=e.state.facet(Ql).autoPanel?t.value.length?$l.open:null:r.panel;r=On.init(t.value,i,e.state)}else t.is(D0)?r=new On(r.diagnostics,t.value?$l.open:null,r.selected):t.is(QC)&&(r=new On(r.diagnostics,r.panel,t.value));return r},provide:r=>[Cl.from(r,e=>e.panel),ge.decorations.from(r,e=>e.diagnostics)]}),c7=Ee.mark({class:"cm-lintRange cm-lintRange-active"});function h7(r,e,t){let{diagnostics:i}=r.state.field(Fi),s,n=-1,a=-1;i.between(e-(t<0?1:0),e+(t>0?1:0),(l,u,{spec:c})=>{if(e>=l&&e<=u&&(l==u||(e>l||t>0)&&(e<u||t<0)))return s=c.diagnostics,n=l,a=u,!1});let o=r.state.facet(Ql).tooltipFilter;return s&&o&&(s=o(s,r.state)),s?{pos:n,end:a,above:r.state.doc.lineAt(n).to<a,create(){return{dom:d7(r,s)}}}:null}function d7(r,e){return rt("ul",{class:"cm-tooltip-lint"},e.map(t=>BC(r,t,!1)))}const f7=r=>{let e=r.state.field(Fi,!1);(!e||!e.panel)&&r.dispatch({effects:u7(r.state,[D0.of(!0)])});let t=wl(r,$l.open);return t&&t.dom.querySelector(".cm-panel-lint ul").focus(),!0},mS=r=>{let e=r.state.field(Fi,!1);return!e||!e.panel?!1:(r.dispatch({effects:D0.of(!1)}),!0)},p7=r=>{let e=r.state.field(Fi,!1);if(!e)return!1;let t=r.state.selection.main,i=e.diagnostics.iter(t.to+1);return!i.value&&(i=e.diagnostics.iter(0),!i.value||i.from==t.from&&i.to==t.to)?!1:(r.dispatch({selection:{anchor:i.from,head:i.to},scrollIntoView:!0}),!0)},m7=[{key:"Mod-Shift-m",run:f7,preventDefault:!0},{key:"F8",run:p7}],Ql=be.define({combine(r){return{sources:r.map(e=>e.source).filter(e=>e!=null),...Gr(r.map(e=>e.config),{delay:750,markerFilter:null,tooltipFilter:null,needsRefresh:null,hideOn:()=>null},{delay:Math.max,markerFilter:gS,tooltipFilter:gS,needsRefresh:(e,t)=>e?t?i=>e(i)||t(i):e:t,hideOn:(e,t)=>e?t?(i,s,n)=>e(i,s,n)||t(i,s,n):e:t,autoPanel:(e,t)=>e||t})}}});function gS(r,e){return r?e?(t,i)=>e(r(t,i),i):r:e}function $C(r){let e=[];if(r)e:for(let{name:t}of r){for(let i=0;i<t.length;i++){let s=t[i];if(/[a-zA-Z]/.test(s)&&!e.some(n=>n.toLowerCase()==s.toLowerCase())){e.push(s);continue e}}e.push("")}return e}function BC(r,e,t){var i;let s=t?$C(e.actions):[];return rt("li",{class:"cm-diagnostic cm-diagnostic-"+e.severity},rt("span",{class:"cm-diagnosticText"},e.renderMessage?e.renderMessage(r):e.message),(i=e.actions)===null||i===void 0?void 0:i.map((n,a)=>{let o=!1,l=m=>{if(m.preventDefault(),o)return;o=!0;let S=Va(r.state.field(Fi).diagnostics,e);S&&n.apply(r,S.from,S.to)},{name:u}=n,c=s[a]?u.indexOf(s[a]):-1,h=c<0?u:[u.slice(0,c),rt("u",u.slice(c,c+1)),u.slice(c+1)],f=n.markClass?" "+n.markClass:"";return rt("button",{type:"button",class:"cm-diagnosticAction"+f,onclick:l,onmousedown:l,"aria-label":` Action: ${u}${c<0?"":` (access key "${s[a]})"`}.`},h)}),e.source&&rt("div",{class:"cm-diagnosticSource"},e.source))}class g7 extends _s{constructor(e){super(),this.sev=e}eq(e){return e.sev==this.sev}toDOM(){return rt("span",{class:"cm-lintPoint cm-lintPoint-"+this.sev})}}class OS{constructor(e,t){this.diagnostic=t,this.id="item_"+Math.floor(Math.random()*4294967295).toString(16),this.dom=BC(e,t,!0),this.dom.id=this.id,this.dom.setAttribute("role","option")}}class $l{constructor(e){this.view=e,this.items=[];let t=s=>{if(s.keyCode==27)mS(this.view),this.view.focus();else if(s.keyCode==38||s.keyCode==33)this.moveSelection((this.selectedIndex-1+this.items.length)%this.items.length);else if(s.keyCode==40||s.keyCode==34)this.moveSelection((this.selectedIndex+1)%this.items.length);else if(s.keyCode==36)this.moveSelection(0);else if(s.keyCode==35)this.moveSelection(this.items.length-1);else if(s.keyCode==13)this.view.focus();else if(s.keyCode>=65&&s.keyCode<=90&&this.selectedIndex>=0){let{diagnostic:n}=this.items[this.selectedIndex],a=$C(n.actions);for(let o=0;o<a.length;o++)if(a[o].toUpperCase().charCodeAt(0)==s.keyCode){let l=Va(this.view.state.field(Fi).diagnostics,n);l&&n.actions[o].apply(e,l.from,l.to)}}else return;s.preventDefault()},i=s=>{for(let n=0;n<this.items.length;n++)this.items[n].dom.contains(s.target)&&this.moveSelection(n)};this.list=rt("ul",{tabIndex:0,role:"listbox","aria-label":this.view.state.phrase("Diagnostics"),onkeydown:t,onclick:i}),this.dom=rt("div",{class:"cm-panel-lint"},this.list,rt("button",{type:"button",name:"close","aria-label":this.view.state.phrase("close"),onclick:()=>mS(this.view)},"×")),this.update()}get selectedIndex(){let e=this.view.state.field(Fi).selected;if(!e)return-1;for(let t=0;t<this.items.length;t++)if(this.items[t].diagnostic==e.diagnostic)return t;return-1}update(){let{diagnostics:e,selected:t}=this.view.state.field(Fi),i=0,s=!1,n=null,a=new Set;for(e.between(0,this.view.state.doc.length,(o,l,{spec:u})=>{for(let c of u.diagnostics){if(a.has(c))continue;a.add(c);let h=-1,f;for(let m=i;m<this.items.length;m++)if(this.items[m].diagnostic==c){h=m;break}h<0?(f=new OS(this.view,c),this.items.splice(i,0,f),s=!0):(f=this.items[h],h>i&&(this.items.splice(i,h-i),s=!0)),t&&f.diagnostic==t.diagnostic?f.dom.hasAttribute("aria-selected")||(f.dom.setAttribute("aria-selected","true"),n=f):f.dom.hasAttribute("aria-selected")&&f.dom.removeAttribute("aria-selected"),i++}});i<this.items.length&&!(this.items.length==1&&this.items[0].diagnostic.from<0);)s=!0,this.items.pop();this.items.length==0&&(this.items.push(new OS(this.view,{from:-1,to:-1,severity:"info",message:this.view.state.phrase("No diagnostics")})),s=!0),n?(this.list.setAttribute("aria-activedescendant",n.id),this.view.requestMeasure({key:this,read:()=>({sel:n.dom.getBoundingClientRect(),panel:this.list.getBoundingClientRect()}),write:({sel:o,panel:l})=>{let u=l.height/this.list.offsetHeight;o.top<l.top?this.list.scrollTop-=(l.top-o.top)/u:o.bottom>l.bottom&&(this.list.scrollTop+=(o.bottom-l.bottom)/u)}})):this.selectedIndex<0&&this.list.removeAttribute("aria-activedescendant"),s&&this.sync()}sync(){let e=this.list.firstChild;function t(){let i=e;e=i.nextSibling,i.remove()}for(let i of this.items)if(i.dom.parentNode==this.list){for(;e!=i.dom;)t();e=i.dom.nextSibling}else this.list.insertBefore(i.dom,e);for(;e;)t()}moveSelection(e){if(this.selectedIndex<0)return;let t=this.view.state.field(Fi),i=Va(t.diagnostics,this.items[e].diagnostic);i&&this.view.dispatch({selection:{anchor:i.from,head:i.to},scrollIntoView:!0,effects:QC.of(i)})}static open(e){return new $l(e)}}function O7(r,e='viewBox="0 0 40 40"'){return`url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" ${e}>${encodeURIComponent(r)}</svg>')`}function dc(r){return O7(`<path d="m0 2.5 l2 -1.5 l1 0 l2 1.5 l1 0" stroke="${r}" fill="none" stroke-width=".7"/>`,'width="6" height="3"')}const y7=ge.baseTheme({".cm-diagnostic":{padding:"3px 6px 3px 8px",marginLeft:"-1px",display:"block",whiteSpace:"pre-wrap"},".cm-diagnostic-error":{borderLeft:"5px solid #d11"},".cm-diagnostic-warning":{borderLeft:"5px solid orange"},".cm-diagnostic-info":{borderLeft:"5px solid #999"},".cm-diagnostic-hint":{borderLeft:"5px solid #66d"},".cm-diagnosticAction":{font:"inherit",border:"none",padding:"2px 4px",backgroundColor:"#444",color:"white",borderRadius:"3px",marginLeft:"8px",cursor:"pointer"},".cm-diagnosticSource":{fontSize:"70%",opacity:.7},".cm-lintRange":{backgroundPosition:"left bottom",backgroundRepeat:"repeat-x",paddingBottom:"0.7px"},".cm-lintRange-error":{backgroundImage:dc("#d11")},".cm-lintRange-warning":{backgroundImage:dc("orange")},".cm-lintRange-info":{backgroundImage:dc("#999")},".cm-lintRange-hint":{backgroundImage:dc("#66d")},".cm-lintRange-active":{backgroundColor:"#ffdd9980"},".cm-tooltip-lint":{padding:0,margin:0},".cm-lintPoint":{position:"relative","&:after":{content:'""',position:"absolute",bottom:0,left:"-2px",borderLeft:"3px solid transparent",borderRight:"3px solid transparent",borderBottom:"4px solid #d11"}},".cm-lintPoint-warning":{"&:after":{borderBottomColor:"orange"}},".cm-lintPoint-info":{"&:after":{borderBottomColor:"#999"}},".cm-lintPoint-hint":{"&:after":{borderBottomColor:"#66d"}},".cm-panel.cm-panel-lint":{position:"relative","& ul":{maxHeight:"100px",overflowY:"auto","& [aria-selected]":{backgroundColor:"#ddd","& u":{textDecoration:"underline"}},"&:focus [aria-selected]":{background_fallback:"#bdf",backgroundColor:"Highlight",color_fallback:"white",color:"HighlightText"},"& u":{textDecoration:"none"},padding:0,margin:0},"& [name=close]":{position:"absolute",top:"0",right:"2px",background:"inherit",border:"none",font:"inherit",padding:0,margin:0}}});function b7(r){return r=="error"?4:r=="warning"?3:r=="info"?2:1}function v7(r){let e="hint",t=1;for(let i of r){let s=b7(i.severity);s>t&&(t=s,e=i.severity)}return e}const S7=[Fi,ge.decorations.compute([Fi],r=>{let{selected:e,panel:t}=r.field(Fi);return!e||!t||e.from==e.to?Ee.none:Ee.set([c7.range(e.from,e.to)])}),tN(h7,{hideOn:l7}),y7],T7=[dN(),mN(),MB(),I8(),o8(),SB(),CB(),Xe.allowMultipleSelections.of(!0),HN(),I2(h8,{fallback:!0}),y8(),H6(),a7(),XB(),ZB(),BB(),VF(),tu.of([...J6,...$F,...l6,...q8,...r8,...RC,...m7])];class kh{static create(e,t,i,s,n){let a=s+(s<<8)+e+(t<<4)|0;return new kh(e,t,i,a,n,[],[])}constructor(e,t,i,s,n,a,o){this.type=e,this.value=t,this.from=i,this.hash=s,this.end=n,this.children=a,this.positions=o,this.hashProp=[[Ie.contextHash,s]]}addChild(e,t){e.prop(Ie.contextHash)!=this.hash&&(e=new He(e.type,e.children,e.positions,e.length,this.hashProp)),this.children.push(e),this.positions.push(t)}toTree(e,t=this.end){let i=this.children.length-1;return i>=0&&(t=Math.max(t,this.positions[i]+this.children[i].length+this.from)),new He(e.types[this.type],this.children,this.positions,t-this.from).balance({makeTree:(s,n,a)=>new He(Bt.none,s,n,a,this.hashProp)})}}var ce;(function(r){r[r.Document=1]="Document",r[r.CodeBlock=2]="CodeBlock",r[r.FencedCode=3]="FencedCode",r[r.Blockquote=4]="Blockquote",r[r.HorizontalRule=5]="HorizontalRule",r[r.BulletList=6]="BulletList",r[r.OrderedList=7]="OrderedList",r[r.ListItem=8]="ListItem",r[r.ATXHeading1=9]="ATXHeading1",r[r.ATXHeading2=10]="ATXHeading2",r[r.ATXHeading3=11]="ATXHeading3",r[r.ATXHeading4=12]="ATXHeading4",r[r.ATXHeading5=13]="ATXHeading5",r[r.ATXHeading6=14]="ATXHeading6",r[r.SetextHeading1=15]="SetextHeading1",r[r.SetextHeading2=16]="SetextHeading2",r[r.HTMLBlock=17]="HTMLBlock",r[r.LinkReference=18]="LinkReference",r[r.Paragraph=19]="Paragraph",r[r.CommentBlock=20]="CommentBlock",r[r.ProcessingInstructionBlock=21]="ProcessingInstructionBlock",r[r.Escape=22]="Escape",r[r.Entity=23]="Entity",r[r.HardBreak=24]="HardBreak",r[r.Emphasis=25]="Emphasis",r[r.StrongEmphasis=26]="StrongEmphasis",r[r.Link=27]="Link",r[r.Image=28]="Image",r[r.InlineCode=29]="InlineCode",r[r.HTMLTag=30]="HTMLTag",r[r.Comment=31]="Comment",r[r.ProcessingInstruction=32]="ProcessingInstruction",r[r.Autolink=33]="Autolink",r[r.HeaderMark=34]="HeaderMark",r[r.QuoteMark=35]="QuoteMark",r[r.ListMark=36]="ListMark",r[r.LinkMark=37]="LinkMark",r[r.EmphasisMark=38]="EmphasisMark",r[r.CodeMark=39]="CodeMark",r[r.CodeText=40]="CodeText",r[r.CodeInfo=41]="CodeInfo",r[r.LinkTitle=42]="LinkTitle",r[r.LinkLabel=43]="LinkLabel",r[r.URL=44]="URL"})(ce||(ce={}));class _7{constructor(e,t){this.start=e,this.content=t,this.marks=[],this.parsers=[]}}class x7{constructor(){this.text="",this.baseIndent=0,this.basePos=0,this.depth=0,this.markers=[],this.pos=0,this.indent=0,this.next=-1}forward(){this.basePos>this.pos&&this.forwardInner()}forwardInner(){let e=this.skipSpace(this.basePos);this.indent=this.countIndent(e,this.pos,this.indent),this.pos=e,this.next=e==this.text.length?-1:this.text.charCodeAt(e)}skipSpace(e){return ll(this.text,e)}reset(e){for(this.text=e,this.baseIndent=this.basePos=this.pos=this.indent=0,this.forwardInner(),this.depth=1;this.markers.length;)this.markers.pop()}moveBase(e){this.basePos=e,this.baseIndent=this.countIndent(e,this.pos,this.indent)}moveBaseColumn(e){this.baseIndent=e,this.basePos=this.findColumn(e)}addMarker(e){this.markers.push(e)}countIndent(e,t=0,i=0){for(let s=t;s<e;s++)i+=this.text.charCodeAt(s)==9?4-i%4:1;return i}findColumn(e){let t=0;for(let i=0;t<this.text.length&&i<e;t++)i+=this.text.charCodeAt(t)==9?4-i%4:1;return t}scrub(){if(!this.baseIndent)return this.text;let e="";for(let t=0;t<this.basePos;t++)e+=" ";return e+this.text.slice(this.basePos)}}function yS(r,e,t){if(t.pos==t.text.length||r!=e.block&&t.indent>=e.stack[t.depth+1].value+t.baseIndent)return!0;if(t.indent>=t.baseIndent+4)return!1;let i=(r.type==ce.OrderedList?R0:I0)(t,e,!1);return i>0&&(r.type!=ce.BulletList||M0(t,e,!1)<0)&&t.text.charCodeAt(t.pos+i-1)==r.value}const NC={[ce.Blockquote](r,e,t){return t.next!=62?!1:(t.markers.push(Fe(ce.QuoteMark,e.lineStart+t.pos,e.lineStart+t.pos+1)),t.moveBase(t.pos+(lr(t.text.charCodeAt(t.pos+1))?2:1)),r.end=e.lineStart+t.text.length,!0)},[ce.ListItem](r,e,t){return t.indent<t.baseIndent+r.value&&t.next>-1?!1:(t.moveBaseColumn(t.baseIndent+r.value),!0)},[ce.OrderedList]:yS,[ce.BulletList]:yS,[ce.Document](){return!0}};function lr(r){return r==32||r==9||r==10||r==13}function ll(r,e=0){for(;e<r.length&&lr(r.charCodeAt(e));)e++;return e}function bS(r,e,t){for(;e>t&&lr(r.charCodeAt(e-1));)e--;return e}function FC(r){if(r.next!=96&&r.next!=126)return-1;let e=r.pos+1;for(;e<r.text.length&&r.text.charCodeAt(e)==r.next;)e++;if(e<r.pos+3)return-1;if(r.next==96){for(let t=e;t<r.text.length;t++)if(r.text.charCodeAt(t)==96)return-1}return e}function UC(r){return r.next!=62?-1:r.text.charCodeAt(r.pos+1)==32?2:1}function M0(r,e,t){if(r.next!=42&&r.next!=45&&r.next!=95)return-1;let i=1;for(let s=r.pos+1;s<r.text.length;s++){let n=r.text.charCodeAt(s);if(n==r.next)i++;else if(!lr(n))return-1}return t&&r.next==45&&XC(r)>-1&&r.depth==e.stack.length&&e.parser.leafBlockParsers.indexOf(WC.SetextHeading)>-1||i<3?-1:1}function qC(r,e){for(let t=r.stack.length-1;t>=0;t--)if(r.stack[t].type==e)return!0;return!1}function I0(r,e,t){return(r.next==45||r.next==43||r.next==42)&&(r.pos==r.text.length-1||lr(r.text.charCodeAt(r.pos+1)))&&(!t||qC(e,ce.BulletList)||r.skipSpace(r.pos+2)<r.text.length)?1:-1}function R0(r,e,t){let i=r.pos,s=r.next;for(;s>=48&&s<=57;){i++;if(i==r.text.length)return-1;s=r.text.charCodeAt(i)}return i==r.pos||i>r.pos+9||s!=46&&s!=41||i<r.text.length-1&&!lr(r.text.charCodeAt(i+1))||t&&!qC(e,ce.OrderedList)&&(r.skipSpace(i+1)==r.text.length||i>r.pos+1||r.next!=49)?-1:i+1-r.pos}function VC(r){if(r.next!=35)return-1;let e=r.pos+1;for(;e<r.text.length&&r.text.charCodeAt(e)==35;)e++;if(e<r.text.length&&r.text.charCodeAt(e)!=32)return-1;let t=e-r.pos;return t>6?-1:t}function XC(r){if(r.next!=45&&r.next!=61||r.indent>=r.baseIndent+4)return-1;let e=r.pos+1;for(;e<r.text.length&&r.text.charCodeAt(e)==r.next;)e++;let t=e;for(;e<r.text.length&&lr(r.text.charCodeAt(e));)e++;return e==r.text.length?t:-1}const Qm=/^[ \t]*$/,jC=/-->/,zC=/\?>/,$m=[[/^<(?:script|pre|style)(?:\s|>|$)/i,/<\/(?:script|pre|style)>/i],[/^\s*<!--/,jC],[/^\s*<\?/,zC],[/^\s*<![A-Z]/,/>/],[/^\s*<!\[CDATA\[/,/\]\]>/],[/^\s*<\/?(?:address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h1|h2|h3|h4|h5|h6|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|nav|noframes|ol|optgroup|option|p|param|section|source|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul)(?:\s|\/?>|$)/i,Qm],[/^\s*(?:<\/[a-z][\w-]*\s*>|<[a-z][\w-]*(\s+[a-z:_][\w-.]*(?:\s*=\s*(?:[^\s"'=<>`]+|'[^']*'|"[^"]*"))?)*\s*>)\s*$/i,Qm]];function ZC(r,e,t){if(r.next!=60)return-1;let i=r.text.slice(r.pos);for(let s=0,n=$m.length-(t?1:0);s<n;s++)if($m[s][0].test(i))return s;return-1}function vS(r,e){let t=r.countIndent(e,r.pos,r.indent),i=r.countIndent(r.skipSpace(e),e,t);return i>=t+5?t+1:i}function cn(r,e,t){let i=r.length-1;i>=0&&r[i].to==e&&r[i].type==ce.CodeText?r[i].to=t:r.push(Fe(ce.CodeText,e,t))}const fc={LinkReference:void 0,IndentedCode(r,e){let t=e.baseIndent+4;if(e.indent<t)return!1;let i=e.findColumn(t),s=r.lineStart+i,n=r.lineStart+e.text.length,a=[],o=[];for(cn(a,s,n);r.nextLine()&&e.depth>=r.stack.length;)if(e.pos==e.text.length){cn(o,r.lineStart-1,r.lineStart);for(let l of e.markers)o.push(l)}else{if(e.indent<t)break;{if(o.length){for(let u of o)u.type==ce.CodeText?cn(a,u.from,u.to):a.push(u);o=[]}cn(a,r.lineStart-1,r.lineStart);for(let u of e.markers)a.push(u);n=r.lineStart+e.text.length;let l=r.lineStart+e.findColumn(e.baseIndent+4);l<n&&cn(a,l,n)}}return o.length&&(o=o.filter(l=>l.type!=ce.CodeText),o.length&&(e.markers=o.concat(e.markers))),r.addNode(r.buffer.writeElements(a,-s).finish(ce.CodeBlock,n-s),s),!0},FencedCode(r,e){let t=FC(e);if(t<0)return!1;let i=r.lineStart+e.pos,s=e.next,n=t-e.pos,a=e.skipSpace(t),o=bS(e.text,e.text.length,a),l=[Fe(ce.CodeMark,i,i+n)];a<o&&l.push(Fe(ce.CodeInfo,r.lineStart+a,r.lineStart+o));for(let u=!0;r.nextLine()&&e.depth>=r.stack.length;u=!1){let c=e.pos;if(e.indent-e.baseIndent<4)for(;c<e.text.length&&e.text.charCodeAt(c)==s;)c++;if(c-e.pos>=n&&e.skipSpace(c)==e.text.length){for(let h of e.markers)l.push(h);l.push(Fe(ce.CodeMark,r.lineStart+e.pos,r.lineStart+c)),r.nextLine();break}else{u||cn(l,r.lineStart-1,r.lineStart);for(let m of e.markers)l.push(m);let h=r.lineStart+e.basePos,f=r.lineStart+e.text.length;h<f&&cn(l,h,f)}}return r.addNode(r.buffer.writeElements(l,-i).finish(ce.FencedCode,r.prevLineEnd()-i),i),!0},Blockquote(r,e){let t=UC(e);return t<0?!1:(r.startContext(ce.Blockquote,e.pos),r.addNode(ce.QuoteMark,r.lineStart+e.pos,r.lineStart+e.pos+1),e.moveBase(e.pos+t),null)},HorizontalRule(r,e){if(M0(e,r,!1)<0)return!1;let t=r.lineStart+e.pos;return r.nextLine(),r.addNode(ce.HorizontalRule,t),!0},BulletList(r,e){let t=I0(e,r,!1);if(t<0)return!1;r.block.type!=ce.BulletList&&r.startContext(ce.BulletList,e.basePos,e.next);let i=vS(e,e.pos+1);return r.startContext(ce.ListItem,e.basePos,i-e.baseIndent),r.addNode(ce.ListMark,r.lineStart+e.pos,r.lineStart+e.pos+t),e.moveBaseColumn(i),null},OrderedList(r,e){let t=R0(e,r,!1);if(t<0)return!1;r.block.type!=ce.OrderedList&&r.startContext(ce.OrderedList,e.basePos,e.text.charCodeAt(e.pos+t-1));let i=vS(e,e.pos+t);return r.startContext(ce.ListItem,e.basePos,i-e.baseIndent),r.addNode(ce.ListMark,r.lineStart+e.pos,r.lineStart+e.pos+t),e.moveBaseColumn(i),null},ATXHeading(r,e){let t=VC(e);if(t<0)return!1;let i=e.pos,s=r.lineStart+i,n=bS(e.text,e.text.length,i),a=n;for(;a>i&&e.text.charCodeAt(a-1)==e.next;)a--;(a==n||a==i||!lr(e.text.charCodeAt(a-1)))&&(a=e.text.length);let o=r.buffer.write(ce.HeaderMark,0,t).writeElements(r.parser.parseInline(e.text.slice(i+t+1,a),s+t+1),-s);a<e.text.length&&o.write(ce.HeaderMark,a-i,n-i);let l=o.finish(ce.ATXHeading1-1+t,e.text.length-i);return r.nextLine(),r.addNode(l,s),!0},HTMLBlock(r,e){let t=ZC(e,r,!1);if(t<0)return!1;let i=r.lineStart+e.pos,s=$m[t][1],n=[],a=s!=Qm;for(;!s.test(e.text)&&r.nextLine();){if(e.depth<r.stack.length){a=!1;break}for(let u of e.markers)n.push(u)}a&&r.nextLine();let o=s==jC?ce.CommentBlock:s==zC?ce.ProcessingInstructionBlock:ce.HTMLBlock,l=r.prevLineEnd();return r.addNode(r.buffer.writeElements(n,-i).finish(o,l-i),i),!0},SetextHeading:void 0};class w7{constructor(e){this.stage=0,this.elts=[],this.pos=0,this.start=e.start,this.advance(e.content)}nextLine(e,t,i){if(this.stage==-1)return!1;let s=i.content+`
`+t.scrub(),n=this.advance(s);return n>-1&&n<s.length?this.complete(e,i,n):!1}finish(e,t){return(this.stage==2||this.stage==3)&&ll(t.content,this.pos)==t.content.length?this.complete(e,t,t.content.length):!1}complete(e,t,i){return e.addLeafElement(t,Fe(ce.LinkReference,this.start,this.start+i,this.elts)),!0}nextStage(e){return e?(this.pos=e.to-this.start,this.elts.push(e),this.stage++,!0):(e===!1&&(this.stage=-1),!1)}advance(e){for(;;){if(this.stage==-1)return-1;if(this.stage==0){if(!this.nextStage(rk(e,this.pos,this.start,!0)))return-1;if(e.charCodeAt(this.pos)!=58)return this.stage=-1;this.elts.push(Fe(ce.LinkMark,this.pos+this.start,this.pos+this.start+1)),this.pos++}else if(this.stage==1){if(!this.nextStage(tk(e,ll(e,this.pos),this.start)))return-1}else if(this.stage==2){let t=ll(e,this.pos),i=0;if(t>this.pos){let s=ik(e,t,this.start);if(s){let n=Zf(e,s.to-this.start);n>0&&(this.nextStage(s),i=n)}}return i||(i=Zf(e,this.pos)),i>0&&i<e.length?i:-1}else return Zf(e,this.pos)}}}function Zf(r,e){for(;e<r.length;e++){let t=r.charCodeAt(e);if(t==10)break;if(!lr(t))return-1}return e}class C7{nextLine(e,t,i){let s=t.depth<e.stack.length?-1:XC(t),n=t.next;if(s<0)return!1;let a=Fe(ce.HeaderMark,e.lineStart+t.pos,e.lineStart+s);return e.nextLine(),e.addLeafElement(i,Fe(n==61?ce.SetextHeading1:ce.SetextHeading2,i.start,e.prevLineEnd(),[...e.parser.parseInline(i.content,i.start),a])),!0}finish(){return!1}}const WC={LinkReference(r,e){return e.content.charCodeAt(0)==91?new w7(e):null},SetextHeading(){return new C7}},k7=[(r,e)=>VC(e)>=0,(r,e)=>FC(e)>=0,(r,e)=>UC(e)>=0,(r,e)=>I0(e,r,!0)>=0,(r,e)=>R0(e,r,!0)>=0,(r,e)=>M0(e,r,!0)>=0,(r,e)=>ZC(e,r,!0)>=0],E7={text:"",end:0};class A7{constructor(e,t,i,s){this.parser=e,this.input=t,this.ranges=s,this.line=new x7,this.atEnd=!1,this.reusePlaceholders=new Map,this.stoppedAt=null,this.rangeI=0,this.to=s[s.length-1].to,this.lineStart=this.absoluteLineStart=this.absoluteLineEnd=s[0].from,this.block=kh.create(ce.Document,0,this.lineStart,0,0),this.stack=[this.block],this.fragments=i.length?new I7(i,t):null,this.readLine()}get parsedPos(){return this.absoluteLineStart}advance(){if(this.stoppedAt!=null&&this.absoluteLineStart>this.stoppedAt)return this.finish();let{line:e}=this;for(;;){for(let i=0;;){let s=e.depth<this.stack.length?this.stack[this.stack.length-1]:null;for(;i<e.markers.length&&(!s||e.markers[i].from<s.end);){let n=e.markers[i++];this.addNode(n.type,n.from,n.to)}if(!s)break;this.finishContext()}if(e.pos<e.text.length)break;if(!this.nextLine())return this.finish()}if(this.fragments&&this.reuseFragment(e.basePos))return null;e:for(;;){for(let i of this.parser.blockParsers)if(i){let s=i(this,e);if(s!=!1){if(s==!0)return null;e.forward();continue e}}break}let t=new _7(this.lineStart+e.pos,e.text.slice(e.pos));for(let i of this.parser.leafBlockParsers)if(i){let s=i(this,t);s&&t.parsers.push(s)}e:for(;this.nextLine()&&e.pos!=e.text.length;){if(e.indent<e.baseIndent+4){for(let i of this.parser.endLeafBlock)if(i(this,e,t))break e}for(let i of t.parsers)if(i.nextLine(this,e,t))return null;t.content+=`
`+e.scrub();for(let i of e.markers)t.marks.push(i)}return this.finishLeaf(t),null}stopAt(e){if(this.stoppedAt!=null&&this.stoppedAt<e)throw new RangeError("Can't move stoppedAt forward");this.stoppedAt=e}reuseFragment(e){if(!this.fragments.moveTo(this.absoluteLineStart+e,this.absoluteLineStart)||!this.fragments.matches(this.block.hash))return!1;let t=this.fragments.takeNodes(this);return t?(this.absoluteLineStart+=t,this.lineStart=sk(this.absoluteLineStart,this.ranges),this.moveRangeI(),this.absoluteLineStart<this.to?(this.lineStart++,this.absoluteLineStart++,this.readLine()):(this.atEnd=!0,this.readLine()),!0):!1}get depth(){return this.stack.length}parentType(e=this.depth-1){return this.parser.nodeSet.types[this.stack[e].type]}nextLine(){return this.lineStart+=this.line.text.length,this.absoluteLineEnd>=this.to?(this.absoluteLineStart=this.absoluteLineEnd,this.atEnd=!0,this.readLine(),!1):(this.lineStart++,this.absoluteLineStart=this.absoluteLineEnd+1,this.moveRangeI(),this.readLine(),!0)}peekLine(){return this.scanLine(this.absoluteLineEnd+1).text}moveRangeI(){for(;this.rangeI<this.ranges.length-1&&this.absoluteLineStart>=this.ranges[this.rangeI].to;)this.rangeI++,this.absoluteLineStart=Math.max(this.absoluteLineStart,this.ranges[this.rangeI].from)}scanLine(e){let t=E7;if(t.end=e,e>=this.to)t.text="";else if(t.text=this.lineChunkAt(e),t.end+=t.text.length,this.ranges.length>1){let i=this.absoluteLineStart,s=this.rangeI;for(;this.ranges[s].to<t.end;){s++;let n=this.ranges[s].from,a=this.lineChunkAt(n);t.end=n+a.length,t.text=t.text.slice(0,this.ranges[s-1].to-i)+a,i=t.end-t.text.length}}return t}readLine(){let{line:e}=this,{text:t,end:i}=this.scanLine(this.absoluteLineStart);for(this.absoluteLineEnd=i,e.reset(t);e.depth<this.stack.length;e.depth++){let s=this.stack[e.depth],n=this.parser.skipContextMarkup[s.type];if(!n)throw new Error("Unhandled block context "+ce[s.type]);if(!n(s,this,e))break;e.forward()}}lineChunkAt(e){let t=this.input.chunk(e),i;if(this.input.lineChunks)i=t==`
`?"":t;else{let s=t.indexOf(`
`);i=s<0?t:t.slice(0,s)}return e+i.length>this.to?i.slice(0,this.to-e):i}prevLineEnd(){return this.atEnd?this.lineStart:this.lineStart-1}startContext(e,t,i=0){this.block=kh.create(e,i,this.lineStart+t,this.block.hash,this.lineStart+this.line.text.length),this.stack.push(this.block)}startComposite(e,t,i=0){this.startContext(this.parser.getNodeType(e),t,i)}addNode(e,t,i){typeof e=="number"&&(e=new He(this.parser.nodeSet.types[e],Xa,Xa,(i??this.prevLineEnd())-t)),this.block.addChild(e,t-this.block.from)}addElement(e){this.block.addChild(e.toTree(this.parser.nodeSet),e.from-this.block.from)}addLeafElement(e,t){this.addNode(this.buffer.writeElements(Fm(t.children,e.marks),-t.from).finish(t.type,t.to-t.from),t.from)}finishContext(){let e=this.stack.pop(),t=this.stack[this.stack.length-1];t.addChild(e.toTree(this.parser.nodeSet),e.from-t.from),this.block=t}finish(){for(;this.stack.length>1;)this.finishContext();return this.addGaps(this.block.toTree(this.parser.nodeSet,this.lineStart))}addGaps(e){return this.ranges.length>1?HC(this.ranges,0,e.topNode,this.ranges[0].from,this.reusePlaceholders):e}finishLeaf(e){for(let i of e.parsers)if(i.finish(this,e))return;let t=Fm(this.parser.parseInline(e.content,e.start),e.marks);this.addNode(this.buffer.writeElements(t,-e.start).finish(ce.Paragraph,e.content.length),e.start)}elt(e,t,i,s){return typeof e=="string"?Fe(this.parser.getNodeType(e),t,i,s):new KC(e,t)}get buffer(){return new GC(this.parser.nodeSet)}}function HC(r,e,t,i,s){let n=r[e].to,a=[],o=[],l=t.from+i;function u(c,h){for(;h?c>=n:c>n;){let f=r[e+1].from-n;i+=f,c+=f,e++,n=r[e].to}}for(let c=t.firstChild;c;c=c.nextSibling){u(c.from+i,!0);let h=c.from+i,f,m=s.get(c.tree);m?f=m:c.to+i>n?(f=HC(r,e,c,i,s),u(c.to+i,!1)):f=c.toTree(),a.push(f),o.push(h-l)}return u(t.to+i,!1),new He(t.type,a,o,t.to+i-l,t.tree?t.tree.propValues:void 0)}class Od extends h0{constructor(e,t,i,s,n,a,o,l,u){super(),this.nodeSet=e,this.blockParsers=t,this.leafBlockParsers=i,this.blockNames=s,this.endLeafBlock=n,this.skipContextMarkup=a,this.inlineParsers=o,this.inlineNames=l,this.wrappers=u,this.nodeTypes=Object.create(null);for(let c of e.types)this.nodeTypes[c.name]=c.id}createParse(e,t,i){let s=new A7(this,e,t,i);for(let n of this.wrappers)s=n(s,e,t,i);return s}configure(e){let t=Bm(e);if(!t)return this;let{nodeSet:i,skipContextMarkup:s}=this,n=this.blockParsers.slice(),a=this.leafBlockParsers.slice(),o=this.blockNames.slice(),l=this.inlineParsers.slice(),u=this.inlineNames.slice(),c=this.endLeafBlock.slice(),h=this.wrappers;if(Lo(t.defineNodes)){s=Object.assign({},s);let f=i.types.slice(),m;for(let S of t.defineNodes){let{name:y,block:E,composite:C,style:_}=typeof S=="string"?{name:S}:S;if(f.some(w=>w.name==y))continue;C&&(s[f.length]=(w,A,I)=>C(A,I,w.value));let v=f.length,T=C?["Block","BlockContext"]:E?v>=ce.ATXHeading1&&v<=ce.SetextHeading2?["Block","LeafBlock","Heading"]:["Block","LeafBlock"]:void 0;f.push(Bt.define({id:v,name:y,props:T&&[[Ie.group,T]]})),_&&(m||(m={}),Array.isArray(_)||_ instanceof Ni?m[y]=_:Object.assign(m,_))}i=new ru(f),m&&(i=i.extend(io(m)))}if(Lo(t.props)&&(i=i.extend(...t.props)),Lo(t.remove))for(let f of t.remove){let m=this.blockNames.indexOf(f),S=this.inlineNames.indexOf(f);m>-1&&(n[m]=a[m]=void 0),S>-1&&(l[S]=void 0)}if(Lo(t.parseBlock))for(let f of t.parseBlock){let m=o.indexOf(f.name);if(m>-1)n[m]=f.parse,a[m]=f.leaf;else{let S=f.before?pc(o,f.before):f.after?pc(o,f.after)+1:o.length-1;n.splice(S,0,f.parse),a.splice(S,0,f.leaf),o.splice(S,0,f.name)}f.endLeaf&&c.push(f.endLeaf)}if(Lo(t.parseInline))for(let f of t.parseInline){let m=u.indexOf(f.name);if(m>-1)l[m]=f.parse;else{let S=f.before?pc(u,f.before):f.after?pc(u,f.after)+1:u.length-1;l.splice(S,0,f.parse),u.splice(S,0,f.name)}}return t.wrap&&(h=h.concat(t.wrap)),new Od(i,n,a,o,c,s,l,u,h)}getNodeType(e){let t=this.nodeTypes[e];if(t==null)throw new RangeError(`Unknown node type '${e}'`);return t}parseInline(e,t){let i=new D7(this,e,t);e:for(let s=t;s<i.end;){let n=i.char(s);for(let a of this.inlineParsers)if(a){let o=a(i,n,s);if(o>=0){s=o;continue e}}s++}return i.resolveMarkers(0)}}function Lo(r){return r!=null&&r.length>0}function Bm(r){if(!Array.isArray(r))return r;if(r.length==0)return null;let e=Bm(r[0]);if(r.length==1)return e;let t=Bm(r.slice(1));if(!t||!e)return e||t;let i=(a,o)=>(a||Xa).concat(o||Xa),s=e.wrap,n=t.wrap;return{props:i(e.props,t.props),defineNodes:i(e.defineNodes,t.defineNodes),parseBlock:i(e.parseBlock,t.parseBlock),parseInline:i(e.parseInline,t.parseInline),remove:i(e.remove,t.remove),wrap:s?n?(a,o,l,u)=>s(n(a,o,l,u),o,l,u):s:n}}function pc(r,e){let t=r.indexOf(e);if(t<0)throw new RangeError(`Position specified relative to unknown parser ${e}`);return t}let YC=[Bt.none];for(let r=1,e;e=ce[r];r++)YC[r]=Bt.define({id:r,name:e,props:r>=ce.Escape?[]:[[Ie.group,r in NC?["Block","BlockContext"]:["Block","LeafBlock"]]],top:e=="Document"});const Xa=[];let GC=class{constructor(e){this.nodeSet=e,this.content=[],this.nodes=[]}write(e,t,i,s=0){return this.content.push(e,t,i,4+s*4),this}writeElements(e,t=0){for(let i of e)i.writeTo(this,t);return this}finish(e,t){return He.build({buffer:this.content,nodeSet:this.nodeSet,reused:this.nodes,topID:e,length:t})}},Bl=class{constructor(e,t,i,s=Xa){this.type=e,this.from=t,this.to=i,this.children=s}writeTo(e,t){let i=e.content.length;e.writeElements(this.children,t),e.content.push(this.type,this.from+t,this.to+t,e.content.length+4-i)}toTree(e){return new GC(e).writeElements(this.children,-this.from).finish(this.type,this.to-this.from)}};class KC{constructor(e,t){this.tree=e,this.from=t}get to(){return this.from+this.tree.length}get type(){return this.tree.type.id}get children(){return Xa}writeTo(e,t){e.nodes.push(this.tree),e.content.push(e.nodes.length-1,this.from+t,this.to+t,-1)}toTree(){return this.tree}}function Fe(r,e,t,i){return new Bl(r,e,t,i)}const JC={resolve:"Emphasis",mark:"EmphasisMark"},ek={resolve:"Emphasis",mark:"EmphasisMark"},Jn={},Nm={};class Hi{constructor(e,t,i,s){this.type=e,this.from=t,this.to=i,this.side=s}}const SS="!\"#$%&'()*+,-./:;<=>?@[\\]^_`{|}~";let Nl=/[!"#$%&'()*+,\-.\/:;<=>?@\[\\\]^_`{|}~\xA1\u2010-\u2027]/;try{Nl=new RegExp("[\\p{S}|\\p{P}]","u")}catch{}const Wf={Escape(r,e,t){if(e!=92||t==r.end-1)return-1;let i=r.char(t+1);for(let s=0;s<SS.length;s++)if(SS.charCodeAt(s)==i)return r.append(Fe(ce.Escape,t,t+2));return-1},Entity(r,e,t){if(e!=38)return-1;let i=/^(?:#\d+|#x[a-f\d]+|\w+);/i.exec(r.slice(t+1,t+31));return i?r.append(Fe(ce.Entity,t,t+1+i[0].length)):-1},InlineCode(r,e,t){if(e!=96||t&&r.char(t-1)==96)return-1;let i=t+1;for(;i<r.end&&r.char(i)==96;)i++;let s=i-t,n=0;for(;i<r.end;i++)if(r.char(i)==96){if(n++,n==s&&r.char(i+1)!=96)return r.append(Fe(ce.InlineCode,t,i+1,[Fe(ce.CodeMark,t,t+s),Fe(ce.CodeMark,i+1-s,i+1)]))}else n=0;return-1},HTMLTag(r,e,t){if(e!=60||t==r.end-1)return-1;let i=r.slice(t+1,r.end),s=/^(?:[a-z][-\w+.]+:[^\s>]+|[a-z\d.!#$%&'*+/=?^_`{|}~-]+@[a-z\d](?:[a-z\d-]{0,61}[a-z\d])?(?:\.[a-z\d](?:[a-z\d-]{0,61}[a-z\d])?)*)>/i.exec(i);if(s)return r.append(Fe(ce.Autolink,t,t+1+s[0].length,[Fe(ce.LinkMark,t,t+1),Fe(ce.URL,t+1,t+s[0].length),Fe(ce.LinkMark,t+s[0].length,t+1+s[0].length)]));let n=/^!--[^>](?:-[^-]|[^-])*?-->/i.exec(i);if(n)return r.append(Fe(ce.Comment,t,t+1+n[0].length));let a=/^\?[^]*?\?>/.exec(i);if(a)return r.append(Fe(ce.ProcessingInstruction,t,t+1+a[0].length));let o=/^(?:![A-Z][^]*?>|!\[CDATA\[[^]*?\]\]>|\/\s*[a-zA-Z][\w-]*\s*>|\s*[a-zA-Z][\w-]*(\s+[a-zA-Z:_][\w-.:]*(?:\s*=\s*(?:[^\s"'=<>`]+|'[^']*'|"[^"]*"))?)*\s*(\/\s*)?>)/.exec(i);return o?r.append(Fe(ce.HTMLTag,t,t+1+o[0].length)):-1},Emphasis(r,e,t){if(e!=95&&e!=42)return-1;let i=t+1;for(;r.char(i)==e;)i++;let s=r.slice(t-1,t),n=r.slice(i,i+1),a=Nl.test(s),o=Nl.test(n),l=/\s|^$/.test(s),u=/\s|^$/.test(n),c=!u&&(!o||l||a),h=!l&&(!a||u||o),f=c&&(e==42||!h||a),m=h&&(e==42||!c||o);return r.append(new Hi(e==95?JC:ek,t,i,(f?1:0)|(m?2:0)))},HardBreak(r,e,t){if(e==92&&r.char(t+1)==10)return r.append(Fe(ce.HardBreak,t,t+2));if(e==32){let i=t+1;for(;r.char(i)==32;)i++;if(r.char(i)==10&&i>=t+2)return r.append(Fe(ce.HardBreak,t,i+1))}return-1},Link(r,e,t){return e==91?r.append(new Hi(Jn,t,t+1,1)):-1},Image(r,e,t){return e==33&&r.char(t+1)==91?r.append(new Hi(Nm,t,t+2,1)):-1},LinkEnd(r,e,t){if(e!=93)return-1;for(let i=r.parts.length-1;i>=0;i--){let s=r.parts[i];if(s instanceof Hi&&(s.type==Jn||s.type==Nm)){if(!s.side||r.skipSpace(s.to)==t&&!/[(\[]/.test(r.slice(t+1,t+2)))return r.parts[i]=null,-1;let n=r.takeContent(i),a=r.parts[i]=P7(r,n,s.type==Jn?ce.Link:ce.Image,s.from,t+1);if(s.type==Jn)for(let o=0;o<i;o++){let l=r.parts[o];l instanceof Hi&&l.type==Jn&&(l.side=0)}return a.to}}return-1}};function P7(r,e,t,i,s){let{text:n}=r,a=r.char(s),o=s;if(e.unshift(Fe(ce.LinkMark,i,i+(t==ce.Image?2:1))),e.push(Fe(ce.LinkMark,s-1,s)),a==40){let l=r.skipSpace(s+1),u=tk(n,l-r.offset,r.offset),c;u&&(l=r.skipSpace(u.to),l!=u.to&&(c=ik(n,l-r.offset,r.offset),c&&(l=r.skipSpace(c.to)))),r.char(l)==41&&(e.push(Fe(ce.LinkMark,s,s+1)),o=l+1,u&&e.push(u),c&&e.push(c),e.push(Fe(ce.LinkMark,l,o)))}else if(a==91){let l=rk(n,s-r.offset,r.offset,!1);l&&(e.push(l),o=l.to)}return Fe(t,i,o,e)}function tk(r,e,t){if(r.charCodeAt(e)==60){for(let s=e+1;s<r.length;s++){let n=r.charCodeAt(s);if(n==62)return Fe(ce.URL,e+t,s+1+t);if(n==60||n==10)return!1}return null}else{let s=0,n=e;for(let a=!1;n<r.length;n++){let o=r.charCodeAt(n);if(lr(o))break;if(a)a=!1;else if(o==40)s++;else if(o==41){if(!s)break;s--}else o==92&&(a=!0)}return n>e?Fe(ce.URL,e+t,n+t):n==r.length?null:!1}}function ik(r,e,t){let i=r.charCodeAt(e);if(i!=39&&i!=34&&i!=40)return!1;let s=i==40?41:i;for(let n=e+1,a=!1;n<r.length;n++){let o=r.charCodeAt(n);if(a)a=!1;else{if(o==s)return Fe(ce.LinkTitle,e+t,n+1+t);o==92&&(a=!0)}}return null}function rk(r,e,t,i){for(let s=!1,n=e+1,a=Math.min(r.length,n+999);n<a;n++){let o=r.charCodeAt(n);if(s)s=!1;else{if(o==93)return i?!1:Fe(ce.LinkLabel,e+t,n+1+t);if(i&&!lr(o)&&(i=!1),o==91)return!1;o==92&&(s=!0)}}return null}class D7{constructor(e,t,i){this.parser=e,this.text=t,this.offset=i,this.parts=[]}char(e){return e>=this.end?-1:this.text.charCodeAt(e-this.offset)}get end(){return this.offset+this.text.length}slice(e,t){return this.text.slice(e-this.offset,t-this.offset)}append(e){return this.parts.push(e),e.to}addDelimiter(e,t,i,s,n){return this.append(new Hi(e,t,i,(s?1:0)|(n?2:0)))}get hasOpenLink(){for(let e=this.parts.length-1;e>=0;e--){let t=this.parts[e];if(t instanceof Hi&&(t.type==Jn||t.type==Nm))return!0}return!1}addElement(e){return this.append(e)}resolveMarkers(e){for(let i=e;i<this.parts.length;i++){let s=this.parts[i];if(!(s instanceof Hi&&s.type.resolve&&s.side&2))continue;let n=s.type==JC||s.type==ek,a=s.to-s.from,o,l=i-1;for(;l>=e;l--){let y=this.parts[l];if(y instanceof Hi&&y.side&1&&y.type==s.type&&!(n&&(s.side&1||y.side&2)&&(y.to-y.from+a)%3==0&&((y.to-y.from)%3||a%3))){o=y;break}}if(!o)continue;let u=s.type.resolve,c=[],h=o.from,f=s.to;if(n){let y=Math.min(2,o.to-o.from,a);h=o.to-y,f=s.from+y,u=y==1?"Emphasis":"StrongEmphasis"}o.type.mark&&c.push(this.elt(o.type.mark,h,o.to));for(let y=l+1;y<i;y++)this.parts[y]instanceof Bl&&c.push(this.parts[y]),this.parts[y]=null;s.type.mark&&c.push(this.elt(s.type.mark,s.from,f));let m=this.elt(u,h,f,c);this.parts[l]=n&&o.from!=h?new Hi(o.type,o.from,h,o.side):null,(this.parts[i]=n&&s.to!=f?new Hi(s.type,f,s.to,s.side):null)?this.parts.splice(i,0,m):this.parts[i]=m}let t=[];for(let i=e;i<this.parts.length;i++){let s=this.parts[i];s instanceof Bl&&t.push(s)}return t}findOpeningDelimiter(e){for(let t=this.parts.length-1;t>=0;t--){let i=this.parts[t];if(i instanceof Hi&&i.type==e)return t}return null}takeContent(e){let t=this.resolveMarkers(e);return this.parts.length=e,t}skipSpace(e){return ll(this.text,e-this.offset)+this.offset}elt(e,t,i,s){return typeof e=="string"?Fe(this.parser.getNodeType(e),t,i,s):new KC(e,t)}}function Fm(r,e){if(!e.length)return r;if(!r.length)return e;let t=r.slice(),i=0;for(let s of e){for(;i<t.length&&t[i].to<s.to;)i++;if(i<t.length&&t[i].from<s.from){let n=t[i];n instanceof Bl&&(t[i]=new Bl(n.type,n.from,n.to,Fm(n.children,[s])))}else t.splice(i++,0,s)}return t}const M7=[ce.CodeBlock,ce.ListItem,ce.OrderedList,ce.BulletList];let I7=class{constructor(e,t){this.fragments=e,this.input=t,this.i=0,this.fragment=null,this.fragmentEnd=-1,this.cursor=null,e.length&&(this.fragment=e[this.i++])}nextFragment(){this.fragment=this.i<this.fragments.length?this.fragments[this.i++]:null,this.cursor=null,this.fragmentEnd=-1}moveTo(e,t){for(;this.fragment&&this.fragment.to<=e;)this.nextFragment();if(!this.fragment||this.fragment.from>(e?e-1:0))return!1;if(this.fragmentEnd<0){let n=this.fragment.to;for(;n>0&&this.input.read(n-1,n)!=`
`;)n--;this.fragmentEnd=n?n-1:0}let i=this.cursor;i||(i=this.cursor=this.fragment.tree.cursor(),i.firstChild());let s=e+this.fragment.offset;for(;i.to<=s;)if(!i.parent())return!1;for(;;){if(i.from>=s)return this.fragment.from<=t;if(!i.childAfter(s))return!1}}matches(e){let t=this.cursor.tree;return t&&t.prop(Ie.contextHash)==e}takeNodes(e){let t=this.cursor,i=this.fragment.offset,s=this.fragmentEnd-(this.fragment.openEnd?1:0),n=e.absoluteLineStart,a=n,o=e.block.children.length,l=a,u=o;for(;;){if(t.to-i>s){if(t.type.isAnonymous&&t.firstChild())continue;break}let c=sk(t.from-i,e.ranges);if(t.to-i<=e.ranges[e.rangeI].to)e.addNode(t.tree,c);else{let h=new He(e.parser.nodeSet.types[ce.Paragraph],[],[],0,e.block.hashProp);e.reusePlaceholders.set(h,t.tree),e.addNode(h,c)}if(t.type.is("Block")&&(M7.indexOf(t.type.id)<0?(a=t.to-i,o=e.block.children.length):(a=l,o=u,l=t.to-i,u=e.block.children.length)),!t.nextSibling())break}for(;e.block.children.length>o;)e.block.children.pop(),e.block.positions.pop();return a-n}};function sk(r,e){let t=r;for(let i=1;i<e.length;i++){let s=e[i-1].to,n=e[i].from;s<r&&(t-=n-s)}return t}const R7=io({"Blockquote/...":V.quote,HorizontalRule:V.contentSeparator,"ATXHeading1/... SetextHeading1/...":V.heading1,"ATXHeading2/... SetextHeading2/...":V.heading2,"ATXHeading3/...":V.heading3,"ATXHeading4/...":V.heading4,"ATXHeading5/...":V.heading5,"ATXHeading6/...":V.heading6,"Comment CommentBlock":V.comment,Escape:V.escape,Entity:V.character,"Emphasis/...":V.emphasis,"StrongEmphasis/...":V.strong,"Link/... Image/...":V.link,"OrderedList/... BulletList/...":V.list,"BlockQuote/...":V.quote,"InlineCode CodeText":V.monospace,"URL Autolink":V.url,"HeaderMark HardBreak QuoteMark ListMark LinkMark EmphasisMark CodeMark":V.processingInstruction,"CodeInfo LinkLabel":V.labelName,LinkTitle:V.string,Paragraph:V.content}),L7=new Od(new ru(YC).extend(R7),Object.keys(fc).map(r=>fc[r]),Object.keys(fc).map(r=>WC[r]),Object.keys(fc),k7,NC,Object.keys(Wf).map(r=>Wf[r]),Object.keys(Wf),[]);function Q7(r,e,t){let i=[];for(let s=r.firstChild,n=e;;s=s.nextSibling){let a=s?s.from:t;if(a>n&&i.push({from:n,to:a}),!s)break;n=s.to}return i}function $7(r){let{codeParser:e,htmlParser:t}=r;return{wrap:O2((s,n)=>{let a=s.type.id;if(e&&(a==ce.CodeBlock||a==ce.FencedCode)){let o="";if(a==ce.FencedCode){let u=s.node.getChild(ce.CodeInfo);u&&(o=n.read(u.from,u.to))}let l=e(o);if(l)return{parser:l,overlay:u=>u.type.id==ce.CodeText}}else if(t&&(a==ce.HTMLBlock||a==ce.HTMLTag||a==ce.CommentBlock))return{parser:t,overlay:Q7(s.node,s.from,s.to)};return null})}}const B7={resolve:"Strikethrough",mark:"StrikethroughMark"},N7={defineNodes:[{name:"Strikethrough",style:{"Strikethrough/...":V.strikethrough}},{name:"StrikethroughMark",style:V.processingInstruction}],parseInline:[{name:"Strikethrough",parse(r,e,t){if(e!=126||r.char(t+1)!=126||r.char(t+2)==126)return-1;let i=r.slice(t-1,t),s=r.slice(t+2,t+3),n=/\s|^$/.test(i),a=/\s|^$/.test(s),o=Nl.test(i),l=Nl.test(s);return r.addDelimiter(B7,t,t+2,!a&&(!l||n||o),!n&&(!o||a||l))},after:"Emphasis"}]};function ul(r,e,t=0,i,s=0){let n=0,a=!0,o=-1,l=-1,u=!1,c=()=>{i.push(r.elt("TableCell",s+o,s+l,r.parser.parseInline(e.slice(o,l),s+o)))};for(let h=t;h<e.length;h++){let f=e.charCodeAt(h);f==124&&!u?((!a||o>-1)&&n++,a=!1,i&&(o>-1&&c(),i.push(r.elt("TableDelimiter",h+s,h+s+1))),o=l=-1):(u||f!=32&&f!=9)&&(o<0&&(o=h),l=h+1),u=!u&&f==92}return o>-1&&(n++,i&&c()),n}function TS(r,e){for(let t=e;t<r.length;t++){let i=r.charCodeAt(t);if(i==124)return!0;i==92&&t++}return!1}const nk=/^\|?(\s*:?-+:?\s*\|)+(\s*:?-+:?\s*)?$/;class _S{constructor(){this.rows=null}nextLine(e,t,i){if(this.rows==null){this.rows=!1;let s;if((t.next==45||t.next==58||t.next==124)&&nk.test(s=t.text.slice(t.pos))){let n=[];ul(e,i.content,0,n,i.start)==ul(e,s,t.pos)&&(this.rows=[e.elt("TableHeader",i.start,i.start+i.content.length,n),e.elt("TableDelimiter",e.lineStart+t.pos,e.lineStart+t.text.length)])}}else if(this.rows){let s=[];ul(e,t.text,t.pos,s,e.lineStart),this.rows.push(e.elt("TableRow",e.lineStart+t.pos,e.lineStart+t.text.length,s))}return!1}finish(e,t){return this.rows?(e.addLeafElement(t,e.elt("Table",t.start,t.start+t.content.length,this.rows)),!0):!1}}const F7={defineNodes:[{name:"Table",block:!0},{name:"TableHeader",style:{"TableHeader/...":V.heading}},"TableRow",{name:"TableCell",style:V.content},{name:"TableDelimiter",style:V.processingInstruction}],parseBlock:[{name:"Table",leaf(r,e){return TS(e.content,0)?new _S:null},endLeaf(r,e,t){if(t.parsers.some(s=>s instanceof _S)||!TS(e.text,e.basePos))return!1;let i=r.peekLine();return nk.test(i)&&ul(r,e.text,e.basePos)==ul(r,i,e.basePos)},before:"SetextHeading"}]};class U7{nextLine(){return!1}finish(e,t){return e.addLeafElement(t,e.elt("Task",t.start,t.start+t.content.length,[e.elt("TaskMarker",t.start,t.start+3),...e.parser.parseInline(t.content.slice(3),t.start+3)])),!0}}const q7={defineNodes:[{name:"Task",block:!0,style:V.list},{name:"TaskMarker",style:V.atom}],parseBlock:[{name:"TaskList",leaf(r,e){return/^\[[ xX]\][ \t]/.test(e.content)&&r.parentType().name=="ListItem"?new U7:null},after:"SetextHeading"}]},xS=/(www\.)|(https?:\/\/)|([\w.+-]{1,100}@)|(mailto:|xmpp:)/gy,wS=/[\w-]+(\.[\w-]+)+(\/[^\s<]*)?/gy,V7=/[\w-]+\.[\w-]+($|\/)/,CS=/[\w.+-]+@[\w-]+(\.[\w.-]+)+/gy,kS=/\/[a-zA-Z\d@.]+/gy;function ES(r,e,t,i){let s=0;for(let n=e;n<t;n++)r[n]==i&&s++;return s}function X7(r,e){wS.lastIndex=e;let t=wS.exec(r);if(!t||V7.exec(t[0])[0].indexOf("_")>-1)return-1;let i=e+t[0].length;for(;;){let s=r[i-1],n;if(/[?!.,:*_~]/.test(s)||s==")"&&ES(r,e,i,")")>ES(r,e,i,"("))i--;else if(s==";"&&(n=/&(?:#\d+|#x[a-f\d]+|\w+);$/.exec(r.slice(e,i))))i=e+n.index;else break}return i}function AS(r,e){CS.lastIndex=e;let t=CS.exec(r);if(!t)return-1;let i=t[0][t[0].length-1];return i=="_"||i=="-"?-1:e+t[0].length-(i=="."?1:0)}const j7={parseInline:[{name:"Autolink",parse(r,e,t){let i=t-r.offset;if(i&&/\w/.test(r.text[i-1]))return-1;xS.lastIndex=i;let s=xS.exec(r.text),n=-1;if(!s)return-1;if(s[1]||s[2]){if(n=X7(r.text,i+s[0].length),n>-1&&r.hasOpenLink){let a=/([^\[\]]|\[[^\]]*\])*/.exec(r.text.slice(i,n));n=i+a[0].length}}else s[3]?n=AS(r.text,i):(n=AS(r.text,i+s[0].length),n>-1&&s[0]=="xmpp:"&&(kS.lastIndex=n,s=kS.exec(r.text),s&&(n=s.index+s[0].length)));return n<0?-1:(r.addElement(r.elt("URL",t,n+r.offset)),n+r.offset)}}]},z7=[F7,q7,N7,j7];function ak(r,e,t){return(i,s,n)=>{if(s!=r||i.char(n+1)==r)return-1;let a=[i.elt(t,n,n+1)];for(let o=n+1;o<i.end;o++){let l=i.char(o);if(l==r)return i.addElement(i.elt(e,n,o+1,a.concat(i.elt(t,o,o+1))));if(l==92&&a.push(i.elt("Escape",o,o+++2)),lr(l))break}return-1}}const Z7={defineNodes:[{name:"Superscript",style:V.special(V.content)},{name:"SuperscriptMark",style:V.processingInstruction}],parseInline:[{name:"Superscript",parse:ak(94,"Superscript","SuperscriptMark")}]},W7={defineNodes:[{name:"Subscript",style:V.special(V.content)},{name:"SubscriptMark",style:V.processingInstruction}],parseInline:[{name:"Subscript",parse:ak(126,"Subscript","SubscriptMark")}]},H7={defineNodes:[{name:"Emoji",style:V.character}],parseInline:[{name:"Emoji",parse(r,e,t){let i;return e!=58||!(i=/^[a-zA-Z_0-9]+:/.exec(r.slice(t+1,r.end)))?-1:r.addElement(r.elt("Emoji",t,t+1+i[0].length))}}]};var PS={};class Eh{constructor(e,t,i,s,n,a,o,l,u,c=0,h){this.p=e,this.stack=t,this.state=i,this.reducePos=s,this.pos=n,this.score=a,this.buffer=o,this.bufferBase=l,this.curContext=u,this.lookAhead=c,this.parent=h}toString(){return`[${this.stack.filter((e,t)=>t%3==0).concat(this.state)}]@${this.pos}${this.score?"!"+this.score:""}`}static start(e,t,i=0){let s=e.parser.context;return new Eh(e,[],t,i,i,0,[],0,s?new DS(s,s.start):null,0,null)}get context(){return this.curContext?this.curContext.context:null}pushState(e,t){this.stack.push(this.state,t,this.bufferBase+this.buffer.length),this.state=e}reduce(e){var t;let i=e>>19,s=e&65535,{parser:n}=this.p,a=this.reducePos<this.pos-25;a&&this.setLookAhead(this.pos);let o=n.dynamicPrecedence(s);if(o&&(this.score+=o),i==0){this.pushState(n.getGoto(this.state,s,!0),this.reducePos),s<n.minRepeatTerm&&this.storeNode(s,this.reducePos,this.reducePos,a?8:4,!0),this.reduceContext(s,this.reducePos);return}let l=this.stack.length-(i-1)*3-(e&262144?6:0),u=l?this.stack[l-2]:this.p.ranges[0].from,c=this.reducePos-u;c>=2e3&&!(!((t=this.p.parser.nodeSet.types[s])===null||t===void 0)&&t.isAnonymous)&&(u==this.p.lastBigReductionStart?(this.p.bigReductionCount++,this.p.lastBigReductionSize=c):this.p.lastBigReductionSize<c&&(this.p.bigReductionCount=1,this.p.lastBigReductionStart=u,this.p.lastBigReductionSize=c));let h=l?this.stack[l-1]:0,f=this.bufferBase+this.buffer.length-h;if(s<n.minRepeatTerm||e&131072){let m=n.stateFlag(this.state,1)?this.pos:this.reducePos;this.storeNode(s,u,m,f+4,!0)}if(e&262144)this.state=this.stack[l];else{let m=this.stack[l-3];this.state=n.getGoto(m,s,!0)}for(;this.stack.length>l;)this.stack.pop();this.reduceContext(s,u)}storeNode(e,t,i,s=4,n=!1){if(e==0&&(!this.stack.length||this.stack[this.stack.length-1]<this.buffer.length+this.bufferBase)){let a=this,o=this.buffer.length;if(o==0&&a.parent&&(o=a.bufferBase-a.parent.bufferBase,a=a.parent),o>0&&a.buffer[o-4]==0&&a.buffer[o-1]>-1){if(t==i)return;if(a.buffer[o-2]>=t){a.buffer[o-2]=i;return}}}if(!n||this.pos==i)this.buffer.push(e,t,i,s);else{let a=this.buffer.length;if(a>0&&this.buffer[a-4]!=0){let o=!1;for(let l=a;l>0&&this.buffer[l-2]>i;l-=4)if(this.buffer[l-1]>=0){o=!0;break}if(o)for(;a>0&&this.buffer[a-2]>i;)this.buffer[a]=this.buffer[a-4],this.buffer[a+1]=this.buffer[a-3],this.buffer[a+2]=this.buffer[a-2],this.buffer[a+3]=this.buffer[a-1],a-=4,s>4&&(s-=4)}this.buffer[a]=e,this.buffer[a+1]=t,this.buffer[a+2]=i,this.buffer[a+3]=s}}shift(e,t,i,s){if(e&131072)this.pushState(e&65535,this.pos);else if((e&262144)==0){let n=e,{parser:a}=this.p;(s>this.pos||t<=a.maxNode)&&(this.pos=s,a.stateFlag(n,1)||(this.reducePos=s)),this.pushState(n,i),this.shiftContext(t,i),t<=a.maxNode&&this.buffer.push(t,i,s,4)}else this.pos=s,this.shiftContext(t,i),t<=this.p.parser.maxNode&&this.buffer.push(t,i,s,4)}apply(e,t,i,s){e&65536?this.reduce(e):this.shift(e,t,i,s)}useNode(e,t){let i=this.p.reused.length-1;(i<0||this.p.reused[i]!=e)&&(this.p.reused.push(e),i++);let s=this.pos;this.reducePos=this.pos=s+e.length,this.pushState(t,s),this.buffer.push(i,s,this.reducePos,-1),this.curContext&&this.updateContext(this.curContext.tracker.reuse(this.curContext.context,e,this,this.p.stream.reset(this.pos-e.length)))}split(){let e=this,t=e.buffer.length;for(;t>0&&e.buffer[t-2]>e.reducePos;)t-=4;let i=e.buffer.slice(t),s=e.bufferBase+t;for(;e&&s==e.bufferBase;)e=e.parent;return new Eh(this.p,this.stack.slice(),this.state,this.reducePos,this.pos,this.score,i,s,this.curContext,this.lookAhead,e)}recoverByDelete(e,t){let i=e<=this.p.parser.maxNode;i&&this.storeNode(e,this.pos,t,4),this.storeNode(0,this.pos,t,i?8:4),this.pos=this.reducePos=t,this.score-=190}canShift(e){for(let t=new Y7(this);;){let i=this.p.parser.stateSlot(t.state,4)||this.p.parser.hasAction(t.state,e);if(i==0)return!1;if((i&65536)==0)return!0;t.reduce(i)}}recoverByInsert(e){if(this.stack.length>=300)return[];let t=this.p.parser.nextStates(this.state);if(t.length>8||this.stack.length>=120){let s=[];for(let n=0,a;n<t.length;n+=2)(a=t[n+1])!=this.state&&this.p.parser.hasAction(a,e)&&s.push(t[n],a);if(this.stack.length<120)for(let n=0;s.length<8&&n<t.length;n+=2){let a=t[n+1];s.some((o,l)=>l&1&&o==a)||s.push(t[n],a)}t=s}let i=[];for(let s=0;s<t.length&&i.length<4;s+=2){let n=t[s+1];if(n==this.state)continue;let a=this.split();a.pushState(n,this.pos),a.storeNode(0,a.pos,a.pos,4,!0),a.shiftContext(t[s],this.pos),a.reducePos=this.pos,a.score-=200,i.push(a)}return i}forceReduce(){let{parser:e}=this.p,t=e.stateSlot(this.state,5);if((t&65536)==0)return!1;if(!e.validAction(this.state,t)){let i=t>>19,s=t&65535,n=this.stack.length-i*3;if(n<0||e.getGoto(this.stack[n],s,!1)<0){let a=this.findForcedReduction();if(a==null)return!1;t=a}this.storeNode(0,this.pos,this.pos,4,!0),this.score-=100}return this.reducePos=this.pos,this.reduce(t),!0}findForcedReduction(){let{parser:e}=this.p,t=[],i=(s,n)=>{if(!t.includes(s))return t.push(s),e.allActions(s,a=>{if(!(a&393216))if(a&65536){let o=(a>>19)-n;if(o>1){let l=a&65535,u=this.stack.length-o*3;if(u>=0&&e.getGoto(this.stack[u],l,!1)>=0)return o<<19|65536|l}}else{let o=i(a,n+1);if(o!=null)return o}})};return i(this.state,0)}forceAll(){for(;!this.p.parser.stateFlag(this.state,2);)if(!this.forceReduce()){this.storeNode(0,this.pos,this.pos,4,!0);break}return this}get deadEnd(){if(this.stack.length!=3)return!1;let{parser:e}=this.p;return e.data[e.stateSlot(this.state,1)]==65535&&!e.stateSlot(this.state,4)}restart(){this.storeNode(0,this.pos,this.pos,4,!0),this.state=this.stack[0],this.stack.length=0}sameState(e){if(this.state!=e.state||this.stack.length!=e.stack.length)return!1;for(let t=0;t<this.stack.length;t+=3)if(this.stack[t]!=e.stack[t])return!1;return!0}get parser(){return this.p.parser}dialectEnabled(e){return this.p.parser.dialect.flags[e]}shiftContext(e,t){this.curContext&&this.updateContext(this.curContext.tracker.shift(this.curContext.context,e,this,this.p.stream.reset(t)))}reduceContext(e,t){this.curContext&&this.updateContext(this.curContext.tracker.reduce(this.curContext.context,e,this,this.p.stream.reset(t)))}emitContext(){let e=this.buffer.length-1;(e<0||this.buffer[e]!=-3)&&this.buffer.push(this.curContext.hash,this.pos,this.pos,-3)}emitLookAhead(){let e=this.buffer.length-1;(e<0||this.buffer[e]!=-4)&&this.buffer.push(this.lookAhead,this.pos,this.pos,-4)}updateContext(e){if(e!=this.curContext.context){let t=new DS(this.curContext.tracker,e);t.hash!=this.curContext.hash&&this.emitContext(),this.curContext=t}}setLookAhead(e){e>this.lookAhead&&(this.emitLookAhead(),this.lookAhead=e)}close(){this.curContext&&this.curContext.tracker.strict&&this.emitContext(),this.lookAhead>0&&this.emitLookAhead()}}class DS{constructor(e,t){this.tracker=e,this.context=t,this.hash=e.strict?e.hash(t):0}}class Y7{constructor(e){this.start=e,this.state=e.state,this.stack=e.stack,this.base=this.stack.length}reduce(e){let t=e&65535,i=e>>19;i==0?(this.stack==this.start.stack&&(this.stack=this.stack.slice()),this.stack.push(this.state,0,0),this.base+=3):this.base-=(i-1)*3;let s=this.start.p.parser.getGoto(this.stack[this.base-3],t,!0);this.state=s}}class Ah{constructor(e,t,i){this.stack=e,this.pos=t,this.index=i,this.buffer=e.buffer,this.index==0&&this.maybeNext()}static create(e,t=e.bufferBase+e.buffer.length){return new Ah(e,t,t-e.bufferBase)}maybeNext(){let e=this.stack.parent;e!=null&&(this.index=this.stack.bufferBase-e.bufferBase,this.stack=e,this.buffer=e.buffer)}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}next(){this.index-=4,this.pos-=4,this.index==0&&this.maybeNext()}fork(){return new Ah(this.stack,this.pos,this.index)}}function jo(r,e=Uint16Array){if(typeof r!="string")return r;let t=null;for(let i=0,s=0;i<r.length;){let n=0;for(;;){let a=r.charCodeAt(i++),o=!1;if(a==126){n=65535;break}a>=92&&a--,a>=34&&a--;let l=a-32;if(l>=46&&(l-=46,o=!0),n+=l,o)break;n*=46}t?t[s++]=n:t=new e(n)}return t}class Ec{constructor(){this.start=-1,this.value=-1,this.end=-1,this.extended=-1,this.lookAhead=0,this.mask=0,this.context=0}}const MS=new Ec;class G7{constructor(e,t){this.input=e,this.ranges=t,this.chunk="",this.chunkOff=0,this.chunk2="",this.chunk2Pos=0,this.next=-1,this.token=MS,this.rangeIndex=0,this.pos=this.chunkPos=t[0].from,this.range=t[0],this.end=t[t.length-1].to,this.readNext()}resolveOffset(e,t){let i=this.range,s=this.rangeIndex,n=this.pos+e;for(;n<i.from;){if(!s)return null;let a=this.ranges[--s];n-=i.from-a.to,i=a}for(;t<0?n>i.to:n>=i.to;){if(s==this.ranges.length-1)return null;let a=this.ranges[++s];n+=a.from-i.to,i=a}return n}clipPos(e){if(e>=this.range.from&&e<this.range.to)return e;for(let t of this.ranges)if(t.to>e)return Math.max(e,t.from);return this.end}peek(e){let t=this.chunkOff+e,i,s;if(t>=0&&t<this.chunk.length)i=this.pos+e,s=this.chunk.charCodeAt(t);else{let n=this.resolveOffset(e,1);if(n==null)return-1;if(i=n,i>=this.chunk2Pos&&i<this.chunk2Pos+this.chunk2.length)s=this.chunk2.charCodeAt(i-this.chunk2Pos);else{let a=this.rangeIndex,o=this.range;for(;o.to<=i;)o=this.ranges[++a];this.chunk2=this.input.chunk(this.chunk2Pos=i),i+this.chunk2.length>o.to&&(this.chunk2=this.chunk2.slice(0,o.to-i)),s=this.chunk2.charCodeAt(0)}}return i>=this.token.lookAhead&&(this.token.lookAhead=i+1),s}acceptToken(e,t=0){let i=t?this.resolveOffset(t,-1):this.pos;if(i==null||i<this.token.start)throw new RangeError("Token end out of bounds");this.token.value=e,this.token.end=i}acceptTokenTo(e,t){this.token.value=e,this.token.end=t}getChunk(){if(this.pos>=this.chunk2Pos&&this.pos<this.chunk2Pos+this.chunk2.length){let{chunk:e,chunkPos:t}=this;this.chunk=this.chunk2,this.chunkPos=this.chunk2Pos,this.chunk2=e,this.chunk2Pos=t,this.chunkOff=this.pos-this.chunkPos}else{this.chunk2=this.chunk,this.chunk2Pos=this.chunkPos;let e=this.input.chunk(this.pos),t=this.pos+e.length;this.chunk=t>this.range.to?e.slice(0,this.range.to-this.pos):e,this.chunkPos=this.pos,this.chunkOff=0}}readNext(){return this.chunkOff>=this.chunk.length&&(this.getChunk(),this.chunkOff==this.chunk.length)?this.next=-1:this.next=this.chunk.charCodeAt(this.chunkOff)}advance(e=1){for(this.chunkOff+=e;this.pos+e>=this.range.to;){if(this.rangeIndex==this.ranges.length-1)return this.setDone();e-=this.range.to-this.pos,this.range=this.ranges[++this.rangeIndex],this.pos=this.range.from}return this.pos+=e,this.pos>=this.token.lookAhead&&(this.token.lookAhead=this.pos+1),this.readNext()}setDone(){return this.pos=this.chunkPos=this.end,this.range=this.ranges[this.rangeIndex=this.ranges.length-1],this.chunk="",this.next=-1}reset(e,t){if(t?(this.token=t,t.start=e,t.lookAhead=e+1,t.value=t.extended=-1):this.token=MS,this.pos!=e){if(this.pos=e,e==this.end)return this.setDone(),this;for(;e<this.range.from;)this.range=this.ranges[--this.rangeIndex];for(;e>=this.range.to;)this.range=this.ranges[++this.rangeIndex];e>=this.chunkPos&&e<this.chunkPos+this.chunk.length?this.chunkOff=e-this.chunkPos:(this.chunk="",this.chunkOff=0),this.readNext()}return this}read(e,t){if(e>=this.chunkPos&&t<=this.chunkPos+this.chunk.length)return this.chunk.slice(e-this.chunkPos,t-this.chunkPos);if(e>=this.chunk2Pos&&t<=this.chunk2Pos+this.chunk2.length)return this.chunk2.slice(e-this.chunk2Pos,t-this.chunk2Pos);if(e>=this.range.from&&t<=this.range.to)return this.input.read(e,t);let i="";for(let s of this.ranges){if(s.from>=t)break;s.to>e&&(i+=this.input.read(Math.max(s.from,e),Math.min(s.to,t)))}return i}}class Ca{constructor(e,t){this.data=e,this.id=t}token(e,t){let{parser:i}=t.p;ok(this.data,e,t,this.id,i.data,i.tokenPrecTable)}}Ca.prototype.contextual=Ca.prototype.fallback=Ca.prototype.extend=!1;class Ph{constructor(e,t,i){this.precTable=t,this.elseToken=i,this.data=typeof e=="string"?jo(e):e}token(e,t){let i=e.pos,s=0;for(;;){let n=e.next<0,a=e.resolveOffset(1,1);if(ok(this.data,e,t,0,this.data,this.precTable),e.token.value>-1)break;if(this.elseToken==null)return;if(n||s++,a==null)break;e.reset(a,e.token)}s&&(e.reset(i,e.token),e.acceptToken(this.elseToken,s))}}Ph.prototype.contextual=Ca.prototype.fallback=Ca.prototype.extend=!1;class Vi{constructor(e,t={}){this.token=e,this.contextual=!!t.contextual,this.fallback=!!t.fallback,this.extend=!!t.extend}}function ok(r,e,t,i,s,n){let a=0,o=1<<i,{dialect:l}=t.p.parser;e:for(;(o&r[a])!=0;){let u=r[a+1];for(let m=a+3;m<u;m+=2)if((r[m+1]&o)>0){let S=r[m];if(l.allows(S)&&(e.token.value==-1||e.token.value==S||K7(S,e.token.value,s,n))){e.acceptToken(S);break}}let c=e.next,h=0,f=r[a+2];if(e.next<0&&f>h&&r[u+f*3-3]==65535){a=r[u+f*3-1];continue e}for(;h<f;){let m=h+f>>1,S=u+m+(m<<1),y=r[S],E=r[S+1]||65536;if(c<y)f=m;else if(c>=E)h=m+1;else{a=r[S+2],e.advance();continue e}}break}}function IS(r,e,t){for(let i=e,s;(s=r[i])!=65535;i++)if(s==t)return i-e;return-1}function K7(r,e,t,i){let s=IS(t,i,e);return s<0||IS(t,i,r)<s}const Li=typeof process<"u"&&PS&&/\bparse\b/.test(PS.LOG);let Hf=null;function RS(r,e,t){let i=r.cursor(lt.IncludeAnonymous);for(i.moveTo(e);;)if(!(t<0?i.childBefore(e):i.childAfter(e)))for(;;){if((t<0?i.to<e:i.from>e)&&!i.type.isError)return t<0?Math.max(0,Math.min(i.to-1,e-25)):Math.min(r.length,Math.max(i.from+1,e+25));if(t<0?i.prevSibling():i.nextSibling())break;if(!i.parent())return t<0?0:r.length}}class J7{constructor(e,t){this.fragments=e,this.nodeSet=t,this.i=0,this.fragment=null,this.safeFrom=-1,this.safeTo=-1,this.trees=[],this.start=[],this.index=[],this.nextFragment()}nextFragment(){let e=this.fragment=this.i==this.fragments.length?null:this.fragments[this.i++];if(e){for(this.safeFrom=e.openStart?RS(e.tree,e.from+e.offset,1)-e.offset:e.from,this.safeTo=e.openEnd?RS(e.tree,e.to+e.offset,-1)-e.offset:e.to;this.trees.length;)this.trees.pop(),this.start.pop(),this.index.pop();this.trees.push(e.tree),this.start.push(-e.offset),this.index.push(0),this.nextStart=this.safeFrom}else this.nextStart=1e9}nodeAt(e){if(e<this.nextStart)return null;for(;this.fragment&&this.safeTo<=e;)this.nextFragment();if(!this.fragment)return null;for(;;){let t=this.trees.length-1;if(t<0)return this.nextFragment(),null;let i=this.trees[t],s=this.index[t];if(s==i.children.length){this.trees.pop(),this.start.pop(),this.index.pop();continue}let n=i.children[s],a=this.start[t]+i.positions[s];if(a>e)return this.nextStart=a,null;if(n instanceof He){if(a==e){if(a<this.safeFrom)return null;let o=a+n.length;if(o<=this.safeTo){let l=n.prop(Ie.lookAhead);if(!l||o+l<this.fragment.to)return n}}this.index[t]++,a+n.length>=Math.max(this.safeFrom,e)&&(this.trees.push(n),this.start.push(a),this.index.push(0))}else this.index[t]++,this.nextStart=a+n.length}}}class eU{constructor(e,t){this.stream=t,this.tokens=[],this.mainToken=null,this.actions=[],this.tokens=e.tokenizers.map(i=>new Ec)}getActions(e){let t=0,i=null,{parser:s}=e.p,{tokenizers:n}=s,a=s.stateSlot(e.state,3),o=e.curContext?e.curContext.hash:0,l=0;for(let u=0;u<n.length;u++){if((1<<u&a)==0)continue;let c=n[u],h=this.tokens[u];if(!(i&&!c.fallback)&&((c.contextual||h.start!=e.pos||h.mask!=a||h.context!=o)&&(this.updateCachedToken(h,c,e),h.mask=a,h.context=o),h.lookAhead>h.end+25&&(l=Math.max(h.lookAhead,l)),h.value!=0)){let f=t;if(h.extended>-1&&(t=this.addActions(e,h.extended,h.end,t)),t=this.addActions(e,h.value,h.end,t),!c.extend&&(i=h,t>f))break}}for(;this.actions.length>t;)this.actions.pop();return l&&e.setLookAhead(l),!i&&e.pos==this.stream.end&&(i=new Ec,i.value=e.p.parser.eofTerm,i.start=i.end=e.pos,t=this.addActions(e,i.value,i.end,t)),this.mainToken=i,this.actions}getMainToken(e){if(this.mainToken)return this.mainToken;let t=new Ec,{pos:i,p:s}=e;return t.start=i,t.end=Math.min(i+1,s.stream.end),t.value=i==s.stream.end?s.parser.eofTerm:0,t}updateCachedToken(e,t,i){let s=this.stream.clipPos(i.pos);if(t.token(this.stream.reset(s,e),i),e.value>-1){let{parser:n}=i.p;for(let a=0;a<n.specialized.length;a++)if(n.specialized[a]==e.value){let o=n.specializers[a](this.stream.read(e.start,e.end),i);if(o>=0&&i.p.parser.dialect.allows(o>>1)){(o&1)==0?e.value=o>>1:e.extended=o>>1;break}}}else e.value=0,e.end=this.stream.clipPos(s+1)}putAction(e,t,i,s){for(let n=0;n<s;n+=3)if(this.actions[n]==e)return s;return this.actions[s++]=e,this.actions[s++]=t,this.actions[s++]=i,s}addActions(e,t,i,s){let{state:n}=e,{parser:a}=e.p,{data:o}=a;for(let l=0;l<2;l++)for(let u=a.stateSlot(n,l?2:1);;u+=3){if(o[u]==65535)if(o[u+1]==1)u=cs(o,u+2);else{s==0&&o[u+1]==2&&(s=this.putAction(cs(o,u+2),t,i,s));break}o[u]==t&&(s=this.putAction(cs(o,u+1),t,i,s))}return s}}class tU{constructor(e,t,i,s){this.parser=e,this.input=t,this.ranges=s,this.recovering=0,this.nextStackID=9812,this.minStackPos=0,this.reused=[],this.stoppedAt=null,this.lastBigReductionStart=-1,this.lastBigReductionSize=0,this.bigReductionCount=0,this.stream=new G7(t,s),this.tokens=new eU(e,this.stream),this.topTerm=e.top[1];let{from:n}=s[0];this.stacks=[Eh.start(this,e.top[0],n)],this.fragments=i.length&&this.stream.end-n>e.bufferLength*4?new J7(i,e.nodeSet):null}get parsedPos(){return this.minStackPos}advance(){let e=this.stacks,t=this.minStackPos,i=this.stacks=[],s,n;if(this.bigReductionCount>300&&e.length==1){let[a]=e;for(;a.forceReduce()&&a.stack.length&&a.stack[a.stack.length-2]>=this.lastBigReductionStart;);this.bigReductionCount=this.lastBigReductionSize=0}for(let a=0;a<e.length;a++){let o=e[a];for(;;){if(this.tokens.mainToken=null,o.pos>t)i.push(o);else{if(this.advanceStack(o,i,e))continue;{s||(s=[],n=[]),s.push(o);let l=this.tokens.getMainToken(o);n.push(l.value,l.end)}}break}}if(!i.length){let a=s&&rU(s);if(a)return Li&&console.log("Finish with "+this.stackID(a)),this.stackToTree(a);if(this.parser.strict)throw Li&&s&&console.log("Stuck with token "+(this.tokens.mainToken?this.parser.getName(this.tokens.mainToken.value):"none")),new SyntaxError("No parse at "+t);this.recovering||(this.recovering=5)}if(this.recovering&&s){let a=this.stoppedAt!=null&&s[0].pos>this.stoppedAt?s[0]:this.runRecovery(s,n,i);if(a)return Li&&console.log("Force-finish "+this.stackID(a)),this.stackToTree(a.forceAll())}if(this.recovering){let a=this.recovering==1?1:this.recovering*3;if(i.length>a)for(i.sort((o,l)=>l.score-o.score);i.length>a;)i.pop();i.some(o=>o.reducePos>t)&&this.recovering--}else if(i.length>1){e:for(let a=0;a<i.length-1;a++){let o=i[a];for(let l=a+1;l<i.length;l++){let u=i[l];if(o.sameState(u)||o.buffer.length>500&&u.buffer.length>500)if((o.score-u.score||o.buffer.length-u.buffer.length)>0)i.splice(l--,1);else{i.splice(a--,1);continue e}}}i.length>12&&i.splice(12,i.length-12)}this.minStackPos=i[0].pos;for(let a=1;a<i.length;a++)i[a].pos<this.minStackPos&&(this.minStackPos=i[a].pos);return null}stopAt(e){if(this.stoppedAt!=null&&this.stoppedAt<e)throw new RangeError("Can't move stoppedAt forward");this.stoppedAt=e}advanceStack(e,t,i){let s=e.pos,{parser:n}=this,a=Li?this.stackID(e)+" -> ":"";if(this.stoppedAt!=null&&s>this.stoppedAt)return e.forceReduce()?e:null;if(this.fragments){let u=e.curContext&&e.curContext.tracker.strict,c=u?e.curContext.hash:0;for(let h=this.fragments.nodeAt(s);h;){let f=this.parser.nodeSet.types[h.type.id]==h.type?n.getGoto(e.state,h.type.id):-1;if(f>-1&&h.length&&(!u||(h.prop(Ie.contextHash)||0)==c))return e.useNode(h,f),Li&&console.log(a+this.stackID(e)+` (via reuse of ${n.getName(h.type.id)})`),!0;if(!(h instanceof He)||h.children.length==0||h.positions[0]>0)break;let m=h.children[0];if(m instanceof He&&h.positions[0]==0)h=m;else break}}let o=n.stateSlot(e.state,4);if(o>0)return e.reduce(o),Li&&console.log(a+this.stackID(e)+` (via always-reduce ${n.getName(o&65535)})`),!0;if(e.stack.length>=8400)for(;e.stack.length>6e3&&e.forceReduce(););let l=this.tokens.getActions(e);for(let u=0;u<l.length;){let c=l[u++],h=l[u++],f=l[u++],m=u==l.length||!i,S=m?e:e.split(),y=this.tokens.mainToken;if(S.apply(c,h,y?y.start:S.pos,f),Li&&console.log(a+this.stackID(S)+` (via ${(c&65536)==0?"shift":`reduce of ${n.getName(c&65535)}`} for ${n.getName(h)} @ ${s}${S==e?"":", split"})`),m)return!0;S.pos>s?t.push(S):i.push(S)}return!1}advanceFully(e,t){let i=e.pos;for(;;){if(!this.advanceStack(e,null,null))return!1;if(e.pos>i)return LS(e,t),!0}}runRecovery(e,t,i){let s=null,n=!1;for(let a=0;a<e.length;a++){let o=e[a],l=t[a<<1],u=t[(a<<1)+1],c=Li?this.stackID(o)+" -> ":"";if(o.deadEnd&&(n||(n=!0,o.restart(),Li&&console.log(c+this.stackID(o)+" (restarted)"),this.advanceFully(o,i))))continue;let h=o.split(),f=c;for(let m=0;h.forceReduce()&&m<10&&(Li&&console.log(f+this.stackID(h)+" (via force-reduce)"),!this.advanceFully(h,i));m++)Li&&(f=this.stackID(h)+" -> ");for(let m of o.recoverByInsert(l))Li&&console.log(c+this.stackID(m)+" (via recover-insert)"),this.advanceFully(m,i);this.stream.end>o.pos?(u==o.pos&&(u++,l=0),o.recoverByDelete(l,u),Li&&console.log(c+this.stackID(o)+` (via recover-delete ${this.parser.getName(l)})`),LS(o,i)):(!s||s.score<o.score)&&(s=o)}return s}stackToTree(e){return e.close(),He.build({buffer:Ah.create(e),nodeSet:this.parser.nodeSet,topID:this.topTerm,maxBufferLength:this.parser.bufferLength,reused:this.reused,start:this.ranges[0].from,length:e.pos-this.ranges[0].from,minRepeatType:this.parser.minRepeatTerm})}stackID(e){let t=(Hf||(Hf=new WeakMap)).get(e);return t||Hf.set(e,t=String.fromCodePoint(this.nextStackID++)),t+e}}function LS(r,e){for(let t=0;t<e.length;t++){let i=e[t];if(i.pos==r.pos&&i.sameState(r)){e[t].score<r.score&&(e[t]=r);return}}e.push(r)}class iU{constructor(e,t,i){this.source=e,this.flags=t,this.disabled=i}allows(e){return!this.disabled||this.disabled[e]==0}}const Yf=r=>r;class lk{constructor(e){this.start=e.start,this.shift=e.shift||Yf,this.reduce=e.reduce||Yf,this.reuse=e.reuse||Yf,this.hash=e.hash||(()=>0),this.strict=e.strict!==!1}}class ja extends h0{constructor(e){if(super(),this.wrappers=[],e.version!=14)throw new RangeError(`Parser version (${e.version}) doesn't match runtime version (14)`);let t=e.nodeNames.split(" ");this.minRepeatTerm=t.length;for(let o=0;o<e.repeatNodeCount;o++)t.push("");let i=Object.keys(e.topRules).map(o=>e.topRules[o][1]),s=[];for(let o=0;o<t.length;o++)s.push([]);function n(o,l,u){s[o].push([l,l.deserialize(String(u))])}if(e.nodeProps)for(let o of e.nodeProps){let l=o[0];typeof l=="string"&&(l=Ie[l]);for(let u=1;u<o.length;){let c=o[u++];if(c>=0)n(c,l,o[u++]);else{let h=o[u+-c];for(let f=-c;f>0;f--)n(o[u++],l,h);u++}}}this.nodeSet=new ru(t.map((o,l)=>Bt.define({name:l>=this.minRepeatTerm?void 0:o,id:l,props:s[l],top:i.indexOf(l)>-1,error:l==0,skipped:e.skippedNodes&&e.skippedNodes.indexOf(l)>-1}))),e.propSources&&(this.nodeSet=this.nodeSet.extend(...e.propSources)),this.strict=!1,this.bufferLength=d2;let a=jo(e.tokenData);this.context=e.context,this.specializerSpecs=e.specialized||[],this.specialized=new Uint16Array(this.specializerSpecs.length);for(let o=0;o<this.specializerSpecs.length;o++)this.specialized[o]=this.specializerSpecs[o].term;this.specializers=this.specializerSpecs.map(QS),this.states=jo(e.states,Uint32Array),this.data=jo(e.stateData),this.goto=jo(e.goto),this.maxTerm=e.maxTerm,this.tokenizers=e.tokenizers.map(o=>typeof o=="number"?new Ca(a,o):o),this.topRules=e.topRules,this.dialects=e.dialects||{},this.dynamicPrecedences=e.dynamicPrecedences||null,this.tokenPrecTable=e.tokenPrec,this.termNames=e.termNames||null,this.maxNode=this.nodeSet.types.length-1,this.dialect=this.parseDialect(),this.top=this.topRules[Object.keys(this.topRules)[0]]}createParse(e,t,i){let s=new tU(this,e,t,i);for(let n of this.wrappers)s=n(s,e,t,i);return s}getGoto(e,t,i=!1){let s=this.goto;if(t>=s[0])return-1;for(let n=s[t+1];;){let a=s[n++],o=a&1,l=s[n++];if(o&&i)return l;for(let u=n+(a>>1);n<u;n++)if(s[n]==e)return l;if(o)return-1}}hasAction(e,t){let i=this.data;for(let s=0;s<2;s++)for(let n=this.stateSlot(e,s?2:1),a;;n+=3){if((a=i[n])==65535)if(i[n+1]==1)a=i[n=cs(i,n+2)];else{if(i[n+1]==2)return cs(i,n+2);break}if(a==t||a==0)return cs(i,n+1)}return 0}stateSlot(e,t){return this.states[e*6+t]}stateFlag(e,t){return(this.stateSlot(e,0)&t)>0}validAction(e,t){return!!this.allActions(e,i=>i==t?!0:null)}allActions(e,t){let i=this.stateSlot(e,4),s=i?t(i):void 0;for(let n=this.stateSlot(e,1);s==null;n+=3){if(this.data[n]==65535)if(this.data[n+1]==1)n=cs(this.data,n+2);else break;s=t(cs(this.data,n+1))}return s}nextStates(e){let t=[];for(let i=this.stateSlot(e,1);;i+=3){if(this.data[i]==65535)if(this.data[i+1]==1)i=cs(this.data,i+2);else break;if((this.data[i+2]&1)==0){let s=this.data[i+1];t.some((n,a)=>a&1&&n==s)||t.push(this.data[i],s)}}return t}configure(e){let t=Object.assign(Object.create(ja.prototype),this);if(e.props&&(t.nodeSet=this.nodeSet.extend(...e.props)),e.top){let i=this.topRules[e.top];if(!i)throw new RangeError(`Invalid top rule name ${e.top}`);t.top=i}return e.tokenizers&&(t.tokenizers=this.tokenizers.map(i=>{let s=e.tokenizers.find(n=>n.from==i);return s?s.to:i})),e.specializers&&(t.specializers=this.specializers.slice(),t.specializerSpecs=this.specializerSpecs.map((i,s)=>{let n=e.specializers.find(o=>o.from==i.external);if(!n)return i;let a=Object.assign(Object.assign({},i),{external:n.to});return t.specializers[s]=QS(a),a})),e.contextTracker&&(t.context=e.contextTracker),e.dialect&&(t.dialect=this.parseDialect(e.dialect)),e.strict!=null&&(t.strict=e.strict),e.wrap&&(t.wrappers=t.wrappers.concat(e.wrap)),e.bufferLength!=null&&(t.bufferLength=e.bufferLength),t}hasWrappers(){return this.wrappers.length>0}getName(e){return this.termNames?this.termNames[e]:String(e<=this.maxNode&&this.nodeSet.types[e].name||e)}get eofTerm(){return this.maxNode+1}get topNode(){return this.nodeSet.types[this.top[1]]}dynamicPrecedence(e){let t=this.dynamicPrecedences;return t==null?0:t[e]||0}parseDialect(e){let t=Object.keys(this.dialects),i=t.map(()=>!1);if(e)for(let n of e.split(" ")){let a=t.indexOf(n);a>=0&&(i[a]=!0)}let s=null;for(let n=0;n<t.length;n++)if(!i[n])for(let a=this.dialects[t[n]],o;(o=this.data[a++])!=65535;)(s||(s=new Uint8Array(this.maxTerm+1)))[o]=1;return new iU(e,i,s)}static deserialize(e){return new ja(e)}}function cs(r,e){return r[e]|r[e+1]<<16}function rU(r){let e=null;for(let t of r){let i=t.p.stoppedAt;(t.pos==t.p.stream.end||i!=null&&t.pos>i)&&t.p.parser.stateFlag(t.state,2)&&(!e||e.score<t.score)&&(e=t)}return e}function QS(r){if(r.external){let e=r.extend?1:0;return(t,i)=>r.external(t,i)<<1|e}return r.get}const sU=55,nU=1,aU=56,oU=2,lU=57,uU=3,$S=4,cU=5,L0=6,uk=7,ck=8,hk=9,dk=10,hU=11,dU=12,fU=13,Gf=58,pU=14,mU=15,BS=59,fk=21,gU=23,pk=24,OU=25,Um=27,mk=28,yU=29,bU=32,vU=35,SU=37,TU=38,_U=0,xU=1,wU={area:!0,base:!0,br:!0,col:!0,command:!0,embed:!0,frame:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0,menuitem:!0},CU={dd:!0,li:!0,optgroup:!0,option:!0,p:!0,rp:!0,rt:!0,tbody:!0,td:!0,tfoot:!0,th:!0,tr:!0},NS={dd:{dd:!0,dt:!0},dt:{dd:!0,dt:!0},li:{li:!0},option:{option:!0,optgroup:!0},optgroup:{optgroup:!0},p:{address:!0,article:!0,aside:!0,blockquote:!0,dir:!0,div:!0,dl:!0,fieldset:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,menu:!0,nav:!0,ol:!0,p:!0,pre:!0,section:!0,table:!0,ul:!0},rp:{rp:!0,rt:!0},rt:{rp:!0,rt:!0},tbody:{tbody:!0,tfoot:!0},td:{td:!0,th:!0},tfoot:{tbody:!0},th:{td:!0,th:!0},thead:{tbody:!0,tfoot:!0},tr:{tr:!0}};function kU(r){return r==45||r==46||r==58||r>=65&&r<=90||r==95||r>=97&&r<=122||r>=161}let FS=null,US=null,qS=0;function qm(r,e){let t=r.pos+e;if(qS==t&&US==r)return FS;let i=r.peek(e),s="";for(;kU(i);)s+=String.fromCharCode(i),i=r.peek(++e);return US=r,qS=t,FS=s?s.toLowerCase():i==EU||i==AU?void 0:null}const gk=60,Dh=62,Q0=47,EU=63,AU=33,PU=45;function VS(r,e){this.name=r,this.parent=e}const DU=[L0,dk,uk,ck,hk],MU=new lk({start:null,shift(r,e,t,i){return DU.indexOf(e)>-1?new VS(qm(i,1)||"",r):r},reduce(r,e){return e==fk&&r?r.parent:r},reuse(r,e,t,i){let s=e.type.id;return s==L0||s==SU?new VS(qm(i,1)||"",r):r},strict:!1}),IU=new Vi((r,e)=>{if(r.next!=gk){r.next<0&&e.context&&r.acceptToken(Gf);return}r.advance();let t=r.next==Q0;t&&r.advance();let i=qm(r,0);if(i===void 0)return;if(!i)return r.acceptToken(t?mU:pU);let s=e.context?e.context.name:null;if(t){if(i==s)return r.acceptToken(hU);if(s&&CU[s])return r.acceptToken(Gf,-2);if(e.dialectEnabled(_U))return r.acceptToken(dU);for(let n=e.context;n;n=n.parent)if(n.name==i)return;r.acceptToken(fU)}else{if(i=="script")return r.acceptToken(uk);if(i=="style")return r.acceptToken(ck);if(i=="textarea")return r.acceptToken(hk);if(wU.hasOwnProperty(i))return r.acceptToken(dk);s&&NS[s]&&NS[s][i]?r.acceptToken(Gf,-1):r.acceptToken(L0)}},{contextual:!0}),RU=new Vi(r=>{for(let e=0,t=0;;t++){if(r.next<0){t&&r.acceptToken(BS);break}if(r.next==PU)e++;else if(r.next==Dh&&e>=2){t>=3&&r.acceptToken(BS,-2);break}else e=0;r.advance()}});function LU(r){for(;r;r=r.parent)if(r.name=="svg"||r.name=="math")return!0;return!1}const QU=new Vi((r,e)=>{if(r.next==Q0&&r.peek(1)==Dh){let t=e.dialectEnabled(xU)||LU(e.context);r.acceptToken(t?cU:$S,2)}else r.next==Dh&&r.acceptToken($S,1)});function $0(r,e,t){let i=2+r.length;return new Vi(s=>{for(let n=0,a=0,o=0;;o++){if(s.next<0){o&&s.acceptToken(e);break}if(n==0&&s.next==gk||n==1&&s.next==Q0||n>=2&&n<i&&s.next==r.charCodeAt(n-2))n++,a++;else if(n==i&&s.next==Dh){o>a?s.acceptToken(e,-a):s.acceptToken(t,-(a-2));break}else if((s.next==10||s.next==13)&&o){s.acceptToken(e,1);break}else n=a=0;s.advance()}})}const $U=$0("script",sU,nU),BU=$0("style",aU,oU),NU=$0("textarea",lU,uU),FU=io({"Text RawText IncompleteTag IncompleteCloseTag":V.content,"StartTag StartCloseTag SelfClosingEndTag EndTag":V.angleBracket,TagName:V.tagName,"MismatchedCloseTag/TagName":[V.tagName,V.invalid],AttributeName:V.attributeName,"AttributeValue UnquotedAttributeValue":V.attributeValue,Is:V.definitionOperator,"EntityReference CharacterReference":V.character,Comment:V.blockComment,ProcessingInst:V.processingInstruction,DoctypeDecl:V.documentMeta}),UU=ja.deserialize({version:14,states:",xOVO!rOOO!ZQ#tO'#CrO!`Q#tO'#C{O!eQ#tO'#DOO!jQ#tO'#DRO!oQ#tO'#DTO!tOaO'#CqO#PObO'#CqO#[OdO'#CqO$kO!rO'#CqOOO`'#Cq'#CqO$rO$fO'#DUO$zQ#tO'#DWO%PQ#tO'#DXOOO`'#Dl'#DlOOO`'#DZ'#DZQVO!rOOO%UQ&rO,59^O%aQ&rO,59gO%lQ&rO,59jO%wQ&rO,59mO&SQ&rO,59oOOOa'#D_'#D_O&_OaO'#CyO&jOaO,59]OOOb'#D`'#D`O&rObO'#C|O&}ObO,59]OOOd'#Da'#DaO'VOdO'#DPO'bOdO,59]OOO`'#Db'#DbO'jO!rO,59]O'qQ#tO'#DSOOO`,59],59]OOOp'#Dc'#DcO'vO$fO,59pOOO`,59p,59pO(OQ#|O,59rO(TQ#|O,59sOOO`-E7X-E7XO(YQ&rO'#CtOOQW'#D['#D[O(hQ&rO1G.xOOOa1G.x1G.xOOO`1G/Z1G/ZO(sQ&rO1G/ROOOb1G/R1G/RO)OQ&rO1G/UOOOd1G/U1G/UO)ZQ&rO1G/XOOO`1G/X1G/XO)fQ&rO1G/ZOOOa-E7]-E7]O)qQ#tO'#CzOOO`1G.w1G.wOOOb-E7^-E7^O)vQ#tO'#C}OOOd-E7_-E7_O){Q#tO'#DQOOO`-E7`-E7`O*QQ#|O,59nOOOp-E7a-E7aOOO`1G/[1G/[OOO`1G/^1G/^OOO`1G/_1G/_O*VQ,UO,59`OOQW-E7Y-E7YOOOa7+$d7+$dOOO`7+$u7+$uOOOb7+$m7+$mOOOd7+$p7+$pOOO`7+$s7+$sO*bQ#|O,59fO*gQ#|O,59iO*lQ#|O,59lOOO`1G/Y1G/YO*qO7[O'#CwO+SOMhO'#CwOOQW1G.z1G.zOOO`1G/Q1G/QOOO`1G/T1G/TOOO`1G/W1G/WOOOO'#D]'#D]O+eO7[O,59cOOQW,59c,59cOOOO'#D^'#D^O+vOMhO,59cOOOO-E7Z-E7ZOOQW1G.}1G.}OOOO-E7[-E7[",stateData:",c~O!_OS~OUSOVPOWQOXROYTO[]O][O^^O_^Oa^Ob^Oc^Od^Oy^O|_O!eZO~OgaO~OgbO~OgcO~OgdO~OgeO~O!XfOPmP![mP~O!YiOQpP![pP~O!ZlORsP![sP~OUSOVPOWQOXROYTOZqO[]O][O^^O_^Oa^Ob^Oc^Od^Oy^O!eZO~O![rO~P#gO!]sO!fuO~OgvO~OgwO~OS|OT}OiyO~OS!POT}OiyO~OS!ROT}OiyO~OS!TOT}OiyO~OS}OT}OiyO~O!XfOPmX![mX~OP!WO![!XO~O!YiOQpX![pX~OQ!ZO![!XO~O!ZlORsX![sX~OR!]O![!XO~O![!XO~P#gOg!_O~O!]sO!f!aO~OS!bO~OS!cO~Oj!dOShXThXihX~OS!fOT!gOiyO~OS!hOT!gOiyO~OS!iOT!gOiyO~OS!jOT!gOiyO~OS!gOT!gOiyO~Og!kO~Og!lO~Og!mO~OS!nO~Ol!qO!a!oO!c!pO~OS!rO~OS!sO~OS!tO~Ob!uOc!uOd!uO!a!wO!b!uO~Ob!xOc!xOd!xO!c!wO!d!xO~Ob!uOc!uOd!uO!a!{O!b!uO~Ob!xOc!xOd!xO!c!{O!d!xO~OT~cbd!ey|!e~",goto:"%q!aPPPPPPPPPPPPPPPPPPPPP!b!hP!nPP!zP!}#Q#T#Z#^#a#g#j#m#s#y!bP!b!bP$P$V$m$s$y%P%V%]%cPPPPPPPP%iX^OX`pXUOX`pezabcde{!O!Q!S!UR!q!dRhUR!XhXVOX`pRkVR!XkXWOX`pRnWR!XnXXOX`pQrXR!XpXYOX`pQ`ORx`Q{aQ!ObQ!QcQ!SdQ!UeZ!e{!O!Q!S!UQ!v!oR!z!vQ!y!pR!|!yQgUR!VgQjVR!YjQmWR![mQpXR!^pQtZR!`tS_O`ToXp",nodeNames:"⚠ StartCloseTag StartCloseTag StartCloseTag EndTag SelfClosingEndTag StartTag StartTag StartTag StartTag StartTag StartCloseTag StartCloseTag StartCloseTag IncompleteTag IncompleteCloseTag Document Text EntityReference CharacterReference InvalidEntity Element OpenTag TagName Attribute AttributeName Is AttributeValue UnquotedAttributeValue ScriptText CloseTag OpenTag StyleText CloseTag OpenTag TextareaText CloseTag OpenTag CloseTag SelfClosingTag Comment ProcessingInst MismatchedCloseTag CloseTag DoctypeDecl",maxTerm:68,context:MU,nodeProps:[["closedBy",-10,1,2,3,7,8,9,10,11,12,13,"EndTag",6,"EndTag SelfClosingEndTag",-4,22,31,34,37,"CloseTag"],["openedBy",4,"StartTag StartCloseTag",5,"StartTag",-4,30,33,36,38,"OpenTag"],["group",-10,14,15,18,19,20,21,40,41,42,43,"Entity",17,"Entity TextContent",-3,29,32,35,"TextContent Entity"],["isolate",-11,22,30,31,33,34,36,37,38,39,42,43,"ltr",-3,27,28,40,""]],propSources:[FU],skippedNodes:[0],repeatNodeCount:9,tokenData:"!<p!aR!YOX$qXY,QYZ,QZ[$q[]&X]^,Q^p$qpq,Qqr-_rs3_sv-_vw3}wxHYx}-_}!OH{!O!P-_!P!Q$q!Q![-_![!]Mz!]!^-_!^!_!$S!_!`!;x!`!a&X!a!c-_!c!}Mz!}#R-_#R#SMz#S#T1k#T#oMz#o#s-_#s$f$q$f%W-_%W%oMz%o%p-_%p&aMz&a&b-_&b1pMz1p4U-_4U4dMz4d4e-_4e$ISMz$IS$I`-_$I`$IbMz$Ib$Kh-_$Kh%#tMz%#t&/x-_&/x&EtMz&Et&FV-_&FV;'SMz;'S;:j!#|;:j;=`3X<%l?&r-_?&r?AhMz?Ah?BY$q?BY?MnMz?MnO$q!Z$|caPlW!b`!dpOX$qXZ&XZ[$q[^&X^p$qpq&Xqr$qrs&}sv$qvw+Pwx(tx!^$q!^!_*V!_!a&X!a#S$q#S#T&X#T;'S$q;'S;=`+z<%lO$q!R&bXaP!b`!dpOr&Xrs&}sv&Xwx(tx!^&X!^!_*V!_;'S&X;'S;=`*y<%lO&Xq'UVaP!dpOv&}wx'kx!^&}!^!_(V!_;'S&};'S;=`(n<%lO&}P'pTaPOv'kw!^'k!_;'S'k;'S;=`(P<%lO'kP(SP;=`<%l'kp([S!dpOv(Vx;'S(V;'S;=`(h<%lO(Vp(kP;=`<%l(Vq(qP;=`<%l&}a({WaP!b`Or(trs'ksv(tw!^(t!^!_)e!_;'S(t;'S;=`*P<%lO(t`)jT!b`Or)esv)ew;'S)e;'S;=`)y<%lO)e`)|P;=`<%l)ea*SP;=`<%l(t!Q*^V!b`!dpOr*Vrs(Vsv*Vwx)ex;'S*V;'S;=`*s<%lO*V!Q*vP;=`<%l*V!R*|P;=`<%l&XW+UYlWOX+PZ[+P^p+Pqr+Psw+Px!^+P!a#S+P#T;'S+P;'S;=`+t<%lO+PW+wP;=`<%l+P!Z+}P;=`<%l$q!a,]`aP!b`!dp!_^OX&XXY,QYZ,QZ]&X]^,Q^p&Xpq,Qqr&Xrs&}sv&Xwx(tx!^&X!^!_*V!_;'S&X;'S;=`*y<%lO&X!_-ljiSaPlW!b`!dpOX$qXZ&XZ[$q[^&X^p$qpq&Xqr-_rs&}sv-_vw/^wx(tx!P-_!P!Q$q!Q!^-_!^!_*V!_!a&X!a#S-_#S#T1k#T#s-_#s$f$q$f;'S-_;'S;=`3X<%l?Ah-_?Ah?BY$q?BY?Mn-_?MnO$q[/ebiSlWOX+PZ[+P^p+Pqr/^sw/^x!P/^!P!Q+P!Q!^/^!a#S/^#S#T0m#T#s/^#s$f+P$f;'S/^;'S;=`1e<%l?Ah/^?Ah?BY+P?BY?Mn/^?MnO+PS0rXiSqr0msw0mx!P0m!Q!^0m!a#s0m$f;'S0m;'S;=`1_<%l?Ah0m?BY?Mn0mS1bP;=`<%l0m[1hP;=`<%l/^!V1vciSaP!b`!dpOq&Xqr1krs&}sv1kvw0mwx(tx!P1k!P!Q&X!Q!^1k!^!_*V!_!a&X!a#s1k#s$f&X$f;'S1k;'S;=`3R<%l?Ah1k?Ah?BY&X?BY?Mn1k?MnO&X!V3UP;=`<%l1k!_3[P;=`<%l-_!Z3hV!ahaP!dpOv&}wx'kx!^&}!^!_(V!_;'S&};'S;=`(n<%lO&}!_4WiiSlWd!ROX5uXZ7SZ[5u[^7S^p5uqr8trs7Sst>]tw8twx7Sx!P8t!P!Q5u!Q!]8t!]!^/^!^!a7S!a#S8t#S#T;{#T#s8t#s$f5u$f;'S8t;'S;=`>V<%l?Ah8t?Ah?BY5u?BY?Mn8t?MnO5u!Z5zblWOX5uXZ7SZ[5u[^7S^p5uqr5urs7Sst+Ptw5uwx7Sx!]5u!]!^7w!^!a7S!a#S5u#S#T7S#T;'S5u;'S;=`8n<%lO5u!R7VVOp7Sqs7St!]7S!]!^7l!^;'S7S;'S;=`7q<%lO7S!R7qOb!R!R7tP;=`<%l7S!Z8OYlWb!ROX+PZ[+P^p+Pqr+Psw+Px!^+P!a#S+P#T;'S+P;'S;=`+t<%lO+P!Z8qP;=`<%l5u!_8{iiSlWOX5uXZ7SZ[5u[^7S^p5uqr8trs7Sst/^tw8twx7Sx!P8t!P!Q5u!Q!]8t!]!^:j!^!a7S!a#S8t#S#T;{#T#s8t#s$f5u$f;'S8t;'S;=`>V<%l?Ah8t?Ah?BY5u?BY?Mn8t?MnO5u!_:sbiSlWb!ROX+PZ[+P^p+Pqr/^sw/^x!P/^!P!Q+P!Q!^/^!a#S/^#S#T0m#T#s/^#s$f+P$f;'S/^;'S;=`1e<%l?Ah/^?Ah?BY+P?BY?Mn/^?MnO+P!V<QciSOp7Sqr;{rs7Sst0mtw;{wx7Sx!P;{!P!Q7S!Q!];{!]!^=]!^!a7S!a#s;{#s$f7S$f;'S;{;'S;=`>P<%l?Ah;{?Ah?BY7S?BY?Mn;{?MnO7S!V=dXiSb!Rqr0msw0mx!P0m!Q!^0m!a#s0m$f;'S0m;'S;=`1_<%l?Ah0m?BY?Mn0m!V>SP;=`<%l;{!_>YP;=`<%l8t!_>dhiSlWOX@OXZAYZ[@O[^AY^p@OqrBwrsAYswBwwxAYx!PBw!P!Q@O!Q!]Bw!]!^/^!^!aAY!a#SBw#S#TE{#T#sBw#s$f@O$f;'SBw;'S;=`HS<%l?AhBw?Ah?BY@O?BY?MnBw?MnO@O!Z@TalWOX@OXZAYZ[@O[^AY^p@Oqr@OrsAYsw@OwxAYx!]@O!]!^Az!^!aAY!a#S@O#S#TAY#T;'S@O;'S;=`Bq<%lO@O!RA]UOpAYq!]AY!]!^Ao!^;'SAY;'S;=`At<%lOAY!RAtOc!R!RAwP;=`<%lAY!ZBRYlWc!ROX+PZ[+P^p+Pqr+Psw+Px!^+P!a#S+P#T;'S+P;'S;=`+t<%lO+P!ZBtP;=`<%l@O!_COhiSlWOX@OXZAYZ[@O[^AY^p@OqrBwrsAYswBwwxAYx!PBw!P!Q@O!Q!]Bw!]!^Dj!^!aAY!a#SBw#S#TE{#T#sBw#s$f@O$f;'SBw;'S;=`HS<%l?AhBw?Ah?BY@O?BY?MnBw?MnO@O!_DsbiSlWc!ROX+PZ[+P^p+Pqr/^sw/^x!P/^!P!Q+P!Q!^/^!a#S/^#S#T0m#T#s/^#s$f+P$f;'S/^;'S;=`1e<%l?Ah/^?Ah?BY+P?BY?Mn/^?MnO+P!VFQbiSOpAYqrE{rsAYswE{wxAYx!PE{!P!QAY!Q!]E{!]!^GY!^!aAY!a#sE{#s$fAY$f;'SE{;'S;=`G|<%l?AhE{?Ah?BYAY?BY?MnE{?MnOAY!VGaXiSc!Rqr0msw0mx!P0m!Q!^0m!a#s0m$f;'S0m;'S;=`1_<%l?Ah0m?BY?Mn0m!VHPP;=`<%lE{!_HVP;=`<%lBw!ZHcW!cxaP!b`Or(trs'ksv(tw!^(t!^!_)e!_;'S(t;'S;=`*P<%lO(t!aIYliSaPlW!b`!dpOX$qXZ&XZ[$q[^&X^p$qpq&Xqr-_rs&}sv-_vw/^wx(tx}-_}!OKQ!O!P-_!P!Q$q!Q!^-_!^!_*V!_!a&X!a#S-_#S#T1k#T#s-_#s$f$q$f;'S-_;'S;=`3X<%l?Ah-_?Ah?BY$q?BY?Mn-_?MnO$q!aK_kiSaPlW!b`!dpOX$qXZ&XZ[$q[^&X^p$qpq&Xqr-_rs&}sv-_vw/^wx(tx!P-_!P!Q$q!Q!^-_!^!_*V!_!`&X!`!aMS!a#S-_#S#T1k#T#s-_#s$f$q$f;'S-_;'S;=`3X<%l?Ah-_?Ah?BY$q?BY?Mn-_?MnO$q!TM_XaP!b`!dp!fQOr&Xrs&}sv&Xwx(tx!^&X!^!_*V!_;'S&X;'S;=`*y<%lO&X!aNZ!ZiSgQaPlW!b`!dpOX$qXZ&XZ[$q[^&X^p$qpq&Xqr-_rs&}sv-_vw/^wx(tx}-_}!OMz!O!PMz!P!Q$q!Q![Mz![!]Mz!]!^-_!^!_*V!_!a&X!a!c-_!c!}Mz!}#R-_#R#SMz#S#T1k#T#oMz#o#s-_#s$f$q$f$}-_$}%OMz%O%W-_%W%oMz%o%p-_%p&aMz&a&b-_&b1pMz1p4UMz4U4dMz4d4e-_4e$ISMz$IS$I`-_$I`$IbMz$Ib$Je-_$Je$JgMz$Jg$Kh-_$Kh%#tMz%#t&/x-_&/x&EtMz&Et&FV-_&FV;'SMz;'S;:j!#|;:j;=`3X<%l?&r-_?&r?AhMz?Ah?BY$q?BY?MnMz?MnO$q!a!$PP;=`<%lMz!R!$ZY!b`!dpOq*Vqr!$yrs(Vsv*Vwx)ex!a*V!a!b!4t!b;'S*V;'S;=`*s<%lO*V!R!%Q]!b`!dpOr*Vrs(Vsv*Vwx)ex}*V}!O!%y!O!f*V!f!g!']!g#W*V#W#X!0`#X;'S*V;'S;=`*s<%lO*V!R!&QX!b`!dpOr*Vrs(Vsv*Vwx)ex}*V}!O!&m!O;'S*V;'S;=`*s<%lO*V!R!&vV!b`!dp!ePOr*Vrs(Vsv*Vwx)ex;'S*V;'S;=`*s<%lO*V!R!'dX!b`!dpOr*Vrs(Vsv*Vwx)ex!q*V!q!r!(P!r;'S*V;'S;=`*s<%lO*V!R!(WX!b`!dpOr*Vrs(Vsv*Vwx)ex!e*V!e!f!(s!f;'S*V;'S;=`*s<%lO*V!R!(zX!b`!dpOr*Vrs(Vsv*Vwx)ex!v*V!v!w!)g!w;'S*V;'S;=`*s<%lO*V!R!)nX!b`!dpOr*Vrs(Vsv*Vwx)ex!{*V!{!|!*Z!|;'S*V;'S;=`*s<%lO*V!R!*bX!b`!dpOr*Vrs(Vsv*Vwx)ex!r*V!r!s!*}!s;'S*V;'S;=`*s<%lO*V!R!+UX!b`!dpOr*Vrs(Vsv*Vwx)ex!g*V!g!h!+q!h;'S*V;'S;=`*s<%lO*V!R!+xY!b`!dpOr!+qrs!,hsv!+qvw!-Swx!.[x!`!+q!`!a!/j!a;'S!+q;'S;=`!0Y<%lO!+qq!,mV!dpOv!,hvx!-Sx!`!,h!`!a!-q!a;'S!,h;'S;=`!.U<%lO!,hP!-VTO!`!-S!`!a!-f!a;'S!-S;'S;=`!-k<%lO!-SP!-kO|PP!-nP;=`<%l!-Sq!-xS!dp|POv(Vx;'S(V;'S;=`(h<%lO(Vq!.XP;=`<%l!,ha!.aX!b`Or!.[rs!-Ssv!.[vw!-Sw!`!.[!`!a!.|!a;'S!.[;'S;=`!/d<%lO!.[a!/TT!b`|POr)esv)ew;'S)e;'S;=`)y<%lO)ea!/gP;=`<%l!.[!R!/sV!b`!dp|POr*Vrs(Vsv*Vwx)ex;'S*V;'S;=`*s<%lO*V!R!0]P;=`<%l!+q!R!0gX!b`!dpOr*Vrs(Vsv*Vwx)ex#c*V#c#d!1S#d;'S*V;'S;=`*s<%lO*V!R!1ZX!b`!dpOr*Vrs(Vsv*Vwx)ex#V*V#V#W!1v#W;'S*V;'S;=`*s<%lO*V!R!1}X!b`!dpOr*Vrs(Vsv*Vwx)ex#h*V#h#i!2j#i;'S*V;'S;=`*s<%lO*V!R!2qX!b`!dpOr*Vrs(Vsv*Vwx)ex#m*V#m#n!3^#n;'S*V;'S;=`*s<%lO*V!R!3eX!b`!dpOr*Vrs(Vsv*Vwx)ex#d*V#d#e!4Q#e;'S*V;'S;=`*s<%lO*V!R!4XX!b`!dpOr*Vrs(Vsv*Vwx)ex#X*V#X#Y!+q#Y;'S*V;'S;=`*s<%lO*V!R!4{Y!b`!dpOr!4trs!5ksv!4tvw!6Vwx!8]x!a!4t!a!b!:]!b;'S!4t;'S;=`!;r<%lO!4tq!5pV!dpOv!5kvx!6Vx!a!5k!a!b!7W!b;'S!5k;'S;=`!8V<%lO!5kP!6YTO!a!6V!a!b!6i!b;'S!6V;'S;=`!7Q<%lO!6VP!6lTO!`!6V!`!a!6{!a;'S!6V;'S;=`!7Q<%lO!6VP!7QOyPP!7TP;=`<%l!6Vq!7]V!dpOv!5kvx!6Vx!`!5k!`!a!7r!a;'S!5k;'S;=`!8V<%lO!5kq!7yS!dpyPOv(Vx;'S(V;'S;=`(h<%lO(Vq!8YP;=`<%l!5ka!8bX!b`Or!8]rs!6Vsv!8]vw!6Vw!a!8]!a!b!8}!b;'S!8];'S;=`!:V<%lO!8]a!9SX!b`Or!8]rs!6Vsv!8]vw!6Vw!`!8]!`!a!9o!a;'S!8];'S;=`!:V<%lO!8]a!9vT!b`yPOr)esv)ew;'S)e;'S;=`)y<%lO)ea!:YP;=`<%l!8]!R!:dY!b`!dpOr!4trs!5ksv!4tvw!6Vwx!8]x!`!4t!`!a!;S!a;'S!4t;'S;=`!;r<%lO!4t!R!;]V!b`!dpyPOr*Vrs(Vsv*Vwx)ex;'S*V;'S;=`*s<%lO*V!R!;uP;=`<%l!4t!V!<TXjSaP!b`!dpOr&Xrs&}sv&Xwx(tx!^&X!^!_*V!_;'S&X;'S;=`*y<%lO&X",tokenizers:[$U,BU,NU,QU,IU,RU,0,1,2,3,4,5],topRules:{Document:[0,16]},dialects:{noMatch:0,selfClosing:515},tokenPrec:517});function Ok(r,e){let t=Object.create(null);for(let i of r.getChildren(pk)){let s=i.getChild(OU),n=i.getChild(Um)||i.getChild(mk);s&&(t[e.read(s.from,s.to)]=n?n.type.id==Um?e.read(n.from+1,n.to-1):e.read(n.from,n.to):"")}return t}function XS(r,e){let t=r.getChild(gU);return t?e.read(t.from,t.to):" "}function Kf(r,e,t){let i;for(let s of t)if(!s.attrs||s.attrs(i||(i=Ok(r.node.parent.firstChild,e))))return{parser:s.parser};return null}function yk(r=[],e=[]){let t=[],i=[],s=[],n=[];for(let o of r)(o.tag=="script"?t:o.tag=="style"?i:o.tag=="textarea"?s:n).push(o);let a=e.length?Object.create(null):null;for(let o of e)(a[o.name]||(a[o.name]=[])).push(o);return O2((o,l)=>{let u=o.type.id;if(u==yU)return Kf(o,l,t);if(u==bU)return Kf(o,l,i);if(u==vU)return Kf(o,l,s);if(u==fk&&n.length){let c=o.node,h=c.firstChild,f=h&&XS(h,l),m;if(f){for(let S of n)if(S.tag==f&&(!S.attrs||S.attrs(m||(m=Ok(h,l))))){let y=c.lastChild,E=y.type.id==TU?y.from:c.to;if(E>h.to)return{parser:S.parser,overlay:[{from:h.to,to:E}]}}}}if(a&&u==pk){let c=o.node,h;if(h=c.firstChild){let f=a[l.read(h.from,h.to)];if(f)for(let m of f){if(m.tagName&&m.tagName!=XS(c.parent,l))continue;let S=c.lastChild;if(S.type.id==Um){let y=S.from+1,E=S.lastChild,C=S.to-(E&&E.isError?0:1);if(C>y)return{parser:m.parser,overlay:[{from:y,to:C}]}}else if(S.type.id==mk)return{parser:m.parser,overlay:[{from:S.from,to:S.to}]}}}}return null})}const qU=122,jS=1,VU=123,XU=124,bk=2,jU=125,zU=3,ZU=4,vk=[9,10,11,12,13,32,133,160,5760,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8232,8233,8239,8287,12288],WU=58,HU=40,Sk=95,YU=91,Ac=45,GU=46,KU=35,JU=37,eq=38,tq=92,iq=10,rq=42;function Fl(r){return r>=65&&r<=90||r>=97&&r<=122||r>=161}function B0(r){return r>=48&&r<=57}function zS(r){return B0(r)||r>=97&&r<=102||r>=65&&r<=70}const Tk=(r,e,t)=>(i,s)=>{for(let n=!1,a=0,o=0;;o++){let{next:l}=i;if(Fl(l)||l==Ac||l==Sk||n&&B0(l))!n&&(l!=Ac||o>0)&&(n=!0),a===o&&l==Ac&&a++,i.advance();else if(l==tq&&i.peek(1)!=iq){if(i.advance(),zS(i.next)){do i.advance();while(zS(i.next));i.next==32&&i.advance()}else i.next>-1&&i.advance();n=!0}else{n&&i.acceptToken(a==2&&s.canShift(bk)?e:l==HU?t:r);break}}},sq=new Vi(Tk(VU,bk,XU)),nq=new Vi(Tk(jU,zU,ZU)),aq=new Vi(r=>{if(vk.includes(r.peek(-1))){let{next:e}=r;(Fl(e)||e==Sk||e==KU||e==GU||e==rq||e==YU||e==WU&&Fl(r.peek(1))||e==Ac||e==eq)&&r.acceptToken(qU)}}),oq=new Vi(r=>{if(!vk.includes(r.peek(-1))){let{next:e}=r;if(e==JU&&(r.advance(),r.acceptToken(jS)),Fl(e)){do r.advance();while(Fl(r.next)||B0(r.next));r.acceptToken(jS)}}}),lq=io({"AtKeyword import charset namespace keyframes media supports":V.definitionKeyword,"from to selector":V.keyword,NamespaceName:V.namespace,KeyframeName:V.labelName,KeyframeRangeName:V.operatorKeyword,TagName:V.tagName,ClassName:V.className,PseudoClassName:V.constant(V.className),IdName:V.labelName,"FeatureName PropertyName":V.propertyName,AttributeName:V.attributeName,NumberLiteral:V.number,KeywordQuery:V.keyword,UnaryQueryOp:V.operatorKeyword,"CallTag ValueName":V.atom,VariableName:V.variableName,Callee:V.operatorKeyword,Unit:V.unit,"UniversalSelector NestingSelector":V.definitionOperator,"MatchOp CompareOp":V.compareOperator,"ChildOp SiblingOp, LogicOp":V.logicOperator,BinOp:V.arithmeticOperator,Important:V.modifier,Comment:V.blockComment,ColorLiteral:V.color,"ParenthesizedContent StringLiteral":V.string,":":V.punctuation,"PseudoOp #":V.derefOperator,"; ,":V.separator,"( )":V.paren,"[ ]":V.squareBracket,"{ }":V.brace}),uq={__proto__:null,lang:38,"nth-child":38,"nth-last-child":38,"nth-of-type":38,"nth-last-of-type":38,dir:38,"host-context":38,if:84,url:124,"url-prefix":124,domain:124,regexp:124},cq={__proto__:null,or:98,and:98,not:106,only:106,layer:170},hq={__proto__:null,selector:112,layer:166},dq={__proto__:null,"@import":162,"@media":174,"@charset":178,"@namespace":182,"@keyframes":188,"@supports":200,"@scope":204},fq={__proto__:null,to:207},pq=ja.deserialize({version:14,states:"EbQYQdOOO#qQdOOP#xO`OOOOQP'#Cf'#CfOOQP'#Ce'#CeO#}QdO'#ChO$nQaO'#CcO$xQdO'#CkO%TQdO'#DpO%YQdO'#DrO%_QdO'#DuO%_QdO'#DxOOQP'#FV'#FVO&eQhO'#EhOOQS'#FU'#FUOOQS'#Ek'#EkQYQdOOO&lQdO'#EOO&PQhO'#EUO&lQdO'#EWO'aQdO'#EYO'lQdO'#E]O'tQhO'#EcO(VQdO'#EeO(bQaO'#CfO)VQ`O'#D{O)[Q`O'#F`O)gQdO'#F`QOQ`OOP)qO&jO'#CaPOOO)C@t)C@tOOQP'#Cj'#CjOOQP,59S,59SO#}QdO,59SO)|QdO,59VO%TQdO,5:[O%YQdO,5:^O%_QdO,5:aO%_QdO,5:cO%_QdO,5:dO%_QdO'#ErO*XQ`O,58}O*aQdO'#DzOOQS,58},58}OOQP'#Cn'#CnOOQO'#Dn'#DnOOQP,59V,59VO*hQ`O,59VO*mQ`O,59VOOQP'#Dq'#DqOOQP,5:[,5:[OOQO'#Ds'#DsO*rQpO,5:^O+]QaO,5:aO+sQaO,5:dOOQW'#DZ'#DZO,ZQhO'#DdO,xQhO'#FaO'tQhO'#DbO-WQ`O'#DhOOQW'#F['#F[O-]Q`O,5;SO-eQ`O'#DeOOQS-E8i-E8iOOQ['#Cs'#CsO-jQdO'#CtO.QQdO'#CzO.hQdO'#C}O/OQ!pO'#DPO1RQ!jO,5:jOOQO'#DU'#DUO*mQ`O'#DTO1cQ!nO'#FXO3`Q`O'#DVO3eQ`O'#DkOOQ['#FX'#FXO-`Q`O,5:pO3jQ!bO,5:rOOQS'#E['#E[O3rQ`O,5:tO3wQdO,5:tOOQO'#E_'#E_O4PQ`O,5:wO4UQhO,5:}O%_QdO'#DgOOQS,5;P,5;PO-eQ`O,5;PO4^QdO,5;PO4fQdO,5:gO4vQdO'#EtO5TQ`O,5;zO5TQ`O,5;zPOOO'#Ej'#EjP5`O&jO,58{POOO,58{,58{OOQP1G.n1G.nOOQP1G.q1G.qO*hQ`O1G.qO*mQ`O1G.qOOQP1G/v1G/vO5kQpO1G/xO5sQaO1G/{O6ZQaO1G/}O6qQaO1G0OO7XQaO,5;^OOQO-E8p-E8pOOQS1G.i1G.iO7cQ`O,5:fO7hQdO'#DoO7oQdO'#CrOOQP1G/x1G/xO&lQdO1G/xO7vQ!jO'#DZO8UQ!bO,59vO8^QhO,5:OOOQO'#F]'#F]O8XQ!bO,59zO'tQhO,59xO8fQhO'#EvO8sQ`O,5;{O9OQhO,59|O9uQhO'#DiOOQW,5:S,5:SOOQS1G0n1G0nOOQW,5:P,5:PO9|Q!fO'#FYOOQS'#FY'#FYOOQS'#Em'#EmO;^QdO,59`OOQ[,59`,59`O;tQdO,59fOOQ[,59f,59fO<[QdO,59iOOQ[,59i,59iOOQ[,59k,59kO&lQdO,59mO<rQhO'#EQOOQW'#EQ'#EQO=WQ`O1G0UO1[QhO1G0UOOQ[,59o,59oO'tQhO'#DXOOQ[,59q,59qO=]Q#tO,5:VOOQS1G0[1G0[OOQS1G0^1G0^OOQS1G0`1G0`O=hQ`O1G0`O=mQdO'#E`OOQS1G0c1G0cOOQS1G0i1G0iO=xQaO,5:RO-`Q`O1G0kOOQS1G0k1G0kO-eQ`O1G0kO>PQ!fO1G0ROOQO1G0R1G0ROOQO,5;`,5;`O>gQdO,5;`OOQO-E8r-E8rO>tQ`O1G1fPOOO-E8h-E8hPOOO1G.g1G.gOOQP7+$]7+$]OOQP7+%d7+%dO&lQdO7+%dOOQS1G0Q1G0QO?PQaO'#F_O?ZQ`O,5:ZO?`Q!fO'#ElO@^QdO'#FWO@hQ`O,59^O@mQ!bO7+%dO&lQdO1G/bO@uQhO1G/fOOQW1G/j1G/jOOQW1G/d1G/dOAWQhO,5;bOOQO-E8t-E8tOAfQhO'#DZOAtQhO'#F^OBPQ`O'#F^OBUQ`O,5:TOOQS-E8k-E8kOOQ[1G.z1G.zOOQ[1G/Q1G/QOOQ[1G/T1G/TOOQ[1G/X1G/XOBZQdO,5:lOOQS7+%p7+%pOB`Q`O7+%pOBeQhO'#DYOBmQ`O,59sO'tQhO,59sOOQ[1G/q1G/qOBuQ`O1G/qOOQS7+%z7+%zOBzQbO'#DPOOQO'#Eb'#EbOCYQ`O'#EaOOQO'#Ea'#EaOCeQ`O'#EwOCmQdO,5:zOOQS,5:z,5:zOOQ[1G/m1G/mOOQS7+&V7+&VO-`Q`O7+&VOCxQ!fO'#EsO&lQdO'#EsOEPQdO7+%mOOQO7+%m7+%mOOQO1G0z1G0zOEdQ!bO<<IOOElQdO'#EqOEvQ`O,5;yOOQP1G/u1G/uOOQS-E8j-E8jOFOQdO'#EpOFYQ`O,5;rOOQ]1G.x1G.xOOQP<<IO<<IOOFbQdO7+$|OOQO'#D]'#D]OFiQ!bO7+%QOFqQhO'#EoOF{Q`O,5;xO&lQdO,5;xOOQW1G/o1G/oOOQO'#ES'#ESOGTQ`O1G0WOOQS<<I[<<I[O&lQdO,59tOGnQhO1G/_OOQ[1G/_1G/_OGuQ`O1G/_OOQW-E8l-E8lOOQ[7+%]7+%]OOQO,5:{,5:{O=pQdO'#ExOCeQ`O,5;cOOQS,5;c,5;cOOQS-E8u-E8uOOQS1G0f1G0fOOQS<<Iq<<IqOG}Q!fO,5;_OOQS-E8q-E8qOOQO<<IX<<IXOOQPAN>jAN>jOIUQaO,5;]OOQO-E8o-E8oOI`QdO,5;[OOQO-E8n-E8nOOQW<<Hh<<HhOOQW<<Hl<<HlOIjQhO<<HlOI{QhO,5;ZOJWQ`O,5;ZOOQO-E8m-E8mOJ]QdO1G1dOBZQdO'#EuOJgQ`O7+%rOOQW7+%r7+%rOJoQ!bO1G/`OOQ[7+$y7+$yOJzQhO7+$yPKRQ`O'#EnOOQO,5;d,5;dOOQO-E8v-E8vOOQS1G0}1G0}OKWQ`OAN>WO&lQdO1G0uOK]Q`O7+'OOOQO,5;a,5;aOOQO-E8s-E8sOOQW<<I^<<I^OOQ[<<He<<HePOQW,5;Y,5;YOOQWG23rG23rOKeQdO7+&a",stateData:"Kx~O#sOS#tQQ~OW[OZ[O]TO`VOaVOi]OjWOmXO!jYO!mZO!saO!ybO!{cO!}dO#QeO#WfO#YgO#oRO~OQiOW[OZ[O]TO`VOaVOi]OjWOmXO!jYO!mZO!saO!ybO!{cO!}dO#QeO#WfO#YgO#ohO~O#m$SP~P!dO#tmO~O#ooO~O]qO`rOarOjsOmtO!juO!mwO#nvO~OpzO!^xO~P$SOc!QO#o|O#p}O~O#o!RO~O#o!TO~OW[OZ[O]TO`VOaVOjWOmXO!jYO!mZO#oRO~OS!]Oe!YO!V![O!Y!`O#q!XOp$TP~Ok$TP~P&POQ!jOe!cOm!dOp!eOr!mOt!mOz!kO!`!lO#o!bO#p!hO#}!fO~Ot!qO!`!lO#o!pO~Ot!sO#o!sO~OS!]Oe!YO!V![O!Y!`O#q!XO~Oe!vOpzO#Z!xO~O]YX`YX`!pXaYXjYXmYXpYX!^YX!jYX!mYX#nYX~O`!zO~Ok!{O#m$SXo$SX~O#m$SXo$SX~P!dO#u#OO#v#OO#w#QO~Oc#UO#o|O#p}O~OpzO!^xO~Oo$SP~P!dOe#`O~Oe#aO~Ol#bO!h#cO~O]qO`rOarOjsOmtO~Op!ia!^!ia!j!ia!m!ia#n!iad!ia~P*zOp!la!^!la!j!la!m!la#n!lad!la~P*zOR#gOS!]Oe!YOr#gOt#gO!V![O!Y!`O#q#dO#}!fO~O!R#iO!^#jOk$TXp$TX~Oe#mO~Ok#oOpzO~Oe!vO~O]#rO`#rOd#uOi#rOj#rOk#rO~P&lO]#rO`#rOi#rOj#rOk#rOl#wO~P&lO]#rO`#rOi#rOj#rOk#rOo#yO~P&lOP#zOSsXesXksXvsX!VsX!YsX!usX!wsX#qsX!TsXQsX]sX`sXdsXisXjsXmsXpsXrsXtsXzsX!`sX#osX#psX#}sXlsXosX!^sX!qsX#msX~Ov#{O!u#|O!w#}Ok$TP~P'tOe#aOS#{Xk#{Xv#{X!V#{X!Y#{X!u#{X!w#{X#q#{XQ#{X]#{X`#{Xd#{Xi#{Xj#{Xm#{Xp#{Xr#{Xt#{Xz#{X!`#{X#o#{X#p#{X#}#{Xl#{Xo#{X!^#{X!q#{X#m#{X~Oe$RO~Oe$TO~Ok$VOv#{O~Ok$WO~Ot$XO!`!lO~Op$YO~OpzO!R#iO~OpzO#Z$`O~O!q$bOk!oa#m!oao!oa~P&lOk#hX#m#hXo#hX~P!dOk!{O#m$Sao$Sa~O#u#OO#v#OO#w$hO~Ol$jO!h$kO~Op!ii!^!ii!j!ii!m!ii#n!iid!ii~P*zOp!ki!^!ki!j!ki!m!ki#n!kid!ki~P*zOp!li!^!li!j!li!m!li#n!lid!li~P*zOp#fa!^#fa~P$SOo$lO~Od$RP~P%_Od#zP~P&lO`!PXd}X!R}X!T!PX~O`$sO!T$tO~Od$uO!R#iO~Ok#jXp#jX!^#jX~P'tO!^#jOk$Tap$Ta~O!R#iOk!Uap!Ua!^!Uad!Ua`!Ua~OS!]Oe!YO!V![O!Y!`O#q$yO~Od$QP~P9dOv#{OQ#|X]#|X`#|Xd#|Xe#|Xi#|Xj#|Xk#|Xm#|Xp#|Xr#|Xt#|Xz#|X!`#|X#o#|X#p#|X#}#|Xl#|Xo#|X~O]#rO`#rOd%OOi#rOj#rOk#rO~P&lO]#rO`#rOi#rOj#rOk#rOl%PO~P&lO]#rO`#rOi#rOj#rOk#rOo%QO~P&lOe%SOS!tXk!tX!V!tX!Y!tX#q!tX~Ok%TO~Od%YOt%ZO!a%ZO~Ok%[O~Oo%cO#o%^O#}%]O~Od%dO~P$SOv#{O!^%hO!q%jOk!oi#m!oio!oi~P&lOk#ha#m#hao#ha~P!dOk!{O#m$Sio$Si~O!^%mOd$RX~P$SOd%oO~Ov#{OQ#`Xd#`Xe#`Xm#`Xp#`Xr#`Xt#`Xz#`X!^#`X!`#`X#o#`X#p#`X#}#`X~O!^%qOd#zX~P&lOd%sO~Ol%tOv#{O~OR#gOr#gOt#gO#q%vO#}!fO~O!R#iOk#jap#ja!^#ja~O`!PXd}X!R}X!^}X~O!R#iO!^%xOd$QX~O`%zO~Od%{O~O#o%|O~Ok&OO~O`&PO!R#iO~Od&ROk&QO~Od&UO~OP#zOpsX!^sXdsX~O#}%]Op#TX!^#TX~OpzO!^&WO~Oo&[O#o%^O#}%]O~Ov#{OQ#gXe#gXk#gXm#gXp#gXr#gXt#gXz#gX!^#gX!`#gX!q#gX#m#gX#o#gX#p#gX#}#gXo#gX~O!^%hO!q&`Ok!oq#m!oqo!oq~P&lOl&aOv#{O~Od#eX!^#eX~P%_O!^%mOd$Ra~Od#dX!^#dX~P&lO!^%qOd#za~Od&fO~P&lOd&gO!T&hO~Od#cX!^#cX~P9dO!^%xOd$Qa~O]&mOd&oO~OS#bae#ba!V#ba!Y#ba#q#ba~Od&qO~PG]Od&qOk&rO~Ov#{OQ#gae#gak#gam#gap#gar#gat#gaz#ga!^#ga!`#ga!q#ga#m#ga#o#ga#p#ga#}#gao#ga~Od#ea!^#ea~P$SOd#da!^#da~P&lOR#gOr#gOt#gO#q%vO#}%]O~O!R#iOd#ca!^#ca~O`&xO~O!^%xOd$Qi~P&lO]&mOd&|O~Ov#{Od|ik|i~Od&}O~PG]Ok'OO~Od'PO~O!^%xOd$Qq~Od#cq!^#cq~P&lO#s!a#t#}]#}v!m~",goto:"2h$UPPPPP$VP$YP$c$uP$cP%X$cPP%_PPP%e%o%oPPPPP%oPP%oP&]P%oP%o'W%oP't'w'}'}(^'}P'}P'}P'}'}P(m'}(yP(|PP)p)v$c)|$c*SP$cP$c$cP*Y*{+YP$YP+aP+dP$YP$YP$YP+j$YP+m+p+s+z$YP$YPP$YP,P,V,f,|-[-b-l-r-x.O.U.`.f.l.rPPPPPPPPPPP.x/R/w/z0|P1U1u2O2R2U2[RnQ_^OP`kz!{$dq[OPYZ`kuvwxz!v!{#`$d%mqSOPYZ`kuvwxz!v!{#`$d%mQpTR#RqQ!OVR#SrQ#S!QS$Q!i!jR$i#U!V!mac!c!d!e!z#a#c#t#v#x#{$a$k$p$s%h%i%q%u%z&P&d&l&x'Q!U!mac!c!d!e!z#a#c#t#v#x#{$a$k$p$s%h%i%q%u%z&P&d&l&x'QU#g!Y$t&hU%`$Y%b&WR&V%_!V!iac!c!d!e!z#a#c#t#v#x#{$a$k$p$s%h%i%q%u%z&P&d&l&x'QR$S!kQ%W$RR&S%Xk!^]bf!Y![!g#i#j#m$P$R%X%xQ#e!YQ${#mQ%w$tQ&j%xR&w&hQ!ygQ#p!`Q$^!xR%f$`R#n!]!U!mac!c!d!e!z#a#c#t#v#x#{$a$k$p$s%h%i%q%u%z&P&d&l&x'QQ!qdR$X!rQ!PVR#TrQ#S!PR$i#TQ!SWR#VsQ!UXR#WtQ{UQ!wgQ#^yQ#o!_Q$U!nQ$[!uQ$_!yQ%e$^Q&Y%aQ&]%fR&v&XSjPzQ!}kQ$c!{R%k$dZiPkz!{$dR$P!gQ%}%SR&z&mR!rdR!teR$Z!tS%a$Y%bR&t&WV%_$Y%b&WQ#PmR$g#PQ`OSkPzU!a`k$dR$d!{Q$p#aY%p$p%u&d&l'QQ%u$sQ&d%qQ&l%zR'Q&xQ#t!cQ#v!dQ#x!eV$}#t#v#xQ%X$RR&T%XQ%y$zS&k%y&yR&y&lQ%r$pR&e%rQ%n$mR&c%nQyUR#]yQ%i$aR&_%iQ!|jS$e!|$fR$f!}Q&n%}R&{&nQ#k!ZR$x#kQ%b$YR&Z%bQ&X%aR&u&X__OP`kz!{$d^UOP`kz!{$dQ!VYQ!WZQ#XuQ#YvQ#ZwQ#[xQ$]!vQ$m#`R&b%mR$q#aQ!gaQ!oc[#q!c!d!e#t#v#xQ$a!zd$o#a$p$s%q%u%z&d&l&x'QQ$r#cQ%R#{S%g$a%iQ%l$kQ&^%hR&p&P]#s!c!d!e#t#v#xW!Z]b!g$PQ!ufQ#f!YQ#l![Q$v#iQ$w#jQ$z#mS%V$R%XR&i%xQ#h!YQ%w$tR&w&hR$|#mR$n#`QlPR#_zQ!_]Q!nbQ$O!gR%U$P",nodeNames:"⚠ Unit VariableName VariableName QueryCallee Comment StyleSheet RuleSet UniversalSelector TagSelector TagName NestingSelector ClassSelector . ClassName PseudoClassSelector : :: PseudoClassName PseudoClassName ) ( ArgList ValueName ParenthesizedValue AtKeyword # ; ] [ BracketedValue } { BracedValue ColorLiteral NumberLiteral StringLiteral BinaryExpression BinOp CallExpression Callee IfExpression if ArgList IfBranch KeywordQuery FeatureQuery FeatureName BinaryQuery LogicOp ComparisonQuery CompareOp UnaryQuery UnaryQueryOp ParenthesizedQuery SelectorQuery selector ParenthesizedSelector CallQuery ArgList , CallLiteral CallTag ParenthesizedContent PseudoClassName ArgList IdSelector IdName AttributeSelector AttributeName MatchOp ChildSelector ChildOp DescendantSelector SiblingSelector SiblingOp Block Declaration PropertyName Important ImportStatement import Layer layer LayerName layer MediaStatement media CharsetStatement charset NamespaceStatement namespace NamespaceName KeyframesStatement keyframes KeyframeName KeyframeList KeyframeSelector KeyframeRangeName SupportsStatement supports ScopeStatement scope to AtRule Styles",maxTerm:143,nodeProps:[["isolate",-2,5,36,""],["openedBy",20,"(",28,"[",31,"{"],["closedBy",21,")",29,"]",32,"}"]],propSources:[lq],skippedNodes:[0,5,106],repeatNodeCount:15,tokenData:"JQ~R!YOX$qX^%i^p$qpq%iqr({rs-ust/itu6Wuv$qvw7Qwx7cxy9Qyz9cz{9h{|:R|}>t}!O?V!O!P?t!P!Q@]!Q![AU![!]BP!]!^B{!^!_C^!_!`DY!`!aDm!a!b$q!b!cEn!c!}$q!}#OG{#O#P$q#P#QH^#Q#R6W#R#o$q#o#pHo#p#q6W#q#rIQ#r#sIc#s#y$q#y#z%i#z$f$q$f$g%i$g#BY$q#BY#BZ%i#BZ$IS$q$IS$I_%i$I_$I|$q$I|$JO%i$JO$JT$q$JT$JU%i$JU$KV$q$KV$KW%i$KW&FU$q&FU&FV%i&FV;'S$q;'S;=`Iz<%lO$q`$tSOy%Qz;'S%Q;'S;=`%c<%lO%Q`%VS!a`Oy%Qz;'S%Q;'S;=`%c<%lO%Q`%fP;=`<%l%Q~%nh#s~OX%QX^'Y^p%Qpq'Yqy%Qz#y%Q#y#z'Y#z$f%Q$f$g'Y$g#BY%Q#BY#BZ'Y#BZ$IS%Q$IS$I_'Y$I_$I|%Q$I|$JO'Y$JO$JT%Q$JT$JU'Y$JU$KV%Q$KV$KW'Y$KW&FU%Q&FU&FV'Y&FV;'S%Q;'S;=`%c<%lO%Q~'ah#s~!a`OX%QX^'Y^p%Qpq'Yqy%Qz#y%Q#y#z'Y#z$f%Q$f$g'Y$g#BY%Q#BY#BZ'Y#BZ$IS%Q$IS$I_'Y$I_$I|%Q$I|$JO'Y$JO$JT%Q$JT$JU'Y$JU$KV%Q$KV$KW'Y$KW&FU%Q&FU&FV'Y&FV;'S%Q;'S;=`%c<%lO%Qj)OUOy%Qz#]%Q#]#^)b#^;'S%Q;'S;=`%c<%lO%Qj)gU!a`Oy%Qz#a%Q#a#b)y#b;'S%Q;'S;=`%c<%lO%Qj*OU!a`Oy%Qz#d%Q#d#e*b#e;'S%Q;'S;=`%c<%lO%Qj*gU!a`Oy%Qz#c%Q#c#d*y#d;'S%Q;'S;=`%c<%lO%Qj+OU!a`Oy%Qz#f%Q#f#g+b#g;'S%Q;'S;=`%c<%lO%Qj+gU!a`Oy%Qz#h%Q#h#i+y#i;'S%Q;'S;=`%c<%lO%Qj,OU!a`Oy%Qz#T%Q#T#U,b#U;'S%Q;'S;=`%c<%lO%Qj,gU!a`Oy%Qz#b%Q#b#c,y#c;'S%Q;'S;=`%c<%lO%Qj-OU!a`Oy%Qz#h%Q#h#i-b#i;'S%Q;'S;=`%c<%lO%Qj-iS!qY!a`Oy%Qz;'S%Q;'S;=`%c<%lO%Q~-xWOY-uZr-urs.bs#O-u#O#P.g#P;'S-u;'S;=`/c<%lO-u~.gOt~~.jRO;'S-u;'S;=`.s;=`O-u~.vXOY-uZr-urs.bs#O-u#O#P.g#P;'S-u;'S;=`/c;=`<%l-u<%lO-u~/fP;=`<%l-uj/nYjYOy%Qz!Q%Q!Q![0^![!c%Q!c!i0^!i#T%Q#T#Z0^#Z;'S%Q;'S;=`%c<%lO%Qj0cY!a`Oy%Qz!Q%Q!Q![1R![!c%Q!c!i1R!i#T%Q#T#Z1R#Z;'S%Q;'S;=`%c<%lO%Qj1WY!a`Oy%Qz!Q%Q!Q![1v![!c%Q!c!i1v!i#T%Q#T#Z1v#Z;'S%Q;'S;=`%c<%lO%Qj1}YrY!a`Oy%Qz!Q%Q!Q![2m![!c%Q!c!i2m!i#T%Q#T#Z2m#Z;'S%Q;'S;=`%c<%lO%Qj2tYrY!a`Oy%Qz!Q%Q!Q![3d![!c%Q!c!i3d!i#T%Q#T#Z3d#Z;'S%Q;'S;=`%c<%lO%Qj3iY!a`Oy%Qz!Q%Q!Q![4X![!c%Q!c!i4X!i#T%Q#T#Z4X#Z;'S%Q;'S;=`%c<%lO%Qj4`YrY!a`Oy%Qz!Q%Q!Q![5O![!c%Q!c!i5O!i#T%Q#T#Z5O#Z;'S%Q;'S;=`%c<%lO%Qj5TY!a`Oy%Qz!Q%Q!Q![5s![!c%Q!c!i5s!i#T%Q#T#Z5s#Z;'S%Q;'S;=`%c<%lO%Qj5zSrY!a`Oy%Qz;'S%Q;'S;=`%c<%lO%Qd6ZUOy%Qz!_%Q!_!`6m!`;'S%Q;'S;=`%c<%lO%Qd6tS!hS!a`Oy%Qz;'S%Q;'S;=`%c<%lO%Qb7VSZQOy%Qz;'S%Q;'S;=`%c<%lO%Q~7fWOY7cZw7cwx.bx#O7c#O#P8O#P;'S7c;'S;=`8z<%lO7c~8RRO;'S7c;'S;=`8[;=`O7c~8_XOY7cZw7cwx.bx#O7c#O#P8O#P;'S7c;'S;=`8z;=`<%l7c<%lO7c~8}P;=`<%l7cj9VSeYOy%Qz;'S%Q;'S;=`%c<%lO%Q~9hOd~n9oUWQvWOy%Qz!_%Q!_!`6m!`;'S%Q;'S;=`%c<%lO%Qj:YWvW!mQOy%Qz!O%Q!O!P:r!P!Q%Q!Q![=w![;'S%Q;'S;=`%c<%lO%Qj:wU!a`Oy%Qz!Q%Q!Q![;Z![;'S%Q;'S;=`%c<%lO%Qj;bY!a`#}YOy%Qz!Q%Q!Q![;Z![!g%Q!g!h<Q!h#X%Q#X#Y<Q#Y;'S%Q;'S;=`%c<%lO%Qj<VY!a`Oy%Qz{%Q{|<u|}%Q}!O<u!O!Q%Q!Q![=^![;'S%Q;'S;=`%c<%lO%Qj<zU!a`Oy%Qz!Q%Q!Q![=^![;'S%Q;'S;=`%c<%lO%Qj=eU!a`#}YOy%Qz!Q%Q!Q![=^![;'S%Q;'S;=`%c<%lO%Qj>O[!a`#}YOy%Qz!O%Q!O!P;Z!P!Q%Q!Q![=w![!g%Q!g!h<Q!h#X%Q#X#Y<Q#Y;'S%Q;'S;=`%c<%lO%Qj>yS!^YOy%Qz;'S%Q;'S;=`%c<%lO%Qj?[WvWOy%Qz!O%Q!O!P:r!P!Q%Q!Q![=w![;'S%Q;'S;=`%c<%lO%Qj?yU]YOy%Qz!Q%Q!Q![;Z![;'S%Q;'S;=`%c<%lO%Q~@bTvWOy%Qz{@q{;'S%Q;'S;=`%c<%lO%Q~@xS!a`#t~Oy%Qz;'S%Q;'S;=`%c<%lO%QjAZ[#}YOy%Qz!O%Q!O!P;Z!P!Q%Q!Q![=w![!g%Q!g!h<Q!h#X%Q#X#Y<Q#Y;'S%Q;'S;=`%c<%lO%QjBUU`YOy%Qz![%Q![!]Bh!];'S%Q;'S;=`%c<%lO%QbBoSaQ!a`Oy%Qz;'S%Q;'S;=`%c<%lO%QjCQSkYOy%Qz;'S%Q;'S;=`%c<%lO%QhCcU!TWOy%Qz!_%Q!_!`Cu!`;'S%Q;'S;=`%c<%lO%QhC|S!TW!a`Oy%Qz;'S%Q;'S;=`%c<%lO%QlDaS!TW!hSOy%Qz;'S%Q;'S;=`%c<%lO%QjDtV!jQ!TWOy%Qz!_%Q!_!`Cu!`!aEZ!a;'S%Q;'S;=`%c<%lO%QbEbS!jQ!a`Oy%Qz;'S%Q;'S;=`%c<%lO%QjEqYOy%Qz}%Q}!OFa!O!c%Q!c!}GO!}#T%Q#T#oGO#o;'S%Q;'S;=`%c<%lO%QjFfW!a`Oy%Qz!c%Q!c!}GO!}#T%Q#T#oGO#o;'S%Q;'S;=`%c<%lO%QjGV[iY!a`Oy%Qz}%Q}!OGO!O!Q%Q!Q![GO![!c%Q!c!}GO!}#T%Q#T#oGO#o;'S%Q;'S;=`%c<%lO%QjHQSmYOy%Qz;'S%Q;'S;=`%c<%lO%QnHcSl^Oy%Qz;'S%Q;'S;=`%c<%lO%QjHtSpYOy%Qz;'S%Q;'S;=`%c<%lO%QjIVSoYOy%Qz;'S%Q;'S;=`%c<%lO%QfIhU!mQOy%Qz!_%Q!_!`6m!`;'S%Q;'S;=`%c<%lO%Q`I}P;=`<%l$q",tokenizers:[aq,oq,sq,nq,1,2,3,4,new Ph("m~RRYZ[z{a~~g~aO#v~~dP!P!Qg~lO#w~~",28,129)],topRules:{StyleSheet:[0,6],Styles:[1,105]},specialized:[{term:124,get:r=>uq[r]||-1},{term:125,get:r=>cq[r]||-1},{term:4,get:r=>hq[r]||-1},{term:25,get:r=>dq[r]||-1},{term:123,get:r=>fq[r]||-1}],tokenPrec:1963});let Jf=null;function ep(){if(!Jf&&typeof document=="object"&&document.body){let{style:r}=document.body,e=[],t=new Set;for(let i in r)i!="cssText"&&i!="cssFloat"&&typeof r[i]=="string"&&(/[A-Z]/.test(i)&&(i=i.replace(/[A-Z]/g,s=>"-"+s.toLowerCase())),t.has(i)||(e.push(i),t.add(i)));Jf=e.sort().map(i=>({type:"property",label:i,apply:i+": "}))}return Jf||[]}const ZS=["active","after","any-link","autofill","backdrop","before","checked","cue","default","defined","disabled","empty","enabled","file-selector-button","first","first-child","first-letter","first-line","first-of-type","focus","focus-visible","focus-within","fullscreen","has","host","host-context","hover","in-range","indeterminate","invalid","is","lang","last-child","last-of-type","left","link","marker","modal","not","nth-child","nth-last-child","nth-last-of-type","nth-of-type","only-child","only-of-type","optional","out-of-range","part","placeholder","placeholder-shown","read-only","read-write","required","right","root","scope","selection","slotted","target","target-text","valid","visited","where"].map(r=>({type:"class",label:r})),WS=["above","absolute","activeborder","additive","activecaption","after-white-space","ahead","alias","all","all-scroll","alphabetic","alternate","always","antialiased","appworkspace","asterisks","attr","auto","auto-flow","avoid","avoid-column","avoid-page","avoid-region","axis-pan","background","backwards","baseline","below","bidi-override","blink","block","block-axis","bold","bolder","border","border-box","both","bottom","break","break-all","break-word","bullets","button","button-bevel","buttonface","buttonhighlight","buttonshadow","buttontext","calc","capitalize","caps-lock-indicator","caption","captiontext","caret","cell","center","checkbox","circle","cjk-decimal","clear","clip","close-quote","col-resize","collapse","color","color-burn","color-dodge","column","column-reverse","compact","condensed","contain","content","contents","content-box","context-menu","continuous","copy","counter","counters","cover","crop","cross","crosshair","currentcolor","cursive","cyclic","darken","dashed","decimal","decimal-leading-zero","default","default-button","dense","destination-atop","destination-in","destination-out","destination-over","difference","disc","discard","disclosure-closed","disclosure-open","document","dot-dash","dot-dot-dash","dotted","double","down","e-resize","ease","ease-in","ease-in-out","ease-out","element","ellipse","ellipsis","embed","end","ethiopic-abegede-gez","ethiopic-halehame-aa-er","ethiopic-halehame-gez","ew-resize","exclusion","expanded","extends","extra-condensed","extra-expanded","fantasy","fast","fill","fill-box","fixed","flat","flex","flex-end","flex-start","footnotes","forwards","from","geometricPrecision","graytext","grid","groove","hand","hard-light","help","hidden","hide","higher","highlight","highlighttext","horizontal","hsl","hsla","hue","icon","ignore","inactiveborder","inactivecaption","inactivecaptiontext","infinite","infobackground","infotext","inherit","initial","inline","inline-axis","inline-block","inline-flex","inline-grid","inline-table","inset","inside","intrinsic","invert","italic","justify","keep-all","landscape","large","larger","left","level","lighter","lighten","line-through","linear","linear-gradient","lines","list-item","listbox","listitem","local","logical","loud","lower","lower-hexadecimal","lower-latin","lower-norwegian","lowercase","ltr","luminosity","manipulation","match","matrix","matrix3d","medium","menu","menutext","message-box","middle","min-intrinsic","mix","monospace","move","multiple","multiple_mask_images","multiply","n-resize","narrower","ne-resize","nesw-resize","no-close-quote","no-drop","no-open-quote","no-repeat","none","normal","not-allowed","nowrap","ns-resize","numbers","numeric","nw-resize","nwse-resize","oblique","opacity","open-quote","optimizeLegibility","optimizeSpeed","outset","outside","outside-shape","overlay","overline","padding","padding-box","painted","page","paused","perspective","pinch-zoom","plus-darker","plus-lighter","pointer","polygon","portrait","pre","pre-line","pre-wrap","preserve-3d","progress","push-button","radial-gradient","radio","read-only","read-write","read-write-plaintext-only","rectangle","region","relative","repeat","repeating-linear-gradient","repeating-radial-gradient","repeat-x","repeat-y","reset","reverse","rgb","rgba","ridge","right","rotate","rotate3d","rotateX","rotateY","rotateZ","round","row","row-resize","row-reverse","rtl","run-in","running","s-resize","sans-serif","saturation","scale","scale3d","scaleX","scaleY","scaleZ","screen","scroll","scrollbar","scroll-position","se-resize","self-start","self-end","semi-condensed","semi-expanded","separate","serif","show","single","skew","skewX","skewY","skip-white-space","slide","slider-horizontal","slider-vertical","sliderthumb-horizontal","sliderthumb-vertical","slow","small","small-caps","small-caption","smaller","soft-light","solid","source-atop","source-in","source-out","source-over","space","space-around","space-between","space-evenly","spell-out","square","start","static","status-bar","stretch","stroke","stroke-box","sub","subpixel-antialiased","svg_masks","super","sw-resize","symbolic","symbols","system-ui","table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row","table-row-group","text","text-bottom","text-top","textarea","textfield","thick","thin","threeddarkshadow","threedface","threedhighlight","threedlightshadow","threedshadow","to","top","transform","translate","translate3d","translateX","translateY","translateZ","transparent","ultra-condensed","ultra-expanded","underline","unidirectional-pan","unset","up","upper-latin","uppercase","url","var","vertical","vertical-text","view-box","visible","visibleFill","visiblePainted","visibleStroke","visual","w-resize","wait","wave","wider","window","windowframe","windowtext","words","wrap","wrap-reverse","x-large","x-small","xor","xx-large","xx-small"].map(r=>({type:"keyword",label:r})).concat(["aliceblue","antiquewhite","aqua","aquamarine","azure","beige","bisque","black","blanchedalmond","blue","blueviolet","brown","burlywood","cadetblue","chartreuse","chocolate","coral","cornflowerblue","cornsilk","crimson","cyan","darkblue","darkcyan","darkgoldenrod","darkgray","darkgreen","darkkhaki","darkmagenta","darkolivegreen","darkorange","darkorchid","darkred","darksalmon","darkseagreen","darkslateblue","darkslategray","darkturquoise","darkviolet","deeppink","deepskyblue","dimgray","dodgerblue","firebrick","floralwhite","forestgreen","fuchsia","gainsboro","ghostwhite","gold","goldenrod","gray","grey","green","greenyellow","honeydew","hotpink","indianred","indigo","ivory","khaki","lavender","lavenderblush","lawngreen","lemonchiffon","lightblue","lightcoral","lightcyan","lightgoldenrodyellow","lightgray","lightgreen","lightpink","lightsalmon","lightseagreen","lightskyblue","lightslategray","lightsteelblue","lightyellow","lime","limegreen","linen","magenta","maroon","mediumaquamarine","mediumblue","mediumorchid","mediumpurple","mediumseagreen","mediumslateblue","mediumspringgreen","mediumturquoise","mediumvioletred","midnightblue","mintcream","mistyrose","moccasin","navajowhite","navy","oldlace","olive","olivedrab","orange","orangered","orchid","palegoldenrod","palegreen","paleturquoise","palevioletred","papayawhip","peachpuff","peru","pink","plum","powderblue","purple","rebeccapurple","red","rosybrown","royalblue","saddlebrown","salmon","sandybrown","seagreen","seashell","sienna","silver","skyblue","slateblue","slategray","snow","springgreen","steelblue","tan","teal","thistle","tomato","turquoise","violet","wheat","white","whitesmoke","yellow","yellowgreen"].map(r=>({type:"constant",label:r}))),mq=["a","abbr","address","article","aside","b","bdi","bdo","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","dd","del","details","dfn","dialog","div","dl","dt","em","figcaption","figure","footer","form","header","hgroup","h1","h2","h3","h4","h5","h6","hr","html","i","iframe","img","input","ins","kbd","label","legend","li","main","meter","nav","ol","output","p","pre","ruby","section","select","small","source","span","strong","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","tr","u","ul"].map(r=>({type:"type",label:r})),gq=["@charset","@color-profile","@container","@counter-style","@font-face","@font-feature-values","@font-palette-values","@import","@keyframes","@layer","@media","@namespace","@page","@position-try","@property","@scope","@starting-style","@supports","@view-transition"].map(r=>({type:"keyword",label:r})),us=/^(\w[\w-]*|-\w[\w-]*|)$/,Oq=/^-(-[\w-]*)?$/;function yq(r,e){var t;if((r.name=="("||r.type.isError)&&(r=r.parent||r),r.name!="ArgList")return!1;let i=(t=r.parent)===null||t===void 0?void 0:t.firstChild;return i?.name!="Callee"?!1:e.sliceString(i.from,i.to)=="var"}const HS=new g2,bq=["Declaration"];function vq(r){for(let e=r;;){if(e.type.isTop)return e;if(!(e=e.parent))return r}}function _k(r,e,t){if(e.to-e.from>4096){let i=HS.get(e);if(i)return i;let s=[],n=new Set,a=e.cursor(lt.IncludeAnonymous);if(a.firstChild())do for(let o of _k(r,a.node,t))n.has(o.label)||(n.add(o.label),s.push(o));while(a.nextSibling());return HS.set(e,s),s}else{let i=[],s=new Set;return e.cursor().iterate(n=>{var a;if(t(n)&&n.matchContext(bq)&&((a=n.node.nextSibling)===null||a===void 0?void 0:a.name)==":"){let o=r.sliceString(n.from,n.to);s.has(o)||(s.add(o),i.push({label:o,type:"variable"}))}}),i}}const Sq=r=>e=>{let{state:t,pos:i}=e,s=nt(t).resolveInner(i,-1),n=s.type.isError&&s.from==s.to-1&&t.doc.sliceString(s.from,s.to)=="-";if(s.name=="PropertyName"||(n||s.name=="TagName")&&/^(Block|Styles)$/.test(s.resolve(s.to).name))return{from:s.from,options:ep(),validFor:us};if(s.name=="ValueName")return{from:s.from,options:WS,validFor:us};if(s.name=="PseudoClassName")return{from:s.from,options:ZS,validFor:us};if(r(s)||(e.explicit||n)&&yq(s,t.doc))return{from:r(s)||n?s.from:i,options:_k(t.doc,vq(s),r),validFor:Oq};if(s.name=="TagName"){for(let{parent:l}=s;l;l=l.parent)if(l.name=="Block")return{from:s.from,options:ep(),validFor:us};return{from:s.from,options:mq,validFor:us}}if(s.name=="AtKeyword")return{from:s.from,options:gq,validFor:us};if(!e.explicit)return null;let a=s.resolve(i),o=a.childBefore(i);return o&&o.name==":"&&a.name=="PseudoClassSelector"?{from:i,options:ZS,validFor:us}:o&&o.name==":"&&a.name=="Declaration"||a.name=="ArgList"?{from:i,options:WS,validFor:us}:a.name=="Block"||a.name=="Styles"?{from:i,options:ep(),validFor:us}:null},Tq=Sq(r=>r.name=="VariableName"),Mh=Fa.define({name:"css",parser:pq.configure({props:[nu.add({Declaration:kc()}),ro.add({"Block KeyframeList":x2})]}),languageData:{commentTokens:{block:{open:"/*",close:"*/"}},indentOnInput:/^\s*\}$/,wordChars:"-"}});function _q(){return new Pl(Mh,Mh.data.of({autocomplete:Tq}))}const xq=316,wq=317,YS=1,Cq=2,kq=3,Eq=4,Aq=318,Pq=320,Dq=321,Mq=5,Iq=6,Rq=0,Vm=[9,10,11,12,13,32,133,160,5760,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8232,8233,8239,8287,12288],xk=125,Lq=59,Xm=47,Qq=42,$q=43,Bq=45,Nq=60,Fq=44,Uq=63,qq=46,Vq=91,Xq=new lk({start:!1,shift(r,e){return e==Mq||e==Iq||e==Pq?r:e==Dq},strict:!1}),jq=new Vi((r,e)=>{let{next:t}=r;(t==xk||t==-1||e.context)&&r.acceptToken(Aq)},{contextual:!0,fallback:!0}),zq=new Vi((r,e)=>{let{next:t}=r,i;Vm.indexOf(t)>-1||t==Xm&&((i=r.peek(1))==Xm||i==Qq)||t!=xk&&t!=Lq&&t!=-1&&!e.context&&r.acceptToken(xq)},{contextual:!0}),Zq=new Vi((r,e)=>{r.next==Vq&&!e.context&&r.acceptToken(wq)},{contextual:!0}),Wq=new Vi((r,e)=>{let{next:t}=r;if(t==$q||t==Bq){if(r.advance(),t==r.next){r.advance();let i=!e.context&&e.canShift(YS);r.acceptToken(i?YS:Cq)}}else t==Uq&&r.peek(1)==qq&&(r.advance(),r.advance(),(r.next<48||r.next>57)&&r.acceptToken(kq))},{contextual:!0});function tp(r,e){return r>=65&&r<=90||r>=97&&r<=122||r==95||r>=192||!e&&r>=48&&r<=57}const Hq=new Vi((r,e)=>{if(r.next!=Nq||!e.dialectEnabled(Rq)||(r.advance(),r.next==Xm))return;let t=0;for(;Vm.indexOf(r.next)>-1;)r.advance(),t++;if(tp(r.next,!0)){for(r.advance(),t++;tp(r.next,!1);)r.advance(),t++;for(;Vm.indexOf(r.next)>-1;)r.advance(),t++;if(r.next==Fq)return;for(let i=0;;i++){if(i==7){if(!tp(r.next,!0))return;break}if(r.next!="extends".charCodeAt(i))break;r.advance(),t++}}r.acceptToken(Eq,-t)}),Yq=io({"get set async static":V.modifier,"for while do if else switch try catch finally return throw break continue default case defer":V.controlKeyword,"in of await yield void typeof delete instanceof as satisfies":V.operatorKeyword,"let var const using function class extends":V.definitionKeyword,"import export from":V.moduleKeyword,"with debugger new":V.keyword,TemplateString:V.special(V.string),super:V.atom,BooleanLiteral:V.bool,this:V.self,null:V.null,Star:V.modifier,VariableName:V.variableName,"CallExpression/VariableName TaggedTemplateExpression/VariableName":V.function(V.variableName),VariableDefinition:V.definition(V.variableName),Label:V.labelName,PropertyName:V.propertyName,PrivatePropertyName:V.special(V.propertyName),"CallExpression/MemberExpression/PropertyName":V.function(V.propertyName),"FunctionDeclaration/VariableDefinition":V.function(V.definition(V.variableName)),"ClassDeclaration/VariableDefinition":V.definition(V.className),"NewExpression/VariableName":V.className,PropertyDefinition:V.definition(V.propertyName),PrivatePropertyDefinition:V.definition(V.special(V.propertyName)),UpdateOp:V.updateOperator,"LineComment Hashbang":V.lineComment,BlockComment:V.blockComment,Number:V.number,String:V.string,Escape:V.escape,ArithOp:V.arithmeticOperator,LogicOp:V.logicOperator,BitOp:V.bitwiseOperator,CompareOp:V.compareOperator,RegExp:V.regexp,Equals:V.definitionOperator,Arrow:V.function(V.punctuation),": Spread":V.punctuation,"( )":V.paren,"[ ]":V.squareBracket,"{ }":V.brace,"InterpolationStart InterpolationEnd":V.special(V.brace),".":V.derefOperator,", ;":V.separator,"@":V.meta,TypeName:V.typeName,TypeDefinition:V.definition(V.typeName),"type enum interface implements namespace module declare":V.definitionKeyword,"abstract global Privacy readonly override":V.modifier,"is keyof unique infer asserts":V.operatorKeyword,JSXAttributeValue:V.attributeValue,JSXText:V.content,"JSXStartTag JSXStartCloseTag JSXSelfCloseEndTag JSXEndTag":V.angleBracket,"JSXIdentifier JSXNameSpacedName":V.tagName,"JSXAttribute/JSXIdentifier JSXAttribute/JSXNameSpacedName":V.attributeName,"JSXBuiltin/JSXIdentifier":V.standard(V.tagName)}),Gq={__proto__:null,export:20,as:25,from:33,default:36,async:41,function:42,in:52,out:55,const:56,extends:60,this:64,true:72,false:72,null:84,void:88,typeof:92,super:108,new:142,delete:154,yield:163,await:167,class:172,public:235,private:235,protected:235,readonly:237,instanceof:256,satisfies:259,import:292,keyof:349,unique:353,infer:359,asserts:395,is:397,abstract:417,implements:419,type:421,let:424,var:426,using:429,interface:435,enum:439,namespace:445,module:447,declare:451,global:455,defer:471,for:476,of:485,while:488,with:492,do:496,if:500,else:502,switch:506,case:512,try:518,catch:522,finally:526,return:530,throw:534,break:538,continue:542,debugger:546},Kq={__proto__:null,async:129,get:131,set:133,declare:195,public:197,private:197,protected:197,static:199,abstract:201,override:203,readonly:209,accessor:211,new:401},Jq={__proto__:null,"<":193},e9=ja.deserialize({version:14,states:"$F|Q%TQlOOO%[QlOOO'_QpOOP(lO`OOO*zQ!0MxO'#CiO+RO#tO'#CjO+aO&jO'#CjO+oO#@ItO'#DaO.QQlO'#DgO.bQlO'#DrO%[QlO'#DzO0fQlO'#ESOOQ!0Lf'#E['#E[O1PQ`O'#EXOOQO'#Ep'#EpOOQO'#Il'#IlO1XQ`O'#GsO1dQ`O'#EoO1iQ`O'#EoO3hQ!0MxO'#JrO6[Q!0MxO'#JsO6uQ`O'#F]O6zQ,UO'#FtOOQ!0Lf'#Ff'#FfO7VO7dO'#FfO9XQMhO'#F|O9`Q`O'#F{OOQ!0Lf'#Js'#JsOOQ!0Lb'#Jr'#JrO9eQ`O'#GwOOQ['#K_'#K_O9pQ`O'#IYO9uQ!0LrO'#IZOOQ['#J`'#J`OOQ['#I_'#I_Q`QlOOQ`QlOOO9}Q!L^O'#DvO:UQlO'#EOO:]QlO'#EQO9kQ`O'#GsO:dQMhO'#CoO:rQ`O'#EnO:}Q`O'#EyO;hQMhO'#FeO;xQ`O'#GsOOQO'#K`'#K`O;}Q`O'#K`O<]Q`O'#G{O<]Q`O'#G|O<]Q`O'#HOO9kQ`O'#HRO=SQ`O'#HUO>kQ`O'#CeO>{Q`O'#HcO?TQ`O'#HiO?TQ`O'#HkO`QlO'#HmO?TQ`O'#HoO?TQ`O'#HrO?YQ`O'#HxO?_Q!0LsO'#IOO%[QlO'#IQO?jQ!0LsO'#ISO?uQ!0LsO'#IUO9uQ!0LrO'#IWO@QQ!0MxO'#CiOASQpO'#DlQOQ`OOO%[QlO'#EQOAjQ`O'#ETO:dQMhO'#EnOAuQ`O'#EnOBQQ!bO'#FeOOQ['#Cg'#CgOOQ!0Lb'#Dq'#DqOOQ!0Lb'#Jv'#JvO%[QlO'#JvOOQO'#Jy'#JyOOQO'#Ih'#IhOCQQpO'#EgOOQ!0Lb'#Ef'#EfOOQ!0Lb'#J}'#J}OC|Q!0MSO'#EgODWQpO'#EWOOQO'#Jx'#JxODlQpO'#JyOEyQpO'#EWODWQpO'#EgPFWO&2DjO'#CbPOOO)CD})CD}OOOO'#I`'#I`OFcO#tO,59UOOQ!0Lh,59U,59UOOOO'#Ia'#IaOFqO&jO,59UOGPQ!L^O'#DcOOOO'#Ic'#IcOGWO#@ItO,59{OOQ!0Lf,59{,59{OGfQlO'#IdOGyQ`O'#JtOIxQ!fO'#JtO+}QlO'#JtOJPQ`O,5:ROJgQ`O'#EpOJtQ`O'#KTOKPQ`O'#KSOKPQ`O'#KSOKXQ`O,5;^OK^Q`O'#KROOQ!0Ln,5:^,5:^OKeQlO,5:^OMcQ!0MxO,5:fONSQ`O,5:nONmQ!0LrO'#KQONtQ`O'#KPO9eQ`O'#KPO! YQ`O'#KPO! bQ`O,5;]O! gQ`O'#KPO!#lQ!fO'#JsOOQ!0Lh'#Ci'#CiO%[QlO'#ESO!$[Q!fO,5:sOOQS'#Jz'#JzOOQO-E<j-E<jO9kQ`O,5=_O!$rQ`O,5=_O!$wQlO,5;ZO!&zQMhO'#EkO!(eQ`O,5;ZO!(jQlO'#DyO!(tQpO,5;dO!(|QpO,5;dO%[QlO,5;dOOQ['#FT'#FTOOQ['#FV'#FVO%[QlO,5;eO%[QlO,5;eO%[QlO,5;eO%[QlO,5;eO%[QlO,5;eO%[QlO,5;eO%[QlO,5;eO%[QlO,5;eO%[QlO,5;eO%[QlO,5;eOOQ['#FZ'#FZO!)[QlO,5;tOOQ!0Lf,5;y,5;yOOQ!0Lf,5;z,5;zOOQ!0Lf,5;|,5;|O%[QlO'#IpO!+_Q!0LrO,5<iO%[QlO,5;eO!&zQMhO,5;eO!+|QMhO,5;eO!-nQMhO'#E^O%[QlO,5;wOOQ!0Lf,5;{,5;{O!-uQ,UO'#FjO!.rQ,UO'#KXO!.^Q,UO'#KXO!.yQ,UO'#KXOOQO'#KX'#KXO!/_Q,UO,5<SOOOW,5<`,5<`O!/pQlO'#FvOOOW'#Io'#IoO7VO7dO,5<QO!/wQ,UO'#FxOOQ!0Lf,5<Q,5<QO!0hQ$IUO'#CyOOQ!0Lh'#C}'#C}O!0{O#@ItO'#DRO!1iQMjO,5<eO!1pQ`O,5<hO!3YQ(CWO'#GXO!3jQ`O'#GYO!3oQ`O'#GYO!5_Q(CWO'#G^O!6dQpO'#GbOOQO'#Gn'#GnO!,TQMhO'#GmOOQO'#Gp'#GpO!,TQMhO'#GoO!7VQ$IUO'#JlOOQ!0Lh'#Jl'#JlO!7aQ`O'#JkO!7oQ`O'#JjO!7wQ`O'#CuOOQ!0Lh'#C{'#C{O!8YQ`O'#C}OOQ!0Lh'#DV'#DVOOQ!0Lh'#DX'#DXO!8_Q`O,5<eO1SQ`O'#DZO!,TQMhO'#GPO!,TQMhO'#GRO!8gQ`O'#GTO!8lQ`O'#GUO!3oQ`O'#G[O!,TQMhO'#GaO<]Q`O'#JkO!8qQ`O'#EqO!9`Q`O,5<gOOQ!0Lb'#Cr'#CrO!9hQ`O'#ErO!:bQpO'#EsOOQ!0Lb'#KR'#KRO!:iQ!0LrO'#KaO9uQ!0LrO,5=cO`QlO,5>tOOQ['#Jh'#JhOOQ[,5>u,5>uOOQ[-E<]-E<]O!<hQ!0MxO,5:bO!:]QpO,5:`O!?RQ!0MxO,5:jO%[QlO,5:jO!AiQ!0MxO,5:lOOQO,5@z,5@zO!BYQMhO,5=_O!BhQ!0LrO'#JiO9`Q`O'#JiO!ByQ!0LrO,59ZO!CUQpO,59ZO!C^QMhO,59ZO:dQMhO,59ZO!CiQ`O,5;ZO!CqQ`O'#HbO!DVQ`O'#KdO%[QlO,5;}O!:]QpO,5<PO!D_Q`O,5=zO!DdQ`O,5=zO!DiQ`O,5=zO!DwQ`O,5=zO9uQ!0LrO,5=zO<]Q`O,5=jOOQO'#Cy'#CyO!EOQpO,5=gO!EWQMhO,5=hO!EcQ`O,5=jO!EhQ!bO,5=mO!EpQ`O'#K`O?YQ`O'#HWO9kQ`O'#HYO!EuQ`O'#HYO:dQMhO'#H[O!EzQ`O'#H[OOQ[,5=p,5=pO!FPQ`O'#H]O!FbQ`O'#CoO!FgQ`O,59PO!FqQ`O,59PO!HvQlO,59POOQ[,59P,59PO!IWQ!0LrO,59PO%[QlO,59PO!KcQlO'#HeOOQ['#Hf'#HfOOQ['#Hg'#HgO`QlO,5=}O!KyQ`O,5=}O`QlO,5>TO`QlO,5>VO!LOQ`O,5>XO`QlO,5>ZO!LTQ`O,5>^O!LYQlO,5>dOOQ[,5>j,5>jO%[QlO,5>jO9uQ!0LrO,5>lOOQ[,5>n,5>nO#!dQ`O,5>nOOQ[,5>p,5>pO#!dQ`O,5>pOOQ[,5>r,5>rO##QQpO'#D_O%[QlO'#JvO##sQpO'#JvO##}QpO'#DmO#$`QpO'#DmO#&qQlO'#DmO#&xQ`O'#JuO#'QQ`O,5:WO#'VQ`O'#EtO#'eQ`O'#KUO#'mQ`O,5;_O#'rQpO'#DmO#(PQpO'#EVOOQ!0Lf,5:o,5:oO%[QlO,5:oO#(WQ`O,5:oO?YQ`O,5;YO!CUQpO,5;YO!C^QMhO,5;YO:dQMhO,5;YO#(`Q`O,5@bO#(eQ07dO,5:sOOQO-E<f-E<fO#)kQ!0MSO,5;RODWQpO,5:rO#)uQpO,5:rODWQpO,5;RO!ByQ!0LrO,5:rOOQ!0Lb'#Ej'#EjOOQO,5;R,5;RO%[QlO,5;RO#*SQ!0LrO,5;RO#*_Q!0LrO,5;RO!CUQpO,5:rOOQO,5;X,5;XO#*mQ!0LrO,5;RPOOO'#I^'#I^P#+RO&2DjO,58|POOO,58|,58|OOOO-E<^-E<^OOQ!0Lh1G.p1G.pOOOO-E<_-E<_OOOO,59},59}O#+^Q!bO,59}OOOO-E<a-E<aOOQ!0Lf1G/g1G/gO#+cQ!fO,5?OO+}QlO,5?OOOQO,5?U,5?UO#+mQlO'#IdOOQO-E<b-E<bO#+zQ`O,5@`O#,SQ!fO,5@`O#,ZQ`O,5@nOOQ!0Lf1G/m1G/mO%[QlO,5@oO#,cQ`O'#IjOOQO-E<h-E<hO#,ZQ`O,5@nOOQ!0Lb1G0x1G0xOOQ!0Ln1G/x1G/xOOQ!0Ln1G0Y1G0YO%[QlO,5@lO#,wQ!0LrO,5@lO#-YQ!0LrO,5@lO#-aQ`O,5@kO9eQ`O,5@kO#-iQ`O,5@kO#-wQ`O'#ImO#-aQ`O,5@kOOQ!0Lb1G0w1G0wO!(tQpO,5:uO!)PQpO,5:uOOQS,5:w,5:wO#.iQdO,5:wO#.qQMhO1G2yO9kQ`O1G2yOOQ!0Lf1G0u1G0uO#/PQ!0MxO1G0uO#0UQ!0MvO,5;VOOQ!0Lh'#GW'#GWO#0rQ!0MzO'#JlO!$wQlO1G0uO#2}Q!fO'#JwO%[QlO'#JwO#3XQ`O,5:eOOQ!0Lh'#D_'#D_OOQ!0Lf1G1O1G1OO%[QlO1G1OOOQ!0Lf1G1f1G1fO#3^Q`O1G1OO#5rQ!0MxO1G1PO#5yQ!0MxO1G1PO#8aQ!0MxO1G1PO#8hQ!0MxO1G1PO#;OQ!0MxO1G1PO#=fQ!0MxO1G1PO#=mQ!0MxO1G1PO#=tQ!0MxO1G1PO#@[Q!0MxO1G1PO#@cQ!0MxO1G1PO#BpQ?MtO'#CiO#DkQ?MtO1G1`O#DrQ?MtO'#JsO#EVQ!0MxO,5?[OOQ!0Lb-E<n-E<nO#GdQ!0MxO1G1PO#HaQ!0MzO1G1POOQ!0Lf1G1P1G1PO#IdQMjO'#J|O#InQ`O,5:xO#IsQ!0MxO1G1cO#JgQ,UO,5<WO#JoQ,UO,5<XO#JwQ,UO'#FoO#K`Q`O'#FnOOQO'#KY'#KYOOQO'#In'#InO#KeQ,UO1G1nOOQ!0Lf1G1n1G1nOOOW1G1y1G1yO#KvQ?MtO'#JrO#LQQ`O,5<bO!)[QlO,5<bOOOW-E<m-E<mOOQ!0Lf1G1l1G1lO#LVQpO'#KXOOQ!0Lf,5<d,5<dO#L_QpO,5<dO#LdQMhO'#DTOOOO'#Ib'#IbO#LkO#@ItO,59mOOQ!0Lh,59m,59mO%[QlO1G2PO!8lQ`O'#IrO#LvQ`O,5<zOOQ!0Lh,5<w,5<wO!,TQMhO'#IuO#MdQMjO,5=XO!,TQMhO'#IwO#NVQMjO,5=ZO!&zQMhO,5=]OOQO1G2S1G2SO#NaQ!dO'#CrO#NtQ(CWO'#ErO$ |QpO'#GbO$!dQ!dO,5<sO$!kQ`O'#K[O9eQ`O'#K[O$!yQ`O,5<uO$#aQ!dO'#C{O!,TQMhO,5<tO$#kQ`O'#GZO$$PQ`O,5<tO$$UQ!dO'#GWO$$cQ!dO'#K]O$$mQ`O'#K]O!&zQMhO'#K]O$$rQ`O,5<xO$$wQlO'#JvO$%RQpO'#GcO#$`QpO'#GcO$%dQ`O'#GgO!3oQ`O'#GkO$%iQ!0LrO'#ItO$%tQpO,5<|OOQ!0Lp,5<|,5<|O$%{QpO'#GcO$&YQpO'#GdO$&kQpO'#GdO$&pQMjO,5=XO$'QQMjO,5=ZOOQ!0Lh,5=^,5=^O!,TQMhO,5@VO!,TQMhO,5@VO$'bQ`O'#IyO$'vQ`O,5@UO$(OQ`O,59aOOQ!0Lh,59i,59iO$(TQ`O,5@VO$)TQ$IYO,59uOOQ!0Lh'#Jp'#JpO$)vQMjO,5<kO$*iQMjO,5<mO@zQ`O,5<oOOQ!0Lh,5<p,5<pO$*sQ`O,5<vO$*xQMjO,5<{O$+YQ`O'#KPO!$wQlO1G2RO$+_Q`O1G2RO9eQ`O'#KSO9eQ`O'#EtO%[QlO'#EtO9eQ`O'#I{O$+dQ!0LrO,5@{OOQ[1G2}1G2}OOQ[1G4`1G4`OOQ!0Lf1G/|1G/|OOQ!0Lf1G/z1G/zO$-fQ!0MxO1G0UOOQ[1G2y1G2yO!&zQMhO1G2yO%[QlO1G2yO#.tQ`O1G2yO$/jQMhO'#EkOOQ!0Lb,5@T,5@TO$/wQ!0LrO,5@TOOQ[1G.u1G.uO!ByQ!0LrO1G.uO!CUQpO1G.uO!C^QMhO1G.uO$0YQ`O1G0uO$0_Q`O'#CiO$0jQ`O'#KeO$0rQ`O,5=|O$0wQ`O'#KeO$0|Q`O'#KeO$1[Q`O'#JRO$1jQ`O,5AOO$1rQ!fO1G1iOOQ!0Lf1G1k1G1kO9kQ`O1G3fO@zQ`O1G3fO$1yQ`O1G3fO$2OQ`O1G3fO!DiQ`O1G3fO9uQ!0LrO1G3fOOQ[1G3f1G3fO!EcQ`O1G3UO!&zQMhO1G3RO$2TQ`O1G3ROOQ[1G3S1G3SO!&zQMhO1G3SO$2YQ`O1G3SO$2bQpO'#HQOOQ[1G3U1G3UO!6_QpO'#I}O!EhQ!bO1G3XOOQ[1G3X1G3XOOQ[,5=r,5=rO$2jQMhO,5=tO9kQ`O,5=tO$%dQ`O,5=vO9`Q`O,5=vO!CUQpO,5=vO!C^QMhO,5=vO:dQMhO,5=vO$2xQ`O'#KcO$3TQ`O,5=wOOQ[1G.k1G.kO$3YQ!0LrO1G.kO@zQ`O1G.kO$3eQ`O1G.kO9uQ!0LrO1G.kO$5mQ!fO,5AQO$5zQ`O,5AQO9eQ`O,5AQO$6VQlO,5>PO$6^Q`O,5>POOQ[1G3i1G3iO`QlO1G3iOOQ[1G3o1G3oOOQ[1G3q1G3qO?TQ`O1G3sO$6cQlO1G3uO$:gQlO'#HtOOQ[1G3x1G3xO$:tQ`O'#HzO?YQ`O'#H|OOQ[1G4O1G4OO$:|QlO1G4OO9uQ!0LrO1G4UOOQ[1G4W1G4WOOQ!0Lb'#G_'#G_O9uQ!0LrO1G4YO9uQ!0LrO1G4[O$?TQ`O,5@bO!)[QlO,5;`O9eQ`O,5;`O?YQ`O,5:XO!)[QlO,5:XO!CUQpO,5:XO$?YQ?MtO,5:XOOQO,5;`,5;`O$?dQpO'#IeO$?zQ`O,5@aOOQ!0Lf1G/r1G/rO$@SQpO'#IkO$@^Q`O,5@pOOQ!0Lb1G0y1G0yO#$`QpO,5:XOOQO'#Ig'#IgO$@fQpO,5:qOOQ!0Ln,5:q,5:qO#(ZQ`O1G0ZOOQ!0Lf1G0Z1G0ZO%[QlO1G0ZOOQ!0Lf1G0t1G0tO?YQ`O1G0tO!CUQpO1G0tO!C^QMhO1G0tOOQ!0Lb1G5|1G5|O!ByQ!0LrO1G0^OOQO1G0m1G0mO%[QlO1G0mO$@mQ!0LrO1G0mO$@xQ!0LrO1G0mO!CUQpO1G0^ODWQpO1G0^O$AWQ!0LrO1G0mOOQO1G0^1G0^O$AlQ!0MxO1G0mPOOO-E<[-E<[POOO1G.h1G.hOOOO1G/i1G/iO$AvQ!bO,5<iO$BOQ!fO1G4jOOQO1G4p1G4pO%[QlO,5?OO$BYQ`O1G5zO$BbQ`O1G6YO$BjQ!fO1G6ZO9eQ`O,5?UO$BtQ!0MxO1G6WO%[QlO1G6WO$CUQ!0LrO1G6WO$CgQ`O1G6VO$CgQ`O1G6VO9eQ`O1G6VO$CoQ`O,5?XO9eQ`O,5?XOOQO,5?X,5?XO$DTQ`O,5?XO$+YQ`O,5?XOOQO-E<k-E<kOOQS1G0a1G0aOOQS1G0c1G0cO#.lQ`O1G0cOOQ[7+(e7+(eO!&zQMhO7+(eO%[QlO7+(eO$DcQ`O7+(eO$DnQMhO7+(eO$D|Q!0MzO,5=XO$GXQ!0MzO,5=ZO$IdQ!0MzO,5=XO$KuQ!0MzO,5=ZO$NWQ!0MzO,59uO%!]Q!0MzO,5<kO%$hQ!0MzO,5<mO%&sQ!0MzO,5<{OOQ!0Lf7+&a7+&aO%)UQ!0MxO7+&aO%)xQlO'#IfO%*VQ`O,5@cO%*_Q!fO,5@cOOQ!0Lf1G0P1G0PO%*iQ`O7+&jOOQ!0Lf7+&j7+&jO%*nQ?MtO,5:fO%[QlO7+&zO%*xQ?MtO,5:bO%+VQ?MtO,5:jO%+aQ?MtO,5:lO%+kQMhO'#IiO%+uQ`O,5@hOOQ!0Lh1G0d1G0dOOQO1G1r1G1rOOQO1G1s1G1sO%+}Q!jO,5<ZO!)[QlO,5<YOOQO-E<l-E<lOOQ!0Lf7+'Y7+'YOOOW7+'e7+'eOOOW1G1|1G1|O%,YQ`O1G1|OOQ!0Lf1G2O1G2OOOOO,59o,59oO%,_Q!dO,59oOOOO-E<`-E<`OOQ!0Lh1G/X1G/XO%,fQ!0MxO7+'kOOQ!0Lh,5?^,5?^O%-YQMhO1G2fP%-aQ`O'#IrPOQ!0Lh-E<p-E<pO%-}QMjO,5?aOOQ!0Lh-E<s-E<sO%.pQMjO,5?cOOQ!0Lh-E<u-E<uO%.zQ!dO1G2wO%/RQ!dO'#CrO%/iQMhO'#KSO$$wQlO'#JvOOQ!0Lh1G2_1G2_O%/sQ`O'#IqO%0[Q`O,5@vO%0[Q`O,5@vO%0dQ`O,5@vO%0oQ`O,5@vOOQO1G2a1G2aO%0}QMjO1G2`O$+YQ`O'#K[O!,TQMhO1G2`O%1_Q(CWO'#IsO%1lQ`O,5@wO!&zQMhO,5@wO%1tQ!dO,5@wOOQ!0Lh1G2d1G2dO%4UQ!fO'#CiO%4`Q`O,5=POOQ!0Lb,5<},5<}O%4hQpO,5<}OOQ!0Lb,5=O,5=OOCwQ`O,5<}O%4sQpO,5<}OOQ!0Lb,5=R,5=RO$+YQ`O,5=VOOQO,5?`,5?`OOQO-E<r-E<rOOQ!0Lp1G2h1G2hO#$`QpO,5<}O$$wQlO,5=PO%5RQ`O,5=OO%5^QpO,5=OO!,TQMhO'#IuO%6WQMjO1G2sO!,TQMhO'#IwO%6yQMjO1G2uO%7TQMjO1G5qO%7_QMjO1G5qOOQO,5?e,5?eOOQO-E<w-E<wOOQO1G.{1G.{O!,TQMhO1G5qO!,TQMhO1G5qO!:]QpO,59wO%[QlO,59wOOQ!0Lh,5<j,5<jO%7lQ`O1G2ZO!,TQMhO1G2bO%7qQ!0MxO7+'mOOQ!0Lf7+'m7+'mO!$wQlO7+'mO%8eQ`O,5;`OOQ!0Lb,5?g,5?gOOQ!0Lb-E<y-E<yO%8jQ!dO'#K^O#(ZQ`O7+(eO4UQ!fO7+(eO$DfQ`O7+(eO%8tQ!0MvO'#CiO%9XQ!0MvO,5=SO%9lQ`O,5=SO%9tQ`O,5=SOOQ!0Lb1G5o1G5oOOQ[7+$a7+$aO!ByQ!0LrO7+$aO!CUQpO7+$aO!$wQlO7+&aO%9yQ`O'#JQO%:bQ`O,5APOOQO1G3h1G3hO9kQ`O,5APO%:bQ`O,5APO%:jQ`O,5APOOQO,5?m,5?mOOQO-E=P-E=POOQ!0Lf7+'T7+'TO%:oQ`O7+)QO9uQ!0LrO7+)QO9kQ`O7+)QO@zQ`O7+)QO%:tQ`O7+)QOOQ[7+)Q7+)QOOQ[7+(p7+(pO%:yQ!0MvO7+(mO!&zQMhO7+(mO!E^Q`O7+(nOOQ[7+(n7+(nO!&zQMhO7+(nO%;TQ`O'#KbO%;`Q`O,5=lOOQO,5?i,5?iOOQO-E<{-E<{OOQ[7+(s7+(sO%<rQpO'#HZOOQ[1G3`1G3`O!&zQMhO1G3`O%[QlO1G3`O%<yQ`O1G3`O%=UQMhO1G3`O9uQ!0LrO1G3bO$%dQ`O1G3bO9`Q`O1G3bO!CUQpO1G3bO!C^QMhO1G3bO%=dQ`O'#JPO%=xQ`O,5@}O%>QQpO,5@}OOQ!0Lb1G3c1G3cOOQ[7+$V7+$VO@zQ`O7+$VO9uQ!0LrO7+$VO%>]Q`O7+$VO%[QlO1G6lO%[QlO1G6mO%>bQ!0LrO1G6lO%>lQlO1G3kO%>sQ`O1G3kO%>xQlO1G3kOOQ[7+)T7+)TO9uQ!0LrO7+)_O`QlO7+)aOOQ['#Kh'#KhOOQ['#JS'#JSO%?PQlO,5>`OOQ[,5>`,5>`O%[QlO'#HuO%?^Q`O'#HwOOQ[,5>f,5>fO9eQ`O,5>fOOQ[,5>h,5>hOOQ[7+)j7+)jOOQ[7+)p7+)pOOQ[7+)t7+)tOOQ[7+)v7+)vO%?cQpO1G5|O%?}Q?MtO1G0zO%@XQ`O1G0zOOQO1G/s1G/sO%@dQ?MtO1G/sO?YQ`O1G/sO!)[QlO'#DmOOQO,5?P,5?POOQO-E<c-E<cOOQO,5?V,5?VOOQO-E<i-E<iO!CUQpO1G/sOOQO-E<e-E<eOOQ!0Ln1G0]1G0]OOQ!0Lf7+%u7+%uO#(ZQ`O7+%uOOQ!0Lf7+&`7+&`O?YQ`O7+&`O!CUQpO7+&`OOQO7+%x7+%xO$AlQ!0MxO7+&XOOQO7+&X7+&XO%[QlO7+&XO%@nQ!0LrO7+&XO!ByQ!0LrO7+%xO!CUQpO7+%xO%@yQ!0LrO7+&XO%AXQ!0MxO7++rO%[QlO7++rO%AiQ`O7++qO%AiQ`O7++qOOQO1G4s1G4sO9eQ`O1G4sO%AqQ`O1G4sOOQS7+%}7+%}O#(ZQ`O<<LPO4UQ!fO<<LPO%BPQ`O<<LPOOQ[<<LP<<LPO!&zQMhO<<LPO%[QlO<<LPO%BXQ`O<<LPO%BdQ!0MzO,5?aO%DoQ!0MzO,5?cO%FzQ!0MzO1G2`O%I]Q!0MzO1G2sO%KhQ!0MzO1G2uO%MsQ!fO,5?QO%[QlO,5?QOOQO-E<d-E<dO%M}Q`O1G5}OOQ!0Lf<<JU<<JUO%NVQ?MtO1G0uO&!^Q?MtO1G1PO&!eQ?MtO1G1PO&$fQ?MtO1G1PO&$mQ?MtO1G1PO&&nQ?MtO1G1PO&(oQ?MtO1G1PO&(vQ?MtO1G1PO&(}Q?MtO1G1PO&+OQ?MtO1G1PO&+VQ?MtO1G1PO&+^Q!0MxO<<JfO&-UQ?MtO1G1PO&.RQ?MvO1G1PO&/UQ?MvO'#JlO&1[Q?MtO1G1cO&1iQ?MtO1G0UO&1sQMjO,5?TOOQO-E<g-E<gO!)[QlO'#FqOOQO'#KZ'#KZOOQO1G1u1G1uO&1}Q`O1G1tO&2SQ?MtO,5?[OOOW7+'h7+'hOOOO1G/Z1G/ZO&2^Q!dO1G4xOOQ!0Lh7+(Q7+(QP!&zQMhO,5?^O!,TQMhO7+(cO&2eQ`O,5?]O9eQ`O,5?]O$+YQ`O,5?]OOQO-E<o-E<oO&2sQ`O1G6bO&2sQ`O1G6bO&2{Q`O1G6bO&3WQMjO7+'zO&3hQ!dO,5?_O&3rQ`O,5?_O!&zQMhO,5?_OOQO-E<q-E<qO&3wQ!dO1G6cO&4RQ`O1G6cO&4ZQ`O1G2kO!&zQMhO1G2kOOQ!0Lb1G2i1G2iOOQ!0Lb1G2j1G2jO%4hQpO1G2iO!CUQpO1G2iOCwQ`O1G2iOOQ!0Lb1G2q1G2qO&4`QpO1G2iO&4nQ`O1G2kO$+YQ`O1G2jOCwQ`O1G2jO$$wQlO1G2kO&4vQ`O1G2jO&5jQMjO,5?aOOQ!0Lh-E<t-E<tO&6]QMjO,5?cOOQ!0Lh-E<v-E<vO!,TQMhO7++]O&6gQMjO7++]O&6qQMjO7++]OOQ!0Lh1G/c1G/cO&7OQ`O1G/cOOQ!0Lh7+'u7+'uO&7TQMjO7+'|O&7eQ!0MxO<<KXOOQ!0Lf<<KX<<KXO&8XQ`O1G0zO!&zQMhO'#IzO&8^Q`O,5@xO&:`Q!fO<<LPO!&zQMhO1G2nO&:gQ!0LrO1G2nOOQ[<<G{<<G{O!ByQ!0LrO<<G{O&:xQ!0MxO<<I{OOQ!0Lf<<I{<<I{OOQO,5?l,5?lO&;lQ`O,5?lO&;qQ`O,5?lOOQO-E=O-E=OO&<PQ`O1G6kO&<PQ`O1G6kO9kQ`O1G6kO@zQ`O<<LlOOQ[<<Ll<<LlO&<XQ`O<<LlO9uQ!0LrO<<LlO9kQ`O<<LlOOQ[<<LX<<LXO%:yQ!0MvO<<LXOOQ[<<LY<<LYO!E^Q`O<<LYO&<^QpO'#I|O&<iQ`O,5@|O!)[QlO,5@|OOQ[1G3W1G3WOOQO'#JO'#JOO9uQ!0LrO'#JOO&<qQpO,5=uOOQ[,5=u,5=uO&<xQpO'#EgO&=PQpO'#GeO&=UQ`O7+(zO&=ZQ`O7+(zOOQ[7+(z7+(zO!&zQMhO7+(zO%[QlO7+(zO&=cQ`O7+(zOOQ[7+(|7+(|O9uQ!0LrO7+(|O$%dQ`O7+(|O9`Q`O7+(|O!CUQpO7+(|O&=nQ`O,5?kOOQO-E<}-E<}OOQO'#H^'#H^O&=yQ`O1G6iO9uQ!0LrO<<GqOOQ[<<Gq<<GqO@zQ`O<<GqO&>RQ`O7+,WO&>WQ`O7+,XO%[QlO7+,WO%[QlO7+,XOOQ[7+)V7+)VO&>]Q`O7+)VO&>bQlO7+)VO&>iQ`O7+)VOOQ[<<Ly<<LyOOQ[<<L{<<L{OOQ[-E=Q-E=QOOQ[1G3z1G3zO&>nQ`O,5>aOOQ[,5>c,5>cO&>sQ`O1G4QO9eQ`O7+&fO!)[QlO7+&fOOQO7+%_7+%_O&>xQ?MtO1G6ZO?YQ`O7+%_OOQ!0Lf<<Ia<<IaOOQ!0Lf<<Iz<<IzO?YQ`O<<IzOOQO<<Is<<IsO$AlQ!0MxO<<IsO%[QlO<<IsOOQO<<Id<<IdO!ByQ!0LrO<<IdO&?SQ!0LrO<<IsO&?_Q!0MxO<= ^O&?oQ`O<= ]OOQO7+*_7+*_O9eQ`O7+*_OOQ[ANAkANAkO&?wQ!fOANAkO!&zQMhOANAkO#(ZQ`OANAkO4UQ!fOANAkO&@OQ`OANAkO%[QlOANAkO&@WQ!0MzO7+'zO&BiQ!0MzO,5?aO&DtQ!0MzO,5?cO&GPQ!0MzO7+'|O&IbQ!fO1G4lO&IlQ?MtO7+&aO&KpQ?MvO,5=XO&MwQ?MvO,5=ZO&NXQ?MvO,5=XO&NiQ?MvO,5=ZO&NyQ?MvO,59uO'#PQ?MvO,5<kO'%SQ?MvO,5<mO''hQ?MvO,5<{O')^Q?MtO7+'kO')kQ?MtO7+'mO')xQ`O,5<]OOQO7+'`7+'`OOQ!0Lh7+*d7+*dO')}QMjO<<K}OOQO1G4w1G4wO'*UQ`O1G4wO'*aQ`O1G4wO'*oQ`O7++|O'*oQ`O7++|O!&zQMhO1G4yO'*wQ!dO1G4yO'+RQ`O7++}O'+ZQ`O7+(VO'+fQ!dO7+(VOOQ!0Lb7+(T7+(TOOQ!0Lb7+(U7+(UO!CUQpO7+(TOCwQ`O7+(TO'+pQ`O7+(VO!&zQMhO7+(VO$+YQ`O7+(UO'+uQ`O7+(VOCwQ`O7+(UO'+}QMjO<<NwO!,TQMhO<<NwOOQ!0Lh7+$}7+$}O',XQ!dO,5?fOOQO-E<x-E<xO',cQ!0MvO7+(YO!&zQMhO7+(YOOQ[AN=gAN=gO9kQ`O1G5WOOQO1G5W1G5WO',sQ`O1G5WO',xQ`O7+,VO',xQ`O7+,VO9uQ!0LrOANBWO@zQ`OANBWOOQ[ANBWANBWO'-QQ`OANBWOOQ[ANAsANAsOOQ[ANAtANAtO'-VQ`O,5?hOOQO-E<z-E<zO'-bQ?MtO1G6hOOQO,5?j,5?jOOQO-E<|-E<|OOQ[1G3a1G3aO'-lQ`O,5=POOQ[<<Lf<<LfO!&zQMhO<<LfO&=UQ`O<<LfO'-qQ`O<<LfO%[QlO<<LfOOQ[<<Lh<<LhO9uQ!0LrO<<LhO$%dQ`O<<LhO9`Q`O<<LhO'-yQpO1G5VO'.UQ`O7+,TOOQ[AN=]AN=]O9uQ!0LrOAN=]OOQ[<= r<= rOOQ[<= s<= sO'.^Q`O<= rO'.cQ`O<= sOOQ[<<Lq<<LqO'.hQ`O<<LqO'.mQlO<<LqOOQ[1G3{1G3{O?YQ`O7+)lO'.tQ`O<<JQO'/PQ?MtO<<JQOOQO<<Hy<<HyOOQ!0LfAN?fAN?fOOQOAN?_AN?_O$AlQ!0MxOAN?_OOQOAN?OAN?OO%[QlOAN?_OOQO<<My<<MyOOQ[G27VG27VO!&zQMhOG27VO#(ZQ`OG27VO'/ZQ!fOG27VO4UQ!fOG27VO'/bQ`OG27VO'/jQ?MtO<<JfO'/wQ?MvO1G2`O'1mQ?MvO,5?aO'3pQ?MvO,5?cO'5sQ?MvO1G2sO'7vQ?MvO1G2uO'9yQ?MtO<<KXO':WQ?MtO<<I{OOQO1G1w1G1wO!,TQMhOANAiOOQO7+*c7+*cO':eQ`O7+*cO':pQ`O<= hO':xQ!dO7+*eOOQ!0Lb<<Kq<<KqO$+YQ`O<<KqOCwQ`O<<KqO';SQ`O<<KqO!&zQMhO<<KqOOQ!0Lb<<Ko<<KoO!CUQpO<<KoO';_Q!dO<<KqOOQ!0Lb<<Kp<<KpO';iQ`O<<KqO!&zQMhO<<KqO$+YQ`O<<KpO';nQMjOANDcO';xQ!0MvO<<KtOOQO7+*r7+*rO9kQ`O7+*rO'<YQ`O<= qOOQ[G27rG27rO9uQ!0LrOG27rO@zQ`OG27rO!)[QlO1G5SO'<bQ`O7+,SO'<jQ`O1G2kO&=UQ`OANBQOOQ[ANBQANBQO!&zQMhOANBQO'<oQ`OANBQOOQ[ANBSANBSO9uQ!0LrOANBSO$%dQ`OANBSOOQO'#H_'#H_OOQO7+*q7+*qOOQ[G22wG22wOOQ[ANE^ANE^OOQ[ANE_ANE_OOQ[ANB]ANB]O'<wQ`OANB]OOQ[<<MW<<MWO!)[QlOAN?lOOQOG24yG24yO$AlQ!0MxOG24yO#(ZQ`OLD,qOOQ[LD,qLD,qO!&zQMhOLD,qO'<|Q!fOLD,qO'=TQ?MvO7+'zO'>yQ?MvO,5?aO'@|Q?MvO,5?cO'CPQ?MvO7+'|O'DuQMjOG27TOOQO<<M}<<M}OOQ!0LbANA]ANA]O$+YQ`OANA]OCwQ`OANA]O'EVQ!dOANA]OOQ!0LbANAZANAZO'E^Q`OANA]O!&zQMhOANA]O'EiQ!dOANA]OOQ!0LbANA[ANA[OOQO<<N^<<N^OOQ[LD-^LD-^O9uQ!0LrOLD-^O'EsQ?MtO7+*nOOQO'#Gf'#GfOOQ[G27lG27lO&=UQ`OG27lO!&zQMhOG27lOOQ[G27nG27nO9uQ!0LrOG27nOOQ[G27wG27wO'E}Q?MtOG25WOOQOLD*eLD*eOOQ[!$(!]!$(!]O#(ZQ`O!$(!]O!&zQMhO!$(!]O'FXQ!0MzOG27TOOQ!0LbG26wG26wO$+YQ`OG26wO'HjQ`OG26wOCwQ`OG26wO'HuQ!dOG26wO!&zQMhOG26wOOQ[!$(!x!$(!xOOQ[LD-WLD-WO&=UQ`OLD-WOOQ[LD-YLD-YOOQ[!)9Ew!)9EwO#(ZQ`O!)9EwOOQ!0LbLD,cLD,cO$+YQ`OLD,cOCwQ`OLD,cO'H|Q`OLD,cO'IXQ!dOLD,cOOQ[!$(!r!$(!rOOQ[!.K;c!.K;cO'I`Q?MvOG27TOOQ!0Lb!$( }!$( }O$+YQ`O!$( }OCwQ`O!$( }O'KUQ`O!$( }OOQ!0Lb!)9Ei!)9EiO$+YQ`O!)9EiOCwQ`O!)9EiOOQ!0Lb!.K;T!.K;TO$+YQ`O!.K;TOOQ!0Lb!4/0o!4/0oO!)[QlO'#DzO1PQ`O'#EXO'KaQ!fO'#JrO'KhQ!L^O'#DvO'KoQlO'#EOO'KvQ!fO'#CiO'N^Q!fO'#CiO!)[QlO'#EQO'NnQlO,5;ZO!)[QlO,5;eO!)[QlO,5;eO!)[QlO,5;eO!)[QlO,5;eO!)[QlO,5;eO!)[QlO,5;eO!)[QlO,5;eO!)[QlO,5;eO!)[QlO,5;eO!)[QlO,5;eO!)[QlO'#IpO(!qQ`O,5<iO!)[QlO,5;eO(!yQMhO,5;eO($dQMhO,5;eO!)[QlO,5;wO!&zQMhO'#GmO(!yQMhO'#GmO!&zQMhO'#GoO(!yQMhO'#GoO1SQ`O'#DZO1SQ`O'#DZO!&zQMhO'#GPO(!yQMhO'#GPO!&zQMhO'#GRO(!yQMhO'#GRO!&zQMhO'#GaO(!yQMhO'#GaO!)[QlO,5:jO($kQpO'#D_O($uQpO'#JvO!)[QlO,5@oO'NnQlO1G0uO(%PQ?MtO'#CiO!)[QlO1G2PO!&zQMhO'#IuO(!yQMhO'#IuO!&zQMhO'#IwO(!yQMhO'#IwO(%ZQ!dO'#CrO!&zQMhO,5<tO(!yQMhO,5<tO'NnQlO1G2RO!)[QlO7+&zO!&zQMhO1G2`O(!yQMhO1G2`O!&zQMhO'#IuO(!yQMhO'#IuO!&zQMhO'#IwO(!yQMhO'#IwO!&zQMhO1G2bO(!yQMhO1G2bO'NnQlO7+'mO'NnQlO7+&aO!&zQMhOANAiO(!yQMhOANAiO(%nQ`O'#EoO(%sQ`O'#EoO(%{Q`O'#F]O(&QQ`O'#EyO(&VQ`O'#KTO(&bQ`O'#KRO(&mQ`O,5;ZO(&rQMjO,5<eO(&yQ`O'#GYO('OQ`O'#GYO('TQ`O,5<eO(']Q`O,5<gO('eQ`O,5;ZO('mQ?MtO1G1`O('tQ`O,5<tO('yQ`O,5<tO((OQ`O,5<vO((TQ`O,5<vO((YQ`O1G2RO((_Q`O1G0uO((dQMjO<<K}O((kQMjO<<K}O((rQMhO'#F|O9`Q`O'#F{OAuQ`O'#EnO!)[QlO,5;tO!3oQ`O'#GYO!3oQ`O'#GYO!3oQ`O'#G[O!3oQ`O'#G[O!,TQMhO7+(cO!,TQMhO7+(cO%.zQ!dO1G2wO%.zQ!dO1G2wO!&zQMhO,5=]O!&zQMhO,5=]",stateData:"()x~O'|OS'}OSTOS(ORQ~OPYOQYOSfOY!VOaqOdzOeyOl!POpkOrYOskOtkOzkO|YO!OYO!SWO!WkO!XkO!_XO!iuO!lZO!oYO!pYO!qYO!svO!uwO!xxO!|]O$W|O$niO%h}O%j!QO%l!OO%m!OO%n!OO%q!RO%s!SO%v!TO%w!TO%y!UO&W!WO&^!XO&`!YO&b!ZO&d![O&g!]O&m!^O&s!_O&u!`O&w!aO&y!bO&{!cO(TSO(VTO(YUO(aVO(o[O~OWtO~P`OPYOQYOSfOd!jOe!iOpkOrYOskOtkOzkO|YO!OYO!SWO!WkO!XkO!_!eO!iuO!lZO!oYO!pYO!qYO!svO!u!gO!x!hO$W!kO$niO(T!dO(VTO(YUO(aVO(o[O~Oa!wOs!nO!S!oO!b!yO!c!vO!d!vO!|<VO#T!pO#U!pO#V!xO#W!pO#X!pO#[!zO#]!zO(U!lO(VTO(YUO(e!mO(o!sO~O(O!{O~OP]XR]X[]Xa]Xj]Xr]X!Q]X!S]X!]]X!l]X!p]X#R]X#S]X#`]X#kfX#n]X#o]X#p]X#q]X#r]X#s]X#t]X#u]X#v]X#x]X#z]X#{]X$Q]X'z]X(a]X(r]X(y]X(z]X~O!g%RX~P(qO_!}O(V#PO(W!}O(X#PO~O_#QO(X#PO(Y#PO(Z#QO~Ox#SO!U#TO(b#TO(c#VO~OPYOQYOSfOd!jOe!iOpkOrYOskOtkOzkO|YO!OYO!SWO!WkO!XkO!_!eO!iuO!lZO!oYO!pYO!qYO!svO!u!gO!x!hO$W!kO$niO(T<ZO(VTO(YUO(aVO(o[O~O![#ZO!]#WO!Y(hP!Y(vP~P+}O!^#cO~P`OPYOQYOSfOd!jOe!iOrYOskOtkOzkO|YO!OYO!SWO!WkO!XkO!_!eO!iuO!lZO!oYO!pYO!qYO!svO!u!gO!x!hO$W!kO$niO(VTO(YUO(aVO(o[O~Op#mO![#iO!|]O#i#lO#j#iO(T<[O!k(sP~P.iO!l#oO(T#nO~O!x#sO!|]O%h#tO~O#k#uO~O!g#vO#k#uO~OP$[OR#zO[$cOj$ROr$aO!Q#yO!S#{O!]$_O!l#xO!p$[O#R$RO#n$OO#o$PO#p$PO#q$PO#r$QO#s$RO#t$RO#u$bO#v$SO#x$UO#z$WO#{$XO(aVO(r$YO(y#|O(z#}O~Oa(fX'z(fX'w(fX!k(fX!Y(fX!_(fX%i(fX!g(fX~P1qO#S$dO#`$eO$Q$eOP(gXR(gX[(gXj(gXr(gX!Q(gX!S(gX!](gX!l(gX!p(gX#R(gX#n(gX#o(gX#p(gX#q(gX#r(gX#s(gX#t(gX#u(gX#v(gX#x(gX#z(gX#{(gX(a(gX(r(gX(y(gX(z(gX!_(gX%i(gX~Oa(gX'z(gX'w(gX!Y(gX!k(gXv(gX!g(gX~P4UO#`$eO~O$]$hO$_$gO$f$mO~OSfO!_$nO$i$oO$k$qO~Oh%VOj%dOk%dOp%WOr%XOs$tOt$tOz%YO|%ZO!O%]O!S${O!_$|O!i%bO!l$xO#j%cO$W%`O$t%^O$v%_O$y%aO(T$sO(VTO(YUO(a$uO(y$}O(z%POg(^P~Ol%[O~P7eO!l%eO~O!S%hO!_%iO(T%gO~O!g%mO~Oa%nO'z%nO~O!Q%rO~P%[O(U!lO~P%[O%n%vO~P%[Oh%VO!l%eO(T%gO(U!lO~Oe%}O!l%eO(T%gO~Oj$RO~O!_&PO(T%gO(U!lO(VTO(YUO`)WP~O!Q&SO!l&RO%j&VO&T&WO~P;SO!x#sO~O%s&YO!S)SX!_)SX(T)SX~O(T&ZO~Ol!PO!u&`O%j!QO%l!OO%m!OO%n!OO%q!RO%s!SO%v!TO%w!TO~Od&eOe&dO!x&bO%h&cO%{&aO~P<bOd&hOeyOl!PO!_&gO!u&`O!xxO!|]O%h}O%l!OO%m!OO%n!OO%q!RO%s!SO%v!TO%w!TO%y!UO~Ob&kO#`&nO%j&iO(U!lO~P=gO!l&oO!u&sO~O!l#oO~O!_XO~Oa%nO'x&{O'z%nO~Oa%nO'x'OO'z%nO~Oa%nO'x'QO'z%nO~O'w]X!Y]Xv]X!k]X&[]X!_]X%i]X!g]X~P(qO!b'_O!c'WO!d'WO(U!lO(VTO(YUO~Os'UO!S'TO!['XO(e'SO!^(iP!^(xP~P@nOn'bO!_'`O(T%gO~Oe'gO!l%eO(T%gO~O!Q&SO!l&RO~Os!nO!S!oO!|<VO#T!pO#U!pO#W!pO#X!pO(U!lO(VTO(YUO(e!mO(o!sO~O!b'mO!c'lO!d'lO#V!pO#['nO#]'nO~PBYOa%nOh%VO!g#vO!l%eO'z%nO(r'pO~O!p'tO#`'rO~PChOs!nO!S!oO(VTO(YUO(e!mO(o!sO~O!_XOs(mX!S(mX!b(mX!c(mX!d(mX!|(mX#T(mX#U(mX#V(mX#W(mX#X(mX#[(mX#](mX(U(mX(V(mX(Y(mX(e(mX(o(mX~O!c'lO!d'lO(U!lO~PDWO(P'xO(Q'xO(R'zO~O_!}O(V'|O(W!}O(X'|O~O_#QO(X'|O(Y'|O(Z#QO~Ov(OO~P%[Ox#SO!U#TO(b#TO(c(RO~O![(TO!Y'WX!Y'^X!]'WX!]'^X~P+}O!](VO!Y(hX~OP$[OR#zO[$cOj$ROr$aO!Q#yO!S#{O!](VO!l#xO!p$[O#R$RO#n$OO#o$PO#p$PO#q$PO#r$QO#s$RO#t$RO#u$bO#v$SO#x$UO#z$WO#{$XO(aVO(r$YO(y#|O(z#}O~O!Y(hX~PHRO!Y([O~O!Y(uX!](uX!g(uX!k(uX(r(uX~O#`(uX#k#dX!^(uX~PJUO#`(]O!Y(wX!](wX~O!](^O!Y(vX~O!Y(aO~O#`$eO~PJUO!^(bO~P`OR#zO!Q#yO!S#{O!l#xO(aVOP!na[!naj!nar!na!]!na!p!na#R!na#n!na#o!na#p!na#q!na#r!na#s!na#t!na#u!na#v!na#x!na#z!na#{!na(r!na(y!na(z!na~Oa!na'z!na'w!na!Y!na!k!nav!na!_!na%i!na!g!na~PKlO!k(cO~O!g#vO#`(dO(r'pO!](tXa(tX'z(tX~O!k(tX~PNXO!S%hO!_%iO!|]O#i(iO#j(hO(T%gO~O!](jO!k(sX~O!k(lO~O!S%hO!_%iO#j(hO(T%gO~OP(gXR(gX[(gXj(gXr(gX!Q(gX!S(gX!](gX!l(gX!p(gX#R(gX#n(gX#o(gX#p(gX#q(gX#r(gX#s(gX#t(gX#u(gX#v(gX#x(gX#z(gX#{(gX(a(gX(r(gX(y(gX(z(gX~O!g#vO!k(gX~P! uOR(nO!Q(mO!l#xO#S$dO!|!{a!S!{a~O!x!{a%h!{a!_!{a#i!{a#j!{a(T!{a~P!#vO!x(rO~OPYOQYOSfOd!jOe!iOpkOrYOskOtkOzkO|YO!OYO!SWO!WkO!XkO!_XO!iuO!lZO!oYO!pYO!qYO!svO!u!gO!x!hO$W!kO$niO(T!dO(VTO(YUO(aVO(o[O~Oh%VOp%WOr%XOs$tOt$tOz%YO|%ZO!O<sO!S${O!_$|O!i>VO!l$xO#j<yO$W%`O$t<uO$v<wO$y%aO(T(vO(VTO(YUO(a$uO(y$}O(z%PO~O#k(xO~O![(zO!k(kP~P%[O(e(|O(o[O~O!S)OO!l#xO(e(|O(o[O~OP<UOQ<UOSfOd>ROe!iOpkOr<UOskOtkOzkO|<UO!O<UO!SWO!WkO!XkO!_!eO!i<XO!lZO!o<UO!p<UO!q<UO!s<YO!u<]O!x!hO$W!kO$n>PO(T)]O(VTO(YUO(aVO(o[O~O!]$_Oa$qa'z$qa'w$qa!k$qa!Y$qa!_$qa%i$qa!g$qa~Ol)dO~P!&zOh%VOp%WOr%XOs$tOt$tOz%YO|%ZO!O%]O!S${O!_$|O!i%bO!l$xO#j%cO$W%`O$t%^O$v%_O$y%aO(T(vO(VTO(YUO(a$uO(y$}O(z%PO~Og(pP~P!,TO!Q)iO!g)hO!_$^X$Z$^X$]$^X$_$^X$f$^X~O!g)hO!_({X$Z({X$]({X$_({X$f({X~O!Q)iO~P!.^O!Q)iO!_({X$Z({X$]({X$_({X$f({X~O!_)kO$Z)oO$])jO$_)jO$f)pO~O![)sO~P!)[O$]$hO$_$gO$f)wO~On$zX!Q$zX#S$zX'y$zX(y$zX(z$zX~OgmXg$zXnmX!]mX#`mX~P!0SOx)yO(b)zO(c)|O~On*VO!Q*OO'y*PO(y$}O(z%PO~Og)}O~P!1WOg*WO~Oh%VOr%XOs$tOt$tOz%YO|%ZO!O<sO!S*YO!_*ZO!i>VO!l$xO#j<yO$W%`O$t<uO$v<wO$y%aO(VTO(YUO(a$uO(y$}O(z%PO~Op*`O![*^O(T*XO!k)OP~P!1uO#k*aO~O!l*bO~Oh%VOp%WOr%XOs$tOt$tOz%YO|%ZO!O<sO!S${O!_$|O!i>VO!l$xO#j<yO$W%`O$t<uO$v<wO$y%aO(T*dO(VTO(YUO(a$uO(y$}O(z%PO~O![*gO!Y)PP~P!3tOr*sOs!nO!S*iO!b*qO!c*kO!d*kO!l*bO#[*rO%`*mO(U!lO(VTO(YUO(e!mO~O!^*pO~P!5iO#S$dOn(`X!Q(`X'y(`X(y(`X(z(`X!](`X#`(`X~Og(`X$O(`X~P!6kOn*xO#`*wOg(_X!](_X~O!]*yOg(^X~Oj%dOk%dOl%dO(T&ZOg(^P~Os*|O~Og)}O(T&ZO~O!l+SO~O(T(vO~Op+WO!S%hO![#iO!_%iO!|]O#i#lO#j#iO(T%gO!k(sP~O!g#vO#k+XO~O!S%hO![+ZO!](^O!_%iO(T%gO!Y(vP~Os'[O!S+]O![+[O(VTO(YUO(e(|O~O!^(xP~P!9|O!]+^Oa)TX'z)TX~OP$[OR#zO[$cOj$ROr$aO!Q#yO!S#{O!l#xO!p$[O#R$RO#n$OO#o$PO#p$PO#q$PO#r$QO#s$RO#t$RO#u$bO#v$SO#x$UO#z$WO#{$XO(aVO(r$YO(y#|O(z#}O~Oa!ja!]!ja'z!ja'w!ja!Y!ja!k!jav!ja!_!ja%i!ja!g!ja~P!:tOR#zO!Q#yO!S#{O!l#xO(aVOP!ra[!raj!rar!ra!]!ra!p!ra#R!ra#n!ra#o!ra#p!ra#q!ra#r!ra#s!ra#t!ra#u!ra#v!ra#x!ra#z!ra#{!ra(r!ra(y!ra(z!ra~Oa!ra'z!ra'w!ra!Y!ra!k!rav!ra!_!ra%i!ra!g!ra~P!=[OR#zO!Q#yO!S#{O!l#xO(aVOP!ta[!taj!tar!ta!]!ta!p!ta#R!ta#n!ta#o!ta#p!ta#q!ta#r!ta#s!ta#t!ta#u!ta#v!ta#x!ta#z!ta#{!ta(r!ta(y!ta(z!ta~Oa!ta'z!ta'w!ta!Y!ta!k!tav!ta!_!ta%i!ta!g!ta~P!?rOh%VOn+gO!_'`O%i+fO~O!g+iOa(]X!_(]X'z(]X!](]X~Oa%nO!_XO'z%nO~Oh%VO!l%eO~Oh%VO!l%eO(T%gO~O!g#vO#k(xO~Ob+tO%j+uO(T+qO(VTO(YUO!^)XP~O!]+vO`)WX~O[+zO~O`+{O~O!_&PO(T%gO(U!lO`)WP~O%j,OO~P;SOh%VO#`,SO~Oh%VOn,VO!_$|O~O!_,XO~O!Q,ZO!_XO~O%n%vO~O!x,`O~Oe,eO~Ob,fO(T#nO(VTO(YUO!^)VP~Oe%}O~O%j!QO(T&ZO~P=gO[,kO`,jO~OPYOQYOSfOdzOeyOpkOrYOskOtkOzkO|YO!OYO!SWO!WkO!XkO!iuO!lZO!oYO!pYO!qYO!svO!xxO!|]O$niO%h}O(VTO(YUO(aVO(o[O~O!_!eO!u!gO$W!kO(T!dO~P!FyO`,jOa%nO'z%nO~OPYOQYOSfOd!jOe!iOpkOrYOskOtkOzkO|YO!OYO!SWO!WkO!XkO!_!eO!iuO!lZO!oYO!pYO!qYO!svO!x!hO$W!kO$niO(T!dO(VTO(YUO(aVO(o[O~Oa,pOl!OO!uwO%l!OO%m!OO%n!OO~P!IcO!l&oO~O&^,vO~O!_,xO~O&o,zO&q,{OP&laQ&laS&laY&laa&lad&lae&lal&lap&lar&las&lat&laz&la|&la!O&la!S&la!W&la!X&la!_&la!i&la!l&la!o&la!p&la!q&la!s&la!u&la!x&la!|&la$W&la$n&la%h&la%j&la%l&la%m&la%n&la%q&la%s&la%v&la%w&la%y&la&W&la&^&la&`&la&b&la&d&la&g&la&m&la&s&la&u&la&w&la&y&la&{&la'w&la(T&la(V&la(Y&la(a&la(o&la!^&la&e&lab&la&j&la~O(T-QO~Oh!eX!]!RX!^!RX!g!RX!g!eX!l!eX#`!RX~O!]!eX!^!eX~P#!iO!g-VO#`-UOh(jX!]#hX!^#hX!g(jX!l(jX~O!](jX!^(jX~P##[Oh%VO!g-XO!l%eO!]!aX!^!aX~Os!nO!S!oO(VTO(YUO(e!mO~OP<UOQ<UOSfOd>ROe!iOpkOr<UOskOtkOzkO|<UO!O<UO!SWO!WkO!XkO!_!eO!i<XO!lZO!o<UO!p<UO!q<UO!s<YO!u<]O!x!hO$W!kO$n>PO(VTO(YUO(aVO(o[O~O(T=QO~P#$qO!]-]O!^(iX~O!^-_O~O!g-VO#`-UO!]#hX!^#hX~O!]-`O!^(xX~O!^-bO~O!c-cO!d-cO(U!lO~P#$`O!^-fO~P'_On-iO!_'`O~O!Y-nO~Os!{a!b!{a!c!{a!d!{a#T!{a#U!{a#V!{a#W!{a#X!{a#[!{a#]!{a(U!{a(V!{a(Y!{a(e!{a(o!{a~P!#vO!p-sO#`-qO~PChO!c-uO!d-uO(U!lO~PDWOa%nO#`-qO'z%nO~Oa%nO!g#vO#`-qO'z%nO~Oa%nO!g#vO!p-sO#`-qO'z%nO(r'pO~O(P'xO(Q'xO(R-zO~Ov-{O~O!Y'Wa!]'Wa~P!:tO![.PO!Y'WX!]'WX~P%[O!](VO!Y(ha~O!Y(ha~PHRO!](^O!Y(va~O!S%hO![.TO!_%iO(T%gO!Y'^X!]'^X~O#`.VO!](ta!k(taa(ta'z(ta~O!g#vO~P#,wO!](jO!k(sa~O!S%hO!_%iO#j.ZO(T%gO~Op.`O!S%hO![.]O!_%iO!|]O#i._O#j.]O(T%gO!]'aX!k'aX~OR.dO!l#xO~Oh%VOn.gO!_'`O%i.fO~Oa#ci!]#ci'z#ci'w#ci!Y#ci!k#civ#ci!_#ci%i#ci!g#ci~P!:tOn>]O!Q*OO'y*PO(y$}O(z%PO~O#k#_aa#_a#`#_a'z#_a!]#_a!k#_a!_#_a!Y#_a~P#/sO#k(`XP(`XR(`X[(`Xa(`Xj(`Xr(`X!S(`X!l(`X!p(`X#R(`X#n(`X#o(`X#p(`X#q(`X#r(`X#s(`X#t(`X#u(`X#v(`X#x(`X#z(`X#{(`X'z(`X(a(`X(r(`X!k(`X!Y(`X'w(`Xv(`X!_(`X%i(`X!g(`X~P!6kO!].tO!k(kX~P!:tO!k.wO~O!Y.yO~OP$[OR#zO!Q#yO!S#{O!l#xO!p$[O(aVO[#mia#mij#mir#mi!]#mi#R#mi#o#mi#p#mi#q#mi#r#mi#s#mi#t#mi#u#mi#v#mi#x#mi#z#mi#{#mi'z#mi(r#mi(y#mi(z#mi'w#mi!Y#mi!k#miv#mi!_#mi%i#mi!g#mi~O#n#mi~P#3cO#n$OO~P#3cOP$[OR#zOr$aO!Q#yO!S#{O!l#xO!p$[O#n$OO#o$PO#p$PO#q$PO(aVO[#mia#mij#mi!]#mi#R#mi#s#mi#t#mi#u#mi#v#mi#x#mi#z#mi#{#mi'z#mi(r#mi(y#mi(z#mi'w#mi!Y#mi!k#miv#mi!_#mi%i#mi!g#mi~O#r#mi~P#6QO#r$QO~P#6QOP$[OR#zO[$cOj$ROr$aO!Q#yO!S#{O!l#xO!p$[O#R$RO#n$OO#o$PO#p$PO#q$PO#r$QO#s$RO#t$RO#u$bO(aVOa#mi!]#mi#x#mi#z#mi#{#mi'z#mi(r#mi(y#mi(z#mi'w#mi!Y#mi!k#miv#mi!_#mi%i#mi!g#mi~O#v#mi~P#8oOP$[OR#zO[$cOj$ROr$aO!Q#yO!S#{O!l#xO!p$[O#R$RO#n$OO#o$PO#p$PO#q$PO#r$QO#s$RO#t$RO#u$bO#v$SO(aVO(z#}Oa#mi!]#mi#z#mi#{#mi'z#mi(r#mi(y#mi'w#mi!Y#mi!k#miv#mi!_#mi%i#mi!g#mi~O#x$UO~P#;VO#x#mi~P#;VO#v$SO~P#8oOP$[OR#zO[$cOj$ROr$aO!Q#yO!S#{O!l#xO!p$[O#R$RO#n$OO#o$PO#p$PO#q$PO#r$QO#s$RO#t$RO#u$bO#v$SO#x$UO(aVO(y#|O(z#}Oa#mi!]#mi#{#mi'z#mi(r#mi'w#mi!Y#mi!k#miv#mi!_#mi%i#mi!g#mi~O#z#mi~P#={O#z$WO~P#={OP]XR]X[]Xj]Xr]X!Q]X!S]X!l]X!p]X#R]X#S]X#`]X#kfX#n]X#o]X#p]X#q]X#r]X#s]X#t]X#u]X#v]X#x]X#z]X#{]X$Q]X(a]X(r]X(y]X(z]X!]]X!^]X~O$O]X~P#@jOP$[OR#zO[<mOj<bOr<kO!Q#yO!S#{O!l#xO!p$[O#R<bO#n<_O#o<`O#p<`O#q<`O#r<aO#s<bO#t<bO#u<lO#v<cO#x<eO#z<gO#{<hO(aVO(r$YO(y#|O(z#}O~O$O.{O~P#BwO#S$dO#`<nO$Q<nO$O(gX!^(gX~P! uOa'da!]'da'z'da'w'da!k'da!Y'dav'da!_'da%i'da!g'da~P!:tO[#mia#mij#mir#mi!]#mi#R#mi#r#mi#s#mi#t#mi#u#mi#v#mi#x#mi#z#mi#{#mi'z#mi(r#mi'w#mi!Y#mi!k#miv#mi!_#mi%i#mi!g#mi~OP$[OR#zO!Q#yO!S#{O!l#xO!p$[O#n$OO#o$PO#p$PO#q$PO(aVO(y#mi(z#mi~P#EyOn>]O!Q*OO'y*PO(y$}O(z%POP#miR#mi!S#mi!l#mi!p#mi#n#mi#o#mi#p#mi#q#mi(a#mi~P#EyO!]/POg(pX~P!1WOg/RO~Oa$Pi!]$Pi'z$Pi'w$Pi!Y$Pi!k$Piv$Pi!_$Pi%i$Pi!g$Pi~P!:tO$]/SO$_/SO~O$]/TO$_/TO~O!g)hO#`/UO!_$cX$Z$cX$]$cX$_$cX$f$cX~O![/VO~O!_)kO$Z/XO$])jO$_)jO$f/YO~O!]<iO!^(fX~P#BwO!^/ZO~O!g)hO$f({X~O$f/]O~Ov/^O~P!&zOx)yO(b)zO(c/aO~O!S/dO~O(y$}On%aa!Q%aa'y%aa(z%aa!]%aa#`%aa~Og%aa$O%aa~P#L{O(z%POn%ca!Q%ca'y%ca(y%ca!]%ca#`%ca~Og%ca$O%ca~P#MnO!]fX!gfX!kfX!k$zX(rfX~P!0SOp%WO![/mO!](^O(T/lO!Y(vP!Y)PP~P!1uOr*sO!b*qO!c*kO!d*kO!l*bO#[*rO%`*mO(U!lO(VTO(YUO~Os<}O!S/nO![+[O!^*pO(e<|O!^(xP~P$ [O!k/oO~P#/sO!]/pO!g#vO(r'pO!k)OX~O!k/uO~OnoX!QoX'yoX(yoX(zoX~O!g#vO!koX~P$#OOp/wO!S%hO![*^O!_%iO(T%gO!k)OP~O#k/xO~O!Y$zX!]$zX!g%RX~P!0SO!]/yO!Y)PX~P#/sO!g/{O~O!Y/}O~OpkO(T0OO~P.iOh%VOr0TO!g#vO!l%eO(r'pO~O!g+iO~Oa%nO!]0XO'z%nO~O!^0ZO~P!5iO!c0[O!d0[O(U!lO~P#$`Os!nO!S0]O(VTO(YUO(e!mO~O#[0_O~Og%aa!]%aa#`%aa$O%aa~P!1WOg%ca!]%ca#`%ca$O%ca~P!1WOj%dOk%dOl%dO(T&ZOg'mX!]'mX~O!]*yOg(^a~Og0hO~On0jO#`0iOg(_a!](_a~OR0kO!Q0kO!S0lO#S$dOn}a'y}a(y}a(z}a!]}a#`}a~Og}a$O}a~P$(cO!Q*OO'y*POn$sa(y$sa(z$sa!]$sa#`$sa~Og$sa$O$sa~P$)_O!Q*OO'y*POn$ua(y$ua(z$ua!]$ua#`$ua~Og$ua$O$ua~P$*QO#k0oO~Og%Ta!]%Ta#`%Ta$O%Ta~P!1WO!g#vO~O#k0rO~O!]+^Oa)Ta'z)Ta~OR#zO!Q#yO!S#{O!l#xO(aVOP!ri[!rij!rir!ri!]!ri!p!ri#R!ri#n!ri#o!ri#p!ri#q!ri#r!ri#s!ri#t!ri#u!ri#v!ri#x!ri#z!ri#{!ri(r!ri(y!ri(z!ri~Oa!ri'z!ri'w!ri!Y!ri!k!riv!ri!_!ri%i!ri!g!ri~P$+oOh%VOr%XOs$tOt$tOz%YO|%ZO!O<sO!S${O!_$|O!i>VO!l$xO#j<yO$W%`O$t<uO$v<wO$y%aO(VTO(YUO(a$uO(y$}O(z%PO~Op0{O%]0|O(T0zO~P$.VO!g+iOa(]a!_(]a'z(]a!](]a~O#k1SO~O[]X!]fX!^fX~O!]1TO!^)XX~O!^1VO~O[1WO~Ob1YO(T+qO(VTO(YUO~O!_&PO(T%gO`'uX!]'uX~O!]+vO`)Wa~O!k1]O~P!:tO[1`O~O`1aO~O#`1fO~On1iO!_$|O~O(e(|O!^)UP~Oh%VOn1rO!_1oO%i1qO~O[1|O!]1zO!^)VX~O!^1}O~O`2POa%nO'z%nO~O(T#nO(VTO(YUO~O#S$dO#`$eO$Q$eOP(gXR(gX[(gXr(gX!Q(gX!S(gX!](gX!l(gX!p(gX#R(gX#n(gX#o(gX#p(gX#q(gX#r(gX#s(gX#t(gX#u(gX#v(gX#x(gX#z(gX#{(gX(a(gX(r(gX(y(gX(z(gX~Oj2SO&[2TOa(gX~P$3pOj2SO#`$eO&[2TO~Oa2VO~P%[Oa2XO~O&e2[OP&ciQ&ciS&ciY&cia&cid&cie&cil&cip&cir&cis&cit&ciz&ci|&ci!O&ci!S&ci!W&ci!X&ci!_&ci!i&ci!l&ci!o&ci!p&ci!q&ci!s&ci!u&ci!x&ci!|&ci$W&ci$n&ci%h&ci%j&ci%l&ci%m&ci%n&ci%q&ci%s&ci%v&ci%w&ci%y&ci&W&ci&^&ci&`&ci&b&ci&d&ci&g&ci&m&ci&s&ci&u&ci&w&ci&y&ci&{&ci'w&ci(T&ci(V&ci(Y&ci(a&ci(o&ci!^&cib&ci&j&ci~Ob2bO!^2`O&j2aO~P`O!_XO!l2dO~O&q,{OP&liQ&liS&liY&lia&lid&lie&lil&lip&lir&lis&lit&liz&li|&li!O&li!S&li!W&li!X&li!_&li!i&li!l&li!o&li!p&li!q&li!s&li!u&li!x&li!|&li$W&li$n&li%h&li%j&li%l&li%m&li%n&li%q&li%s&li%v&li%w&li%y&li&W&li&^&li&`&li&b&li&d&li&g&li&m&li&s&li&u&li&w&li&y&li&{&li'w&li(T&li(V&li(Y&li(a&li(o&li!^&li&e&lib&li&j&li~O!Y2jO~O!]!aa!^!aa~P#BwOs!nO!S!oO![2pO(e!mO!]'XX!^'XX~P@nO!]-]O!^(ia~O!]'_X!^'_X~P!9|O!]-`O!^(xa~O!^2wO~P'_Oa%nO#`3QO'z%nO~Oa%nO!g#vO#`3QO'z%nO~Oa%nO!g#vO!p3UO#`3QO'z%nO(r'pO~Oa%nO'z%nO~P!:tO!]$_Ov$qa~O!Y'Wi!]'Wi~P!:tO!](VO!Y(hi~O!](^O!Y(vi~O!Y(wi!](wi~P!:tO!](ti!k(tia(ti'z(ti~P!:tO#`3WO!](ti!k(tia(ti'z(ti~O!](jO!k(si~O!S%hO!_%iO!|]O#i3]O#j3[O(T%gO~O!S%hO!_%iO#j3[O(T%gO~On3dO!_'`O%i3cO~Oh%VOn3dO!_'`O%i3cO~O#k%aaP%aaR%aa[%aaa%aaj%aar%aa!S%aa!l%aa!p%aa#R%aa#n%aa#o%aa#p%aa#q%aa#r%aa#s%aa#t%aa#u%aa#v%aa#x%aa#z%aa#{%aa'z%aa(a%aa(r%aa!k%aa!Y%aa'w%aav%aa!_%aa%i%aa!g%aa~P#L{O#k%caP%caR%ca[%caa%caj%car%ca!S%ca!l%ca!p%ca#R%ca#n%ca#o%ca#p%ca#q%ca#r%ca#s%ca#t%ca#u%ca#v%ca#x%ca#z%ca#{%ca'z%ca(a%ca(r%ca!k%ca!Y%ca'w%cav%ca!_%ca%i%ca!g%ca~P#MnO#k%aaP%aaR%aa[%aaa%aaj%aar%aa!S%aa!]%aa!l%aa!p%aa#R%aa#n%aa#o%aa#p%aa#q%aa#r%aa#s%aa#t%aa#u%aa#v%aa#x%aa#z%aa#{%aa'z%aa(a%aa(r%aa!k%aa!Y%aa'w%aa#`%aav%aa!_%aa%i%aa!g%aa~P#/sO#k%caP%caR%ca[%caa%caj%car%ca!S%ca!]%ca!l%ca!p%ca#R%ca#n%ca#o%ca#p%ca#q%ca#r%ca#s%ca#t%ca#u%ca#v%ca#x%ca#z%ca#{%ca'z%ca(a%ca(r%ca!k%ca!Y%ca'w%ca#`%cav%ca!_%ca%i%ca!g%ca~P#/sO#k}aP}a[}aa}aj}ar}a!l}a!p}a#R}a#n}a#o}a#p}a#q}a#r}a#s}a#t}a#u}a#v}a#x}a#z}a#{}a'z}a(a}a(r}a!k}a!Y}a'w}av}a!_}a%i}a!g}a~P$(cO#k$saP$saR$sa[$saa$saj$sar$sa!S$sa!l$sa!p$sa#R$sa#n$sa#o$sa#p$sa#q$sa#r$sa#s$sa#t$sa#u$sa#v$sa#x$sa#z$sa#{$sa'z$sa(a$sa(r$sa!k$sa!Y$sa'w$sav$sa!_$sa%i$sa!g$sa~P$)_O#k$uaP$uaR$ua[$uaa$uaj$uar$ua!S$ua!l$ua!p$ua#R$ua#n$ua#o$ua#p$ua#q$ua#r$ua#s$ua#t$ua#u$ua#v$ua#x$ua#z$ua#{$ua'z$ua(a$ua(r$ua!k$ua!Y$ua'w$uav$ua!_$ua%i$ua!g$ua~P$*QO#k%TaP%TaR%Ta[%Taa%Taj%Tar%Ta!S%Ta!]%Ta!l%Ta!p%Ta#R%Ta#n%Ta#o%Ta#p%Ta#q%Ta#r%Ta#s%Ta#t%Ta#u%Ta#v%Ta#x%Ta#z%Ta#{%Ta'z%Ta(a%Ta(r%Ta!k%Ta!Y%Ta'w%Ta#`%Tav%Ta!_%Ta%i%Ta!g%Ta~P#/sOa#cq!]#cq'z#cq'w#cq!Y#cq!k#cqv#cq!_#cq%i#cq!g#cq~P!:tO![3lO!]'YX!k'YX~P%[O!].tO!k(ka~O!].tO!k(ka~P!:tO!Y3oO~O$O!na!^!na~PKlO$O!ja!]!ja!^!ja~P#BwO$O!ra!^!ra~P!=[O$O!ta!^!ta~P!?rOg']X!]']X~P!,TO!]/POg(pa~OSfO!_4TO$d4UO~O!^4YO~Ov4ZO~P#/sOa$mq!]$mq'z$mq'w$mq!Y$mq!k$mqv$mq!_$mq%i$mq!g$mq~P!:tO!Y4]O~P!&zO!S4^O~O!Q*OO'y*PO(z%POn'ia(y'ia!]'ia#`'ia~Og'ia$O'ia~P%-fO!Q*OO'y*POn'ka(y'ka(z'ka!]'ka#`'ka~Og'ka$O'ka~P%.XO(r$YO~P#/sO!YfX!Y$zX!]fX!]$zX!g%RX#`fX~P!0SOp%WO(T=WO~P!1uOp4bO!S%hO![4aO!_%iO(T%gO!]'eX!k'eX~O!]/pO!k)Oa~O!]/pO!g#vO!k)Oa~O!]/pO!g#vO(r'pO!k)Oa~Og$|i!]$|i#`$|i$O$|i~P!1WO![4jO!Y'gX!]'gX~P!3tO!]/yO!Y)Pa~O!]/yO!Y)Pa~P#/sOP]XR]X[]Xj]Xr]X!Q]X!S]X!Y]X!]]X!l]X!p]X#R]X#S]X#`]X#kfX#n]X#o]X#p]X#q]X#r]X#s]X#t]X#u]X#v]X#x]X#z]X#{]X$Q]X(a]X(r]X(y]X(z]X~Oj%YX!g%YX~P%2OOj4oO!g#vO~Oh%VO!g#vO!l%eO~Oh%VOr4tO!l%eO(r'pO~Or4yO!g#vO(r'pO~Os!nO!S4zO(VTO(YUO(e!mO~O(y$}On%ai!Q%ai'y%ai(z%ai!]%ai#`%ai~Og%ai$O%ai~P%5oO(z%POn%ci!Q%ci'y%ci(y%ci!]%ci#`%ci~Og%ci$O%ci~P%6bOg(_i!](_i~P!1WO#`5QOg(_i!](_i~P!1WO!k5VO~Oa$oq!]$oq'z$oq'w$oq!Y$oq!k$oqv$oq!_$oq%i$oq!g$oq~P!:tO!Y5ZO~O!]5[O!_)QX~P#/sOa$zX!_$zX%^]X'z$zX!]$zX~P!0SO%^5_OaoX!_oX'zoX!]oX~P$#OOp5`O(T#nO~O%^5_O~Ob5fO%j5gO(T+qO(VTO(YUO!]'tX!^'tX~O!]1TO!^)Xa~O[5kO~O`5lO~O[5pO~Oa%nO'z%nO~P#/sO!]5uO#`5wO!^)UX~O!^5xO~Or6OOs!nO!S*iO!b!yO!c!vO!d!vO!|<VO#T!pO#U!pO#V!pO#W!pO#X!pO#[5}O#]!zO(U!lO(VTO(YUO(e!mO(o!sO~O!^5|O~P%;eOn6TO!_1oO%i6SO~Oh%VOn6TO!_1oO%i6SO~Ob6[O(T#nO(VTO(YUO!]'sX!^'sX~O!]1zO!^)Va~O(VTO(YUO(e6^O~O`6bO~Oj6eO&[6fO~PNXO!k6gO~P%[Oa6iO~Oa6iO~P%[Ob2bO!^6nO&j2aO~P`O!g6pO~O!g6rOh(ji!](ji!^(ji!g(ji!l(jir(ji(r(ji~O!]#hi!^#hi~P#BwO#`6sO!]#hi!^#hi~O!]!ai!^!ai~P#BwOa%nO#`6|O'z%nO~Oa%nO!g#vO#`6|O'z%nO~O!](tq!k(tqa(tq'z(tq~P!:tO!](jO!k(sq~O!S%hO!_%iO#j7TO(T%gO~O!_'`O%i7WO~On7[O!_'`O%i7WO~O#k'iaP'iaR'ia['iaa'iaj'iar'ia!S'ia!l'ia!p'ia#R'ia#n'ia#o'ia#p'ia#q'ia#r'ia#s'ia#t'ia#u'ia#v'ia#x'ia#z'ia#{'ia'z'ia(a'ia(r'ia!k'ia!Y'ia'w'iav'ia!_'ia%i'ia!g'ia~P%-fO#k'kaP'kaR'ka['kaa'kaj'kar'ka!S'ka!l'ka!p'ka#R'ka#n'ka#o'ka#p'ka#q'ka#r'ka#s'ka#t'ka#u'ka#v'ka#x'ka#z'ka#{'ka'z'ka(a'ka(r'ka!k'ka!Y'ka'w'kav'ka!_'ka%i'ka!g'ka~P%.XO#k$|iP$|iR$|i[$|ia$|ij$|ir$|i!S$|i!]$|i!l$|i!p$|i#R$|i#n$|i#o$|i#p$|i#q$|i#r$|i#s$|i#t$|i#u$|i#v$|i#x$|i#z$|i#{$|i'z$|i(a$|i(r$|i!k$|i!Y$|i'w$|i#`$|iv$|i!_$|i%i$|i!g$|i~P#/sO#k%aiP%aiR%ai[%aia%aij%air%ai!S%ai!l%ai!p%ai#R%ai#n%ai#o%ai#p%ai#q%ai#r%ai#s%ai#t%ai#u%ai#v%ai#x%ai#z%ai#{%ai'z%ai(a%ai(r%ai!k%ai!Y%ai'w%aiv%ai!_%ai%i%ai!g%ai~P%5oO#k%ciP%ciR%ci[%cia%cij%cir%ci!S%ci!l%ci!p%ci#R%ci#n%ci#o%ci#p%ci#q%ci#r%ci#s%ci#t%ci#u%ci#v%ci#x%ci#z%ci#{%ci'z%ci(a%ci(r%ci!k%ci!Y%ci'w%civ%ci!_%ci%i%ci!g%ci~P%6bO!]'Ya!k'Ya~P!:tO!].tO!k(ki~O$O#ci!]#ci!^#ci~P#BwOP$[OR#zO!Q#yO!S#{O!l#xO!p$[O(aVO[#mij#mir#mi#R#mi#o#mi#p#mi#q#mi#r#mi#s#mi#t#mi#u#mi#v#mi#x#mi#z#mi#{#mi$O#mi(r#mi(y#mi(z#mi!]#mi!^#mi~O#n#mi~P%NdO#n<_O~P%NdOP$[OR#zOr<kO!Q#yO!S#{O!l#xO!p$[O#n<_O#o<`O#p<`O#q<`O(aVO[#mij#mi#R#mi#s#mi#t#mi#u#mi#v#mi#x#mi#z#mi#{#mi$O#mi(r#mi(y#mi(z#mi!]#mi!^#mi~O#r#mi~P&!lO#r<aO~P&!lOP$[OR#zO[<mOj<bOr<kO!Q#yO!S#{O!l#xO!p$[O#R<bO#n<_O#o<`O#p<`O#q<`O#r<aO#s<bO#t<bO#u<lO(aVO#x#mi#z#mi#{#mi$O#mi(r#mi(y#mi(z#mi!]#mi!^#mi~O#v#mi~P&$tOP$[OR#zO[<mOj<bOr<kO!Q#yO!S#{O!l#xO!p$[O#R<bO#n<_O#o<`O#p<`O#q<`O#r<aO#s<bO#t<bO#u<lO#v<cO(aVO(z#}O#z#mi#{#mi$O#mi(r#mi(y#mi!]#mi!^#mi~O#x<eO~P&&uO#x#mi~P&&uO#v<cO~P&$tOP$[OR#zO[<mOj<bOr<kO!Q#yO!S#{O!l#xO!p$[O#R<bO#n<_O#o<`O#p<`O#q<`O#r<aO#s<bO#t<bO#u<lO#v<cO#x<eO(aVO(y#|O(z#}O#{#mi$O#mi(r#mi!]#mi!^#mi~O#z#mi~P&)UO#z<gO~P&)UOa#|y!]#|y'z#|y'w#|y!Y#|y!k#|yv#|y!_#|y%i#|y!g#|y~P!:tO[#mij#mir#mi#R#mi#r#mi#s#mi#t#mi#u#mi#v#mi#x#mi#z#mi#{#mi$O#mi(r#mi!]#mi!^#mi~OP$[OR#zO!Q#yO!S#{O!l#xO!p$[O#n<_O#o<`O#p<`O#q<`O(aVO(y#mi(z#mi~P&,QOn>^O!Q*OO'y*PO(y$}O(z%POP#miR#mi!S#mi!l#mi!p#mi#n#mi#o#mi#p#mi#q#mi(a#mi~P&,QO#S$dOP(`XR(`X[(`Xj(`Xn(`Xr(`X!Q(`X!S(`X!l(`X!p(`X#R(`X#n(`X#o(`X#p(`X#q(`X#r(`X#s(`X#t(`X#u(`X#v(`X#x(`X#z(`X#{(`X$O(`X'y(`X(a(`X(r(`X(y(`X(z(`X!](`X!^(`X~O$O$Pi!]$Pi!^$Pi~P#BwO$O!ri!^!ri~P$+oOg']a!]']a~P!1WO!^7nO~O!]'da!^'da~P#BwO!Y7oO~P#/sO!g#vO(r'pO!]'ea!k'ea~O!]/pO!k)Oi~O!]/pO!g#vO!k)Oi~Og$|q!]$|q#`$|q$O$|q~P!1WO!Y'ga!]'ga~P#/sO!g7vO~O!]/yO!Y)Pi~P#/sO!]/yO!Y)Pi~O!Y7yO~Oh%VOr8OO!l%eO(r'pO~Oj8QO!g#vO~Or8TO!g#vO(r'pO~O!Q*OO'y*PO(z%POn'ja(y'ja!]'ja#`'ja~Og'ja$O'ja~P&5RO!Q*OO'y*POn'la(y'la(z'la!]'la#`'la~Og'la$O'la~P&5tOg(_q!](_q~P!1WO#`8VOg(_q!](_q~P!1WO!Y8WO~Og%Oq!]%Oq#`%Oq$O%Oq~P!1WOa$oy!]$oy'z$oy'w$oy!Y$oy!k$oyv$oy!_$oy%i$oy!g$oy~P!:tO!g6rO~O!]5[O!_)Qa~O!_'`OP$TaR$Ta[$Taj$Tar$Ta!Q$Ta!S$Ta!]$Ta!l$Ta!p$Ta#R$Ta#n$Ta#o$Ta#p$Ta#q$Ta#r$Ta#s$Ta#t$Ta#u$Ta#v$Ta#x$Ta#z$Ta#{$Ta(a$Ta(r$Ta(y$Ta(z$Ta~O%i7WO~P&8fO%^8[Oa%[i!_%[i'z%[i!]%[i~Oa#cy!]#cy'z#cy'w#cy!Y#cy!k#cyv#cy!_#cy%i#cy!g#cy~P!:tO[8^O~Ob8`O(T+qO(VTO(YUO~O!]1TO!^)Xi~O`8dO~O(e(|O!]'pX!^'pX~O!]5uO!^)Ua~O!^8nO~P%;eO(o!sO~P$&YO#[8oO~O!_1oO~O!_1oO%i8qO~On8tO!_1oO%i8qO~O[8yO!]'sa!^'sa~O!]1zO!^)Vi~O!k8}O~O!k9OO~O!k9RO~O!k9RO~P%[Oa9TO~O!g9UO~O!k9VO~O!](wi!^(wi~P#BwOa%nO#`9_O'z%nO~O!](ty!k(tya(ty'z(ty~P!:tO!](jO!k(sy~O%i9bO~P&8fO!_'`O%i9bO~O#k$|qP$|qR$|q[$|qa$|qj$|qr$|q!S$|q!]$|q!l$|q!p$|q#R$|q#n$|q#o$|q#p$|q#q$|q#r$|q#s$|q#t$|q#u$|q#v$|q#x$|q#z$|q#{$|q'z$|q(a$|q(r$|q!k$|q!Y$|q'w$|q#`$|qv$|q!_$|q%i$|q!g$|q~P#/sO#k'jaP'jaR'ja['jaa'jaj'jar'ja!S'ja!l'ja!p'ja#R'ja#n'ja#o'ja#p'ja#q'ja#r'ja#s'ja#t'ja#u'ja#v'ja#x'ja#z'ja#{'ja'z'ja(a'ja(r'ja!k'ja!Y'ja'w'jav'ja!_'ja%i'ja!g'ja~P&5RO#k'laP'laR'la['laa'laj'lar'la!S'la!l'la!p'la#R'la#n'la#o'la#p'la#q'la#r'la#s'la#t'la#u'la#v'la#x'la#z'la#{'la'z'la(a'la(r'la!k'la!Y'la'w'lav'la!_'la%i'la!g'la~P&5tO#k%OqP%OqR%Oq[%Oqa%Oqj%Oqr%Oq!S%Oq!]%Oq!l%Oq!p%Oq#R%Oq#n%Oq#o%Oq#p%Oq#q%Oq#r%Oq#s%Oq#t%Oq#u%Oq#v%Oq#x%Oq#z%Oq#{%Oq'z%Oq(a%Oq(r%Oq!k%Oq!Y%Oq'w%Oq#`%Oqv%Oq!_%Oq%i%Oq!g%Oq~P#/sO!]'Yi!k'Yi~P!:tO$O#cq!]#cq!^#cq~P#BwO(y$}OP%aaR%aa[%aaj%aar%aa!S%aa!l%aa!p%aa#R%aa#n%aa#o%aa#p%aa#q%aa#r%aa#s%aa#t%aa#u%aa#v%aa#x%aa#z%aa#{%aa$O%aa(a%aa(r%aa!]%aa!^%aa~On%aa!Q%aa'y%aa(z%aa~P&IyO(z%POP%caR%ca[%caj%car%ca!S%ca!l%ca!p%ca#R%ca#n%ca#o%ca#p%ca#q%ca#r%ca#s%ca#t%ca#u%ca#v%ca#x%ca#z%ca#{%ca$O%ca(a%ca(r%ca!]%ca!^%ca~On%ca!Q%ca'y%ca(y%ca~P&LQOn>^O!Q*OO'y*PO(z%PO~P&IyOn>^O!Q*OO'y*PO(y$}O~P&LQOR0kO!Q0kO!S0lO#S$dOP}a[}aj}an}ar}a!l}a!p}a#R}a#n}a#o}a#p}a#q}a#r}a#s}a#t}a#u}a#v}a#x}a#z}a#{}a$O}a'y}a(a}a(r}a(y}a(z}a!]}a!^}a~O!Q*OO'y*POP$saR$sa[$saj$san$sar$sa!S$sa!l$sa!p$sa#R$sa#n$sa#o$sa#p$sa#q$sa#r$sa#s$sa#t$sa#u$sa#v$sa#x$sa#z$sa#{$sa$O$sa(a$sa(r$sa(y$sa(z$sa!]$sa!^$sa~O!Q*OO'y*POP$uaR$ua[$uaj$uan$uar$ua!S$ua!l$ua!p$ua#R$ua#n$ua#o$ua#p$ua#q$ua#r$ua#s$ua#t$ua#u$ua#v$ua#x$ua#z$ua#{$ua$O$ua(a$ua(r$ua(y$ua(z$ua!]$ua!^$ua~On>^O!Q*OO'y*PO(y$}O(z%PO~OP%TaR%Ta[%Taj%Tar%Ta!S%Ta!l%Ta!p%Ta#R%Ta#n%Ta#o%Ta#p%Ta#q%Ta#r%Ta#s%Ta#t%Ta#u%Ta#v%Ta#x%Ta#z%Ta#{%Ta$O%Ta(a%Ta(r%Ta!]%Ta!^%Ta~P''VO$O$mq!]$mq!^$mq~P#BwO$O$oq!]$oq!^$oq~P#BwO!^9oO~O$O9pO~P!1WO!g#vO!]'ei!k'ei~O!g#vO(r'pO!]'ei!k'ei~O!]/pO!k)Oq~O!Y'gi!]'gi~P#/sO!]/yO!Y)Pq~Or9wO!g#vO(r'pO~O[9yO!Y9xO~P#/sO!Y9xO~Oj:PO!g#vO~Og(_y!](_y~P!1WO!]'na!_'na~P#/sOa%[q!_%[q'z%[q!]%[q~P#/sO[:UO~O!]1TO!^)Xq~O`:YO~O#`:ZO!]'pa!^'pa~O!]5uO!^)Ui~P#BwO!S:]O~O!_1oO%i:`O~O(VTO(YUO(e:eO~O!]1zO!^)Vq~O!k:hO~O!k:iO~O!k:jO~O!k:jO~P%[O#`:mO!]#hy!^#hy~O!]#hy!^#hy~P#BwO%i:rO~P&8fO!_'`O%i:rO~O$O#|y!]#|y!^#|y~P#BwOP$|iR$|i[$|ij$|ir$|i!S$|i!l$|i!p$|i#R$|i#n$|i#o$|i#p$|i#q$|i#r$|i#s$|i#t$|i#u$|i#v$|i#x$|i#z$|i#{$|i$O$|i(a$|i(r$|i!]$|i!^$|i~P''VO!Q*OO'y*PO(z%POP'iaR'ia['iaj'ian'iar'ia!S'ia!l'ia!p'ia#R'ia#n'ia#o'ia#p'ia#q'ia#r'ia#s'ia#t'ia#u'ia#v'ia#x'ia#z'ia#{'ia$O'ia(a'ia(r'ia(y'ia!]'ia!^'ia~O!Q*OO'y*POP'kaR'ka['kaj'kan'kar'ka!S'ka!l'ka!p'ka#R'ka#n'ka#o'ka#p'ka#q'ka#r'ka#s'ka#t'ka#u'ka#v'ka#x'ka#z'ka#{'ka$O'ka(a'ka(r'ka(y'ka(z'ka!]'ka!^'ka~O(y$}OP%aiR%ai[%aij%ain%air%ai!Q%ai!S%ai!l%ai!p%ai#R%ai#n%ai#o%ai#p%ai#q%ai#r%ai#s%ai#t%ai#u%ai#v%ai#x%ai#z%ai#{%ai$O%ai'y%ai(a%ai(r%ai(z%ai!]%ai!^%ai~O(z%POP%ciR%ci[%cij%cin%cir%ci!Q%ci!S%ci!l%ci!p%ci#R%ci#n%ci#o%ci#p%ci#q%ci#r%ci#s%ci#t%ci#u%ci#v%ci#x%ci#z%ci#{%ci$O%ci'y%ci(a%ci(r%ci(y%ci!]%ci!^%ci~O$O$oy!]$oy!^$oy~P#BwO$O#cy!]#cy!^#cy~P#BwO!g#vO!]'eq!k'eq~O!]/pO!k)Oy~O!Y'gq!]'gq~P#/sOr:|O!g#vO(r'pO~O[;QO!Y;PO~P#/sO!Y;PO~Og(_!R!](_!R~P!1WOa%[y!_%[y'z%[y!]%[y~P#/sO!]1TO!^)Xy~O!]5uO!^)Uq~O(T;XO~O!_1oO%i;[O~O!k;_O~O%i;dO~P&8fOP$|qR$|q[$|qj$|qr$|q!S$|q!l$|q!p$|q#R$|q#n$|q#o$|q#p$|q#q$|q#r$|q#s$|q#t$|q#u$|q#v$|q#x$|q#z$|q#{$|q$O$|q(a$|q(r$|q!]$|q!^$|q~P''VO!Q*OO'y*PO(z%POP'jaR'ja['jaj'jan'jar'ja!S'ja!l'ja!p'ja#R'ja#n'ja#o'ja#p'ja#q'ja#r'ja#s'ja#t'ja#u'ja#v'ja#x'ja#z'ja#{'ja$O'ja(a'ja(r'ja(y'ja!]'ja!^'ja~O!Q*OO'y*POP'laR'la['laj'lan'lar'la!S'la!l'la!p'la#R'la#n'la#o'la#p'la#q'la#r'la#s'la#t'la#u'la#v'la#x'la#z'la#{'la$O'la(a'la(r'la(y'la(z'la!]'la!^'la~OP%OqR%Oq[%Oqj%Oqr%Oq!S%Oq!l%Oq!p%Oq#R%Oq#n%Oq#o%Oq#p%Oq#q%Oq#r%Oq#s%Oq#t%Oq#u%Oq#v%Oq#x%Oq#z%Oq#{%Oq$O%Oq(a%Oq(r%Oq!]%Oq!^%Oq~P''VOg%e!Z!]%e!Z#`%e!Z$O%e!Z~P!1WO!Y;hO~P#/sOr;iO!g#vO(r'pO~O[;kO!Y;hO~P#/sO!]'pq!^'pq~P#BwO!]#h!Z!^#h!Z~P#BwO#k%e!ZP%e!ZR%e!Z[%e!Za%e!Zj%e!Zr%e!Z!S%e!Z!]%e!Z!l%e!Z!p%e!Z#R%e!Z#n%e!Z#o%e!Z#p%e!Z#q%e!Z#r%e!Z#s%e!Z#t%e!Z#u%e!Z#v%e!Z#x%e!Z#z%e!Z#{%e!Z'z%e!Z(a%e!Z(r%e!Z!k%e!Z!Y%e!Z'w%e!Z#`%e!Zv%e!Z!_%e!Z%i%e!Z!g%e!Z~P#/sOr;tO!g#vO(r'pO~O!Y;uO~P#/sOr;|O!g#vO(r'pO~O!Y;}O~P#/sOP%e!ZR%e!Z[%e!Zj%e!Zr%e!Z!S%e!Z!l%e!Z!p%e!Z#R%e!Z#n%e!Z#o%e!Z#p%e!Z#q%e!Z#r%e!Z#s%e!Z#t%e!Z#u%e!Z#v%e!Z#x%e!Z#z%e!Z#{%e!Z$O%e!Z(a%e!Z(r%e!Z!]%e!Z!^%e!Z~P''VOr<QO!g#vO(r'pO~Ov(fX~P1qO!Q%rO~P!)[O(U!lO~P!)[O!YfX!]fX#`fX~P%2OOP]XR]X[]Xj]Xr]X!Q]X!S]X!]]X!]fX!l]X!p]X#R]X#S]X#`]X#`fX#kfX#n]X#o]X#p]X#q]X#r]X#s]X#t]X#u]X#v]X#x]X#z]X#{]X$Q]X(a]X(r]X(y]X(z]X~O!gfX!k]X!kfX(rfX~P'LTOP<UOQ<UOSfOd>ROe!iOpkOr<UOskOtkOzkO|<UO!O<UO!SWO!WkO!XkO!_XO!i<XO!lZO!o<UO!p<UO!q<UO!s<YO!u<]O!x!hO$W!kO$n>PO(T)]O(VTO(YUO(aVO(o[O~O!]<iO!^$qa~Oh%VOp%WOr%XOs$tOt$tOz%YO|%ZO!O<tO!S${O!_$|O!i>WO!l$xO#j<zO$W%`O$t<vO$v<xO$y%aO(T(vO(VTO(YUO(a$uO(y$}O(z%PO~Ol)dO~P(!yOr!eX(r!eX~P#!iOr(jX(r(jX~P##[O!^]X!^fX~P'LTO!YfX!Y$zX!]fX!]$zX#`fX~P!0SO#k<^O~O!g#vO#k<^O~O#`<nO~Oj<bO~O#`=OO!](wX!^(wX~O#`<nO!](uX!^(uX~O#k=PO~Og=RO~P!1WO#k=XO~O#k=YO~Og=RO(T&ZO~O!g#vO#k=ZO~O!g#vO#k=PO~O$O=[O~P#BwO#k=]O~O#k=^O~O#k=cO~O#k=dO~O#k=eO~O#k=fO~O$O=gO~P!1WO$O=hO~P!1WOl=sO~P7eOk#S#T#U#W#X#[#i#j#u$n$t$v$y%]%^%h%i%j%q%s%v%w%y%{~(OT#o!X'|(U#ps#n#qr!Q'}$]'}(T$_(e~",goto:"$9Y)]PPPPPP)^PP)aP)rP+W/]PPPP6mPP7TPP=QPPP@tPA^PA^PPPA^PCfPA^PA^PA^PCjPCoPD^PIWPPPI[PPPPI[L_PPPLeMVPI[PI[PP! eI[PPPI[PI[P!#lI[P!'S!(X!(bP!)U!)Y!)U!,gPPPPPPP!-W!(XPP!-h!/YP!2iI[I[!2n!5z!:h!:h!>gPPP!>oI[PPPPPPPPP!BOP!C]PPI[!DnPI[PI[I[I[I[I[PI[!FQP!I[P!LbP!Lf!Lp!Lt!LtP!IXP!Lx!LxP#!OP#!SI[PI[#!Y#%_CjA^PA^PA^A^P#&lA^A^#)OA^#+vA^#.SA^A^#.r#1W#1W#1]#1f#1W#1qPP#1WPA^#2ZA^#6YA^A^6mPPP#:_PPP#:x#:xP#:xP#;`#:xPP#;fP#;]P#;]#;y#;]#<e#<k#<n)aP#<q)aP#<z#<z#<zP)aP)aP)aP)aPP)aP#=Q#=TP#=T)aP#=XP#=[P)aP)aP)aP)aP)aP)a)aPP#=b#=h#=s#=y#>P#>V#>]#>k#>q#>{#?R#?]#?c#?s#?y#@k#@}#AT#AZ#Ai#BO#Cs#DR#DY#Et#FS#Gt#HS#HY#H`#Hf#Hp#Hv#H|#IW#Ij#IpPPPPPPPPPPP#IvPPPPPPP#Jk#Mx$ b$ i$ qPPP$']P$'f$*_$0x$0{$1O$1}$2Q$2X$2aP$2g$2jP$3W$3[$4S$5b$5g$5}PP$6S$6Y$6^$6a$6e$6i$7e$7|$8e$8i$8l$8o$8y$8|$9Q$9UR!|RoqOXst!Z#d%m&r&t&u&w,s,x2[2_Y!vQ'`-e1o5{Q%tvQ%|yQ&T|Q&j!VS'W!e-]Q'f!iS'l!r!yU*k$|*Z*oQ+o%}S+|&V&WQ,d&dQ-c'_Q-m'gQ-u'mQ0[*qQ1b,OQ1y,eR<{<Y%SdOPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$_$a$e%m%t&R&k&n&r&t&u&w&{'T'b'r(T(V(](d(x(z)O)}*i+X+],p,s,x-i-q.P.V.t.{/n0]0l0r1S1r2S2T2V2X2[2_2a3Q3W3l4z6T6e6f6i6|8t9T9_S#q]<V!r)_$Z$n'X)s-U-X/V2p4T5w6s:Z:m<U<X<Y<]<^<_<`<a<b<c<d<e<f<g<h<i<k<n<{=O=P=R=Z=[=e=f>SU+P%]<s<tQ+t&PQ,f&gQ,m&oQ0x+gQ0}+iQ1Y+uQ2R,kQ3`.gQ5`0|Q5f1TQ6[1zQ7Y3dQ8`5gR9e7['QkOPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$Z$_$a$e$n%m%t&R&k&n&o&r&t&u&w&{'T'X'b'r(T(V(](d(x(z)O)s)}*i+X+]+g,p,s,x-U-X-i-q.P.V.g.t.{/V/n0]0l0r1S1r2S2T2V2X2[2_2a2p3Q3W3d3l4T4z5w6T6e6f6i6s6|7[8t9T9_:Z:m<U<X<Y<]<^<_<`<a<b<c<d<e<f<g<h<i<k<n<{=O=P=R=Z=[=e=f>S!S!nQ!r!v!y!z$|'W'_'`'l'm'n*k*o*q*r-]-c-e-u0[0_1o5{5}%[$ti#v$b$c$d$x${%O%Q%^%_%c)y*R*T*V*Y*a*g*w*x+f+i,S,V.f/P/d/m/x/y/{0`0b0i0j0o1f1i1q3c4^4_4j4o5Q5[5_6S7W7v8Q8V8[8q9b9p9y:P:`:r;Q;[;d;k<l<m<o<p<q<r<u<v<w<x<y<z=S=T=U=V=X=Y=]=^=_=`=a=b=c=d=g=h>P>X>Y>]>^Q&X|Q'U!eS'[%i-`Q+t&PQ,P&WQ,f&gQ0n+SQ1Y+uQ1_+{Q2Q,jQ2R,kQ5f1TQ5o1aQ6[1zQ6_1|Q6`2PQ8`5gQ8c5lQ8|6bQ:X8dQ:f8yQ;V:YR<}*ZrnOXst!V!Z#d%m&i&r&t&u&w,s,x2[2_R,h&k&z^OPXYstuvwz!Z!`!g!j!o#S#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$Z$_$a$e$n%m%t&R&k&n&o&r&t&u&w&{'T'b'r(V(](d(x(z)O)s)}*i+X+]+g,p,s,x-U-X-i-q.P.V.g.t.{/V/n0]0l0r1S1r2S2T2V2X2[2_2a2p3Q3W3d3l4T4z5w6T6e6f6i6s6|7[8t9T9_:Z:m<U<X<Y<]<^<_<`<a<b<c<d<e<f<g<h<i<k<n<{=O=P=R=Z=[=e=f>R>S[#]WZ#W#Z'X(T!b%jm#h#i#l$x%e%h(^(h(i(j*Y*^*b+Z+[+^,o-V.T.Z.[.]._/m/p2d3[3]4a6r7TQ%wxQ%{yW&Q|&V&W,OQ&_!TQ'c!hQ'e!iQ(q#sS+n%|%}Q+r&PQ,_&bQ,c&dS-l'f'gQ.i(rQ1R+oQ1X+uQ1Z+vQ1^+zQ1t,`S1x,d,eQ2|-mQ5e1TQ5i1WQ5n1`Q6Z1yQ8_5gQ8b5kQ8f5pQ:T8^R;T:U!U$zi$d%O%Q%^%_%c*R*T*a*w*x/P/x0`0b0i0j0o4_5Q8V9p>P>X>Y!^%yy!i!u%{%|%}'V'e'f'g'k'u*j+n+o-Y-l-m-t0R0U1R2u2|3T4r4s4v7}9{Q+h%wQ,T&[Q,W&]Q,b&dQ.h(qQ1s,_U1w,c,d,eQ3e.iQ6U1tS6Y1x1yQ8x6Z#f>T#v$b$c$x${)y*V*Y*g+f+i,S,V.f/d/m/y/{1f1i1q3c4^4j4o5[5_6S7W7v8Q8[8q9b9y:P:`:r;Q;[;d;k<o<q<u<w<y=S=U=X=]=_=a=c=g>]>^o>U<l<m<p<r<v<x<z=T=V=Y=^=`=b=d=hW%Ti%V*y>PS&[!Q&iQ&]!RQ&^!SU*}%[%d=sR,R&Y%]%Si#v$b$c$d$x${%O%Q%^%_%c)y*R*T*V*Y*a*g*w*x+f+i,S,V.f/P/d/m/x/y/{0`0b0i0j0o1f1i1q3c4^4_4j4o5Q5[5_6S7W7v8Q8V8[8q9b9p9y:P:`:r;Q;[;d;k<l<m<o<p<q<r<u<v<w<x<y<z=S=T=U=V=X=Y=]=^=_=`=a=b=c=d=g=h>P>X>Y>]>^T)z$u){V+P%]<s<tW'[!e%i*Z-`S(}#y#zQ+c%rQ+y&SS.b(m(nQ1j,XQ5T0kR8i5u'QkOPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$Z$_$a$e$n%m%t&R&k&n&o&r&t&u&w&{'T'X'b'r(T(V(](d(x(z)O)s)}*i+X+]+g,p,s,x-U-X-i-q.P.V.g.t.{/V/n0]0l0r1S1r2S2T2V2X2[2_2a2p3Q3W3d3l4T4z5w6T6e6f6i6s6|7[8t9T9_:Z:m<U<X<Y<]<^<_<`<a<b<c<d<e<f<g<h<i<k<n<{=O=P=R=Z=[=e=f>S$i$^c#Y#e%q%s%u(S(Y(t(y)R)S)T)U)V)W)X)Y)Z)[)^)`)b)g)q+d+x-Z-x-}.S.U.s.v.z.|.}/O/b0p2k2n3O3V3k3p3q3r3s3t3u3v3w3x3y3z3{3|4P4Q4X5X5c6u6{7Q7a7b7k7l8k9X9]9g9m9n:o;W;`<W=vT#TV#U'RkOPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$Z$_$a$e$n%m%t&R&k&n&o&r&t&u&w&{'T'X'b'r(T(V(](d(x(z)O)s)}*i+X+]+g,p,s,x-U-X-i-q.P.V.g.t.{/V/n0]0l0r1S1r2S2T2V2X2[2_2a2p3Q3W3d3l4T4z5w6T6e6f6i6s6|7[8t9T9_:Z:m<U<X<Y<]<^<_<`<a<b<c<d<e<f<g<h<i<k<n<{=O=P=R=Z=[=e=f>SQ'Y!eR2q-]!W!nQ!e!r!v!y!z$|'W'_'`'l'm'n*Z*k*o*q*r-]-c-e-u0[0_1o5{5}R1l,ZnqOXst!Z#d%m&r&t&u&w,s,x2[2_Q&y!^Q'v!xS(s#u<^Q+l%zQ,]&_Q,^&aQ-j'dQ-w'oS.r(x=PS0q+X=ZQ1P+mQ1n,[Q2c,zQ2e,{Q2m-WQ2z-kQ2}-oS5Y0r=eQ5a1QS5d1S=fQ6t2oQ6x2{Q6}3SQ8]5bQ9Y6vQ9Z6yQ9^7OR:l9V$d$]c#Y#e%s%u(S(Y(t(y)R)S)T)U)V)W)X)Y)Z)[)^)`)b)g)q+d+x-Z-x-}.S.U.s.v.z.}/O/b0p2k2n3O3V3k3p3q3r3s3t3u3v3w3x3y3z3{3|4P4Q4X5X5c6u6{7Q7a7b7k7l8k9X9]9g9m9n:o;W;`<W=vS(o#p'iQ)P#zS+b%q.|S.c(n(pR3^.d'QkOPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$Z$_$a$e$n%m%t&R&k&n&o&r&t&u&w&{'T'X'b'r(T(V(](d(x(z)O)s)}*i+X+]+g,p,s,x-U-X-i-q.P.V.g.t.{/V/n0]0l0r1S1r2S2T2V2X2[2_2a2p3Q3W3d3l4T4z5w6T6e6f6i6s6|7[8t9T9_:Z:m<U<X<Y<]<^<_<`<a<b<c<d<e<f<g<h<i<k<n<{=O=P=R=Z=[=e=f>SS#q]<VQ&t!XQ&u!YQ&w![Q&x!]R2Z,vQ'a!hQ+e%wQ-h'cS.e(q+hQ2x-gW3b.h.i0w0yQ6w2yW7U3_3a3e5^U9a7V7X7ZU:q9c9d9fS;b:p:sQ;p;cR;x;qU!wQ'`-eT5y1o5{!Q_OXZ`st!V!Z#d#h%e%m&i&k&r&t&u&w(j,s,x.[2[2_]!pQ!r'`-e1o5{T#q]<V%^{OPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$_$a$e%m%t&R&k&n&o&r&t&u&w&{'T'b'r(T(V(](d(x(z)O)}*i+X+]+g,p,s,x-i-q.P.V.g.t.{/n0]0l0r1S1r2S2T2V2X2[2_2a3Q3W3d3l4z6T6e6f6i6|7[8t9T9_S(}#y#zS.b(m(n!s=l$Z$n'X)s-U-X/V2p4T5w6s:Z:m<U<X<Y<]<^<_<`<a<b<c<d<e<f<g<h<i<k<n<{=O=P=R=Z=[=e=f>SU$fd)_,mS(p#p'iU*v%R(w4OU0m+O.n7gQ5^0xQ7V3`Q9d7YR:s9em!tQ!r!v!y!z'`'l'm'n-e-u1o5{5}Q't!uS(f#g2US-s'k'wQ/s*]Q0R*jQ3U-vQ4f/tQ4r0TQ4s0UQ4x0^Q7r4`S7}4t4vS8R4y4{Q9r7sQ9v7yQ9{8OQ:Q8TS:{9w9xS;g:|;PS;s;h;iS;{;t;uS<P;|;}R<S<QQ#wbQ's!uS(e#g2US(g#m+WQ+Y%fQ+j%xQ+p&OU-r'k't'wQ.W(fU/r*]*`/wQ0S*jQ0V*lQ1O+kQ1u,aS3R-s-vQ3Z.`S4e/s/tQ4n0PS4q0R0^Q4u0WQ6W1vQ7P3US7q4`4bQ7u4fU7|4r4x4{Q8P4wQ8v6XS9q7r7sQ9u7yQ9}8RQ:O8SQ:c8wQ:y9rS:z9v9xQ;S:QQ;^:dS;f:{;PS;r;g;hS;z;s;uS<O;{;}Q<R<PQ<T<SQ=o=jQ={=tR=|=uV!wQ'`-e%^aOPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$_$a$e%m%t&R&k&n&o&r&t&u&w&{'T'b'r(T(V(](d(x(z)O)}*i+X+]+g,p,s,x-i-q.P.V.g.t.{/n0]0l0r1S1r2S2T2V2X2[2_2a3Q3W3d3l4z6T6e6f6i6|7[8t9T9_S#wz!j!r=i$Z$n'X)s-U-X/V2p4T5w6s:Z:m<U<X<Y<]<^<_<`<a<b<c<d<e<f<g<h<i<k<n<{=O=P=R=Z=[=e=f>SR=o>R%^bOPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$_$a$e%m%t&R&k&n&o&r&t&u&w&{'T'b'r(T(V(](d(x(z)O)}*i+X+]+g,p,s,x-i-q.P.V.g.t.{/n0]0l0r1S1r2S2T2V2X2[2_2a3Q3W3d3l4z6T6e6f6i6|7[8t9T9_Q%fj!^%xy!i!u%{%|%}'V'e'f'g'k'u*j+n+o-Y-l-m-t0R0U1R2u2|3T4r4s4v7}9{S&Oz!jQ+k%yQ,a&dW1v,b,c,d,eU6X1w1x1yS8w6Y6ZQ:d8x!r=j$Z$n'X)s-U-X/V2p4T5w6s:Z:m<U<X<Y<]<^<_<`<a<b<c<d<e<f<g<h<i<k<n<{=O=P=R=Z=[=e=f>SQ=t>QR=u>R%QeOPXYstuvw!Z!`!g!o#S#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$_$a$e%m%t&R&k&n&r&t&u&w&{'T'b'r(V(](d(x(z)O)}*i+X+]+g,p,s,x-i-q.P.V.g.t.{/n0]0l0r1S1r2S2T2V2X2[2_2a3Q3W3d3l4z6T6e6f6i6|7[8t9T9_Y#bWZ#W#Z(T!b%jm#h#i#l$x%e%h(^(h(i(j*Y*^*b+Z+[+^,o-V.T.Z.[.]._/m/p2d3[3]4a6r7TQ,n&o!p=k$Z$n)s-U-X/V2p4T5w6s:Z:m<U<X<Y<]<^<_<`<a<b<c<d<e<f<g<h<i<k<n<{=O=P=R=Z=[=e=f>SR=n'XU']!e%i*ZR2s-`%SdOPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$_$a$e%m%t&R&k&n&r&t&u&w&{'T'b'r(T(V(](d(x(z)O)}*i+X+],p,s,x-i-q.P.V.t.{/n0]0l0r1S1r2S2T2V2X2[2_2a3Q3W3l4z6T6e6f6i6|8t9T9_!r)_$Z$n'X)s-U-X/V2p4T5w6s:Z:m<U<X<Y<]<^<_<`<a<b<c<d<e<f<g<h<i<k<n<{=O=P=R=Z=[=e=f>SQ,m&oQ0x+gQ3`.gQ7Y3dR9e7[!b$Tc#Y%q(S(Y(t(y)Z)[)`)g+x-x-}.S.U.s.v/b0p3O3V3k3{5X5c6{7Q7a9]:o<W!P<d)^)q-Z.|2k2n3p3y3z4P4X6u7b7k7l8k9X9g9m9n;W;`=v!f$Vc#Y%q(S(Y(t(y)W)X)Z)[)`)g+x-x-}.S.U.s.v/b0p3O3V3k3{5X5c6{7Q7a9]:o<W!T<f)^)q-Z.|2k2n3p3v3w3y3z4P4X6u7b7k7l8k9X9g9m9n;W;`=v!^$Zc#Y%q(S(Y(t(y)`)g+x-x-}.S.U.s.v/b0p3O3V3k3{5X5c6{7Q7a9]:o<WQ4_/kz>S)^)q-Z.|2k2n3p4P4X6u7b7k7l8k9X9g9m9n;W;`=vQ>X>ZR>Y>['QkOPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$Z$_$a$e$n%m%t&R&k&n&o&r&t&u&w&{'T'X'b'r(T(V(](d(x(z)O)s)}*i+X+]+g,p,s,x-U-X-i-q.P.V.g.t.{/V/n0]0l0r1S1r2S2T2V2X2[2_2a2p3Q3W3d3l4T4z5w6T6e6f6i6s6|7[8t9T9_:Z:m<U<X<Y<]<^<_<`<a<b<c<d<e<f<g<h<i<k<n<{=O=P=R=Z=[=e=f>SS$oh$pR4U/U'XgOPWXYZhstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$Z$_$a$e$n$p%m%t&R&k&n&o&r&t&u&w&{'T'X'b'r(T(V(](d(x(z)O)s)}*i+X+]+g,p,s,x-U-X-i-q.P.V.g.t.{/U/V/n0]0l0r1S1r2S2T2V2X2[2_2a2p3Q3W3d3l4T4z5w6T6e6f6i6s6|7[8t9T9_:Z:m<U<X<Y<]<^<_<`<a<b<c<d<e<f<g<h<i<k<n<{=O=P=R=Z=[=e=f>ST$kf$qQ$ifS)j$l)nR)v$qT$jf$qT)l$l)n'XhOPWXYZhstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$Z$_$a$e$n$p%m%t&R&k&n&o&r&t&u&w&{'T'X'b'r(T(V(](d(x(z)O)s)}*i+X+]+g,p,s,x-U-X-i-q.P.V.g.t.{/U/V/n0]0l0r1S1r2S2T2V2X2[2_2a2p3Q3W3d3l4T4z5w6T6e6f6i6s6|7[8t9T9_:Z:m<U<X<Y<]<^<_<`<a<b<c<d<e<f<g<h<i<k<n<{=O=P=R=Z=[=e=f>ST$oh$pQ$rhR)u$p%^jOPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$_$a$e%m%t&R&k&n&o&r&t&u&w&{'T'b'r(T(V(](d(x(z)O)}*i+X+]+g,p,s,x-i-q.P.V.g.t.{/n0]0l0r1S1r2S2T2V2X2[2_2a3Q3W3d3l4z6T6e6f6i6|7[8t9T9_!s>Q$Z$n'X)s-U-X/V2p4T5w6s:Z:m<U<X<Y<]<^<_<`<a<b<c<d<e<f<g<h<i<k<n<{=O=P=R=Z=[=e=f>S#glOPXZst!Z!`!o#S#d#o#{$n%m&k&n&o&r&t&u&w&{'T'b)O)s*i+]+g,p,s,x-i.g/V/n0]0l1r2S2T2V2X2[2_2a3d4T4z6T6e6f6i7[8t9T!U%Ri$d%O%Q%^%_%c*R*T*a*w*x/P/x0`0b0i0j0o4_5Q8V9p>P>X>Y#f(w#v$b$c$x${)y*V*Y*g+f+i,S,V.f/d/m/y/{1f1i1q3c4^4j4o5[5_6S7W7v8Q8[8q9b9y:P:`:r;Q;[;d;k<o<q<u<w<y=S=U=X=]=_=a=c=g>]>^Q+T%aQ/c*Oo4O<l<m<p<r<v<x<z=T=V=Y=^=`=b=d=h!U$yi$d%O%Q%^%_%c*R*T*a*w*x/P/x0`0b0i0j0o4_5Q8V9p>P>X>YQ*c$zU*l$|*Z*oQ+U%bQ0W*m#f=q#v$b$c$x${)y*V*Y*g+f+i,S,V.f/d/m/y/{1f1i1q3c4^4j4o5[5_6S7W7v8Q8[8q9b9y:P:`:r;Q;[;d;k<o<q<u<w<y=S=U=X=]=_=a=c=g>]>^n=r<l<m<p<r<v<x<z=T=V=Y=^=`=b=d=hQ=w>TQ=x>UQ=y>VR=z>W!U%Ri$d%O%Q%^%_%c*R*T*a*w*x/P/x0`0b0i0j0o4_5Q8V9p>P>X>Y#f(w#v$b$c$x${)y*V*Y*g+f+i,S,V.f/d/m/y/{1f1i1q3c4^4j4o5[5_6S7W7v8Q8[8q9b9y:P:`:r;Q;[;d;k<o<q<u<w<y=S=U=X=]=_=a=c=g>]>^o4O<l<m<p<r<v<x<z=T=V=Y=^=`=b=d=hnoOXst!Z#d%m&r&t&u&w,s,x2[2_S*f${*YQ-R'OQ-S'QR4i/y%[%Si#v$b$c$d$x${%O%Q%^%_%c)y*R*T*V*Y*a*g*w*x+f+i,S,V.f/P/d/m/x/y/{0`0b0i0j0o1f1i1q3c4^4_4j4o5Q5[5_6S7W7v8Q8V8[8q9b9p9y:P:`:r;Q;[;d;k<l<m<o<p<q<r<u<v<w<x<y<z=S=T=U=V=X=Y=]=^=_=`=a=b=c=d=g=h>P>X>Y>]>^Q,U&]Q1h,WQ5s1gR8h5tV*n$|*Z*oU*n$|*Z*oT5z1o5{S0P*i/nQ4w0]T8S4z:]Q+j%xQ0V*lQ1O+kQ1u,aQ6W1vQ8v6XQ:c8wR;^:d!U%Oi$d%O%Q%^%_%c*R*T*a*w*x/P/x0`0b0i0j0o4_5Q8V9p>P>X>Yx*R$v)e*S*u+V/v0d0e4R4g5R5S5W7p8U:R:x=p=}>OS0`*t0a#f<o#v$b$c$x${)y*V*Y*g+f+i,S,V.f/d/m/y/{1f1i1q3c4^4j4o5[5_6S7W7v8Q8[8q9b9y:P:`:r;Q;[;d;k<o<q<u<w<y=S=U=X=]=_=a=c=g>]>^n<p<l<m<p<r<v<x<z=T=V=Y=^=`=b=d=h!d=S(u)c*[*e.j.m.q/_/k/|0v1e3h4[4h4l5r7]7`7w7z8X8Z9t9|:S:};R;e;j;v>Z>[`=T3}7c7f7j9h:t:w;yS=_.l3iT=`7e9k!U%Qi$d%O%Q%^%_%c*R*T*a*w*x/P/x0`0b0i0j0o4_5Q8V9p>P>X>Y|*T$v)e*U*t+V/g/v0d0e4R4g4|5R5S5W7p8U:R:x=p=}>OS0b*u0c#f<q#v$b$c$x${)y*V*Y*g+f+i,S,V.f/d/m/y/{1f1i1q3c4^4j4o5[5_6S7W7v8Q8[8q9b9y:P:`:r;Q;[;d;k<o<q<u<w<y=S=U=X=]=_=a=c=g>]>^n<r<l<m<p<r<v<x<z=T=V=Y=^=`=b=d=h!h=U(u)c*[*e.k.l.q/_/k/|0v1e3f3h4[4h4l5r7]7^7`7w7z8X8Z9t9|:S:};R;e;j;v>Z>[d=V3}7d7e7j9h9i:t:u:w;yS=a.m3jT=b7f9lrnOXst!V!Z#d%m&i&r&t&u&w,s,x2[2_Q&f!UR,p&ornOXst!V!Z#d%m&i&r&t&u&w,s,x2[2_R&f!UQ,Y&^R1d,RsnOXst!V!Z#d%m&i&r&t&u&w,s,x2[2_Q1p,_S6R1s1tU8p6P6Q6US:_8r8sS;Y:^:aQ;m;ZR;w;nQ&m!VR,i&iR6_1|R:f8yW&Q|&V&W,OR1Z+vQ&r!WR,s&sR,y&xT2],x2_R,}&yQ,|&yR2f,}Q'y!{R-y'ySsOtQ#dXT%ps#dQ#OTR'{#OQ#RUR'}#RQ){$uR/`){Q#UVR(Q#UQ#XWU(W#X(X.QQ(X#YR.Q(YQ-^'YR2r-^Q.u(yS3m.u3nR3n.vQ-e'`R2v-eY!rQ'`-e1o5{R'j!rQ/Q)eR4S/QU#_W%h*YU(_#_(`.RQ(`#`R.R(ZQ-a']R2t-at`OXst!V!Z#d%m&i&k&r&t&u&w,s,x2[2_S#hZ%eU#r`#h.[R.[(jQ(k#jQ.X(gW.a(k.X3X7RQ3X.YR7R3YQ)n$lR/W)nQ$phR)t$pQ$`cU)a$`-|<jQ-|<WR<j)qQ/q*]W4c/q4d7t9sU4d/r/s/tS7t4e4fR9s7u$e*Q$v(u)c)e*[*e*t*u+Q+R+V.l.m.o.p.q/_/g/i/k/v/|0d0e0v1e3f3g3h3}4R4[4g4h4l4|5O5R5S5W5r7]7^7_7`7e7f7h7i7j7p7w7z8U8X8Z9h9i9j9t9|:R:S:t:u:v:w:x:};R;e;j;v;y=p=}>O>Z>[Q/z*eU4k/z4m7xQ4m/|R7x4lS*o$|*ZR0Y*ox*S$v)e*t*u+V/v0d0e4R4g5R5S5W7p8U:R:x=p=}>O!d.j(u)c*[*e.l.m.q/_/k/|0v1e3h4[4h4l5r7]7`7w7z8X8Z9t9|:S:};R;e;j;v>Z>[U/h*S.j7ca7c3}7e7f7j9h:t:w;yQ0a*tQ3i.lU4}0a3i9kR9k7e|*U$v)e*t*u+V/g/v0d0e4R4g4|5R5S5W7p8U:R:x=p=}>O!h.k(u)c*[*e.l.m.q/_/k/|0v1e3f3h4[4h4l5r7]7^7`7w7z8X8Z9t9|:S:};R;e;j;v>Z>[U/j*U.k7de7d3}7e7f7j9h9i:t:u:w;yQ0c*uQ3j.mU5P0c3j9lR9l7fQ*z%UR0g*zQ5]0vR8Y5]Q+_%kR0u+_Q5v1jS8j5v:[R:[8kQ,[&_R1m,[Q5{1oR8m5{Q1{,fS6]1{8zR8z6_Q1U+rW5h1U5j8a:VQ5j1XQ8a5iR:V8bQ+w&QR1[+wQ2_,xR6m2_YrOXst#dQ&v!ZQ+a%mQ,r&rQ,t&tQ,u&uQ,w&wQ2Y,sS2],x2_R6l2[Q%opQ&z!_Q&}!aQ'P!bQ'R!cQ'q!uQ+`%lQ+l%zQ,Q&XQ,h&mQ-P&|W-p'k's't'wQ-w'oQ0X*nQ1P+mQ1c,PS2O,i,lQ2g-OQ2h-RQ2i-SQ2}-oW3P-r-s-v-xQ5a1QQ5m1_Q5q1eQ6V1uQ6a2QQ6k2ZU6z3O3R3UQ6}3SQ8]5bQ8e5oQ8g5rQ8l5zQ8u6WQ8{6`S9[6{7PQ9^7OQ:W8cQ:b8vQ:g8|Q:n9]Q;U:XQ;]:cQ;a:oQ;l;VR;o;^Q%zyQ'd!iQ'o!uU+m%{%|%}Q-W'VU-k'e'f'gS-o'k'uQ0Q*jS1Q+n+oQ2o-YS2{-l-mQ3S-tS4p0R0UQ5b1RQ6v2uQ6y2|Q7O3TU7{4r4s4vQ9z7}R;O9{S$wi>PR*{%VU%Ui%V>PR0f*yQ$viS(u#v+iS)c$b$cQ)e$dQ*[$xS*e${*YQ*t%OQ*u%QQ+Q%^Q+R%_Q+V%cQ.l<oQ.m<qQ.o<uQ.p<wQ.q<yQ/_)yQ/g*RQ/i*TQ/k*VQ/v*aS/|*g/mQ0d*wQ0e*xl0v+f,V.f1i1q3c6S7W8q9b:`:r;[;dQ1e,SQ3f=SQ3g=UQ3h=XS3}<l<mQ4R/PS4[/d4^Q4g/xQ4h/yQ4l/{Q4|0`Q5O0bQ5R0iQ5S0jQ5W0oQ5r1fQ7]=]Q7^=_Q7_=aQ7`=cQ7e<pQ7f<rQ7h<vQ7i<xQ7j<zQ7p4_Q7w4jQ7z4oQ8U5QQ8X5[Q8Z5_Q9h=YQ9i=TQ9j=VQ9t7vQ9|8QQ:R8VQ:S8[Q:t=^Q:u=`Q:v=bQ:w=dQ:x9pQ:}9yQ;R:PQ;e=gQ;j;QQ;v;kQ;y=hQ=p>PQ=}>XQ>O>YQ>Z>]R>[>^Q+O%]Q.n<sR7g<tnpOXst!Z#d%m&r&t&u&w,s,x2[2_Q!fPS#fZ#oQ&|!`W'h!o*i0]4zQ(P#SQ)Q#{Q)r$nS,l&k&nQ,q&oQ-O&{S-T'T/nQ-g'bQ.x)OQ/[)sQ0s+]Q0y+gQ2W,pQ2y-iQ3a.gQ4W/VQ5U0lQ6Q1rQ6c2SQ6d2TQ6h2VQ6j2XQ6o2aQ7Z3dQ7m4TQ8s6TQ9P6eQ9Q6fQ9S6iQ9f7[Q:a8tR:k9T#[cOPXZst!Z!`!o#d#o#{%m&k&n&o&r&t&u&w&{'T'b)O*i+]+g,p,s,x-i.g/n0]0l1r2S2T2V2X2[2_2a3d4z6T6e6f6i7[8t9TQ#YWQ#eYQ%quQ%svS%uw!gS(S#W(VQ(Y#ZQ(t#uQ(y#xQ)R$OQ)S$PQ)T$QQ)U$RQ)V$SQ)W$TQ)X$UQ)Y$VQ)Z$WQ)[$XQ)^$ZQ)`$_Q)b$aQ)g$eW)q$n)s/V4TQ+d%tQ+x&RS-Z'X2pQ-x'rS-}(T.PQ.S(]Q.U(dQ.s(xQ.v(zQ.z<UQ.|<XQ.}<YQ/O<]Q/b)}Q0p+XQ2k-UQ2n-XQ3O-qQ3V.VQ3k.tQ3p<^Q3q<_Q3r<`Q3s<aQ3t<bQ3u<cQ3v<dQ3w<eQ3x<fQ3y<gQ3z<hQ3{.{Q3|<kQ4P<nQ4Q<{Q4X<iQ5X0rQ5c1SQ6u=OQ6{3QQ7Q3WQ7a3lQ7b=PQ7k=RQ7l=ZQ8k5wQ9X6sQ9]6|Q9g=[Q9m=eQ9n=fQ:o9_Q;W:ZQ;`:mQ<W#SR=v>SR#[WR'Z!el!tQ!r!v!y!z'`'l'm'n-e-u1o5{5}S'V!e-]U*j$|*Z*oS-Y'W'_S0U*k*qQ0^*rQ2u-cQ4v0[R4{0_R({#xQ!fQT-d'`-e]!qQ!r'`-e1o5{Q#p]R'i<VR)f$dY!uQ'`-e1o5{Q'k!rS'u!v!yS'w!z5}S-t'l'mQ-v'nR3T-uT#kZ%eS#jZ%eS%km,oU(g#h#i#lS.Y(h(iQ.^(jQ0t+^Q3Y.ZU3Z.[.]._S7S3[3]R9`7Td#^W#W#Z%h(T(^*Y+Z.T/mr#gZm#h#i#l%e(h(i(j+^.Z.[.]._3[3]7TS*]$x*bQ/t*^Q2U,oQ2l-VQ4`/pQ6q2dQ7s4aQ9W6rT=m'X+[V#aW%h*YU#`W%h*YS(U#W(^U(Z#Z+Z/mS-['X+[T.O(T.TV'^!e%i*ZQ$lfR)x$qT)m$l)nR4V/UT*_$x*bT*h${*YQ0w+fQ1g,VQ3_.fQ5t1iQ6P1qQ7X3cQ8r6SQ9c7WQ:^8qQ:p9bQ;Z:`Q;c:rQ;n;[R;q;dnqOXst!Z#d%m&r&t&u&w,s,x2[2_Q&l!VR,h&itmOXst!U!V!Z#d%m&i&r&t&u&w,s,x2[2_R,o&oT%lm,oR1k,XR,g&gQ&U|S+}&V&WR1^,OR+s&PT&p!W&sT&q!W&sT2^,x2_",nodeNames:"⚠ ArithOp ArithOp ?. JSXStartTag LineComment BlockComment Script Hashbang ExportDeclaration export Star as VariableName String Escape from ; default FunctionDeclaration async function VariableDefinition > < TypeParamList in out const TypeDefinition extends ThisType this LiteralType ArithOp Number BooleanLiteral TemplateType InterpolationEnd Interpolation InterpolationStart NullType null VoidType void TypeofType typeof MemberExpression . PropertyName [ TemplateString Escape Interpolation super RegExp ] ArrayExpression Spread , } { ObjectExpression Property async get set PropertyDefinition Block : NewTarget new NewExpression ) ( ArgList UnaryExpression delete LogicOp BitOp YieldExpression yield AwaitExpression await ParenthesizedExpression ClassExpression class ClassBody MethodDeclaration Decorator @ MemberExpression PrivatePropertyName CallExpression TypeArgList CompareOp < declare Privacy static abstract override PrivatePropertyDefinition PropertyDeclaration readonly accessor Optional TypeAnnotation Equals StaticBlock FunctionExpression ArrowFunction ParamList ParamList ArrayPattern ObjectPattern PatternProperty Privacy readonly Arrow MemberExpression BinaryExpression ArithOp ArithOp ArithOp ArithOp BitOp CompareOp instanceof satisfies CompareOp BitOp BitOp BitOp LogicOp LogicOp ConditionalExpression LogicOp LogicOp AssignmentExpression UpdateOp PostfixExpression CallExpression InstantiationExpression TaggedTemplateExpression DynamicImport import ImportMeta JSXElement JSXSelfCloseEndTag JSXSelfClosingTag JSXIdentifier JSXBuiltin JSXIdentifier JSXNamespacedName JSXMemberExpression JSXSpreadAttribute JSXAttribute JSXAttributeValue JSXEscape JSXEndTag JSXOpenTag JSXFragmentTag JSXText JSXEscape JSXStartCloseTag JSXCloseTag PrefixCast < ArrowFunction TypeParamList SequenceExpression InstantiationExpression KeyofType keyof UniqueType unique ImportType InferredType infer TypeName ParenthesizedType FunctionSignature ParamList NewSignature IndexedType TupleType Label ArrayType ReadonlyType ObjectType MethodType PropertyType IndexSignature PropertyDefinition CallSignature TypePredicate asserts is NewSignature new UnionType LogicOp IntersectionType LogicOp ConditionalType ParameterizedType ClassDeclaration abstract implements type VariableDeclaration let var using TypeAliasDeclaration InterfaceDeclaration interface EnumDeclaration enum EnumBody NamespaceDeclaration namespace module AmbientDeclaration declare GlobalDeclaration global ClassDeclaration ClassBody AmbientFunctionDeclaration ExportGroup VariableName VariableName ImportDeclaration defer ImportGroup ForStatement for ForSpec ForInSpec ForOfSpec of WhileStatement while WithStatement with DoStatement do IfStatement if else SwitchStatement switch SwitchBody CaseLabel case DefaultLabel TryStatement try CatchClause catch FinallyClause finally ReturnStatement return ThrowStatement throw BreakStatement break ContinueStatement continue DebuggerStatement debugger LabeledStatement ExpressionStatement SingleExpression SingleClassItem",maxTerm:380,context:Xq,nodeProps:[["isolate",-8,5,6,14,37,39,51,53,55,""],["group",-26,9,17,19,68,207,211,215,216,218,221,224,234,237,243,245,247,249,252,258,264,266,268,270,272,274,275,"Statement",-34,13,14,32,35,36,42,51,54,55,57,62,70,72,76,80,82,84,85,110,111,120,121,136,139,141,142,143,144,145,147,148,167,169,171,"Expression",-23,31,33,37,41,43,45,173,175,177,178,180,181,182,184,185,186,188,189,190,201,203,205,206,"Type",-3,88,103,109,"ClassItem"],["openedBy",23,"<",38,"InterpolationStart",56,"[",60,"{",73,"(",160,"JSXStartCloseTag"],["closedBy",-2,24,168,">",40,"InterpolationEnd",50,"]",61,"}",74,")",165,"JSXEndTag"]],propSources:[Yq],skippedNodes:[0,5,6,278],repeatNodeCount:37,tokenData:"$Fq07[R!bOX%ZXY+gYZ-yZ[+g[]%Z]^.c^p%Zpq+gqr/mrs3cst:_tuEruvJSvwLkwx! Yxy!'iyz!(sz{!)}{|!,q|}!.O}!O!,q!O!P!/Y!P!Q!9j!Q!R#:O!R![#<_![!]#I_!]!^#Jk!^!_#Ku!_!`$![!`!a$$v!a!b$*T!b!c$,r!c!}Er!}#O$-|#O#P$/W#P#Q$4o#Q#R$5y#R#SEr#S#T$7W#T#o$8b#o#p$<r#p#q$=h#q#r$>x#r#s$@U#s$f%Z$f$g+g$g#BYEr#BY#BZ$A`#BZ$ISEr$IS$I_$A`$I_$I|Er$I|$I}$Dk$I}$JO$Dk$JO$JTEr$JT$JU$A`$JU$KVEr$KV$KW$A`$KW&FUEr&FU&FV$A`&FV;'SEr;'S;=`I|<%l?HTEr?HT?HU$A`?HUOEr(n%d_$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z&j&hT$i&jO!^&c!_#o&c#p;'S&c;'S;=`&w<%lO&c&j&zP;=`<%l&c'|'U]$i&j(Z!bOY&}YZ&cZw&}wx&cx!^&}!^!_'}!_#O&}#O#P&c#P#o&}#o#p'}#p;'S&};'S;=`(l<%lO&}!b(SU(Z!bOY'}Zw'}x#O'}#P;'S'};'S;=`(f<%lO'}!b(iP;=`<%l'}'|(oP;=`<%l&}'[(y]$i&j(WpOY(rYZ&cZr(rrs&cs!^(r!^!_)r!_#O(r#O#P&c#P#o(r#o#p)r#p;'S(r;'S;=`*a<%lO(rp)wU(WpOY)rZr)rs#O)r#P;'S)r;'S;=`*Z<%lO)rp*^P;=`<%l)r'[*dP;=`<%l(r#S*nX(Wp(Z!bOY*gZr*grs'}sw*gwx)rx#O*g#P;'S*g;'S;=`+Z<%lO*g#S+^P;=`<%l*g(n+dP;=`<%l%Z07[+rq$i&j(Wp(Z!b'|0/lOX%ZXY+gYZ&cZ[+g[p%Zpq+gqr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p$f%Z$f$g+g$g#BY%Z#BY#BZ+g#BZ$IS%Z$IS$I_+g$I_$JT%Z$JT$JU+g$JU$KV%Z$KV$KW+g$KW&FU%Z&FU&FV+g&FV;'S%Z;'S;=`+a<%l?HT%Z?HT?HU+g?HUO%Z07[.ST(X#S$i&j'}0/lO!^&c!_#o&c#p;'S&c;'S;=`&w<%lO&c07[.n_$i&j(Wp(Z!b'}0/lOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z)3p/x`$i&j!p),Q(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`0z!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(KW1V`#v(Ch$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`2X!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(KW2d_#v(Ch$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'At3l_(V':f$i&j(Z!bOY4kYZ5qZr4krs7nsw4kwx5qx!^4k!^!_8p!_#O4k#O#P5q#P#o4k#o#p8p#p;'S4k;'S;=`:X<%lO4k(^4r_$i&j(Z!bOY4kYZ5qZr4krs7nsw4kwx5qx!^4k!^!_8p!_#O4k#O#P5q#P#o4k#o#p8p#p;'S4k;'S;=`:X<%lO4k&z5vX$i&jOr5qrs6cs!^5q!^!_6y!_#o5q#o#p6y#p;'S5q;'S;=`7h<%lO5q&z6jT$d`$i&jO!^&c!_#o&c#p;'S&c;'S;=`&w<%lO&c`6|TOr6yrs7]s;'S6y;'S;=`7b<%lO6y`7bO$d``7eP;=`<%l6y&z7kP;=`<%l5q(^7w]$d`$i&j(Z!bOY&}YZ&cZw&}wx&cx!^&}!^!_'}!_#O&}#O#P&c#P#o&}#o#p'}#p;'S&};'S;=`(l<%lO&}!r8uZ(Z!bOY8pYZ6yZr8prs9hsw8pwx6yx#O8p#O#P6y#P;'S8p;'S;=`:R<%lO8p!r9oU$d`(Z!bOY'}Zw'}x#O'}#P;'S'};'S;=`(f<%lO'}!r:UP;=`<%l8p(^:[P;=`<%l4k%9[:hh$i&j(Wp(Z!bOY%ZYZ&cZq%Zqr<Srs&}st%ZtuCruw%Zwx(rx!^%Z!^!_*g!_!c%Z!c!}Cr!}#O%Z#O#P&c#P#R%Z#R#SCr#S#T%Z#T#oCr#o#p*g#p$g%Z$g;'SCr;'S;=`El<%lOCr(r<__WS$i&j(Wp(Z!bOY<SYZ&cZr<Srs=^sw<Swx@nx!^<S!^!_Bm!_#O<S#O#P>`#P#o<S#o#pBm#p;'S<S;'S;=`Cl<%lO<S(Q=g]WS$i&j(Z!bOY=^YZ&cZw=^wx>`x!^=^!^!_?q!_#O=^#O#P>`#P#o=^#o#p?q#p;'S=^;'S;=`@h<%lO=^&n>gXWS$i&jOY>`YZ&cZ!^>`!^!_?S!_#o>`#o#p?S#p;'S>`;'S;=`?k<%lO>`S?XSWSOY?SZ;'S?S;'S;=`?e<%lO?SS?hP;=`<%l?S&n?nP;=`<%l>`!f?xWWS(Z!bOY?qZw?qwx?Sx#O?q#O#P?S#P;'S?q;'S;=`@b<%lO?q!f@eP;=`<%l?q(Q@kP;=`<%l=^'`@w]WS$i&j(WpOY@nYZ&cZr@nrs>`s!^@n!^!_Ap!_#O@n#O#P>`#P#o@n#o#pAp#p;'S@n;'S;=`Bg<%lO@ntAwWWS(WpOYApZrAprs?Ss#OAp#O#P?S#P;'SAp;'S;=`Ba<%lOAptBdP;=`<%lAp'`BjP;=`<%l@n#WBvYWS(Wp(Z!bOYBmZrBmrs?qswBmwxApx#OBm#O#P?S#P;'SBm;'S;=`Cf<%lOBm#WCiP;=`<%lBm(rCoP;=`<%l<S%9[C}i$i&j(o%1l(Wp(Z!bOY%ZYZ&cZr%Zrs&}st%ZtuCruw%Zwx(rx!Q%Z!Q![Cr![!^%Z!^!_*g!_!c%Z!c!}Cr!}#O%Z#O#P&c#P#R%Z#R#SCr#S#T%Z#T#oCr#o#p*g#p$g%Z$g;'SCr;'S;=`El<%lOCr%9[EoP;=`<%lCr07[FRk$i&j(Wp(Z!b$]#t(T,2j(e$I[OY%ZYZ&cZr%Zrs&}st%ZtuEruw%Zwx(rx}%Z}!OGv!O!Q%Z!Q![Er![!^%Z!^!_*g!_!c%Z!c!}Er!}#O%Z#O#P&c#P#R%Z#R#SEr#S#T%Z#T#oEr#o#p*g#p$g%Z$g;'SEr;'S;=`I|<%lOEr+dHRk$i&j(Wp(Z!b$]#tOY%ZYZ&cZr%Zrs&}st%ZtuGvuw%Zwx(rx}%Z}!OGv!O!Q%Z!Q![Gv![!^%Z!^!_*g!_!c%Z!c!}Gv!}#O%Z#O#P&c#P#R%Z#R#SGv#S#T%Z#T#oGv#o#p*g#p$g%Z$g;'SGv;'S;=`Iv<%lOGv+dIyP;=`<%lGv07[JPP;=`<%lEr(KWJ_`$i&j(Wp(Z!b#p(ChOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(KWKl_$i&j$Q(Ch(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z,#xLva(z+JY$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sv%ZvwM{wx(rx!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(KWNW`$i&j#z(Ch(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'At! c_(Y';W$i&j(WpOY!!bYZ!#hZr!!brs!#hsw!!bwx!$xx!^!!b!^!_!%z!_#O!!b#O#P!#h#P#o!!b#o#p!%z#p;'S!!b;'S;=`!'c<%lO!!b'l!!i_$i&j(WpOY!!bYZ!#hZr!!brs!#hsw!!bwx!$xx!^!!b!^!_!%z!_#O!!b#O#P!#h#P#o!!b#o#p!%z#p;'S!!b;'S;=`!'c<%lO!!b&z!#mX$i&jOw!#hwx6cx!^!#h!^!_!$Y!_#o!#h#o#p!$Y#p;'S!#h;'S;=`!$r<%lO!#h`!$]TOw!$Ywx7]x;'S!$Y;'S;=`!$l<%lO!$Y`!$oP;=`<%l!$Y&z!$uP;=`<%l!#h'l!%R]$d`$i&j(WpOY(rYZ&cZr(rrs&cs!^(r!^!_)r!_#O(r#O#P&c#P#o(r#o#p)r#p;'S(r;'S;=`*a<%lO(r!Q!&PZ(WpOY!%zYZ!$YZr!%zrs!$Ysw!%zwx!&rx#O!%z#O#P!$Y#P;'S!%z;'S;=`!']<%lO!%z!Q!&yU$d`(WpOY)rZr)rs#O)r#P;'S)r;'S;=`*Z<%lO)r!Q!'`P;=`<%l!%z'l!'fP;=`<%l!!b/5|!'t_!l/.^$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z#&U!)O_!k!Lf$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z-!n!*[b$i&j(Wp(Z!b(U%&f#q(ChOY%ZYZ&cZr%Zrs&}sw%Zwx(rxz%Zz{!+d{!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(KW!+o`$i&j(Wp(Z!b#n(ChOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z+;x!,|`$i&j(Wp(Z!br+4YOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z,$U!.Z_!]+Jf$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z07[!/ec$i&j(Wp(Z!b!Q.2^OY%ZYZ&cZr%Zrs&}sw%Zwx(rx!O%Z!O!P!0p!P!Q%Z!Q![!3Y![!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z#%|!0ya$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!O%Z!O!P!2O!P!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z#%|!2Z_![!L^$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad!3eg$i&j(Wp(Z!bs'9tOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q![!3Y![!^%Z!^!_*g!_!g%Z!g!h!4|!h#O%Z#O#P&c#P#R%Z#R#S!3Y#S#X%Z#X#Y!4|#Y#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad!5Vg$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx{%Z{|!6n|}%Z}!O!6n!O!Q%Z!Q![!8S![!^%Z!^!_*g!_#O%Z#O#P&c#P#R%Z#R#S!8S#S#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad!6wc$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q![!8S![!^%Z!^!_*g!_#O%Z#O#P&c#P#R%Z#R#S!8S#S#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad!8_c$i&j(Wp(Z!bs'9tOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q![!8S![!^%Z!^!_*g!_#O%Z#O#P&c#P#R%Z#R#S!8S#S#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z07[!9uf$i&j(Wp(Z!b#o(ChOY!;ZYZ&cZr!;Zrs!<nsw!;Zwx!Lcxz!;Zz{#-}{!P!;Z!P!Q#/d!Q!^!;Z!^!_#(i!_!`#7S!`!a#8i!a!}!;Z!}#O#,f#O#P!Dy#P#o!;Z#o#p#(i#p;'S!;Z;'S;=`#-w<%lO!;Z?O!;fb$i&j(Wp(Z!b!X7`OY!;ZYZ&cZr!;Zrs!<nsw!;Zwx!Lcx!P!;Z!P!Q#&`!Q!^!;Z!^!_#(i!_!}!;Z!}#O#,f#O#P!Dy#P#o!;Z#o#p#(i#p;'S!;Z;'S;=`#-w<%lO!;Z>^!<w`$i&j(Z!b!X7`OY!<nYZ&cZw!<nwx!=yx!P!<n!P!Q!Eq!Q!^!<n!^!_!Gr!_!}!<n!}#O!KS#O#P!Dy#P#o!<n#o#p!Gr#p;'S!<n;'S;=`!L]<%lO!<n<z!>Q^$i&j!X7`OY!=yYZ&cZ!P!=y!P!Q!>|!Q!^!=y!^!_!@c!_!}!=y!}#O!CW#O#P!Dy#P#o!=y#o#p!@c#p;'S!=y;'S;=`!Ek<%lO!=y<z!?Td$i&j!X7`O!^&c!_#W&c#W#X!>|#X#Z&c#Z#[!>|#[#]&c#]#^!>|#^#a&c#a#b!>|#b#g&c#g#h!>|#h#i&c#i#j!>|#j#k!>|#k#m&c#m#n!>|#n#o&c#p;'S&c;'S;=`&w<%lO&c7`!@hX!X7`OY!@cZ!P!@c!P!Q!AT!Q!}!@c!}#O!Ar#O#P!Bq#P;'S!@c;'S;=`!CQ<%lO!@c7`!AYW!X7`#W#X!AT#Z#[!AT#]#^!AT#a#b!AT#g#h!AT#i#j!AT#j#k!AT#m#n!AT7`!AuVOY!ArZ#O!Ar#O#P!B[#P#Q!@c#Q;'S!Ar;'S;=`!Bk<%lO!Ar7`!B_SOY!ArZ;'S!Ar;'S;=`!Bk<%lO!Ar7`!BnP;=`<%l!Ar7`!BtSOY!@cZ;'S!@c;'S;=`!CQ<%lO!@c7`!CTP;=`<%l!@c<z!C][$i&jOY!CWYZ&cZ!^!CW!^!_!Ar!_#O!CW#O#P!DR#P#Q!=y#Q#o!CW#o#p!Ar#p;'S!CW;'S;=`!Ds<%lO!CW<z!DWX$i&jOY!CWYZ&cZ!^!CW!^!_!Ar!_#o!CW#o#p!Ar#p;'S!CW;'S;=`!Ds<%lO!CW<z!DvP;=`<%l!CW<z!EOX$i&jOY!=yYZ&cZ!^!=y!^!_!@c!_#o!=y#o#p!@c#p;'S!=y;'S;=`!Ek<%lO!=y<z!EnP;=`<%l!=y>^!Ezl$i&j(Z!b!X7`OY&}YZ&cZw&}wx&cx!^&}!^!_'}!_#O&}#O#P&c#P#W&}#W#X!Eq#X#Z&}#Z#[!Eq#[#]&}#]#^!Eq#^#a&}#a#b!Eq#b#g&}#g#h!Eq#h#i&}#i#j!Eq#j#k!Eq#k#m&}#m#n!Eq#n#o&}#o#p'}#p;'S&};'S;=`(l<%lO&}8r!GyZ(Z!b!X7`OY!GrZw!Grwx!@cx!P!Gr!P!Q!Hl!Q!}!Gr!}#O!JU#O#P!Bq#P;'S!Gr;'S;=`!J|<%lO!Gr8r!Hse(Z!b!X7`OY'}Zw'}x#O'}#P#W'}#W#X!Hl#X#Z'}#Z#[!Hl#[#]'}#]#^!Hl#^#a'}#a#b!Hl#b#g'}#g#h!Hl#h#i'}#i#j!Hl#j#k!Hl#k#m'}#m#n!Hl#n;'S'};'S;=`(f<%lO'}8r!JZX(Z!bOY!JUZw!JUwx!Arx#O!JU#O#P!B[#P#Q!Gr#Q;'S!JU;'S;=`!Jv<%lO!JU8r!JyP;=`<%l!JU8r!KPP;=`<%l!Gr>^!KZ^$i&j(Z!bOY!KSYZ&cZw!KSwx!CWx!^!KS!^!_!JU!_#O!KS#O#P!DR#P#Q!<n#Q#o!KS#o#p!JU#p;'S!KS;'S;=`!LV<%lO!KS>^!LYP;=`<%l!KS>^!L`P;=`<%l!<n=l!Ll`$i&j(Wp!X7`OY!LcYZ&cZr!Lcrs!=ys!P!Lc!P!Q!Mn!Q!^!Lc!^!_# o!_!}!Lc!}#O#%P#O#P!Dy#P#o!Lc#o#p# o#p;'S!Lc;'S;=`#&Y<%lO!Lc=l!Mwl$i&j(Wp!X7`OY(rYZ&cZr(rrs&cs!^(r!^!_)r!_#O(r#O#P&c#P#W(r#W#X!Mn#X#Z(r#Z#[!Mn#[#](r#]#^!Mn#^#a(r#a#b!Mn#b#g(r#g#h!Mn#h#i(r#i#j!Mn#j#k!Mn#k#m(r#m#n!Mn#n#o(r#o#p)r#p;'S(r;'S;=`*a<%lO(r8Q# vZ(Wp!X7`OY# oZr# ors!@cs!P# o!P!Q#!i!Q!}# o!}#O#$R#O#P!Bq#P;'S# o;'S;=`#$y<%lO# o8Q#!pe(Wp!X7`OY)rZr)rs#O)r#P#W)r#W#X#!i#X#Z)r#Z#[#!i#[#])r#]#^#!i#^#a)r#a#b#!i#b#g)r#g#h#!i#h#i)r#i#j#!i#j#k#!i#k#m)r#m#n#!i#n;'S)r;'S;=`*Z<%lO)r8Q#$WX(WpOY#$RZr#$Rrs!Ars#O#$R#O#P!B[#P#Q# o#Q;'S#$R;'S;=`#$s<%lO#$R8Q#$vP;=`<%l#$R8Q#$|P;=`<%l# o=l#%W^$i&j(WpOY#%PYZ&cZr#%Prs!CWs!^#%P!^!_#$R!_#O#%P#O#P!DR#P#Q!Lc#Q#o#%P#o#p#$R#p;'S#%P;'S;=`#&S<%lO#%P=l#&VP;=`<%l#%P=l#&]P;=`<%l!Lc?O#&kn$i&j(Wp(Z!b!X7`OY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#W%Z#W#X#&`#X#Z%Z#Z#[#&`#[#]%Z#]#^#&`#^#a%Z#a#b#&`#b#g%Z#g#h#&`#h#i%Z#i#j#&`#j#k#&`#k#m%Z#m#n#&`#n#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z9d#(r](Wp(Z!b!X7`OY#(iZr#(irs!Grsw#(iwx# ox!P#(i!P!Q#)k!Q!}#(i!}#O#+`#O#P!Bq#P;'S#(i;'S;=`#,`<%lO#(i9d#)th(Wp(Z!b!X7`OY*gZr*grs'}sw*gwx)rx#O*g#P#W*g#W#X#)k#X#Z*g#Z#[#)k#[#]*g#]#^#)k#^#a*g#a#b#)k#b#g*g#g#h#)k#h#i*g#i#j#)k#j#k#)k#k#m*g#m#n#)k#n;'S*g;'S;=`+Z<%lO*g9d#+gZ(Wp(Z!bOY#+`Zr#+`rs!JUsw#+`wx#$Rx#O#+`#O#P!B[#P#Q#(i#Q;'S#+`;'S;=`#,Y<%lO#+`9d#,]P;=`<%l#+`9d#,cP;=`<%l#(i?O#,o`$i&j(Wp(Z!bOY#,fYZ&cZr#,frs!KSsw#,fwx#%Px!^#,f!^!_#+`!_#O#,f#O#P!DR#P#Q!;Z#Q#o#,f#o#p#+`#p;'S#,f;'S;=`#-q<%lO#,f?O#-tP;=`<%l#,f?O#-zP;=`<%l!;Z07[#.[b$i&j(Wp(Z!b(O0/l!X7`OY!;ZYZ&cZr!;Zrs!<nsw!;Zwx!Lcx!P!;Z!P!Q#&`!Q!^!;Z!^!_#(i!_!}!;Z!}#O#,f#O#P!Dy#P#o!;Z#o#p#(i#p;'S!;Z;'S;=`#-w<%lO!;Z07[#/o_$i&j(Wp(Z!bT0/lOY#/dYZ&cZr#/drs#0nsw#/dwx#4Ox!^#/d!^!_#5}!_#O#/d#O#P#1p#P#o#/d#o#p#5}#p;'S#/d;'S;=`#6|<%lO#/d06j#0w]$i&j(Z!bT0/lOY#0nYZ&cZw#0nwx#1px!^#0n!^!_#3R!_#O#0n#O#P#1p#P#o#0n#o#p#3R#p;'S#0n;'S;=`#3x<%lO#0n05W#1wX$i&jT0/lOY#1pYZ&cZ!^#1p!^!_#2d!_#o#1p#o#p#2d#p;'S#1p;'S;=`#2{<%lO#1p0/l#2iST0/lOY#2dZ;'S#2d;'S;=`#2u<%lO#2d0/l#2xP;=`<%l#2d05W#3OP;=`<%l#1p01O#3YW(Z!bT0/lOY#3RZw#3Rwx#2dx#O#3R#O#P#2d#P;'S#3R;'S;=`#3r<%lO#3R01O#3uP;=`<%l#3R06j#3{P;=`<%l#0n05x#4X]$i&j(WpT0/lOY#4OYZ&cZr#4Ors#1ps!^#4O!^!_#5Q!_#O#4O#O#P#1p#P#o#4O#o#p#5Q#p;'S#4O;'S;=`#5w<%lO#4O00^#5XW(WpT0/lOY#5QZr#5Qrs#2ds#O#5Q#O#P#2d#P;'S#5Q;'S;=`#5q<%lO#5Q00^#5tP;=`<%l#5Q05x#5zP;=`<%l#4O01p#6WY(Wp(Z!bT0/lOY#5}Zr#5}rs#3Rsw#5}wx#5Qx#O#5}#O#P#2d#P;'S#5};'S;=`#6v<%lO#5}01p#6yP;=`<%l#5}07[#7PP;=`<%l#/d)3h#7ab$i&j$Q(Ch(Wp(Z!b!X7`OY!;ZYZ&cZr!;Zrs!<nsw!;Zwx!Lcx!P!;Z!P!Q#&`!Q!^!;Z!^!_#(i!_!}!;Z!}#O#,f#O#P!Dy#P#o!;Z#o#p#(i#p;'S!;Z;'S;=`#-w<%lO!;ZAt#8vb$Z#t$i&j(Wp(Z!b!X7`OY!;ZYZ&cZr!;Zrs!<nsw!;Zwx!Lcx!P!;Z!P!Q#&`!Q!^!;Z!^!_#(i!_!}!;Z!}#O#,f#O#P!Dy#P#o!;Z#o#p#(i#p;'S!;Z;'S;=`#-w<%lO!;Z'Ad#:Zp$i&j(Wp(Z!bs'9tOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!O%Z!O!P!3Y!P!Q%Z!Q![#<_![!^%Z!^!_*g!_!g%Z!g!h!4|!h#O%Z#O#P&c#P#R%Z#R#S#<_#S#U%Z#U#V#?i#V#X%Z#X#Y!4|#Y#b%Z#b#c#>_#c#d#Bq#d#l%Z#l#m#Es#m#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad#<jk$i&j(Wp(Z!bs'9tOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!O%Z!O!P!3Y!P!Q%Z!Q![#<_![!^%Z!^!_*g!_!g%Z!g!h!4|!h#O%Z#O#P&c#P#R%Z#R#S#<_#S#X%Z#X#Y!4|#Y#b%Z#b#c#>_#c#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad#>j_$i&j(Wp(Z!bs'9tOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad#?rd$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q!R#AQ!R!S#AQ!S!^%Z!^!_*g!_#O%Z#O#P&c#P#R%Z#R#S#AQ#S#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad#A]f$i&j(Wp(Z!bs'9tOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q!R#AQ!R!S#AQ!S!^%Z!^!_*g!_#O%Z#O#P&c#P#R%Z#R#S#AQ#S#b%Z#b#c#>_#c#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad#Bzc$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q!Y#DV!Y!^%Z!^!_*g!_#O%Z#O#P&c#P#R%Z#R#S#DV#S#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad#Dbe$i&j(Wp(Z!bs'9tOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q!Y#DV!Y!^%Z!^!_*g!_#O%Z#O#P&c#P#R%Z#R#S#DV#S#b%Z#b#c#>_#c#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad#E|g$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q![#Ge![!^%Z!^!_*g!_!c%Z!c!i#Ge!i#O%Z#O#P&c#P#R%Z#R#S#Ge#S#T%Z#T#Z#Ge#Z#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad#Gpi$i&j(Wp(Z!bs'9tOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q![#Ge![!^%Z!^!_*g!_!c%Z!c!i#Ge!i#O%Z#O#P&c#P#R%Z#R#S#Ge#S#T%Z#T#Z#Ge#Z#b%Z#b#c#>_#c#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z*)x#Il_!g$b$i&j$O)Lv(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z)[#Jv_al$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z04f#LS^h#)`#R-<U(Wp(Z!b$n7`OY*gZr*grs'}sw*gwx)rx!P*g!P!Q#MO!Q!^*g!^!_#Mt!_!`$ f!`#O*g#P;'S*g;'S;=`+Z<%lO*g(n#MXX$k&j(Wp(Z!bOY*gZr*grs'}sw*gwx)rx#O*g#P;'S*g;'S;=`+Z<%lO*g(El#M}Z#r(Ch(Wp(Z!bOY*gZr*grs'}sw*gwx)rx!_*g!_!`#Np!`#O*g#P;'S*g;'S;=`+Z<%lO*g(El#NyX$Q(Ch(Wp(Z!bOY*gZr*grs'}sw*gwx)rx#O*g#P;'S*g;'S;=`+Z<%lO*g(El$ oX#s(Ch(Wp(Z!bOY*gZr*grs'}sw*gwx)rx#O*g#P;'S*g;'S;=`+Z<%lO*g*)x$!ga#`*!Y$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`0z!`!a$#l!a#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(K[$#w_#k(Cl$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z*)x$%Vag!*r#s(Ch$f#|$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`$&[!`!a$'f!a#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(KW$&g_#s(Ch$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(KW$'qa#r(Ch$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Ka!`!a$(v!a#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(KW$)R`#r(Ch$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(Kd$*`a(r(Ct$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!a%Z!a!b$+e!b#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(KW$+p`$i&j#{(Ch(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z%#`$,}_!|$Ip$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z04f$.X_!S0,v$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(n$/]Z$i&jO!^$0O!^!_$0f!_#i$0O#i#j$0k#j#l$0O#l#m$2^#m#o$0O#o#p$0f#p;'S$0O;'S;=`$4i<%lO$0O(n$0VT_#S$i&jO!^&c!_#o&c#p;'S&c;'S;=`&w<%lO&c#S$0kO_#S(n$0p[$i&jO!Q&c!Q![$1f![!^&c!_!c&c!c!i$1f!i#T&c#T#Z$1f#Z#o&c#o#p$3|#p;'S&c;'S;=`&w<%lO&c(n$1kZ$i&jO!Q&c!Q![$2^![!^&c!_!c&c!c!i$2^!i#T&c#T#Z$2^#Z#o&c#p;'S&c;'S;=`&w<%lO&c(n$2cZ$i&jO!Q&c!Q![$3U![!^&c!_!c&c!c!i$3U!i#T&c#T#Z$3U#Z#o&c#p;'S&c;'S;=`&w<%lO&c(n$3ZZ$i&jO!Q&c!Q![$0O![!^&c!_!c&c!c!i$0O!i#T&c#T#Z$0O#Z#o&c#p;'S&c;'S;=`&w<%lO&c#S$4PR!Q![$4Y!c!i$4Y#T#Z$4Y#S$4]S!Q![$4Y!c!i$4Y#T#Z$4Y#q#r$0f(n$4lP;=`<%l$0O#1[$4z_!Y#)l$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(KW$6U`#x(Ch$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z+;p$7c_$i&j(Wp(Z!b(a+4QOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z07[$8qk$i&j(Wp(Z!b(T,2j$_#t(e$I[OY%ZYZ&cZr%Zrs&}st%Ztu$8buw%Zwx(rx}%Z}!O$:f!O!Q%Z!Q![$8b![!^%Z!^!_*g!_!c%Z!c!}$8b!}#O%Z#O#P&c#P#R%Z#R#S$8b#S#T%Z#T#o$8b#o#p*g#p$g%Z$g;'S$8b;'S;=`$<l<%lO$8b+d$:qk$i&j(Wp(Z!b$_#tOY%ZYZ&cZr%Zrs&}st%Ztu$:fuw%Zwx(rx}%Z}!O$:f!O!Q%Z!Q![$:f![!^%Z!^!_*g!_!c%Z!c!}$:f!}#O%Z#O#P&c#P#R%Z#R#S$:f#S#T%Z#T#o$:f#o#p*g#p$g%Z$g;'S$:f;'S;=`$<f<%lO$:f+d$<iP;=`<%l$:f07[$<oP;=`<%l$8b#Jf$<{X!_#Hb(Wp(Z!bOY*gZr*grs'}sw*gwx)rx#O*g#P;'S*g;'S;=`+Z<%lO*g,#x$=sa(y+JY$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p#q$+e#q;'S%Z;'S;=`+a<%lO%Z)>v$?V_!^(CdvBr$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z?O$@a_!q7`$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z07[$Aq|$i&j(Wp(Z!b'|0/l$]#t(T,2j(e$I[OX%ZXY+gYZ&cZ[+g[p%Zpq+gqr%Zrs&}st%ZtuEruw%Zwx(rx}%Z}!OGv!O!Q%Z!Q![Er![!^%Z!^!_*g!_!c%Z!c!}Er!}#O%Z#O#P&c#P#R%Z#R#SEr#S#T%Z#T#oEr#o#p*g#p$f%Z$f$g+g$g#BYEr#BY#BZ$A`#BZ$ISEr$IS$I_$A`$I_$JTEr$JT$JU$A`$JU$KVEr$KV$KW$A`$KW&FUEr&FU&FV$A`&FV;'SEr;'S;=`I|<%l?HTEr?HT?HU$A`?HUOEr07[$D|k$i&j(Wp(Z!b'}0/l$]#t(T,2j(e$I[OY%ZYZ&cZr%Zrs&}st%ZtuEruw%Zwx(rx}%Z}!OGv!O!Q%Z!Q![Er![!^%Z!^!_*g!_!c%Z!c!}Er!}#O%Z#O#P&c#P#R%Z#R#SEr#S#T%Z#T#oEr#o#p*g#p$g%Z$g;'SEr;'S;=`I|<%lOEr",tokenizers:[zq,Zq,Wq,Hq,2,3,4,5,6,7,8,9,10,11,12,13,14,jq,new Ph("$S~RRtu[#O#Pg#S#T#|~_P#o#pb~gOx~~jVO#i!P#i#j!U#j#l!P#l#m!q#m;'S!P;'S;=`#v<%lO!P~!UO!U~~!XS!Q![!e!c!i!e#T#Z!e#o#p#Z~!hR!Q![!q!c!i!q#T#Z!q~!tR!Q![!}!c!i!}#T#Z!}~#QR!Q![!P!c!i!P#T#Z!P~#^R!Q![#g!c!i#g#T#Z#g~#jS!Q![#g!c!i#g#T#Z#g#q#r!P~#yP;=`<%l!P~$RO(c~~",141,340),new Ph("j~RQYZXz{^~^O(Q~~aP!P!Qd~iO(R~~",25,323)],topRules:{Script:[0,7],SingleExpression:[1,276],SingleClassItem:[2,277]},dialects:{jsx:0,ts:15175},dynamicPrecedences:{80:1,82:1,94:1,169:1,199:1},specialized:[{term:327,get:r=>Gq[r]||-1},{term:343,get:r=>Kq[r]||-1},{term:95,get:r=>Jq[r]||-1}],tokenPrec:15201}),wk=[vi("function ${name}(${params}) {\n	${}\n}",{label:"function",detail:"definition",type:"keyword"}),vi("for (let ${index} = 0; ${index} < ${bound}; ${index}++) {\n	${}\n}",{label:"for",detail:"loop",type:"keyword"}),vi("for (let ${name} of ${collection}) {\n	${}\n}",{label:"for",detail:"of loop",type:"keyword"}),vi("do {\n	${}\n} while (${})",{label:"do",detail:"loop",type:"keyword"}),vi("while (${}) {\n	${}\n}",{label:"while",detail:"loop",type:"keyword"}),vi(`try {
	\${}
} catch (\${error}) {
	\${}
}`,{label:"try",detail:"/ catch block",type:"keyword"}),vi("if (${}) {\n	${}\n}",{label:"if",detail:"block",type:"keyword"}),vi(`if (\${}) {
	\${}
} else {
	\${}
}`,{label:"if",detail:"/ else block",type:"keyword"}),vi(`class \${name} {
	constructor(\${params}) {
		\${}
	}
}`,{label:"class",detail:"definition",type:"keyword"}),vi('import {${names}} from "${module}"\n${}',{label:"import",detail:"named",type:"keyword"}),vi('import ${name} from "${module}"\n${}',{label:"import",detail:"default",type:"keyword"})],t9=wk.concat([vi("interface ${name} {\n	${}\n}",{label:"interface",detail:"definition",type:"keyword"}),vi("type ${name} = ${type}",{label:"type",detail:"definition",type:"keyword"}),vi("enum ${name} {\n	${}\n}",{label:"enum",detail:"definition",type:"keyword"})]),GS=new g2,Ck=new Set(["Script","Block","FunctionExpression","FunctionDeclaration","ArrowFunction","MethodDeclaration","ForStatement"]);function Qo(r){return(e,t)=>{let i=e.node.getChild("VariableDefinition");return i&&t(i,r),!0}}const i9=["FunctionDeclaration"],r9={FunctionDeclaration:Qo("function"),ClassDeclaration:Qo("class"),ClassExpression:()=>!0,EnumDeclaration:Qo("constant"),TypeAliasDeclaration:Qo("type"),NamespaceDeclaration:Qo("namespace"),VariableDefinition(r,e){r.matchContext(i9)||e(r,"variable")},TypeDefinition(r,e){e(r,"type")},__proto__:null};function kk(r,e){let t=GS.get(e);if(t)return t;let i=[],s=!0;function n(a,o){let l=r.sliceString(a.from,a.to);i.push({label:l,type:o})}return e.cursor(lt.IncludeAnonymous).iterate(a=>{if(s)s=!1;else if(a.name){let o=r9[a.name];if(o&&o(a,n)||Ck.has(a.name))return!1}else if(a.to-a.from>8192){for(let o of kk(r,a.node))i.push(o);return!1}}),GS.set(e,i),i}const KS=/^[\w$\xa1-\uffff][\w$\d\xa1-\uffff]*$/,Ek=["TemplateString","String","RegExp","LineComment","BlockComment","VariableDefinition","TypeDefinition","Label","PropertyDefinition","PropertyName","PrivatePropertyDefinition","PrivatePropertyName","JSXText","JSXAttributeValue","JSXOpenTag","JSXCloseTag","JSXSelfClosingTag",".","?."];function s9(r){let e=nt(r.state).resolveInner(r.pos,-1);if(Ek.indexOf(e.name)>-1)return null;let t=e.name=="VariableName"||e.to-e.from<20&&KS.test(r.state.sliceDoc(e.from,e.to));if(!t&&!r.explicit)return null;let i=[];for(let s=e;s;s=s.parent)Ck.has(s.name)&&(i=i.concat(kk(r.state.doc,s)));return{options:i,from:t?e.from:r.pos,validFor:KS}}const zr=Fa.define({name:"javascript",parser:e9.configure({props:[nu.add({IfStatement:kc({except:/^\s*({|else\b)/}),TryStatement:kc({except:/^\s*({|catch\b|finally\b)/}),LabeledStatement:ZN,SwitchBody:r=>{let e=r.textAfter,t=/^\s*\}/.test(e),i=/^\s*(case|default)\b/.test(e);return r.baseIndent+(t?0:i?1:2)*r.unit},Block:zN({closing:"}"}),ArrowFunction:r=>r.baseIndent+r.unit,"TemplateString BlockComment":()=>null,"Statement Property":kc({except:/^\s*{/}),JSXElement(r){let e=/^\s*<\//.test(r.textAfter);return r.lineIndent(r.node.from)+(e?0:r.unit)},JSXEscape(r){let e=/\s*\}/.test(r.textAfter);return r.lineIndent(r.node.from)+(e?0:r.unit)},"JSXOpenTag JSXSelfClosingTag"(r){return r.column(r.node.from)+r.unit}}),ro.add({"Block ClassBody SwitchBody EnumBody ObjectExpression ArrayExpression ObjectType":x2,BlockComment(r){return{from:r.from+2,to:r.to-2}}})]}),languageData:{closeBrackets:{brackets:["(","[","{","'",'"',"`"]},commentTokens:{line:"//",block:{open:"/*",close:"*/"}},indentOnInput:/^\s*(?:case |default:|\{|\}|<\/)$/,wordChars:"$"}}),Ak={test:r=>/^JSX/.test(r.name),facet:d0({commentTokens:{block:{open:"{/*",close:"*/}"}}})},Pk=zr.configure({dialect:"ts"},"typescript"),Dk=zr.configure({dialect:"jsx",props:[f0.add(r=>r.isTop?[Ak]:void 0)]}),Mk=zr.configure({dialect:"jsx ts",props:[f0.add(r=>r.isTop?[Ak]:void 0)]},"typescript");let Ik=r=>({label:r,type:"keyword"});const Rk="break case const continue default delete export extends false finally in instanceof let new return static super switch this throw true typeof var yield".split(" ").map(Ik),n9=Rk.concat(["declare","implements","private","protected","public"].map(Ik));function a9(r={}){let e=r.jsx?r.typescript?Mk:Dk:r.typescript?Pk:zr,t=r.typescript?t9.concat(n9):wk.concat(Rk);return new Pl(e,[zr.data.of({autocomplete:f6(Ek,xC(t))}),zr.data.of({autocomplete:s9}),r.jsx?u9:[]])}function o9(r){for(;;){if(r.name=="JSXOpenTag"||r.name=="JSXSelfClosingTag"||r.name=="JSXFragmentTag")return r;if(r.name=="JSXEscape"||!r.parent)return null;r=r.parent}}function JS(r,e,t=r.length){for(let i=e?.firstChild;i;i=i.nextSibling)if(i.name=="JSXIdentifier"||i.name=="JSXBuiltin"||i.name=="JSXNamespacedName"||i.name=="JSXMemberExpression")return r.sliceString(i.from,Math.min(i.to,t));return""}const l9=typeof navigator=="object"&&/Android\b/.test(navigator.userAgent),u9=ge.inputHandler.of((r,e,t,i,s)=>{if((l9?r.composing:r.compositionStarted)||r.state.readOnly||e!=t||i!=">"&&i!="/"||!zr.isActiveAt(r.state,e,-1))return!1;let n=s(),{state:a}=n,o=a.changeByRange(l=>{var u;let{head:c}=l,h=nt(a).resolveInner(c-1,-1),f;if(h.name=="JSXStartTag"&&(h=h.parent),!(a.doc.sliceString(c-1,c)!=i||h.name=="JSXAttributeValue"&&h.to>c)){if(i==">"&&h.name=="JSXFragmentTag")return{range:l,changes:{from:c,insert:"</>"}};if(i=="/"&&h.name=="JSXStartCloseTag"){let m=h.parent,S=m.parent;if(S&&m.from==c-2&&((f=JS(a.doc,S.firstChild,c))||((u=S.firstChild)===null||u===void 0?void 0:u.name)=="JSXFragmentTag")){let y=`${f}>`;return{range:ie.cursor(c+y.length,-1),changes:{from:c,insert:y}}}}else if(i==">"){let m=o9(h);if(m&&m.name=="JSXOpenTag"&&!/^\/?>|^<\//.test(a.doc.sliceString(c,c+2))&&(f=JS(a.doc,m,c)))return{range:l,changes:{from:c,insert:`</${f}>`}}}}return{range:l}});return o.changes.empty?!1:(r.dispatch([n,a.update(o,{userEvent:"input.complete",scrollIntoView:!0})]),!0)}),$o=["_blank","_self","_top","_parent"],ip=["ascii","utf-8","utf-16","latin1","latin1"],rp=["get","post","put","delete"],sp=["application/x-www-form-urlencoded","multipart/form-data","text/plain"],Qi=["true","false"],_e={},c9={a:{attrs:{href:null,ping:null,type:null,media:null,target:$o,hreflang:null}},abbr:_e,address:_e,area:{attrs:{alt:null,coords:null,href:null,target:null,ping:null,media:null,hreflang:null,type:null,shape:["default","rect","circle","poly"]}},article:_e,aside:_e,audio:{attrs:{src:null,mediagroup:null,crossorigin:["anonymous","use-credentials"],preload:["none","metadata","auto"],autoplay:["autoplay"],loop:["loop"],controls:["controls"]}},b:_e,base:{attrs:{href:null,target:$o}},bdi:_e,bdo:_e,blockquote:{attrs:{cite:null}},body:_e,br:_e,button:{attrs:{form:null,formaction:null,name:null,value:null,autofocus:["autofocus"],disabled:["autofocus"],formenctype:sp,formmethod:rp,formnovalidate:["novalidate"],formtarget:$o,type:["submit","reset","button"]}},canvas:{attrs:{width:null,height:null}},caption:_e,center:_e,cite:_e,code:_e,col:{attrs:{span:null}},colgroup:{attrs:{span:null}},command:{attrs:{type:["command","checkbox","radio"],label:null,icon:null,radiogroup:null,command:null,title:null,disabled:["disabled"],checked:["checked"]}},data:{attrs:{value:null}},datagrid:{attrs:{disabled:["disabled"],multiple:["multiple"]}},datalist:{attrs:{data:null}},dd:_e,del:{attrs:{cite:null,datetime:null}},details:{attrs:{open:["open"]}},dfn:_e,div:_e,dl:_e,dt:_e,em:_e,embed:{attrs:{src:null,type:null,width:null,height:null}},eventsource:{attrs:{src:null}},fieldset:{attrs:{disabled:["disabled"],form:null,name:null}},figcaption:_e,figure:_e,footer:_e,form:{attrs:{action:null,name:null,"accept-charset":ip,autocomplete:["on","off"],enctype:sp,method:rp,novalidate:["novalidate"],target:$o}},h1:_e,h2:_e,h3:_e,h4:_e,h5:_e,h6:_e,head:{children:["title","base","link","style","meta","script","noscript","command"]},header:_e,hgroup:_e,hr:_e,html:{attrs:{manifest:null}},i:_e,iframe:{attrs:{src:null,srcdoc:null,name:null,width:null,height:null,sandbox:["allow-top-navigation","allow-same-origin","allow-forms","allow-scripts"],seamless:["seamless"]}},img:{attrs:{alt:null,src:null,ismap:null,usemap:null,width:null,height:null,crossorigin:["anonymous","use-credentials"]}},input:{attrs:{alt:null,dirname:null,form:null,formaction:null,height:null,list:null,max:null,maxlength:null,min:null,name:null,pattern:null,placeholder:null,size:null,src:null,step:null,value:null,width:null,accept:["audio/*","video/*","image/*"],autocomplete:["on","off"],autofocus:["autofocus"],checked:["checked"],disabled:["disabled"],formenctype:sp,formmethod:rp,formnovalidate:["novalidate"],formtarget:$o,multiple:["multiple"],readonly:["readonly"],required:["required"],type:["hidden","text","search","tel","url","email","password","datetime","date","month","week","time","datetime-local","number","range","color","checkbox","radio","file","submit","image","reset","button"]}},ins:{attrs:{cite:null,datetime:null}},kbd:_e,keygen:{attrs:{challenge:null,form:null,name:null,autofocus:["autofocus"],disabled:["disabled"],keytype:["RSA"]}},label:{attrs:{for:null,form:null}},legend:_e,li:{attrs:{value:null}},link:{attrs:{href:null,type:null,hreflang:null,media:null,sizes:["all","16x16","16x16 32x32","16x16 32x32 64x64"]}},map:{attrs:{name:null}},mark:_e,menu:{attrs:{label:null,type:["list","context","toolbar"]}},meta:{attrs:{content:null,charset:ip,name:["viewport","application-name","author","description","generator","keywords"],"http-equiv":["content-language","content-type","default-style","refresh"]}},meter:{attrs:{value:null,min:null,low:null,high:null,max:null,optimum:null}},nav:_e,noscript:_e,object:{attrs:{data:null,type:null,name:null,usemap:null,form:null,width:null,height:null,typemustmatch:["typemustmatch"]}},ol:{attrs:{reversed:["reversed"],start:null,type:["1","a","A","i","I"]},children:["li","script","template","ul","ol"]},optgroup:{attrs:{disabled:["disabled"],label:null}},option:{attrs:{disabled:["disabled"],label:null,selected:["selected"],value:null}},output:{attrs:{for:null,form:null,name:null}},p:_e,param:{attrs:{name:null,value:null}},pre:_e,progress:{attrs:{value:null,max:null}},q:{attrs:{cite:null}},rp:_e,rt:_e,ruby:_e,samp:_e,script:{attrs:{type:["text/javascript"],src:null,async:["async"],defer:["defer"],charset:ip}},section:_e,select:{attrs:{form:null,name:null,size:null,autofocus:["autofocus"],disabled:["disabled"],multiple:["multiple"]}},slot:{attrs:{name:null}},small:_e,source:{attrs:{src:null,type:null,media:null}},span:_e,strong:_e,style:{attrs:{type:["text/css"],media:null,scoped:null}},sub:_e,summary:_e,sup:_e,table:_e,tbody:_e,td:{attrs:{colspan:null,rowspan:null,headers:null}},template:_e,textarea:{attrs:{dirname:null,form:null,maxlength:null,name:null,placeholder:null,rows:null,cols:null,autofocus:["autofocus"],disabled:["disabled"],readonly:["readonly"],required:["required"],wrap:["soft","hard"]}},tfoot:_e,th:{attrs:{colspan:null,rowspan:null,headers:null,scope:["row","col","rowgroup","colgroup"]}},thead:_e,time:{attrs:{datetime:null}},title:_e,tr:_e,track:{attrs:{src:null,label:null,default:null,kind:["subtitles","captions","descriptions","chapters","metadata"],srclang:null}},ul:{children:["li","script","template","ul","ol"]},var:_e,video:{attrs:{src:null,poster:null,width:null,height:null,crossorigin:["anonymous","use-credentials"],preload:["auto","metadata","none"],autoplay:["autoplay"],mediagroup:["movie"],muted:["muted"],controls:["controls"]}},wbr:_e},Lk={accesskey:null,class:null,contenteditable:Qi,contextmenu:null,dir:["ltr","rtl","auto"],draggable:["true","false","auto"],dropzone:["copy","move","link","string:","file:"],hidden:["hidden"],id:null,inert:["inert"],itemid:null,itemprop:null,itemref:null,itemscope:["itemscope"],itemtype:null,lang:["ar","bn","de","en-GB","en-US","es","fr","hi","id","ja","pa","pt","ru","tr","zh"],spellcheck:Qi,autocorrect:Qi,autocapitalize:Qi,style:null,tabindex:null,title:null,translate:["yes","no"],rel:["stylesheet","alternate","author","bookmark","help","license","next","nofollow","noreferrer","prefetch","prev","search","tag"],role:"alert application article banner button cell checkbox complementary contentinfo dialog document feed figure form grid gridcell heading img list listbox listitem main navigation region row rowgroup search switch tab table tabpanel textbox timer".split(" "),"aria-activedescendant":null,"aria-atomic":Qi,"aria-autocomplete":["inline","list","both","none"],"aria-busy":Qi,"aria-checked":["true","false","mixed","undefined"],"aria-controls":null,"aria-describedby":null,"aria-disabled":Qi,"aria-dropeffect":null,"aria-expanded":["true","false","undefined"],"aria-flowto":null,"aria-grabbed":["true","false","undefined"],"aria-haspopup":Qi,"aria-hidden":Qi,"aria-invalid":["true","false","grammar","spelling"],"aria-label":null,"aria-labelledby":null,"aria-level":null,"aria-live":["off","polite","assertive"],"aria-multiline":Qi,"aria-multiselectable":Qi,"aria-owns":null,"aria-posinset":null,"aria-pressed":["true","false","mixed","undefined"],"aria-readonly":Qi,"aria-relevant":null,"aria-required":Qi,"aria-selected":["true","false","undefined"],"aria-setsize":null,"aria-sort":["ascending","descending","none","other"],"aria-valuemax":null,"aria-valuemin":null,"aria-valuenow":null,"aria-valuetext":null},Qk="beforeunload copy cut dragstart dragover dragleave dragenter dragend drag paste focus blur change click load mousedown mouseenter mouseleave mouseup keydown keyup resize scroll unload".split(" ").map(r=>"on"+r);for(let r of Qk)Lk[r]=null;class Ul{constructor(e,t){this.tags={...c9,...e},this.globalAttrs={...Lk,...t},this.allTags=Object.keys(this.tags),this.globalAttrNames=Object.keys(this.globalAttrs)}}Ul.default=new Ul;function za(r,e,t=r.length){if(!e)return"";let i=e.firstChild,s=i&&i.getChild("TagName");return s?r.sliceString(s.from,Math.min(s.to,t)):""}function Za(r,e=!1){for(;r;r=r.parent)if(r.name=="Element")if(e)e=!1;else return r;return null}function $k(r,e,t){let i=t.tags[za(r,Za(e))];return i?.children||t.allTags}function N0(r,e){let t=[];for(let i=Za(e);i&&!i.type.isTop;i=Za(i.parent)){let s=za(r,i);if(s&&i.lastChild.name=="CloseTag")break;s&&t.indexOf(s)<0&&(e.name=="EndTag"||e.from>=i.firstChild.to)&&t.push(s)}return t}const Bk=/^[:\-\.\w\u00b7-\uffff]*$/;function e1(r,e,t,i,s){let n=/\s*>/.test(r.sliceDoc(s,s+5))?"":">",a=Za(t,t.name=="StartTag"||t.name=="TagName");return{from:i,to:s,options:$k(r.doc,a,e).map(o=>({label:o,type:"type"})).concat(N0(r.doc,t).map((o,l)=>({label:"/"+o,apply:"/"+o+n,type:"type",boost:99-l}))),validFor:/^\/?[:\-\.\w\u00b7-\uffff]*$/}}function t1(r,e,t,i){let s=/\s*>/.test(r.sliceDoc(i,i+5))?"":">";return{from:t,to:i,options:N0(r.doc,e).map((n,a)=>({label:n,apply:n+s,type:"type",boost:99-a})),validFor:Bk}}function h9(r,e,t,i){let s=[],n=0;for(let a of $k(r.doc,t,e))s.push({label:"<"+a,type:"type"});for(let a of N0(r.doc,t))s.push({label:"</"+a+">",type:"type",boost:99-n++});return{from:i,to:i,options:s,validFor:/^<\/?[:\-\.\w\u00b7-\uffff]*$/}}function d9(r,e,t,i,s){let n=Za(t),a=n?e.tags[za(r.doc,n)]:null,o=a&&a.attrs?Object.keys(a.attrs):[],l=a&&a.globalAttrs===!1?o:o.length?o.concat(e.globalAttrNames):e.globalAttrNames;return{from:i,to:s,options:l.map(u=>({label:u,type:"property"})),validFor:Bk}}function f9(r,e,t,i,s){var n;let a=(n=t.parent)===null||n===void 0?void 0:n.getChild("AttributeName"),o=[],l;if(a){let u=r.sliceDoc(a.from,a.to),c=e.globalAttrs[u];if(!c){let h=Za(t),f=h?e.tags[za(r.doc,h)]:null;c=f?.attrs&&f.attrs[u]}if(c){let h=r.sliceDoc(i,s).toLowerCase(),f='"',m='"';/^['"]/.test(h)?(l=h[0]=='"'?/^[^"]*$/:/^[^']*$/,f="",m=r.sliceDoc(s,s+1)==h[0]?"":h[0],h=h.slice(1),i++):l=/^[^\s<>='"]*$/;for(let S of c)o.push({label:S,apply:f+S+m,type:"constant"})}}return{from:i,to:s,options:o,validFor:l}}function Nk(r,e){let{state:t,pos:i}=e,s=nt(t).resolveInner(i,-1),n=s.resolve(i);for(let a=i,o;n==s&&(o=s.childBefore(a));){let l=o.lastChild;if(!l||!l.type.isError||l.from<l.to)break;n=s=o,a=l.from}return s.name=="TagName"?s.parent&&/CloseTag$/.test(s.parent.name)?t1(t,s,s.from,i):e1(t,r,s,s.from,i):s.name=="StartTag"||s.name=="IncompleteTag"?e1(t,r,s,i,i):s.name=="StartCloseTag"||s.name=="IncompleteCloseTag"?t1(t,s,i,i):s.name=="OpenTag"||s.name=="SelfClosingTag"||s.name=="AttributeName"?d9(t,r,s,s.name=="AttributeName"?s.from:i,i):s.name=="Is"||s.name=="AttributeValue"||s.name=="UnquotedAttributeValue"?f9(t,r,s,s.name=="Is"?i:s.from,i):e.explicit&&(n.name=="Element"||n.name=="Text"||n.name=="Document")?h9(t,r,s,i):null}function p9(r){return Nk(Ul.default,r)}function m9(r){let{extraTags:e,extraGlobalAttributes:t}=r,i=t||e?new Ul(e,t):Ul.default;return s=>Nk(i,s)}const g9=zr.parser.configure({top:"SingleExpression"}),Fk=[{tag:"script",attrs:r=>r.type=="text/typescript"||r.lang=="ts",parser:Pk.parser},{tag:"script",attrs:r=>r.type=="text/babel"||r.type=="text/jsx",parser:Dk.parser},{tag:"script",attrs:r=>r.type=="text/typescript-jsx",parser:Mk.parser},{tag:"script",attrs(r){return/^(importmap|speculationrules|application\/(.+\+)?json)$/i.test(r.type)},parser:g9},{tag:"script",attrs(r){return!r.type||/^(?:text|application)\/(?:x-)?(?:java|ecma)script$|^module$|^$/i.test(r.type)},parser:zr.parser},{tag:"style",attrs(r){return(!r.lang||r.lang=="css")&&(!r.type||/^(text\/)?(x-)?(stylesheet|css)$/i.test(r.type))},parser:Mh.parser}],Uk=[{name:"style",parser:Mh.parser.configure({top:"Styles"})}].concat(Qk.map(r=>({name:r,parser:zr.parser}))),qk=Fa.define({name:"html",parser:UU.configure({props:[nu.add({Element(r){let e=/^(\s*)(<\/)?/.exec(r.textAfter);return r.node.to<=r.pos+e[0].length?r.continue():r.lineIndent(r.node.from)+(e[2]?0:r.unit)},"OpenTag CloseTag SelfClosingTag"(r){return r.column(r.node.from)+r.unit},Document(r){if(r.pos+/\s*/.exec(r.textAfter)[0].length<r.node.to)return r.continue();let e=null,t;for(let i=r.node;;){let s=i.lastChild;if(!s||s.name!="Element"||s.to!=i.to)break;e=i=s}return e&&!((t=e.lastChild)&&(t.name=="CloseTag"||t.name=="SelfClosingTag"))?r.lineIndent(e.from)+r.unit:null}}),ro.add({Element(r){let e=r.firstChild,t=r.lastChild;return!e||e.name!="OpenTag"?null:{from:e.to,to:t.name=="CloseTag"?t.from:r.to}}}),$2.add({"OpenTag CloseTag":r=>r.getChild("TagName")})]}),languageData:{commentTokens:{block:{open:"<!--",close:"-->"}},indentOnInput:/^\s*<\/\w+\W$/,wordChars:"-_"}}),Pc=qk.configure({wrap:yk(Fk,Uk)});function O9(r={}){let e="",t;r.matchClosingTags===!1&&(e="noMatch"),r.selfClosingTags===!0&&(e=(e?e+" ":"")+"selfClosing"),(r.nestedLanguages&&r.nestedLanguages.length||r.nestedAttributes&&r.nestedAttributes.length)&&(t=yk((r.nestedLanguages||[]).concat(Fk),(r.nestedAttributes||[]).concat(Uk)));let i=t?qk.configure({wrap:t,dialect:e}):e?Pc.configure({dialect:e}):Pc;return new Pl(i,[Pc.data.of({autocomplete:m9(r)}),r.autoCloseTags!==!1?y9:[],a9().support,_q().support])}const i1=new Set("area base br col command embed frame hr img input keygen link meta param source track wbr menuitem".split(" ")),y9=ge.inputHandler.of((r,e,t,i,s)=>{if(r.composing||r.state.readOnly||e!=t||i!=">"&&i!="/"||!Pc.isActiveAt(r.state,e,-1))return!1;let n=s(),{state:a}=n,o=a.changeByRange(l=>{var u,c,h;let f=a.doc.sliceString(l.from-1,l.to)==i,{head:m}=l,S=nt(a).resolveInner(m,-1),y;if(f&&i==">"&&S.name=="EndTag"){let E=S.parent;if(((c=(u=E.parent)===null||u===void 0?void 0:u.lastChild)===null||c===void 0?void 0:c.name)!="CloseTag"&&(y=za(a.doc,E.parent,m))&&!i1.has(y)){let C=m+(a.doc.sliceString(m,m+1)===">"?1:0),_=`</${y}>`;return{range:l,changes:{from:m,to:C,insert:_}}}}else if(f&&i=="/"&&S.name=="IncompleteCloseTag"){let E=S.parent;if(S.from==m-2&&((h=E.lastChild)===null||h===void 0?void 0:h.name)!="CloseTag"&&(y=za(a.doc,E,m))&&!i1.has(y)){let C=m+(a.doc.sliceString(m,m+1)===">"?1:0),_=`${y}>`;return{range:ie.cursor(m+_.length,-1),changes:{from:m,to:C,insert:_}}}}return{range:l}});return o.changes.empty?!1:(r.dispatch([n,a.update(o,{userEvent:"input.complete",scrollIntoView:!0})]),!0)}),Vk=d0({commentTokens:{block:{open:"<!--",close:"-->"}}}),Xk=new Ie,jk=L7.configure({props:[ro.add(r=>!r.is("Block")||r.is("Document")||jm(r)!=null||b9(r)?void 0:(e,t)=>({from:t.doc.lineAt(e.from).to,to:e.to})),Xk.add(jm),nu.add({Document:()=>null}),Sn.add({Document:Vk})]});function jm(r){let e=/^(?:ATX|Setext)Heading(\d)$/.exec(r.name);return e?+e[1]:void 0}function b9(r){return r.name=="OrderedList"||r.name=="BulletList"}function v9(r,e){let t=r;for(;;){let i=t.nextSibling,s;if(!i||(s=jm(i.type))!=null&&s<=e)break;t=i}return t.to}const S9=_2.of((r,e,t)=>{for(let i=nt(r).resolveInner(t,-1);i&&!(i.from<e);i=i.parent){let s=i.type.prop(Xk);if(s==null)continue;let n=v9(i,s);if(n>t)return{from:t,to:n}}return null});function F0(r){return new Ki(Vk,r,[],"markdown")}const T9=F0(jk),_9=jk.configure([z7,W7,Z7,H7,{props:[ro.add({Table:(r,e)=>({from:e.doc.lineAt(r.from).to,to:r.to})})]}]),Ih=F0(_9);function x9(r,e){return t=>{if(t&&r){let i=null;if(t=/\S*/.exec(t)[0],typeof r=="function"?i=r(t):i=mh.matchLanguageName(r,t,!0),i instanceof mh)return i.support?i.support.language.parser:Al.getSkippingParser(i.load());if(i)return i.parser}return e?e.parser:null}}class np{constructor(e,t,i,s,n,a,o){this.node=e,this.from=t,this.to=i,this.spaceBefore=s,this.spaceAfter=n,this.type=a,this.item=o}blank(e,t=!0){let i=this.spaceBefore+(this.node.name=="Blockquote"?">":"");if(e!=null){for(;i.length<e;)i+=" ";return i}else{for(let s=this.to-this.from-i.length-this.spaceAfter.length;s>0;s--)i+=" ";return i+(t?this.spaceAfter:"")}}marker(e,t){let i=this.node.name=="OrderedList"?String(+Zk(this.item,e)[2]+t):"";return this.spaceBefore+i+this.type+this.spaceAfter}}function zk(r,e){let t=[],i=[];for(let s=r;s;s=s.parent){if(s.name=="FencedCode")return i;(s.name=="ListItem"||s.name=="Blockquote")&&t.push(s)}for(let s=t.length-1;s>=0;s--){let n=t[s],a,o=e.lineAt(n.from),l=n.from-o.from;if(n.name=="Blockquote"&&(a=/^ *>( ?)/.exec(o.text.slice(l))))i.push(new np(n,l,l+a[0].length,"",a[1],">",null));else if(n.name=="ListItem"&&n.parent.name=="OrderedList"&&(a=/^( *)\d+([.)])( *)/.exec(o.text.slice(l)))){let u=a[3],c=a[0].length;u.length>=4&&(u=u.slice(0,u.length-4),c-=4),i.push(new np(n.parent,l,l+c,a[1],u,a[2],n))}else if(n.name=="ListItem"&&n.parent.name=="BulletList"&&(a=/^( *)([-+*])( {1,4}\[[ xX]\])?( +)/.exec(o.text.slice(l)))){let u=a[4],c=a[0].length;u.length>4&&(u=u.slice(0,u.length-4),c-=4);let h=a[2];a[3]&&(h+=a[3].replace(/[xX]/," ")),i.push(new np(n.parent,l,l+c,a[1],u,h,n))}}return i}function Zk(r,e){return/^(\s*)(\d+)(?=[.)])/.exec(e.sliceString(r.from,r.from+10))}function ap(r,e,t,i=0){for(let s=-1,n=r;;){if(n.name=="ListItem"){let o=Zk(n,e),l=+o[2];if(s>=0){if(l!=s+1)return;t.push({from:n.from+o[1].length,to:n.from+o[0].length,insert:String(s+2+i)})}s=l}let a=n.nextSibling;if(!a)break;n=a}}function U0(r,e){let t=/^[ \t]*/.exec(r)[0].length;if(!t||e.facet(su)!="	")return r;let i=yr(r,4,t),s="";for(let n=i;n>0;)n>=4?(s+="	",n-=4):(s+=" ",n--);return s+r.slice(t)}const w9=({state:r,dispatch:e})=>{let t=nt(r),{doc:i}=r,s=null,n=r.changeByRange(a=>{if(!a.empty||!Ih.isActiveAt(r,a.from,-1)&&!Ih.isActiveAt(r,a.from,1))return s={range:a};let o=a.from,l=i.lineAt(o),u=zk(t.resolveInner(o,-1),i);for(;u.length&&u[u.length-1].from>o-l.from;)u.pop();if(!u.length)return s={range:a};let c=u[u.length-1];if(c.to-c.spaceAfter.length>o-l.from)return s={range:a};let h=o>=c.to-c.spaceAfter.length&&!/\S/.test(l.text.slice(c.to));if(c.item&&h){let E=c.node.firstChild,C=c.node.getChild("ListItem","ListItem");if(E.to>=o||C&&C.to<o||l.from>0&&!/[^\s>]/.test(i.lineAt(l.from-1).text)){let _=u.length>1?u[u.length-2]:null,v,T="";_&&_.item?(v=l.from+_.from,T=_.marker(i,1)):v=l.from+(_?_.to:0);let w=[{from:v,to:o,insert:T}];return c.node.name=="OrderedList"&&ap(c.item,i,w,-2),_&&_.node.name=="OrderedList"&&ap(_.item,i,w),{range:ie.cursor(v+T.length),changes:w}}else{let _=s1(u,r,l);return{range:ie.cursor(o+_.length+1),changes:{from:l.from,insert:_+r.lineBreak}}}}if(c.node.name=="Blockquote"&&h&&l.from){let E=i.lineAt(l.from-1),C=/>\s*$/.exec(E.text);if(C&&C.index==c.from){let _=r.changes([{from:E.from+C.index,to:E.to},{from:l.from+c.from,to:l.to}]);return{range:a.map(_),changes:_}}}let f=[];c.node.name=="OrderedList"&&ap(c.item,i,f);let m=c.item&&c.item.from<l.from,S="";if(!m||/^[\s\d.)\-+*>]*/.exec(l.text)[0].length>=c.to)for(let E=0,C=u.length-1;E<=C;E++)S+=E==C&&!m?u[E].marker(i,1):u[E].blank(E<C?yr(l.text,4,u[E+1].from)-S.length:null);let y=o;for(;y>l.from&&/\s/.test(l.text.charAt(y-l.from-1));)y--;return S=U0(S,r),C9(c.node,r.doc)&&(S=s1(u,r,l)+r.lineBreak+S),f.push({from:y,to:o,insert:r.lineBreak+S}),{range:ie.cursor(y+S.length+1),changes:f}});return s?!1:(e(r.update(n,{scrollIntoView:!0,userEvent:"input"})),!0)};function r1(r){return r.name=="QuoteMark"||r.name=="ListMark"}function C9(r,e){if(r.name!="OrderedList"&&r.name!="BulletList")return!1;let t=r.firstChild,i=r.getChild("ListItem","ListItem");if(!i)return!1;let s=e.lineAt(t.to),n=e.lineAt(i.from),a=/^[\s>]*$/.test(s.text);return s.number+(a?0:1)<n.number}function s1(r,e,t){let i="";for(let s=0,n=r.length-2;s<=n;s++)i+=r[s].blank(s<n?yr(t.text,4,r[s+1].from)-i.length:null,s<n);return U0(i,e)}function k9(r,e){let t=r.resolveInner(e,-1),i=e;r1(t)&&(i=t.from,t=t.parent);for(let s;s=t.childBefore(i);)if(r1(s))i=s.from;else if(s.name=="OrderedList"||s.name=="BulletList")t=s.lastChild,i=t.to;else break;return t}const E9=({state:r,dispatch:e})=>{let t=nt(r),i=null,s=r.changeByRange(n=>{let a=n.from,{doc:o}=r;if(n.empty&&Ih.isActiveAt(r,n.from)){let l=o.lineAt(a),u=zk(k9(t,a),o);if(u.length){let c=u[u.length-1],h=c.to-c.spaceAfter.length+(c.spaceAfter?1:0);if(a-l.from>h&&!/\S/.test(l.text.slice(h,a-l.from)))return{range:ie.cursor(l.from+h),changes:{from:l.from+h,to:a}};if(a-l.from==h&&(!c.item||l.from<=c.item.from||!/\S/.test(l.text.slice(0,c.to)))){let f=l.from+c.from;if(c.item&&c.node.from<c.item.from&&/\S/.test(l.text.slice(c.from,c.to))){let m=c.blank(yr(l.text,4,c.to)-yr(l.text,4,c.from));return f==l.from&&(m=U0(m,r)),{range:ie.cursor(f+m.length),changes:{from:f,to:l.from+c.to,insert:m}}}if(f<a)return{range:ie.cursor(f),changes:{from:f,to:a}}}}}return i={range:n}});return i?!1:(e(r.update(s,{scrollIntoView:!0,userEvent:"delete"})),!0)},A9=[{key:"Enter",run:w9},{key:"Backspace",run:E9}],Wk=O9({matchClosingTags:!1});function P9(r={}){let{codeLanguages:e,defaultCodeLanguage:t,addKeymap:i=!0,base:{parser:s}=T9,completeHTMLTags:n=!0,pasteURLAsLink:a=!0,htmlTagLanguage:o=Wk}=r;if(!(s instanceof Od))throw new RangeError("Base parser provided to `markdown` should be a Markdown parser");let l=r.extensions?[r.extensions]:[],u=[o.support,S9],c;a&&u.push(R9),t instanceof Pl?(u.push(t.support),c=t.language):t&&(c=t);let h=e||c?x9(e,c):void 0;l.push($7({codeParser:h,htmlParser:o.language.parser})),i&&u.push(Ss.high(tu.of(A9)));let f=F0(s.configure(l));return n&&u.push(f.data.of({autocomplete:D9})),new Pl(f,u)}function D9(r){let{state:e,pos:t}=r,i=/<[:\-\.\w\u00b7-\uffff]*$/.exec(e.sliceDoc(t-25,t));if(!i)return null;let s=nt(e).resolveInner(t,-1);for(;s&&!s.type.isTop;){if(s.name=="CodeBlock"||s.name=="FencedCode"||s.name=="ProcessingInstructionBlock"||s.name=="CommentBlock"||s.name=="Link"||s.name=="Image")return null;s=s.parent}return{from:t-i[0].length,to:t,options:M9(),validFor:/^<[:\-\.\w\u00b7-\uffff]*$/}}let op=null;function M9(){if(op)return op;let r=p9(new _0(Xe.create({extensions:Wk}),0,!0));return op=r?r.options:[]}const I9=/code|horizontalrule|html|link|comment|processing|escape|entity|image|mark|url/i,R9=ge.domEventHandlers({paste:(r,e)=>{var t;let{main:i}=e.state.selection;if(i.empty)return!1;let s=(t=r.clipboardData)===null||t===void 0?void 0:t.getData("text/plain");if(!s||!/^(https?:\/\/|mailto:|xmpp:|www\.)/.test(s)||(/^www\./.test(s)&&(s="https://"+s),!Ih.isActiveAt(e.state,i.from,1)))return!1;let n=nt(e.state),a=!1;return n.iterate({from:i.from,to:i.to,enter:o=>{(o.from>i.from||I9.test(o.name))&&(a=!0)},leave:o=>{o.to<i.to&&(a=!0)}}),a?!1:(e.dispatch({changes:[{from:i.from,insert:"["},{from:i.to,insert:`](${s})`}],userEvent:"input.paste",scrollIntoView:!0}),!0)}});class L9 extends Nn{static targets=["textarea"];connect(){if(this.cm)return;const e=()=>this.initializeCodeMirror(),t=i=>{if(!i)return!1;const s=getComputedStyle(i);return!(s.display==="none"||s.visibility==="hidden"||!i.offsetParent&&s.position!=="fixed")};document.head&&this.element.isConnected&&t(this.element)?e():requestAnimationFrame(()=>{document.head&&this.element.isConnected&&t(this.element)&&e()})}async initializeCodeMirror(){const e=this.textareaTarget||this.element.querySelector("textarea");if(!e)return;const t=ge.theme({"&":{color:"#000",backgroundColor:"#fff"},".cm-content":{caretColor:"#000"},".cm-cursor, .cm-dropCursor":{borderLeft:"1px solid #000"},"&.cm-focused .cm-selectionBackground, .cm-selectionBackground, ::selection":{backgroundColor:"#d9d9d9"},".cm-gutters":{backgroundColor:"#f7f7f7",color:"#999",borderRight:"1px solid #ddd"}},{dark:!1}),i=ou.define([{tag:V.keyword,color:"#708"},{tag:V.atom,color:"#219"},{tag:V.number,color:"#164"},{tag:V.definition(V.variableName),color:"#00f"},{tag:V.variableName,color:"#000"},{tag:V.propertyName,color:"#00c"},{tag:V.typeName,color:"#085"},{tag:V.className,color:"#05a"},{tag:V.string,color:"#a11"},{tag:V.special(V.string),color:"#f50"},{tag:V.comment,color:"#a50"},{tag:V.meta,color:"#555"},{tag:V.link,color:"#00c",textDecoration:"underline"},{tag:V.tagName,color:"#170"},{tag:V.attributeName,color:"#00c"},{tag:V.bracket,color:"#997"},{tag:V.invalid,color:"#f00"}]),s=ge.updateListener.of(l=>{l.docChanged&&(e.value=l.state.doc.toString())}),n=[T7,P9(),t,I2(i,{fallback:!0}),s],a=document.createElement("div");a.className="cm-container",e.parentElement.insertBefore(a,e),this.cm=new ge({doc:e.value||"",parent:a,extensions:n}),e.hidden=!0,e.setAttribute("aria-hidden","true"),e.value=this.cm.state.doc.toString();const o=e.closest("form");o&&!this._syncedOnSubmit&&(this._syncedOnSubmit=!0,o.addEventListener("submit",()=>{e.value=this.cm.state.doc.toString()})),this.editor=this.cm,this.dispatch("ready",{detail:{view:this.cm}}),this.element.dataset.codemirrorReady="true",window.codeEditorInstances||(window.codeEditorInstances=new WeakMap),window.codeEditorInstances.set(this.element,this.cm),queueMicrotask(()=>requestAnimationFrame(()=>{}))}isVisible(e){if(!e)return!1;const t=getComputedStyle(e);return!(t.display==="none"||t.visibility==="hidden"||!e.offsetParent&&t.position!=="fixed")}insertText(e){if(console.log("=== CodeEditor insertText called ==="),console.log("Text to insert:",e),console.log("Editor available:",!!this.editor),this.editor&&this.editor.state){const t=this.editor.state.selection.main.head;console.log("Current cursor position:",t);const i=this.editor.state.update({changes:{from:t,insert:e}});this.editor.dispatch(i),this.editor.focus(),console.log("Text insertion completed successfully")}else console.warn("CodeMirror 6 editor not available for text insertion")}handleInsertText(e){console.log("=== CodeEditor received insert-text event ===");const t=e.detail.text;t&&(console.log("Inserting text via event:",t),this.insertText(t),this.dispatch("text-inserted",{detail:{text:t}}))}disconnect(){try{this.cm?.destroy()}finally{this.cm=null}this.editor=null,this.resizeHandler&&window.removeEventListener("resize",this.resizeHandler),this.orientationHandler&&window.removeEventListener("orientationchange",this.orientationHandler),this.boundInsertHandler&&(this.element.removeEventListener("code-editor:insert-text",this.boundInsertHandler),this.boundInsertHandler=null),window.codeEditorInstances&&window.codeEditorInstances.delete(this.element),this.element&&this.element.dataset&&delete this.element.dataset.codemirrorReady}}class Q9 extends Nn{static targets=["video"];connect(){console.log("VideoPlayer controller connected"),console.log("hasVideoTarget:",this.hasVideoTarget),console.log("videoTargets length:",this.videoTargets?this.videoTargets.length:"undefined"),console.log("All targets:",this.element.querySelectorAll('[data-video-player-target="video"]')),document.readyState==="loading"?document.addEventListener("DOMContentLoaded",()=>{console.log("DOMContentLoaded - calling initializePlayer"),this.initializePlayer()}):(console.log("Document already ready - calling initializePlayer"),this.initializePlayer())}disconnect(){this.player&&(this.player.dispose(),this.player=null)}initializePlayer(){console.log("initializePlayer called"),console.log("hasVideoTarget:",this.hasVideoTarget),console.log("videoTargets:",this.videoTargets);const e=this.element.querySelector('[data-video-player-target="video"]');if(console.log("Video element found:",e),!e){console.error("Video target element not found in controller element:",this.element);return}if(this.hasVideoTarget){console.log("Using hasVideoTarget path");const t=this.videoTarget;console.log("Video target:",t),console.log("Video target ID:",t.id),this.setupPlayer(t)}else console.log("Using direct query selector path"),console.log("Direct video element:",e),console.log("Direct video element ID:",e.id),this.setupPlayer(e)}setupPlayer(e){if(typeof H>"u"){console.error("Video.js library is not available");return}if(e.classList.contains("vjs-tech")){console.log("Video.js player already initialized for this element");return}this.player&&(console.log("Disposing existing player"),this.player.dispose(),this.player=null),e.classList.contains("video-js")||e.classList.add("video-js","vjs-default-skin");const t={fluid:!0,responsive:!0,controls:!0,playbackRates:[.5,1,1.25,1.5,2,4],language:"ja"};try{console.log("Attempting to initialize Video.js player with element:",e.id),this.player=H(e,t,()=>{console.log("Video.js player is ready")}),console.log("Player created successfully:",this.player)}catch(i){console.error("Failed to initialize Video.js player:",i)}}}var zo={exports:{}},$9=zo.exports,n1;function B9(){return n1||(n1=1,(function(r,e){(function(t,i){i(e)})($9,(function(t){var i=typeof window<"u"&&window.flatpickr!==void 0?window.flatpickr:{l10ns:{}},s={weekdays:{shorthand:["日","月","火","水","木","金","土"],longhand:["日曜日","月曜日","火曜日","水曜日","木曜日","金曜日","土曜日"]},months:{shorthand:["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月"],longhand:["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月"]},time_24hr:!0,rangeSeparator:" から ",monthAriaLabel:"月",amPM:["午前","午後"],yearAriaLabel:"年",hourAriaLabel:"時間",minuteAriaLabel:"分"};i.l10ns.ja=s;var n=i.l10ns;t.Japanese=s,t.default=n,Object.defineProperty(t,"__esModule",{value:!0})}))})(zo,zo.exports)),zo.exports}var N9=B9();class F9 extends Nn{static targets=["input"];static values={mode:String,dateFormat:String,locale:String};connect(){console.log("Flatpickr controller connected"),this.initializeFlatpickr()}initializeFlatpickr(){const e={mode:this.modeValue||"single",dateFormat:this.dateFormatValue||"Y/m/d",allowInput:!1,clickOpens:!0,locale:this.localeValue==="ja"?N9.Japanese:"default"};this.modeValue==="range"&&(e.mode="range",e.dateFormat="Y/m/d",e.separator=" 〜 "),this.flatpickr=Et(this.inputTarget,e),console.log("Flatpickr initialized with options:",e)}disconnect(){this.flatpickr&&this.flatpickr.destroy()}}window.videojs=H;window.flatpickr=Et;window.startPasskeyAuthentication=$A;window.startPasskeyRegistration=BA;console.log("Passkey functions loaded globally:",{auth:!!window.startPasskeyAuthentication,reg:!!window.startPasskeyRegistration});window.ActiveStorage||(window.ActiveStorage=sI,lg(),console.log("ActiveStorage initialized"));async function Hk(){return window.videojs?(console.log("Video.js already available:",!!window.videojs),window.videojs):(console.warn("Video.js not found on window object"),null)}window.loadVideoJS=Hk;console.log("Pre-loading Video.js...");Hk().then(()=>{console.log("Video.js pre-loaded successfully, window.videojs available:",!!window.videojs)}).catch(r=>{console.warn("Video.js pre-loading failed:",r)});const yd=LP.start();window.Stimulus=yd;yd.register("code-editor",L9);yd.register("video-player",Q9);yd.register("flatpickr",F9);console.log("Application loaded with esbuild (CodeMirror dynamic)");window.checkActiveStorageStatus=function(){const r={available:typeof window.ActiveStorage<"u",directUpload:typeof window.ActiveStorage?.DirectUpload=="function",started:window.ActiveStorage?.started||!1};return console.log("ActiveStorage Status:",r),r};document.addEventListener("turbo:before-fetch-request",r=>{const e=document.querySelector('meta[name="csrf-token"]').getAttribute("content");e&&(r.detail.fetchOptions.headers["X-CSRF-Token"]=e)});console.log("ActiveStorage initialized and ready");console.log("[Vite entry] application.js loaded at",new Date);location.pathname.startsWith("/posts/new")&&UA(()=>import("./new-DbwhxP13.js").then(r=>r._),__vite__mapDeps([0,1]));
//# sourceMappingURL=application-DPE5Liym.js.map
