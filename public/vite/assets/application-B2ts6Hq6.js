import{s as HL,a as WL}from"./new-dcje0AiI.js";class ZL{constructor(e,t,i){this.eventTarget=e,this.eventName=t,this.eventOptions=i,this.unorderedBindings=new Set}connect(){this.eventTarget.addEventListener(this.eventName,this,this.eventOptions)}disconnect(){this.eventTarget.removeEventListener(this.eventName,this,this.eventOptions)}bindingConnected(e){this.unorderedBindings.add(e)}bindingDisconnected(e){this.unorderedBindings.delete(e)}handleEvent(e){const t=YL(e);for(const i of this.bindings){if(t.immediatePropagationStopped)break;i.handleEvent(t)}}hasBindings(){return this.unorderedBindings.size>0}get bindings(){return Array.from(this.unorderedBindings).sort((e,t)=>{const i=e.index,s=t.index;return i<s?-1:i>s?1:0})}}function YL(n){if("immediatePropagationStopped"in n)return n;{const{stopImmediatePropagation:e}=n;return Object.assign(n,{immediatePropagationStopped:!1,stopImmediatePropagation(){this.immediatePropagationStopped=!0,e.call(this)}})}}class GL{constructor(e){this.application=e,this.eventListenerMaps=new Map,this.started=!1}start(){this.started||(this.started=!0,this.eventListeners.forEach(e=>e.connect()))}stop(){this.started&&(this.started=!1,this.eventListeners.forEach(e=>e.disconnect()))}get eventListeners(){return Array.from(this.eventListenerMaps.values()).reduce((e,t)=>e.concat(Array.from(t.values())),[])}bindingConnected(e){this.fetchEventListenerForBinding(e).bindingConnected(e)}bindingDisconnected(e,t=!1){this.fetchEventListenerForBinding(e).bindingDisconnected(e),t&&this.clearEventListenersForBinding(e)}handleError(e,t,i={}){this.application.handleError(e,`Error ${t}`,i)}clearEventListenersForBinding(e){const t=this.fetchEventListenerForBinding(e);t.hasBindings()||(t.disconnect(),this.removeMappedEventListenerFor(e))}removeMappedEventListenerFor(e){const{eventTarget:t,eventName:i,eventOptions:s}=e,r=this.fetchEventListenerMapForEventTarget(t),o=this.cacheKey(i,s);r.delete(o),r.size==0&&this.eventListenerMaps.delete(t)}fetchEventListenerForBinding(e){const{eventTarget:t,eventName:i,eventOptions:s}=e;return this.fetchEventListener(t,i,s)}fetchEventListener(e,t,i){const s=this.fetchEventListenerMapForEventTarget(e),r=this.cacheKey(t,i);let o=s.get(r);return o||(o=this.createEventListener(e,t,i),s.set(r,o)),o}createEventListener(e,t,i){const s=new ZL(e,t,i);return this.started&&s.connect(),s}fetchEventListenerMapForEventTarget(e){let t=this.eventListenerMaps.get(e);return t||(t=new Map,this.eventListenerMaps.set(e,t)),t}cacheKey(e,t){const i=[e];return Object.keys(t).sort().forEach(s=>{i.push(`${t[s]?"":"!"}${s}`)}),i.join(":")}}const KL={stop({event:n,value:e}){return e&&n.stopPropagation(),!0},prevent({event:n,value:e}){return e&&n.preventDefault(),!0},self({event:n,value:e,element:t}){return e?t===n.target:!0}},JL=/^(?:(?:([^.]+?)\+)?(.+?)(?:\.(.+?))?(?:@(window|document))?->)?(.+?)(?:#([^:]+?))(?::(.+))?$/;function e$(n){const t=n.trim().match(JL)||[];let i=t[2],s=t[3];return s&&!["keydown","keyup","keypress"].includes(i)&&(i+=`.${s}`,s=""),{eventTarget:t$(t[4]),eventName:i,eventOptions:t[7]?i$(t[7]):{},identifier:t[5],methodName:t[6],keyFilter:t[1]||s}}function t$(n){if(n=="window")return window;if(n=="document")return document}function i$(n){return n.split(":").reduce((e,t)=>Object.assign(e,{[t.replace(/^!/,"")]:!/^!/.test(t)}),{})}function n$(n){if(n==window)return"window";if(n==document)return"document"}function hy(n){return n.replace(/(?:[_-])([a-z0-9])/g,(e,t)=>t.toUpperCase())}function Ig(n){return hy(n.replace(/--/g,"-").replace(/__/g,"_"))}function gu(n){return n.charAt(0).toUpperCase()+n.slice(1)}function D_(n){return n.replace(/([A-Z])/g,(e,t)=>`-${t.toLowerCase()}`)}function s$(n){return n.match(/[^\s]+/g)||[]}function s1(n){return n!=null}function Rg(n,e){return Object.prototype.hasOwnProperty.call(n,e)}const r1=["meta","ctrl","alt","shift"];class r${constructor(e,t,i,s){this.element=e,this.index=t,this.eventTarget=i.eventTarget||e,this.eventName=i.eventName||o$(e)||rc("missing event name"),this.eventOptions=i.eventOptions||{},this.identifier=i.identifier||rc("missing identifier"),this.methodName=i.methodName||rc("missing method name"),this.keyFilter=i.keyFilter||"",this.schema=s}static forToken(e,t){return new this(e.element,e.index,e$(e.content),t)}toString(){const e=this.keyFilter?`.${this.keyFilter}`:"",t=this.eventTargetName?`@${this.eventTargetName}`:"";return`${this.eventName}${e}${t}->${this.identifier}#${this.methodName}`}shouldIgnoreKeyboardEvent(e){if(!this.keyFilter)return!1;const t=this.keyFilter.split("+");if(this.keyFilterDissatisfied(e,t))return!0;const i=t.filter(s=>!r1.includes(s))[0];return i?(Rg(this.keyMappings,i)||rc(`contains unknown key filter: ${this.keyFilter}`),this.keyMappings[i].toLowerCase()!==e.key.toLowerCase()):!1}shouldIgnoreMouseEvent(e){if(!this.keyFilter)return!1;const t=[this.keyFilter];return!!this.keyFilterDissatisfied(e,t)}get params(){const e={},t=new RegExp(`^data-${this.identifier}-(.+)-param$`,"i");for(const{name:i,value:s}of Array.from(this.element.attributes)){const r=i.match(t),o=r&&r[1];o&&(e[hy(o)]=a$(s))}return e}get eventTargetName(){return n$(this.eventTarget)}get keyMappings(){return this.schema.keyMappings}keyFilterDissatisfied(e,t){const[i,s,r,o]=r1.map(a=>t.includes(a));return e.metaKey!==i||e.ctrlKey!==s||e.altKey!==r||e.shiftKey!==o}}const o1={a:()=>"click",button:()=>"click",form:()=>"submit",details:()=>"toggle",input:n=>n.getAttribute("type")=="submit"?"click":"input",select:()=>"change",textarea:()=>"input"};function o$(n){const e=n.tagName.toLowerCase();if(e in o1)return o1[e](n)}function rc(n){throw new Error(n)}function a$(n){try{return JSON.parse(n)}catch{return n}}class l${constructor(e,t){this.context=e,this.action=t}get index(){return this.action.index}get eventTarget(){return this.action.eventTarget}get eventOptions(){return this.action.eventOptions}get identifier(){return this.context.identifier}handleEvent(e){const t=this.prepareActionEvent(e);this.willBeInvokedByEvent(e)&&this.applyEventModifiers(t)&&this.invokeWithEvent(t)}get eventName(){return this.action.eventName}get method(){const e=this.controller[this.methodName];if(typeof e=="function")return e;throw new Error(`Action "${this.action}" references undefined method "${this.methodName}"`)}applyEventModifiers(e){const{element:t}=this.action,{actionDescriptorFilters:i}=this.context.application,{controller:s}=this.context;let r=!0;for(const[o,a]of Object.entries(this.eventOptions))if(o in i){const l=i[o];r=r&&l({name:o,value:a,event:e,element:t,controller:s})}else continue;return r}prepareActionEvent(e){return Object.assign(e,{params:this.action.params})}invokeWithEvent(e){const{target:t,currentTarget:i}=e;try{this.method.call(this.controller,e),this.context.logDebugActivity(this.methodName,{event:e,target:t,currentTarget:i,action:this.methodName})}catch(s){const{identifier:r,controller:o,element:a,index:l}=this,h={identifier:r,controller:o,element:a,index:l,event:e};this.context.handleError(s,`invoking action "${this.action}"`,h)}}willBeInvokedByEvent(e){const t=e.target;return e instanceof KeyboardEvent&&this.action.shouldIgnoreKeyboardEvent(e)||e instanceof MouseEvent&&this.action.shouldIgnoreMouseEvent(e)?!1:this.element===t?!0:t instanceof Element&&this.element.contains(t)?this.scope.containsElement(t):this.scope.containsElement(this.action.element)}get controller(){return this.context.controller}get methodName(){return this.action.methodName}get element(){return this.scope.element}get scope(){return this.context.scope}}class M_{constructor(e,t){this.mutationObserverInit={attributes:!0,childList:!0,subtree:!0},this.element=e,this.started=!1,this.delegate=t,this.elements=new Set,this.mutationObserver=new MutationObserver(i=>this.processMutations(i))}start(){this.started||(this.started=!0,this.mutationObserver.observe(this.element,this.mutationObserverInit),this.refresh())}pause(e){this.started&&(this.mutationObserver.disconnect(),this.started=!1),e(),this.started||(this.mutationObserver.observe(this.element,this.mutationObserverInit),this.started=!0)}stop(){this.started&&(this.mutationObserver.takeRecords(),this.mutationObserver.disconnect(),this.started=!1)}refresh(){if(this.started){const e=new Set(this.matchElementsInTree());for(const t of Array.from(this.elements))e.has(t)||this.removeElement(t);for(const t of Array.from(e))this.addElement(t)}}processMutations(e){if(this.started)for(const t of e)this.processMutation(t)}processMutation(e){e.type=="attributes"?this.processAttributeChange(e.target,e.attributeName):e.type=="childList"&&(this.processRemovedNodes(e.removedNodes),this.processAddedNodes(e.addedNodes))}processAttributeChange(e,t){this.elements.has(e)?this.delegate.elementAttributeChanged&&this.matchElement(e)?this.delegate.elementAttributeChanged(e,t):this.removeElement(e):this.matchElement(e)&&this.addElement(e)}processRemovedNodes(e){for(const t of Array.from(e)){const i=this.elementFromNode(t);i&&this.processTree(i,this.removeElement)}}processAddedNodes(e){for(const t of Array.from(e)){const i=this.elementFromNode(t);i&&this.elementIsActive(i)&&this.processTree(i,this.addElement)}}matchElement(e){return this.delegate.matchElement(e)}matchElementsInTree(e=this.element){return this.delegate.matchElementsInTree(e)}processTree(e,t){for(const i of this.matchElementsInTree(e))t.call(this,i)}elementFromNode(e){if(e.nodeType==Node.ELEMENT_NODE)return e}elementIsActive(e){return e.isConnected!=this.element.isConnected?!1:this.element.contains(e)}addElement(e){this.elements.has(e)||this.elementIsActive(e)&&(this.elements.add(e),this.delegate.elementMatched&&this.delegate.elementMatched(e))}removeElement(e){this.elements.has(e)&&(this.elements.delete(e),this.delegate.elementUnmatched&&this.delegate.elementUnmatched(e))}}class I_{constructor(e,t,i){this.attributeName=t,this.delegate=i,this.elementObserver=new M_(e,this)}get element(){return this.elementObserver.element}get selector(){return`[${this.attributeName}]`}start(){this.elementObserver.start()}pause(e){this.elementObserver.pause(e)}stop(){this.elementObserver.stop()}refresh(){this.elementObserver.refresh()}get started(){return this.elementObserver.started}matchElement(e){return e.hasAttribute(this.attributeName)}matchElementsInTree(e){const t=this.matchElement(e)?[e]:[],i=Array.from(e.querySelectorAll(this.selector));return t.concat(i)}elementMatched(e){this.delegate.elementMatchedAttribute&&this.delegate.elementMatchedAttribute(e,this.attributeName)}elementUnmatched(e){this.delegate.elementUnmatchedAttribute&&this.delegate.elementUnmatchedAttribute(e,this.attributeName)}elementAttributeChanged(e,t){this.delegate.elementAttributeValueChanged&&this.attributeName==t&&this.delegate.elementAttributeValueChanged(e,t)}}function h$(n,e,t){R_(n,e).add(t)}function u$(n,e,t){R_(n,e).delete(t),c$(n,e)}function R_(n,e){let t=n.get(e);return t||(t=new Set,n.set(e,t)),t}function c$(n,e){const t=n.get(e);t!=null&&t.size==0&&n.delete(e)}class So{constructor(){this.valuesByKey=new Map}get keys(){return Array.from(this.valuesByKey.keys())}get values(){return Array.from(this.valuesByKey.values()).reduce((t,i)=>t.concat(Array.from(i)),[])}get size(){return Array.from(this.valuesByKey.values()).reduce((t,i)=>t+i.size,0)}add(e,t){h$(this.valuesByKey,e,t)}delete(e,t){u$(this.valuesByKey,e,t)}has(e,t){const i=this.valuesByKey.get(e);return i!=null&&i.has(t)}hasKey(e){return this.valuesByKey.has(e)}hasValue(e){return Array.from(this.valuesByKey.values()).some(i=>i.has(e))}getValuesForKey(e){const t=this.valuesByKey.get(e);return t?Array.from(t):[]}getKeysForValue(e){return Array.from(this.valuesByKey).filter(([t,i])=>i.has(e)).map(([t,i])=>t)}}class d${constructor(e,t,i,s){this._selector=t,this.details=s,this.elementObserver=new M_(e,this),this.delegate=i,this.matchesByElement=new So}get started(){return this.elementObserver.started}get selector(){return this._selector}set selector(e){this._selector=e,this.refresh()}start(){this.elementObserver.start()}pause(e){this.elementObserver.pause(e)}stop(){this.elementObserver.stop()}refresh(){this.elementObserver.refresh()}get element(){return this.elementObserver.element}matchElement(e){const{selector:t}=this;if(t){const i=e.matches(t);return this.delegate.selectorMatchElement?i&&this.delegate.selectorMatchElement(e,this.details):i}else return!1}matchElementsInTree(e){const{selector:t}=this;if(t){const i=this.matchElement(e)?[e]:[],s=Array.from(e.querySelectorAll(t)).filter(r=>this.matchElement(r));return i.concat(s)}else return[]}elementMatched(e){const{selector:t}=this;t&&this.selectorMatched(e,t)}elementUnmatched(e){const t=this.matchesByElement.getKeysForValue(e);for(const i of t)this.selectorUnmatched(e,i)}elementAttributeChanged(e,t){const{selector:i}=this;if(i){const s=this.matchElement(e),r=this.matchesByElement.has(i,e);s&&!r?this.selectorMatched(e,i):!s&&r&&this.selectorUnmatched(e,i)}}selectorMatched(e,t){this.delegate.selectorMatched(e,t,this.details),this.matchesByElement.add(t,e)}selectorUnmatched(e,t){this.delegate.selectorUnmatched(e,t,this.details),this.matchesByElement.delete(t,e)}}class f${constructor(e,t){this.element=e,this.delegate=t,this.started=!1,this.stringMap=new Map,this.mutationObserver=new MutationObserver(i=>this.processMutations(i))}start(){this.started||(this.started=!0,this.mutationObserver.observe(this.element,{attributes:!0,attributeOldValue:!0}),this.refresh())}stop(){this.started&&(this.mutationObserver.takeRecords(),this.mutationObserver.disconnect(),this.started=!1)}refresh(){if(this.started)for(const e of this.knownAttributeNames)this.refreshAttribute(e,null)}processMutations(e){if(this.started)for(const t of e)this.processMutation(t)}processMutation(e){const t=e.attributeName;t&&this.refreshAttribute(t,e.oldValue)}refreshAttribute(e,t){const i=this.delegate.getStringMapKeyForAttribute(e);if(i!=null){this.stringMap.has(e)||this.stringMapKeyAdded(i,e);const s=this.element.getAttribute(e);if(this.stringMap.get(e)!=s&&this.stringMapValueChanged(s,i,t),s==null){const r=this.stringMap.get(e);this.stringMap.delete(e),r&&this.stringMapKeyRemoved(i,e,r)}else this.stringMap.set(e,s)}}stringMapKeyAdded(e,t){this.delegate.stringMapKeyAdded&&this.delegate.stringMapKeyAdded(e,t)}stringMapValueChanged(e,t,i){this.delegate.stringMapValueChanged&&this.delegate.stringMapValueChanged(e,t,i)}stringMapKeyRemoved(e,t,i){this.delegate.stringMapKeyRemoved&&this.delegate.stringMapKeyRemoved(e,t,i)}get knownAttributeNames(){return Array.from(new Set(this.currentAttributeNames.concat(this.recordedAttributeNames)))}get currentAttributeNames(){return Array.from(this.element.attributes).map(e=>e.name)}get recordedAttributeNames(){return Array.from(this.stringMap.keys())}}class L_{constructor(e,t,i){this.attributeObserver=new I_(e,t,this),this.delegate=i,this.tokensByElement=new So}get started(){return this.attributeObserver.started}start(){this.attributeObserver.start()}pause(e){this.attributeObserver.pause(e)}stop(){this.attributeObserver.stop()}refresh(){this.attributeObserver.refresh()}get element(){return this.attributeObserver.element}get attributeName(){return this.attributeObserver.attributeName}elementMatchedAttribute(e){this.tokensMatched(this.readTokensForElement(e))}elementAttributeValueChanged(e){const[t,i]=this.refreshTokensForElement(e);this.tokensUnmatched(t),this.tokensMatched(i)}elementUnmatchedAttribute(e){this.tokensUnmatched(this.tokensByElement.getValuesForKey(e))}tokensMatched(e){e.forEach(t=>this.tokenMatched(t))}tokensUnmatched(e){e.forEach(t=>this.tokenUnmatched(t))}tokenMatched(e){this.delegate.tokenMatched(e),this.tokensByElement.add(e.element,e)}tokenUnmatched(e){this.delegate.tokenUnmatched(e),this.tokensByElement.delete(e.element,e)}refreshTokensForElement(e){const t=this.tokensByElement.getValuesForKey(e),i=this.readTokensForElement(e),s=m$(t,i).findIndex(([r,o])=>!g$(r,o));return s==-1?[[],[]]:[t.slice(s),i.slice(s)]}readTokensForElement(e){const t=this.attributeName,i=e.getAttribute(t)||"";return p$(i,e,t)}}function p$(n,e,t){return n.trim().split(/\s+/).filter(i=>i.length).map((i,s)=>({element:e,attributeName:t,content:i,index:s}))}function m$(n,e){const t=Math.max(n.length,e.length);return Array.from({length:t},(i,s)=>[n[s],e[s]])}function g$(n,e){return n&&e&&n.index==e.index&&n.content==e.content}class $_{constructor(e,t,i){this.tokenListObserver=new L_(e,t,this),this.delegate=i,this.parseResultsByToken=new WeakMap,this.valuesByTokenByElement=new WeakMap}get started(){return this.tokenListObserver.started}start(){this.tokenListObserver.start()}stop(){this.tokenListObserver.stop()}refresh(){this.tokenListObserver.refresh()}get element(){return this.tokenListObserver.element}get attributeName(){return this.tokenListObserver.attributeName}tokenMatched(e){const{element:t}=e,{value:i}=this.fetchParseResultForToken(e);i&&(this.fetchValuesByTokenForElement(t).set(e,i),this.delegate.elementMatchedValue(t,i))}tokenUnmatched(e){const{element:t}=e,{value:i}=this.fetchParseResultForToken(e);i&&(this.fetchValuesByTokenForElement(t).delete(e),this.delegate.elementUnmatchedValue(t,i))}fetchParseResultForToken(e){let t=this.parseResultsByToken.get(e);return t||(t=this.parseToken(e),this.parseResultsByToken.set(e,t)),t}fetchValuesByTokenForElement(e){let t=this.valuesByTokenByElement.get(e);return t||(t=new Map,this.valuesByTokenByElement.set(e,t)),t}parseToken(e){try{return{value:this.delegate.parseValueForToken(e)}}catch(t){return{error:t}}}}class O${constructor(e,t){this.context=e,this.delegate=t,this.bindingsByAction=new Map}start(){this.valueListObserver||(this.valueListObserver=new $_(this.element,this.actionAttribute,this),this.valueListObserver.start())}stop(){this.valueListObserver&&(this.valueListObserver.stop(),delete this.valueListObserver,this.disconnectAllActions())}get element(){return this.context.element}get identifier(){return this.context.identifier}get actionAttribute(){return this.schema.actionAttribute}get schema(){return this.context.schema}get bindings(){return Array.from(this.bindingsByAction.values())}connectAction(e){const t=new l$(this.context,e);this.bindingsByAction.set(e,t),this.delegate.bindingConnected(t)}disconnectAction(e){const t=this.bindingsByAction.get(e);t&&(this.bindingsByAction.delete(e),this.delegate.bindingDisconnected(t))}disconnectAllActions(){this.bindings.forEach(e=>this.delegate.bindingDisconnected(e,!0)),this.bindingsByAction.clear()}parseValueForToken(e){const t=r$.forToken(e,this.schema);if(t.identifier==this.identifier)return t}elementMatchedValue(e,t){this.connectAction(t)}elementUnmatchedValue(e,t){this.disconnectAction(t)}}class y${constructor(e,t){this.context=e,this.receiver=t,this.stringMapObserver=new f$(this.element,this),this.valueDescriptorMap=this.controller.valueDescriptorMap}start(){this.stringMapObserver.start(),this.invokeChangedCallbacksForDefaultValues()}stop(){this.stringMapObserver.stop()}get element(){return this.context.element}get controller(){return this.context.controller}getStringMapKeyForAttribute(e){if(e in this.valueDescriptorMap)return this.valueDescriptorMap[e].name}stringMapKeyAdded(e,t){const i=this.valueDescriptorMap[t];this.hasValue(e)||this.invokeChangedCallback(e,i.writer(this.receiver[e]),i.writer(i.defaultValue))}stringMapValueChanged(e,t,i){const s=this.valueDescriptorNameMap[t];e!==null&&(i===null&&(i=s.writer(s.defaultValue)),this.invokeChangedCallback(t,e,i))}stringMapKeyRemoved(e,t,i){const s=this.valueDescriptorNameMap[e];this.hasValue(e)?this.invokeChangedCallback(e,s.writer(this.receiver[e]),i):this.invokeChangedCallback(e,s.writer(s.defaultValue),i)}invokeChangedCallbacksForDefaultValues(){for(const{key:e,name:t,defaultValue:i,writer:s}of this.valueDescriptors)i!=null&&!this.controller.data.has(e)&&this.invokeChangedCallback(t,s(i),void 0)}invokeChangedCallback(e,t,i){const s=`${e}Changed`,r=this.receiver[s];if(typeof r=="function"){const o=this.valueDescriptorNameMap[e];try{const a=o.reader(t);let l=i;i&&(l=o.reader(i)),r.call(this.receiver,a,l)}catch(a){throw a instanceof TypeError&&(a.message=`Stimulus Value "${this.context.identifier}.${o.name}" - ${a.message}`),a}}}get valueDescriptors(){const{valueDescriptorMap:e}=this;return Object.keys(e).map(t=>e[t])}get valueDescriptorNameMap(){const e={};return Object.keys(this.valueDescriptorMap).forEach(t=>{const i=this.valueDescriptorMap[t];e[i.name]=i}),e}hasValue(e){const t=this.valueDescriptorNameMap[e],i=`has${gu(t.name)}`;return this.receiver[i]}}class b${constructor(e,t){this.context=e,this.delegate=t,this.targetsByName=new So}start(){this.tokenListObserver||(this.tokenListObserver=new L_(this.element,this.attributeName,this),this.tokenListObserver.start())}stop(){this.tokenListObserver&&(this.disconnectAllTargets(),this.tokenListObserver.stop(),delete this.tokenListObserver)}tokenMatched({element:e,content:t}){this.scope.containsElement(e)&&this.connectTarget(e,t)}tokenUnmatched({element:e,content:t}){this.disconnectTarget(e,t)}connectTarget(e,t){var i;this.targetsByName.has(t,e)||(this.targetsByName.add(t,e),(i=this.tokenListObserver)===null||i===void 0||i.pause(()=>this.delegate.targetConnected(e,t)))}disconnectTarget(e,t){var i;this.targetsByName.has(t,e)&&(this.targetsByName.delete(t,e),(i=this.tokenListObserver)===null||i===void 0||i.pause(()=>this.delegate.targetDisconnected(e,t)))}disconnectAllTargets(){for(const e of this.targetsByName.keys)for(const t of this.targetsByName.getValuesForKey(e))this.disconnectTarget(t,e)}get attributeName(){return`data-${this.context.identifier}-target`}get element(){return this.context.element}get scope(){return this.context.scope}}function Ou(n,e){const t=Q_(n);return Array.from(t.reduce((i,s)=>(S$(s,e).forEach(r=>i.add(r)),i),new Set))}function v$(n,e){return Q_(n).reduce((i,s)=>(i.push(...x$(s,e)),i),[])}function Q_(n){const e=[];for(;n;)e.push(n),n=Object.getPrototypeOf(n);return e.reverse()}function S$(n,e){const t=n[e];return Array.isArray(t)?t:[]}function x$(n,e){const t=n[e];return t?Object.keys(t).map(i=>[i,t[i]]):[]}class T${constructor(e,t){this.started=!1,this.context=e,this.delegate=t,this.outletsByName=new So,this.outletElementsByName=new So,this.selectorObserverMap=new Map,this.attributeObserverMap=new Map}start(){this.started||(this.outletDefinitions.forEach(e=>{this.setupSelectorObserverForOutlet(e),this.setupAttributeObserverForOutlet(e)}),this.started=!0,this.dependentContexts.forEach(e=>e.refresh()))}refresh(){this.selectorObserverMap.forEach(e=>e.refresh()),this.attributeObserverMap.forEach(e=>e.refresh())}stop(){this.started&&(this.started=!1,this.disconnectAllOutlets(),this.stopSelectorObservers(),this.stopAttributeObservers())}stopSelectorObservers(){this.selectorObserverMap.size>0&&(this.selectorObserverMap.forEach(e=>e.stop()),this.selectorObserverMap.clear())}stopAttributeObservers(){this.attributeObserverMap.size>0&&(this.attributeObserverMap.forEach(e=>e.stop()),this.attributeObserverMap.clear())}selectorMatched(e,t,{outletName:i}){const s=this.getOutlet(e,i);s&&this.connectOutlet(s,e,i)}selectorUnmatched(e,t,{outletName:i}){const s=this.getOutletFromMap(e,i);s&&this.disconnectOutlet(s,e,i)}selectorMatchElement(e,{outletName:t}){const i=this.selector(t),s=this.hasOutlet(e,t),r=e.matches(`[${this.schema.controllerAttribute}~=${t}]`);return i?s&&r&&e.matches(i):!1}elementMatchedAttribute(e,t){const i=this.getOutletNameFromOutletAttributeName(t);i&&this.updateSelectorObserverForOutlet(i)}elementAttributeValueChanged(e,t){const i=this.getOutletNameFromOutletAttributeName(t);i&&this.updateSelectorObserverForOutlet(i)}elementUnmatchedAttribute(e,t){const i=this.getOutletNameFromOutletAttributeName(t);i&&this.updateSelectorObserverForOutlet(i)}connectOutlet(e,t,i){var s;this.outletElementsByName.has(i,t)||(this.outletsByName.add(i,e),this.outletElementsByName.add(i,t),(s=this.selectorObserverMap.get(i))===null||s===void 0||s.pause(()=>this.delegate.outletConnected(e,t,i)))}disconnectOutlet(e,t,i){var s;this.outletElementsByName.has(i,t)&&(this.outletsByName.delete(i,e),this.outletElementsByName.delete(i,t),(s=this.selectorObserverMap.get(i))===null||s===void 0||s.pause(()=>this.delegate.outletDisconnected(e,t,i)))}disconnectAllOutlets(){for(const e of this.outletElementsByName.keys)for(const t of this.outletElementsByName.getValuesForKey(e))for(const i of this.outletsByName.getValuesForKey(e))this.disconnectOutlet(i,t,e)}updateSelectorObserverForOutlet(e){const t=this.selectorObserverMap.get(e);t&&(t.selector=this.selector(e))}setupSelectorObserverForOutlet(e){const t=this.selector(e),i=new d$(document.body,t,this,{outletName:e});this.selectorObserverMap.set(e,i),i.start()}setupAttributeObserverForOutlet(e){const t=this.attributeNameForOutletName(e),i=new I_(this.scope.element,t,this);this.attributeObserverMap.set(e,i),i.start()}selector(e){return this.scope.outlets.getSelectorForOutletName(e)}attributeNameForOutletName(e){return this.scope.schema.outletAttributeForScope(this.identifier,e)}getOutletNameFromOutletAttributeName(e){return this.outletDefinitions.find(t=>this.attributeNameForOutletName(t)===e)}get outletDependencies(){const e=new So;return this.router.modules.forEach(t=>{const i=t.definition.controllerConstructor;Ou(i,"outlets").forEach(r=>e.add(r,t.identifier))}),e}get outletDefinitions(){return this.outletDependencies.getKeysForValue(this.identifier)}get dependentControllerIdentifiers(){return this.outletDependencies.getValuesForKey(this.identifier)}get dependentContexts(){const e=this.dependentControllerIdentifiers;return this.router.contexts.filter(t=>e.includes(t.identifier))}hasOutlet(e,t){return!!this.getOutlet(e,t)||!!this.getOutletFromMap(e,t)}getOutlet(e,t){return this.application.getControllerForElementAndIdentifier(e,t)}getOutletFromMap(e,t){return this.outletsByName.getValuesForKey(t).find(i=>i.element===e)}get scope(){return this.context.scope}get schema(){return this.context.schema}get identifier(){return this.context.identifier}get application(){return this.context.application}get router(){return this.application.router}}let w$=class{constructor(e,t){this.logDebugActivity=(i,s={})=>{const{identifier:r,controller:o,element:a}=this;s=Object.assign({identifier:r,controller:o,element:a},s),this.application.logDebugActivity(this.identifier,i,s)},this.module=e,this.scope=t,this.controller=new e.controllerConstructor(this),this.bindingObserver=new O$(this,this.dispatcher),this.valueObserver=new y$(this,this.controller),this.targetObserver=new b$(this,this),this.outletObserver=new T$(this,this);try{this.controller.initialize(),this.logDebugActivity("initialize")}catch(i){this.handleError(i,"initializing controller")}}connect(){this.bindingObserver.start(),this.valueObserver.start(),this.targetObserver.start(),this.outletObserver.start();try{this.controller.connect(),this.logDebugActivity("connect")}catch(e){this.handleError(e,"connecting controller")}}refresh(){this.outletObserver.refresh()}disconnect(){try{this.controller.disconnect(),this.logDebugActivity("disconnect")}catch(e){this.handleError(e,"disconnecting controller")}this.outletObserver.stop(),this.targetObserver.stop(),this.valueObserver.stop(),this.bindingObserver.stop()}get application(){return this.module.application}get identifier(){return this.module.identifier}get schema(){return this.application.schema}get dispatcher(){return this.application.dispatcher}get element(){return this.scope.element}get parentElement(){return this.element.parentElement}handleError(e,t,i={}){const{identifier:s,controller:r,element:o}=this;i=Object.assign({identifier:s,controller:r,element:o},i),this.application.handleError(e,`Error ${t}`,i)}targetConnected(e,t){this.invokeControllerMethod(`${t}TargetConnected`,e)}targetDisconnected(e,t){this.invokeControllerMethod(`${t}TargetDisconnected`,e)}outletConnected(e,t,i){this.invokeControllerMethod(`${Ig(i)}OutletConnected`,e,t)}outletDisconnected(e,t,i){this.invokeControllerMethod(`${Ig(i)}OutletDisconnected`,e,t)}invokeControllerMethod(e,...t){const i=this.controller;typeof i[e]=="function"&&i[e](...t)}};function _$(n){return k$(n,C$(n))}function k$(n,e){const t=D$(n),i=E$(n.prototype,e);return Object.defineProperties(t.prototype,i),t}function C$(n){return Ou(n,"blessings").reduce((t,i)=>{const s=i(n);for(const r in s){const o=t[r]||{};t[r]=Object.assign(o,s[r])}return t},{})}function E$(n,e){return P$(e).reduce((t,i)=>{const s=A$(n,e,i);return s&&Object.assign(t,{[i]:s}),t},{})}function A$(n,e,t){const i=Object.getOwnPropertyDescriptor(n,t);if(!(i&&"value"in i)){const r=Object.getOwnPropertyDescriptor(e,t).value;return i&&(r.get=i.get||r.get,r.set=i.set||r.set),r}}const P$=typeof Object.getOwnPropertySymbols=="function"?n=>[...Object.getOwnPropertyNames(n),...Object.getOwnPropertySymbols(n)]:Object.getOwnPropertyNames,D$=(()=>{function n(t){function i(){return Reflect.construct(t,arguments,new.target)}return i.prototype=Object.create(t.prototype,{constructor:{value:i}}),Reflect.setPrototypeOf(i,t),i}function e(){const i=n(function(){this.a.call(this)});return i.prototype.a=function(){},new i}try{return e(),n}catch{return i=>class extends i{}}})();function M$(n){return{identifier:n.identifier,controllerConstructor:_$(n.controllerConstructor)}}class I${constructor(e,t){this.application=e,this.definition=M$(t),this.contextsByScope=new WeakMap,this.connectedContexts=new Set}get identifier(){return this.definition.identifier}get controllerConstructor(){return this.definition.controllerConstructor}get contexts(){return Array.from(this.connectedContexts)}connectContextForScope(e){const t=this.fetchContextForScope(e);this.connectedContexts.add(t),t.connect()}disconnectContextForScope(e){const t=this.contextsByScope.get(e);t&&(this.connectedContexts.delete(t),t.disconnect())}fetchContextForScope(e){let t=this.contextsByScope.get(e);return t||(t=new w$(this,e),this.contextsByScope.set(e,t)),t}}class R${constructor(e){this.scope=e}has(e){return this.data.has(this.getDataKey(e))}get(e){return this.getAll(e)[0]}getAll(e){const t=this.data.get(this.getDataKey(e))||"";return s$(t)}getAttributeName(e){return this.data.getAttributeNameForKey(this.getDataKey(e))}getDataKey(e){return`${e}-class`}get data(){return this.scope.data}}class L${constructor(e){this.scope=e}get element(){return this.scope.element}get identifier(){return this.scope.identifier}get(e){const t=this.getAttributeNameForKey(e);return this.element.getAttribute(t)}set(e,t){const i=this.getAttributeNameForKey(e);return this.element.setAttribute(i,t),this.get(e)}has(e){const t=this.getAttributeNameForKey(e);return this.element.hasAttribute(t)}delete(e){if(this.has(e)){const t=this.getAttributeNameForKey(e);return this.element.removeAttribute(t),!0}else return!1}getAttributeNameForKey(e){return`data-${this.identifier}-${D_(e)}`}}class $${constructor(e){this.warnedKeysByObject=new WeakMap,this.logger=e}warn(e,t,i){let s=this.warnedKeysByObject.get(e);s||(s=new Set,this.warnedKeysByObject.set(e,s)),s.has(t)||(s.add(t),this.logger.warn(i,e))}}function Lg(n,e){return`[${n}~="${e}"]`}class Q${constructor(e){this.scope=e}get element(){return this.scope.element}get identifier(){return this.scope.identifier}get schema(){return this.scope.schema}has(e){return this.find(e)!=null}find(...e){return e.reduce((t,i)=>t||this.findTarget(i)||this.findLegacyTarget(i),void 0)}findAll(...e){return e.reduce((t,i)=>[...t,...this.findAllTargets(i),...this.findAllLegacyTargets(i)],[])}findTarget(e){const t=this.getSelectorForTargetName(e);return this.scope.findElement(t)}findAllTargets(e){const t=this.getSelectorForTargetName(e);return this.scope.findAllElements(t)}getSelectorForTargetName(e){const t=this.schema.targetAttributeForScope(this.identifier);return Lg(t,e)}findLegacyTarget(e){const t=this.getLegacySelectorForTargetName(e);return this.deprecate(this.scope.findElement(t),e)}findAllLegacyTargets(e){const t=this.getLegacySelectorForTargetName(e);return this.scope.findAllElements(t).map(i=>this.deprecate(i,e))}getLegacySelectorForTargetName(e){const t=`${this.identifier}.${e}`;return Lg(this.schema.targetAttribute,t)}deprecate(e,t){if(e){const{identifier:i}=this,s=this.schema.targetAttribute,r=this.schema.targetAttributeForScope(i);this.guide.warn(e,`target:${t}`,`Please replace ${s}="${i}.${t}" with ${r}="${t}". The ${s} attribute is deprecated and will be removed in a future version of Stimulus.`)}return e}get guide(){return this.scope.guide}}class B${constructor(e,t){this.scope=e,this.controllerElement=t}get element(){return this.scope.element}get identifier(){return this.scope.identifier}get schema(){return this.scope.schema}has(e){return this.find(e)!=null}find(...e){return e.reduce((t,i)=>t||this.findOutlet(i),void 0)}findAll(...e){return e.reduce((t,i)=>[...t,...this.findAllOutlets(i)],[])}getSelectorForOutletName(e){const t=this.schema.outletAttributeForScope(this.identifier,e);return this.controllerElement.getAttribute(t)}findOutlet(e){const t=this.getSelectorForOutletName(e);if(t)return this.findElement(t,e)}findAllOutlets(e){const t=this.getSelectorForOutletName(e);return t?this.findAllElements(t,e):[]}findElement(e,t){return this.scope.queryElements(e).filter(s=>this.matchesElement(s,e,t))[0]}findAllElements(e,t){return this.scope.queryElements(e).filter(s=>this.matchesElement(s,e,t))}matchesElement(e,t,i){const s=e.getAttribute(this.scope.schema.controllerAttribute)||"";return e.matches(t)&&s.split(" ").includes(i)}}class uy{constructor(e,t,i,s){this.targets=new Q$(this),this.classes=new R$(this),this.data=new L$(this),this.containsElement=r=>r.closest(this.controllerSelector)===this.element,this.schema=e,this.element=t,this.identifier=i,this.guide=new $$(s),this.outlets=new B$(this.documentScope,t)}findElement(e){return this.element.matches(e)?this.element:this.queryElements(e).find(this.containsElement)}findAllElements(e){return[...this.element.matches(e)?[this.element]:[],...this.queryElements(e).filter(this.containsElement)]}queryElements(e){return Array.from(this.element.querySelectorAll(e))}get controllerSelector(){return Lg(this.schema.controllerAttribute,this.identifier)}get isDocumentScope(){return this.element===document.documentElement}get documentScope(){return this.isDocumentScope?this:new uy(this.schema,document.documentElement,this.identifier,this.guide.logger)}}class N${constructor(e,t,i){this.element=e,this.schema=t,this.delegate=i,this.valueListObserver=new $_(this.element,this.controllerAttribute,this),this.scopesByIdentifierByElement=new WeakMap,this.scopeReferenceCounts=new WeakMap}start(){this.valueListObserver.start()}stop(){this.valueListObserver.stop()}get controllerAttribute(){return this.schema.controllerAttribute}parseValueForToken(e){const{element:t,content:i}=e;return this.parseValueForElementAndIdentifier(t,i)}parseValueForElementAndIdentifier(e,t){const i=this.fetchScopesByIdentifierForElement(e);let s=i.get(t);return s||(s=this.delegate.createScopeForElementAndIdentifier(e,t),i.set(t,s)),s}elementMatchedValue(e,t){const i=(this.scopeReferenceCounts.get(t)||0)+1;this.scopeReferenceCounts.set(t,i),i==1&&this.delegate.scopeConnected(t)}elementUnmatchedValue(e,t){const i=this.scopeReferenceCounts.get(t);i&&(this.scopeReferenceCounts.set(t,i-1),i==1&&this.delegate.scopeDisconnected(t))}fetchScopesByIdentifierForElement(e){let t=this.scopesByIdentifierByElement.get(e);return t||(t=new Map,this.scopesByIdentifierByElement.set(e,t)),t}}class F${constructor(e){this.application=e,this.scopeObserver=new N$(this.element,this.schema,this),this.scopesByIdentifier=new So,this.modulesByIdentifier=new Map}get element(){return this.application.element}get schema(){return this.application.schema}get logger(){return this.application.logger}get controllerAttribute(){return this.schema.controllerAttribute}get modules(){return Array.from(this.modulesByIdentifier.values())}get contexts(){return this.modules.reduce((e,t)=>e.concat(t.contexts),[])}start(){this.scopeObserver.start()}stop(){this.scopeObserver.stop()}loadDefinition(e){this.unloadIdentifier(e.identifier);const t=new I$(this.application,e);this.connectModule(t);const i=e.controllerConstructor.afterLoad;i&&i.call(e.controllerConstructor,e.identifier,this.application)}unloadIdentifier(e){const t=this.modulesByIdentifier.get(e);t&&this.disconnectModule(t)}getContextForElementAndIdentifier(e,t){const i=this.modulesByIdentifier.get(t);if(i)return i.contexts.find(s=>s.element==e)}proposeToConnectScopeForElementAndIdentifier(e,t){const i=this.scopeObserver.parseValueForElementAndIdentifier(e,t);i?this.scopeObserver.elementMatchedValue(i.element,i):console.error(`Couldn't find or create scope for identifier: "${t}" and element:`,e)}handleError(e,t,i){this.application.handleError(e,t,i)}createScopeForElementAndIdentifier(e,t){return new uy(this.schema,e,t,this.logger)}scopeConnected(e){this.scopesByIdentifier.add(e.identifier,e);const t=this.modulesByIdentifier.get(e.identifier);t&&t.connectContextForScope(e)}scopeDisconnected(e){this.scopesByIdentifier.delete(e.identifier,e);const t=this.modulesByIdentifier.get(e.identifier);t&&t.disconnectContextForScope(e)}connectModule(e){this.modulesByIdentifier.set(e.identifier,e),this.scopesByIdentifier.getValuesForKey(e.identifier).forEach(i=>e.connectContextForScope(i))}disconnectModule(e){this.modulesByIdentifier.delete(e.identifier),this.scopesByIdentifier.getValuesForKey(e.identifier).forEach(i=>e.disconnectContextForScope(i))}}const V$={controllerAttribute:"data-controller",actionAttribute:"data-action",targetAttribute:"data-target",targetAttributeForScope:n=>`data-${n}-target`,outletAttributeForScope:(n,e)=>`data-${n}-${e}-outlet`,keyMappings:Object.assign(Object.assign({enter:"Enter",tab:"Tab",esc:"Escape",space:" ",up:"ArrowUp",down:"ArrowDown",left:"ArrowLeft",right:"ArrowRight",home:"Home",end:"End",page_up:"PageUp",page_down:"PageDown"},a1("abcdefghijklmnopqrstuvwxyz".split("").map(n=>[n,n]))),a1("0123456789".split("").map(n=>[n,n])))};function a1(n){return n.reduce((e,[t,i])=>Object.assign(Object.assign({},e),{[t]:i}),{})}class U${constructor(e=document.documentElement,t=V$){this.logger=console,this.debug=!1,this.logDebugActivity=(i,s,r={})=>{this.debug&&this.logFormattedMessage(i,s,r)},this.element=e,this.schema=t,this.dispatcher=new GL(this),this.router=new F$(this),this.actionDescriptorFilters=Object.assign({},KL)}static start(e,t){const i=new this(e,t);return i.start(),i}async start(){await q$(),this.logDebugActivity("application","starting"),this.dispatcher.start(),this.router.start(),this.logDebugActivity("application","start")}stop(){this.logDebugActivity("application","stopping"),this.dispatcher.stop(),this.router.stop(),this.logDebugActivity("application","stop")}register(e,t){this.load({identifier:e,controllerConstructor:t})}registerActionOption(e,t){this.actionDescriptorFilters[e]=t}load(e,...t){(Array.isArray(e)?e:[e,...t]).forEach(s=>{s.controllerConstructor.shouldLoad&&this.router.loadDefinition(s)})}unload(e,...t){(Array.isArray(e)?e:[e,...t]).forEach(s=>this.router.unloadIdentifier(s))}get controllers(){return this.router.contexts.map(e=>e.controller)}getControllerForElementAndIdentifier(e,t){const i=this.router.getContextForElementAndIdentifier(e,t);return i?i.controller:null}handleError(e,t,i){var s;this.logger.error(`%s

%o

%o`,t,e,i),(s=window.onerror)===null||s===void 0||s.call(window,t,"",0,0,e)}logFormattedMessage(e,t,i={}){i=Object.assign({application:this},i),this.logger.groupCollapsed(`${e} #${t}`),this.logger.log("details:",Object.assign({},i)),this.logger.groupEnd()}}function q$(){return new Promise(n=>{document.readyState=="loading"?document.addEventListener("DOMContentLoaded",()=>n()):n()})}function z$(n){return Ou(n,"classes").reduce((t,i)=>Object.assign(t,j$(i)),{})}function j$(n){return{[`${n}Class`]:{get(){const{classes:e}=this;if(e.has(n))return e.get(n);{const t=e.getAttributeName(n);throw new Error(`Missing attribute "${t}"`)}}},[`${n}Classes`]:{get(){return this.classes.getAll(n)}},[`has${gu(n)}Class`]:{get(){return this.classes.has(n)}}}}function X$(n){return Ou(n,"outlets").reduce((t,i)=>Object.assign(t,H$(i)),{})}function l1(n,e,t){return n.application.getControllerForElementAndIdentifier(e,t)}function h1(n,e,t){let i=l1(n,e,t);if(i||(n.application.router.proposeToConnectScopeForElementAndIdentifier(e,t),i=l1(n,e,t),i))return i}function H$(n){const e=Ig(n);return{[`${e}Outlet`]:{get(){const t=this.outlets.find(n),i=this.outlets.getSelectorForOutletName(n);if(t){const s=h1(this,t,n);if(s)return s;throw new Error(`The provided outlet element is missing an outlet controller "${n}" instance for host controller "${this.identifier}"`)}throw new Error(`Missing outlet element "${n}" for host controller "${this.identifier}". Stimulus couldn't find a matching outlet element using selector "${i}".`)}},[`${e}Outlets`]:{get(){const t=this.outlets.findAll(n);return t.length>0?t.map(i=>{const s=h1(this,i,n);if(s)return s;console.warn(`The provided outlet element is missing an outlet controller "${n}" instance for host controller "${this.identifier}"`,i)}).filter(i=>i):[]}},[`${e}OutletElement`]:{get(){const t=this.outlets.find(n),i=this.outlets.getSelectorForOutletName(n);if(t)return t;throw new Error(`Missing outlet element "${n}" for host controller "${this.identifier}". Stimulus couldn't find a matching outlet element using selector "${i}".`)}},[`${e}OutletElements`]:{get(){return this.outlets.findAll(n)}},[`has${gu(e)}Outlet`]:{get(){return this.outlets.has(n)}}}}function W$(n){return Ou(n,"targets").reduce((t,i)=>Object.assign(t,Z$(i)),{})}function Z$(n){return{[`${n}Target`]:{get(){const e=this.targets.find(n);if(e)return e;throw new Error(`Missing target element "${n}" for "${this.identifier}" controller`)}},[`${n}Targets`]:{get(){return this.targets.findAll(n)}},[`has${gu(n)}Target`]:{get(){return this.targets.has(n)}}}}function Y$(n){const e=v$(n,"values"),t={valueDescriptorMap:{get(){return e.reduce((i,s)=>{const r=B_(s,this.identifier),o=this.data.getAttributeNameForKey(r.key);return Object.assign(i,{[o]:r})},{})}}};return e.reduce((i,s)=>Object.assign(i,G$(s)),t)}function G$(n,e){const t=B_(n,e),{key:i,name:s,reader:r,writer:o}=t;return{[s]:{get(){const a=this.data.get(i);return a!==null?r(a):t.defaultValue},set(a){a===void 0?this.data.delete(i):this.data.set(i,o(a))}},[`has${gu(s)}`]:{get(){return this.data.has(i)||t.hasCustomDefaultValue}}}}function B_([n,e],t){return tQ({controller:t,token:n,typeDefinition:e})}function xd(n){switch(n){case Array:return"array";case Boolean:return"boolean";case Number:return"number";case Object:return"object";case String:return"string"}}function Qh(n){switch(typeof n){case"boolean":return"boolean";case"number":return"number";case"string":return"string"}if(Array.isArray(n))return"array";if(Object.prototype.toString.call(n)==="[object Object]")return"object"}function K$(n){const{controller:e,token:t,typeObject:i}=n,s=s1(i.type),r=s1(i.default),o=s&&r,a=s&&!r,l=!s&&r,h=xd(i.type),u=Qh(n.typeObject.default);if(a)return h;if(l)return u;if(h!==u){const c=e?`${e}.${t}`:t;throw new Error(`The specified default value for the Stimulus Value "${c}" must match the defined type "${h}". The provided default value of "${i.default}" is of type "${u}".`)}if(o)return h}function J$(n){const{controller:e,token:t,typeDefinition:i}=n,r=K$({controller:e,token:t,typeObject:i}),o=Qh(i),a=xd(i),l=r||o||a;if(l)return l;const h=e?`${e}.${i}`:t;throw new Error(`Unknown value type "${h}" for "${t}" value`)}function eQ(n){const e=xd(n);if(e)return u1[e];const t=Rg(n,"default"),i=Rg(n,"type"),s=n;if(t)return s.default;if(i){const{type:r}=s,o=xd(r);if(o)return u1[o]}return n}function tQ(n){const{token:e,typeDefinition:t}=n,i=`${D_(e)}-value`,s=J$(n);return{type:s,key:i,name:hy(i),get defaultValue(){return eQ(t)},get hasCustomDefaultValue(){return Qh(t)!==void 0},reader:iQ[s],writer:c1[s]||c1.default}}const u1={get array(){return[]},boolean:!1,number:0,get object(){return{}},string:""},iQ={array(n){const e=JSON.parse(n);if(!Array.isArray(e))throw new TypeError(`expected value of type "array" but instead got value "${n}" of type "${Qh(e)}"`);return e},boolean(n){return!(n=="0"||String(n).toLowerCase()=="false")},number(n){return Number(n.replace(/_/g,""))},object(n){const e=JSON.parse(n);if(e===null||typeof e!="object"||Array.isArray(e))throw new TypeError(`expected value of type "object" but instead got value "${n}" of type "${Qh(e)}"`);return e},string(n){return n}},c1={default:nQ,array:d1,object:d1};function d1(n){return JSON.stringify(n)}function nQ(n){return`${n}`}class No{constructor(e){this.context=e}static get shouldLoad(){return!0}static afterLoad(e,t){}get application(){return this.context.application}get scope(){return this.context.scope}get element(){return this.scope.element}get identifier(){return this.scope.identifier}get targets(){return this.scope.targets}get outlets(){return this.scope.outlets}get classes(){return this.scope.classes}get data(){return this.scope.data}initialize(){}connect(){}disconnect(){}dispatch(e,{target:t=this.element,detail:i={},prefix:s=this.identifier,bubbles:r=!0,cancelable:o=!0}={}){const a=s?`${s}:${e}`:e,l=new CustomEvent(a,{detail:i,bubbles:r,cancelable:o});return t.dispatchEvent(l),l}}No.blessings=[z$,W$,Y$,X$];No.targets=[];No.outlets=[];No.values={};/*!
Turbo 8.0.17
Copyright © 2025 37signals LLC
 */(function(n){if(typeof n.requestSubmit=="function")return;n.requestSubmit=function(i){i?(e(i,this),i.click()):(i=document.createElement("input"),i.type="submit",i.hidden=!0,this.appendChild(i),i.click(),this.removeChild(i))};function e(i,s){i instanceof HTMLElement||t(TypeError,"parameter 1 is not of type 'HTMLElement'"),i.type=="submit"||t(TypeError,"The specified element is not a submit button"),i.form==s||t(DOMException,"The specified element is not owned by this form element","NotFoundError")}function t(i,s,r){throw new i("Failed to execute 'requestSubmit' on 'HTMLFormElement': "+s+".",r)}})(HTMLFormElement.prototype);const N_=new WeakMap;function sQ(n){const e=n instanceof Element?n:n instanceof Node?n.parentElement:null,t=e?e.closest("input, button"):null;return t?.type=="submit"?t:null}function rQ(n){const e=sQ(n.target);e&&e.form&&N_.set(e.form,e)}(function(){if("submitter"in Event.prototype)return;let n=window.Event.prototype;if("SubmitEvent"in window){const e=window.SubmitEvent.prototype;if(/Apple Computer/.test(navigator.vendor)&&!("submitter"in e))n=e;else return}addEventListener("click",rQ,!0),Object.defineProperty(n,"submitter",{get(){if(this.type=="submit"&&this.target instanceof HTMLFormElement)return N_.get(this.target)}})})();const ra={eager:"eager",lazy:"lazy"};class Hn extends HTMLElement{static delegateConstructor=void 0;loaded=Promise.resolve();static get observedAttributes(){return["disabled","loading","src"]}constructor(){super(),this.delegate=new Hn.delegateConstructor(this)}connectedCallback(){this.delegate.connect()}disconnectedCallback(){this.delegate.disconnect()}reload(){return this.delegate.sourceURLReloaded()}attributeChangedCallback(e){e=="loading"?this.delegate.loadingStyleChanged():e=="src"?this.delegate.sourceURLChanged():e=="disabled"&&this.delegate.disabledChanged()}get src(){return this.getAttribute("src")}set src(e){e?this.setAttribute("src",e):this.removeAttribute("src")}get refresh(){return this.getAttribute("refresh")}set refresh(e){e?this.setAttribute("refresh",e):this.removeAttribute("refresh")}get shouldReloadWithMorph(){return this.src&&this.refresh==="morph"}get loading(){return oQ(this.getAttribute("loading")||"")}set loading(e){e?this.setAttribute("loading",e):this.removeAttribute("loading")}get disabled(){return this.hasAttribute("disabled")}set disabled(e){e?this.setAttribute("disabled",""):this.removeAttribute("disabled")}get autoscroll(){return this.hasAttribute("autoscroll")}set autoscroll(e){e?this.setAttribute("autoscroll",""):this.removeAttribute("autoscroll")}get complete(){return!this.delegate.isLoading}get isActive(){return this.ownerDocument===document&&!this.isPreview}get isPreview(){return this.ownerDocument?.documentElement?.hasAttribute("data-turbo-preview")}}function oQ(n){switch(n.toLowerCase()){case"lazy":return ra.lazy;default:return ra.eager}}const aQ={enabled:!0,progressBarDelay:500,unvisitableExtensions:new Set([".7z",".aac",".apk",".avi",".bmp",".bz2",".css",".csv",".deb",".dmg",".doc",".docx",".exe",".gif",".gz",".heic",".heif",".ico",".iso",".jpeg",".jpg",".js",".json",".m4a",".mkv",".mov",".mp3",".mp4",".mpeg",".mpg",".msi",".ogg",".ogv",".pdf",".pkg",".png",".ppt",".pptx",".rar",".rtf",".svg",".tar",".tif",".tiff",".txt",".wav",".webm",".webp",".wma",".wmv",".xls",".xlsx",".xml",".zip"])};function Bh(n){if(n.getAttribute("data-turbo-eval")=="false")return n;{const e=document.createElement("script"),t=j_();return t&&(e.nonce=t),e.textContent=n.textContent,e.async=!1,lQ(e,n),e}}function lQ(n,e){for(const{name:t,value:i}of e.attributes)n.setAttribute(t,i)}function hQ(n){const e=document.createElement("template");return e.innerHTML=n,e.content}function Ct(n,{target:e,cancelable:t,detail:i}={}){const s=new CustomEvent(n,{cancelable:t,bubbles:!0,composed:!0,detail:i});return e&&e.isConnected?e.dispatchEvent(s):document.documentElement.dispatchEvent(s),s}function f1(n){n.preventDefault(),n.stopImmediatePropagation()}function mh(){return document.visibilityState==="hidden"?V_():F_()}function F_(){return new Promise(n=>requestAnimationFrame(()=>n()))}function V_(){return new Promise(n=>setTimeout(()=>n(),0))}function uQ(){return Promise.resolve()}function U_(n=""){return new DOMParser().parseFromString(n,"text/html")}function q_(n,...e){const t=cQ(n,e).replace(/^\n/,"").split(`
`),i=t[0].match(/^\s+/),s=i?i[0].length:0;return t.map(r=>r.slice(s)).join(`
`)}function cQ(n,e){return n.reduce((t,i,s)=>{const r=e[s]==null?"":e[s];return t+i+r},"")}function Fr(){return Array.from({length:36}).map((n,e)=>e==8||e==13||e==18||e==23?"-":e==14?"4":e==19?(Math.floor(Math.random()*4)+8).toString(16):Math.floor(Math.random()*15).toString(16)).join("")}function Td(n,...e){for(const t of e.map(i=>i?.getAttribute(n)))if(typeof t=="string")return t;return null}function dQ(n,...e){return e.some(t=>t&&t.hasAttribute(n))}function wd(...n){for(const e of n)e.localName=="turbo-frame"&&e.setAttribute("busy",""),e.setAttribute("aria-busy","true")}function _d(...n){for(const e of n)e.localName=="turbo-frame"&&e.removeAttribute("busy"),e.removeAttribute("aria-busy")}function fQ(n,e=2e3){return new Promise(t=>{const i=()=>{n.removeEventListener("error",i),n.removeEventListener("load",i),t()};n.addEventListener("load",i,{once:!0}),n.addEventListener("error",i,{once:!0}),setTimeout(t,e)})}function z_(n){switch(n){case"replace":return history.replaceState;case"advance":case"restore":return history.pushState}}function pQ(n){return n=="advance"||n=="replace"||n=="restore"}function xo(...n){const e=Td("data-turbo-action",...n);return pQ(e)?e:null}function cy(n){return document.querySelector(`meta[name="${n}"]`)}function kd(n){const e=cy(n);return e&&e.content}function j_(){const n=cy("csp-nonce");if(n){const{nonce:e,content:t}=n;return e==""?t:e}}function mQ(n,e){let t=cy(n);return t||(t=document.createElement("meta"),t.setAttribute("name",n),document.head.appendChild(t)),t.setAttribute("content",e),t}function fa(n,e){if(n instanceof Element)return n.closest(e)||fa(n.assignedSlot||n.getRootNode()?.host,e)}function dy(n){return!!n&&n.closest("[inert], :disabled, [hidden], details:not([open]), dialog:not([open])")==null&&typeof n.focus=="function"}function X_(n){return Array.from(n.querySelectorAll("[autofocus]")).find(dy)}async function gQ(n,e){const t=e();n(),await F_();const i=e();return[t,i]}function H_(n){if(n==="_blank")return!1;if(n){for(const e of document.getElementsByName(n))if(e instanceof HTMLIFrameElement)return!1;return!0}else return!0}function W_(n){const e=fa(n,"a[href], a[xlink\\:href]");return!e||e.hasAttribute("download")||e.hasAttribute("target")&&e.target!=="_self"?null:e}function Z_(n){return ai(n.getAttribute("href")||"")}function OQ(n,e){let t=null;return(...i)=>{const s=()=>n.apply(this,i);clearTimeout(t),t=setTimeout(s,e)}}const yQ={"aria-disabled":{beforeSubmit:n=>{n.setAttribute("aria-disabled","true"),n.addEventListener("click",f1)},afterSubmit:n=>{n.removeAttribute("aria-disabled"),n.removeEventListener("click",f1)}},disabled:{beforeSubmit:n=>n.disabled=!0,afterSubmit:n=>n.disabled=!1}};let bQ=class{#e=null;constructor(e){Object.assign(this,e)}get submitter(){return this.#e}set submitter(e){this.#e=yQ[e]||e}};const vQ=new bQ({mode:"on",submitter:"disabled"}),Kt={drive:aQ,forms:vQ};function ai(n){return new URL(n.toString(),document.baseURI)}function To(n){let e;if(n.hash)return n.hash.slice(1);if(e=n.href.match(/#(.*)$/))return e[1]}function fy(n,e){const t=e?.getAttribute("formaction")||n.getAttribute("action")||n.action;return ai(t)}function SQ(n){return(wQ(n).match(/\.[^.]*$/)||[])[0]||""}function xQ(n,e){const t=p1(e.origin+e.pathname);return p1(n.href)===t||n.href.startsWith(t)}function Er(n,e){return xQ(n,e)&&!Kt.drive.unvisitableExtensions.has(SQ(n))}function $g(n){const e=To(n);return e!=null?n.href.slice(0,-(e.length+1)):n.href}function oc(n){return $g(n)}function Y_(n,e){return ai(n).href==ai(e).href}function TQ(n){return n.pathname.split("/").slice(1)}function wQ(n){return TQ(n).slice(-1)[0]}function p1(n){return n.endsWith("/")?n:n+"/"}class py{constructor(e){this.response=e}get succeeded(){return this.response.ok}get failed(){return!this.succeeded}get clientError(){return this.statusCode>=400&&this.statusCode<=499}get serverError(){return this.statusCode>=500&&this.statusCode<=599}get redirected(){return this.response.redirected}get location(){return ai(this.response.url)}get isHTML(){return this.contentType&&this.contentType.match(/^(?:text\/([^\s;,]+\b)?html|application\/xhtml\+xml)\b/)}get statusCode(){return this.response.status}get contentType(){return this.header("Content-Type")}get responseText(){return this.response.clone().text()}get responseHTML(){return this.isHTML?this.response.clone().text():Promise.resolve(void 0)}header(e){return this.response.headers.get(e)}}class _Q extends Set{constructor(e){super(),this.maxSize=e}add(e){if(this.size>=this.maxSize){const i=this.values().next().value;this.delete(i)}super.add(e)}}const G_=new _Q(20);function K_(n,e={}){const t=new Headers(e.headers||{}),i=Fr();return G_.add(i),t.append("X-Turbo-Request-Id",i),window.fetch(n,{...e,headers:t})}function my(n){switch(n.toLowerCase()){case"get":return Tn.get;case"post":return Tn.post;case"put":return Tn.put;case"patch":return Tn.patch;case"delete":return Tn.delete}}const Tn={get:"get",post:"post",put:"put",patch:"patch",delete:"delete"};function kQ(n){switch(n.toLowerCase()){case ho.multipart:return ho.multipart;case ho.plain:return ho.plain;default:return ho.urlEncoded}}const ho={urlEncoded:"application/x-www-form-urlencoded",multipart:"multipart/form-data",plain:"text/plain"};class yu{abortController=new AbortController;#e=e=>{};constructor(e,t,i,s=new URLSearchParams,r=null,o=ho.urlEncoded){const[a,l]=m1(ai(i),t,s,o);this.delegate=e,this.url=a,this.target=r,this.fetchOptions={credentials:"same-origin",redirect:"follow",method:t.toUpperCase(),headers:{...this.defaultHeaders},body:l,signal:this.abortSignal,referrer:this.delegate.referrer?.href},this.enctype=o}get method(){return this.fetchOptions.method}set method(e){const t=this.isSafe?this.url.searchParams:this.fetchOptions.body||new FormData,i=my(e)||Tn.get;this.url.search="";const[s,r]=m1(this.url,i,t,this.enctype);this.url=s,this.fetchOptions.body=r,this.fetchOptions.method=i.toUpperCase()}get headers(){return this.fetchOptions.headers}set headers(e){this.fetchOptions.headers=e}get body(){return this.isSafe?this.url.searchParams:this.fetchOptions.body}set body(e){this.fetchOptions.body=e}get location(){return this.url}get params(){return this.url.searchParams}get entries(){return this.body?Array.from(this.body.entries()):[]}cancel(){this.abortController.abort()}async perform(){const{fetchOptions:e}=this;this.delegate.prepareRequest(this);const t=await this.#t(e);try{this.delegate.requestStarted(this),t.detail.fetchRequest?this.response=t.detail.fetchRequest.response:this.response=K_(this.url.href,e);const i=await this.response;return await this.receive(i)}catch(i){if(i.name!=="AbortError")throw this.#i(i)&&this.delegate.requestErrored(this,i),i}finally{this.delegate.requestFinished(this)}}async receive(e){const t=new py(e);return Ct("turbo:before-fetch-response",{cancelable:!0,detail:{fetchResponse:t},target:this.target}).defaultPrevented?this.delegate.requestPreventedHandlingResponse(this,t):t.succeeded?this.delegate.requestSucceededWithResponse(this,t):this.delegate.requestFailedWithResponse(this,t),t}get defaultHeaders(){return{Accept:"text/html, application/xhtml+xml"}}get isSafe(){return gy(this.method)}get abortSignal(){return this.abortController.signal}acceptResponseType(e){this.headers.Accept=[e,this.headers.Accept].join(", ")}async#t(e){const t=new Promise(s=>this.#e=s),i=Ct("turbo:before-fetch-request",{cancelable:!0,detail:{fetchOptions:e,url:this.url,resume:this.#e},target:this.target});return this.url=i.detail.url,i.defaultPrevented&&await t,i}#i(e){return!Ct("turbo:fetch-request-error",{target:this.target,cancelable:!0,detail:{request:this,error:e}}).defaultPrevented}}function gy(n){return my(n)==Tn.get}function m1(n,e,t,i){const s=Array.from(t).length>0?new URLSearchParams(J_(t)):n.searchParams;return gy(e)?[CQ(n,s),null]:i==ho.urlEncoded?[n,s]:[n,t]}function J_(n){const e=[];for(const[t,i]of n)i instanceof File||e.push([t,i]);return e}function CQ(n,e){const t=new URLSearchParams(J_(e));return n.search=t.toString(),n}class EQ{started=!1;constructor(e,t){this.delegate=e,this.element=t,this.intersectionObserver=new IntersectionObserver(this.intersect)}start(){this.started||(this.started=!0,this.intersectionObserver.observe(this.element))}stop(){this.started&&(this.started=!1,this.intersectionObserver.unobserve(this.element))}intersect=e=>{e.slice(-1)[0]?.isIntersecting&&this.delegate.elementAppearedInViewport(this.element)}}class al{static contentType="text/vnd.turbo-stream.html";static wrap(e){return typeof e=="string"?new this(hQ(e)):e}constructor(e){this.fragment=AQ(e)}}function AQ(n){for(const e of n.querySelectorAll("turbo-stream")){const t=document.importNode(e,!0);for(const i of t.templateElement.content.querySelectorAll("script"))i.replaceWith(Bh(i));e.replaceWith(t)}return n}const PQ=100;class DQ{#e=null;#t=null;get(e){if(this.#t&&this.#t.url===e&&this.#t.expire>Date.now())return this.#t.request}setLater(e,t,i){this.clear(),this.#e=setTimeout(()=>{t.perform(),this.set(e,t,i),this.#e=null},PQ)}set(e,t,i){this.#t={url:e,request:t,expire:new Date(new Date().getTime()+i)}}clear(){this.#e&&clearTimeout(this.#e),this.#t=null}}const MQ=10*1e3,oa=new DQ,Zo={initialized:"initialized",requesting:"requesting",waiting:"waiting",receiving:"receiving",stopping:"stopping",stopped:"stopped"};class Lf{state=Zo.initialized;static confirmMethod(e){return Promise.resolve(confirm(e))}constructor(e,t,i,s=!1){const r=BQ(t,i),o=QQ($Q(t,i),r),a=IQ(t,i),l=NQ(t,i);this.delegate=e,this.formElement=t,this.submitter=i,this.fetchRequest=new yu(this,r,o,a,t,l),this.mustRedirect=s}get method(){return this.fetchRequest.method}set method(e){this.fetchRequest.method=e}get action(){return this.fetchRequest.url.toString()}set action(e){this.fetchRequest.url=ai(e)}get body(){return this.fetchRequest.body}get enctype(){return this.fetchRequest.enctype}get isSafe(){return this.fetchRequest.isSafe}get location(){return this.fetchRequest.url}async start(){const{initialized:e,requesting:t}=Zo,i=Td("data-turbo-confirm",this.submitter,this.formElement);if(!(typeof i=="string"&&!await(typeof Kt.forms.confirm=="function"?Kt.forms.confirm:Lf.confirmMethod)(i,this.formElement,this.submitter))&&this.state==e)return this.state=t,this.fetchRequest.perform()}stop(){const{stopping:e,stopped:t}=Zo;if(this.state!=e&&this.state!=t)return this.state=e,this.fetchRequest.cancel(),!0}prepareRequest(e){if(!e.isSafe){const t=RQ(kd("csrf-param"))||kd("csrf-token");t&&(e.headers["X-CSRF-Token"]=t)}this.requestAcceptsTurboStreamResponse(e)&&e.acceptResponseType(al.contentType)}requestStarted(e){this.state=Zo.waiting,this.submitter&&Kt.forms.submitter.beforeSubmit(this.submitter),this.setSubmitsWith(),wd(this.formElement),Ct("turbo:submit-start",{target:this.formElement,detail:{formSubmission:this}}),this.delegate.formSubmissionStarted(this)}requestPreventedHandlingResponse(e,t){oa.clear(),this.result={success:t.succeeded,fetchResponse:t}}requestSucceededWithResponse(e,t){if(t.clientError||t.serverError){this.delegate.formSubmissionFailedWithResponse(this,t);return}if(oa.clear(),this.requestMustRedirect(e)&&LQ(t)){const i=new Error("Form responses must redirect to another location");this.delegate.formSubmissionErrored(this,i)}else this.state=Zo.receiving,this.result={success:!0,fetchResponse:t},this.delegate.formSubmissionSucceededWithResponse(this,t)}requestFailedWithResponse(e,t){this.result={success:!1,fetchResponse:t},this.delegate.formSubmissionFailedWithResponse(this,t)}requestErrored(e,t){this.result={success:!1,error:t},this.delegate.formSubmissionErrored(this,t)}requestFinished(e){this.state=Zo.stopped,this.submitter&&Kt.forms.submitter.afterSubmit(this.submitter),this.resetSubmitterText(),_d(this.formElement),Ct("turbo:submit-end",{target:this.formElement,detail:{formSubmission:this,...this.result}}),this.delegate.formSubmissionFinished(this)}setSubmitsWith(){if(!(!this.submitter||!this.submitsWith)){if(this.submitter.matches("button"))this.originalSubmitText=this.submitter.innerHTML,this.submitter.innerHTML=this.submitsWith;else if(this.submitter.matches("input")){const e=this.submitter;this.originalSubmitText=e.value,e.value=this.submitsWith}}}resetSubmitterText(){if(!(!this.submitter||!this.originalSubmitText)){if(this.submitter.matches("button"))this.submitter.innerHTML=this.originalSubmitText;else if(this.submitter.matches("input")){const e=this.submitter;e.value=this.originalSubmitText}}}requestMustRedirect(e){return!e.isSafe&&this.mustRedirect}requestAcceptsTurboStreamResponse(e){return!e.isSafe||dQ("data-turbo-stream",this.submitter,this.formElement)}get submitsWith(){return this.submitter?.getAttribute("data-turbo-submits-with")}}function IQ(n,e){const t=new FormData(n),i=e?.getAttribute("name"),s=e?.getAttribute("value");return i&&t.append(i,s||""),t}function RQ(n){if(n!=null){const t=(document.cookie?document.cookie.split("; "):[]).find(i=>i.startsWith(n));if(t){const i=t.split("=").slice(1).join("=");return i?decodeURIComponent(i):void 0}}}function LQ(n){return n.statusCode==200&&!n.redirected}function $Q(n,e){const t=typeof n.action=="string"?n.action:null;return e?.hasAttribute("formaction")?e.getAttribute("formaction")||"":n.getAttribute("action")||t||""}function QQ(n,e){const t=ai(n);return gy(e)&&(t.search=""),t}function BQ(n,e){const t=e?.getAttribute("formmethod")||n.getAttribute("method")||"";return my(t.toLowerCase())||Tn.get}function NQ(n,e){return kQ(e?.getAttribute("formenctype")||n.enctype)}class $f{constructor(e){this.element=e}get activeElement(){return this.element.ownerDocument.activeElement}get children(){return[...this.element.children]}hasAnchor(e){return this.getElementForAnchor(e)!=null}getElementForAnchor(e){return e?this.element.querySelector(`[id='${e}'], a[name='${e}']`):null}get isConnected(){return this.element.isConnected}get firstAutofocusableElement(){return X_(this.element)}get permanentElements(){return t2(this.element)}getPermanentElementById(e){return e2(this.element,e)}getPermanentElementMapForSnapshot(e){const t={};for(const i of this.permanentElements){const{id:s}=i,r=e.getPermanentElementById(s);r&&(t[s]=[i,r])}return t}}function e2(n,e){return n.querySelector(`#${e}[data-turbo-permanent]`)}function t2(n){return n.querySelectorAll("[id][data-turbo-permanent]")}class Oy{started=!1;constructor(e,t){this.delegate=e,this.eventTarget=t}start(){this.started||(this.eventTarget.addEventListener("submit",this.submitCaptured,!0),this.started=!0)}stop(){this.started&&(this.eventTarget.removeEventListener("submit",this.submitCaptured,!0),this.started=!1)}submitCaptured=()=>{this.eventTarget.removeEventListener("submit",this.submitBubbled,!1),this.eventTarget.addEventListener("submit",this.submitBubbled,!1)};submitBubbled=e=>{if(!e.defaultPrevented){const t=e.target instanceof HTMLFormElement?e.target:void 0,i=e.submitter||void 0;t&&FQ(t,i)&&VQ(t,i)&&this.delegate.willSubmitForm(t,i)&&(e.preventDefault(),e.stopImmediatePropagation(),this.delegate.formSubmitted(t,i))}}}function FQ(n,e){return(e?.getAttribute("formmethod")||n.getAttribute("method"))!="dialog"}function VQ(n,e){const t=e?.getAttribute("formtarget")||n.getAttribute("target");return H_(t)}class i2{#e=e=>{};#t=e=>{};constructor(e,t){this.delegate=e,this.element=t}scrollToAnchor(e){const t=this.snapshot.getElementForAnchor(e);t?(this.focusElement(t),this.scrollToElement(t)):this.scrollToPosition({x:0,y:0})}scrollToAnchorFromLocation(e){this.scrollToAnchor(To(e))}scrollToElement(e){e.scrollIntoView()}focusElement(e){e instanceof HTMLElement&&(e.hasAttribute("tabindex")?e.focus():(e.setAttribute("tabindex","-1"),e.focus(),e.removeAttribute("tabindex")))}scrollToPosition({x:e,y:t}){this.scrollRoot.scrollTo(e,t)}scrollToTop(){this.scrollToPosition({x:0,y:0})}get scrollRoot(){return window}async render(e){const{isPreview:t,shouldRender:i,willRender:s,newSnapshot:r}=e,o=s;if(i)try{this.renderPromise=new Promise(u=>this.#e=u),this.renderer=e,await this.prepareToRenderSnapshot(e);const a=new Promise(u=>this.#t=u),l={resume:this.#t,render:this.renderer.renderElement,renderMethod:this.renderer.renderMethod};this.delegate.allowsImmediateRender(r,l)||await a,await this.renderSnapshot(e),this.delegate.viewRenderedSnapshot(r,t,this.renderer.renderMethod),this.delegate.preloadOnLoadLinksForView(this.element),this.finishRenderingSnapshot(e)}finally{delete this.renderer,this.#e(void 0),delete this.renderPromise}else o&&this.invalidate(e.reloadReason)}invalidate(e){this.delegate.viewInvalidated(e)}async prepareToRenderSnapshot(e){this.markAsPreview(e.isPreview),await e.prepareToRender()}markAsPreview(e){e?this.element.setAttribute("data-turbo-preview",""):this.element.removeAttribute("data-turbo-preview")}markVisitDirection(e){this.element.setAttribute("data-turbo-visit-direction",e)}unmarkVisitDirection(){this.element.removeAttribute("data-turbo-visit-direction")}async renderSnapshot(e){await e.render()}finishRenderingSnapshot(e){e.finishRendering()}}class UQ extends i2{missing(){this.element.innerHTML='<strong class="turbo-frame-error">Content missing</strong>'}get snapshot(){return new $f(this.element)}}class n2{constructor(e,t){this.delegate=e,this.element=t}start(){this.element.addEventListener("click",this.clickBubbled),document.addEventListener("turbo:click",this.linkClicked),document.addEventListener("turbo:before-visit",this.willVisit)}stop(){this.element.removeEventListener("click",this.clickBubbled),document.removeEventListener("turbo:click",this.linkClicked),document.removeEventListener("turbo:before-visit",this.willVisit)}clickBubbled=e=>{this.clickEventIsSignificant(e)?this.clickEvent=e:delete this.clickEvent};linkClicked=e=>{this.clickEvent&&this.clickEventIsSignificant(e)&&this.delegate.shouldInterceptLinkClick(e.target,e.detail.url,e.detail.originalEvent)&&(this.clickEvent.preventDefault(),e.preventDefault(),this.delegate.linkClickIntercepted(e.target,e.detail.url,e.detail.originalEvent)),delete this.clickEvent};willVisit=e=>{delete this.clickEvent};clickEventIsSignificant(e){const t=e.composed?e.target?.parentElement:e.target,i=W_(t)||t;return i instanceof Element&&i.closest("turbo-frame, html")==this.element}}class s2{started=!1;constructor(e,t){this.delegate=e,this.eventTarget=t}start(){this.started||(this.eventTarget.addEventListener("click",this.clickCaptured,!0),this.started=!0)}stop(){this.started&&(this.eventTarget.removeEventListener("click",this.clickCaptured,!0),this.started=!1)}clickCaptured=()=>{this.eventTarget.removeEventListener("click",this.clickBubbled,!1),this.eventTarget.addEventListener("click",this.clickBubbled,!1)};clickBubbled=e=>{if(e instanceof MouseEvent&&this.clickEventIsSignificant(e)){const t=e.composedPath&&e.composedPath()[0]||e.target,i=W_(t);if(i&&H_(i.target)){const s=Z_(i);this.delegate.willFollowLinkToLocation(i,s,e)&&(e.preventDefault(),this.delegate.followedLinkToLocation(i,s))}}};clickEventIsSignificant(e){return!(e.target&&e.target.isContentEditable||e.defaultPrevented||e.which>1||e.altKey||e.ctrlKey||e.metaKey||e.shiftKey)}}class r2{constructor(e,t){this.delegate=e,this.linkInterceptor=new s2(this,t)}start(){this.linkInterceptor.start()}stop(){this.linkInterceptor.stop()}canPrefetchRequestToLocation(e,t){return!1}prefetchAndCacheRequestToLocation(e,t){}willFollowLinkToLocation(e,t,i){return this.delegate.willSubmitFormLinkToLocation(e,t,i)&&(e.hasAttribute("data-turbo-method")||e.hasAttribute("data-turbo-stream"))}followedLinkToLocation(e,t){const i=document.createElement("form"),s="hidden";for(const[c,f]of t.searchParams)i.append(Object.assign(document.createElement("input"),{type:s,name:c,value:f}));const r=Object.assign(t,{search:""});i.setAttribute("data-turbo","true"),i.setAttribute("action",r.href),i.setAttribute("hidden","");const o=e.getAttribute("data-turbo-method");o&&i.setAttribute("method",o);const a=e.getAttribute("data-turbo-frame");a&&i.setAttribute("data-turbo-frame",a);const l=xo(e);l&&i.setAttribute("data-turbo-action",l);const h=e.getAttribute("data-turbo-confirm");h&&i.setAttribute("data-turbo-confirm",h),e.hasAttribute("data-turbo-stream")&&i.setAttribute("data-turbo-stream",""),this.delegate.submittedFormLinkToLocation(e,t,i),document.body.appendChild(i),i.addEventListener("turbo:submit-end",()=>i.remove(),{once:!0}),requestAnimationFrame(()=>i.requestSubmit())}}class o2{static async preservingPermanentElements(e,t,i){const s=new this(e,t);s.enter(),await i(),s.leave()}constructor(e,t){this.delegate=e,this.permanentElementMap=t}enter(){for(const e in this.permanentElementMap){const[t,i]=this.permanentElementMap[e];this.delegate.enteringBardo(t,i),this.replaceNewPermanentElementWithPlaceholder(i)}}leave(){for(const e in this.permanentElementMap){const[t]=this.permanentElementMap[e];this.replaceCurrentPermanentElementWithClone(t),this.replacePlaceholderWithPermanentElement(t),this.delegate.leavingBardo(t)}}replaceNewPermanentElementWithPlaceholder(e){const t=qQ(e);e.replaceWith(t)}replaceCurrentPermanentElementWithClone(e){const t=e.cloneNode(!0);e.replaceWith(t)}replacePlaceholderWithPermanentElement(e){this.getPlaceholderById(e.id)?.replaceWith(e)}getPlaceholderById(e){return this.placeholders.find(t=>t.content==e)}get placeholders(){return[...document.querySelectorAll("meta[name=turbo-permanent-placeholder][content]")]}}function qQ(n){const e=document.createElement("meta");return e.setAttribute("name","turbo-permanent-placeholder"),e.setAttribute("content",n.id),e}class yy{#e=null;static renderElement(e,t){}constructor(e,t,i,s=!0){this.currentSnapshot=e,this.newSnapshot=t,this.isPreview=i,this.willRender=s,this.renderElement=this.constructor.renderElement,this.promise=new Promise((r,o)=>this.resolvingFunctions={resolve:r,reject:o})}get shouldRender(){return!0}get shouldAutofocus(){return!0}get reloadReason(){}prepareToRender(){}render(){}finishRendering(){this.resolvingFunctions&&(this.resolvingFunctions.resolve(),delete this.resolvingFunctions)}async preservingPermanentElements(e){await o2.preservingPermanentElements(this,this.permanentElementMap,e)}focusFirstAutofocusableElement(){if(this.shouldAutofocus){const e=this.connectedSnapshot.firstAutofocusableElement;e&&e.focus()}}enteringBardo(e){this.#e||e.contains(this.currentSnapshot.activeElement)&&(this.#e=this.currentSnapshot.activeElement)}leavingBardo(e){e.contains(this.#e)&&this.#e instanceof HTMLElement&&(this.#e.focus(),this.#e=null)}get connectedSnapshot(){return this.newSnapshot.isConnected?this.newSnapshot:this.currentSnapshot}get currentElement(){return this.currentSnapshot.element}get newElement(){return this.newSnapshot.element}get permanentElementMap(){return this.currentSnapshot.getPermanentElementMapForSnapshot(this.newSnapshot)}get renderMethod(){return"replace"}}class by extends yy{static renderElement(e,t){const i=document.createRange();i.selectNodeContents(e),i.deleteContents();const s=t,r=s.ownerDocument?.createRange();r&&(r.selectNodeContents(s),e.appendChild(r.extractContents()))}constructor(e,t,i,s,r,o=!0){super(t,i,s,r,o),this.delegate=e}get shouldRender(){return!0}async render(){await mh(),this.preservingPermanentElements(()=>{this.loadFrameElement()}),this.scrollFrameIntoView(),await mh(),this.focusFirstAutofocusableElement(),await mh(),this.activateScriptElements()}loadFrameElement(){this.delegate.willRenderFrame(this.currentElement,this.newElement),this.renderElement(this.currentElement,this.newElement)}scrollFrameIntoView(){if(this.currentElement.autoscroll||this.newElement.autoscroll){const e=this.currentElement.firstElementChild,t=zQ(this.currentElement.getAttribute("data-autoscroll-block"),"end"),i=jQ(this.currentElement.getAttribute("data-autoscroll-behavior"),"auto");if(e)return e.scrollIntoView({block:t,behavior:i}),!0}return!1}activateScriptElements(){for(const e of this.newScriptElements){const t=Bh(e);e.replaceWith(t)}}get newScriptElements(){return this.currentElement.querySelectorAll("script")}}function zQ(n,e){return n=="end"||n=="start"||n=="center"||n=="nearest"?n:e}function jQ(n,e){return n=="auto"||n=="smooth"?n:e}var XQ=(function(){const n=()=>{},e={morphStyle:"outerHTML",callbacks:{beforeNodeAdded:n,afterNodeAdded:n,beforeNodeMorphed:n,afterNodeMorphed:n,beforeNodeRemoved:n,afterNodeRemoved:n,beforeAttributeUpdated:n},head:{style:"merge",shouldPreserve:f=>f.getAttribute("im-preserve")==="true",shouldReAppend:f=>f.getAttribute("im-re-append")==="true",shouldRemove:n,afterHeadMorphed:n},restoreFocus:!0};function t(f,p,b={}){f=u(f);const y=c(p),_=h(f,y,b),T=s(_,()=>a(_,f,y,w=>w.morphStyle==="innerHTML"?(r(w,f,y),Array.from(f.childNodes)):i(w,f,y)));return _.pantry.remove(),T}function i(f,p,b){const y=c(p);let _=Array.from(y.childNodes);const T=_.indexOf(p),w=_.length-(T+1);return r(f,y,b,p,p.nextSibling),_=Array.from(y.childNodes),_.slice(T,_.length-w)}function s(f,p){if(!f.config.restoreFocus)return p();let b=document.activeElement;if(!(b instanceof HTMLInputElement||b instanceof HTMLTextAreaElement))return p();const{id:y,selectionStart:_,selectionEnd:T}=b,w=p();return y&&y!==document.activeElement?.id&&(b=f.target.querySelector(`#${y}`),b?.focus()),b&&!b.selectionEnd&&T&&b.setSelectionRange(_,T),w}const r=(function(){function f(S,k,A,M=null,B=null){k instanceof HTMLTemplateElement&&A instanceof HTMLTemplateElement&&(k=k.content,A=A.content),M||=k.firstChild;for(const P of A.childNodes){if(M&&M!=B){const q=b(S,P,M,B);if(q){q!==M&&_(S,M,q),o(q,P,S),M=q.nextSibling;continue}}if(P instanceof Element&&S.persistentIds.has(P.id)){const q=T(k,P.id,M,S);o(q,P,S),M=q.nextSibling;continue}const R=p(k,P,M,S);R&&(M=R.nextSibling)}for(;M&&M!=B;){const P=M;M=M.nextSibling,y(S,P)}}function p(S,k,A,M){if(M.callbacks.beforeNodeAdded(k)===!1)return null;if(M.idMap.has(k)){const B=document.createElement(k.tagName);return S.insertBefore(B,A),o(B,k,M),M.callbacks.afterNodeAdded(B),B}else{const B=document.importNode(k,!0);return S.insertBefore(B,A),M.callbacks.afterNodeAdded(B),B}}const b=(function(){function S(M,B,P,R){let q=null,z=B.nextSibling,X=0,Z=P;for(;Z&&Z!=R;){if(A(Z,B)){if(k(M,Z,B))return Z;q===null&&(M.idMap.has(Z)||(q=Z))}if(q===null&&z&&A(Z,z)&&(X++,z=z.nextSibling,X>=2&&(q=void 0)),Z.contains(document.activeElement))break;Z=Z.nextSibling}return q||null}function k(M,B,P){let R=M.idMap.get(B),q=M.idMap.get(P);if(!q||!R)return!1;for(const z of R)if(q.has(z))return!0;return!1}function A(M,B){const P=M,R=B;return P.nodeType===R.nodeType&&P.tagName===R.tagName&&(!P.id||P.id===R.id)}return S})();function y(S,k){if(S.idMap.has(k))v(S.pantry,k,null);else{if(S.callbacks.beforeNodeRemoved(k)===!1)return;k.parentNode?.removeChild(k),S.callbacks.afterNodeRemoved(k)}}function _(S,k,A){let M=k;for(;M&&M!==A;){let B=M;M=M.nextSibling,y(S,B)}return M}function T(S,k,A,M){const B=M.target.querySelector(`#${k}`)||M.pantry.querySelector(`#${k}`);return w(B,M),v(S,B,A),B}function w(S,k){const A=S.id;for(;S=S.parentNode;){let M=k.idMap.get(S);M&&(M.delete(A),M.size||k.idMap.delete(S))}}function v(S,k,A){if(S.moveBefore)try{S.moveBefore(k,A)}catch{S.insertBefore(k,A)}else S.insertBefore(k,A)}return f})(),o=(function(){function f(w,v,S){return S.ignoreActive&&w===document.activeElement?null:(S.callbacks.beforeNodeMorphed(w,v)===!1||(w instanceof HTMLHeadElement&&S.head.ignore||(w instanceof HTMLHeadElement&&S.head.style!=="morph"?l(w,v,S):(p(w,v,S),T(w,S)||r(S,w,v))),S.callbacks.afterNodeMorphed(w,v)),w)}function p(w,v,S){let k=v.nodeType;if(k===1){const A=w,M=v,B=A.attributes,P=M.attributes;for(const R of P)_(R.name,A,"update",S)||A.getAttribute(R.name)!==R.value&&A.setAttribute(R.name,R.value);for(let R=B.length-1;0<=R;R--){const q=B[R];if(q&&!M.hasAttribute(q.name)){if(_(q.name,A,"remove",S))continue;A.removeAttribute(q.name)}}T(A,S)||b(A,M,S)}(k===8||k===3)&&w.nodeValue!==v.nodeValue&&(w.nodeValue=v.nodeValue)}function b(w,v,S){if(w instanceof HTMLInputElement&&v instanceof HTMLInputElement&&v.type!=="file"){let k=v.value,A=w.value;y(w,v,"checked",S),y(w,v,"disabled",S),v.hasAttribute("value")?A!==k&&(_("value",w,"update",S)||(w.setAttribute("value",k),w.value=k)):_("value",w,"remove",S)||(w.value="",w.removeAttribute("value"))}else if(w instanceof HTMLOptionElement&&v instanceof HTMLOptionElement)y(w,v,"selected",S);else if(w instanceof HTMLTextAreaElement&&v instanceof HTMLTextAreaElement){let k=v.value,A=w.value;if(_("value",w,"update",S))return;k!==A&&(w.value=k),w.firstChild&&w.firstChild.nodeValue!==k&&(w.firstChild.nodeValue=k)}}function y(w,v,S,k){const A=v[S],M=w[S];if(A!==M){const B=_(S,w,"update",k);B||(w[S]=v[S]),A?B||w.setAttribute(S,""):_(S,w,"remove",k)||w.removeAttribute(S)}}function _(w,v,S,k){return w==="value"&&k.ignoreActiveValue&&v===document.activeElement?!0:k.callbacks.beforeAttributeUpdated(w,v,S)===!1}function T(w,v){return!!v.ignoreActiveValue&&w===document.activeElement&&w!==document.body}return f})();function a(f,p,b,y){if(f.head.block){const _=p.querySelector("head"),T=b.querySelector("head");if(_&&T){const w=l(_,T,f);return Promise.all(w).then(()=>{const v=Object.assign(f,{head:{block:!1,ignore:!0}});return y(v)})}}return y(f)}function l(f,p,b){let y=[],_=[],T=[],w=[],v=new Map;for(const k of p.children)v.set(k.outerHTML,k);for(const k of f.children){let A=v.has(k.outerHTML),M=b.head.shouldReAppend(k),B=b.head.shouldPreserve(k);A||B?M?_.push(k):(v.delete(k.outerHTML),T.push(k)):b.head.style==="append"?M&&(_.push(k),w.push(k)):b.head.shouldRemove(k)!==!1&&_.push(k)}w.push(...v.values());let S=[];for(const k of w){let A=document.createRange().createContextualFragment(k.outerHTML).firstChild;if(b.callbacks.beforeNodeAdded(A)!==!1){if("href"in A&&A.href||"src"in A&&A.src){let M,B=new Promise(function(P){M=P});A.addEventListener("load",function(){M()}),S.push(B)}f.appendChild(A),b.callbacks.afterNodeAdded(A),y.push(A)}}for(const k of _)b.callbacks.beforeNodeRemoved(k)!==!1&&(f.removeChild(k),b.callbacks.afterNodeRemoved(k));return b.head.afterHeadMorphed(f,{added:y,kept:T,removed:_}),S}const h=(function(){function f(v,S,k){const{persistentIds:A,idMap:M}=T(v,S),B=p(k),P=B.morphStyle||"outerHTML";if(!["innerHTML","outerHTML"].includes(P))throw`Do not understand how to morph style ${P}`;return{target:v,newContent:S,config:B,morphStyle:P,ignoreActive:B.ignoreActive,ignoreActiveValue:B.ignoreActiveValue,restoreFocus:B.restoreFocus,idMap:M,persistentIds:A,pantry:b(),callbacks:B.callbacks,head:B.head}}function p(v){let S=Object.assign({},e);return Object.assign(S,v),S.callbacks=Object.assign({},e.callbacks,v.callbacks),S.head=Object.assign({},e.head,v.head),S}function b(){const v=document.createElement("div");return v.hidden=!0,document.body.insertAdjacentElement("afterend",v),v}function y(v){let S=Array.from(v.querySelectorAll("[id]"));return v.id&&S.push(v),S}function _(v,S,k,A){for(const M of A)if(S.has(M.id)){let B=M;for(;B;){let P=v.get(B);if(P==null&&(P=new Set,v.set(B,P)),P.add(M.id),B===k)break;B=B.parentElement}}}function T(v,S){const k=y(v),A=y(S),M=w(k,A);let B=new Map;_(B,M,v,k);const P=S.__idiomorphRoot||S;return _(B,M,P,A),{persistentIds:M,idMap:B}}function w(v,S){let k=new Set,A=new Map;for(const{id:B,tagName:P}of v)A.has(B)?k.add(B):A.set(B,P);let M=new Set;for(const{id:B,tagName:P}of S)M.has(B)?k.add(B):A.get(B)===P&&M.add(B);for(const B of k)M.delete(B);return M}return f})(),{normalizeElement:u,normalizeParent:c}=(function(){const f=new WeakSet;function p(T){return T instanceof Document?T.documentElement:T}function b(T){if(T==null)return document.createElement("div");if(typeof T=="string")return b(_(T));if(f.has(T))return T;if(T instanceof Node){if(T.parentNode)return y(T);{const w=document.createElement("div");return w.append(T),w}}else{const w=document.createElement("div");for(const v of[...T])w.append(v);return w}}function y(T){return{childNodes:[T],querySelectorAll:w=>{const v=T.querySelectorAll(w);return T.matches(w)?[T,...v]:v},insertBefore:(w,v)=>T.parentNode.insertBefore(w,v),moveBefore:(w,v)=>T.parentNode.moveBefore(w,v),get __idiomorphRoot(){return T}}}function _(T){let w=new DOMParser,v=T.replace(/<svg(\s[^>]*>|>)([\s\S]*?)<\/svg>/gim,"");if(v.match(/<\/html>/)||v.match(/<\/head>/)||v.match(/<\/body>/)){let S=w.parseFromString(T,"text/html");if(v.match(/<\/html>/))return f.add(S),S;{let k=S.firstChild;return k&&f.add(k),k}}else{let k=w.parseFromString("<body><template>"+T+"</template></body>","text/html").body.querySelector("template").content;return f.add(k),k}}return{normalizeElement:p,normalizeParent:b}})();return{morph:t,defaults:e}})();function Qf(n,e,{callbacks:t,...i}={}){XQ.morph(n,e,{...i,callbacks:new HQ(t)})}function vy(n,e,t={}){Qf(n,e.childNodes,{...t,morphStyle:"innerHTML"})}function a2(n,e){return n instanceof Hn&&e instanceof Element&&e.nodeName==="TURBO-FRAME"&&n.shouldReloadWithMorph&&n.id===e.id&&(!e.getAttribute("src")||Y_(n.src,e.getAttribute("src")))&&!n.closest("[data-turbo-permanent]")}function l2(n){return n.parentElement.closest("turbo-frame[src][refresh=morph]")}class HQ{#e;constructor({beforeNodeMorphed:e}={}){this.#e=e||(()=>!0)}beforeNodeAdded=e=>!(e.id&&e.hasAttribute("data-turbo-permanent")&&document.getElementById(e.id));beforeNodeMorphed=(e,t)=>{if(e instanceof Element)return!e.hasAttribute("data-turbo-permanent")&&this.#e(e,t)?!Ct("turbo:before-morph-element",{cancelable:!0,target:e,detail:{currentElement:e,newElement:t}}).defaultPrevented:!1};beforeAttributeUpdated=(e,t,i)=>!Ct("turbo:before-morph-attribute",{cancelable:!0,target:t,detail:{attributeName:e,mutationType:i}}).defaultPrevented;beforeNodeRemoved=e=>this.beforeNodeMorphed(e);afterNodeMorphed=(e,t)=>{e instanceof Element&&Ct("turbo:morph-element",{target:e,detail:{currentElement:e,newElement:t}})}}class h2 extends by{static renderElement(e,t){Ct("turbo:before-frame-morph",{target:e,detail:{currentElement:e,newElement:t}}),vy(e,t,{callbacks:{beforeNodeMorphed:(i,s)=>a2(i,s)&&l2(i)===e?(i.reload(),!1):!0}})}async preservingPermanentElements(e){return await e()}}class vr{static animationDuration=300;static get defaultCSS(){return q_`
      .turbo-progress-bar {
        position: fixed;
        display: block;
        top: 0;
        left: 0;
        height: 3px;
        background: #0076ff;
        z-index: 2147483647;
        transition:
          width ${vr.animationDuration}ms ease-out,
          opacity ${vr.animationDuration/2}ms ${vr.animationDuration/2}ms ease-in;
        transform: translate3d(0, 0, 0);
      }
    `}hiding=!1;value=0;visible=!1;constructor(){this.stylesheetElement=this.createStylesheetElement(),this.progressElement=this.createProgressElement(),this.installStylesheetElement(),this.setValue(0)}show(){this.visible||(this.visible=!0,this.installProgressElement(),this.startTrickling())}hide(){this.visible&&!this.hiding&&(this.hiding=!0,this.fadeProgressElement(()=>{this.uninstallProgressElement(),this.stopTrickling(),this.visible=!1,this.hiding=!1}))}setValue(e){this.value=e,this.refresh()}installStylesheetElement(){document.head.insertBefore(this.stylesheetElement,document.head.firstChild)}installProgressElement(){this.progressElement.style.width="0",this.progressElement.style.opacity="1",document.documentElement.insertBefore(this.progressElement,document.body),this.refresh()}fadeProgressElement(e){this.progressElement.style.opacity="0",setTimeout(e,vr.animationDuration*1.5)}uninstallProgressElement(){this.progressElement.parentNode&&document.documentElement.removeChild(this.progressElement)}startTrickling(){this.trickleInterval||(this.trickleInterval=window.setInterval(this.trickle,vr.animationDuration))}stopTrickling(){window.clearInterval(this.trickleInterval),delete this.trickleInterval}trickle=()=>{this.setValue(this.value+Math.random()/100)};refresh(){requestAnimationFrame(()=>{this.progressElement.style.width=`${10+this.value*90}%`})}createStylesheetElement(){const e=document.createElement("style");e.type="text/css",e.textContent=vr.defaultCSS;const t=j_();return t&&(e.nonce=t),e}createProgressElement(){const e=document.createElement("div");return e.className="turbo-progress-bar",e}}class WQ extends $f{detailsByOuterHTML=this.children.filter(e=>!KQ(e)).map(e=>t3(e)).reduce((e,t)=>{const{outerHTML:i}=t,s=i in e?e[i]:{type:ZQ(t),tracked:YQ(t),elements:[]};return{...e,[i]:{...s,elements:[...s.elements,t]}}},{});get trackedElementSignature(){return Object.keys(this.detailsByOuterHTML).filter(e=>this.detailsByOuterHTML[e].tracked).join("")}getScriptElementsNotInSnapshot(e){return this.getElementsMatchingTypeNotInSnapshot("script",e)}getStylesheetElementsNotInSnapshot(e){return this.getElementsMatchingTypeNotInSnapshot("stylesheet",e)}getElementsMatchingTypeNotInSnapshot(e,t){return Object.keys(this.detailsByOuterHTML).filter(i=>!(i in t.detailsByOuterHTML)).map(i=>this.detailsByOuterHTML[i]).filter(({type:i})=>i==e).map(({elements:[i]})=>i)}get provisionalElements(){return Object.keys(this.detailsByOuterHTML).reduce((e,t)=>{const{type:i,tracked:s,elements:r}=this.detailsByOuterHTML[t];return i==null&&!s?[...e,...r]:r.length>1?[...e,...r.slice(1)]:e},[])}getMetaValue(e){const t=this.findMetaElementByName(e);return t?t.getAttribute("content"):null}findMetaElementByName(e){return Object.keys(this.detailsByOuterHTML).reduce((t,i)=>{const{elements:[s]}=this.detailsByOuterHTML[i];return e3(s,e)?s:t},void 0|void 0)}}function ZQ(n){if(GQ(n))return"script";if(JQ(n))return"stylesheet"}function YQ(n){return n.getAttribute("data-turbo-track")=="reload"}function GQ(n){return n.localName=="script"}function KQ(n){return n.localName=="noscript"}function JQ(n){const e=n.localName;return e=="style"||e=="link"&&n.getAttribute("rel")=="stylesheet"}function e3(n,e){return n.localName=="meta"&&n.getAttribute("name")==e}function t3(n){return n.hasAttribute("nonce")&&n.setAttribute("nonce",""),n}class zn extends $f{static fromHTMLString(e=""){return this.fromDocument(U_(e))}static fromElement(e){return this.fromDocument(e.ownerDocument)}static fromDocument({documentElement:e,body:t,head:i}){return new this(e,t,new WQ(i))}constructor(e,t,i){super(t),this.documentElement=e,this.headSnapshot=i}clone(){const e=this.element.cloneNode(!0),t=this.element.querySelectorAll("select"),i=e.querySelectorAll("select");for(const[s,r]of t.entries()){const o=i[s];for(const a of o.selectedOptions)a.selected=!1;for(const a of r.selectedOptions)o.options[a.index].selected=!0}for(const s of e.querySelectorAll('input[type="password"]'))s.value="";return new zn(this.documentElement,e,this.headSnapshot)}get lang(){return this.documentElement.getAttribute("lang")}get headElement(){return this.headSnapshot.element}get rootLocation(){const e=this.getSetting("root")??"/";return ai(e)}get cacheControlValue(){return this.getSetting("cache-control")}get isPreviewable(){return this.cacheControlValue!="no-preview"}get isCacheable(){return this.cacheControlValue!="no-cache"}get isVisitable(){return this.getSetting("visit-control")!="reload"}get prefersViewTransitions(){return(this.getSetting("view-transition")==="true"||this.headSnapshot.getMetaValue("view-transition")==="same-origin")&&!window.matchMedia("(prefers-reduced-motion: reduce)").matches}get shouldMorphPage(){return this.getSetting("refresh-method")==="morph"}get shouldPreserveScrollPosition(){return this.getSetting("refresh-scroll")==="preserve"}getSetting(e){return this.headSnapshot.getMetaValue(`turbo-${e}`)}}class i3{#e=!1;#t=Promise.resolve();renderChange(e,t){return e&&this.viewTransitionsAvailable&&!this.#e?(this.#e=!0,this.#t=this.#t.then(async()=>{await document.startViewTransition(t).finished})):this.#t=this.#t.then(t),this.#t}get viewTransitionsAvailable(){return document.startViewTransition}}const n3={action:"advance",historyChanged:!1,visitCachedSnapshot:()=>{},willRender:!0,updateHistory:!0,shouldCacheSnapshot:!0,acceptsStreamResponse:!1},ac={visitStart:"visitStart",requestStart:"requestStart",requestEnd:"requestEnd",visitEnd:"visitEnd"},Xs={initialized:"initialized",started:"started",canceled:"canceled",failed:"failed",completed:"completed"},pa={networkFailure:0,timeoutFailure:-1,contentTypeMismatch:-2},s3={advance:"forward",restore:"back",replace:"none"};class r3{identifier=Fr();timingMetrics={};followedRedirect=!1;historyChanged=!1;scrolled=!1;shouldCacheSnapshot=!0;acceptsStreamResponse=!1;snapshotCached=!1;state=Xs.initialized;viewTransitioner=new i3;constructor(e,t,i,s={}){this.delegate=e,this.location=t,this.restorationIdentifier=i||Fr();const{action:r,historyChanged:o,referrer:a,snapshot:l,snapshotHTML:h,response:u,visitCachedSnapshot:c,willRender:f,updateHistory:p,shouldCacheSnapshot:b,acceptsStreamResponse:y,direction:_}={...n3,...s};this.action=r,this.historyChanged=o,this.referrer=a,this.snapshot=l,this.snapshotHTML=h,this.response=u,this.isSamePage=this.delegate.locationWithActionIsSamePage(this.location,this.action),this.isPageRefresh=this.view.isPageRefresh(this),this.visitCachedSnapshot=c,this.willRender=f,this.updateHistory=p,this.scrolled=!f,this.shouldCacheSnapshot=b,this.acceptsStreamResponse=y,this.direction=_||s3[r]}get adapter(){return this.delegate.adapter}get view(){return this.delegate.view}get history(){return this.delegate.history}get restorationData(){return this.history.getRestorationDataForIdentifier(this.restorationIdentifier)}get silent(){return this.isSamePage}start(){this.state==Xs.initialized&&(this.recordTimingMetric(ac.visitStart),this.state=Xs.started,this.adapter.visitStarted(this),this.delegate.visitStarted(this))}cancel(){this.state==Xs.started&&(this.request&&this.request.cancel(),this.cancelRender(),this.state=Xs.canceled)}complete(){this.state==Xs.started&&(this.recordTimingMetric(ac.visitEnd),this.adapter.visitCompleted(this),this.state=Xs.completed,this.followRedirect(),this.followedRedirect||this.delegate.visitCompleted(this))}fail(){this.state==Xs.started&&(this.state=Xs.failed,this.adapter.visitFailed(this),this.delegate.visitCompleted(this))}changeHistory(){if(!this.historyChanged&&this.updateHistory){const e=this.location.href===this.referrer?.href?"replace":this.action,t=z_(e);this.history.update(t,this.location,this.restorationIdentifier),this.historyChanged=!0}}issueRequest(){this.hasPreloadedResponse()?this.simulateRequest():this.shouldIssueRequest()&&!this.request&&(this.request=new yu(this,Tn.get,this.location),this.request.perform())}simulateRequest(){this.response&&(this.startRequest(),this.recordResponse(),this.finishRequest())}startRequest(){this.recordTimingMetric(ac.requestStart),this.adapter.visitRequestStarted(this)}recordResponse(e=this.response){if(this.response=e,e){const{statusCode:t}=e;g1(t)?this.adapter.visitRequestCompleted(this):this.adapter.visitRequestFailedWithStatusCode(this,t)}}finishRequest(){this.recordTimingMetric(ac.requestEnd),this.adapter.visitRequestFinished(this)}loadResponse(){if(this.response){const{statusCode:e,responseHTML:t}=this.response;this.render(async()=>{if(this.shouldCacheSnapshot&&this.cacheSnapshot(),this.view.renderPromise&&await this.view.renderPromise,g1(e)&&t!=null){const i=zn.fromHTMLString(t);await this.renderPageSnapshot(i,!1),this.adapter.visitRendered(this),this.complete()}else await this.view.renderError(zn.fromHTMLString(t),this),this.adapter.visitRendered(this),this.fail()})}}getCachedSnapshot(){const e=this.view.getCachedSnapshotForLocation(this.location)||this.getPreloadedSnapshot();if(e&&(!To(this.location)||e.hasAnchor(To(this.location)))&&(this.action=="restore"||e.isPreviewable))return e}getPreloadedSnapshot(){if(this.snapshotHTML)return zn.fromHTMLString(this.snapshotHTML)}hasCachedSnapshot(){return this.getCachedSnapshot()!=null}loadCachedSnapshot(){const e=this.getCachedSnapshot();if(e){const t=this.shouldIssueRequest();this.render(async()=>{this.cacheSnapshot(),this.isSamePage||this.isPageRefresh?this.adapter.visitRendered(this):(this.view.renderPromise&&await this.view.renderPromise,await this.renderPageSnapshot(e,t),this.adapter.visitRendered(this),t||this.complete())})}}followRedirect(){this.redirectedToLocation&&!this.followedRedirect&&this.response?.redirected&&(this.adapter.visitProposedToLocation(this.redirectedToLocation,{action:"replace",response:this.response,shouldCacheSnapshot:!1,willRender:!1}),this.followedRedirect=!0)}goToSamePageAnchor(){this.isSamePage&&this.render(async()=>{this.cacheSnapshot(),this.performScroll(),this.changeHistory(),this.adapter.visitRendered(this)})}prepareRequest(e){this.acceptsStreamResponse&&e.acceptResponseType(al.contentType)}requestStarted(){this.startRequest()}requestPreventedHandlingResponse(e,t){}async requestSucceededWithResponse(e,t){const i=await t.responseHTML,{redirected:s,statusCode:r}=t;i==null?this.recordResponse({statusCode:pa.contentTypeMismatch,redirected:s}):(this.redirectedToLocation=t.redirected?t.location:void 0,this.recordResponse({statusCode:r,responseHTML:i,redirected:s}))}async requestFailedWithResponse(e,t){const i=await t.responseHTML,{redirected:s,statusCode:r}=t;i==null?this.recordResponse({statusCode:pa.contentTypeMismatch,redirected:s}):this.recordResponse({statusCode:r,responseHTML:i,redirected:s})}requestErrored(e,t){this.recordResponse({statusCode:pa.networkFailure,redirected:!1})}requestFinished(){this.finishRequest()}performScroll(){!this.scrolled&&!this.view.forceReloaded&&!this.view.shouldPreserveScrollPosition(this)&&(this.action=="restore"?this.scrollToRestoredPosition()||this.scrollToAnchor()||this.view.scrollToTop():this.scrollToAnchor()||this.view.scrollToTop(),this.isSamePage&&this.delegate.visitScrolledToSamePageLocation(this.view.lastRenderedLocation,this.location),this.scrolled=!0)}scrollToRestoredPosition(){const{scrollPosition:e}=this.restorationData;if(e)return this.view.scrollToPosition(e),!0}scrollToAnchor(){const e=To(this.location);if(e!=null)return this.view.scrollToAnchor(e),!0}recordTimingMetric(e){this.timingMetrics[e]=new Date().getTime()}getTimingMetrics(){return{...this.timingMetrics}}hasPreloadedResponse(){return typeof this.response=="object"}shouldIssueRequest(){return this.isSamePage?!1:this.action=="restore"?!this.hasCachedSnapshot():this.willRender}cacheSnapshot(){this.snapshotCached||(this.view.cacheSnapshot(this.snapshot).then(e=>e&&this.visitCachedSnapshot(e)),this.snapshotCached=!0)}async render(e){this.cancelRender(),await new Promise(t=>{this.frame=document.visibilityState==="hidden"?setTimeout(()=>t(),0):requestAnimationFrame(()=>t())}),await e(),delete this.frame}async renderPageSnapshot(e,t){await this.viewTransitioner.renderChange(this.view.shouldTransitionTo(e),async()=>{await this.view.renderPage(e,t,this.willRender,this),this.performScroll()})}cancelRender(){this.frame&&(cancelAnimationFrame(this.frame),delete this.frame)}}function g1(n){return n>=200&&n<300}class o3{progressBar=new vr;constructor(e){this.session=e}visitProposedToLocation(e,t){Er(e,this.navigator.rootLocation)?this.navigator.startVisit(e,t?.restorationIdentifier||Fr(),t):window.location.href=e.toString()}visitStarted(e){this.location=e.location,this.redirectedToLocation=null,e.loadCachedSnapshot(),e.issueRequest(),e.goToSamePageAnchor()}visitRequestStarted(e){this.progressBar.setValue(0),e.hasCachedSnapshot()||e.action!="restore"?this.showVisitProgressBarAfterDelay():this.showProgressBar()}visitRequestCompleted(e){e.loadResponse(),e.response.redirected&&(this.redirectedToLocation=e.redirectedToLocation)}visitRequestFailedWithStatusCode(e,t){switch(t){case pa.networkFailure:case pa.timeoutFailure:case pa.contentTypeMismatch:return this.reload({reason:"request_failed",context:{statusCode:t}});default:return e.loadResponse()}}visitRequestFinished(e){}visitCompleted(e){this.progressBar.setValue(1),this.hideVisitProgressBar()}pageInvalidated(e){this.reload(e)}visitFailed(e){this.progressBar.setValue(1),this.hideVisitProgressBar()}visitRendered(e){}linkPrefetchingIsEnabledForLocation(e){return!0}formSubmissionStarted(e){this.progressBar.setValue(0),this.showFormProgressBarAfterDelay()}formSubmissionFinished(e){this.progressBar.setValue(1),this.hideFormProgressBar()}showVisitProgressBarAfterDelay(){this.visitProgressBarTimeout=window.setTimeout(this.showProgressBar,this.session.progressBarDelay)}hideVisitProgressBar(){this.progressBar.hide(),this.visitProgressBarTimeout!=null&&(window.clearTimeout(this.visitProgressBarTimeout),delete this.visitProgressBarTimeout)}showFormProgressBarAfterDelay(){this.formProgressBarTimeout==null&&(this.formProgressBarTimeout=window.setTimeout(this.showProgressBar,this.session.progressBarDelay))}hideFormProgressBar(){this.progressBar.hide(),this.formProgressBarTimeout!=null&&(window.clearTimeout(this.formProgressBarTimeout),delete this.formProgressBarTimeout)}showProgressBar=()=>{this.progressBar.show()};reload(e){Ct("turbo:reload",{detail:e}),window.location.href=(this.redirectedToLocation||this.location)?.toString()||window.location.href}get navigator(){return this.session.navigator}}class a3{selector="[data-turbo-temporary]";deprecatedSelector="[data-turbo-cache=false]";started=!1;start(){this.started||(this.started=!0,addEventListener("turbo:before-cache",this.removeTemporaryElements,!1))}stop(){this.started&&(this.started=!1,removeEventListener("turbo:before-cache",this.removeTemporaryElements,!1))}removeTemporaryElements=e=>{for(const t of this.temporaryElements)t.remove()};get temporaryElements(){return[...document.querySelectorAll(this.selector),...this.temporaryElementsWithDeprecation]}get temporaryElementsWithDeprecation(){const e=document.querySelectorAll(this.deprecatedSelector);return e.length&&console.warn(`The ${this.deprecatedSelector} selector is deprecated and will be removed in a future version. Use ${this.selector} instead.`),[...e]}}class l3{constructor(e,t){this.session=e,this.element=t,this.linkInterceptor=new n2(this,t),this.formSubmitObserver=new Oy(this,t)}start(){this.linkInterceptor.start(),this.formSubmitObserver.start()}stop(){this.linkInterceptor.stop(),this.formSubmitObserver.stop()}shouldInterceptLinkClick(e,t,i){return this.#t(e)}linkClickIntercepted(e,t,i){const s=this.#i(e);s&&s.delegate.linkClickIntercepted(e,t,i)}willSubmitForm(e,t){return e.closest("turbo-frame")==null&&this.#e(e,t)&&this.#t(e,t)}formSubmitted(e,t){const i=this.#i(e,t);i&&i.delegate.formSubmitted(e,t)}#e(e,t){const i=fy(e,t),s=this.element.ownerDocument.querySelector('meta[name="turbo-root"]'),r=ai(s?.content??"/");return this.#t(e,t)&&Er(i,r)}#t(e,t){if(e instanceof HTMLFormElement?this.session.submissionIsNavigatable(e,t):this.session.elementIsNavigatable(e)){const s=this.#i(e,t);return s?s!=e.closest("turbo-frame"):!1}else return!1}#i(e,t){const i=t?.getAttribute("data-turbo-frame")||e.getAttribute("data-turbo-frame");if(i&&i!="_top"){const s=this.element.querySelector(`#${i}:not([disabled])`);if(s instanceof Hn)return s}}}class h3{location;restorationIdentifier=Fr();restorationData={};started=!1;pageLoaded=!1;currentIndex=0;constructor(e){this.delegate=e}start(){this.started||(addEventListener("popstate",this.onPopState,!1),addEventListener("load",this.onPageLoad,!1),this.currentIndex=history.state?.turbo?.restorationIndex||0,this.started=!0,this.replace(new URL(window.location.href)))}stop(){this.started&&(removeEventListener("popstate",this.onPopState,!1),removeEventListener("load",this.onPageLoad,!1),this.started=!1)}push(e,t){this.update(history.pushState,e,t)}replace(e,t){this.update(history.replaceState,e,t)}update(e,t,i=Fr()){e===history.pushState&&++this.currentIndex;const s={turbo:{restorationIdentifier:i,restorationIndex:this.currentIndex}};e.call(history,s,"",t.href),this.location=t,this.restorationIdentifier=i}getRestorationDataForIdentifier(e){return this.restorationData[e]||{}}updateRestorationData(e){const{restorationIdentifier:t}=this,i=this.restorationData[t];this.restorationData[t]={...i,...e}}assumeControlOfScrollRestoration(){this.previousScrollRestoration||(this.previousScrollRestoration=history.scrollRestoration??"auto",history.scrollRestoration="manual")}relinquishControlOfScrollRestoration(){this.previousScrollRestoration&&(history.scrollRestoration=this.previousScrollRestoration,delete this.previousScrollRestoration)}onPopState=e=>{if(this.shouldHandlePopState()){const{turbo:t}=e.state||{};if(t){this.location=new URL(window.location.href);const{restorationIdentifier:i,restorationIndex:s}=t;this.restorationIdentifier=i;const r=s>this.currentIndex?"forward":"back";this.delegate.historyPoppedToLocationWithRestorationIdentifierAndDirection(this.location,i,r),this.currentIndex=s}}};onPageLoad=async e=>{await uQ(),this.pageLoaded=!0};shouldHandlePopState(){return this.pageIsLoaded()}pageIsLoaded(){return this.pageLoaded||document.readyState=="complete"}}class u3{started=!1;#e=null;constructor(e,t){this.delegate=e,this.eventTarget=t}start(){this.started||(this.eventTarget.readyState==="loading"?this.eventTarget.addEventListener("DOMContentLoaded",this.#t,{once:!0}):this.#t())}stop(){this.started&&(this.eventTarget.removeEventListener("mouseenter",this.#i,{capture:!0,passive:!0}),this.eventTarget.removeEventListener("mouseleave",this.#r,{capture:!0,passive:!0}),this.eventTarget.removeEventListener("turbo:before-fetch-request",this.#s,!0),this.started=!1)}#t=()=>{this.eventTarget.addEventListener("mouseenter",this.#i,{capture:!0,passive:!0}),this.eventTarget.addEventListener("mouseleave",this.#r,{capture:!0,passive:!0}),this.eventTarget.addEventListener("turbo:before-fetch-request",this.#s,!0),this.started=!0};#i=e=>{if(kd("turbo-prefetch")==="false")return;const t=e.target;if(t.matches&&t.matches("a[href]:not([target^=_]):not([download])")&&this.#l(t)){const s=t,r=Z_(s);if(this.delegate.canPrefetchRequestToLocation(s,r)){this.#e=s;const o=new yu(this,Tn.get,r,new URLSearchParams,t);o.fetchOptions.priority="low",oa.setLater(r.toString(),o,this.#n)}}};#r=e=>{e.target===this.#e&&this.#o()};#o=()=>{oa.clear(),this.#e=null};#s=e=>{if(e.target.tagName!=="FORM"&&e.detail.fetchOptions.method==="GET"){const t=oa.get(e.detail.url.toString());t&&(e.detail.fetchRequest=t),oa.clear()}};prepareRequest(e){const t=e.target;e.headers["X-Sec-Purpose"]="prefetch";const i=t.closest("turbo-frame"),s=t.getAttribute("data-turbo-frame")||i?.getAttribute("target")||i?.id;s&&s!=="_top"&&(e.headers["Turbo-Frame"]=s)}requestSucceededWithResponse(){}requestStarted(e){}requestErrored(e){}requestFinished(e){}requestPreventedHandlingResponse(e,t){}requestFailedWithResponse(e,t){}get#n(){return Number(kd("turbo-prefetch-cache-time"))||MQ}#l(e){return!(!e.getAttribute("href")||c3(e)||d3(e)||f3(e)||p3(e)||g3(e))}}const c3=n=>n.origin!==document.location.origin||!["http:","https:"].includes(n.protocol)||n.hasAttribute("target"),d3=n=>n.pathname+n.search===document.location.pathname+document.location.search||n.href.startsWith("#"),f3=n=>{if(n.getAttribute("data-turbo-prefetch")==="false"||n.getAttribute("data-turbo")==="false")return!0;const e=fa(n,"[data-turbo-prefetch]");return!!(e&&e.getAttribute("data-turbo-prefetch")==="false")},p3=n=>{const e=n.getAttribute("data-turbo-method");return!!(e&&e.toLowerCase()!=="get"||m3(n)||n.hasAttribute("data-turbo-confirm")||n.hasAttribute("data-turbo-stream"))},m3=n=>n.hasAttribute("data-remote")||n.hasAttribute("data-behavior")||n.hasAttribute("data-confirm")||n.hasAttribute("data-method"),g3=n=>Ct("turbo:before-prefetch",{target:n,cancelable:!0}).defaultPrevented;class O3{constructor(e){this.delegate=e}proposeVisit(e,t={}){this.delegate.allowsVisitingLocationWithAction(e,t.action)&&this.delegate.visitProposedToLocation(e,t)}startVisit(e,t,i={}){this.stop(),this.currentVisit=new r3(this,ai(e),t,{referrer:this.location,...i}),this.currentVisit.start()}submitForm(e,t){this.stop(),this.formSubmission=new Lf(this,e,t,!0),this.formSubmission.start()}stop(){this.formSubmission&&(this.formSubmission.stop(),delete this.formSubmission),this.currentVisit&&(this.currentVisit.cancel(),delete this.currentVisit)}get adapter(){return this.delegate.adapter}get view(){return this.delegate.view}get rootLocation(){return this.view.snapshot.rootLocation}get history(){return this.delegate.history}formSubmissionStarted(e){typeof this.adapter.formSubmissionStarted=="function"&&this.adapter.formSubmissionStarted(e)}async formSubmissionSucceededWithResponse(e,t){if(e==this.formSubmission){const i=await t.responseHTML;if(i){const s=e.isSafe;s||this.view.clearSnapshotCache();const{statusCode:r,redirected:o}=t,l={action:this.#e(e,t),shouldCacheSnapshot:s,response:{statusCode:r,responseHTML:i,redirected:o}};this.proposeVisit(t.location,l)}}}async formSubmissionFailedWithResponse(e,t){const i=await t.responseHTML;if(i){const s=zn.fromHTMLString(i);t.serverError?await this.view.renderError(s,this.currentVisit):await this.view.renderPage(s,!1,!0,this.currentVisit),s.shouldPreserveScrollPosition||this.view.scrollToTop(),this.view.clearSnapshotCache()}}formSubmissionErrored(e,t){console.error(t)}formSubmissionFinished(e){typeof this.adapter.formSubmissionFinished=="function"&&this.adapter.formSubmissionFinished(e)}linkPrefetchingIsEnabledForLocation(e){return typeof this.adapter.linkPrefetchingIsEnabledForLocation=="function"?this.adapter.linkPrefetchingIsEnabledForLocation(e):!0}visitStarted(e){this.delegate.visitStarted(e)}visitCompleted(e){this.delegate.visitCompleted(e),delete this.currentVisit}locationWithActionIsSamePage(e,t){const i=To(e),s=To(this.view.lastRenderedLocation),r=t==="restore"&&typeof i>"u";return t!=="replace"&&$g(e)===$g(this.view.lastRenderedLocation)&&(r||i!=null&&i!==s)}visitScrolledToSamePageLocation(e,t){this.delegate.visitScrolledToSamePageLocation(e,t)}get location(){return this.history.location}get restorationIdentifier(){return this.history.restorationIdentifier}#e(e,t){const{submitter:i,formElement:s}=e;return xo(i,s)||this.#t(t)}#t(e){return e.redirected&&e.location.href===this.location?.href?"replace":"advance"}}const to={initial:0,loading:1,interactive:2,complete:3};class y3{stage=to.initial;started=!1;constructor(e){this.delegate=e}start(){this.started||(this.stage==to.initial&&(this.stage=to.loading),document.addEventListener("readystatechange",this.interpretReadyState,!1),addEventListener("pagehide",this.pageWillUnload,!1),this.started=!0)}stop(){this.started&&(document.removeEventListener("readystatechange",this.interpretReadyState,!1),removeEventListener("pagehide",this.pageWillUnload,!1),this.started=!1)}interpretReadyState=()=>{const{readyState:e}=this;e=="interactive"?this.pageIsInteractive():e=="complete"&&this.pageIsComplete()};pageIsInteractive(){this.stage==to.loading&&(this.stage=to.interactive,this.delegate.pageBecameInteractive())}pageIsComplete(){this.pageIsInteractive(),this.stage==to.interactive&&(this.stage=to.complete,this.delegate.pageLoaded())}pageWillUnload=()=>{this.delegate.pageWillUnload()};get readyState(){return document.readyState}}class b3{started=!1;constructor(e){this.delegate=e}start(){this.started||(addEventListener("scroll",this.onScroll,!1),this.onScroll(),this.started=!0)}stop(){this.started&&(removeEventListener("scroll",this.onScroll,!1),this.started=!1)}onScroll=()=>{this.updatePosition({x:window.pageXOffset,y:window.pageYOffset})};updatePosition(e){this.delegate.scrollPositionChanged(e)}}class v3{render({fragment:e}){o2.preservingPermanentElements(this,S3(e),()=>{x3(e,()=>{T3(()=>{document.documentElement.appendChild(e)})})})}enteringBardo(e,t){t.replaceWith(e.cloneNode(!0))}leavingBardo(){}}function S3(n){const e=t2(document.documentElement),t={};for(const i of e){const{id:s}=i;for(const r of n.querySelectorAll("turbo-stream")){const o=e2(r.templateElement.content,s);o&&(t[s]=[i,o])}}return t}async function x3(n,e){const t=`turbo-stream-autofocus-${Fr()}`,i=n.querySelectorAll("turbo-stream"),s=w3(i);let r=null;if(s&&(s.id?r=s.id:r=t,s.id=r),e(),await mh(),(document.activeElement==null||document.activeElement==document.body)&&r){const a=document.getElementById(r);dy(a)&&a.focus(),a&&a.id==t&&a.removeAttribute("id")}}async function T3(n){const[e,t]=await gQ(n,()=>document.activeElement),i=e&&e.id;if(i){const s=document.getElementById(i);dy(s)&&s!=t&&s.focus()}}function w3(n){for(const e of n){const t=X_(e.templateElement.content);if(t)return t}return null}class _3{sources=new Set;#e=!1;constructor(e){this.delegate=e}start(){this.#e||(this.#e=!0,addEventListener("turbo:before-fetch-response",this.inspectFetchResponse,!1))}stop(){this.#e&&(this.#e=!1,removeEventListener("turbo:before-fetch-response",this.inspectFetchResponse,!1))}connectStreamSource(e){this.streamSourceIsConnected(e)||(this.sources.add(e),e.addEventListener("message",this.receiveMessageEvent,!1))}disconnectStreamSource(e){this.streamSourceIsConnected(e)&&(this.sources.delete(e),e.removeEventListener("message",this.receiveMessageEvent,!1))}streamSourceIsConnected(e){return this.sources.has(e)}inspectFetchResponse=e=>{const t=k3(e);t&&C3(t)&&(e.preventDefault(),this.receiveMessageResponse(t))};receiveMessageEvent=e=>{this.#e&&typeof e.data=="string"&&this.receiveMessageHTML(e.data)};async receiveMessageResponse(e){const t=await e.responseHTML;t&&this.receiveMessageHTML(t)}receiveMessageHTML(e){this.delegate.receivedMessageFromStream(al.wrap(e))}}function k3(n){const e=n.detail?.fetchResponse;if(e instanceof py)return e}function C3(n){return(n.contentType??"").startsWith(al.contentType)}class E3 extends yy{static renderElement(e,t){const{documentElement:i,body:s}=document;i.replaceChild(t,s)}async render(){this.replaceHeadAndBody(),this.activateScriptElements()}replaceHeadAndBody(){const{documentElement:e,head:t}=document;e.replaceChild(this.newHead,t),this.renderElement(this.currentElement,this.newElement)}activateScriptElements(){for(const e of this.scriptElements){const t=e.parentNode;if(t){const i=Bh(e);t.replaceChild(i,e)}}}get newHead(){return this.newSnapshot.headSnapshot.element}get scriptElements(){return document.documentElement.querySelectorAll("script")}}class Sy extends yy{static renderElement(e,t){document.body&&t instanceof HTMLBodyElement?document.body.replaceWith(t):document.documentElement.appendChild(t)}get shouldRender(){return this.newSnapshot.isVisitable&&this.trackedElementsAreIdentical}get reloadReason(){if(!this.newSnapshot.isVisitable)return{reason:"turbo_visit_control_is_reload"};if(!this.trackedElementsAreIdentical)return{reason:"tracked_element_mismatch"}}async prepareToRender(){this.#e(),await this.mergeHead()}async render(){this.willRender&&await this.replaceBody()}finishRendering(){super.finishRendering(),this.isPreview||this.focusFirstAutofocusableElement()}get currentHeadSnapshot(){return this.currentSnapshot.headSnapshot}get newHeadSnapshot(){return this.newSnapshot.headSnapshot}get newElement(){return this.newSnapshot.element}#e(){const{documentElement:e}=this.currentSnapshot,{lang:t}=this.newSnapshot;t?e.setAttribute("lang",t):e.removeAttribute("lang")}async mergeHead(){const e=this.mergeProvisionalElements(),t=this.copyNewHeadStylesheetElements();this.copyNewHeadScriptElements(),await e,await t,this.willRender&&this.removeUnusedDynamicStylesheetElements()}async replaceBody(){await this.preservingPermanentElements(async()=>{this.activateNewBody(),await this.assignNewBody()})}get trackedElementsAreIdentical(){return this.currentHeadSnapshot.trackedElementSignature==this.newHeadSnapshot.trackedElementSignature}async copyNewHeadStylesheetElements(){const e=[];for(const t of this.newHeadStylesheetElements)e.push(fQ(t)),document.head.appendChild(t);await Promise.all(e)}copyNewHeadScriptElements(){for(const e of this.newHeadScriptElements)document.head.appendChild(Bh(e))}removeUnusedDynamicStylesheetElements(){for(const e of this.unusedDynamicStylesheetElements)document.head.removeChild(e)}async mergeProvisionalElements(){const e=[...this.newHeadProvisionalElements];for(const t of this.currentHeadProvisionalElements)this.isCurrentElementInElementList(t,e)||document.head.removeChild(t);for(const t of e)document.head.appendChild(t)}isCurrentElementInElementList(e,t){for(const[i,s]of t.entries()){if(e.tagName=="TITLE"){if(s.tagName!="TITLE")continue;if(e.innerHTML==s.innerHTML)return t.splice(i,1),!0}if(s.isEqualNode(e))return t.splice(i,1),!0}return!1}removeCurrentHeadProvisionalElements(){for(const e of this.currentHeadProvisionalElements)document.head.removeChild(e)}copyNewHeadProvisionalElements(){for(const e of this.newHeadProvisionalElements)document.head.appendChild(e)}activateNewBody(){document.adoptNode(this.newElement),this.activateNewBodyScriptElements()}activateNewBodyScriptElements(){for(const e of this.newBodyScriptElements){const t=Bh(e);e.replaceWith(t)}}async assignNewBody(){await this.renderElement(this.currentElement,this.newElement)}get unusedDynamicStylesheetElements(){return this.oldHeadStylesheetElements.filter(e=>e.getAttribute("data-turbo-track")==="dynamic")}get oldHeadStylesheetElements(){return this.currentHeadSnapshot.getStylesheetElementsNotInSnapshot(this.newHeadSnapshot)}get newHeadStylesheetElements(){return this.newHeadSnapshot.getStylesheetElementsNotInSnapshot(this.currentHeadSnapshot)}get newHeadScriptElements(){return this.newHeadSnapshot.getScriptElementsNotInSnapshot(this.currentHeadSnapshot)}get currentHeadProvisionalElements(){return this.currentHeadSnapshot.provisionalElements}get newHeadProvisionalElements(){return this.newHeadSnapshot.provisionalElements}get newBodyScriptElements(){return this.newElement.querySelectorAll("script")}}class u2 extends Sy{static renderElement(e,t){Qf(e,t,{callbacks:{beforeNodeMorphed:(i,s)=>a2(i,s)&&!l2(i)?(i.reload(),!1):!0}}),Ct("turbo:morph",{detail:{currentElement:e,newElement:t}})}async preservingPermanentElements(e){return await e()}get renderMethod(){return"morph"}get shouldAutofocus(){return!1}}class A3{keys=[];snapshots={};constructor(e){this.size=e}has(e){return oc(e)in this.snapshots}get(e){if(this.has(e)){const t=this.read(e);return this.touch(e),t}}put(e,t){return this.write(e,t),this.touch(e),t}clear(){this.snapshots={}}read(e){return this.snapshots[oc(e)]}write(e,t){this.snapshots[oc(e)]=t}touch(e){const t=oc(e),i=this.keys.indexOf(t);i>-1&&this.keys.splice(i,1),this.keys.unshift(t),this.trim()}trim(){for(const e of this.keys.splice(this.size))delete this.snapshots[e]}}class P3 extends i2{snapshotCache=new A3(10);lastRenderedLocation=new URL(location.href);forceReloaded=!1;shouldTransitionTo(e){return this.snapshot.prefersViewTransitions&&e.prefersViewTransitions}renderPage(e,t=!1,i=!0,s){const o=this.isPageRefresh(s)&&this.snapshot.shouldMorphPage?u2:Sy,a=new o(this.snapshot,e,t,i);return a.shouldRender?s?.changeHistory():this.forceReloaded=!0,this.render(a)}renderError(e,t){t?.changeHistory();const i=new E3(this.snapshot,e,!1);return this.render(i)}clearSnapshotCache(){this.snapshotCache.clear()}async cacheSnapshot(e=this.snapshot){if(e.isCacheable){this.delegate.viewWillCacheSnapshot();const{lastRenderedLocation:t}=this;await V_();const i=e.clone();return this.snapshotCache.put(t,i),i}}getCachedSnapshotForLocation(e){return this.snapshotCache.get(e)}isPageRefresh(e){return!e||this.lastRenderedLocation.pathname===e.location.pathname&&e.action==="replace"}shouldPreserveScrollPosition(e){return this.isPageRefresh(e)&&this.snapshot.shouldPreserveScrollPosition}get snapshot(){return zn.fromElement(this.element)}}class D3{selector="a[data-turbo-preload]";constructor(e,t){this.delegate=e,this.snapshotCache=t}start(){document.readyState==="loading"?document.addEventListener("DOMContentLoaded",this.#e):this.preloadOnLoadLinksForView(document.body)}stop(){document.removeEventListener("DOMContentLoaded",this.#e)}preloadOnLoadLinksForView(e){for(const t of e.querySelectorAll(this.selector))this.delegate.shouldPreloadLink(t)&&this.preloadURL(t)}async preloadURL(e){const t=new URL(e.href);if(this.snapshotCache.has(t))return;await new yu(this,Tn.get,t,new URLSearchParams,e).perform()}prepareRequest(e){e.headers["X-Sec-Purpose"]="prefetch"}async requestSucceededWithResponse(e,t){try{const i=await t.responseHTML,s=zn.fromHTMLString(i);this.snapshotCache.put(e.url,s)}catch{}}requestStarted(e){}requestErrored(e){}requestFinished(e){}requestPreventedHandlingResponse(e,t){}requestFailedWithResponse(e,t){}#e=()=>{this.preloadOnLoadLinksForView(document.body)}}class M3{constructor(e){this.session=e}clear(){this.session.clearCache()}resetCacheControl(){this.#e("")}exemptPageFromCache(){this.#e("no-cache")}exemptPageFromPreview(){this.#e("no-preview")}#e(e){mQ("turbo-cache-control",e)}}class I3{navigator=new O3(this);history=new h3(this);view=new P3(this,document.documentElement);adapter=new o3(this);pageObserver=new y3(this);cacheObserver=new a3;linkPrefetchObserver=new u3(this,document);linkClickObserver=new s2(this,window);formSubmitObserver=new Oy(this,document);scrollObserver=new b3(this);streamObserver=new _3(this);formLinkClickObserver=new r2(this,document.documentElement);frameRedirector=new l3(this,document.documentElement);streamMessageRenderer=new v3;cache=new M3(this);enabled=!0;started=!1;#e=150;constructor(e){this.recentRequests=e,this.preloader=new D3(this,this.view.snapshotCache),this.debouncedRefresh=this.refresh,this.pageRefreshDebouncePeriod=this.pageRefreshDebouncePeriod}start(){this.started||(this.pageObserver.start(),this.cacheObserver.start(),this.linkPrefetchObserver.start(),this.formLinkClickObserver.start(),this.linkClickObserver.start(),this.formSubmitObserver.start(),this.scrollObserver.start(),this.streamObserver.start(),this.frameRedirector.start(),this.history.start(),this.preloader.start(),this.started=!0,this.enabled=!0)}disable(){this.enabled=!1}stop(){this.started&&(this.pageObserver.stop(),this.cacheObserver.stop(),this.linkPrefetchObserver.stop(),this.formLinkClickObserver.stop(),this.linkClickObserver.stop(),this.formSubmitObserver.stop(),this.scrollObserver.stop(),this.streamObserver.stop(),this.frameRedirector.stop(),this.history.stop(),this.preloader.stop(),this.started=!1)}registerAdapter(e){this.adapter=e}visit(e,t={}){const i=t.frame?document.getElementById(t.frame):null;if(i instanceof Hn){const s=t.action||xo(i);i.delegate.proposeVisitIfNavigatedWithAction(i,s),i.src=e.toString()}else this.navigator.proposeVisit(ai(e),t)}refresh(e,t){const i=t&&this.recentRequests.has(t),s=e===document.baseURI;!i&&!this.navigator.currentVisit&&s&&this.visit(e,{action:"replace",shouldCacheSnapshot:!1})}connectStreamSource(e){this.streamObserver.connectStreamSource(e)}disconnectStreamSource(e){this.streamObserver.disconnectStreamSource(e)}renderStreamMessage(e){this.streamMessageRenderer.render(al.wrap(e))}clearCache(){this.view.clearSnapshotCache()}setProgressBarDelay(e){console.warn("Please replace `session.setProgressBarDelay(delay)` with `session.progressBarDelay = delay`. The function is deprecated and will be removed in a future version of Turbo.`"),this.progressBarDelay=e}set progressBarDelay(e){Kt.drive.progressBarDelay=e}get progressBarDelay(){return Kt.drive.progressBarDelay}set drive(e){Kt.drive.enabled=e}get drive(){return Kt.drive.enabled}set formMode(e){Kt.forms.mode=e}get formMode(){return Kt.forms.mode}get location(){return this.history.location}get restorationIdentifier(){return this.history.restorationIdentifier}get pageRefreshDebouncePeriod(){return this.#e}set pageRefreshDebouncePeriod(e){this.refresh=OQ(this.debouncedRefresh.bind(this),e),this.#e=e}shouldPreloadLink(e){const t=e.hasAttribute("data-turbo-method"),i=e.hasAttribute("data-turbo-stream"),s=e.getAttribute("data-turbo-frame"),r=s=="_top"?null:document.getElementById(s)||fa(e,"turbo-frame:not([disabled])");if(t||i||r instanceof Hn)return!1;{const o=new URL(e.href);return this.elementIsNavigatable(e)&&Er(o,this.snapshot.rootLocation)}}historyPoppedToLocationWithRestorationIdentifierAndDirection(e,t,i){this.enabled?this.navigator.startVisit(e,t,{action:"restore",historyChanged:!0,direction:i}):this.adapter.pageInvalidated({reason:"turbo_disabled"})}scrollPositionChanged(e){this.history.updateRestorationData({scrollPosition:e})}willSubmitFormLinkToLocation(e,t){return this.elementIsNavigatable(e)&&Er(t,this.snapshot.rootLocation)}submittedFormLinkToLocation(){}canPrefetchRequestToLocation(e,t){return this.elementIsNavigatable(e)&&Er(t,this.snapshot.rootLocation)&&this.navigator.linkPrefetchingIsEnabledForLocation(t)}willFollowLinkToLocation(e,t,i){return this.elementIsNavigatable(e)&&Er(t,this.snapshot.rootLocation)&&this.applicationAllowsFollowingLinkToLocation(e,t,i)}followedLinkToLocation(e,t){const i=this.getActionForLink(e),s=e.hasAttribute("data-turbo-stream");this.visit(t.href,{action:i,acceptsStreamResponse:s})}allowsVisitingLocationWithAction(e,t){return this.locationWithActionIsSamePage(e,t)||this.applicationAllowsVisitingLocation(e)}visitProposedToLocation(e,t){O1(e),this.adapter.visitProposedToLocation(e,t)}visitStarted(e){e.acceptsStreamResponse||(wd(document.documentElement),this.view.markVisitDirection(e.direction)),O1(e.location),e.silent||this.notifyApplicationAfterVisitingLocation(e.location,e.action)}visitCompleted(e){this.view.unmarkVisitDirection(),_d(document.documentElement),this.notifyApplicationAfterPageLoad(e.getTimingMetrics())}locationWithActionIsSamePage(e,t){return this.navigator.locationWithActionIsSamePage(e,t)}visitScrolledToSamePageLocation(e,t){this.notifyApplicationAfterVisitingSamePageLocation(e,t)}willSubmitForm(e,t){const i=fy(e,t);return this.submissionIsNavigatable(e,t)&&Er(ai(i),this.snapshot.rootLocation)}formSubmitted(e,t){this.navigator.submitForm(e,t)}pageBecameInteractive(){this.view.lastRenderedLocation=this.location,this.notifyApplicationAfterPageLoad()}pageLoaded(){this.history.assumeControlOfScrollRestoration()}pageWillUnload(){this.history.relinquishControlOfScrollRestoration()}receivedMessageFromStream(e){this.renderStreamMessage(e)}viewWillCacheSnapshot(){this.navigator.currentVisit?.silent||this.notifyApplicationBeforeCachingSnapshot()}allowsImmediateRender({element:e},t){const i=this.notifyApplicationBeforeRender(e,t),{defaultPrevented:s,detail:{render:r}}=i;return this.view.renderer&&r&&(this.view.renderer.renderElement=r),!s}viewRenderedSnapshot(e,t,i){this.view.lastRenderedLocation=this.history.location,this.notifyApplicationAfterRender(i)}preloadOnLoadLinksForView(e){this.preloader.preloadOnLoadLinksForView(e)}viewInvalidated(e){this.adapter.pageInvalidated(e)}frameLoaded(e){this.notifyApplicationAfterFrameLoad(e)}frameRendered(e,t){this.notifyApplicationAfterFrameRender(e,t)}applicationAllowsFollowingLinkToLocation(e,t,i){return!this.notifyApplicationAfterClickingLinkToLocation(e,t,i).defaultPrevented}applicationAllowsVisitingLocation(e){return!this.notifyApplicationBeforeVisitingLocation(e).defaultPrevented}notifyApplicationAfterClickingLinkToLocation(e,t,i){return Ct("turbo:click",{target:e,detail:{url:t.href,originalEvent:i},cancelable:!0})}notifyApplicationBeforeVisitingLocation(e){return Ct("turbo:before-visit",{detail:{url:e.href},cancelable:!0})}notifyApplicationAfterVisitingLocation(e,t){return Ct("turbo:visit",{detail:{url:e.href,action:t}})}notifyApplicationBeforeCachingSnapshot(){return Ct("turbo:before-cache")}notifyApplicationBeforeRender(e,t){return Ct("turbo:before-render",{detail:{newBody:e,...t},cancelable:!0})}notifyApplicationAfterRender(e){return Ct("turbo:render",{detail:{renderMethod:e}})}notifyApplicationAfterPageLoad(e={}){return Ct("turbo:load",{detail:{url:this.location.href,timing:e}})}notifyApplicationAfterVisitingSamePageLocation(e,t){dispatchEvent(new HashChangeEvent("hashchange",{oldURL:e.toString(),newURL:t.toString()}))}notifyApplicationAfterFrameLoad(e){return Ct("turbo:frame-load",{target:e})}notifyApplicationAfterFrameRender(e,t){return Ct("turbo:frame-render",{detail:{fetchResponse:e},target:t,cancelable:!0})}submissionIsNavigatable(e,t){if(Kt.forms.mode=="off")return!1;{const i=t?this.elementIsNavigatable(t):!0;return Kt.forms.mode=="optin"?i&&e.closest('[data-turbo="true"]')!=null:i&&this.elementIsNavigatable(e)}}elementIsNavigatable(e){const t=fa(e,"[data-turbo]"),i=fa(e,"turbo-frame");return Kt.drive.enabled||i?t?t.getAttribute("data-turbo")!="false":!0:t?t.getAttribute("data-turbo")=="true":!1}getActionForLink(e){return xo(e)||"advance"}get snapshot(){return this.view.snapshot}}function O1(n){Object.defineProperties(n,R3)}const R3={absoluteURL:{get(){return this.toString()}}},$t=new I3(G_),{cache:L3,navigator:$3}=$t;function c2(){$t.start()}function Q3(n){$t.registerAdapter(n)}function B3(n,e){$t.visit(n,e)}function d2(n){$t.connectStreamSource(n)}function f2(n){$t.disconnectStreamSource(n)}function N3(n){$t.renderStreamMessage(n)}function F3(){console.warn("Please replace `Turbo.clearCache()` with `Turbo.cache.clear()`. The top-level function is deprecated and will be removed in a future version of Turbo.`"),$t.clearCache()}function V3(n){console.warn("Please replace `Turbo.setProgressBarDelay(delay)` with `Turbo.config.drive.progressBarDelay = delay`. The top-level function is deprecated and will be removed in a future version of Turbo.`"),Kt.drive.progressBarDelay=n}function U3(n){console.warn("Please replace `Turbo.setConfirmMethod(confirmMethod)` with `Turbo.config.forms.confirm = confirmMethod`. The top-level function is deprecated and will be removed in a future version of Turbo.`"),Kt.forms.confirm=n}function q3(n){console.warn("Please replace `Turbo.setFormMode(mode)` with `Turbo.config.forms.mode = mode`. The top-level function is deprecated and will be removed in a future version of Turbo.`"),Kt.forms.mode=n}function z3(n,e){u2.renderElement(n,e)}function j3(n,e){h2.renderElement(n,e)}var X3=Object.freeze({__proto__:null,navigator:$3,session:$t,cache:L3,PageRenderer:Sy,PageSnapshot:zn,FrameRenderer:by,fetch:K_,config:Kt,start:c2,registerAdapter:Q3,visit:B3,connectStreamSource:d2,disconnectStreamSource:f2,renderStreamMessage:N3,clearCache:F3,setProgressBarDelay:V3,setConfirmMethod:U3,setFormMode:q3,morphBodyElements:z3,morphTurboFrameElements:j3,morphChildren:vy,morphElements:Qf});class H3 extends Error{}class W3{fetchResponseLoaded=e=>Promise.resolve();#e=null;#t=()=>{};#i=!1;#r=!1;#o=new Set;#s=!1;action=null;constructor(e){this.element=e,this.view=new UQ(this,this.element),this.appearanceObserver=new EQ(this,this.element),this.formLinkClickObserver=new r2(this,this.element),this.linkInterceptor=new n2(this,this.element),this.restorationIdentifier=Fr(),this.formSubmitObserver=new Oy(this,this.element)}connect(){this.#i||(this.#i=!0,this.loadingStyle==ra.lazy?this.appearanceObserver.start():this.#n(),this.formLinkClickObserver.start(),this.linkInterceptor.start(),this.formSubmitObserver.start())}disconnect(){this.#i&&(this.#i=!1,this.appearanceObserver.stop(),this.formLinkClickObserver.stop(),this.linkInterceptor.stop(),this.formSubmitObserver.stop())}disabledChanged(){this.loadingStyle==ra.eager&&this.#n()}sourceURLChanged(){this.#y("src")||(this.element.isConnected&&(this.complete=!1),(this.loadingStyle==ra.eager||this.#r)&&this.#n())}sourceURLReloaded(){const{refresh:e,src:t}=this.element;return this.#s=t&&e==="morph",this.element.removeAttribute("complete"),this.element.src=null,this.element.src=t,this.element.loaded}loadingStyleChanged(){this.loadingStyle==ra.lazy?this.appearanceObserver.start():(this.appearanceObserver.stop(),this.#n())}async#n(){this.enabled&&this.isActive&&!this.complete&&this.sourceURL&&(this.element.loaded=this.#c(ai(this.sourceURL)),this.appearanceObserver.stop(),await this.element.loaded,this.#r=!0)}async loadResponse(e){(e.redirected||e.succeeded&&e.isHTML)&&(this.sourceURL=e.response.url);try{const t=await e.responseHTML;if(t){const i=U_(t);zn.fromDocument(i).isVisitable?await this.#l(e,i):await this.#f(e)}}finally{this.#s=!1,this.fetchResponseLoaded=()=>Promise.resolve()}}elementAppearedInViewport(e){this.proposeVisitIfNavigatedWithAction(e,xo(e)),this.#n()}willSubmitFormLinkToLocation(e){return this.#h(e)}submittedFormLinkToLocation(e,t,i){const s=this.#a(e);s&&i.setAttribute("data-turbo-frame",s.id)}shouldInterceptLinkClick(e,t,i){return this.#h(e)}linkClickIntercepted(e,t){this.#d(e,t)}willSubmitForm(e,t){return e.closest("turbo-frame")==this.element&&this.#h(e,t)}formSubmitted(e,t){this.formSubmission&&this.formSubmission.stop(),this.formSubmission=new Lf(this,e,t);const{fetchRequest:i}=this.formSubmission;this.prepareRequest(i),this.formSubmission.start()}prepareRequest(e){e.headers["Turbo-Frame"]=this.id,this.currentNavigationElement?.hasAttribute("data-turbo-stream")&&e.acceptResponseType(al.contentType)}requestStarted(e){wd(this.element)}requestPreventedHandlingResponse(e,t){this.#t()}async requestSucceededWithResponse(e,t){await this.loadResponse(t),this.#t()}async requestFailedWithResponse(e,t){await this.loadResponse(t),this.#t()}requestErrored(e,t){console.error(t),this.#t()}requestFinished(e){_d(this.element)}formSubmissionStarted({formElement:e}){wd(e,this.#a(e))}formSubmissionSucceededWithResponse(e,t){const i=this.#a(e.formElement,e.submitter);i.delegate.proposeVisitIfNavigatedWithAction(i,xo(e.submitter,e.formElement,i)),i.delegate.loadResponse(t),e.isSafe||$t.clearCache()}formSubmissionFailedWithResponse(e,t){this.element.delegate.loadResponse(t),$t.clearCache()}formSubmissionErrored(e,t){console.error(t)}formSubmissionFinished({formElement:e}){_d(e,this.#a(e))}allowsImmediateRender({element:e},t){const i=Ct("turbo:before-frame-render",{target:this.element,detail:{newFrame:e,...t},cancelable:!0}),{defaultPrevented:s,detail:{render:r}}=i;return this.view.renderer&&r&&(this.view.renderer.renderElement=r),!s}viewRenderedSnapshot(e,t,i){}preloadOnLoadLinksForView(e){$t.preloadOnLoadLinksForView(e)}viewInvalidated(){}willRenderFrame(e,t){this.previousFrameElement=e.cloneNode(!0)}visitCachedSnapshot=({element:e})=>{const t=e.querySelector("#"+this.element.id);t&&this.previousFrameElement&&t.replaceChildren(...this.previousFrameElement.children),delete this.previousFrameElement};async#l(e,t){const i=await this.extractForeignFrameElement(t.body),s=this.#s?h2:by;if(i){const r=new $f(i),o=new s(this,this.view.snapshot,r,!1,!1);this.view.renderPromise&&await this.view.renderPromise,this.changeHistory(),await this.view.render(o),this.complete=!0,$t.frameRendered(e,this.element),$t.frameLoaded(this.element),await this.fetchResponseLoaded(e)}else this.#p(e)&&this.#m(e)}async#c(e){const t=new yu(this,Tn.get,e,new URLSearchParams,this.element);return this.#e?.cancel(),this.#e=t,new Promise(i=>{this.#t=()=>{this.#t=()=>{},this.#e=null,i()},t.perform()})}#d(e,t,i){const s=this.#a(e,i);s.delegate.proposeVisitIfNavigatedWithAction(s,xo(i,e,s)),this.#v(e,()=>{s.src=t})}proposeVisitIfNavigatedWithAction(e,t=null){if(this.action=t,this.action){const i=zn.fromElement(e).clone(),{visitCachedSnapshot:s}=e.delegate;e.delegate.fetchResponseLoaded=async r=>{if(e.src){const{statusCode:o,redirected:a}=r,l=await r.responseHTML,u={response:{statusCode:o,redirected:a,responseHTML:l},visitCachedSnapshot:s,willRender:!1,updateHistory:!1,restorationIdentifier:this.restorationIdentifier,snapshot:i};this.action&&(u.action=this.action),$t.visit(e.src,u)}}}}changeHistory(){if(this.action){const e=z_(this.action);$t.history.update(e,ai(this.element.src||""),this.restorationIdentifier)}}async#f(e){console.warn(`The response (${e.statusCode}) from <turbo-frame id="${this.element.id}"> is performing a full page visit due to turbo-visit-control.`),await this.#u(e.response)}#p(e){this.element.setAttribute("complete","");const t=e.response,i=async(r,o)=>{r instanceof Response?this.#u(r):$t.visit(r,o)};return!Ct("turbo:frame-missing",{target:this.element,detail:{response:t,visit:i},cancelable:!0}).defaultPrevented}#m(e){this.view.missing(),this.#g(e)}#g(e){const t=`The response (${e.statusCode}) did not contain the expected <turbo-frame id="${this.element.id}"> and will be ignored. To perform a full page visit instead, set turbo-visit-control to reload.`;throw new H3(t)}async#u(e){const t=new py(e),i=await t.responseHTML,{location:s,redirected:r,statusCode:o}=t;return $t.visit(s,{response:{redirected:r,statusCode:o,responseHTML:i}})}#a(e,t){const i=Td("data-turbo-frame",t,e)||this.element.getAttribute("target");return y1(i)??this.element}async extractForeignFrameElement(e){let t;const i=CSS.escape(this.id);try{if(t=b1(e.querySelector(`turbo-frame#${i}`),this.sourceURL),t)return t;if(t=b1(e.querySelector(`turbo-frame[src][recurse~=${i}]`),this.sourceURL),t)return await t.loaded,await this.extractForeignFrameElement(t)}catch(s){return console.error(s),new Hn}return null}#O(e,t){const i=fy(e,t);return Er(ai(i),this.rootLocation)}#h(e,t){const i=Td("data-turbo-frame",t,e)||this.element.getAttribute("target");if(e instanceof HTMLFormElement&&!this.#O(e,t)||!this.enabled||i=="_top")return!1;if(i){const s=y1(i);if(s)return!s.disabled}return!(!$t.elementIsNavigatable(e)||t&&!$t.elementIsNavigatable(t))}get id(){return this.element.id}get enabled(){return!this.element.disabled}get sourceURL(){if(this.element.src)return this.element.src}set sourceURL(e){this.#b("src",()=>{this.element.src=e??null})}get loadingStyle(){return this.element.loading}get isLoading(){return this.formSubmission!==void 0||this.#t()!==void 0}get complete(){return this.element.hasAttribute("complete")}set complete(e){e?this.element.setAttribute("complete",""):this.element.removeAttribute("complete")}get isActive(){return this.element.isActive&&this.#i}get rootLocation(){const t=this.element.ownerDocument.querySelector('meta[name="turbo-root"]')?.content??"/";return ai(t)}#y(e){return this.#o.has(e)}#b(e,t){this.#o.add(e),t(),this.#o.delete(e)}#v(e,t){this.currentNavigationElement=e,t(),delete this.currentNavigationElement}}function y1(n){if(n!=null){const e=document.getElementById(n);if(e instanceof Hn)return e}}function b1(n,e){if(n){const t=n.getAttribute("src");if(t!=null&&e!=null&&Y_(t,e))throw new Error(`Matching <turbo-frame id="${n.id}"> element has a source URL which references itself`);if(n.ownerDocument!==document&&(n=document.importNode(n,!0)),n instanceof Hn)return n.connectedCallback(),n.disconnectedCallback(),n}}const p2={after(){this.targetElements.forEach(n=>n.parentElement?.insertBefore(this.templateContent,n.nextSibling))},append(){this.removeDuplicateTargetChildren(),this.targetElements.forEach(n=>n.append(this.templateContent))},before(){this.targetElements.forEach(n=>n.parentElement?.insertBefore(this.templateContent,n))},prepend(){this.removeDuplicateTargetChildren(),this.targetElements.forEach(n=>n.prepend(this.templateContent))},remove(){this.targetElements.forEach(n=>n.remove())},replace(){const n=this.getAttribute("method");this.targetElements.forEach(e=>{n==="morph"?Qf(e,this.templateContent):e.replaceWith(this.templateContent)})},update(){const n=this.getAttribute("method");this.targetElements.forEach(e=>{n==="morph"?vy(e,this.templateContent):(e.innerHTML="",e.append(this.templateContent))})},refresh(){$t.refresh(this.baseURI,this.requestId)}};class xy extends HTMLElement{static async renderElement(e){await e.performAction()}async connectedCallback(){try{await this.render()}catch(e){console.error(e)}finally{this.disconnect()}}async render(){return this.renderPromise??=(async()=>{const e=this.beforeRenderEvent;this.dispatchEvent(e)&&(await mh(),await e.detail.render(this))})()}disconnect(){try{this.remove()}catch{}}removeDuplicateTargetChildren(){this.duplicateChildren.forEach(e=>e.remove())}get duplicateChildren(){const e=this.targetElements.flatMap(i=>[...i.children]).filter(i=>!!i.getAttribute("id")),t=[...this.templateContent?.children||[]].filter(i=>!!i.getAttribute("id")).map(i=>i.getAttribute("id"));return e.filter(i=>t.includes(i.getAttribute("id")))}get performAction(){if(this.action){const e=p2[this.action];if(e)return e;this.#e("unknown action")}this.#e("action attribute is missing")}get targetElements(){if(this.target)return this.targetElementsById;if(this.targets)return this.targetElementsByQuery;this.#e("target or targets attribute is missing")}get templateContent(){return this.templateElement.content.cloneNode(!0)}get templateElement(){if(this.firstElementChild===null){const e=this.ownerDocument.createElement("template");return this.appendChild(e),e}else if(this.firstElementChild instanceof HTMLTemplateElement)return this.firstElementChild;this.#e("first child element must be a <template> element")}get action(){return this.getAttribute("action")}get target(){return this.getAttribute("target")}get targets(){return this.getAttribute("targets")}get requestId(){return this.getAttribute("request-id")}#e(e){throw new Error(`${this.description}: ${e}`)}get description(){return(this.outerHTML.match(/<[^>]+>/)??[])[0]??"<turbo-stream>"}get beforeRenderEvent(){return new CustomEvent("turbo:before-stream-render",{bubbles:!0,cancelable:!0,detail:{newStream:this,render:xy.renderElement}})}get targetElementsById(){const e=this.ownerDocument?.getElementById(this.target);return e!==null?[e]:[]}get targetElementsByQuery(){const e=this.ownerDocument?.querySelectorAll(this.targets);return e.length!==0?Array.prototype.slice.call(e):[]}}class Z3 extends HTMLElement{streamSource=null;connectedCallback(){this.streamSource=this.src.match(/^ws{1,2}:/)?new WebSocket(this.src):new EventSource(this.src),d2(this.streamSource)}disconnectedCallback(){this.streamSource&&(this.streamSource.close(),f2(this.streamSource))}get src(){return this.getAttribute("src")||""}}Hn.delegateConstructor=W3;customElements.get("turbo-frame")===void 0&&customElements.define("turbo-frame",Hn);customElements.get("turbo-stream")===void 0&&customElements.define("turbo-stream",xy);customElements.get("turbo-stream-source")===void 0&&customElements.define("turbo-stream-source",Z3);(()=>{let n=document.currentScript;if(n&&!n.hasAttribute("data-turbo-suppress-warning"))for(n=n.parentElement;n;){if(n==document.body)return console.warn(q_`
        You are loading Turbo from a <script> element inside the <body> element. This is probably not what you meant to do!

        Load your application’s JavaScript bundle inside the <head> element instead. <script> elements in <body> are evaluated with each page change.

        For more information, see: https://turbo.hotwired.dev/handbook/building#working-with-script-elements

        ——
        Suppress this warning by adding a "data-turbo-suppress-warning" attribute to: %s
      `,n.outerHTML);n=n.parentElement}})();window.Turbo={...X3,StreamActions:p2};c2();var m2={exports:{}};(function(n,e){(function(t){n.exports=t()})((function(t){var i=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];function s(T,w){var v=T[0],S=T[1],k=T[2],A=T[3];v+=(S&k|~S&A)+w[0]-680876936|0,v=(v<<7|v>>>25)+S|0,A+=(v&S|~v&k)+w[1]-389564586|0,A=(A<<12|A>>>20)+v|0,k+=(A&v|~A&S)+w[2]+606105819|0,k=(k<<17|k>>>15)+A|0,S+=(k&A|~k&v)+w[3]-1044525330|0,S=(S<<22|S>>>10)+k|0,v+=(S&k|~S&A)+w[4]-176418897|0,v=(v<<7|v>>>25)+S|0,A+=(v&S|~v&k)+w[5]+1200080426|0,A=(A<<12|A>>>20)+v|0,k+=(A&v|~A&S)+w[6]-1473231341|0,k=(k<<17|k>>>15)+A|0,S+=(k&A|~k&v)+w[7]-45705983|0,S=(S<<22|S>>>10)+k|0,v+=(S&k|~S&A)+w[8]+1770035416|0,v=(v<<7|v>>>25)+S|0,A+=(v&S|~v&k)+w[9]-1958414417|0,A=(A<<12|A>>>20)+v|0,k+=(A&v|~A&S)+w[10]-42063|0,k=(k<<17|k>>>15)+A|0,S+=(k&A|~k&v)+w[11]-1990404162|0,S=(S<<22|S>>>10)+k|0,v+=(S&k|~S&A)+w[12]+1804603682|0,v=(v<<7|v>>>25)+S|0,A+=(v&S|~v&k)+w[13]-40341101|0,A=(A<<12|A>>>20)+v|0,k+=(A&v|~A&S)+w[14]-1502002290|0,k=(k<<17|k>>>15)+A|0,S+=(k&A|~k&v)+w[15]+1236535329|0,S=(S<<22|S>>>10)+k|0,v+=(S&A|k&~A)+w[1]-165796510|0,v=(v<<5|v>>>27)+S|0,A+=(v&k|S&~k)+w[6]-1069501632|0,A=(A<<9|A>>>23)+v|0,k+=(A&S|v&~S)+w[11]+643717713|0,k=(k<<14|k>>>18)+A|0,S+=(k&v|A&~v)+w[0]-373897302|0,S=(S<<20|S>>>12)+k|0,v+=(S&A|k&~A)+w[5]-701558691|0,v=(v<<5|v>>>27)+S|0,A+=(v&k|S&~k)+w[10]+38016083|0,A=(A<<9|A>>>23)+v|0,k+=(A&S|v&~S)+w[15]-660478335|0,k=(k<<14|k>>>18)+A|0,S+=(k&v|A&~v)+w[4]-405537848|0,S=(S<<20|S>>>12)+k|0,v+=(S&A|k&~A)+w[9]+568446438|0,v=(v<<5|v>>>27)+S|0,A+=(v&k|S&~k)+w[14]-1019803690|0,A=(A<<9|A>>>23)+v|0,k+=(A&S|v&~S)+w[3]-187363961|0,k=(k<<14|k>>>18)+A|0,S+=(k&v|A&~v)+w[8]+1163531501|0,S=(S<<20|S>>>12)+k|0,v+=(S&A|k&~A)+w[13]-1444681467|0,v=(v<<5|v>>>27)+S|0,A+=(v&k|S&~k)+w[2]-51403784|0,A=(A<<9|A>>>23)+v|0,k+=(A&S|v&~S)+w[7]+1735328473|0,k=(k<<14|k>>>18)+A|0,S+=(k&v|A&~v)+w[12]-1926607734|0,S=(S<<20|S>>>12)+k|0,v+=(S^k^A)+w[5]-378558|0,v=(v<<4|v>>>28)+S|0,A+=(v^S^k)+w[8]-2022574463|0,A=(A<<11|A>>>21)+v|0,k+=(A^v^S)+w[11]+1839030562|0,k=(k<<16|k>>>16)+A|0,S+=(k^A^v)+w[14]-35309556|0,S=(S<<23|S>>>9)+k|0,v+=(S^k^A)+w[1]-1530992060|0,v=(v<<4|v>>>28)+S|0,A+=(v^S^k)+w[4]+1272893353|0,A=(A<<11|A>>>21)+v|0,k+=(A^v^S)+w[7]-155497632|0,k=(k<<16|k>>>16)+A|0,S+=(k^A^v)+w[10]-1094730640|0,S=(S<<23|S>>>9)+k|0,v+=(S^k^A)+w[13]+681279174|0,v=(v<<4|v>>>28)+S|0,A+=(v^S^k)+w[0]-358537222|0,A=(A<<11|A>>>21)+v|0,k+=(A^v^S)+w[3]-722521979|0,k=(k<<16|k>>>16)+A|0,S+=(k^A^v)+w[6]+76029189|0,S=(S<<23|S>>>9)+k|0,v+=(S^k^A)+w[9]-640364487|0,v=(v<<4|v>>>28)+S|0,A+=(v^S^k)+w[12]-421815835|0,A=(A<<11|A>>>21)+v|0,k+=(A^v^S)+w[15]+530742520|0,k=(k<<16|k>>>16)+A|0,S+=(k^A^v)+w[2]-995338651|0,S=(S<<23|S>>>9)+k|0,v+=(k^(S|~A))+w[0]-198630844|0,v=(v<<6|v>>>26)+S|0,A+=(S^(v|~k))+w[7]+1126891415|0,A=(A<<10|A>>>22)+v|0,k+=(v^(A|~S))+w[14]-1416354905|0,k=(k<<15|k>>>17)+A|0,S+=(A^(k|~v))+w[5]-57434055|0,S=(S<<21|S>>>11)+k|0,v+=(k^(S|~A))+w[12]+1700485571|0,v=(v<<6|v>>>26)+S|0,A+=(S^(v|~k))+w[3]-1894986606|0,A=(A<<10|A>>>22)+v|0,k+=(v^(A|~S))+w[10]-1051523|0,k=(k<<15|k>>>17)+A|0,S+=(A^(k|~v))+w[1]-2054922799|0,S=(S<<21|S>>>11)+k|0,v+=(k^(S|~A))+w[8]+1873313359|0,v=(v<<6|v>>>26)+S|0,A+=(S^(v|~k))+w[15]-30611744|0,A=(A<<10|A>>>22)+v|0,k+=(v^(A|~S))+w[6]-1560198380|0,k=(k<<15|k>>>17)+A|0,S+=(A^(k|~v))+w[13]+1309151649|0,S=(S<<21|S>>>11)+k|0,v+=(k^(S|~A))+w[4]-145523070|0,v=(v<<6|v>>>26)+S|0,A+=(S^(v|~k))+w[11]-1120210379|0,A=(A<<10|A>>>22)+v|0,k+=(v^(A|~S))+w[2]+718787259|0,k=(k<<15|k>>>17)+A|0,S+=(A^(k|~v))+w[9]-343485551|0,S=(S<<21|S>>>11)+k|0,T[0]=v+T[0]|0,T[1]=S+T[1]|0,T[2]=k+T[2]|0,T[3]=A+T[3]|0}function r(T){var w=[],v;for(v=0;v<64;v+=4)w[v>>2]=T.charCodeAt(v)+(T.charCodeAt(v+1)<<8)+(T.charCodeAt(v+2)<<16)+(T.charCodeAt(v+3)<<24);return w}function o(T){var w=[],v;for(v=0;v<64;v+=4)w[v>>2]=T[v]+(T[v+1]<<8)+(T[v+2]<<16)+(T[v+3]<<24);return w}function a(T){var w=T.length,v=[1732584193,-271733879,-1732584194,271733878],S,k,A,M,B,P;for(S=64;S<=w;S+=64)s(v,r(T.substring(S-64,S)));for(T=T.substring(S-64),k=T.length,A=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],S=0;S<k;S+=1)A[S>>2]|=T.charCodeAt(S)<<(S%4<<3);if(A[S>>2]|=128<<(S%4<<3),S>55)for(s(v,A),S=0;S<16;S+=1)A[S]=0;return M=w*8,M=M.toString(16).match(/(.*?)(.{0,8})$/),B=parseInt(M[2],16),P=parseInt(M[1],16)||0,A[14]=B,A[15]=P,s(v,A),v}function l(T){var w=T.length,v=[1732584193,-271733879,-1732584194,271733878],S,k,A,M,B,P;for(S=64;S<=w;S+=64)s(v,o(T.subarray(S-64,S)));for(T=S-64<w?T.subarray(S-64):new Uint8Array(0),k=T.length,A=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],S=0;S<k;S+=1)A[S>>2]|=T[S]<<(S%4<<3);if(A[S>>2]|=128<<(S%4<<3),S>55)for(s(v,A),S=0;S<16;S+=1)A[S]=0;return M=w*8,M=M.toString(16).match(/(.*?)(.{0,8})$/),B=parseInt(M[2],16),P=parseInt(M[1],16)||0,A[14]=B,A[15]=P,s(v,A),v}function h(T){var w="",v;for(v=0;v<4;v+=1)w+=i[T>>v*8+4&15]+i[T>>v*8&15];return w}function u(T){var w;for(w=0;w<T.length;w+=1)T[w]=h(T[w]);return T.join("")}u(a("hello")),typeof ArrayBuffer<"u"&&!ArrayBuffer.prototype.slice&&(function(){function T(w,v){return w=w|0||0,w<0?Math.max(w+v,0):Math.min(w,v)}ArrayBuffer.prototype.slice=function(w,v){var S=this.byteLength,k=T(w,S),A=S,M,B,P,R;return v!==t&&(A=T(v,S)),k>A?new ArrayBuffer(0):(M=A-k,B=new ArrayBuffer(M),P=new Uint8Array(B),R=new Uint8Array(this,k,M),P.set(R),B)}})();function c(T){return/[\u0080-\uFFFF]/.test(T)&&(T=unescape(encodeURIComponent(T))),T}function f(T,w){var v=T.length,S=new ArrayBuffer(v),k=new Uint8Array(S),A;for(A=0;A<v;A+=1)k[A]=T.charCodeAt(A);return w?k:S}function p(T){return String.fromCharCode.apply(null,new Uint8Array(T))}function b(T,w,v){var S=new Uint8Array(T.byteLength+w.byteLength);return S.set(new Uint8Array(T)),S.set(new Uint8Array(w),T.byteLength),S}function y(T){var w=[],v=T.length,S;for(S=0;S<v-1;S+=2)w.push(parseInt(T.substr(S,2),16));return String.fromCharCode.apply(String,w)}function _(){this.reset()}return _.prototype.append=function(T){return this.appendBinary(c(T)),this},_.prototype.appendBinary=function(T){this._buff+=T,this._length+=T.length;var w=this._buff.length,v;for(v=64;v<=w;v+=64)s(this._hash,r(this._buff.substring(v-64,v)));return this._buff=this._buff.substring(v-64),this},_.prototype.end=function(T){var w=this._buff,v=w.length,S,k=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],A;for(S=0;S<v;S+=1)k[S>>2]|=w.charCodeAt(S)<<(S%4<<3);return this._finish(k,v),A=u(this._hash),T&&(A=y(A)),this.reset(),A},_.prototype.reset=function(){return this._buff="",this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},_.prototype.getState=function(){return{buff:this._buff,length:this._length,hash:this._hash.slice()}},_.prototype.setState=function(T){return this._buff=T.buff,this._length=T.length,this._hash=T.hash,this},_.prototype.destroy=function(){delete this._hash,delete this._buff,delete this._length},_.prototype._finish=function(T,w){var v=w,S,k,A;if(T[v>>2]|=128<<(v%4<<3),v>55)for(s(this._hash,T),v=0;v<16;v+=1)T[v]=0;S=this._length*8,S=S.toString(16).match(/(.*?)(.{0,8})$/),k=parseInt(S[2],16),A=parseInt(S[1],16)||0,T[14]=k,T[15]=A,s(this._hash,T)},_.hash=function(T,w){return _.hashBinary(c(T),w)},_.hashBinary=function(T,w){var v=a(T),S=u(v);return w?y(S):S},_.ArrayBuffer=function(){this.reset()},_.ArrayBuffer.prototype.append=function(T){var w=b(this._buff.buffer,T),v=w.length,S;for(this._length+=T.byteLength,S=64;S<=v;S+=64)s(this._hash,o(w.subarray(S-64,S)));return this._buff=S-64<v?new Uint8Array(w.buffer.slice(S-64)):new Uint8Array(0),this},_.ArrayBuffer.prototype.end=function(T){var w=this._buff,v=w.length,S=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],k,A;for(k=0;k<v;k+=1)S[k>>2]|=w[k]<<(k%4<<3);return this._finish(S,v),A=u(this._hash),T&&(A=y(A)),this.reset(),A},_.ArrayBuffer.prototype.reset=function(){return this._buff=new Uint8Array(0),this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},_.ArrayBuffer.prototype.getState=function(){var T=_.prototype.getState.call(this);return T.buff=p(T.buff),T},_.ArrayBuffer.prototype.setState=function(T){return T.buff=f(T.buff,!0),_.prototype.setState.call(this,T)},_.ArrayBuffer.prototype.destroy=_.prototype.destroy,_.ArrayBuffer.prototype._finish=_.prototype._finish,_.ArrayBuffer.hash=function(T,w){var v=l(new Uint8Array(T)),S=u(v);return w?y(S):S},_}))})(m2);var Y3=m2.exports;const G3=File.prototype.slice||File.prototype.mozSlice||File.prototype.webkitSlice;class Ty{static create(e,t){new Ty(e).create(t)}constructor(e){this.file=e,this.chunkSize=2097152,this.chunkCount=Math.ceil(this.file.size/this.chunkSize),this.chunkIndex=0}create(e){this.callback=e,this.md5Buffer=new Y3.ArrayBuffer,this.fileReader=new FileReader,this.fileReader.addEventListener("load",(t=>this.fileReaderDidLoad(t))),this.fileReader.addEventListener("error",(t=>this.fileReaderDidError(t))),this.readNextChunk()}fileReaderDidLoad(e){if(this.md5Buffer.append(e.target.result),!this.readNextChunk()){const t=this.md5Buffer.end(!0),i=btoa(t);this.callback(null,i)}}fileReaderDidError(e){this.callback(`Error reading ${this.file.name}`)}readNextChunk(){if(this.chunkIndex<this.chunkCount||this.chunkIndex==0&&this.chunkCount==0){const e=this.chunkIndex*this.chunkSize,t=Math.min(e+this.chunkSize,this.file.size),i=G3.call(this.file,e,t);return this.fileReader.readAsArrayBuffer(i),this.chunkIndex++,!0}else return!1}}function K3(n){const e=g2(document.head,`meta[name="${n}"]`);if(e)return e.getAttribute("content")}function J3(n,e){typeof n=="string"&&(e=n,n=document);const t=n.querySelectorAll(e);return O2(t)}function g2(n,e){return typeof n=="string"&&(e=n,n=document),n.querySelector(e)}function wy(n,e,t={}){const{disabled:i}=n,{bubbles:s,cancelable:r,detail:o}=t,a=document.createEvent("Event");a.initEvent(e,s||!0,r||!0),a.detail=o||{};try{n.disabled=!1,n.dispatchEvent(a)}finally{n.disabled=i}return a}function O2(n){return Array.isArray(n)?n:Array.from?Array.from(n):[].slice.call(n)}class e5{constructor(e,t,i,s={}){this.file=e,this.attributes={filename:e.name,content_type:e.type||"application/octet-stream",byte_size:e.size,checksum:t},this.xhr=new XMLHttpRequest,this.xhr.open("POST",i,!0),this.xhr.responseType="json",this.xhr.setRequestHeader("Content-Type","application/json"),this.xhr.setRequestHeader("Accept","application/json"),this.xhr.setRequestHeader("X-Requested-With","XMLHttpRequest"),Object.keys(s).forEach((o=>{this.xhr.setRequestHeader(o,s[o])}));const r=K3("csrf-token");r!=null&&this.xhr.setRequestHeader("X-CSRF-Token",r),this.xhr.addEventListener("load",(o=>this.requestDidLoad(o))),this.xhr.addEventListener("error",(o=>this.requestDidError(o)))}get status(){return this.xhr.status}get response(){const{responseType:e,response:t}=this.xhr;return e=="json"?t:JSON.parse(t)}create(e){this.callback=e,this.xhr.send(JSON.stringify({blob:this.attributes}))}requestDidLoad(e){if(this.status>=200&&this.status<300){const{response:t}=this,{direct_upload:i}=t;delete t.direct_upload,this.attributes=t,this.directUploadData=i,this.callback(null,this.toJSON())}else this.requestDidError(e)}requestDidError(e){this.callback(`Error creating Blob for "${this.file.name}". Status: ${this.status}`)}toJSON(){const e={};for(const t in this.attributes)e[t]=this.attributes[t];return e}}class t5{constructor(e){this.blob=e,this.file=e.file;const{url:t,headers:i}=e.directUploadData;this.xhr=new XMLHttpRequest,this.xhr.open("PUT",t,!0),this.xhr.responseType="text";for(const s in i)this.xhr.setRequestHeader(s,i[s]);this.xhr.addEventListener("load",(s=>this.requestDidLoad(s))),this.xhr.addEventListener("error",(s=>this.requestDidError(s)))}create(e){this.callback=e,this.xhr.send(this.file.slice())}requestDidLoad(e){const{status:t,response:i}=this.xhr;t>=200&&t<300?this.callback(null,i):this.requestDidError(e)}requestDidError(e){this.callback(`Error storing "${this.file.name}". Status: ${this.xhr.status}`)}}let i5=0;class y2{constructor(e,t,i,s={}){this.id=++i5,this.file=e,this.url=t,this.delegate=i,this.customHeaders=s}create(e){Ty.create(this.file,((t,i)=>{if(t){e(t);return}const s=new e5(this.file,i,this.url,this.customHeaders);v1(this.delegate,"directUploadWillCreateBlobWithXHR",s.xhr),s.create((r=>{if(r)e(r);else{const o=new t5(s);v1(this.delegate,"directUploadWillStoreFileWithXHR",o.xhr),o.create((a=>{a?e(a):e(null,s.toJSON())}))}}))}))}}function v1(n,e,...t){if(n&&typeof n[e]=="function")return n[e](...t)}class b2{constructor(e,t){this.input=e,this.file=t,this.directUpload=new y2(this.file,this.url,this),this.dispatch("initialize")}start(e){const t=document.createElement("input");t.type="hidden",t.name=this.input.name,this.input.insertAdjacentElement("beforebegin",t),this.dispatch("start"),this.directUpload.create(((i,s)=>{i?(t.parentNode.removeChild(t),this.dispatchError(i)):t.value=s.signed_id,this.dispatch("end"),e(i)}))}uploadRequestDidProgress(e){const t=e.loaded/e.total*100;t&&this.dispatch("progress",{progress:t})}get url(){return this.input.getAttribute("data-direct-upload-url")}dispatch(e,t={}){return t.file=this.file,t.id=this.directUpload.id,wy(this.input,`direct-upload:${e}`,{detail:t})}dispatchError(e){this.dispatch("error",{error:e}).defaultPrevented||alert(e)}directUploadWillCreateBlobWithXHR(e){this.dispatch("before-blob-request",{xhr:e})}directUploadWillStoreFileWithXHR(e){this.dispatch("before-storage-request",{xhr:e}),e.upload.addEventListener("progress",(t=>this.uploadRequestDidProgress(t)))}}const n5="input[type=file][data-direct-upload-url]:not([disabled])";class v2{constructor(e){this.form=e,this.inputs=J3(e,n5).filter((t=>t.files.length))}start(e){const t=this.createDirectUploadControllers(),i=()=>{const s=t.shift();s?s.start((r=>{r?(e(r),this.dispatch("end")):i()})):(e(),this.dispatch("end"))};this.dispatch("start"),i()}createDirectUploadControllers(){const e=[];return this.inputs.forEach((t=>{O2(t.files).forEach((i=>{const s=new b2(t,i);e.push(s)}))})),e}dispatch(e,t={}){return wy(this.form,`direct-uploads:${e}`,{detail:t})}}const jp="data-direct-uploads-processing",Qg=new WeakMap;let S1=!1;function _y(){S1||(S1=!0,document.addEventListener("click",s5,!0),document.addEventListener("submit",r5,!0),document.addEventListener("ajax:before",o5))}function s5(n){const e=n.target.closest("button, input");e&&e.type==="submit"&&e.form&&Qg.set(e.form,e)}function r5(n){S2(n)}function o5(n){n.target.tagName=="FORM"&&S2(n)}function S2(n){const e=n.target;if(e.hasAttribute(jp)){n.preventDefault();return}const t=new v2(e),{inputs:i}=t;i.length&&(n.preventDefault(),e.setAttribute(jp,""),i.forEach(l5),t.start((s=>{e.removeAttribute(jp),s?i.forEach(h5):a5(e)})))}function a5(n){let e=Qg.get(n)||g2(n,"input[type=submit], button[type=submit]");if(e){const{disabled:t}=e;e.disabled=!1,e.focus(),e.click(),e.disabled=t}else e=document.createElement("input"),e.type="submit",e.style.display="none",n.appendChild(e),e.click(),n.removeChild(e);Qg.delete(n)}function l5(n){n.disabled=!0}function h5(n){n.disabled=!1}function u5(){window.ActiveStorage&&_y()}setTimeout(u5,1);const c5=Object.freeze(Object.defineProperty({__proto__:null,DirectUpload:y2,DirectUploadController:b2,DirectUploadsController:v2,dispatchEvent:wy,start:_y},Symbol.toStringTag,{value:"Module"}));var Cd=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function bu(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}function d5(n){if(Object.prototype.hasOwnProperty.call(n,"__esModule"))return n;var e=n.default;if(typeof e=="function"){var t=function i(){var s=!1;try{s=this instanceof i}catch{}return s?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(n).forEach(function(i){var s=Object.getOwnPropertyDescriptor(n,i);Object.defineProperty(t,i,s.get?s:{enumerable:!0,get:function(){return n[i]}})}),t}var Xp,x1;function Bf(){if(x1)return Xp;x1=1;var n;return typeof window<"u"?n=window:typeof Cd<"u"?n=Cd:typeof self<"u"?n=self:n={},Xp=n,Xp}var f5=Bf();const V=bu(f5),p5={},m5=Object.freeze(Object.defineProperty({__proto__:null,default:p5},Symbol.toStringTag,{value:"Module"})),g5=d5(m5);var Hp,T1;function x2(){if(T1)return Hp;T1=1;var n=typeof Cd<"u"?Cd:typeof window<"u"?window:{},e=g5,t;return typeof document<"u"?t=document:(t=n["__GLOBAL_DOCUMENT_CACHE@4"],t||(t=n["__GLOBAL_DOCUMENT_CACHE@4"]=e)),Hp=t,Hp}var O5=x2();const he=bu(O5);var lc={exports:{}},Wp={exports:{}},w1;function y5(){return w1||(w1=1,(function(n){function e(){return n.exports=e=Object.assign?Object.assign.bind():function(t){for(var i=1;i<arguments.length;i++){var s=arguments[i];for(var r in s)({}).hasOwnProperty.call(s,r)&&(t[r]=s[r])}return t},n.exports.__esModule=!0,n.exports.default=n.exports,e.apply(null,arguments)}n.exports=e,n.exports.__esModule=!0,n.exports.default=n.exports})(Wp)),Wp.exports}var Zp,_1;function b5(){if(_1)return Zp;_1=1,Zp=e;var n=Object.prototype.toString;function e(t){if(!t)return!1;var i=n.call(t);return i==="[object Function]"||typeof t=="function"&&i!=="[object RegExp]"||typeof window<"u"&&(t===window.setTimeout||t===window.alert||t===window.confirm||t===window.prompt)}return Zp}var Yp,k1;function v5(){if(k1)return Yp;k1=1;function n(s,r){var o=typeof Symbol<"u"&&s[Symbol.iterator]||s["@@iterator"];if(o)return(o=o.call(s)).next.bind(o);if(Array.isArray(s)||(o=e(s))||r){o&&(s=o);var a=0;return function(){return a>=s.length?{done:!0}:{done:!1,value:s[a++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function e(s,r){if(s){if(typeof s=="string")return t(s,r);var o=Object.prototype.toString.call(s).slice(8,-1);if(o==="Object"&&s.constructor&&(o=s.constructor.name),o==="Map"||o==="Set")return Array.from(s);if(o==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o))return t(s,r)}}function t(s,r){(r==null||r>s.length)&&(r=s.length);for(var o=0,a=new Array(r);o<r;o++)a[o]=s[o];return a}var i=(function(){function s(){this.typeToInterceptorsMap_=new Map,this.enabled_=!1}var r=s.prototype;return r.getIsEnabled=function(){return this.enabled_},r.enable=function(){this.enabled_=!0},r.disable=function(){this.enabled_=!1},r.reset=function(){this.typeToInterceptorsMap_=new Map,this.enabled_=!1},r.addInterceptor=function(a,l){this.typeToInterceptorsMap_.has(a)||this.typeToInterceptorsMap_.set(a,new Set);var h=this.typeToInterceptorsMap_.get(a);return h.has(l)?!1:(h.add(l),!0)},r.removeInterceptor=function(a,l){var h=this.typeToInterceptorsMap_.get(a);return h&&h.has(l)?(h.delete(l),!0):!1},r.clearInterceptorsByType=function(a){var l=this.typeToInterceptorsMap_.get(a);return l?(this.typeToInterceptorsMap_.delete(a),this.typeToInterceptorsMap_.set(a,new Set),!0):!1},r.clear=function(){return this.typeToInterceptorsMap_.size?(this.typeToInterceptorsMap_=new Map,!0):!1},r.getForType=function(a){return this.typeToInterceptorsMap_.get(a)||new Set},r.execute=function(a,l){for(var h=this.getForType(a),u=n(h),c;!(c=u()).done;){var f=c.value;try{l=f(l)}catch{}}return l},s})();return Yp=i,Yp}var Gp,C1;function S5(){if(C1)return Gp;C1=1;var n=(function(){function t(){this.maxAttempts_=1,this.delayFactor_=.1,this.fuzzFactor_=.1,this.initialDelay_=1e3,this.enabled_=!1}var i=t.prototype;return i.getIsEnabled=function(){return this.enabled_},i.enable=function(){this.enabled_=!0},i.disable=function(){this.enabled_=!1},i.reset=function(){this.maxAttempts_=1,this.delayFactor_=.1,this.fuzzFactor_=.1,this.initialDelay_=1e3,this.enabled_=!1},i.getMaxAttempts=function(){return this.maxAttempts_},i.setMaxAttempts=function(r){this.maxAttempts_=r},i.getDelayFactor=function(){return this.delayFactor_},i.setDelayFactor=function(r){this.delayFactor_=r},i.getFuzzFactor=function(){return this.fuzzFactor_},i.setFuzzFactor=function(r){this.fuzzFactor_=r},i.getInitialDelay=function(){return this.initialDelay_},i.setInitialDelay=function(r){this.initialDelay_=r},i.createRetry=function(r){var o=r===void 0?{}:r,a=o.maxAttempts,l=o.delayFactor,h=o.fuzzFactor,u=o.initialDelay;return new e({maxAttempts:a||this.maxAttempts_,delayFactor:l||this.delayFactor_,fuzzFactor:h||this.fuzzFactor_,initialDelay:u||this.initialDelay_})},t})(),e=(function(){function t(s){this.maxAttempts_=s.maxAttempts,this.delayFactor_=s.delayFactor,this.fuzzFactor_=s.fuzzFactor,this.currentDelay_=s.initialDelay,this.currentAttempt_=1}var i=t.prototype;return i.moveToNextAttempt=function(){this.currentAttempt_++;var r=this.currentDelay_*this.delayFactor_;this.currentDelay_=this.currentDelay_+r},i.shouldRetry=function(){return this.currentAttempt_<this.maxAttempts_},i.getCurrentDelay=function(){return this.currentDelay_},i.getCurrentMinPossibleDelay=function(){return(1-this.fuzzFactor_)*this.currentDelay_},i.getCurrentMaxPossibleDelay=function(){return(1+this.fuzzFactor_)*this.currentDelay_},i.getCurrentFuzzedDelay=function(){var r=this.getCurrentMinPossibleDelay(),o=this.getCurrentMaxPossibleDelay();return r+Math.random()*(o-r)},t})();return Gp=n,Gp}var Kp,E1;function x5(){if(E1)return Kp;E1=1;var n=Bf(),e=function(s,r){return r===void 0&&(r=!1),function(o,a,l){if(o){s(o);return}if(a.statusCode>=400&&a.statusCode<=599){var h=l;if(r)if(n.TextDecoder){var u=t(a.headers&&a.headers["content-type"]);try{h=new TextDecoder(u).decode(l)}catch{}}else h=String.fromCharCode.apply(null,new Uint8Array(l));s({cause:h});return}s(null,l)}};function t(i){return i===void 0&&(i=""),i.toLowerCase().split(";").reduce(function(s,r){var o=r.split("="),a=o[0],l=o[1];return a.trim()==="charset"?l.trim():s},"utf-8")}return Kp=e,Kp}var A1;function T5(){if(A1)return lc.exports;A1=1;var n=Bf(),e=y5(),t=b5(),i=v5(),s=S5();h.httpHandler=x5(),h.requestInterceptorsStorage=new i,h.responseInterceptorsStorage=new i,h.retryManager=new s;/**
 * @license
 * slighly modified parse-headers 2.0.2 <https://github.com/kesla/parse-headers/>
 * Copyright (c) 2014 David Björklund
 * Available under the MIT license
 * <https://github.com/kesla/parse-headers/blob/master/LICENCE>
 */var r=function(b){var y={};return b&&b.trim().split(`
`).forEach(function(_){var T=_.indexOf(":"),w=_.slice(0,T).trim().toLowerCase(),v=_.slice(T+1).trim();typeof y[w]>"u"?y[w]=v:Array.isArray(y[w])?y[w].push(v):y[w]=[y[w],v]}),y};lc.exports=h,lc.exports.default=h,h.XMLHttpRequest=n.XMLHttpRequest||f,h.XDomainRequest="withCredentials"in new h.XMLHttpRequest?h.XMLHttpRequest:n.XDomainRequest,o(["get","put","post","patch","head","delete"],function(p){h[p==="delete"?"del":p]=function(b,y,_){return y=l(b,y,_),y.method=p.toUpperCase(),u(y)}});function o(p,b){for(var y=0;y<p.length;y++)b(p[y])}function a(p){for(var b in p)if(p.hasOwnProperty(b))return!1;return!0}function l(p,b,y){var _=p;return t(b)?(y=b,typeof p=="string"&&(_={uri:p})):_=e({},b,{uri:p}),_.callback=y,_}function h(p,b,y){return b=l(p,b,y),u(b)}function u(p){if(typeof p.callback>"u")throw new Error("callback argument missing");if(p.requestType&&h.requestInterceptorsStorage.getIsEnabled()){var b={uri:p.uri||p.url,headers:p.headers||{},body:p.body,metadata:p.metadata||{},retry:p.retry,timeout:p.timeout},y=h.requestInterceptorsStorage.execute(p.requestType,b);p.uri=y.uri,p.headers=y.headers,p.body=y.body,p.metadata=y.metadata,p.retry=y.retry,p.timeout=y.timeout}var _=!1,T=function(ee,te,re){_||(_=!0,p.callback(ee,te,re))};function w(){A.readyState===4&&!h.responseInterceptorsStorage.getIsEnabled()&&setTimeout(k,0)}function v(){var G=void 0;if(A.response?G=A.response:G=A.responseText||c(A),Z)try{G=JSON.parse(G)}catch{}return G}function S(G){if(clearTimeout(K),clearTimeout(p.retryTimeout),G instanceof Error||(G=new Error(""+(G||"Unknown XMLHttpRequest Error"))),G.statusCode=0,!B&&h.retryManager.getIsEnabled()&&p.retry&&p.retry.shouldRetry()){p.retryTimeout=setTimeout(function(){p.retry.moveToNextAttempt(),p.xhr=A,u(p)},p.retry.getCurrentFuzzedDelay());return}if(p.requestType&&h.responseInterceptorsStorage.getIsEnabled()){var ee={headers:oe.headers||{},body:oe.body,responseUrl:A.responseURL,responseType:A.responseType},te=h.responseInterceptorsStorage.execute(p.requestType,ee);oe.body=te.body,oe.headers=te.headers}return T(G,oe)}function k(){if(!B){var G;clearTimeout(K),clearTimeout(p.retryTimeout),p.useXDR&&A.status===void 0?G=200:G=A.status===1223?204:A.status;var ee=oe,te=null;if(G!==0?(ee={body:v(),statusCode:G,method:R,headers:{},url:P,rawRequest:A},A.getAllResponseHeaders&&(ee.headers=r(A.getAllResponseHeaders()))):te=new Error("Internal XMLHttpRequest Error"),p.requestType&&h.responseInterceptorsStorage.getIsEnabled()){var re={headers:ee.headers||{},body:ee.body,responseUrl:A.responseURL,responseType:A.responseType},ne=h.responseInterceptorsStorage.execute(p.requestType,re);ee.body=ne.body,ee.headers=ne.headers}return T(te,ee,ee.body)}}var A=p.xhr||null;A||(p.cors||p.useXDR?A=new h.XDomainRequest:A=new h.XMLHttpRequest);var M,B,P=A.url=p.uri||p.url,R=A.method=p.method||"GET",q=p.body||p.data,z=A.headers=p.headers||{},X=!!p.sync,Z=!1,K,oe={body:void 0,headers:{},statusCode:0,method:R,url:P,rawRequest:A};if("json"in p&&p.json!==!1&&(Z=!0,z.accept||z.Accept||(z.Accept="application/json"),R!=="GET"&&R!=="HEAD"&&(z["content-type"]||z["Content-Type"]||(z["Content-Type"]="application/json"),q=JSON.stringify(p.json===!0?q:p.json))),A.onreadystatechange=w,A.onload=k,A.onerror=S,A.onprogress=function(){},A.onabort=function(){B=!0,clearTimeout(p.retryTimeout)},A.ontimeout=S,A.open(R,P,!X,p.username,p.password),X||(A.withCredentials=!!p.withCredentials),!X&&p.timeout>0&&(K=setTimeout(function(){if(!B){B=!0,A.abort("timeout");var G=new Error("XMLHttpRequest timeout");G.code="ETIMEDOUT",S(G)}},p.timeout)),A.setRequestHeader)for(M in z)z.hasOwnProperty(M)&&A.setRequestHeader(M,z[M]);else if(p.headers&&!a(p.headers))throw new Error("Headers cannot be set on an XDomainRequest object");return"responseType"in p&&(A.responseType=p.responseType),"beforeSend"in p&&typeof p.beforeSend=="function"&&p.beforeSend(A),A.send(q||null),A}function c(p){try{if(p.responseType==="document")return p.responseXML;var b=p.responseXML&&p.responseXML.documentElement.nodeName==="parsererror";if(p.responseType===""&&!b)return p.responseXML}catch{}return null}function f(){}return lc.exports}var w5=T5();const T2=bu(w5);var Jp={exports:{}},em,P1;function _5(){if(P1)return em;P1=1;var n=x2(),e=Object.create||(function(){function P(){}return function(R){if(arguments.length!==1)throw new Error("Object.create shim only accepts one parameter.");return P.prototype=R,new P}})();function t(P,R){this.name="ParsingError",this.code=P.code,this.message=R||P.message}t.prototype=e(Error.prototype),t.prototype.constructor=t,t.Errors={BadSignature:{code:0,message:"Malformed WebVTT signature."},BadTimeStamp:{code:1,message:"Malformed time stamp."}};function i(P){function R(z,X,Z,K){return(z|0)*3600+(X|0)*60+(Z|0)+(K|0)/1e3}var q=P.match(/^(\d+):(\d{1,2})(:\d{1,2})?\.(\d{3})/);return q?q[3]?R(q[1],q[2],q[3].replace(":",""),q[4]):q[1]>59?R(q[1],q[2],0,q[4]):R(0,q[1],q[2],q[4]):null}function s(){this.values=e(null)}s.prototype={set:function(P,R){!this.get(P)&&R!==""&&(this.values[P]=R)},get:function(P,R,q){return q?this.has(P)?this.values[P]:R[q]:this.has(P)?this.values[P]:R},has:function(P){return P in this.values},alt:function(P,R,q){for(var z=0;z<q.length;++z)if(R===q[z]){this.set(P,R);break}},integer:function(P,R){/^-?\d+$/.test(R)&&this.set(P,parseInt(R,10))},percent:function(P,R){return R.match(/^([\d]{1,3})(\.[\d]*)?%$/)&&(R=parseFloat(R),R>=0&&R<=100)?(this.set(P,R),!0):!1}};function r(P,R,q,z){var X=z?P.split(z):[P];for(var Z in X)if(typeof X[Z]=="string"){var K=X[Z].split(q);if(K.length===2){var oe=K[0].trim(),G=K[1].trim();R(oe,G)}}}function o(P,R,q){var z=P;function X(){var oe=i(P);if(oe===null)throw new t(t.Errors.BadTimeStamp,"Malformed timestamp: "+z);return P=P.replace(/^[^\sa-zA-Z-]+/,""),oe}function Z(oe,G){var ee=new s;r(oe,function(te,re){switch(te){case"region":for(var ne=q.length-1;ne>=0;ne--)if(q[ne].id===re){ee.set(te,q[ne].region);break}break;case"vertical":ee.alt(te,re,["rl","lr"]);break;case"line":var ve=re.split(","),xe=ve[0];ee.integer(te,xe),ee.percent(te,xe)&&ee.set("snapToLines",!1),ee.alt(te,xe,["auto"]),ve.length===2&&ee.alt("lineAlign",ve[1],["start","center","end"]);break;case"position":ve=re.split(","),ee.percent(te,ve[0]),ve.length===2&&ee.alt("positionAlign",ve[1],["start","center","end"]);break;case"size":ee.percent(te,re);break;case"align":ee.alt(te,re,["start","center","end","left","right"]);break}},/:/,/\s/),G.region=ee.get("region",null),G.vertical=ee.get("vertical","");try{G.line=ee.get("line","auto")}catch{}G.lineAlign=ee.get("lineAlign","start"),G.snapToLines=ee.get("snapToLines",!0),G.size=ee.get("size",100);try{G.align=ee.get("align","center")}catch{G.align=ee.get("align","middle")}try{G.position=ee.get("position","auto")}catch{G.position=ee.get("position",{start:0,left:0,center:50,middle:50,end:100,right:100},G.align)}G.positionAlign=ee.get("positionAlign",{start:"start",left:"start",center:"center",middle:"center",end:"end",right:"end"},G.align)}function K(){P=P.replace(/^\s+/,"")}if(K(),R.startTime=X(),K(),P.substr(0,3)!=="-->")throw new t(t.Errors.BadTimeStamp,"Malformed time stamp (time stamps must be separated by '-->'): "+z);P=P.substr(3),K(),R.endTime=X(),K(),Z(P,R)}var a=n.createElement&&n.createElement("textarea"),l={c:"span",i:"i",b:"b",u:"u",ruby:"ruby",rt:"rt",v:"span",lang:"span"},h={white:"rgba(255,255,255,1)",lime:"rgba(0,255,0,1)",cyan:"rgba(0,255,255,1)",red:"rgba(255,0,0,1)",yellow:"rgba(255,255,0,1)",magenta:"rgba(255,0,255,1)",blue:"rgba(0,0,255,1)",black:"rgba(0,0,0,1)"},u={v:"title",lang:"lang"},c={rt:"ruby"};function f(P,R){function q(){if(!R)return null;function xe(Se){return R=R.substr(Se.length),Se}var Pe=R.match(/^([^<]*)(<[^>]*>?)?/);return xe(Pe[1]?Pe[1]:Pe[2])}function z(xe){return a.innerHTML=xe,xe=a.textContent,a.textContent="",xe}function X(xe,Pe){return!c[Pe.localName]||c[Pe.localName]===xe.localName}function Z(xe,Pe){var Se=l[xe];if(!Se)return null;var ct=P.document.createElement(Se),vt=u[xe];return vt&&Pe&&(ct[vt]=Pe.trim()),ct}for(var K=P.document.createElement("div"),oe=K,G,ee=[];(G=q())!==null;){if(G[0]==="<"){if(G[1]==="/"){ee.length&&ee[ee.length-1]===G.substr(2).replace(">","")&&(ee.pop(),oe=oe.parentNode);continue}var te=i(G.substr(1,G.length-2)),re;if(te){re=P.document.createProcessingInstruction("timestamp",te),oe.appendChild(re);continue}var ne=G.match(/^<([^.\s/0-9>]+)(\.[^\s\\>]+)?([^>\\]+)?(\\?)>?$/);if(!ne||(re=Z(ne[1],ne[3]),!re)||!X(oe,re))continue;if(ne[2]){var ve=ne[2].split(".");ve.forEach(function(xe){var Pe=/^bg_/.test(xe),Se=Pe?xe.slice(3):xe;if(h.hasOwnProperty(Se)){var ct=Pe?"background-color":"color",vt=h[Se];re.style[ct]=vt}}),re.className=ve.join(" ")}ee.push(ne[1]),oe.appendChild(re),oe=re;continue}oe.appendChild(P.document.createTextNode(z(G)))}return K}var p=[[1470,1470],[1472,1472],[1475,1475],[1478,1478],[1488,1514],[1520,1524],[1544,1544],[1547,1547],[1549,1549],[1563,1563],[1566,1610],[1645,1647],[1649,1749],[1765,1766],[1774,1775],[1786,1805],[1807,1808],[1810,1839],[1869,1957],[1969,1969],[1984,2026],[2036,2037],[2042,2042],[2048,2069],[2074,2074],[2084,2084],[2088,2088],[2096,2110],[2112,2136],[2142,2142],[2208,2208],[2210,2220],[8207,8207],[64285,64285],[64287,64296],[64298,64310],[64312,64316],[64318,64318],[64320,64321],[64323,64324],[64326,64449],[64467,64829],[64848,64911],[64914,64967],[65008,65020],[65136,65140],[65142,65276],[67584,67589],[67592,67592],[67594,67637],[67639,67640],[67644,67644],[67647,67669],[67671,67679],[67840,67867],[67872,67897],[67903,67903],[67968,68023],[68030,68031],[68096,68096],[68112,68115],[68117,68119],[68121,68147],[68160,68167],[68176,68184],[68192,68223],[68352,68405],[68416,68437],[68440,68466],[68472,68479],[68608,68680],[126464,126467],[126469,126495],[126497,126498],[126500,126500],[126503,126503],[126505,126514],[126516,126519],[126521,126521],[126523,126523],[126530,126530],[126535,126535],[126537,126537],[126539,126539],[126541,126543],[126545,126546],[126548,126548],[126551,126551],[126553,126553],[126555,126555],[126557,126557],[126559,126559],[126561,126562],[126564,126564],[126567,126570],[126572,126578],[126580,126583],[126585,126588],[126590,126590],[126592,126601],[126603,126619],[126625,126627],[126629,126633],[126635,126651],[1114109,1114109]];function b(P){for(var R=0;R<p.length;R++){var q=p[R];if(P>=q[0]&&P<=q[1])return!0}return!1}function y(P){var R=[],q="",z;if(!P||!P.childNodes)return"ltr";function X(oe,G){for(var ee=G.childNodes.length-1;ee>=0;ee--)oe.push(G.childNodes[ee])}function Z(oe){if(!oe||!oe.length)return null;var G=oe.pop(),ee=G.textContent||G.innerText;if(ee){var te=ee.match(/^.*(\n|\r)/);return te?(oe.length=0,te[0]):ee}if(G.tagName==="ruby")return Z(oe);if(G.childNodes)return X(oe,G),Z(oe)}for(X(R,P);q=Z(R);)for(var K=0;K<q.length;K++)if(z=q.charCodeAt(K),b(z))return"rtl";return"ltr"}function _(P){if(typeof P.line=="number"&&(P.snapToLines||P.line>=0&&P.line<=100))return P.line;if(!P.track||!P.track.textTrackList||!P.track.textTrackList.mediaElement)return-1;for(var R=P.track,q=R.textTrackList,z=0,X=0;X<q.length&&q[X]!==R;X++)q[X].mode==="showing"&&z++;return++z*-1}function T(){}T.prototype.applyStyles=function(P,R){R=R||this.div;for(var q in P)P.hasOwnProperty(q)&&(R.style[q]=P[q])},T.prototype.formatStyle=function(P,R){return P===0?0:P+R};function w(P,R,q){T.call(this),this.cue=R,this.cueDiv=f(P,R.text);var z={color:"rgba(255, 255, 255, 1)",backgroundColor:"rgba(0, 0, 0, 0.8)",position:"relative",left:0,right:0,top:0,bottom:0,display:"inline",writingMode:R.vertical===""?"horizontal-tb":R.vertical==="lr"?"vertical-lr":"vertical-rl",unicodeBidi:"plaintext"};this.applyStyles(z,this.cueDiv),this.div=P.document.createElement("div"),z={direction:y(this.cueDiv),writingMode:R.vertical===""?"horizontal-tb":R.vertical==="lr"?"vertical-lr":"vertical-rl",unicodeBidi:"plaintext",textAlign:R.align==="middle"?"center":R.align,font:q.font,whiteSpace:"pre-line",position:"absolute"},this.applyStyles(z),this.div.appendChild(this.cueDiv);var X=0;switch(R.positionAlign){case"start":case"line-left":X=R.position;break;case"center":X=R.position-R.size/2;break;case"end":case"line-right":X=R.position-R.size;break}R.vertical===""?this.applyStyles({left:this.formatStyle(X,"%"),width:this.formatStyle(R.size,"%")}):this.applyStyles({top:this.formatStyle(X,"%"),height:this.formatStyle(R.size,"%")}),this.move=function(Z){this.applyStyles({top:this.formatStyle(Z.top,"px"),bottom:this.formatStyle(Z.bottom,"px"),left:this.formatStyle(Z.left,"px"),right:this.formatStyle(Z.right,"px"),height:this.formatStyle(Z.height,"px"),width:this.formatStyle(Z.width,"px")})}}w.prototype=e(T.prototype),w.prototype.constructor=w;function v(P){var R,q,z,X;if(P.div){q=P.div.offsetHeight,z=P.div.offsetWidth,X=P.div.offsetTop;var Z=(Z=P.div.childNodes)&&(Z=Z[0])&&Z.getClientRects&&Z.getClientRects();P=P.div.getBoundingClientRect(),R=Z?Math.max(Z[0]&&Z[0].height||0,P.height/Z.length):0}this.left=P.left,this.right=P.right,this.top=P.top||X,this.height=P.height||q,this.bottom=P.bottom||X+(P.height||q),this.width=P.width||z,this.lineHeight=R!==void 0?R:P.lineHeight}v.prototype.move=function(P,R){switch(R=R!==void 0?R:this.lineHeight,P){case"+x":this.left+=R,this.right+=R;break;case"-x":this.left-=R,this.right-=R;break;case"+y":this.top+=R,this.bottom+=R;break;case"-y":this.top-=R,this.bottom-=R;break}},v.prototype.overlaps=function(P){return this.left<P.right&&this.right>P.left&&this.top<P.bottom&&this.bottom>P.top},v.prototype.overlapsAny=function(P){for(var R=0;R<P.length;R++)if(this.overlaps(P[R]))return!0;return!1},v.prototype.within=function(P){return this.top>=P.top&&this.bottom<=P.bottom&&this.left>=P.left&&this.right<=P.right},v.prototype.overlapsOppositeAxis=function(P,R){switch(R){case"+x":return this.left<P.left;case"-x":return this.right>P.right;case"+y":return this.top<P.top;case"-y":return this.bottom>P.bottom}},v.prototype.intersectPercentage=function(P){var R=Math.max(0,Math.min(this.right,P.right)-Math.max(this.left,P.left)),q=Math.max(0,Math.min(this.bottom,P.bottom)-Math.max(this.top,P.top)),z=R*q;return z/(this.height*this.width)},v.prototype.toCSSCompatValues=function(P){return{top:this.top-P.top,bottom:P.bottom-this.bottom,left:this.left-P.left,right:P.right-this.right,height:this.height,width:this.width}},v.getSimpleBoxPosition=function(P){var R=P.div?P.div.offsetHeight:P.tagName?P.offsetHeight:0,q=P.div?P.div.offsetWidth:P.tagName?P.offsetWidth:0,z=P.div?P.div.offsetTop:P.tagName?P.offsetTop:0;P=P.div?P.div.getBoundingClientRect():P.tagName?P.getBoundingClientRect():P;var X={left:P.left,right:P.right,top:P.top||z,height:P.height||R,bottom:P.bottom||z+(P.height||R),width:P.width||q};return X};function S(P,R,q,z){function X(Se,ct){for(var vt,rt=new v(Se),It=1,Bi=0;Bi<ct.length;Bi++){for(;Se.overlapsOppositeAxis(q,ct[Bi])||Se.within(q)&&Se.overlapsAny(z);)Se.move(ct[Bi]);if(Se.within(q))return Se;var Vt=Se.intersectPercentage(q);It>Vt&&(vt=new v(Se),It=Vt),Se=new v(rt)}return vt||rt}var Z=new v(R),K=R.cue,oe=_(K),G=[];if(K.snapToLines){var ee;switch(K.vertical){case"":G=["+y","-y"],ee="height";break;case"rl":G=["+x","-x"],ee="width";break;case"lr":G=["-x","+x"],ee="width";break}var te=Z.lineHeight,re=te*Math.round(oe),ne=q[ee]+te,ve=G[0];Math.abs(re)>ne&&(re=re<0?-1:1,re*=Math.ceil(ne/te)*te),oe<0&&(re+=K.vertical===""?q.height:q.width,G=G.reverse()),Z.move(ve,re)}else{var xe=Z.lineHeight/q.height*100;switch(K.lineAlign){case"center":oe-=xe/2;break;case"end":oe-=xe;break}switch(K.vertical){case"":R.applyStyles({top:R.formatStyle(oe,"%")});break;case"rl":R.applyStyles({left:R.formatStyle(oe,"%")});break;case"lr":R.applyStyles({right:R.formatStyle(oe,"%")});break}G=["+y","-x","+x","-y"],Z=new v(R)}var Pe=X(Z,G);R.move(Pe.toCSSCompatValues(q))}function k(){}k.StringDecoder=function(){return{decode:function(P){if(!P)return"";if(typeof P!="string")throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(P))}}},k.convertCueToDOMTree=function(P,R){return!P||!R?null:f(P,R)};var A=.05,M="sans-serif",B="1.5%";return k.processCues=function(P,R,q){if(!P||!R||!q)return null;for(;q.firstChild;)q.removeChild(q.firstChild);var z=P.document.createElement("div");z.style.position="absolute",z.style.left="0",z.style.right="0",z.style.top="0",z.style.bottom="0",z.style.margin=B,q.appendChild(z);function X(te){for(var re=0;re<te.length;re++)if(te[re].hasBeenReset||!te[re].displayState)return!0;return!1}if(!X(R)){for(var Z=0;Z<R.length;Z++)z.appendChild(R[Z].displayState);return}var K=[],oe=v.getSimpleBoxPosition(z),G=Math.round(oe.height*A*100)/100,ee={font:G+"px "+M};(function(){for(var te,re,ne=0;ne<R.length;ne++)re=R[ne],te=new w(P,re,ee),z.appendChild(te.div),S(P,te,oe,K),re.displayState=te.div,K.push(v.getSimpleBoxPosition(te))})()},k.Parser=function(P,R,q){q||(q=R,R={}),R||(R={}),this.window=P,this.vttjs=R,this.state="INITIAL",this.buffer="",this.decoder=q||new TextDecoder("utf8"),this.regionList=[]},k.Parser.prototype={reportOrThrowError:function(P){if(P instanceof t)this.onparsingerror&&this.onparsingerror(P);else throw P},parse:function(P){var R=this;P&&(R.buffer+=R.decoder.decode(P,{stream:!0}));function q(){for(var te=R.buffer,re=0;re<te.length&&te[re]!=="\r"&&te[re]!==`
`;)++re;var ne=te.substr(0,re);return te[re]==="\r"&&++re,te[re]===`
`&&++re,R.buffer=te.substr(re),ne}function z(te){var re=new s;if(r(te,function(ve,xe){switch(ve){case"id":re.set(ve,xe);break;case"width":re.percent(ve,xe);break;case"lines":re.integer(ve,xe);break;case"regionanchor":case"viewportanchor":var Pe=xe.split(",");if(Pe.length!==2)break;var Se=new s;if(Se.percent("x",Pe[0]),Se.percent("y",Pe[1]),!Se.has("x")||!Se.has("y"))break;re.set(ve+"X",Se.get("x")),re.set(ve+"Y",Se.get("y"));break;case"scroll":re.alt(ve,xe,["up"]);break}},/=/,/\s/),re.has("id")){var ne=new(R.vttjs.VTTRegion||R.window.VTTRegion);ne.width=re.get("width",100),ne.lines=re.get("lines",3),ne.regionAnchorX=re.get("regionanchorX",0),ne.regionAnchorY=re.get("regionanchorY",100),ne.viewportAnchorX=re.get("viewportanchorX",0),ne.viewportAnchorY=re.get("viewportanchorY",100),ne.scroll=re.get("scroll",""),R.onregion&&R.onregion(ne),R.regionList.push({id:re.get("id"),region:ne})}}function X(te){var re=new s;r(te,function(ne,ve){switch(ne){case"MPEGT":re.integer(ne+"S",ve);break;case"LOCA":re.set(ne+"L",i(ve));break}},/[^\d]:/,/,/),R.ontimestampmap&&R.ontimestampmap({MPEGTS:re.get("MPEGTS"),LOCAL:re.get("LOCAL")})}function Z(te){te.match(/X-TIMESTAMP-MAP/)?r(te,function(re,ne){switch(re){case"X-TIMESTAMP-MAP":X(ne);break}},/=/):r(te,function(re,ne){switch(re){case"Region":z(ne);break}},/:/)}try{var K;if(R.state==="INITIAL"){if(!/\r\n|\n/.test(R.buffer))return this;K=q();var oe=K.match(/^WEBVTT([ \t].*)?$/);if(!oe||!oe[0])throw new t(t.Errors.BadSignature);R.state="HEADER"}for(var G=!1;R.buffer;){if(!/\r\n|\n/.test(R.buffer))return this;switch(G?G=!1:K=q(),R.state){case"HEADER":/:/.test(K)?Z(K):K||(R.state="ID");continue;case"NOTE":K||(R.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(K)){R.state="NOTE";break}if(!K)continue;R.cue=new(R.vttjs.VTTCue||R.window.VTTCue)(0,0,"");try{R.cue.align="center"}catch{R.cue.align="middle"}if(R.state="CUE",K.indexOf("-->")===-1){R.cue.id=K;continue}case"CUE":try{o(K,R.cue,R.regionList)}catch(te){R.reportOrThrowError(te),R.cue=null,R.state="BADCUE";continue}R.state="CUETEXT";continue;case"CUETEXT":var ee=K.indexOf("-->")!==-1;if(!K||ee&&(G=!0)){R.oncue&&R.oncue(R.cue),R.cue=null,R.state="ID";continue}R.cue.text&&(R.cue.text+=`
`),R.cue.text+=K.replace(/\u2028/g,`
`).replace(/u2029/g,`
`);continue;case"BADCUE":K||(R.state="ID");continue}}}catch(te){R.reportOrThrowError(te),R.state==="CUETEXT"&&R.cue&&R.oncue&&R.oncue(R.cue),R.cue=null,R.state=R.state==="INITIAL"?"BADWEBVTT":"BADCUE"}return this},flush:function(){var P=this;try{if(P.buffer+=P.decoder.decode(),(P.cue||P.state==="HEADER")&&(P.buffer+=`

`,P.parse()),P.state==="INITIAL")throw new t(t.Errors.BadSignature)}catch(R){P.reportOrThrowError(R)}return P.onflush&&P.onflush(),this}},em=k,em}var tm,D1;function k5(){if(D1)return tm;D1=1;var n="auto",e={"":1,lr:1,rl:1},t={start:1,center:1,end:1,left:1,right:1,auto:1,"line-left":1,"line-right":1};function i(o){if(typeof o!="string")return!1;var a=e[o.toLowerCase()];return a?o.toLowerCase():!1}function s(o){if(typeof o!="string")return!1;var a=t[o.toLowerCase()];return a?o.toLowerCase():!1}function r(o,a,l){this.hasBeenReset=!1;var h="",u=!1,c=o,f=a,p=l,b=null,y="",_=!0,T="auto",w="start",v="auto",S="auto",k=100,A="center";Object.defineProperties(this,{id:{enumerable:!0,get:function(){return h},set:function(M){h=""+M}},pauseOnExit:{enumerable:!0,get:function(){return u},set:function(M){u=!!M}},startTime:{enumerable:!0,get:function(){return c},set:function(M){if(typeof M!="number")throw new TypeError("Start time must be set to a number.");c=M,this.hasBeenReset=!0}},endTime:{enumerable:!0,get:function(){return f},set:function(M){if(typeof M!="number")throw new TypeError("End time must be set to a number.");f=M,this.hasBeenReset=!0}},text:{enumerable:!0,get:function(){return p},set:function(M){p=""+M,this.hasBeenReset=!0}},region:{enumerable:!0,get:function(){return b},set:function(M){b=M,this.hasBeenReset=!0}},vertical:{enumerable:!0,get:function(){return y},set:function(M){var B=i(M);if(B===!1)throw new SyntaxError("Vertical: an invalid or illegal direction string was specified.");y=B,this.hasBeenReset=!0}},snapToLines:{enumerable:!0,get:function(){return _},set:function(M){_=!!M,this.hasBeenReset=!0}},line:{enumerable:!0,get:function(){return T},set:function(M){if(typeof M!="number"&&M!==n)throw new SyntaxError("Line: an invalid number or illegal string was specified.");T=M,this.hasBeenReset=!0}},lineAlign:{enumerable:!0,get:function(){return w},set:function(M){var B=s(M);B?(w=B,this.hasBeenReset=!0):console.warn("lineAlign: an invalid or illegal string was specified.")}},position:{enumerable:!0,get:function(){return v},set:function(M){if(M<0||M>100)throw new Error("Position must be between 0 and 100.");v=M,this.hasBeenReset=!0}},positionAlign:{enumerable:!0,get:function(){return S},set:function(M){var B=s(M);B?(S=B,this.hasBeenReset=!0):console.warn("positionAlign: an invalid or illegal string was specified.")}},size:{enumerable:!0,get:function(){return k},set:function(M){if(M<0||M>100)throw new Error("Size must be between 0 and 100.");k=M,this.hasBeenReset=!0}},align:{enumerable:!0,get:function(){return A},set:function(M){var B=s(M);if(!B)throw new SyntaxError("align: an invalid or illegal alignment string was specified.");A=B,this.hasBeenReset=!0}}}),this.displayState=void 0}return r.prototype.getCueAsHTML=function(){return WebVTT.convertCueToDOMTree(window,this.text)},tm=r,tm}var im,M1;function C5(){if(M1)return im;M1=1;var n={"":!0,up:!0};function e(s){if(typeof s!="string")return!1;var r=n[s.toLowerCase()];return r?s.toLowerCase():!1}function t(s){return typeof s=="number"&&s>=0&&s<=100}function i(){var s=100,r=3,o=0,a=100,l=0,h=100,u="";Object.defineProperties(this,{width:{enumerable:!0,get:function(){return s},set:function(c){if(!t(c))throw new Error("Width must be between 0 and 100.");s=c}},lines:{enumerable:!0,get:function(){return r},set:function(c){if(typeof c!="number")throw new TypeError("Lines must be set to a number.");r=c}},regionAnchorY:{enumerable:!0,get:function(){return a},set:function(c){if(!t(c))throw new Error("RegionAnchorX must be between 0 and 100.");a=c}},regionAnchorX:{enumerable:!0,get:function(){return o},set:function(c){if(!t(c))throw new Error("RegionAnchorY must be between 0 and 100.");o=c}},viewportAnchorY:{enumerable:!0,get:function(){return h},set:function(c){if(!t(c))throw new Error("ViewportAnchorY must be between 0 and 100.");h=c}},viewportAnchorX:{enumerable:!0,get:function(){return l},set:function(c){if(!t(c))throw new Error("ViewportAnchorX must be between 0 and 100.");l=c}},scroll:{enumerable:!0,get:function(){return u},set:function(c){var f=e(c);f===!1?console.warn("Scroll: an invalid or illegal string was specified."):u=f}}})}return im=i,im}var I1;function E5(){if(I1)return Jp.exports;I1=1;var n=Bf(),e=Jp.exports={WebVTT:_5(),VTTCue:k5(),VTTRegion:C5()};n.vttjs=e,n.WebVTT=e.WebVTT;var t=e.VTTCue,i=e.VTTRegion,s=n.VTTCue,r=n.VTTRegion;return e.shim=function(){n.VTTCue=t,n.VTTRegion=i},e.restore=function(){n.VTTCue=s,n.VTTRegion=r},n.VTTCue||e.shim(),Jp.exports}var A5=E5();const R1=bu(A5);function Nt(){return Nt=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var i in t)({}).hasOwnProperty.call(t,i)&&(n[i]=t[i])}return n},Nt.apply(null,arguments)}var L1="https://example.com",Nf=function(e,t){if(/^[a-z]+:/i.test(t))return t;/^data:/.test(e)&&(e=V.location&&V.location.href||"");var i=/^\/\//.test(e),s=!V.location&&!/\/\//i.test(e);e=new V.URL(e,V.location||L1);var r=new URL(t,e);return s?r.href.slice(L1.length):i?r.href.slice(r.protocol.length):r.href},ky=(function(){function n(){this.listeners={}}var e=n.prototype;return e.on=function(i,s){this.listeners[i]||(this.listeners[i]=[]),this.listeners[i].push(s)},e.off=function(i,s){if(!this.listeners[i])return!1;var r=this.listeners[i].indexOf(s);return this.listeners[i]=this.listeners[i].slice(0),this.listeners[i].splice(r,1),r>-1},e.trigger=function(i){var s=this.listeners[i];if(s)if(arguments.length===2)for(var r=s.length,o=0;o<r;++o)s[o].call(this,arguments[1]);else for(var a=Array.prototype.slice.call(arguments,1),l=s.length,h=0;h<l;++h)s[h].apply(this,a)},e.dispose=function(){this.listeners={}},e.pipe=function(i){this.on("data",function(s){i.push(s)})},n})(),P5=function(e){return V.atob?V.atob(e):Buffer.from(e,"base64").toString("binary")};function w2(n){for(var e=P5(n),t=new Uint8Array(e.length),i=0;i<e.length;i++)t[i]=e.charCodeAt(i);return t}/*! @name m3u8-parser @version 7.2.0 @license Apache-2.0 */class D5 extends ky{constructor(){super(),this.buffer=""}push(e){let t;for(this.buffer+=e,t=this.buffer.indexOf(`
`);t>-1;t=this.buffer.indexOf(`
`))this.trigger("data",this.buffer.substring(0,t)),this.buffer=this.buffer.substring(t+1)}}const M5="	",nm=function(n){const e=/([0-9.]*)?@?([0-9.]*)?/.exec(n||""),t={};return e[1]&&(t.length=parseInt(e[1],10)),e[2]&&(t.offset=parseInt(e[2],10)),t},I5=function(){const t="(?:"+"[^=]*"+")=(?:"+'"[^"]*"|[^,]*'+")";return new RegExp("(?:^|,)("+t+")")},ki=function(n){const e={};if(!n)return e;const t=n.split(I5());let i=t.length,s;for(;i--;)t[i]!==""&&(s=/([^=]*)=(.*)/.exec(t[i]).slice(1),s[0]=s[0].replace(/^\s+|\s+$/g,""),s[1]=s[1].replace(/^\s+|\s+$/g,""),s[1]=s[1].replace(/^['"](.*)['"]$/g,"$1"),e[s[0]]=s[1]);return e},$1=n=>{const e=n.split("x"),t={};return e[0]&&(t.width=parseInt(e[0],10)),e[1]&&(t.height=parseInt(e[1],10)),t};class R5 extends ky{constructor(){super(),this.customParsers=[],this.tagMappers=[]}push(e){let t,i;if(e=e.trim(),e.length===0)return;if(e[0]!=="#"){this.trigger("data",{type:"uri",uri:e});return}this.tagMappers.reduce((r,o)=>{const a=o(e);return a===e?r:r.concat([a])},[e]).forEach(r=>{for(let o=0;o<this.customParsers.length;o++)if(this.customParsers[o].call(this,r))return;if(r.indexOf("#EXT")!==0){this.trigger("data",{type:"comment",text:r.slice(1)});return}if(r=r.replace("\r",""),t=/^#EXTM3U/.exec(r),t){this.trigger("data",{type:"tag",tagType:"m3u"});return}if(t=/^#EXTINF:([0-9\.]*)?,?(.*)?$/.exec(r),t){i={type:"tag",tagType:"inf"},t[1]&&(i.duration=parseFloat(t[1])),t[2]&&(i.title=t[2]),this.trigger("data",i);return}if(t=/^#EXT-X-TARGETDURATION:([0-9.]*)?/.exec(r),t){i={type:"tag",tagType:"targetduration"},t[1]&&(i.duration=parseInt(t[1],10)),this.trigger("data",i);return}if(t=/^#EXT-X-VERSION:([0-9.]*)?/.exec(r),t){i={type:"tag",tagType:"version"},t[1]&&(i.version=parseInt(t[1],10)),this.trigger("data",i);return}if(t=/^#EXT-X-MEDIA-SEQUENCE:(\-?[0-9.]*)?/.exec(r),t){i={type:"tag",tagType:"media-sequence"},t[1]&&(i.number=parseInt(t[1],10)),this.trigger("data",i);return}if(t=/^#EXT-X-DISCONTINUITY-SEQUENCE:(\-?[0-9.]*)?/.exec(r),t){i={type:"tag",tagType:"discontinuity-sequence"},t[1]&&(i.number=parseInt(t[1],10)),this.trigger("data",i);return}if(t=/^#EXT-X-PLAYLIST-TYPE:(.*)?$/.exec(r),t){i={type:"tag",tagType:"playlist-type"},t[1]&&(i.playlistType=t[1]),this.trigger("data",i);return}if(t=/^#EXT-X-BYTERANGE:(.*)?$/.exec(r),t){i=Nt(nm(t[1]),{type:"tag",tagType:"byterange"}),this.trigger("data",i);return}if(t=/^#EXT-X-ALLOW-CACHE:(YES|NO)?/.exec(r),t){i={type:"tag",tagType:"allow-cache"},t[1]&&(i.allowed=!/NO/.test(t[1])),this.trigger("data",i);return}if(t=/^#EXT-X-MAP:(.*)$/.exec(r),t){if(i={type:"tag",tagType:"map"},t[1]){const o=ki(t[1]);o.URI&&(i.uri=o.URI),o.BYTERANGE&&(i.byterange=nm(o.BYTERANGE))}this.trigger("data",i);return}if(t=/^#EXT-X-STREAM-INF:(.*)$/.exec(r),t){i={type:"tag",tagType:"stream-inf"},t[1]&&(i.attributes=ki(t[1]),i.attributes.RESOLUTION&&(i.attributes.RESOLUTION=$1(i.attributes.RESOLUTION)),i.attributes.BANDWIDTH&&(i.attributes.BANDWIDTH=parseInt(i.attributes.BANDWIDTH,10)),i.attributes["FRAME-RATE"]&&(i.attributes["FRAME-RATE"]=parseFloat(i.attributes["FRAME-RATE"])),i.attributes["PROGRAM-ID"]&&(i.attributes["PROGRAM-ID"]=parseInt(i.attributes["PROGRAM-ID"],10))),this.trigger("data",i);return}if(t=/^#EXT-X-MEDIA:(.*)$/.exec(r),t){i={type:"tag",tagType:"media"},t[1]&&(i.attributes=ki(t[1])),this.trigger("data",i);return}if(t=/^#EXT-X-ENDLIST/.exec(r),t){this.trigger("data",{type:"tag",tagType:"endlist"});return}if(t=/^#EXT-X-DISCONTINUITY/.exec(r),t){this.trigger("data",{type:"tag",tagType:"discontinuity"});return}if(t=/^#EXT-X-PROGRAM-DATE-TIME:(.*)$/.exec(r),t){i={type:"tag",tagType:"program-date-time"},t[1]&&(i.dateTimeString=t[1],i.dateTimeObject=new Date(t[1])),this.trigger("data",i);return}if(t=/^#EXT-X-KEY:(.*)$/.exec(r),t){i={type:"tag",tagType:"key"},t[1]&&(i.attributes=ki(t[1]),i.attributes.IV&&(i.attributes.IV.substring(0,2).toLowerCase()==="0x"&&(i.attributes.IV=i.attributes.IV.substring(2)),i.attributes.IV=i.attributes.IV.match(/.{8}/g),i.attributes.IV[0]=parseInt(i.attributes.IV[0],16),i.attributes.IV[1]=parseInt(i.attributes.IV[1],16),i.attributes.IV[2]=parseInt(i.attributes.IV[2],16),i.attributes.IV[3]=parseInt(i.attributes.IV[3],16),i.attributes.IV=new Uint32Array(i.attributes.IV))),this.trigger("data",i);return}if(t=/^#EXT-X-START:(.*)$/.exec(r),t){i={type:"tag",tagType:"start"},t[1]&&(i.attributes=ki(t[1]),i.attributes["TIME-OFFSET"]=parseFloat(i.attributes["TIME-OFFSET"]),i.attributes.PRECISE=/YES/.test(i.attributes.PRECISE)),this.trigger("data",i);return}if(t=/^#EXT-X-CUE-OUT-CONT:(.*)?$/.exec(r),t){i={type:"tag",tagType:"cue-out-cont"},t[1]?i.data=t[1]:i.data="",this.trigger("data",i);return}if(t=/^#EXT-X-CUE-OUT:(.*)?$/.exec(r),t){i={type:"tag",tagType:"cue-out"},t[1]?i.data=t[1]:i.data="",this.trigger("data",i);return}if(t=/^#EXT-X-CUE-IN:?(.*)?$/.exec(r),t){i={type:"tag",tagType:"cue-in"},t[1]?i.data=t[1]:i.data="",this.trigger("data",i);return}if(t=/^#EXT-X-SKIP:(.*)$/.exec(r),t&&t[1]){i={type:"tag",tagType:"skip"},i.attributes=ki(t[1]),i.attributes.hasOwnProperty("SKIPPED-SEGMENTS")&&(i.attributes["SKIPPED-SEGMENTS"]=parseInt(i.attributes["SKIPPED-SEGMENTS"],10)),i.attributes.hasOwnProperty("RECENTLY-REMOVED-DATERANGES")&&(i.attributes["RECENTLY-REMOVED-DATERANGES"]=i.attributes["RECENTLY-REMOVED-DATERANGES"].split(M5)),this.trigger("data",i);return}if(t=/^#EXT-X-PART:(.*)$/.exec(r),t&&t[1]){i={type:"tag",tagType:"part"},i.attributes=ki(t[1]),["DURATION"].forEach(function(o){i.attributes.hasOwnProperty(o)&&(i.attributes[o]=parseFloat(i.attributes[o]))}),["INDEPENDENT","GAP"].forEach(function(o){i.attributes.hasOwnProperty(o)&&(i.attributes[o]=/YES/.test(i.attributes[o]))}),i.attributes.hasOwnProperty("BYTERANGE")&&(i.attributes.byterange=nm(i.attributes.BYTERANGE)),this.trigger("data",i);return}if(t=/^#EXT-X-SERVER-CONTROL:(.*)$/.exec(r),t&&t[1]){i={type:"tag",tagType:"server-control"},i.attributes=ki(t[1]),["CAN-SKIP-UNTIL","PART-HOLD-BACK","HOLD-BACK"].forEach(function(o){i.attributes.hasOwnProperty(o)&&(i.attributes[o]=parseFloat(i.attributes[o]))}),["CAN-SKIP-DATERANGES","CAN-BLOCK-RELOAD"].forEach(function(o){i.attributes.hasOwnProperty(o)&&(i.attributes[o]=/YES/.test(i.attributes[o]))}),this.trigger("data",i);return}if(t=/^#EXT-X-PART-INF:(.*)$/.exec(r),t&&t[1]){i={type:"tag",tagType:"part-inf"},i.attributes=ki(t[1]),["PART-TARGET"].forEach(function(o){i.attributes.hasOwnProperty(o)&&(i.attributes[o]=parseFloat(i.attributes[o]))}),this.trigger("data",i);return}if(t=/^#EXT-X-PRELOAD-HINT:(.*)$/.exec(r),t&&t[1]){i={type:"tag",tagType:"preload-hint"},i.attributes=ki(t[1]),["BYTERANGE-START","BYTERANGE-LENGTH"].forEach(function(o){if(i.attributes.hasOwnProperty(o)){i.attributes[o]=parseInt(i.attributes[o],10);const a=o==="BYTERANGE-LENGTH"?"length":"offset";i.attributes.byterange=i.attributes.byterange||{},i.attributes.byterange[a]=i.attributes[o],delete i.attributes[o]}}),this.trigger("data",i);return}if(t=/^#EXT-X-RENDITION-REPORT:(.*)$/.exec(r),t&&t[1]){i={type:"tag",tagType:"rendition-report"},i.attributes=ki(t[1]),["LAST-MSN","LAST-PART"].forEach(function(o){i.attributes.hasOwnProperty(o)&&(i.attributes[o]=parseInt(i.attributes[o],10))}),this.trigger("data",i);return}if(t=/^#EXT-X-DATERANGE:(.*)$/.exec(r),t&&t[1]){i={type:"tag",tagType:"daterange"},i.attributes=ki(t[1]),["ID","CLASS"].forEach(function(a){i.attributes.hasOwnProperty(a)&&(i.attributes[a]=String(i.attributes[a]))}),["START-DATE","END-DATE"].forEach(function(a){i.attributes.hasOwnProperty(a)&&(i.attributes[a]=new Date(i.attributes[a]))}),["DURATION","PLANNED-DURATION"].forEach(function(a){i.attributes.hasOwnProperty(a)&&(i.attributes[a]=parseFloat(i.attributes[a]))}),["END-ON-NEXT"].forEach(function(a){i.attributes.hasOwnProperty(a)&&(i.attributes[a]=/YES/i.test(i.attributes[a]))}),["SCTE35-CMD"," SCTE35-OUT","SCTE35-IN"].forEach(function(a){i.attributes.hasOwnProperty(a)&&(i.attributes[a]=i.attributes[a].toString(16))});const o=/^X-([A-Z]+-)+[A-Z]+$/;for(const a in i.attributes){if(!o.test(a))continue;const l=/[0-9A-Fa-f]{6}/g.test(i.attributes[a]),h=/^\d+(\.\d+)?$/.test(i.attributes[a]);i.attributes[a]=l?i.attributes[a].toString(16):h?parseFloat(i.attributes[a]):String(i.attributes[a])}this.trigger("data",i);return}if(t=/^#EXT-X-INDEPENDENT-SEGMENTS/.exec(r),t){this.trigger("data",{type:"tag",tagType:"independent-segments"});return}if(t=/^#EXT-X-I-FRAMES-ONLY/.exec(r),t){this.trigger("data",{type:"tag",tagType:"i-frames-only"});return}if(t=/^#EXT-X-CONTENT-STEERING:(.*)$/.exec(r),t){i={type:"tag",tagType:"content-steering"},i.attributes=ki(t[1]),this.trigger("data",i);return}if(t=/^#EXT-X-I-FRAME-STREAM-INF:(.*)$/.exec(r),t){i={type:"tag",tagType:"i-frame-playlist"},i.attributes=ki(t[1]),i.attributes.URI&&(i.uri=i.attributes.URI),i.attributes.BANDWIDTH&&(i.attributes.BANDWIDTH=parseInt(i.attributes.BANDWIDTH,10)),i.attributes.RESOLUTION&&(i.attributes.RESOLUTION=$1(i.attributes.RESOLUTION)),i.attributes["AVERAGE-BANDWIDTH"]&&(i.attributes["AVERAGE-BANDWIDTH"]=parseInt(i.attributes["AVERAGE-BANDWIDTH"],10)),i.attributes["FRAME-RATE"]&&(i.attributes["FRAME-RATE"]=parseFloat(i.attributes["FRAME-RATE"])),this.trigger("data",i);return}if(t=/^#EXT-X-DEFINE:(.*)$/.exec(r),t){i={type:"tag",tagType:"define"},i.attributes=ki(t[1]),this.trigger("data",i);return}this.trigger("data",{type:"tag",data:r.slice(4)})})}addParser({expression:e,customType:t,dataParser:i,segment:s}){typeof i!="function"&&(i=r=>r),this.customParsers.push(r=>{if(e.exec(r))return this.trigger("data",{type:"custom",data:i(r),customType:t,segment:s}),!0})}addTagMapper({expression:e,map:t}){const i=s=>e.test(s)?t(s):s;this.tagMappers.push(i)}}const L5=n=>n.toLowerCase().replace(/-(\w)/g,e=>e[1].toUpperCase()),mr=function(n){const e={};return Object.keys(n).forEach(function(t){e[L5(t)]=n[t]}),e},sm=function(n){const{serverControl:e,targetDuration:t,partTargetDuration:i}=n;if(!e)return;const s="#EXT-X-SERVER-CONTROL",r="holdBack",o="partHoldBack",a=t&&t*3,l=i&&i*2;t&&!e.hasOwnProperty(r)&&(e[r]=a,this.trigger("info",{message:`${s} defaulting HOLD-BACK to targetDuration * 3 (${a}).`})),a&&e[r]<a&&(this.trigger("warn",{message:`${s} clamping HOLD-BACK (${e[r]}) to targetDuration * 3 (${a})`}),e[r]=a),i&&!e.hasOwnProperty(o)&&(e[o]=i*3,this.trigger("info",{message:`${s} defaulting PART-HOLD-BACK to partTargetDuration * 3 (${e[o]}).`})),i&&e[o]<l&&(this.trigger("warn",{message:`${s} clamping PART-HOLD-BACK (${e[o]}) to partTargetDuration * 2 (${l}).`}),e[o]=l)};let $5=class extends ky{constructor(e={}){super(),this.lineStream=new D5,this.parseStream=new R5,this.lineStream.pipe(this.parseStream),this.mainDefinitions=e.mainDefinitions||{},this.params=new URL(e.uri,"https://a.com").searchParams,this.lastProgramDateTime=null;const t=this,i=[];let s={},r,o,a=!1;const l=function(){},h={AUDIO:{},VIDEO:{},"CLOSED-CAPTIONS":{},SUBTITLES:{}},u="urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed";let c=0;this.manifest={allowCache:!0,discontinuityStarts:[],dateRanges:[],iFramePlaylists:[],segments:[]};let f=0,p=0;const b={};this.on("end",()=>{s.uri||!s.parts&&!s.preloadHints||(!s.map&&r&&(s.map=r),!s.key&&o&&(s.key=o),!s.timeline&&typeof c=="number"&&(s.timeline=c),this.manifest.preloadSegment=s)}),this.parseStream.on("data",function(y){let _,T;if(t.manifest.definitions){for(const w in t.manifest.definitions)if(y.uri&&(y.uri=y.uri.replace(`{$${w}}`,t.manifest.definitions[w])),y.attributes)for(const v in y.attributes)typeof y.attributes[v]=="string"&&(y.attributes[v]=y.attributes[v].replace(`{$${w}}`,t.manifest.definitions[w]))}({tag(){({version(){y.version&&(this.manifest.version=y.version)},"allow-cache"(){this.manifest.allowCache=y.allowed,"allowed"in y||(this.trigger("info",{message:"defaulting allowCache to YES"}),this.manifest.allowCache=!0)},byterange(){const w={};"length"in y&&(s.byterange=w,w.length=y.length,"offset"in y||(y.offset=f)),"offset"in y&&(s.byterange=w,w.offset=y.offset),f=w.offset+w.length},endlist(){this.manifest.endList=!0},inf(){"mediaSequence"in this.manifest||(this.manifest.mediaSequence=0,this.trigger("info",{message:"defaulting media sequence to zero"})),"discontinuitySequence"in this.manifest||(this.manifest.discontinuitySequence=0,this.trigger("info",{message:"defaulting discontinuity sequence to zero"})),y.title&&(s.title=y.title),y.duration>0&&(s.duration=y.duration),y.duration===0&&(s.duration=.01,this.trigger("info",{message:"updating zero segment duration to a small value"})),this.manifest.segments=i},key(){if(!y.attributes){this.trigger("warn",{message:"ignoring key declaration without attribute list"});return}if(y.attributes.METHOD==="NONE"){o=null;return}if(!y.attributes.URI){this.trigger("warn",{message:"ignoring key declaration without URI"});return}if(y.attributes.KEYFORMAT==="com.apple.streamingkeydelivery"){this.manifest.contentProtection=this.manifest.contentProtection||{},this.manifest.contentProtection["com.apple.fps.1_0"]={attributes:y.attributes};return}if(y.attributes.KEYFORMAT==="com.microsoft.playready"){this.manifest.contentProtection=this.manifest.contentProtection||{},this.manifest.contentProtection["com.microsoft.playready"]={uri:y.attributes.URI};return}if(y.attributes.KEYFORMAT===u){if(["SAMPLE-AES","SAMPLE-AES-CTR","SAMPLE-AES-CENC"].indexOf(y.attributes.METHOD)===-1){this.trigger("warn",{message:"invalid key method provided for Widevine"});return}if(y.attributes.METHOD==="SAMPLE-AES-CENC"&&this.trigger("warn",{message:"SAMPLE-AES-CENC is deprecated, please use SAMPLE-AES-CTR instead"}),y.attributes.URI.substring(0,23)!=="data:text/plain;base64,"){this.trigger("warn",{message:"invalid key URI provided for Widevine"});return}if(!(y.attributes.KEYID&&y.attributes.KEYID.substring(0,2)==="0x")){this.trigger("warn",{message:"invalid key ID provided for Widevine"});return}this.manifest.contentProtection=this.manifest.contentProtection||{},this.manifest.contentProtection["com.widevine.alpha"]={attributes:{schemeIdUri:y.attributes.KEYFORMAT,keyId:y.attributes.KEYID.substring(2)},pssh:w2(y.attributes.URI.split(",")[1])};return}y.attributes.METHOD||this.trigger("warn",{message:"defaulting key method to AES-128"}),o={method:y.attributes.METHOD||"AES-128",uri:y.attributes.URI},typeof y.attributes.IV<"u"&&(o.iv=y.attributes.IV)},"media-sequence"(){if(!isFinite(y.number)){this.trigger("warn",{message:"ignoring invalid media sequence: "+y.number});return}this.manifest.mediaSequence=y.number},"discontinuity-sequence"(){if(!isFinite(y.number)){this.trigger("warn",{message:"ignoring invalid discontinuity sequence: "+y.number});return}this.manifest.discontinuitySequence=y.number,c=y.number},"playlist-type"(){if(!/VOD|EVENT/.test(y.playlistType)){this.trigger("warn",{message:"ignoring unknown playlist type: "+y.playlist});return}this.manifest.playlistType=y.playlistType},map(){r={},y.uri&&(r.uri=y.uri),y.byterange&&(r.byterange=y.byterange),o&&(r.key=o)},"stream-inf"(){if(this.manifest.playlists=i,this.manifest.mediaGroups=this.manifest.mediaGroups||h,!y.attributes){this.trigger("warn",{message:"ignoring empty stream-inf attributes"});return}s.attributes||(s.attributes={}),Nt(s.attributes,y.attributes)},media(){if(this.manifest.mediaGroups=this.manifest.mediaGroups||h,!(y.attributes&&y.attributes.TYPE&&y.attributes["GROUP-ID"]&&y.attributes.NAME)){this.trigger("warn",{message:"ignoring incomplete or missing media group"});return}const w=this.manifest.mediaGroups[y.attributes.TYPE];w[y.attributes["GROUP-ID"]]=w[y.attributes["GROUP-ID"]]||{},_=w[y.attributes["GROUP-ID"]],T={default:/yes/i.test(y.attributes.DEFAULT)},T.default?T.autoselect=!0:T.autoselect=/yes/i.test(y.attributes.AUTOSELECT),y.attributes.LANGUAGE&&(T.language=y.attributes.LANGUAGE),y.attributes.URI&&(T.uri=y.attributes.URI),y.attributes["INSTREAM-ID"]&&(T.instreamId=y.attributes["INSTREAM-ID"]),y.attributes.CHARACTERISTICS&&(T.characteristics=y.attributes.CHARACTERISTICS),y.attributes.FORCED&&(T.forced=/yes/i.test(y.attributes.FORCED)),_[y.attributes.NAME]=T},discontinuity(){c+=1,s.discontinuity=!0,this.manifest.discontinuityStarts.push(i.length)},"program-date-time"(){typeof this.manifest.dateTimeString>"u"&&(this.manifest.dateTimeString=y.dateTimeString,this.manifest.dateTimeObject=y.dateTimeObject),s.dateTimeString=y.dateTimeString,s.dateTimeObject=y.dateTimeObject;const{lastProgramDateTime:w}=this;this.lastProgramDateTime=new Date(y.dateTimeString).getTime(),w===null&&this.manifest.segments.reduceRight((v,S)=>(S.programDateTime=v-S.duration*1e3,S.programDateTime),this.lastProgramDateTime)},targetduration(){if(!isFinite(y.duration)||y.duration<0){this.trigger("warn",{message:"ignoring invalid target duration: "+y.duration});return}this.manifest.targetDuration=y.duration,sm.call(this,this.manifest)},start(){if(!y.attributes||isNaN(y.attributes["TIME-OFFSET"])){this.trigger("warn",{message:"ignoring start declaration without appropriate attribute list"});return}this.manifest.start={timeOffset:y.attributes["TIME-OFFSET"],precise:y.attributes.PRECISE}},"cue-out"(){s.cueOut=y.data},"cue-out-cont"(){s.cueOutCont=y.data},"cue-in"(){s.cueIn=y.data},skip(){this.manifest.skip=mr(y.attributes),this.warnOnMissingAttributes_("#EXT-X-SKIP",y.attributes,["SKIPPED-SEGMENTS"])},part(){a=!0;const w=this.manifest.segments.length,v=mr(y.attributes);s.parts=s.parts||[],s.parts.push(v),v.byterange&&(v.byterange.hasOwnProperty("offset")||(v.byterange.offset=p),p=v.byterange.offset+v.byterange.length);const S=s.parts.length-1;this.warnOnMissingAttributes_(`#EXT-X-PART #${S} for segment #${w}`,y.attributes,["URI","DURATION"]),this.manifest.renditionReports&&this.manifest.renditionReports.forEach((k,A)=>{k.hasOwnProperty("lastPart")||this.trigger("warn",{message:`#EXT-X-RENDITION-REPORT #${A} lacks required attribute(s): LAST-PART`})})},"server-control"(){const w=this.manifest.serverControl=mr(y.attributes);w.hasOwnProperty("canBlockReload")||(w.canBlockReload=!1,this.trigger("info",{message:"#EXT-X-SERVER-CONTROL defaulting CAN-BLOCK-RELOAD to false"})),sm.call(this,this.manifest),w.canSkipDateranges&&!w.hasOwnProperty("canSkipUntil")&&this.trigger("warn",{message:"#EXT-X-SERVER-CONTROL lacks required attribute CAN-SKIP-UNTIL which is required when CAN-SKIP-DATERANGES is set"})},"preload-hint"(){const w=this.manifest.segments.length,v=mr(y.attributes),S=v.type&&v.type==="PART";s.preloadHints=s.preloadHints||[],s.preloadHints.push(v),v.byterange&&(v.byterange.hasOwnProperty("offset")||(v.byterange.offset=S?p:0,S&&(p=v.byterange.offset+v.byterange.length)));const k=s.preloadHints.length-1;if(this.warnOnMissingAttributes_(`#EXT-X-PRELOAD-HINT #${k} for segment #${w}`,y.attributes,["TYPE","URI"]),!!v.type)for(let A=0;A<s.preloadHints.length-1;A++){const M=s.preloadHints[A];M.type&&M.type===v.type&&this.trigger("warn",{message:`#EXT-X-PRELOAD-HINT #${k} for segment #${w} has the same TYPE ${v.type} as preload hint #${A}`})}},"rendition-report"(){const w=mr(y.attributes);this.manifest.renditionReports=this.manifest.renditionReports||[],this.manifest.renditionReports.push(w);const v=this.manifest.renditionReports.length-1,S=["LAST-MSN","URI"];a&&S.push("LAST-PART"),this.warnOnMissingAttributes_(`#EXT-X-RENDITION-REPORT #${v}`,y.attributes,S)},"part-inf"(){this.manifest.partInf=mr(y.attributes),this.warnOnMissingAttributes_("#EXT-X-PART-INF",y.attributes,["PART-TARGET"]),this.manifest.partInf.partTarget&&(this.manifest.partTargetDuration=this.manifest.partInf.partTarget),sm.call(this,this.manifest)},daterange(){this.manifest.dateRanges.push(mr(y.attributes));const w=this.manifest.dateRanges.length-1;this.warnOnMissingAttributes_(`#EXT-X-DATERANGE #${w}`,y.attributes,["ID","START-DATE"]);const v=this.manifest.dateRanges[w];v.endDate&&v.startDate&&new Date(v.endDate)<new Date(v.startDate)&&this.trigger("warn",{message:"EXT-X-DATERANGE END-DATE must be equal to or later than the value of the START-DATE"}),v.duration&&v.duration<0&&this.trigger("warn",{message:"EXT-X-DATERANGE DURATION must not be negative"}),v.plannedDuration&&v.plannedDuration<0&&this.trigger("warn",{message:"EXT-X-DATERANGE PLANNED-DURATION must not be negative"});const S=!!v.endOnNext;if(S&&!v.class&&this.trigger("warn",{message:"EXT-X-DATERANGE with an END-ON-NEXT=YES attribute must have a CLASS attribute"}),S&&(v.duration||v.endDate)&&this.trigger("warn",{message:"EXT-X-DATERANGE with an END-ON-NEXT=YES attribute must not contain DURATION or END-DATE attributes"}),v.duration&&v.endDate){const A=v.startDate.getTime()+v.duration*1e3;this.manifest.dateRanges[w].endDate=new Date(A)}if(!b[v.id])b[v.id]=v;else{for(const A in b[v.id])if(v[A]&&JSON.stringify(b[v.id][A])!==JSON.stringify(v[A])){this.trigger("warn",{message:"EXT-X-DATERANGE tags with the same ID in a playlist must have the same attributes values"});break}const k=this.manifest.dateRanges.findIndex(A=>A.id===v.id);this.manifest.dateRanges[k]=Nt(this.manifest.dateRanges[k],v),b[v.id]=Nt(b[v.id],v),this.manifest.dateRanges.pop()}},"independent-segments"(){this.manifest.independentSegments=!0},"i-frames-only"(){this.manifest.iFramesOnly=!0,this.requiredCompatibilityversion(this.manifest.version,4)},"content-steering"(){this.manifest.contentSteering=mr(y.attributes),this.warnOnMissingAttributes_("#EXT-X-CONTENT-STEERING",y.attributes,["SERVER-URI"])},define(){this.manifest.definitions=this.manifest.definitions||{};const w=(v,S)=>{if(v in this.manifest.definitions){this.trigger("error",{message:`EXT-X-DEFINE: Duplicate name ${v}`});return}this.manifest.definitions[v]=S};if("QUERYPARAM"in y.attributes){if("NAME"in y.attributes||"IMPORT"in y.attributes){this.trigger("error",{message:"EXT-X-DEFINE: Invalid attributes"});return}const v=this.params.get(y.attributes.QUERYPARAM);if(!v){this.trigger("error",{message:`EXT-X-DEFINE: No query param ${y.attributes.QUERYPARAM}`});return}w(y.attributes.QUERYPARAM,decodeURIComponent(v));return}if("NAME"in y.attributes){if("IMPORT"in y.attributes){this.trigger("error",{message:"EXT-X-DEFINE: Invalid attributes"});return}if(!("VALUE"in y.attributes)||typeof y.attributes.VALUE!="string"){this.trigger("error",{message:`EXT-X-DEFINE: No value for ${y.attributes.NAME}`});return}w(y.attributes.NAME,y.attributes.VALUE);return}if("IMPORT"in y.attributes){if(!this.mainDefinitions[y.attributes.IMPORT]){this.trigger("error",{message:`EXT-X-DEFINE: No value ${y.attributes.IMPORT} to import, or IMPORT used on main playlist`});return}w(y.attributes.IMPORT,this.mainDefinitions[y.attributes.IMPORT]);return}this.trigger("error",{message:"EXT-X-DEFINE: No attribute"})},"i-frame-playlist"(){this.manifest.iFramePlaylists.push({attributes:y.attributes,uri:y.uri,timeline:c}),this.warnOnMissingAttributes_("#EXT-X-I-FRAME-STREAM-INF",y.attributes,["BANDWIDTH","URI"])}}[y.tagType]||l).call(t)},uri(){s.uri=y.uri,i.push(s),this.manifest.targetDuration&&!("duration"in s)&&(this.trigger("warn",{message:"defaulting segment duration to the target duration"}),s.duration=this.manifest.targetDuration),o&&(s.key=o),s.timeline=c,r&&(s.map=r),p=0,this.lastProgramDateTime!==null&&(s.programDateTime=this.lastProgramDateTime,this.lastProgramDateTime+=s.duration*1e3),s={}},comment(){},custom(){y.segment?(s.custom=s.custom||{},s.custom[y.customType]=y.data):(this.manifest.custom=this.manifest.custom||{},this.manifest.custom[y.customType]=y.data)}})[y.type].call(t)})}requiredCompatibilityversion(e,t){(e<t||!e)&&this.trigger("warn",{message:`manifest must be at least version ${t}`})}warnOnMissingAttributes_(e,t,i){const s=[];i.forEach(function(r){t.hasOwnProperty(r)||s.push(r)}),s.length&&this.trigger("warn",{message:`${e} lacks required attribute(s): ${s.join(", ")}`})}push(e){this.lineStream.push(e)}end(){this.lineStream.push(`
`),this.manifest.dateRanges.length&&this.lastProgramDateTime===null&&this.trigger("warn",{message:"A playlist with EXT-X-DATERANGE tag must contain atleast one EXT-X-PROGRAM-DATE-TIME tag"}),this.lastProgramDateTime=null,this.trigger("end")}addParser(e){this.parseStream.addParser(e)}addTagMapper(e){this.parseStream.addTagMapper(e)}};var wo={mp4:/^(av0?1|avc0?[1234]|vp0?9|flac|opus|mp3|mp4a|mp4v|stpp.ttml.im1t)/,webm:/^(vp0?[89]|av0?1|opus|vorbis)/,ogg:/^(vp0?[89]|theora|flac|opus|vorbis)/,video:/^(av0?1|avc0?[1234]|vp0?[89]|hvc1|hev1|theora|mp4v)/,audio:/^(mp4a|flac|vorbis|opus|ac-[34]|ec-3|alac|mp3|speex|aac)/,text:/^(stpp.ttml.im1t)/,muxerVideo:/^(avc0?1)/,muxerAudio:/^(mp4a)/,muxerText:/a^/},Q5=["video","audio","text"],Q1=["Video","Audio","Text"],_2=function(e){return e&&e.replace(/avc1\.(\d+)\.(\d+)/i,function(t,i,s){var r=("00"+Number(i).toString(16)).slice(-2),o=("00"+Number(s).toString(16)).slice(-2);return"avc1."+r+"00"+o})},ds=function(e){e===void 0&&(e="");var t=e.split(","),i=[];return t.forEach(function(s){s=s.trim();var r;Q5.forEach(function(o){var a=wo[o].exec(s.toLowerCase());if(!(!a||a.length<=1)){r=o;var l=s.substring(0,a[1].length),h=s.replace(l,"");i.push({type:l,details:h,mediaType:o})}}),r||i.push({type:s,details:"",mediaType:"unknown"})}),i},B5=function(e,t){if(!e.mediaGroups.AUDIO||!t)return null;var i=e.mediaGroups.AUDIO[t];if(!i)return null;for(var s in i){var r=i[s];if(r.default&&r.playlists)return ds(r.playlists[0].attributes.CODECS)}return null},k2=function(e){return e===void 0&&(e=""),wo.audio.test(e.trim().toLowerCase())},N5=function(e){return e===void 0&&(e=""),wo.text.test(e.trim().toLowerCase())},Ra=function(e){if(!(!e||typeof e!="string")){var t=e.toLowerCase().split(",").map(function(r){return _2(r.trim())}),i="video";t.length===1&&k2(t[0])?i="audio":t.length===1&&N5(t[0])&&(i="application");var s="mp4";return t.every(function(r){return wo.mp4.test(r)})?s="mp4":t.every(function(r){return wo.webm.test(r)})?s="webm":t.every(function(r){return wo.ogg.test(r)})&&(s="ogg"),i+"/"+s+';codecs="'+e+'"'}},gh=function(e,t){return e===void 0&&(e=""),t===void 0&&(t=!1),V.MediaSource&&V.MediaSource.isTypeSupported&&V.MediaSource.isTypeSupported(Ra(e))||t&&V.ManagedMediaSource&&V.ManagedMediaSource.isTypeSupported&&V.ManagedMediaSource.isTypeSupported(Ra(e))||!1},rm=function(e){return e===void 0&&(e=""),e.toLowerCase().split(",").every(function(t){t=t.trim();for(var i=0;i<Q1.length;i++){var s=Q1[i];if(wo["muxer"+s].test(t))return!0}return!1})},B1="mp4a.40.2",F5="avc1.4d400d",V5=/^(audio|video|application)\/(x-|vnd\.apple\.)?mpegurl/i,U5=/^application\/dash\+xml/i,C2=function(e){return V5.test(e)?"hls":U5.test(e)?"dash":e==="application/vnd.videojs.vhs+json"?"vhs-json":null},q5=function(e){return e.toString(2).length},z5=function(e){return Math.ceil(q5(e)/8)},E2=function(e){return ArrayBuffer.isView==="function"?ArrayBuffer.isView(e):e&&e.buffer instanceof ArrayBuffer},j5=function(e){return E2(e)},De=function(e){return e instanceof Uint8Array?e:(!Array.isArray(e)&&!j5(e)&&!(e instanceof ArrayBuffer)&&(typeof e!="number"||typeof e=="number"&&e!==e?e=0:e=[e]),new Uint8Array(e&&e.buffer||e,e&&e.byteOffset||0,e&&e.byteLength||0))},ri=V.BigInt||Number,Bg=[ri("0x1"),ri("0x100"),ri("0x10000"),ri("0x1000000"),ri("0x100000000"),ri("0x10000000000"),ri("0x1000000000000"),ri("0x100000000000000"),ri("0x10000000000000000")];(function(){var n=new Uint16Array([65484]),e=new Uint8Array(n.buffer,n.byteOffset,n.byteLength);return e[0]===255?"big":e[0]===204?"little":"unknown"})();var X5=function(e,t){var i=t===void 0?{}:t,s=i.signed,r=s===void 0?!1:s,o=i.le,a=o===void 0?!1:o;e=De(e);var l=a?"reduce":"reduceRight",h=e[l]?e[l]:Array.prototype[l],u=h.call(e,function(f,p,b){var y=a?b:Math.abs(b+1-e.length);return f+ri(p)*Bg[y]},ri(0));if(r){var c=Bg[e.length]/ri(2)-ri(1);u=ri(u),u>c&&(u-=c,u-=c,u-=ri(2))}return Number(u)},H5=function(e,t){var i={},s=i.le,r=s===void 0?!1:s;(typeof e!="bigint"&&typeof e!="number"||typeof e=="number"&&e!==e)&&(e=0),e=ri(e);for(var o=z5(e),a=new Uint8Array(new ArrayBuffer(o)),l=0;l<o;l++){var h=r?l:Math.abs(l+1-a.length);a[h]=Number(e/Bg[l]&ri(255)),e<0&&(a[h]=Math.abs(~a[h]),a[h]-=l===0?1:2)}return a},A2=function(e,t){if(typeof e!="string"&&e&&typeof e.toString=="function"&&(e=e.toString()),typeof e!="string")return new Uint8Array;t||(e=unescape(encodeURIComponent(e)));for(var i=new Uint8Array(e.length),s=0;s<e.length;s++)i[s]=e.charCodeAt(s);return i},W5=function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];if(t=t.filter(function(a){return a&&(a.byteLength||a.length)&&typeof a!="string"}),t.length<=1)return De(t[0]);var s=t.reduce(function(a,l,h){return a+(l.byteLength||l.length)},0),r=new Uint8Array(s),o=0;return t.forEach(function(a){a=De(a),r.set(a,o),o+=a.byteLength}),r},St=function(e,t,i){var s=i===void 0?{}:i,r=s.offset,o=r===void 0?0:r,a=s.mask,l=a===void 0?[]:a;e=De(e),t=De(t);var h=t.every?t.every:Array.prototype.every;return t.length&&e.length-o>=t.length&&h.call(t,function(u,c){var f=l[c]?l[c]&e[o+c]:e[o+c];return u===f})},Z5=function(e,t,i){t.forEach(function(s){for(var r in e.mediaGroups[s])for(var o in e.mediaGroups[s][r]){var a=e.mediaGroups[s][r][o];i(a,s,r,o)}})},Ll={},Hs={},io={},N1;function Ff(){if(N1)return io;N1=1;function n(r,o,a){if(a===void 0&&(a=Array.prototype),r&&typeof a.find=="function")return a.find.call(r,o);for(var l=0;l<r.length;l++)if(Object.prototype.hasOwnProperty.call(r,l)){var h=r[l];if(o.call(void 0,h,l,r))return h}}function e(r,o){return o===void 0&&(o=Object),o&&typeof o.freeze=="function"?o.freeze(r):r}function t(r,o){if(r===null||typeof r!="object")throw new TypeError("target is not an object");for(var a in o)Object.prototype.hasOwnProperty.call(o,a)&&(r[a]=o[a]);return r}var i=e({HTML:"text/html",isHTML:function(r){return r===i.HTML},XML_APPLICATION:"application/xml",XML_TEXT:"text/xml",XML_XHTML_APPLICATION:"application/xhtml+xml",XML_SVG_IMAGE:"image/svg+xml"}),s=e({HTML:"http://www.w3.org/1999/xhtml",isHTML:function(r){return r===s.HTML},SVG:"http://www.w3.org/2000/svg",XML:"http://www.w3.org/XML/1998/namespace",XMLNS:"http://www.w3.org/2000/xmlns/"});return io.assign=t,io.find=n,io.freeze=e,io.MIME_TYPE=i,io.NAMESPACE=s,io}var F1;function P2(){if(F1)return Hs;F1=1;var n=Ff(),e=n.find,t=n.NAMESPACE;function i(I){return I!==""}function s(I){return I?I.split(/[\t\n\f\r ]+/).filter(i):[]}function r(I,L){return I.hasOwnProperty(L)||(I[L]=!0),I}function o(I){if(!I)return[];var L=s(I);return Object.keys(L.reduce(r,{}))}function a(I){return function(L){return I&&I.indexOf(L)!==-1}}function l(I,L){for(var C in I)Object.prototype.hasOwnProperty.call(I,C)&&(L[C]=I[C])}function h(I,L){var C=I.prototype;if(!(C instanceof L)){let D=function(){};D.prototype=L.prototype,D=new D,l(C,D),I.prototype=C=D}C.constructor!=I&&(typeof I!="function"&&console.error("unknown Class:"+I),C.constructor=I)}var u={},c=u.ELEMENT_NODE=1,f=u.ATTRIBUTE_NODE=2,p=u.TEXT_NODE=3,b=u.CDATA_SECTION_NODE=4,y=u.ENTITY_REFERENCE_NODE=5,_=u.ENTITY_NODE=6,T=u.PROCESSING_INSTRUCTION_NODE=7,w=u.COMMENT_NODE=8,v=u.DOCUMENT_NODE=9,S=u.DOCUMENT_TYPE_NODE=10,k=u.DOCUMENT_FRAGMENT_NODE=11,A=u.NOTATION_NODE=12,M={},B={};M.INDEX_SIZE_ERR=(B[1]="Index size error",1),M.DOMSTRING_SIZE_ERR=(B[2]="DOMString size error",2);var P=M.HIERARCHY_REQUEST_ERR=(B[3]="Hierarchy request error",3);M.WRONG_DOCUMENT_ERR=(B[4]="Wrong document",4),M.INVALID_CHARACTER_ERR=(B[5]="Invalid character",5),M.NO_DATA_ALLOWED_ERR=(B[6]="No data allowed",6),M.NO_MODIFICATION_ALLOWED_ERR=(B[7]="No modification allowed",7);var R=M.NOT_FOUND_ERR=(B[8]="Not found",8);M.NOT_SUPPORTED_ERR=(B[9]="Not supported",9);var q=M.INUSE_ATTRIBUTE_ERR=(B[10]="Attribute in use",10);M.INVALID_STATE_ERR=(B[11]="Invalid state",11),M.SYNTAX_ERR=(B[12]="Syntax error",12),M.INVALID_MODIFICATION_ERR=(B[13]="Invalid modification",13),M.NAMESPACE_ERR=(B[14]="Invalid namespace",14),M.INVALID_ACCESS_ERR=(B[15]="Invalid access",15);function z(I,L){if(L instanceof Error)var C=L;else C=this,Error.call(this,B[I]),this.message=B[I],Error.captureStackTrace&&Error.captureStackTrace(this,z);return C.code=I,L&&(this.message=this.message+": "+L),C}z.prototype=Error.prototype,l(M,z);function X(){}X.prototype={length:0,item:function(I){return I>=0&&I<this.length?this[I]:null},toString:function(I,L){for(var C=[],D=0;D<this.length;D++)Jn(this[D],C,I,L);return C.join("")},filter:function(I){return Array.prototype.filter.call(this,I)},indexOf:function(I){return Array.prototype.indexOf.call(this,I)}};function Z(I,L){this._node=I,this._refresh=L,K(this)}function K(I){var L=I._node._inc||I._node.ownerDocument._inc;if(I._inc!==L){var C=I._refresh(I._node);if(Ni(I,"length",C.length),!I.$$length||C.length<I.$$length)for(var D=C.length;D in I;D++)Object.prototype.hasOwnProperty.call(I,D)&&delete I[D];l(C,I),I._inc=L}}Z.prototype.item=function(I){return K(this),this[I]||null},h(Z,X);function oe(){}function G(I,L){for(var C=I.length;C--;)if(I[C]===L)return C}function ee(I,L,C,D){if(D?L[G(L,D)]=C:L[L.length++]=C,I){C.ownerElement=I;var N=I.ownerDocument;N&&(D&&ct(N,I,D),Se(N,I,C))}}function te(I,L,C){var D=G(L,C);if(D>=0){for(var N=L.length-1;D<N;)L[D]=L[++D];if(L.length=N,I){var W=I.ownerDocument;W&&(ct(W,I,C),C.ownerElement=null)}}else throw new z(R,new Error(I.tagName+"@"+C))}oe.prototype={length:0,item:X.prototype.item,getNamedItem:function(I){for(var L=this.length;L--;){var C=this[L];if(C.nodeName==I)return C}},setNamedItem:function(I){var L=I.ownerElement;if(L&&L!=this._ownerElement)throw new z(q);var C=this.getNamedItem(I.nodeName);return ee(this._ownerElement,this,I,C),C},setNamedItemNS:function(I){var L=I.ownerElement,C;if(L&&L!=this._ownerElement)throw new z(q);return C=this.getNamedItemNS(I.namespaceURI,I.localName),ee(this._ownerElement,this,I,C),C},removeNamedItem:function(I){var L=this.getNamedItem(I);return te(this._ownerElement,this,L),L},removeNamedItemNS:function(I,L){var C=this.getNamedItemNS(I,L);return te(this._ownerElement,this,C),C},getNamedItemNS:function(I,L){for(var C=this.length;C--;){var D=this[C];if(D.localName==L&&D.namespaceURI==I)return D}return null}};function re(){}re.prototype={hasFeature:function(I,L){return!0},createDocument:function(I,L,C){var D=new Pe;if(D.implementation=this,D.childNodes=new X,D.doctype=C||null,C&&D.appendChild(C),L){var N=D.createElementNS(I,L);D.appendChild(N)}return D},createDocumentType:function(I,L,C){var D=new Kn;return D.name=I,D.nodeName=I,D.publicId=L||"",D.systemId=C||"",D}};function ne(){}ne.prototype={firstChild:null,lastChild:null,previousSibling:null,nextSibling:null,attributes:null,parentNode:null,childNodes:null,ownerDocument:null,nodeValue:null,namespaceURI:null,prefix:null,localName:null,insertBefore:function(I,L){return ni(this,I,L)},replaceChild:function(I,L){ni(this,I,L,di),L&&this.removeChild(L)},removeChild:function(I){return rt(this,I)},appendChild:function(I){return this.insertBefore(I,null)},hasChildNodes:function(){return this.firstChild!=null},cloneNode:function(I){return Us(this.ownerDocument||this,this,I)},normalize:function(){for(var I=this.firstChild;I;){var L=I.nextSibling;L&&L.nodeType==p&&I.nodeType==p?(this.removeChild(L),I.appendData(L.data)):(I.normalize(),I=L)}},isSupported:function(I,L){return this.ownerDocument.implementation.hasFeature(I,L)},hasAttributes:function(){return this.attributes.length>0},lookupPrefix:function(I){for(var L=this;L;){var C=L._nsMap;if(C){for(var D in C)if(Object.prototype.hasOwnProperty.call(C,D)&&C[D]===I)return D}L=L.nodeType==f?L.ownerDocument:L.parentNode}return null},lookupNamespaceURI:function(I){for(var L=this;L;){var C=L._nsMap;if(C&&Object.prototype.hasOwnProperty.call(C,I))return C[I];L=L.nodeType==f?L.ownerDocument:L.parentNode}return null},isDefaultNamespace:function(I){var L=this.lookupPrefix(I);return L==null}};function ve(I){return I=="<"&&"&lt;"||I==">"&&"&gt;"||I=="&"&&"&amp;"||I=='"'&&"&quot;"||"&#"+I.charCodeAt()+";"}l(u,ne),l(u,ne.prototype);function xe(I,L){if(L(I))return!0;if(I=I.firstChild)do if(xe(I,L))return!0;while(I=I.nextSibling)}function Pe(){this.ownerDocument=this}function Se(I,L,C){I&&I._inc++;var D=C.namespaceURI;D===t.XMLNS&&(L._nsMap[C.prefix?C.localName:""]=C.value)}function ct(I,L,C,D){I&&I._inc++;var N=C.namespaceURI;N===t.XMLNS&&delete L._nsMap[C.prefix?C.localName:""]}function vt(I,L,C){if(I&&I._inc){I._inc++;var D=L.childNodes;if(C)D[D.length++]=C;else{for(var N=L.firstChild,W=0;N;)D[W++]=N,N=N.nextSibling;D.length=W,delete D[D.length]}}}function rt(I,L){var C=L.previousSibling,D=L.nextSibling;return C?C.nextSibling=D:I.firstChild=D,D?D.previousSibling=C:I.lastChild=C,L.parentNode=null,L.previousSibling=null,L.nextSibling=null,vt(I.ownerDocument,I),L}function It(I){return I&&(I.nodeType===ne.DOCUMENT_NODE||I.nodeType===ne.DOCUMENT_FRAGMENT_NODE||I.nodeType===ne.ELEMENT_NODE)}function Bi(I){return I&&(Ut(I)||Gn(I)||Vt(I)||I.nodeType===ne.DOCUMENT_FRAGMENT_NODE||I.nodeType===ne.COMMENT_NODE||I.nodeType===ne.PROCESSING_INSTRUCTION_NODE)}function Vt(I){return I&&I.nodeType===ne.DOCUMENT_TYPE_NODE}function Ut(I){return I&&I.nodeType===ne.ELEMENT_NODE}function Gn(I){return I&&I.nodeType===ne.TEXT_NODE}function qt(I,L){var C=I.childNodes||[];if(e(C,Ut)||Vt(L))return!1;var D=e(C,Vt);return!(L&&D&&C.indexOf(D)>C.indexOf(L))}function Ln(I,L){var C=I.childNodes||[];function D(W){return Ut(W)&&W!==L}if(e(C,D))return!1;var N=e(C,Vt);return!(L&&N&&C.indexOf(N)>C.indexOf(L))}function Rt(I,L,C){if(!It(I))throw new z(P,"Unexpected parent node type "+I.nodeType);if(C&&C.parentNode!==I)throw new z(R,"child not in parent");if(!Bi(L)||Vt(L)&&I.nodeType!==ne.DOCUMENT_NODE)throw new z(P,"Unexpected node type "+L.nodeType+" for parent node type "+I.nodeType)}function Qs(I,L,C){var D=I.childNodes||[],N=L.childNodes||[];if(L.nodeType===ne.DOCUMENT_FRAGMENT_NODE){var W=N.filter(Ut);if(W.length>1||e(N,Gn))throw new z(P,"More than one element or text in fragment");if(W.length===1&&!qt(I,C))throw new z(P,"Element in fragment can not be inserted before doctype")}if(Ut(L)&&!qt(I,C))throw new z(P,"Only one element can be added and only after doctype");if(Vt(L)){if(e(D,Vt))throw new z(P,"Only one doctype is allowed");var ae=e(D,Ut);if(C&&D.indexOf(ae)<D.indexOf(C))throw new z(P,"Doctype can only be inserted before an element");if(!C&&ae)throw new z(P,"Doctype can not be appended since element is present")}}function di(I,L,C){var D=I.childNodes||[],N=L.childNodes||[];if(L.nodeType===ne.DOCUMENT_FRAGMENT_NODE){var W=N.filter(Ut);if(W.length>1||e(N,Gn))throw new z(P,"More than one element or text in fragment");if(W.length===1&&!Ln(I,C))throw new z(P,"Element in fragment can not be inserted before doctype")}if(Ut(L)&&!Ln(I,C))throw new z(P,"Only one element can be added and only after doctype");if(Vt(L)){if(e(D,function(Ee){return Vt(Ee)&&Ee!==C}))throw new z(P,"Only one doctype is allowed");var ae=e(D,Ut);if(C&&D.indexOf(ae)<D.indexOf(C))throw new z(P,"Doctype can only be inserted before an element")}}function ni(I,L,C,D){Rt(I,L,C),I.nodeType===ne.DOCUMENT_NODE&&(D||Qs)(I,L,C);var N=L.parentNode;if(N&&N.removeChild(L),L.nodeType===k){var W=L.firstChild;if(W==null)return L;var ae=L.lastChild}else W=ae=L;var ce=C?C.previousSibling:I.lastChild;W.previousSibling=ce,ae.nextSibling=C,ce?ce.nextSibling=W:I.firstChild=W,C==null?I.lastChild=ae:C.previousSibling=ae;do{W.parentNode=I;var Ee=I.ownerDocument||I;Fe(W,Ee)}while(W!==ae&&(W=W.nextSibling));return vt(I.ownerDocument||I,I),L.nodeType==k&&(L.firstChild=L.lastChild=null),L}function Fe(I,L){if(I.ownerDocument!==L){if(I.ownerDocument=L,I.nodeType===c&&I.attributes)for(var C=0;C<I.attributes.length;C++){var D=I.attributes.item(C);D&&(D.ownerDocument=L)}for(var N=I.firstChild;N;)Fe(N,L),N=N.nextSibling}}function lt(I,L){L.parentNode&&L.parentNode.removeChild(L),L.parentNode=I,L.previousSibling=I.lastChild,L.nextSibling=null,L.previousSibling?L.previousSibling.nextSibling=L:I.firstChild=L,I.lastChild=L,vt(I.ownerDocument,I,L);var C=I.ownerDocument||I;return Fe(L,C),L}Pe.prototype={nodeName:"#document",nodeType:v,doctype:null,documentElement:null,_inc:1,insertBefore:function(I,L){if(I.nodeType==k){for(var C=I.firstChild;C;){var D=C.nextSibling;this.insertBefore(C,L),C=D}return I}return ni(this,I,L),Fe(I,this),this.documentElement===null&&I.nodeType===c&&(this.documentElement=I),I},removeChild:function(I){return this.documentElement==I&&(this.documentElement=null),rt(this,I)},replaceChild:function(I,L){ni(this,I,L,di),Fe(I,this),L&&this.removeChild(L),Ut(I)&&(this.documentElement=I)},importNode:function(I,L){return Vs(this,I,L)},getElementById:function(I){var L=null;return xe(this.documentElement,function(C){if(C.nodeType==c&&C.getAttribute("id")==I)return L=C,!0}),L},getElementsByClassName:function(I){var L=o(I);return new Z(this,function(C){var D=[];return L.length>0&&xe(C.documentElement,function(N){if(N!==C&&N.nodeType===c){var W=N.getAttribute("class");if(W){var ae=I===W;if(!ae){var ce=o(W);ae=L.every(a(ce))}ae&&D.push(N)}}}),D})},createElement:function(I){var L=new ht;L.ownerDocument=this,L.nodeName=I,L.tagName=I,L.localName=I,L.childNodes=new X;var C=L.attributes=new oe;return C._ownerElement=L,L},createDocumentFragment:function(){var I=new He;return I.ownerDocument=this,I.childNodes=new X,I},createTextNode:function(I){var L=new gn;return L.ownerDocument=this,L.appendData(I),L},createComment:function(I){var L=new Bs;return L.ownerDocument=this,L.appendData(I),L},createCDATASection:function(I){var L=new $n;return L.ownerDocument=this,L.appendData(I),L},createProcessingInstruction:function(I,L){var C=new Kr;return C.ownerDocument=this,C.tagName=C.nodeName=C.target=I,C.nodeValue=C.data=L,C},createAttribute:function(I){var L=new pn;return L.ownerDocument=this,L.name=I,L.nodeName=I,L.localName=I,L.specified=!0,L},createEntityReference:function(I){var L=new ur;return L.ownerDocument=this,L.nodeName=I,L},createElementNS:function(I,L){var C=new ht,D=L.split(":"),N=C.attributes=new oe;return C.childNodes=new X,C.ownerDocument=this,C.nodeName=L,C.tagName=L,C.namespaceURI=I,D.length==2?(C.prefix=D[0],C.localName=D[1]):C.localName=L,N._ownerElement=C,C},createAttributeNS:function(I,L){var C=new pn,D=L.split(":");return C.ownerDocument=this,C.nodeName=L,C.name=L,C.namespaceURI=I,C.specified=!0,D.length==2?(C.prefix=D[0],C.localName=D[1]):C.localName=L,C}},h(Pe,ne);function ht(){this._nsMap={}}ht.prototype={nodeType:c,hasAttribute:function(I){return this.getAttributeNode(I)!=null},getAttribute:function(I){var L=this.getAttributeNode(I);return L&&L.value||""},getAttributeNode:function(I){return this.attributes.getNamedItem(I)},setAttribute:function(I,L){var C=this.ownerDocument.createAttribute(I);C.value=C.nodeValue=""+L,this.setAttributeNode(C)},removeAttribute:function(I){var L=this.getAttributeNode(I);L&&this.removeAttributeNode(L)},appendChild:function(I){return I.nodeType===k?this.insertBefore(I,null):lt(this,I)},setAttributeNode:function(I){return this.attributes.setNamedItem(I)},setAttributeNodeNS:function(I){return this.attributes.setNamedItemNS(I)},removeAttributeNode:function(I){return this.attributes.removeNamedItem(I.nodeName)},removeAttributeNS:function(I,L){var C=this.getAttributeNodeNS(I,L);C&&this.removeAttributeNode(C)},hasAttributeNS:function(I,L){return this.getAttributeNodeNS(I,L)!=null},getAttributeNS:function(I,L){var C=this.getAttributeNodeNS(I,L);return C&&C.value||""},setAttributeNS:function(I,L,C){var D=this.ownerDocument.createAttributeNS(I,L);D.value=D.nodeValue=""+C,this.setAttributeNode(D)},getAttributeNodeNS:function(I,L){return this.attributes.getNamedItemNS(I,L)},getElementsByTagName:function(I){return new Z(this,function(L){var C=[];return xe(L,function(D){D!==L&&D.nodeType==c&&(I==="*"||D.tagName==I)&&C.push(D)}),C})},getElementsByTagNameNS:function(I,L){return new Z(this,function(C){var D=[];return xe(C,function(N){N!==C&&N.nodeType===c&&(I==="*"||N.namespaceURI===I)&&(L==="*"||N.localName==L)&&D.push(N)}),D})}},Pe.prototype.getElementsByTagName=ht.prototype.getElementsByTagName,Pe.prototype.getElementsByTagNameNS=ht.prototype.getElementsByTagNameNS,h(ht,ne);function pn(){}pn.prototype.nodeType=f,h(pn,ne);function mn(){}mn.prototype={data:"",substringData:function(I,L){return this.data.substring(I,I+L)},appendData:function(I){I=this.data+I,this.nodeValue=this.data=I,this.length=I.length},insertData:function(I,L){this.replaceData(I,0,L)},appendChild:function(I){throw new Error(B[P])},deleteData:function(I,L){this.replaceData(I,L,"")},replaceData:function(I,L,C){var D=this.data.substring(0,I),N=this.data.substring(I+L);C=D+C+N,this.nodeValue=this.data=C,this.length=C.length}},h(mn,ne);function gn(){}gn.prototype={nodeName:"#text",nodeType:p,splitText:function(I){var L=this.data,C=L.substring(I);L=L.substring(0,I),this.data=this.nodeValue=L,this.length=L.length;var D=this.ownerDocument.createTextNode(C);return this.parentNode&&this.parentNode.insertBefore(D,this.nextSibling),D}},h(gn,mn);function Bs(){}Bs.prototype={nodeName:"#comment",nodeType:w},h(Bs,mn);function $n(){}$n.prototype={nodeName:"#cdata-section",nodeType:b},h($n,mn);function Kn(){}Kn.prototype.nodeType=S,h(Kn,ne);function hr(){}hr.prototype.nodeType=A,h(hr,ne);function Gr(){}Gr.prototype.nodeType=_,h(Gr,ne);function ur(){}ur.prototype.nodeType=y,h(ur,ne);function He(){}He.prototype.nodeName="#document-fragment",He.prototype.nodeType=k,h(He,ne);function Kr(){}Kr.prototype.nodeType=T,h(Kr,ne);function Ns(){}Ns.prototype.serializeToString=function(I,L,C){return ot.call(I,L,C)},ne.prototype.toString=ot;function ot(I,L){var C=[],D=this.nodeType==9&&this.documentElement||this,N=D.prefix,W=D.namespaceURI;if(W&&N==null){var N=D.lookupPrefix(W);if(N==null)var ae=[{namespace:W,prefix:null}]}return Jn(this,C,I,L,ae),C.join("")}function cr(I,L,C){var D=I.prefix||"",N=I.namespaceURI;if(!N||D==="xml"&&N===t.XML||N===t.XMLNS)return!1;for(var W=C.length;W--;){var ae=C[W];if(ae.prefix===D)return ae.namespace!==N}return!0}function Fs(I,L,C){I.push(" ",L,'="',C.replace(/[<>&"\t\n\r]/g,ve),'"')}function Jn(I,L,C,D,N){if(N||(N=[]),D)if(I=D(I),I){if(typeof I=="string"){L.push(I);return}}else return;switch(I.nodeType){case c:var W=I.attributes,ae=W.length,We=I.firstChild,ce=I.tagName;C=t.isHTML(I.namespaceURI)||C;var Ee=ce;if(!C&&!I.prefix&&I.namespaceURI){for(var Oe,Me=0;Me<W.length;Me++)if(W.item(Me).name==="xmlns"){Oe=W.item(Me).value;break}if(!Oe)for(var me=N.length-1;me>=0;me--){var Te=N[me];if(Te.prefix===""&&Te.namespace===I.namespaceURI){Oe=Te.namespace;break}}if(Oe!==I.namespaceURI)for(var me=N.length-1;me>=0;me--){var Te=N[me];if(Te.namespace===I.namespaceURI){Te.prefix&&(Ee=Te.prefix+":"+ce);break}}}L.push("<",Ee);for(var Re=0;Re<ae;Re++){var wt=W.item(Re);wt.prefix=="xmlns"?N.push({prefix:wt.localName,namespace:wt.value}):wt.nodeName=="xmlns"&&N.push({prefix:"",namespace:wt.value})}for(var Re=0;Re<ae;Re++){var wt=W.item(Re);if(cr(wt,C,N)){var _t=wt.prefix||"",fi=wt.namespaceURI;Fs(L,_t?"xmlns:"+_t:"xmlns",fi),N.push({prefix:_t,namespace:fi})}Jn(wt,L,C,D,N)}if(ce===Ee&&cr(I,C,N)){var _t=I.prefix||"",fi=I.namespaceURI;Fs(L,_t?"xmlns:"+_t:"xmlns",fi),N.push({prefix:_t,namespace:fi})}if(We||C&&!/^(?:meta|link|img|br|hr|input)$/i.test(ce)){if(L.push(">"),C&&/^script$/i.test(ce))for(;We;)We.data?L.push(We.data):Jn(We,L,C,D,N.slice()),We=We.nextSibling;else for(;We;)Jn(We,L,C,D,N.slice()),We=We.nextSibling;L.push("</",Ee,">")}else L.push("/>");return;case v:case k:for(var We=I.firstChild;We;)Jn(We,L,C,D,N.slice()),We=We.nextSibling;return;case f:return Fs(L,I.name,I.value);case p:return L.push(I.data.replace(/[<&>]/g,ve));case b:return L.push("<![CDATA[",I.data,"]]>");case w:return L.push("<!--",I.data,"-->");case S:var qs=I.publicId,je=I.systemId;if(L.push("<!DOCTYPE ",I.name),qs)L.push(" PUBLIC ",qs),je&&je!="."&&L.push(" ",je),L.push(">");else if(je&&je!=".")L.push(" SYSTEM ",je,">");else{var Uo=I.internalSubset;Uo&&L.push(" [",Uo,"]"),L.push(">")}return;case T:return L.push("<?",I.target," ",I.data,"?>");case y:return L.push("&",I.nodeName,";");default:L.push("??",I.nodeName)}}function Vs(I,L,C){var D;switch(L.nodeType){case c:D=L.cloneNode(!1),D.ownerDocument=I;case k:break;case f:C=!0;break}if(D||(D=L.cloneNode(!1)),D.ownerDocument=I,D.parentNode=null,C)for(var N=L.firstChild;N;)D.appendChild(Vs(I,N,C)),N=N.nextSibling;return D}function Us(I,L,C){var D=new L.constructor;for(var N in L)if(Object.prototype.hasOwnProperty.call(L,N)){var W=L[N];typeof W!="object"&&W!=D[N]&&(D[N]=W)}switch(L.childNodes&&(D.childNodes=new X),D.ownerDocument=I,D.nodeType){case c:var ae=L.attributes,ce=D.attributes=new oe,Ee=ae.length;ce._ownerElement=D;for(var Oe=0;Oe<Ee;Oe++)D.setAttributeNode(Us(I,ae.item(Oe),!0));break;case f:C=!0}if(C)for(var Me=L.firstChild;Me;)D.appendChild(Us(I,Me,C)),Me=Me.nextSibling;return D}function Ni(I,L,C){I[L]=C}try{if(Object.defineProperty){let I=function(L){switch(L.nodeType){case c:case k:var C=[];for(L=L.firstChild;L;)L.nodeType!==7&&L.nodeType!==8&&C.push(I(L)),L=L.nextSibling;return C.join("");default:return L.nodeValue}};Object.defineProperty(Z.prototype,"length",{get:function(){return K(this),this.$$length}}),Object.defineProperty(ne.prototype,"textContent",{get:function(){return I(this)},set:function(L){switch(this.nodeType){case c:case k:for(;this.firstChild;)this.removeChild(this.firstChild);(L||String(L))&&this.appendChild(this.ownerDocument.createTextNode(L));break;default:this.data=L,this.value=L,this.nodeValue=L}}}),Ni=function(L,C,D){L["$$"+C]=D}}}catch{}return Hs.DocumentType=Kn,Hs.DOMException=z,Hs.DOMImplementation=re,Hs.Element=ht,Hs.Node=ne,Hs.NodeList=X,Hs.XMLSerializer=Ns,Hs}var $l={},om={},V1;function Y5(){return V1||(V1=1,(function(n){var e=Ff().freeze;n.XML_ENTITIES=e({amp:"&",apos:"'",gt:">",lt:"<",quot:'"'}),n.HTML_ENTITIES=e({Aacute:"Á",aacute:"á",Abreve:"Ă",abreve:"ă",ac:"∾",acd:"∿",acE:"∾̳",Acirc:"Â",acirc:"â",acute:"´",Acy:"А",acy:"а",AElig:"Æ",aelig:"æ",af:"⁡",Afr:"𝔄",afr:"𝔞",Agrave:"À",agrave:"à",alefsym:"ℵ",aleph:"ℵ",Alpha:"Α",alpha:"α",Amacr:"Ā",amacr:"ā",amalg:"⨿",AMP:"&",amp:"&",And:"⩓",and:"∧",andand:"⩕",andd:"⩜",andslope:"⩘",andv:"⩚",ang:"∠",ange:"⦤",angle:"∠",angmsd:"∡",angmsdaa:"⦨",angmsdab:"⦩",angmsdac:"⦪",angmsdad:"⦫",angmsdae:"⦬",angmsdaf:"⦭",angmsdag:"⦮",angmsdah:"⦯",angrt:"∟",angrtvb:"⊾",angrtvbd:"⦝",angsph:"∢",angst:"Å",angzarr:"⍼",Aogon:"Ą",aogon:"ą",Aopf:"𝔸",aopf:"𝕒",ap:"≈",apacir:"⩯",apE:"⩰",ape:"≊",apid:"≋",apos:"'",ApplyFunction:"⁡",approx:"≈",approxeq:"≊",Aring:"Å",aring:"å",Ascr:"𝒜",ascr:"𝒶",Assign:"≔",ast:"*",asymp:"≈",asympeq:"≍",Atilde:"Ã",atilde:"ã",Auml:"Ä",auml:"ä",awconint:"∳",awint:"⨑",backcong:"≌",backepsilon:"϶",backprime:"‵",backsim:"∽",backsimeq:"⋍",Backslash:"∖",Barv:"⫧",barvee:"⊽",Barwed:"⌆",barwed:"⌅",barwedge:"⌅",bbrk:"⎵",bbrktbrk:"⎶",bcong:"≌",Bcy:"Б",bcy:"б",bdquo:"„",becaus:"∵",Because:"∵",because:"∵",bemptyv:"⦰",bepsi:"϶",bernou:"ℬ",Bernoullis:"ℬ",Beta:"Β",beta:"β",beth:"ℶ",between:"≬",Bfr:"𝔅",bfr:"𝔟",bigcap:"⋂",bigcirc:"◯",bigcup:"⋃",bigodot:"⨀",bigoplus:"⨁",bigotimes:"⨂",bigsqcup:"⨆",bigstar:"★",bigtriangledown:"▽",bigtriangleup:"△",biguplus:"⨄",bigvee:"⋁",bigwedge:"⋀",bkarow:"⤍",blacklozenge:"⧫",blacksquare:"▪",blacktriangle:"▴",blacktriangledown:"▾",blacktriangleleft:"◂",blacktriangleright:"▸",blank:"␣",blk12:"▒",blk14:"░",blk34:"▓",block:"█",bne:"=⃥",bnequiv:"≡⃥",bNot:"⫭",bnot:"⌐",Bopf:"𝔹",bopf:"𝕓",bot:"⊥",bottom:"⊥",bowtie:"⋈",boxbox:"⧉",boxDL:"╗",boxDl:"╖",boxdL:"╕",boxdl:"┐",boxDR:"╔",boxDr:"╓",boxdR:"╒",boxdr:"┌",boxH:"═",boxh:"─",boxHD:"╦",boxHd:"╤",boxhD:"╥",boxhd:"┬",boxHU:"╩",boxHu:"╧",boxhU:"╨",boxhu:"┴",boxminus:"⊟",boxplus:"⊞",boxtimes:"⊠",boxUL:"╝",boxUl:"╜",boxuL:"╛",boxul:"┘",boxUR:"╚",boxUr:"╙",boxuR:"╘",boxur:"└",boxV:"║",boxv:"│",boxVH:"╬",boxVh:"╫",boxvH:"╪",boxvh:"┼",boxVL:"╣",boxVl:"╢",boxvL:"╡",boxvl:"┤",boxVR:"╠",boxVr:"╟",boxvR:"╞",boxvr:"├",bprime:"‵",Breve:"˘",breve:"˘",brvbar:"¦",Bscr:"ℬ",bscr:"𝒷",bsemi:"⁏",bsim:"∽",bsime:"⋍",bsol:"\\",bsolb:"⧅",bsolhsub:"⟈",bull:"•",bullet:"•",bump:"≎",bumpE:"⪮",bumpe:"≏",Bumpeq:"≎",bumpeq:"≏",Cacute:"Ć",cacute:"ć",Cap:"⋒",cap:"∩",capand:"⩄",capbrcup:"⩉",capcap:"⩋",capcup:"⩇",capdot:"⩀",CapitalDifferentialD:"ⅅ",caps:"∩︀",caret:"⁁",caron:"ˇ",Cayleys:"ℭ",ccaps:"⩍",Ccaron:"Č",ccaron:"č",Ccedil:"Ç",ccedil:"ç",Ccirc:"Ĉ",ccirc:"ĉ",Cconint:"∰",ccups:"⩌",ccupssm:"⩐",Cdot:"Ċ",cdot:"ċ",cedil:"¸",Cedilla:"¸",cemptyv:"⦲",cent:"¢",CenterDot:"·",centerdot:"·",Cfr:"ℭ",cfr:"𝔠",CHcy:"Ч",chcy:"ч",check:"✓",checkmark:"✓",Chi:"Χ",chi:"χ",cir:"○",circ:"ˆ",circeq:"≗",circlearrowleft:"↺",circlearrowright:"↻",circledast:"⊛",circledcirc:"⊚",circleddash:"⊝",CircleDot:"⊙",circledR:"®",circledS:"Ⓢ",CircleMinus:"⊖",CirclePlus:"⊕",CircleTimes:"⊗",cirE:"⧃",cire:"≗",cirfnint:"⨐",cirmid:"⫯",cirscir:"⧂",ClockwiseContourIntegral:"∲",CloseCurlyDoubleQuote:"”",CloseCurlyQuote:"’",clubs:"♣",clubsuit:"♣",Colon:"∷",colon:":",Colone:"⩴",colone:"≔",coloneq:"≔",comma:",",commat:"@",comp:"∁",compfn:"∘",complement:"∁",complexes:"ℂ",cong:"≅",congdot:"⩭",Congruent:"≡",Conint:"∯",conint:"∮",ContourIntegral:"∮",Copf:"ℂ",copf:"𝕔",coprod:"∐",Coproduct:"∐",COPY:"©",copy:"©",copysr:"℗",CounterClockwiseContourIntegral:"∳",crarr:"↵",Cross:"⨯",cross:"✗",Cscr:"𝒞",cscr:"𝒸",csub:"⫏",csube:"⫑",csup:"⫐",csupe:"⫒",ctdot:"⋯",cudarrl:"⤸",cudarrr:"⤵",cuepr:"⋞",cuesc:"⋟",cularr:"↶",cularrp:"⤽",Cup:"⋓",cup:"∪",cupbrcap:"⩈",CupCap:"≍",cupcap:"⩆",cupcup:"⩊",cupdot:"⊍",cupor:"⩅",cups:"∪︀",curarr:"↷",curarrm:"⤼",curlyeqprec:"⋞",curlyeqsucc:"⋟",curlyvee:"⋎",curlywedge:"⋏",curren:"¤",curvearrowleft:"↶",curvearrowright:"↷",cuvee:"⋎",cuwed:"⋏",cwconint:"∲",cwint:"∱",cylcty:"⌭",Dagger:"‡",dagger:"†",daleth:"ℸ",Darr:"↡",dArr:"⇓",darr:"↓",dash:"‐",Dashv:"⫤",dashv:"⊣",dbkarow:"⤏",dblac:"˝",Dcaron:"Ď",dcaron:"ď",Dcy:"Д",dcy:"д",DD:"ⅅ",dd:"ⅆ",ddagger:"‡",ddarr:"⇊",DDotrahd:"⤑",ddotseq:"⩷",deg:"°",Del:"∇",Delta:"Δ",delta:"δ",demptyv:"⦱",dfisht:"⥿",Dfr:"𝔇",dfr:"𝔡",dHar:"⥥",dharl:"⇃",dharr:"⇂",DiacriticalAcute:"´",DiacriticalDot:"˙",DiacriticalDoubleAcute:"˝",DiacriticalGrave:"`",DiacriticalTilde:"˜",diam:"⋄",Diamond:"⋄",diamond:"⋄",diamondsuit:"♦",diams:"♦",die:"¨",DifferentialD:"ⅆ",digamma:"ϝ",disin:"⋲",div:"÷",divide:"÷",divideontimes:"⋇",divonx:"⋇",DJcy:"Ђ",djcy:"ђ",dlcorn:"⌞",dlcrop:"⌍",dollar:"$",Dopf:"𝔻",dopf:"𝕕",Dot:"¨",dot:"˙",DotDot:"⃜",doteq:"≐",doteqdot:"≑",DotEqual:"≐",dotminus:"∸",dotplus:"∔",dotsquare:"⊡",doublebarwedge:"⌆",DoubleContourIntegral:"∯",DoubleDot:"¨",DoubleDownArrow:"⇓",DoubleLeftArrow:"⇐",DoubleLeftRightArrow:"⇔",DoubleLeftTee:"⫤",DoubleLongLeftArrow:"⟸",DoubleLongLeftRightArrow:"⟺",DoubleLongRightArrow:"⟹",DoubleRightArrow:"⇒",DoubleRightTee:"⊨",DoubleUpArrow:"⇑",DoubleUpDownArrow:"⇕",DoubleVerticalBar:"∥",DownArrow:"↓",Downarrow:"⇓",downarrow:"↓",DownArrowBar:"⤓",DownArrowUpArrow:"⇵",DownBreve:"̑",downdownarrows:"⇊",downharpoonleft:"⇃",downharpoonright:"⇂",DownLeftRightVector:"⥐",DownLeftTeeVector:"⥞",DownLeftVector:"↽",DownLeftVectorBar:"⥖",DownRightTeeVector:"⥟",DownRightVector:"⇁",DownRightVectorBar:"⥗",DownTee:"⊤",DownTeeArrow:"↧",drbkarow:"⤐",drcorn:"⌟",drcrop:"⌌",Dscr:"𝒟",dscr:"𝒹",DScy:"Ѕ",dscy:"ѕ",dsol:"⧶",Dstrok:"Đ",dstrok:"đ",dtdot:"⋱",dtri:"▿",dtrif:"▾",duarr:"⇵",duhar:"⥯",dwangle:"⦦",DZcy:"Џ",dzcy:"џ",dzigrarr:"⟿",Eacute:"É",eacute:"é",easter:"⩮",Ecaron:"Ě",ecaron:"ě",ecir:"≖",Ecirc:"Ê",ecirc:"ê",ecolon:"≕",Ecy:"Э",ecy:"э",eDDot:"⩷",Edot:"Ė",eDot:"≑",edot:"ė",ee:"ⅇ",efDot:"≒",Efr:"𝔈",efr:"𝔢",eg:"⪚",Egrave:"È",egrave:"è",egs:"⪖",egsdot:"⪘",el:"⪙",Element:"∈",elinters:"⏧",ell:"ℓ",els:"⪕",elsdot:"⪗",Emacr:"Ē",emacr:"ē",empty:"∅",emptyset:"∅",EmptySmallSquare:"◻",emptyv:"∅",EmptyVerySmallSquare:"▫",emsp:" ",emsp13:" ",emsp14:" ",ENG:"Ŋ",eng:"ŋ",ensp:" ",Eogon:"Ę",eogon:"ę",Eopf:"𝔼",eopf:"𝕖",epar:"⋕",eparsl:"⧣",eplus:"⩱",epsi:"ε",Epsilon:"Ε",epsilon:"ε",epsiv:"ϵ",eqcirc:"≖",eqcolon:"≕",eqsim:"≂",eqslantgtr:"⪖",eqslantless:"⪕",Equal:"⩵",equals:"=",EqualTilde:"≂",equest:"≟",Equilibrium:"⇌",equiv:"≡",equivDD:"⩸",eqvparsl:"⧥",erarr:"⥱",erDot:"≓",Escr:"ℰ",escr:"ℯ",esdot:"≐",Esim:"⩳",esim:"≂",Eta:"Η",eta:"η",ETH:"Ð",eth:"ð",Euml:"Ë",euml:"ë",euro:"€",excl:"!",exist:"∃",Exists:"∃",expectation:"ℰ",ExponentialE:"ⅇ",exponentiale:"ⅇ",fallingdotseq:"≒",Fcy:"Ф",fcy:"ф",female:"♀",ffilig:"ﬃ",fflig:"ﬀ",ffllig:"ﬄ",Ffr:"𝔉",ffr:"𝔣",filig:"ﬁ",FilledSmallSquare:"◼",FilledVerySmallSquare:"▪",fjlig:"fj",flat:"♭",fllig:"ﬂ",fltns:"▱",fnof:"ƒ",Fopf:"𝔽",fopf:"𝕗",ForAll:"∀",forall:"∀",fork:"⋔",forkv:"⫙",Fouriertrf:"ℱ",fpartint:"⨍",frac12:"½",frac13:"⅓",frac14:"¼",frac15:"⅕",frac16:"⅙",frac18:"⅛",frac23:"⅔",frac25:"⅖",frac34:"¾",frac35:"⅗",frac38:"⅜",frac45:"⅘",frac56:"⅚",frac58:"⅝",frac78:"⅞",frasl:"⁄",frown:"⌢",Fscr:"ℱ",fscr:"𝒻",gacute:"ǵ",Gamma:"Γ",gamma:"γ",Gammad:"Ϝ",gammad:"ϝ",gap:"⪆",Gbreve:"Ğ",gbreve:"ğ",Gcedil:"Ģ",Gcirc:"Ĝ",gcirc:"ĝ",Gcy:"Г",gcy:"г",Gdot:"Ġ",gdot:"ġ",gE:"≧",ge:"≥",gEl:"⪌",gel:"⋛",geq:"≥",geqq:"≧",geqslant:"⩾",ges:"⩾",gescc:"⪩",gesdot:"⪀",gesdoto:"⪂",gesdotol:"⪄",gesl:"⋛︀",gesles:"⪔",Gfr:"𝔊",gfr:"𝔤",Gg:"⋙",gg:"≫",ggg:"⋙",gimel:"ℷ",GJcy:"Ѓ",gjcy:"ѓ",gl:"≷",gla:"⪥",glE:"⪒",glj:"⪤",gnap:"⪊",gnapprox:"⪊",gnE:"≩",gne:"⪈",gneq:"⪈",gneqq:"≩",gnsim:"⋧",Gopf:"𝔾",gopf:"𝕘",grave:"`",GreaterEqual:"≥",GreaterEqualLess:"⋛",GreaterFullEqual:"≧",GreaterGreater:"⪢",GreaterLess:"≷",GreaterSlantEqual:"⩾",GreaterTilde:"≳",Gscr:"𝒢",gscr:"ℊ",gsim:"≳",gsime:"⪎",gsiml:"⪐",Gt:"≫",GT:">",gt:">",gtcc:"⪧",gtcir:"⩺",gtdot:"⋗",gtlPar:"⦕",gtquest:"⩼",gtrapprox:"⪆",gtrarr:"⥸",gtrdot:"⋗",gtreqless:"⋛",gtreqqless:"⪌",gtrless:"≷",gtrsim:"≳",gvertneqq:"≩︀",gvnE:"≩︀",Hacek:"ˇ",hairsp:" ",half:"½",hamilt:"ℋ",HARDcy:"Ъ",hardcy:"ъ",hArr:"⇔",harr:"↔",harrcir:"⥈",harrw:"↭",Hat:"^",hbar:"ℏ",Hcirc:"Ĥ",hcirc:"ĥ",hearts:"♥",heartsuit:"♥",hellip:"…",hercon:"⊹",Hfr:"ℌ",hfr:"𝔥",HilbertSpace:"ℋ",hksearow:"⤥",hkswarow:"⤦",hoarr:"⇿",homtht:"∻",hookleftarrow:"↩",hookrightarrow:"↪",Hopf:"ℍ",hopf:"𝕙",horbar:"―",HorizontalLine:"─",Hscr:"ℋ",hscr:"𝒽",hslash:"ℏ",Hstrok:"Ħ",hstrok:"ħ",HumpDownHump:"≎",HumpEqual:"≏",hybull:"⁃",hyphen:"‐",Iacute:"Í",iacute:"í",ic:"⁣",Icirc:"Î",icirc:"î",Icy:"И",icy:"и",Idot:"İ",IEcy:"Е",iecy:"е",iexcl:"¡",iff:"⇔",Ifr:"ℑ",ifr:"𝔦",Igrave:"Ì",igrave:"ì",ii:"ⅈ",iiiint:"⨌",iiint:"∭",iinfin:"⧜",iiota:"℩",IJlig:"Ĳ",ijlig:"ĳ",Im:"ℑ",Imacr:"Ī",imacr:"ī",image:"ℑ",ImaginaryI:"ⅈ",imagline:"ℐ",imagpart:"ℑ",imath:"ı",imof:"⊷",imped:"Ƶ",Implies:"⇒",in:"∈",incare:"℅",infin:"∞",infintie:"⧝",inodot:"ı",Int:"∬",int:"∫",intcal:"⊺",integers:"ℤ",Integral:"∫",intercal:"⊺",Intersection:"⋂",intlarhk:"⨗",intprod:"⨼",InvisibleComma:"⁣",InvisibleTimes:"⁢",IOcy:"Ё",iocy:"ё",Iogon:"Į",iogon:"į",Iopf:"𝕀",iopf:"𝕚",Iota:"Ι",iota:"ι",iprod:"⨼",iquest:"¿",Iscr:"ℐ",iscr:"𝒾",isin:"∈",isindot:"⋵",isinE:"⋹",isins:"⋴",isinsv:"⋳",isinv:"∈",it:"⁢",Itilde:"Ĩ",itilde:"ĩ",Iukcy:"І",iukcy:"і",Iuml:"Ï",iuml:"ï",Jcirc:"Ĵ",jcirc:"ĵ",Jcy:"Й",jcy:"й",Jfr:"𝔍",jfr:"𝔧",jmath:"ȷ",Jopf:"𝕁",jopf:"𝕛",Jscr:"𝒥",jscr:"𝒿",Jsercy:"Ј",jsercy:"ј",Jukcy:"Є",jukcy:"є",Kappa:"Κ",kappa:"κ",kappav:"ϰ",Kcedil:"Ķ",kcedil:"ķ",Kcy:"К",kcy:"к",Kfr:"𝔎",kfr:"𝔨",kgreen:"ĸ",KHcy:"Х",khcy:"х",KJcy:"Ќ",kjcy:"ќ",Kopf:"𝕂",kopf:"𝕜",Kscr:"𝒦",kscr:"𝓀",lAarr:"⇚",Lacute:"Ĺ",lacute:"ĺ",laemptyv:"⦴",lagran:"ℒ",Lambda:"Λ",lambda:"λ",Lang:"⟪",lang:"⟨",langd:"⦑",langle:"⟨",lap:"⪅",Laplacetrf:"ℒ",laquo:"«",Larr:"↞",lArr:"⇐",larr:"←",larrb:"⇤",larrbfs:"⤟",larrfs:"⤝",larrhk:"↩",larrlp:"↫",larrpl:"⤹",larrsim:"⥳",larrtl:"↢",lat:"⪫",lAtail:"⤛",latail:"⤙",late:"⪭",lates:"⪭︀",lBarr:"⤎",lbarr:"⤌",lbbrk:"❲",lbrace:"{",lbrack:"[",lbrke:"⦋",lbrksld:"⦏",lbrkslu:"⦍",Lcaron:"Ľ",lcaron:"ľ",Lcedil:"Ļ",lcedil:"ļ",lceil:"⌈",lcub:"{",Lcy:"Л",lcy:"л",ldca:"⤶",ldquo:"“",ldquor:"„",ldrdhar:"⥧",ldrushar:"⥋",ldsh:"↲",lE:"≦",le:"≤",LeftAngleBracket:"⟨",LeftArrow:"←",Leftarrow:"⇐",leftarrow:"←",LeftArrowBar:"⇤",LeftArrowRightArrow:"⇆",leftarrowtail:"↢",LeftCeiling:"⌈",LeftDoubleBracket:"⟦",LeftDownTeeVector:"⥡",LeftDownVector:"⇃",LeftDownVectorBar:"⥙",LeftFloor:"⌊",leftharpoondown:"↽",leftharpoonup:"↼",leftleftarrows:"⇇",LeftRightArrow:"↔",Leftrightarrow:"⇔",leftrightarrow:"↔",leftrightarrows:"⇆",leftrightharpoons:"⇋",leftrightsquigarrow:"↭",LeftRightVector:"⥎",LeftTee:"⊣",LeftTeeArrow:"↤",LeftTeeVector:"⥚",leftthreetimes:"⋋",LeftTriangle:"⊲",LeftTriangleBar:"⧏",LeftTriangleEqual:"⊴",LeftUpDownVector:"⥑",LeftUpTeeVector:"⥠",LeftUpVector:"↿",LeftUpVectorBar:"⥘",LeftVector:"↼",LeftVectorBar:"⥒",lEg:"⪋",leg:"⋚",leq:"≤",leqq:"≦",leqslant:"⩽",les:"⩽",lescc:"⪨",lesdot:"⩿",lesdoto:"⪁",lesdotor:"⪃",lesg:"⋚︀",lesges:"⪓",lessapprox:"⪅",lessdot:"⋖",lesseqgtr:"⋚",lesseqqgtr:"⪋",LessEqualGreater:"⋚",LessFullEqual:"≦",LessGreater:"≶",lessgtr:"≶",LessLess:"⪡",lesssim:"≲",LessSlantEqual:"⩽",LessTilde:"≲",lfisht:"⥼",lfloor:"⌊",Lfr:"𝔏",lfr:"𝔩",lg:"≶",lgE:"⪑",lHar:"⥢",lhard:"↽",lharu:"↼",lharul:"⥪",lhblk:"▄",LJcy:"Љ",ljcy:"љ",Ll:"⋘",ll:"≪",llarr:"⇇",llcorner:"⌞",Lleftarrow:"⇚",llhard:"⥫",lltri:"◺",Lmidot:"Ŀ",lmidot:"ŀ",lmoust:"⎰",lmoustache:"⎰",lnap:"⪉",lnapprox:"⪉",lnE:"≨",lne:"⪇",lneq:"⪇",lneqq:"≨",lnsim:"⋦",loang:"⟬",loarr:"⇽",lobrk:"⟦",LongLeftArrow:"⟵",Longleftarrow:"⟸",longleftarrow:"⟵",LongLeftRightArrow:"⟷",Longleftrightarrow:"⟺",longleftrightarrow:"⟷",longmapsto:"⟼",LongRightArrow:"⟶",Longrightarrow:"⟹",longrightarrow:"⟶",looparrowleft:"↫",looparrowright:"↬",lopar:"⦅",Lopf:"𝕃",lopf:"𝕝",loplus:"⨭",lotimes:"⨴",lowast:"∗",lowbar:"_",LowerLeftArrow:"↙",LowerRightArrow:"↘",loz:"◊",lozenge:"◊",lozf:"⧫",lpar:"(",lparlt:"⦓",lrarr:"⇆",lrcorner:"⌟",lrhar:"⇋",lrhard:"⥭",lrm:"‎",lrtri:"⊿",lsaquo:"‹",Lscr:"ℒ",lscr:"𝓁",Lsh:"↰",lsh:"↰",lsim:"≲",lsime:"⪍",lsimg:"⪏",lsqb:"[",lsquo:"‘",lsquor:"‚",Lstrok:"Ł",lstrok:"ł",Lt:"≪",LT:"<",lt:"<",ltcc:"⪦",ltcir:"⩹",ltdot:"⋖",lthree:"⋋",ltimes:"⋉",ltlarr:"⥶",ltquest:"⩻",ltri:"◃",ltrie:"⊴",ltrif:"◂",ltrPar:"⦖",lurdshar:"⥊",luruhar:"⥦",lvertneqq:"≨︀",lvnE:"≨︀",macr:"¯",male:"♂",malt:"✠",maltese:"✠",Map:"⤅",map:"↦",mapsto:"↦",mapstodown:"↧",mapstoleft:"↤",mapstoup:"↥",marker:"▮",mcomma:"⨩",Mcy:"М",mcy:"м",mdash:"—",mDDot:"∺",measuredangle:"∡",MediumSpace:" ",Mellintrf:"ℳ",Mfr:"𝔐",mfr:"𝔪",mho:"℧",micro:"µ",mid:"∣",midast:"*",midcir:"⫰",middot:"·",minus:"−",minusb:"⊟",minusd:"∸",minusdu:"⨪",MinusPlus:"∓",mlcp:"⫛",mldr:"…",mnplus:"∓",models:"⊧",Mopf:"𝕄",mopf:"𝕞",mp:"∓",Mscr:"ℳ",mscr:"𝓂",mstpos:"∾",Mu:"Μ",mu:"μ",multimap:"⊸",mumap:"⊸",nabla:"∇",Nacute:"Ń",nacute:"ń",nang:"∠⃒",nap:"≉",napE:"⩰̸",napid:"≋̸",napos:"ŉ",napprox:"≉",natur:"♮",natural:"♮",naturals:"ℕ",nbsp:" ",nbump:"≎̸",nbumpe:"≏̸",ncap:"⩃",Ncaron:"Ň",ncaron:"ň",Ncedil:"Ņ",ncedil:"ņ",ncong:"≇",ncongdot:"⩭̸",ncup:"⩂",Ncy:"Н",ncy:"н",ndash:"–",ne:"≠",nearhk:"⤤",neArr:"⇗",nearr:"↗",nearrow:"↗",nedot:"≐̸",NegativeMediumSpace:"​",NegativeThickSpace:"​",NegativeThinSpace:"​",NegativeVeryThinSpace:"​",nequiv:"≢",nesear:"⤨",nesim:"≂̸",NestedGreaterGreater:"≫",NestedLessLess:"≪",NewLine:`
`,nexist:"∄",nexists:"∄",Nfr:"𝔑",nfr:"𝔫",ngE:"≧̸",nge:"≱",ngeq:"≱",ngeqq:"≧̸",ngeqslant:"⩾̸",nges:"⩾̸",nGg:"⋙̸",ngsim:"≵",nGt:"≫⃒",ngt:"≯",ngtr:"≯",nGtv:"≫̸",nhArr:"⇎",nharr:"↮",nhpar:"⫲",ni:"∋",nis:"⋼",nisd:"⋺",niv:"∋",NJcy:"Њ",njcy:"њ",nlArr:"⇍",nlarr:"↚",nldr:"‥",nlE:"≦̸",nle:"≰",nLeftarrow:"⇍",nleftarrow:"↚",nLeftrightarrow:"⇎",nleftrightarrow:"↮",nleq:"≰",nleqq:"≦̸",nleqslant:"⩽̸",nles:"⩽̸",nless:"≮",nLl:"⋘̸",nlsim:"≴",nLt:"≪⃒",nlt:"≮",nltri:"⋪",nltrie:"⋬",nLtv:"≪̸",nmid:"∤",NoBreak:"⁠",NonBreakingSpace:" ",Nopf:"ℕ",nopf:"𝕟",Not:"⫬",not:"¬",NotCongruent:"≢",NotCupCap:"≭",NotDoubleVerticalBar:"∦",NotElement:"∉",NotEqual:"≠",NotEqualTilde:"≂̸",NotExists:"∄",NotGreater:"≯",NotGreaterEqual:"≱",NotGreaterFullEqual:"≧̸",NotGreaterGreater:"≫̸",NotGreaterLess:"≹",NotGreaterSlantEqual:"⩾̸",NotGreaterTilde:"≵",NotHumpDownHump:"≎̸",NotHumpEqual:"≏̸",notin:"∉",notindot:"⋵̸",notinE:"⋹̸",notinva:"∉",notinvb:"⋷",notinvc:"⋶",NotLeftTriangle:"⋪",NotLeftTriangleBar:"⧏̸",NotLeftTriangleEqual:"⋬",NotLess:"≮",NotLessEqual:"≰",NotLessGreater:"≸",NotLessLess:"≪̸",NotLessSlantEqual:"⩽̸",NotLessTilde:"≴",NotNestedGreaterGreater:"⪢̸",NotNestedLessLess:"⪡̸",notni:"∌",notniva:"∌",notnivb:"⋾",notnivc:"⋽",NotPrecedes:"⊀",NotPrecedesEqual:"⪯̸",NotPrecedesSlantEqual:"⋠",NotReverseElement:"∌",NotRightTriangle:"⋫",NotRightTriangleBar:"⧐̸",NotRightTriangleEqual:"⋭",NotSquareSubset:"⊏̸",NotSquareSubsetEqual:"⋢",NotSquareSuperset:"⊐̸",NotSquareSupersetEqual:"⋣",NotSubset:"⊂⃒",NotSubsetEqual:"⊈",NotSucceeds:"⊁",NotSucceedsEqual:"⪰̸",NotSucceedsSlantEqual:"⋡",NotSucceedsTilde:"≿̸",NotSuperset:"⊃⃒",NotSupersetEqual:"⊉",NotTilde:"≁",NotTildeEqual:"≄",NotTildeFullEqual:"≇",NotTildeTilde:"≉",NotVerticalBar:"∤",npar:"∦",nparallel:"∦",nparsl:"⫽⃥",npart:"∂̸",npolint:"⨔",npr:"⊀",nprcue:"⋠",npre:"⪯̸",nprec:"⊀",npreceq:"⪯̸",nrArr:"⇏",nrarr:"↛",nrarrc:"⤳̸",nrarrw:"↝̸",nRightarrow:"⇏",nrightarrow:"↛",nrtri:"⋫",nrtrie:"⋭",nsc:"⊁",nsccue:"⋡",nsce:"⪰̸",Nscr:"𝒩",nscr:"𝓃",nshortmid:"∤",nshortparallel:"∦",nsim:"≁",nsime:"≄",nsimeq:"≄",nsmid:"∤",nspar:"∦",nsqsube:"⋢",nsqsupe:"⋣",nsub:"⊄",nsubE:"⫅̸",nsube:"⊈",nsubset:"⊂⃒",nsubseteq:"⊈",nsubseteqq:"⫅̸",nsucc:"⊁",nsucceq:"⪰̸",nsup:"⊅",nsupE:"⫆̸",nsupe:"⊉",nsupset:"⊃⃒",nsupseteq:"⊉",nsupseteqq:"⫆̸",ntgl:"≹",Ntilde:"Ñ",ntilde:"ñ",ntlg:"≸",ntriangleleft:"⋪",ntrianglelefteq:"⋬",ntriangleright:"⋫",ntrianglerighteq:"⋭",Nu:"Ν",nu:"ν",num:"#",numero:"№",numsp:" ",nvap:"≍⃒",nVDash:"⊯",nVdash:"⊮",nvDash:"⊭",nvdash:"⊬",nvge:"≥⃒",nvgt:">⃒",nvHarr:"⤄",nvinfin:"⧞",nvlArr:"⤂",nvle:"≤⃒",nvlt:"<⃒",nvltrie:"⊴⃒",nvrArr:"⤃",nvrtrie:"⊵⃒",nvsim:"∼⃒",nwarhk:"⤣",nwArr:"⇖",nwarr:"↖",nwarrow:"↖",nwnear:"⤧",Oacute:"Ó",oacute:"ó",oast:"⊛",ocir:"⊚",Ocirc:"Ô",ocirc:"ô",Ocy:"О",ocy:"о",odash:"⊝",Odblac:"Ő",odblac:"ő",odiv:"⨸",odot:"⊙",odsold:"⦼",OElig:"Œ",oelig:"œ",ofcir:"⦿",Ofr:"𝔒",ofr:"𝔬",ogon:"˛",Ograve:"Ò",ograve:"ò",ogt:"⧁",ohbar:"⦵",ohm:"Ω",oint:"∮",olarr:"↺",olcir:"⦾",olcross:"⦻",oline:"‾",olt:"⧀",Omacr:"Ō",omacr:"ō",Omega:"Ω",omega:"ω",Omicron:"Ο",omicron:"ο",omid:"⦶",ominus:"⊖",Oopf:"𝕆",oopf:"𝕠",opar:"⦷",OpenCurlyDoubleQuote:"“",OpenCurlyQuote:"‘",operp:"⦹",oplus:"⊕",Or:"⩔",or:"∨",orarr:"↻",ord:"⩝",order:"ℴ",orderof:"ℴ",ordf:"ª",ordm:"º",origof:"⊶",oror:"⩖",orslope:"⩗",orv:"⩛",oS:"Ⓢ",Oscr:"𝒪",oscr:"ℴ",Oslash:"Ø",oslash:"ø",osol:"⊘",Otilde:"Õ",otilde:"õ",Otimes:"⨷",otimes:"⊗",otimesas:"⨶",Ouml:"Ö",ouml:"ö",ovbar:"⌽",OverBar:"‾",OverBrace:"⏞",OverBracket:"⎴",OverParenthesis:"⏜",par:"∥",para:"¶",parallel:"∥",parsim:"⫳",parsl:"⫽",part:"∂",PartialD:"∂",Pcy:"П",pcy:"п",percnt:"%",period:".",permil:"‰",perp:"⊥",pertenk:"‱",Pfr:"𝔓",pfr:"𝔭",Phi:"Φ",phi:"φ",phiv:"ϕ",phmmat:"ℳ",phone:"☎",Pi:"Π",pi:"π",pitchfork:"⋔",piv:"ϖ",planck:"ℏ",planckh:"ℎ",plankv:"ℏ",plus:"+",plusacir:"⨣",plusb:"⊞",pluscir:"⨢",plusdo:"∔",plusdu:"⨥",pluse:"⩲",PlusMinus:"±",plusmn:"±",plussim:"⨦",plustwo:"⨧",pm:"±",Poincareplane:"ℌ",pointint:"⨕",Popf:"ℙ",popf:"𝕡",pound:"£",Pr:"⪻",pr:"≺",prap:"⪷",prcue:"≼",prE:"⪳",pre:"⪯",prec:"≺",precapprox:"⪷",preccurlyeq:"≼",Precedes:"≺",PrecedesEqual:"⪯",PrecedesSlantEqual:"≼",PrecedesTilde:"≾",preceq:"⪯",precnapprox:"⪹",precneqq:"⪵",precnsim:"⋨",precsim:"≾",Prime:"″",prime:"′",primes:"ℙ",prnap:"⪹",prnE:"⪵",prnsim:"⋨",prod:"∏",Product:"∏",profalar:"⌮",profline:"⌒",profsurf:"⌓",prop:"∝",Proportion:"∷",Proportional:"∝",propto:"∝",prsim:"≾",prurel:"⊰",Pscr:"𝒫",pscr:"𝓅",Psi:"Ψ",psi:"ψ",puncsp:" ",Qfr:"𝔔",qfr:"𝔮",qint:"⨌",Qopf:"ℚ",qopf:"𝕢",qprime:"⁗",Qscr:"𝒬",qscr:"𝓆",quaternions:"ℍ",quatint:"⨖",quest:"?",questeq:"≟",QUOT:'"',quot:'"',rAarr:"⇛",race:"∽̱",Racute:"Ŕ",racute:"ŕ",radic:"√",raemptyv:"⦳",Rang:"⟫",rang:"⟩",rangd:"⦒",range:"⦥",rangle:"⟩",raquo:"»",Rarr:"↠",rArr:"⇒",rarr:"→",rarrap:"⥵",rarrb:"⇥",rarrbfs:"⤠",rarrc:"⤳",rarrfs:"⤞",rarrhk:"↪",rarrlp:"↬",rarrpl:"⥅",rarrsim:"⥴",Rarrtl:"⤖",rarrtl:"↣",rarrw:"↝",rAtail:"⤜",ratail:"⤚",ratio:"∶",rationals:"ℚ",RBarr:"⤐",rBarr:"⤏",rbarr:"⤍",rbbrk:"❳",rbrace:"}",rbrack:"]",rbrke:"⦌",rbrksld:"⦎",rbrkslu:"⦐",Rcaron:"Ř",rcaron:"ř",Rcedil:"Ŗ",rcedil:"ŗ",rceil:"⌉",rcub:"}",Rcy:"Р",rcy:"р",rdca:"⤷",rdldhar:"⥩",rdquo:"”",rdquor:"”",rdsh:"↳",Re:"ℜ",real:"ℜ",realine:"ℛ",realpart:"ℜ",reals:"ℝ",rect:"▭",REG:"®",reg:"®",ReverseElement:"∋",ReverseEquilibrium:"⇋",ReverseUpEquilibrium:"⥯",rfisht:"⥽",rfloor:"⌋",Rfr:"ℜ",rfr:"𝔯",rHar:"⥤",rhard:"⇁",rharu:"⇀",rharul:"⥬",Rho:"Ρ",rho:"ρ",rhov:"ϱ",RightAngleBracket:"⟩",RightArrow:"→",Rightarrow:"⇒",rightarrow:"→",RightArrowBar:"⇥",RightArrowLeftArrow:"⇄",rightarrowtail:"↣",RightCeiling:"⌉",RightDoubleBracket:"⟧",RightDownTeeVector:"⥝",RightDownVector:"⇂",RightDownVectorBar:"⥕",RightFloor:"⌋",rightharpoondown:"⇁",rightharpoonup:"⇀",rightleftarrows:"⇄",rightleftharpoons:"⇌",rightrightarrows:"⇉",rightsquigarrow:"↝",RightTee:"⊢",RightTeeArrow:"↦",RightTeeVector:"⥛",rightthreetimes:"⋌",RightTriangle:"⊳",RightTriangleBar:"⧐",RightTriangleEqual:"⊵",RightUpDownVector:"⥏",RightUpTeeVector:"⥜",RightUpVector:"↾",RightUpVectorBar:"⥔",RightVector:"⇀",RightVectorBar:"⥓",ring:"˚",risingdotseq:"≓",rlarr:"⇄",rlhar:"⇌",rlm:"‏",rmoust:"⎱",rmoustache:"⎱",rnmid:"⫮",roang:"⟭",roarr:"⇾",robrk:"⟧",ropar:"⦆",Ropf:"ℝ",ropf:"𝕣",roplus:"⨮",rotimes:"⨵",RoundImplies:"⥰",rpar:")",rpargt:"⦔",rppolint:"⨒",rrarr:"⇉",Rrightarrow:"⇛",rsaquo:"›",Rscr:"ℛ",rscr:"𝓇",Rsh:"↱",rsh:"↱",rsqb:"]",rsquo:"’",rsquor:"’",rthree:"⋌",rtimes:"⋊",rtri:"▹",rtrie:"⊵",rtrif:"▸",rtriltri:"⧎",RuleDelayed:"⧴",ruluhar:"⥨",rx:"℞",Sacute:"Ś",sacute:"ś",sbquo:"‚",Sc:"⪼",sc:"≻",scap:"⪸",Scaron:"Š",scaron:"š",sccue:"≽",scE:"⪴",sce:"⪰",Scedil:"Ş",scedil:"ş",Scirc:"Ŝ",scirc:"ŝ",scnap:"⪺",scnE:"⪶",scnsim:"⋩",scpolint:"⨓",scsim:"≿",Scy:"С",scy:"с",sdot:"⋅",sdotb:"⊡",sdote:"⩦",searhk:"⤥",seArr:"⇘",searr:"↘",searrow:"↘",sect:"§",semi:";",seswar:"⤩",setminus:"∖",setmn:"∖",sext:"✶",Sfr:"𝔖",sfr:"𝔰",sfrown:"⌢",sharp:"♯",SHCHcy:"Щ",shchcy:"щ",SHcy:"Ш",shcy:"ш",ShortDownArrow:"↓",ShortLeftArrow:"←",shortmid:"∣",shortparallel:"∥",ShortRightArrow:"→",ShortUpArrow:"↑",shy:"­",Sigma:"Σ",sigma:"σ",sigmaf:"ς",sigmav:"ς",sim:"∼",simdot:"⩪",sime:"≃",simeq:"≃",simg:"⪞",simgE:"⪠",siml:"⪝",simlE:"⪟",simne:"≆",simplus:"⨤",simrarr:"⥲",slarr:"←",SmallCircle:"∘",smallsetminus:"∖",smashp:"⨳",smeparsl:"⧤",smid:"∣",smile:"⌣",smt:"⪪",smte:"⪬",smtes:"⪬︀",SOFTcy:"Ь",softcy:"ь",sol:"/",solb:"⧄",solbar:"⌿",Sopf:"𝕊",sopf:"𝕤",spades:"♠",spadesuit:"♠",spar:"∥",sqcap:"⊓",sqcaps:"⊓︀",sqcup:"⊔",sqcups:"⊔︀",Sqrt:"√",sqsub:"⊏",sqsube:"⊑",sqsubset:"⊏",sqsubseteq:"⊑",sqsup:"⊐",sqsupe:"⊒",sqsupset:"⊐",sqsupseteq:"⊒",squ:"□",Square:"□",square:"□",SquareIntersection:"⊓",SquareSubset:"⊏",SquareSubsetEqual:"⊑",SquareSuperset:"⊐",SquareSupersetEqual:"⊒",SquareUnion:"⊔",squarf:"▪",squf:"▪",srarr:"→",Sscr:"𝒮",sscr:"𝓈",ssetmn:"∖",ssmile:"⌣",sstarf:"⋆",Star:"⋆",star:"☆",starf:"★",straightepsilon:"ϵ",straightphi:"ϕ",strns:"¯",Sub:"⋐",sub:"⊂",subdot:"⪽",subE:"⫅",sube:"⊆",subedot:"⫃",submult:"⫁",subnE:"⫋",subne:"⊊",subplus:"⪿",subrarr:"⥹",Subset:"⋐",subset:"⊂",subseteq:"⊆",subseteqq:"⫅",SubsetEqual:"⊆",subsetneq:"⊊",subsetneqq:"⫋",subsim:"⫇",subsub:"⫕",subsup:"⫓",succ:"≻",succapprox:"⪸",succcurlyeq:"≽",Succeeds:"≻",SucceedsEqual:"⪰",SucceedsSlantEqual:"≽",SucceedsTilde:"≿",succeq:"⪰",succnapprox:"⪺",succneqq:"⪶",succnsim:"⋩",succsim:"≿",SuchThat:"∋",Sum:"∑",sum:"∑",sung:"♪",Sup:"⋑",sup:"⊃",sup1:"¹",sup2:"²",sup3:"³",supdot:"⪾",supdsub:"⫘",supE:"⫆",supe:"⊇",supedot:"⫄",Superset:"⊃",SupersetEqual:"⊇",suphsol:"⟉",suphsub:"⫗",suplarr:"⥻",supmult:"⫂",supnE:"⫌",supne:"⊋",supplus:"⫀",Supset:"⋑",supset:"⊃",supseteq:"⊇",supseteqq:"⫆",supsetneq:"⊋",supsetneqq:"⫌",supsim:"⫈",supsub:"⫔",supsup:"⫖",swarhk:"⤦",swArr:"⇙",swarr:"↙",swarrow:"↙",swnwar:"⤪",szlig:"ß",Tab:"	",target:"⌖",Tau:"Τ",tau:"τ",tbrk:"⎴",Tcaron:"Ť",tcaron:"ť",Tcedil:"Ţ",tcedil:"ţ",Tcy:"Т",tcy:"т",tdot:"⃛",telrec:"⌕",Tfr:"𝔗",tfr:"𝔱",there4:"∴",Therefore:"∴",therefore:"∴",Theta:"Θ",theta:"θ",thetasym:"ϑ",thetav:"ϑ",thickapprox:"≈",thicksim:"∼",ThickSpace:"  ",thinsp:" ",ThinSpace:" ",thkap:"≈",thksim:"∼",THORN:"Þ",thorn:"þ",Tilde:"∼",tilde:"˜",TildeEqual:"≃",TildeFullEqual:"≅",TildeTilde:"≈",times:"×",timesb:"⊠",timesbar:"⨱",timesd:"⨰",tint:"∭",toea:"⤨",top:"⊤",topbot:"⌶",topcir:"⫱",Topf:"𝕋",topf:"𝕥",topfork:"⫚",tosa:"⤩",tprime:"‴",TRADE:"™",trade:"™",triangle:"▵",triangledown:"▿",triangleleft:"◃",trianglelefteq:"⊴",triangleq:"≜",triangleright:"▹",trianglerighteq:"⊵",tridot:"◬",trie:"≜",triminus:"⨺",TripleDot:"⃛",triplus:"⨹",trisb:"⧍",tritime:"⨻",trpezium:"⏢",Tscr:"𝒯",tscr:"𝓉",TScy:"Ц",tscy:"ц",TSHcy:"Ћ",tshcy:"ћ",Tstrok:"Ŧ",tstrok:"ŧ",twixt:"≬",twoheadleftarrow:"↞",twoheadrightarrow:"↠",Uacute:"Ú",uacute:"ú",Uarr:"↟",uArr:"⇑",uarr:"↑",Uarrocir:"⥉",Ubrcy:"Ў",ubrcy:"ў",Ubreve:"Ŭ",ubreve:"ŭ",Ucirc:"Û",ucirc:"û",Ucy:"У",ucy:"у",udarr:"⇅",Udblac:"Ű",udblac:"ű",udhar:"⥮",ufisht:"⥾",Ufr:"𝔘",ufr:"𝔲",Ugrave:"Ù",ugrave:"ù",uHar:"⥣",uharl:"↿",uharr:"↾",uhblk:"▀",ulcorn:"⌜",ulcorner:"⌜",ulcrop:"⌏",ultri:"◸",Umacr:"Ū",umacr:"ū",uml:"¨",UnderBar:"_",UnderBrace:"⏟",UnderBracket:"⎵",UnderParenthesis:"⏝",Union:"⋃",UnionPlus:"⊎",Uogon:"Ų",uogon:"ų",Uopf:"𝕌",uopf:"𝕦",UpArrow:"↑",Uparrow:"⇑",uparrow:"↑",UpArrowBar:"⤒",UpArrowDownArrow:"⇅",UpDownArrow:"↕",Updownarrow:"⇕",updownarrow:"↕",UpEquilibrium:"⥮",upharpoonleft:"↿",upharpoonright:"↾",uplus:"⊎",UpperLeftArrow:"↖",UpperRightArrow:"↗",Upsi:"ϒ",upsi:"υ",upsih:"ϒ",Upsilon:"Υ",upsilon:"υ",UpTee:"⊥",UpTeeArrow:"↥",upuparrows:"⇈",urcorn:"⌝",urcorner:"⌝",urcrop:"⌎",Uring:"Ů",uring:"ů",urtri:"◹",Uscr:"𝒰",uscr:"𝓊",utdot:"⋰",Utilde:"Ũ",utilde:"ũ",utri:"▵",utrif:"▴",uuarr:"⇈",Uuml:"Ü",uuml:"ü",uwangle:"⦧",vangrt:"⦜",varepsilon:"ϵ",varkappa:"ϰ",varnothing:"∅",varphi:"ϕ",varpi:"ϖ",varpropto:"∝",vArr:"⇕",varr:"↕",varrho:"ϱ",varsigma:"ς",varsubsetneq:"⊊︀",varsubsetneqq:"⫋︀",varsupsetneq:"⊋︀",varsupsetneqq:"⫌︀",vartheta:"ϑ",vartriangleleft:"⊲",vartriangleright:"⊳",Vbar:"⫫",vBar:"⫨",vBarv:"⫩",Vcy:"В",vcy:"в",VDash:"⊫",Vdash:"⊩",vDash:"⊨",vdash:"⊢",Vdashl:"⫦",Vee:"⋁",vee:"∨",veebar:"⊻",veeeq:"≚",vellip:"⋮",Verbar:"‖",verbar:"|",Vert:"‖",vert:"|",VerticalBar:"∣",VerticalLine:"|",VerticalSeparator:"❘",VerticalTilde:"≀",VeryThinSpace:" ",Vfr:"𝔙",vfr:"𝔳",vltri:"⊲",vnsub:"⊂⃒",vnsup:"⊃⃒",Vopf:"𝕍",vopf:"𝕧",vprop:"∝",vrtri:"⊳",Vscr:"𝒱",vscr:"𝓋",vsubnE:"⫋︀",vsubne:"⊊︀",vsupnE:"⫌︀",vsupne:"⊋︀",Vvdash:"⊪",vzigzag:"⦚",Wcirc:"Ŵ",wcirc:"ŵ",wedbar:"⩟",Wedge:"⋀",wedge:"∧",wedgeq:"≙",weierp:"℘",Wfr:"𝔚",wfr:"𝔴",Wopf:"𝕎",wopf:"𝕨",wp:"℘",wr:"≀",wreath:"≀",Wscr:"𝒲",wscr:"𝓌",xcap:"⋂",xcirc:"◯",xcup:"⋃",xdtri:"▽",Xfr:"𝔛",xfr:"𝔵",xhArr:"⟺",xharr:"⟷",Xi:"Ξ",xi:"ξ",xlArr:"⟸",xlarr:"⟵",xmap:"⟼",xnis:"⋻",xodot:"⨀",Xopf:"𝕏",xopf:"𝕩",xoplus:"⨁",xotime:"⨂",xrArr:"⟹",xrarr:"⟶",Xscr:"𝒳",xscr:"𝓍",xsqcup:"⨆",xuplus:"⨄",xutri:"△",xvee:"⋁",xwedge:"⋀",Yacute:"Ý",yacute:"ý",YAcy:"Я",yacy:"я",Ycirc:"Ŷ",ycirc:"ŷ",Ycy:"Ы",ycy:"ы",yen:"¥",Yfr:"𝔜",yfr:"𝔶",YIcy:"Ї",yicy:"ї",Yopf:"𝕐",yopf:"𝕪",Yscr:"𝒴",yscr:"𝓎",YUcy:"Ю",yucy:"ю",Yuml:"Ÿ",yuml:"ÿ",Zacute:"Ź",zacute:"ź",Zcaron:"Ž",zcaron:"ž",Zcy:"З",zcy:"з",Zdot:"Ż",zdot:"ż",zeetrf:"ℨ",ZeroWidthSpace:"​",Zeta:"Ζ",zeta:"ζ",Zfr:"ℨ",zfr:"𝔷",ZHcy:"Ж",zhcy:"ж",zigrarr:"⇝",Zopf:"ℤ",zopf:"𝕫",Zscr:"𝒵",zscr:"𝓏",zwj:"‍",zwnj:"‌"}),n.entityMap=n.HTML_ENTITIES})(om)),om}var hc={},U1;function G5(){if(U1)return hc;U1=1;var n=Ff().NAMESPACE,e=/[A-Z_a-z\xC0-\xD6\xD8-\xF6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,t=new RegExp("[\\-\\.0-9"+e.source.slice(1,-1)+"\\u00B7\\u0300-\\u036F\\u203F-\\u2040]"),i=new RegExp("^"+e.source+t.source+"*(?::"+e.source+t.source+"*)?$"),s=0,r=1,o=2,a=3,l=4,h=5,u=6,c=7;function f(P,R){this.message=P,this.locator=R,Error.captureStackTrace&&Error.captureStackTrace(this,f)}f.prototype=new Error,f.prototype.name=f.name;function p(){}p.prototype={parse:function(P,R,q){var z=this.domBuilder;z.startDocument(),S(R,R={}),b(P,R,q,z,this.errorHandler),z.endDocument()}};function b(P,R,q,z,X){function Z(lt){if(lt>65535){lt-=65536;var ht=55296+(lt>>10),pn=56320+(lt&1023);return String.fromCharCode(ht,pn)}else return String.fromCharCode(lt)}function K(lt){var ht=lt.slice(1,-1);return Object.hasOwnProperty.call(q,ht)?q[ht]:ht.charAt(0)==="#"?Z(parseInt(ht.substr(1).replace("x","0x"))):(X.error("entity not found:"+lt),lt)}function oe(lt){if(lt>Pe){var ht=P.substring(Pe,lt).replace(/&#?\w+;/g,K);ne&&G(Pe),z.characters(ht,0,lt-Pe),Pe=lt}}function G(lt,ht){for(;lt>=te&&(ht=re.exec(P));)ee=ht.index,te=ee+ht[0].length,ne.lineNumber++;ne.columnNumber=lt-ee+1}for(var ee=0,te=0,re=/.*(?:\r\n?|\n)|.*$/g,ne=z.locator,ve=[{currentNSMap:R}],xe={},Pe=0;;){try{var Se=P.indexOf("<",Pe);if(Se<0){if(!P.substr(Pe).match(/^\s*$/)){var ct=z.doc,vt=ct.createTextNode(P.substr(Pe));ct.appendChild(vt),z.currentElement=vt}return}switch(Se>Pe&&oe(Se),P.charAt(Se+1)){case"/":var Rt=P.indexOf(">",Se+3),rt=P.substring(Se+2,Rt).replace(/[ \t\n\r]+$/g,""),It=ve.pop();Rt<0?(rt=P.substring(Se+2).replace(/[\s<].*/,""),X.error("end tag name: "+rt+" is not complete:"+It.tagName),Rt=Se+1+rt.length):rt.match(/\s</)&&(rt=rt.replace(/[\s<].*/,""),X.error("end tag name: "+rt+" maybe not complete"),Rt=Se+1+rt.length);var Bi=It.localNSMap,Vt=It.tagName==rt,Ut=Vt||It.tagName&&It.tagName.toLowerCase()==rt.toLowerCase();if(Ut){if(z.endElement(It.uri,It.localName,rt),Bi)for(var Gn in Bi)Object.prototype.hasOwnProperty.call(Bi,Gn)&&z.endPrefixMapping(Gn);Vt||X.fatalError("end tag name: "+rt+" is not match the current start tagName:"+It.tagName)}else ve.push(It);Rt++;break;case"?":ne&&G(Se),Rt=A(P,Se,z);break;case"!":ne&&G(Se),Rt=k(P,Se,z,X);break;default:ne&&G(Se);var qt=new M,Ln=ve[ve.length-1].currentNSMap,Rt=_(P,Se,qt,Ln,K,X),Qs=qt.length;if(!qt.closed&&v(P,Rt,qt.tagName,xe)&&(qt.closed=!0,q.nbsp||X.warning("unclosed xml attribute")),ne&&Qs){for(var di=y(ne,{}),ni=0;ni<Qs;ni++){var Fe=qt[ni];G(Fe.offset),Fe.locator=y(ne,{})}z.locator=di,T(qt,z,Ln)&&ve.push(qt),z.locator=ne}else T(qt,z,Ln)&&ve.push(qt);n.isHTML(qt.uri)&&!qt.closed?Rt=w(P,Rt,qt.tagName,K,z):Rt++}}catch(lt){if(lt instanceof f)throw lt;X.error("element parse error: "+lt),Rt=-1}Rt>Pe?Pe=Rt:oe(Math.max(Se,Pe)+1)}}function y(P,R){return R.lineNumber=P.lineNumber,R.columnNumber=P.columnNumber,R}function _(P,R,q,z,X,Z){function K(ne,ve,xe){q.attributeNames.hasOwnProperty(ne)&&Z.fatalError("Attribute "+ne+" redefined"),q.addValue(ne,ve.replace(/[\t\n\r]/g," ").replace(/&#?\w+;/g,X),xe)}for(var oe,G,ee=++R,te=s;;){var re=P.charAt(ee);switch(re){case"=":if(te===r)oe=P.slice(R,ee),te=a;else if(te===o)te=a;else throw new Error("attribute equal must after attrName");break;case"'":case'"':if(te===a||te===r)if(te===r&&(Z.warning('attribute value must after "="'),oe=P.slice(R,ee)),R=ee+1,ee=P.indexOf(re,R),ee>0)G=P.slice(R,ee),K(oe,G,R-1),te=h;else throw new Error("attribute value no end '"+re+"' match");else if(te==l)G=P.slice(R,ee),K(oe,G,R),Z.warning('attribute "'+oe+'" missed start quot('+re+")!!"),R=ee+1,te=h;else throw new Error('attribute value must after "="');break;case"/":switch(te){case s:q.setTagName(P.slice(R,ee));case h:case u:case c:te=c,q.closed=!0;case l:case r:break;case o:q.closed=!0;break;default:throw new Error("attribute invalid close char('/')")}break;case"":return Z.error("unexpected end of input"),te==s&&q.setTagName(P.slice(R,ee)),ee;case">":switch(te){case s:q.setTagName(P.slice(R,ee));case h:case u:case c:break;case l:case r:G=P.slice(R,ee),G.slice(-1)==="/"&&(q.closed=!0,G=G.slice(0,-1));case o:te===o&&(G=oe),te==l?(Z.warning('attribute "'+G+'" missed quot(")!'),K(oe,G,R)):((!n.isHTML(z[""])||!G.match(/^(?:disabled|checked|selected)$/i))&&Z.warning('attribute "'+G+'" missed value!! "'+G+'" instead!!'),K(G,G,R));break;case a:throw new Error("attribute value missed!!")}return ee;case"":re=" ";default:if(re<=" ")switch(te){case s:q.setTagName(P.slice(R,ee)),te=u;break;case r:oe=P.slice(R,ee),te=o;break;case l:var G=P.slice(R,ee);Z.warning('attribute "'+G+'" missed quot(")!!'),K(oe,G,R);case h:te=u;break}else switch(te){case o:q.tagName,(!n.isHTML(z[""])||!oe.match(/^(?:disabled|checked|selected)$/i))&&Z.warning('attribute "'+oe+'" missed value!! "'+oe+'" instead2!!'),K(oe,oe,R),R=ee,te=r;break;case h:Z.warning('attribute space is required"'+oe+'"!!');case u:te=r,R=ee;break;case a:te=l,R=ee;break;case c:throw new Error("elements closed character '/' and '>' must be connected to")}}ee++}}function T(P,R,q){for(var z=P.tagName,X=null,re=P.length;re--;){var Z=P[re],K=Z.qName,oe=Z.value,ne=K.indexOf(":");if(ne>0)var G=Z.prefix=K.slice(0,ne),ee=K.slice(ne+1),te=G==="xmlns"&&ee;else ee=K,G=null,te=K==="xmlns"&&"";Z.localName=ee,te!==!1&&(X==null&&(X={},S(q,q={})),q[te]=X[te]=oe,Z.uri=n.XMLNS,R.startPrefixMapping(te,oe))}for(var re=P.length;re--;){Z=P[re];var G=Z.prefix;G&&(G==="xml"&&(Z.uri=n.XML),G!=="xmlns"&&(Z.uri=q[G||""]))}var ne=z.indexOf(":");ne>0?(G=P.prefix=z.slice(0,ne),ee=P.localName=z.slice(ne+1)):(G=null,ee=P.localName=z);var ve=P.uri=q[G||""];if(R.startElement(ve,ee,z,P),P.closed){if(R.endElement(ve,ee,z),X)for(G in X)Object.prototype.hasOwnProperty.call(X,G)&&R.endPrefixMapping(G)}else return P.currentNSMap=q,P.localNSMap=X,!0}function w(P,R,q,z,X){if(/^(?:script|textarea)$/i.test(q)){var Z=P.indexOf("</"+q+">",R),K=P.substring(R+1,Z);if(/[&<]/.test(K))return/^script$/i.test(q)?(X.characters(K,0,K.length),Z):(K=K.replace(/&#?\w+;/g,z),X.characters(K,0,K.length),Z)}return R+1}function v(P,R,q,z){var X=z[q];return X==null&&(X=P.lastIndexOf("</"+q+">"),X<R&&(X=P.lastIndexOf("</"+q)),z[q]=X),X<R}function S(P,R){for(var q in P)Object.prototype.hasOwnProperty.call(P,q)&&(R[q]=P[q])}function k(P,R,q,z){var X=P.charAt(R+2);switch(X){case"-":if(P.charAt(R+3)==="-"){var Z=P.indexOf("-->",R+4);return Z>R?(q.comment(P,R+4,Z-R-4),Z+3):(z.error("Unclosed comment"),-1)}else return-1;default:if(P.substr(R+3,6)=="CDATA["){var Z=P.indexOf("]]>",R+9);return q.startCDATA(),q.characters(P,R+9,Z-R-9),q.endCDATA(),Z+3}var K=B(P,R),oe=K.length;if(oe>1&&/!doctype/i.test(K[0][0])){var G=K[1][0],ee=!1,te=!1;oe>3&&(/^public$/i.test(K[2][0])?(ee=K[3][0],te=oe>4&&K[4][0]):/^system$/i.test(K[2][0])&&(te=K[3][0]));var re=K[oe-1];return q.startDTD(G,ee,te),q.endDTD(),re.index+re[0].length}}return-1}function A(P,R,q){var z=P.indexOf("?>",R);if(z){var X=P.substring(R,z).match(/^<\?(\S*)\s*([\s\S]*?)\s*$/);return X?(X[0].length,q.processingInstruction(X[1],X[2]),z+2):-1}return-1}function M(){this.attributeNames={}}M.prototype={setTagName:function(P){if(!i.test(P))throw new Error("invalid tagName:"+P);this.tagName=P},addValue:function(P,R,q){if(!i.test(P))throw new Error("invalid attribute:"+P);this.attributeNames[P]=this.length,this[this.length++]={qName:P,value:R,offset:q}},length:0,getLocalName:function(P){return this[P].localName},getLocator:function(P){return this[P].locator},getQName:function(P){return this[P].qName},getURI:function(P){return this[P].uri},getValue:function(P){return this[P].value}};function B(P,R){var q,z=[],X=/'[^']+'|"[^"]+"|[^\s<>\/=]+=?|(\/?\s*>|<)/g;for(X.lastIndex=R,X.exec(P);q=X.exec(P);)if(z.push(q),q[1])return z}return hc.XMLReader=p,hc.ParseError=f,hc}var q1;function K5(){if(q1)return $l;q1=1;var n=Ff(),e=P2(),t=Y5(),i=G5(),s=e.DOMImplementation,r=n.NAMESPACE,o=i.ParseError,a=i.XMLReader;function l(_){return _.replace(/\r[\n\u0085]/g,`
`).replace(/[\r\u0085\u2028]/g,`
`)}function h(_){this.options=_||{locator:{}}}h.prototype.parseFromString=function(_,T){var w=this.options,v=new a,S=w.domBuilder||new c,k=w.errorHandler,A=w.locator,M=w.xmlns||{},B=/\/x?html?$/.test(T),P=B?t.HTML_ENTITIES:t.XML_ENTITIES;A&&S.setDocumentLocator(A),v.errorHandler=u(k,S,A),v.domBuilder=w.domBuilder||S,B&&(M[""]=r.HTML),M.xml=M.xml||r.XML;var R=w.normalizeLineEndings||l;return _&&typeof _=="string"?v.parse(R(_),M,P):v.errorHandler.error("invalid doc source"),S.doc};function u(_,T,w){if(!_){if(T instanceof c)return T;_=T}var v={},S=_ instanceof Function;w=w||{};function k(A){var M=_[A];!M&&S&&(M=_.length==2?function(B){_(A,B)}:_),v[A]=M&&function(B){M("[xmldom "+A+"]	"+B+p(w))}||function(){}}return k("warning"),k("error"),k("fatalError"),v}function c(){this.cdata=!1}function f(_,T){T.lineNumber=_.lineNumber,T.columnNumber=_.columnNumber}c.prototype={startDocument:function(){this.doc=new s().createDocument(null,null,null),this.locator&&(this.doc.documentURI=this.locator.systemId)},startElement:function(_,T,w,v){var S=this.doc,k=S.createElementNS(_,w||T),A=v.length;y(this,k),this.currentElement=k,this.locator&&f(this.locator,k);for(var M=0;M<A;M++){var _=v.getURI(M),B=v.getValue(M),w=v.getQName(M),P=S.createAttributeNS(_,w);this.locator&&f(v.getLocator(M),P),P.value=P.nodeValue=B,k.setAttributeNode(P)}},endElement:function(_,T,w){var v=this.currentElement;v.tagName,this.currentElement=v.parentNode},startPrefixMapping:function(_,T){},endPrefixMapping:function(_){},processingInstruction:function(_,T){var w=this.doc.createProcessingInstruction(_,T);this.locator&&f(this.locator,w),y(this,w)},ignorableWhitespace:function(_,T,w){},characters:function(_,T,w){if(_=b.apply(this,arguments),_){if(this.cdata)var v=this.doc.createCDATASection(_);else var v=this.doc.createTextNode(_);this.currentElement?this.currentElement.appendChild(v):/^\s*$/.test(_)&&this.doc.appendChild(v),this.locator&&f(this.locator,v)}},skippedEntity:function(_){},endDocument:function(){this.doc.normalize()},setDocumentLocator:function(_){(this.locator=_)&&(_.lineNumber=0)},comment:function(_,T,w){_=b.apply(this,arguments);var v=this.doc.createComment(_);this.locator&&f(this.locator,v),y(this,v)},startCDATA:function(){this.cdata=!0},endCDATA:function(){this.cdata=!1},startDTD:function(_,T,w){var v=this.doc.implementation;if(v&&v.createDocumentType){var S=v.createDocumentType(_,T,w);this.locator&&f(this.locator,S),y(this,S),this.doc.doctype=S}},warning:function(_){console.warn("[xmldom warning]	"+_,p(this.locator))},error:function(_){console.error("[xmldom error]	"+_,p(this.locator))},fatalError:function(_){throw new o(_,this.locator)}};function p(_){if(_)return`
@`+(_.systemId||"")+"#[line:"+_.lineNumber+",col:"+_.columnNumber+"]"}function b(_,T,w){return typeof _=="string"?_.substr(T,w):_.length>=T+w||T?new java.lang.String(_,T,w)+"":_}"endDTD,startEntity,endEntity,attributeDecl,elementDecl,externalEntityDecl,internalEntityDecl,resolveEntity,getExternalSubset,notationDecl,unparsedEntityDecl".replace(/\w+/g,function(_){c.prototype[_]=function(){return null}});function y(_,T){_.currentElement?_.currentElement.appendChild(T):_.doc.appendChild(T)}return $l.__DOMHandler=c,$l.normalizeLineEndings=l,$l.DOMParser=h,$l}var z1;function J5(){if(z1)return Ll;z1=1;var n=P2();return Ll.DOMImplementation=n.DOMImplementation,Ll.XMLSerializer=n.XMLSerializer,Ll.DOMParser=K5().DOMParser,Ll}var e4=J5();/*! @name mpd-parser @version 1.3.1 @license Apache-2.0 */const j1=n=>!!n&&typeof n=="object",ei=(...n)=>n.reduce((e,t)=>(typeof t!="object"||Object.keys(t).forEach(i=>{Array.isArray(e[i])&&Array.isArray(t[i])?e[i]=e[i].concat(t[i]):j1(e[i])&&j1(t[i])?e[i]=ei(e[i],t[i]):e[i]=t[i]}),e),{}),D2=n=>Object.keys(n).map(e=>n[e]),t4=(n,e)=>{const t=[];for(let i=n;i<e;i++)t.push(i);return t},La=n=>n.reduce((e,t)=>e.concat(t),[]),M2=n=>{if(!n.length)return[];const e=[];for(let t=0;t<n.length;t++)e.push(n[t]);return e},i4=(n,e)=>n.reduce((t,i,s)=>(i[e]&&t.push(s),t),[]),n4=(n,e)=>D2(n.reduce((t,i)=>(i.forEach(s=>{t[e(s)]=s}),t),{}));var $a={INVALID_NUMBER_OF_PERIOD:"INVALID_NUMBER_OF_PERIOD",DASH_EMPTY_MANIFEST:"DASH_EMPTY_MANIFEST",DASH_INVALID_XML:"DASH_INVALID_XML",NO_BASE_URL:"NO_BASE_URL",SEGMENT_TIME_UNSPECIFIED:"SEGMENT_TIME_UNSPECIFIED",UNSUPPORTED_UTC_TIMING_SCHEME:"UNSUPPORTED_UTC_TIMING_SCHEME"};const Nh=({baseUrl:n="",source:e="",range:t="",indexRange:i=""})=>{const s={uri:e,resolvedUri:Nf(n||"",e)};if(t||i){const o=(t||i).split("-");let a=V.BigInt?V.BigInt(o[0]):parseInt(o[0],10),l=V.BigInt?V.BigInt(o[1]):parseInt(o[1],10);a<Number.MAX_SAFE_INTEGER&&typeof a=="bigint"&&(a=Number(a)),l<Number.MAX_SAFE_INTEGER&&typeof l=="bigint"&&(l=Number(l));let h;typeof l=="bigint"||typeof a=="bigint"?h=V.BigInt(l)-V.BigInt(a)+V.BigInt(1):h=l-a+1,typeof h=="bigint"&&h<Number.MAX_SAFE_INTEGER&&(h=Number(h)),s.byterange={length:h,offset:a}}return s},s4=n=>{let e;return typeof n.offset=="bigint"||typeof n.length=="bigint"?e=V.BigInt(n.offset)+V.BigInt(n.length)-V.BigInt(1):e=n.offset+n.length-1,`${n.offset}-${e}`},X1=n=>(n&&typeof n!="number"&&(n=parseInt(n,10)),isNaN(n)?null:n),r4={static(n){const{duration:e,timescale:t=1,sourceDuration:i,periodDuration:s}=n,r=X1(n.endNumber),o=e/t;return typeof r=="number"?{start:0,end:r}:typeof s=="number"?{start:0,end:s/o}:{start:0,end:i/o}},dynamic(n){const{NOW:e,clientOffset:t,availabilityStartTime:i,timescale:s=1,duration:r,periodStart:o=0,minimumUpdatePeriod:a=0,timeShiftBufferDepth:l=1/0}=n,h=X1(n.endNumber),u=(e+t)/1e3,c=i+o,p=u+a-c,b=Math.ceil(p*s/r),y=Math.floor((u-c-l)*s/r),_=Math.floor((u-c)*s/r);return{start:Math.max(0,y),end:typeof h=="number"?h:Math.min(b,_)}}},o4=n=>e=>{const{duration:t,timescale:i=1,periodStart:s,startNumber:r=1}=n;return{number:r+e,duration:t/i,timeline:s,time:e*t}},Cy=n=>{const{type:e,duration:t,timescale:i=1,periodDuration:s,sourceDuration:r}=n,{start:o,end:a}=r4[e](n),l=t4(o,a).map(o4(n));if(e==="static"){const h=l.length-1,u=typeof s=="number"?s:r;l[h].duration=u-t/i*h}return l},I2=n=>{const{baseUrl:e,initialization:t={},sourceDuration:i,indexRange:s="",periodStart:r,presentationTime:o,number:a=0,duration:l}=n;if(!e)throw new Error($a.NO_BASE_URL);const h=Nh({baseUrl:e,source:t.sourceURL,range:t.range}),u=Nh({baseUrl:e,source:e,indexRange:s});if(u.map=h,l){const c=Cy(n);c.length&&(u.duration=c[0].duration,u.timeline=c[0].timeline)}else i&&(u.duration=i,u.timeline=r);return u.presentationTime=o||r,u.number=a,[u]},Ey=(n,e,t)=>{const i=n.sidx.map?n.sidx.map:null,s=n.sidx.duration,r=n.timeline||0,o=n.sidx.byterange,a=o.offset+o.length,l=e.timescale,h=e.references.filter(_=>_.referenceType!==1),u=[],c=n.endList?"static":"dynamic",f=n.sidx.timeline;let p=f,b=n.mediaSequence||0,y;typeof e.firstOffset=="bigint"?y=V.BigInt(a)+e.firstOffset:y=a+e.firstOffset;for(let _=0;_<h.length;_++){const T=e.references[_],w=T.referencedSize,v=T.subsegmentDuration;let S;typeof y=="bigint"?S=y+V.BigInt(w)-V.BigInt(1):S=y+w-1;const k=`${y}-${S}`,M=I2({baseUrl:t,timescale:l,timeline:r,periodStart:f,presentationTime:p,number:b,duration:v,sourceDuration:s,indexRange:k,type:c})[0];i&&(M.map=i),u.push(M),typeof y=="bigint"?y+=V.BigInt(w):y+=w,p+=v/l,b++}return n.segments=u,n},a4=["AUDIO","SUBTITLES"],l4=1/60,R2=n=>n4(n,({timeline:e})=>e).sort((e,t)=>e.timeline>t.timeline?1:-1),h4=(n,e)=>{for(let t=0;t<n.length;t++)if(n[t].attributes.NAME===e)return n[t];return null},H1=n=>{let e=[];return Z5(n,a4,(t,i,s,r)=>{e=e.concat(t.playlists||[])}),e},W1=({playlist:n,mediaSequence:e})=>{n.mediaSequence=e,n.segments.forEach((t,i)=>{t.number=n.mediaSequence+i})},u4=({oldPlaylists:n,newPlaylists:e,timelineStarts:t})=>{e.forEach(i=>{i.discontinuitySequence=t.findIndex(function({timeline:l}){return l===i.timeline});const s=h4(n,i.attributes.NAME);if(!s||i.sidx)return;const r=i.segments[0],o=s.segments.findIndex(function(l){return Math.abs(l.presentationTime-r.presentationTime)<l4});if(o===-1){W1({playlist:i,mediaSequence:s.mediaSequence+s.segments.length}),i.segments[0].discontinuity=!0,i.discontinuityStarts.unshift(0),(!s.segments.length&&i.timeline>s.timeline||s.segments.length&&i.timeline>s.segments[s.segments.length-1].timeline)&&i.discontinuitySequence--;return}s.segments[o].discontinuity&&!r.discontinuity&&(r.discontinuity=!0,i.discontinuityStarts.unshift(0),i.discontinuitySequence--),W1({playlist:i,mediaSequence:s.segments[o].number})})},c4=({oldManifest:n,newManifest:e})=>{const t=n.playlists.concat(H1(n)),i=e.playlists.concat(H1(e));return e.timelineStarts=R2([n.timelineStarts,e.timelineStarts]),u4({oldPlaylists:t,newPlaylists:i,timelineStarts:e.timelineStarts}),e},Vf=n=>n&&n.uri+"-"+s4(n.byterange),am=n=>{const e=n.reduce(function(i,s){return i[s.attributes.baseUrl]||(i[s.attributes.baseUrl]=[]),i[s.attributes.baseUrl].push(s),i},{});let t=[];return Object.values(e).forEach(i=>{const s=D2(i.reduce((r,o)=>{const a=o.attributes.id+(o.attributes.lang||"");return r[a]?(o.segments&&(o.segments[0]&&(o.segments[0].discontinuity=!0),r[a].segments.push(...o.segments)),o.attributes.contentProtection&&(r[a].attributes.contentProtection=o.attributes.contentProtection)):(r[a]=o,r[a].attributes.timelineStarts=[]),r[a].attributes.timelineStarts.push({start:o.attributes.periodStart,timeline:o.attributes.periodStart}),r},{}));t=t.concat(s)}),t.map(i=>(i.discontinuityStarts=i4(i.segments||[],"discontinuity"),i))},Ay=(n,e)=>{const t=Vf(n.sidx),i=t&&e[t]&&e[t].sidx;return i&&Ey(n,i,n.sidx.resolvedUri),n},d4=(n,e={})=>{if(!Object.keys(e).length)return n;for(const t in n)n[t]=Ay(n[t],e);return n},f4=({attributes:n,segments:e,sidx:t,mediaSequence:i,discontinuitySequence:s,discontinuityStarts:r},o)=>{const a={attributes:{NAME:n.id,BANDWIDTH:n.bandwidth,CODECS:n.codecs,"PROGRAM-ID":1},uri:"",endList:n.type==="static",timeline:n.periodStart,resolvedUri:n.baseUrl||"",targetDuration:n.duration,discontinuitySequence:s,discontinuityStarts:r,timelineStarts:n.timelineStarts,mediaSequence:i,segments:e};return n.contentProtection&&(a.contentProtection=n.contentProtection),n.serviceLocation&&(a.attributes.serviceLocation=n.serviceLocation),t&&(a.sidx=t),o&&(a.attributes.AUDIO="audio",a.attributes.SUBTITLES="subs"),a},p4=({attributes:n,segments:e,mediaSequence:t,discontinuityStarts:i,discontinuitySequence:s})=>{typeof e>"u"&&(e=[{uri:n.baseUrl,timeline:n.periodStart,resolvedUri:n.baseUrl||"",duration:n.sourceDuration,number:0}],n.duration=n.sourceDuration);const r={NAME:n.id,BANDWIDTH:n.bandwidth,"PROGRAM-ID":1};n.codecs&&(r.CODECS=n.codecs);const o={attributes:r,uri:"",endList:n.type==="static",timeline:n.periodStart,resolvedUri:n.baseUrl||"",targetDuration:n.duration,timelineStarts:n.timelineStarts,discontinuityStarts:i,discontinuitySequence:s,mediaSequence:t,segments:e};return n.serviceLocation&&(o.attributes.serviceLocation=n.serviceLocation),o},m4=(n,e={},t=!1)=>{let i;const s=n.reduce((r,o)=>{const a=o.attributes.role&&o.attributes.role.value||"",l=o.attributes.lang||"";let h=o.attributes.label||"main";if(l&&!o.attributes.label){const c=a?` (${a})`:"";h=`${o.attributes.lang}${c}`}r[h]||(r[h]={language:l,autoselect:!0,default:a==="main",playlists:[],uri:""});const u=Ay(f4(o,t),e);return r[h].playlists.push(u),typeof i>"u"&&a==="main"&&(i=o,i.default=!0),r},{});if(!i){const r=Object.keys(s)[0];s[r].default=!0}return s},g4=(n,e={})=>n.reduce((t,i)=>{const s=i.attributes.label||i.attributes.lang||"text",r=i.attributes.lang||"und";return t[s]||(t[s]={language:r,default:!1,autoselect:!1,playlists:[],uri:""}),t[s].playlists.push(Ay(p4(i),e)),t},{}),O4=n=>n.reduce((e,t)=>(t&&t.forEach(i=>{const{channel:s,language:r}=i;e[r]={autoselect:!1,default:!1,instreamId:s,language:r},i.hasOwnProperty("aspectRatio")&&(e[r].aspectRatio=i.aspectRatio),i.hasOwnProperty("easyReader")&&(e[r].easyReader=i.easyReader),i.hasOwnProperty("3D")&&(e[r]["3D"]=i["3D"])}),e),{}),y4=({attributes:n,segments:e,sidx:t,discontinuityStarts:i})=>{const s={attributes:{NAME:n.id,AUDIO:"audio",SUBTITLES:"subs",RESOLUTION:{width:n.width,height:n.height},CODECS:n.codecs,BANDWIDTH:n.bandwidth,"PROGRAM-ID":1},uri:"",endList:n.type==="static",timeline:n.periodStart,resolvedUri:n.baseUrl||"",targetDuration:n.duration,discontinuityStarts:i,timelineStarts:n.timelineStarts,segments:e};return n.frameRate&&(s.attributes["FRAME-RATE"]=n.frameRate),n.contentProtection&&(s.contentProtection=n.contentProtection),n.serviceLocation&&(s.attributes.serviceLocation=n.serviceLocation),t&&(s.sidx=t),s},b4=({attributes:n})=>n.mimeType==="video/mp4"||n.mimeType==="video/webm"||n.contentType==="video",v4=({attributes:n})=>n.mimeType==="audio/mp4"||n.mimeType==="audio/webm"||n.contentType==="audio",S4=({attributes:n})=>n.mimeType==="text/vtt"||n.contentType==="text",x4=(n,e)=>{n.forEach(t=>{t.mediaSequence=0,t.discontinuitySequence=e.findIndex(function({timeline:i}){return i===t.timeline}),t.segments&&t.segments.forEach((i,s)=>{i.number=s})})},Z1=n=>n?Object.keys(n).reduce((e,t)=>{const i=n[t];return e.concat(i.playlists)},[]):[],T4=({dashPlaylists:n,locations:e,contentSteering:t,sidxMapping:i={},previousManifest:s,eventStream:r})=>{if(!n.length)return{};const{sourceDuration:o,type:a,suggestedPresentationDelay:l,minimumUpdatePeriod:h}=n[0].attributes,u=am(n.filter(b4)).map(y4),c=am(n.filter(v4)),f=am(n.filter(S4)),p=n.map(S=>S.attributes.captionServices).filter(Boolean),b={allowCache:!0,discontinuityStarts:[],segments:[],endList:!0,mediaGroups:{AUDIO:{},VIDEO:{},"CLOSED-CAPTIONS":{},SUBTITLES:{}},uri:"",duration:o,playlists:d4(u,i)};h>=0&&(b.minimumUpdatePeriod=h*1e3),e&&(b.locations=e),t&&(b.contentSteering=t),a==="dynamic"&&(b.suggestedPresentationDelay=l),r&&r.length>0&&(b.eventStream=r);const y=b.playlists.length===0,_=c.length?m4(c,i,y):null,T=f.length?g4(f,i):null,w=u.concat(Z1(_),Z1(T)),v=w.map(({timelineStarts:S})=>S);return b.timelineStarts=R2(v),x4(w,b.timelineStarts),_&&(b.mediaGroups.AUDIO.audio=_),T&&(b.mediaGroups.SUBTITLES.subs=T),p.length&&(b.mediaGroups["CLOSED-CAPTIONS"].cc=O4(p)),s?c4({oldManifest:s,newManifest:b}):b},w4=(n,e,t)=>{const{NOW:i,clientOffset:s,availabilityStartTime:r,timescale:o=1,periodStart:a=0,minimumUpdatePeriod:l=0}=n,h=(i+s)/1e3,u=r+a,f=h+l-u;return Math.ceil((f*o-e)/t)},L2=(n,e)=>{const{type:t,minimumUpdatePeriod:i=0,media:s="",sourceDuration:r,timescale:o=1,startNumber:a=1,periodStart:l}=n,h=[];let u=-1;for(let c=0;c<e.length;c++){const f=e[c],p=f.d,b=f.r||0,y=f.t||0;u<0&&(u=y),y&&y>u&&(u=y);let _;if(b<0){const v=c+1;v===e.length?t==="dynamic"&&i>0&&s.indexOf("$Number$")>0?_=w4(n,u,p):_=(r*o-u)/p:_=(e[v].t-u)/p}else _=b+1;const T=a+h.length+_;let w=a+h.length;for(;w<T;)h.push({number:w,duration:p/o,time:u,timeline:l}),u+=p,w++}return h},_4=/\$([A-z]*)(?:(%0)([0-9]+)d)?\$/g,k4=n=>(e,t,i,s)=>{if(e==="$$")return"$";if(typeof n[t]>"u")return e;const r=""+n[t];return t==="RepresentationID"||(i?s=parseInt(s,10):s=1,r.length>=s)?r:`${new Array(s-r.length+1).join("0")}${r}`},Y1=(n,e)=>n.replace(_4,k4(e)),C4=(n,e)=>!n.duration&&!e?[{number:n.startNumber||1,duration:n.sourceDuration,time:0,timeline:n.periodStart}]:n.duration?Cy(n):L2(n,e),E4=(n,e)=>{const t={RepresentationID:n.id,Bandwidth:n.bandwidth||0},{initialization:i={sourceURL:"",range:""}}=n,s=Nh({baseUrl:n.baseUrl,source:Y1(i.sourceURL,t),range:i.range});return C4(n,e).map(o=>{t.Number=o.number,t.Time=o.time;const a=Y1(n.media||"",t),l=n.timescale||1,h=n.presentationTimeOffset||0,u=n.periodStart+(o.time-h)/l;return{uri:a,timeline:o.timeline,duration:o.duration,resolvedUri:Nf(n.baseUrl||"",a),map:s,number:o.number,presentationTime:u}})},A4=(n,e)=>{const{baseUrl:t,initialization:i={}}=n,s=Nh({baseUrl:t,source:i.sourceURL,range:i.range}),r=Nh({baseUrl:t,source:e.media,range:e.mediaRange});return r.map=s,r},P4=(n,e)=>{const{duration:t,segmentUrls:i=[],periodStart:s}=n;if(!t&&!e||t&&e)throw new Error($a.SEGMENT_TIME_UNSPECIFIED);const r=i.map(l=>A4(n,l));let o;return t&&(o=Cy(n)),e&&(o=L2(n,e)),o.map((l,h)=>{if(r[h]){const u=r[h],c=n.timescale||1,f=n.presentationTimeOffset||0;return u.timeline=l.timeline,u.duration=l.duration,u.number=l.number,u.presentationTime=s+(l.time-f)/c,u}}).filter(l=>l)},D4=({attributes:n,segmentInfo:e})=>{let t,i;e.template?(i=E4,t=ei(n,e.template)):e.base?(i=I2,t=ei(n,e.base)):e.list&&(i=P4,t=ei(n,e.list));const s={attributes:n};if(!i)return s;const r=i(t,e.segmentTimeline);if(t.duration){const{duration:o,timescale:a=1}=t;t.duration=o/a}else r.length?t.duration=r.reduce((o,a)=>Math.max(o,Math.ceil(a.duration)),0):t.duration=0;return s.attributes=t,s.segments=r,e.base&&t.indexRange&&(s.sidx=r[0],s.segments=[]),s},M4=n=>n.map(D4),Tt=(n,e)=>M2(n.childNodes).filter(({tagName:t})=>t===e),vu=n=>n.textContent.trim(),I4=n=>parseFloat(n.split("/").reduce((e,t)=>e/t)),Yo=n=>{const a=/P(?:(\d*)Y)?(?:(\d*)M)?(?:(\d*)D)?(?:T(?:(\d*)H)?(?:(\d*)M)?(?:([\d.]*)S)?)?/.exec(n);if(!a)return 0;const[l,h,u,c,f,p]=a.slice(1);return parseFloat(l||0)*31536e3+parseFloat(h||0)*2592e3+parseFloat(u||0)*86400+parseFloat(c||0)*3600+parseFloat(f||0)*60+parseFloat(p||0)},R4=n=>(/^\d+-\d+-\d+T\d+:\d+:\d+(\.\d+)?$/.test(n)&&(n+="Z"),Date.parse(n)),G1={mediaPresentationDuration(n){return Yo(n)},availabilityStartTime(n){return R4(n)/1e3},minimumUpdatePeriod(n){return Yo(n)},suggestedPresentationDelay(n){return Yo(n)},type(n){return n},timeShiftBufferDepth(n){return Yo(n)},start(n){return Yo(n)},width(n){return parseInt(n,10)},height(n){return parseInt(n,10)},bandwidth(n){return parseInt(n,10)},frameRate(n){return I4(n)},startNumber(n){return parseInt(n,10)},timescale(n){return parseInt(n,10)},presentationTimeOffset(n){return parseInt(n,10)},duration(n){const e=parseInt(n,10);return isNaN(e)?Yo(n):e},d(n){return parseInt(n,10)},t(n){return parseInt(n,10)},r(n){return parseInt(n,10)},presentationTime(n){return parseInt(n,10)},DEFAULT(n){return n}},zt=n=>n&&n.attributes?M2(n.attributes).reduce((e,t)=>{const i=G1[t.name]||G1.DEFAULT;return e[t.name]=i(t.value),e},{}):{},L4={"urn:uuid:1077efec-c0b2-4d02-ace3-3c1e52e2fb4b":"org.w3.clearkey","urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed":"com.widevine.alpha","urn:uuid:9a04f079-9840-4286-ab92-e65be0885f95":"com.microsoft.playready","urn:uuid:f239e769-efa3-4850-9c16-a903c6932efb":"com.adobe.primetime","urn:mpeg:dash:mp4protection:2011":"mp4protection"},Uf=(n,e)=>e.length?La(n.map(function(t){return e.map(function(i){const s=vu(i),r=Nf(t.baseUrl,s),o=ei(zt(i),{baseUrl:r});return r!==s&&!o.serviceLocation&&t.serviceLocation&&(o.serviceLocation=t.serviceLocation),o})})):n,Py=n=>{const e=Tt(n,"SegmentTemplate")[0],t=Tt(n,"SegmentList")[0],i=t&&Tt(t,"SegmentURL").map(c=>ei({tag:"SegmentURL"},zt(c))),s=Tt(n,"SegmentBase")[0],r=t||e,o=r&&Tt(r,"SegmentTimeline")[0],a=t||s||e,l=a&&Tt(a,"Initialization")[0],h=e&&zt(e);h&&l?h.initialization=l&&zt(l):h&&h.initialization&&(h.initialization={sourceURL:h.initialization});const u={template:h,segmentTimeline:o&&Tt(o,"S").map(c=>zt(c)),list:t&&ei(zt(t),{segmentUrls:i,initialization:zt(l)}),base:s&&ei(zt(s),{initialization:zt(l)})};return Object.keys(u).forEach(c=>{u[c]||delete u[c]}),u},$4=(n,e,t)=>i=>{const s=Tt(i,"BaseURL"),r=Uf(e,s),o=ei(n,zt(i)),a=Py(i);return r.map(l=>({segmentInfo:ei(t,a),attributes:ei(o,l)}))},Q4=n=>n.reduce((e,t)=>{const i=zt(t);i.schemeIdUri&&(i.schemeIdUri=i.schemeIdUri.toLowerCase());const s=L4[i.schemeIdUri];if(s){e[s]={attributes:i};const r=Tt(t,"cenc:pssh")[0];if(r){const o=vu(r);e[s].pssh=o&&w2(o)}}return e},{}),B4=n=>{if(n.schemeIdUri==="urn:scte:dash:cc:cea-608:2015")return(typeof n.value!="string"?[]:n.value.split(";")).map(t=>{let i,s;return s=t,/^CC\d=/.test(t)?[i,s]=t.split("="):/^CC\d$/.test(t)&&(i=t),{channel:i,language:s}});if(n.schemeIdUri==="urn:scte:dash:cc:cea-708:2015")return(typeof n.value!="string"?[]:n.value.split(";")).map(t=>{const i={channel:void 0,language:void 0,aspectRatio:1,easyReader:0,"3D":0};if(/=/.test(t)){const[s,r=""]=t.split("=");i.channel=s,i.language=t,r.split(",").forEach(o=>{const[a,l]=o.split(":");a==="lang"?i.language=l:a==="er"?i.easyReader=Number(l):a==="war"?i.aspectRatio=Number(l):a==="3D"&&(i["3D"]=Number(l))})}else i.language=t;return i.channel&&(i.channel="SERVICE"+i.channel),i})},N4=n=>La(Tt(n.node,"EventStream").map(e=>{const t=zt(e),i=t.schemeIdUri;return Tt(e,"Event").map(s=>{const r=zt(s),o=r.presentationTime||0,a=t.timescale||1,l=r.duration||0,h=o/a+n.attributes.start;return{schemeIdUri:i,value:t.value,id:r.id,start:h,end:h+l/a,messageData:vu(s)||r.messageData,contentEncoding:t.contentEncoding,presentationTimeOffset:t.presentationTimeOffset||0}})})),F4=(n,e,t)=>i=>{const s=zt(i),r=Uf(e,Tt(i,"BaseURL")),o=Tt(i,"Role")[0],a={role:zt(o)};let l=ei(n,s,a);const h=Tt(i,"Accessibility")[0],u=B4(zt(h));u&&(l=ei(l,{captionServices:u}));const c=Tt(i,"Label")[0];if(c&&c.childNodes.length){const _=c.childNodes[0].nodeValue.trim();l=ei(l,{label:_})}const f=Q4(Tt(i,"ContentProtection"));Object.keys(f).length&&(l=ei(l,{contentProtection:f}));const p=Py(i),b=Tt(i,"Representation"),y=ei(t,p);return La(b.map($4(l,r,y)))},V4=(n,e)=>(t,i)=>{const s=Uf(e,Tt(t.node,"BaseURL")),r=ei(n,{periodStart:t.attributes.start});typeof t.attributes.duration=="number"&&(r.periodDuration=t.attributes.duration);const o=Tt(t.node,"AdaptationSet"),a=Py(t.node);return La(o.map(F4(r,s,a)))},U4=(n,e)=>{if(n.length>1&&e({type:"warn",message:"The MPD manifest should contain no more than one ContentSteering tag"}),!n.length)return null;const t=ei({serverURL:vu(n[0])},zt(n[0]));return t.queryBeforeStart=t.queryBeforeStart==="true",t},q4=({attributes:n,priorPeriodAttributes:e,mpdType:t})=>typeof n.start=="number"?n.start:e&&typeof e.start=="number"&&typeof e.duration=="number"?e.start+e.duration:!e&&t==="static"?0:null,z4=(n,e={})=>{const{manifestUri:t="",NOW:i=Date.now(),clientOffset:s=0,eventHandler:r=function(){}}=e,o=Tt(n,"Period");if(!o.length)throw new Error($a.INVALID_NUMBER_OF_PERIOD);const a=Tt(n,"Location"),l=zt(n),h=Uf([{baseUrl:t}],Tt(n,"BaseURL")),u=Tt(n,"ContentSteering");l.type=l.type||"static",l.sourceDuration=l.mediaPresentationDuration||0,l.NOW=i,l.clientOffset=s,a.length&&(l.locations=a.map(vu));const c=[];return o.forEach((f,p)=>{const b=zt(f),y=c[p-1];b.start=q4({attributes:b,priorPeriodAttributes:y?y.attributes:null,mpdType:l.type}),c.push({node:f,attributes:b})}),{locations:l.locations,contentSteeringInfo:U4(u,r),representationInfo:La(c.map(V4(l,h))),eventStream:La(c.map(N4))}},$2=n=>{if(n==="")throw new Error($a.DASH_EMPTY_MANIFEST);const e=new e4.DOMParser;let t,i;try{t=e.parseFromString(n,"application/xml"),i=t&&t.documentElement.tagName==="MPD"?t.documentElement:null}catch{}if(!i||i&&i.getElementsByTagName("parsererror").length>0)throw new Error($a.DASH_INVALID_XML);return i},j4=n=>{const e=Tt(n,"UTCTiming")[0];if(!e)return null;const t=zt(e);switch(t.schemeIdUri){case"urn:mpeg:dash:utc:http-head:2014":case"urn:mpeg:dash:utc:http-head:2012":t.method="HEAD";break;case"urn:mpeg:dash:utc:http-xsdate:2014":case"urn:mpeg:dash:utc:http-iso:2014":case"urn:mpeg:dash:utc:http-xsdate:2012":case"urn:mpeg:dash:utc:http-iso:2012":t.method="GET";break;case"urn:mpeg:dash:utc:direct:2014":case"urn:mpeg:dash:utc:direct:2012":t.method="DIRECT",t.value=Date.parse(t.value);break;case"urn:mpeg:dash:utc:http-ntp:2014":case"urn:mpeg:dash:utc:ntp:2014":case"urn:mpeg:dash:utc:sntp:2014":default:throw new Error($a.UNSUPPORTED_UTC_TIMING_SCHEME)}return t},X4=(n,e={})=>{const t=z4($2(n),e),i=M4(t.representationInfo);return T4({dashPlaylists:i,locations:t.locations,contentSteering:t.contentSteeringInfo,sidxMapping:e.sidxMapping,previousManifest:e.previousManifest,eventStream:t.eventStream})},H4=n=>j4($2(n));var lm,K1;function W4(){if(K1)return lm;K1=1;var n=Math.pow(2,32),e=function(t){var i=new DataView(t.buffer,t.byteOffset,t.byteLength),s;return i.getBigUint64?(s=i.getBigUint64(0),s<Number.MAX_SAFE_INTEGER?Number(s):s):i.getUint32(0)*n+i.getUint32(4)};return lm={getUint64:e,MAX_UINT32:n},lm}var hm,J1;function Z4(){if(J1)return hm;J1=1;var n=W4().getUint64,e=function(t){var i=new DataView(t.buffer,t.byteOffset,t.byteLength),s={version:t[0],flags:new Uint8Array(t.subarray(1,4)),references:[],referenceId:i.getUint32(4),timescale:i.getUint32(8)},r=12;s.version===0?(s.earliestPresentationTime=i.getUint32(r),s.firstOffset=i.getUint32(r+4),r+=8):(s.earliestPresentationTime=n(t.subarray(r)),s.firstOffset=n(t.subarray(r+8)),r+=16),r+=2;var o=i.getUint16(r);for(r+=2;o>0;r+=12,o--)s.references.push({referenceType:(t[r]&128)>>>7,referencedSize:i.getUint32(r)&2147483647,subsegmentDuration:i.getUint32(r+4),startsWithSap:!!(t[r+8]&128),sapType:(t[r+8]&112)>>>4,sapDeltaTime:i.getUint32(r+8)&268435455});return s};return hm=e,hm}var Y4=Z4();const G4=bu(Y4);var K4=De([73,68,51]),J4=function(e,t){t===void 0&&(t=0),e=De(e);var i=e[t+5],s=e[t+6]<<21|e[t+7]<<14|e[t+8]<<7|e[t+9],r=(i&16)>>4;return r?s+20:s+10},Kl=function n(e,t){return t===void 0&&(t=0),e=De(e),e.length-t<10||!St(e,K4,{offset:t})?t:(t+=J4(e,t),n(e,t))},eS=function(e){return typeof e=="string"?A2(e):e},eB=function(e){return Array.isArray(e)?e.map(function(t){return eS(t)}):[eS(e)]},tB=function n(e,t,i){i===void 0&&(i=!1),t=eB(t),e=De(e);var s=[];if(!t.length)return s;for(var r=0;r<e.length;){var o=(e[r]<<24|e[r+1]<<16|e[r+2]<<8|e[r+3])>>>0,a=e.subarray(r+4,r+8);if(o===0)break;var l=r+o;if(l>e.length){if(i)break;l=e.length}var h=e.subarray(r+8,l);St(a,t[0])&&(t.length===1?s.push(h):s.push.apply(s,n(h,t.slice(1),i))),r=l}return s},uc={EBML:De([26,69,223,163]),DocType:De([66,130]),Segment:De([24,83,128,103]),SegmentInfo:De([21,73,169,102]),Tracks:De([22,84,174,107]),Track:De([174]),TrackNumber:De([215]),DefaultDuration:De([35,227,131]),TrackEntry:De([174]),TrackType:De([131]),FlagDefault:De([136]),CodecID:De([134]),CodecPrivate:De([99,162]),VideoTrack:De([224]),AudioTrack:De([225]),Cluster:De([31,67,182,117]),Timestamp:De([231]),TimestampScale:De([42,215,177]),BlockGroup:De([160]),BlockDuration:De([155]),Block:De([161]),SimpleBlock:De([163])},Ng=[128,64,32,16,8,4,2,1],iB=function(e){for(var t=1,i=0;i<Ng.length&&!(e&Ng[i]);i++)t++;return t},Ed=function(e,t,i,s){i===void 0&&(i=!0),s===void 0&&(s=!1);var r=iB(e[t]),o=e.subarray(t,t+r);return i&&(o=Array.prototype.slice.call(e,t,t+r),o[0]^=Ng[r-1]),{length:r,value:X5(o,{signed:s}),bytes:o}},tS=function n(e){return typeof e=="string"?e.match(/.{1,2}/g).map(function(t){return n(t)}):typeof e=="number"?H5(e):e},nB=function(e){return Array.isArray(e)?e.map(function(t){return tS(t)}):[tS(e)]},sB=function n(e,t,i){if(i>=t.length)return t.length;var s=Ed(t,i,!1);if(St(e.bytes,s.bytes))return i;var r=Ed(t,i+s.length);return n(e,t,i+r.length+r.value+s.length)},iS=function n(e,t){t=nB(t),e=De(e);var i=[];if(!t.length)return i;for(var s=0;s<e.length;){var r=Ed(e,s,!1),o=Ed(e,s+r.length),a=s+r.length+o.length;o.value===127&&(o.value=sB(r,e,a),o.value!==e.length&&(o.value-=a));var l=a+o.value>e.length?e.length:a+o.value,h=e.subarray(a,l);St(t[0],r.bytes)&&(t.length===1?i.push(h):i=i.concat(n(h,t.slice(1))));var u=r.length+o.length+h.length;s+=u}return i},rB=De([0,0,0,1]),oB=De([0,0,1]),aB=De([0,0,3]),lB=function(e){for(var t=[],i=1;i<e.length-2;)St(e.subarray(i,i+3),aB)&&(t.push(i+2),i++),i++;if(t.length===0)return e;var s=e.length-t.length,r=new Uint8Array(s),o=0;for(i=0;i<s;o++,i++)o===t[0]&&(o++,t.shift()),r[i]=e[o];return r},Q2=function(e,t,i,s){e=De(e),i=[].concat(i);for(var r=0,o,a=0;r<e.length&&(a<s||o);){var l=void 0;if(St(e.subarray(r),rB)?l=4:St(e.subarray(r),oB)&&(l=3),!l){r++;continue}if(a++,o)return lB(e.subarray(o,r));var h=void 0;t==="h264"?h=e[r+l]&31:t==="h265"&&(h=e[r+l]>>1&63),i.indexOf(h)!==-1&&(o=r+l),r+=l+(t==="h264"?1:2)}return e.subarray(0,0)},hB=function(e,t,i){return Q2(e,"h264",t,i)},uB=function(e,t,i){return Q2(e,"h265",t,i)},Ci={webm:De([119,101,98,109]),matroska:De([109,97,116,114,111,115,107,97]),flac:De([102,76,97,67]),ogg:De([79,103,103,83]),ac3:De([11,119]),riff:De([82,73,70,70]),avi:De([65,86,73]),wav:De([87,65,86,69]),"3gp":De([102,116,121,112,51,103]),mp4:De([102,116,121,112]),fmp4:De([115,116,121,112]),mov:De([102,116,121,112,113,116]),moov:De([109,111,111,118]),moof:De([109,111,111,102])},Qa={aac:function(e){var t=Kl(e);return St(e,[255,16],{offset:t,mask:[255,22]})},mp3:function(e){var t=Kl(e);return St(e,[255,2],{offset:t,mask:[255,6]})},webm:function(e){var t=iS(e,[uc.EBML,uc.DocType])[0];return St(t,Ci.webm)},mkv:function(e){var t=iS(e,[uc.EBML,uc.DocType])[0];return St(t,Ci.matroska)},mp4:function(e){if(Qa["3gp"](e)||Qa.mov(e))return!1;if(St(e,Ci.mp4,{offset:4})||St(e,Ci.fmp4,{offset:4})||St(e,Ci.moof,{offset:4})||St(e,Ci.moov,{offset:4}))return!0},mov:function(e){return St(e,Ci.mov,{offset:4})},"3gp":function(e){return St(e,Ci["3gp"],{offset:4})},ac3:function(e){var t=Kl(e);return St(e,Ci.ac3,{offset:t})},ts:function(e){if(e.length<189&&e.length>=1)return e[0]===71;for(var t=0;t+188<e.length&&t<188;){if(e[t]===71&&e[t+188]===71)return!0;t+=1}return!1},flac:function(e){var t=Kl(e);return St(e,Ci.flac,{offset:t})},ogg:function(e){return St(e,Ci.ogg)},avi:function(e){return St(e,Ci.riff)&&St(e,Ci.avi,{offset:8})},wav:function(e){return St(e,Ci.riff)&&St(e,Ci.wav,{offset:8})},h264:function(e){return hB(e,7,3).length},h265:function(e){return uB(e,[32,33],3).length}},Fg=Object.keys(Qa).filter(function(n){return n!=="ts"&&n!=="h264"&&n!=="h265"}).concat(["ts","h264","h265"]);Fg.forEach(function(n){var e=Qa[n];Qa[n]=function(t){return e(De(t))}});var cB=Qa,Dy=function(e){e=De(e);for(var t=0;t<Fg.length;t++){var i=Fg[t];if(cB[i](e))return i}return""},dB=function(e){return tB(e,["moof"]).length>0},um,nS;function fB(){if(nS)return um;nS=1;var n=9e4,e,t,i,s,r,o,a;return e=function(l){return l*n},t=function(l,h){return l*h},i=function(l){return l/n},s=function(l,h){return l/h},r=function(l,h){return e(s(l,h))},o=function(l,h){return t(i(l),h)},a=function(l,h,u){return i(u?l:l-h)},um={ONE_SECOND_IN_TS:n,secondsToVideoTs:e,secondsToAudioTs:t,videoTsToSeconds:i,audioTsToSeconds:s,audioTsToVideoTs:r,videoTsToAudioTs:o,metadataTsToSeconds:a},um}var mo=fB();/**
 * @license
 * Video.js 8.23.4 <http://videojs.com/>
 * Copyright Brightcove, Inc. <https://www.brightcove.com/>
 * Available under Apache License Version 2.0
 * <https://github.com/videojs/video.js/blob/main/LICENSE>
 *
 * Includes vtt.js <https://github.com/mozilla/vtt.js>
 * Available under Apache License Version 2.0
 * <https://github.com/mozilla/vtt.js/blob/main/LICENSE>
 */var Vg="8.23.4";const Gs={},Vr=function(n,e){return Gs[n]=Gs[n]||[],e&&(Gs[n]=Gs[n].concat(e)),Gs[n]},pB=function(n,e){Vr(n,e)},B2=function(n,e){const t=Vr(n).indexOf(e);return t<=-1?!1:(Gs[n]=Gs[n].slice(),Gs[n].splice(t,1),!0)},mB=function(n,e){Vr(n,[].concat(e).map(t=>{const i=(...s)=>(B2(n,i),t(...s));return i}))},Ad={prefixed:!0},Yc=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror","fullscreen"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror","-webkit-full-screen"]],sS=Yc[0];let Jl;for(let n=0;n<Yc.length;n++)if(Yc[n][1]in he){Jl=Yc[n];break}if(Jl){for(let n=0;n<Jl.length;n++)Ad[sS[n]]=Jl[n];Ad.prefixed=Jl[0]!==sS[0]}let Vi=[];const gB=(n,e,t)=>(i,s,r)=>{const o=e.levels[s],a=new RegExp(`^(${o})$`);let l=n;if(i!=="log"&&r.unshift(i.toUpperCase()+":"),t&&(l=`%c${n}`,r.unshift(t)),r.unshift(l+":"),Vi){Vi.push([].concat(r));const u=Vi.length-1e3;Vi.splice(0,u>0?u:0)}if(!V.console)return;let h=V.console[i];!h&&i==="debug"&&(h=V.console.info||V.console.log),!(!h||!o||!a.test(i))&&h[Array.isArray(r)?"apply":"call"](V.console,r)};function Ug(n,e=":",t=""){let i="info",s;function r(...o){s("log",i,o)}return s=gB(n,r,t),r.createLogger=(o,a,l)=>{const h=a!==void 0?a:e,u=l!==void 0?l:t,c=`${n} ${h} ${o}`;return Ug(c,h,u)},r.createNewLogger=(o,a,l)=>Ug(o,a,l),r.levels={all:"debug|log|warn|error",off:"",debug:"debug|log|warn|error",info:"log|warn|error",warn:"warn|error",error:"error",DEFAULT:i},r.level=o=>{if(typeof o=="string"){if(!r.levels.hasOwnProperty(o))throw new Error(`"${o}" in not a valid log level`);i=o}return i},r.history=()=>Vi?[].concat(Vi):[],r.history.filter=o=>(Vi||[]).filter(a=>new RegExp(`.*${o}.*`).test(a[0])),r.history.clear=()=>{Vi&&(Vi.length=0)},r.history.disable=()=>{Vi!==null&&(Vi.length=0,Vi=null)},r.history.enable=()=>{Vi===null&&(Vi=[])},r.error=(...o)=>s("error",i,o),r.warn=(...o)=>s("warn",i,o),r.debug=(...o)=>s("debug",i,o),r}const ze=Ug("VIDEOJS"),N2=ze.createLogger,OB=Object.prototype.toString,F2=function(n){return Es(n)?Object.keys(n):[]};function ma(n,e){F2(n).forEach(t=>e(n[t],t))}function V2(n,e,t=0){return F2(n).reduce((i,s)=>e(i,n[s],s),t)}function Es(n){return!!n&&typeof n=="object"}function Ba(n){return Es(n)&&OB.call(n)==="[object Object]"&&n.constructor===Object}function at(...n){const e={};return n.forEach(t=>{t&&ma(t,(i,s)=>{if(!Ba(i)){e[s]=i;return}Ba(e[s])||(e[s]={}),e[s]=at(e[s],i)})}),e}function U2(n={}){const e=[];for(const t in n)if(n.hasOwnProperty(t)){const i=n[t];e.push(i)}return e}function qf(n,e,t,i=!0){const s=o=>Object.defineProperty(n,e,{value:o,enumerable:!0,writable:!0}),r={configurable:!0,enumerable:!0,get(){const o=t();return s(o),o}};return i&&(r.set=s),Object.defineProperty(n,e,r)}var yB=Object.freeze({__proto__:null,each:ma,reduce:V2,isObject:Es,isPlain:Ba,merge:at,values:U2,defineLazyProperty:qf});let My=!1,q2=null,Wn=!1,z2,j2=!1,ga=!1,Oa=!1,As=!1,Iy=null,zf=null;const bB=!!(V.cast&&V.cast.framework&&V.cast.framework.CastReceiverContext);let X2=null,Pd=!1,jf=!1,Dd=!1,Xf=!1,Md=!1,Id=!1,Rd=!1;const Fh=!!(ll()&&("ontouchstart"in V||V.navigator.maxTouchPoints||V.DocumentTouch&&V.document instanceof V.DocumentTouch)),gr=V.navigator&&V.navigator.userAgentData;gr&&gr.platform&&gr.brands&&(Wn=gr.platform==="Android",ga=!!gr.brands.find(n=>n.brand==="Microsoft Edge"),Oa=!!gr.brands.find(n=>n.brand==="Chromium"),As=!ga&&Oa,Iy=zf=(gr.brands.find(n=>n.brand==="Chromium")||{}).version||null,jf=gr.platform==="Windows");if(!Oa){const n=V.navigator&&V.navigator.userAgent||"";My=/iPod/i.test(n),q2=(function(){const e=n.match(/OS (\d+)_/i);return e&&e[1]?e[1]:null})(),Wn=/Android/i.test(n),z2=(function(){const e=n.match(/Android (\d+)(?:\.(\d+))?(?:\.(\d+))*/i);if(!e)return null;const t=e[1]&&parseFloat(e[1]),i=e[2]&&parseFloat(e[2]);return t&&i?parseFloat(e[1]+"."+e[2]):t||null})(),j2=/Firefox/i.test(n),ga=/Edg/i.test(n),Oa=/Chrome/i.test(n)||/CriOS/i.test(n),As=!ga&&Oa,Iy=zf=(function(){const e=n.match(/(Chrome|CriOS)\/(\d+)/);return e&&e[2]?parseFloat(e[2]):null})(),X2=(function(){const e=/MSIE\s(\d+)\.\d/.exec(n);let t=e&&parseFloat(e[1]);return!t&&/Trident\/7.0/i.test(n)&&/rv:11.0/.test(n)&&(t=11),t})(),Md=/Tizen/i.test(n),Id=/Web0S/i.test(n),Rd=Md||Id,Pd=/Safari/i.test(n)&&!As&&!Wn&&!ga&&!Rd,jf=/Windows/i.test(n),Dd=/iPad/i.test(n)||Pd&&Fh&&!/iPhone/i.test(n),Xf=/iPhone/i.test(n)&&!Dd}const yi=Xf||Dd||My,Hf=(Pd||yi)&&!As;var H2=Object.freeze({__proto__:null,get IS_IPOD(){return My},get IOS_VERSION(){return q2},get IS_ANDROID(){return Wn},get ANDROID_VERSION(){return z2},get IS_FIREFOX(){return j2},get IS_EDGE(){return ga},get IS_CHROMIUM(){return Oa},get IS_CHROME(){return As},get CHROMIUM_VERSION(){return Iy},get CHROME_VERSION(){return zf},IS_CHROMECAST_RECEIVER:bB,get IE_VERSION(){return X2},get IS_SAFARI(){return Pd},get IS_WINDOWS(){return jf},get IS_IPAD(){return Dd},get IS_IPHONE(){return Xf},get IS_TIZEN(){return Md},get IS_WEBOS(){return Id},get IS_SMART_TV(){return Rd},TOUCH_ENABLED:Fh,IS_IOS:yi,IS_ANY_SAFARI:Hf});function rS(n){return typeof n=="string"&&!!n.trim()}function vB(n){if(n.indexOf(" ")>=0)throw new Error("class has illegal whitespace characters")}function ll(){return he===V.document}function hl(n){return Es(n)&&n.nodeType===1}function W2(){try{return V.parent!==V.self}catch{return!0}}function Z2(n){return function(e,t){if(!rS(e))return he[n](null);rS(t)&&(t=he.querySelector(t));const i=hl(t)?t:he;return i[n]&&i[n](e)}}function Le(n="div",e={},t={},i){const s=he.createElement(n);return Object.getOwnPropertyNames(e).forEach(function(r){const o=e[r];r==="textContent"?Zr(s,o):(s[r]!==o||r==="tabIndex")&&(s[r]=o)}),Object.getOwnPropertyNames(t).forEach(function(r){s.setAttribute(r,t[r])}),i&&Ry(s,i),s}function Zr(n,e){return typeof n.textContent>"u"?n.innerText=e:n.textContent=e,n}function qg(n,e){e.firstChild?e.insertBefore(n,e.firstChild):e.appendChild(n)}function Oh(n,e){return vB(e),n.classList.contains(e)}function _o(n,...e){return n.classList.add(...e.reduce((t,i)=>t.concat(i.split(/\s+/)),[])),n}function Wf(n,...e){return n?(n.classList.remove(...e.reduce((t,i)=>t.concat(i.split(/\s+/)),[])),n):(ze.warn("removeClass was called with an element that doesn't exist"),null)}function Y2(n,e,t){return typeof t=="function"&&(t=t(n,e)),typeof t!="boolean"&&(t=void 0),e.split(/\s+/).forEach(i=>n.classList.toggle(i,t)),n}function G2(n,e){Object.getOwnPropertyNames(e).forEach(function(t){const i=e[t];i===null||typeof i>"u"||i===!1?n.removeAttribute(t):n.setAttribute(t,i===!0?"":i)})}function Sr(n){const e={},t=["autoplay","controls","playsinline","loop","muted","default","defaultMuted"];if(n&&n.attributes&&n.attributes.length>0){const i=n.attributes;for(let s=i.length-1;s>=0;s--){const r=i[s].name;let o=i[s].value;t.includes(r)&&(o=o!==null),e[r]=o}}return e}function K2(n,e){return n.getAttribute(e)}function Na(n,e,t){n.setAttribute(e,t)}function Zf(n,e){n.removeAttribute(e)}function J2(){he.body.focus(),he.onselectstart=function(){return!1}}function ek(){he.onselectstart=function(){return!0}}function Fa(n){if(n&&n.getBoundingClientRect&&n.parentNode){const e=n.getBoundingClientRect(),t={};return["bottom","height","left","right","top","width"].forEach(i=>{e[i]!==void 0&&(t[i]=e[i])}),t.height||(t.height=parseFloat(Va(n,"height"))),t.width||(t.width=parseFloat(Va(n,"width"))),t}}function Vh(n){if(!n||n&&!n.offsetParent)return{left:0,top:0,width:0,height:0};const e=n.offsetWidth,t=n.offsetHeight;let i=0,s=0;for(;n.offsetParent&&n!==he[Ad.fullscreenElement];)i+=n.offsetLeft,s+=n.offsetTop,n=n.offsetParent;return{left:i,top:s,width:e,height:t}}function Yf(n,e){const t={x:0,y:0};if(yi){let u=n;for(;u&&u.nodeName.toLowerCase()!=="html";){const c=Va(u,"transform");if(/^matrix/.test(c)){const f=c.slice(7,-1).split(/,\s/).map(Number);t.x+=f[4],t.y+=f[5]}else if(/^matrix3d/.test(c)){const f=c.slice(9,-1).split(/,\s/).map(Number);t.x+=f[12],t.y+=f[13]}if(u.assignedSlot&&u.assignedSlot.parentElement&&V.WebKitCSSMatrix){const f=V.getComputedStyle(u.assignedSlot.parentElement).transform,p=new V.WebKitCSSMatrix(f);t.x+=p.m41,t.y+=p.m42}u=u.parentNode||u.host}}const i={},s=Vh(e.target),r=Vh(n),o=r.width,a=r.height;let l=e.offsetY-(r.top-s.top),h=e.offsetX-(r.left-s.left);return e.changedTouches&&(h=e.changedTouches[0].pageX-r.left,l=e.changedTouches[0].pageY+r.top,yi&&(h-=t.x,l-=t.y)),i.y=1-Math.max(0,Math.min(1,l/a)),i.x=Math.max(0,Math.min(1,h/o)),i}function tk(n){return Es(n)&&n.nodeType===3}function Gf(n){for(;n.firstChild;)n.removeChild(n.firstChild);return n}function ik(n){return typeof n=="function"&&(n=n()),(Array.isArray(n)?n:[n]).map(e=>{if(typeof e=="function"&&(e=e()),hl(e)||tk(e))return e;if(typeof e=="string"&&/\S/.test(e))return he.createTextNode(e)}).filter(e=>e)}function Ry(n,e){return ik(e).forEach(t=>n.appendChild(t)),n}function nk(n,e){return Ry(Gf(n),e)}function Uh(n){return n.button===void 0&&n.buttons===void 0||n.button===0&&n.buttons===void 0||n.type==="mouseup"&&n.button===0&&n.buttons===0||n.type==="mousedown"&&n.button===0&&n.buttons===0?!0:!(n.button!==0||n.buttons!==1)}const Ur=Z2("querySelector"),sk=Z2("querySelectorAll");function Va(n,e){if(!n||!e)return"";if(typeof V.getComputedStyle=="function"){let t;try{t=V.getComputedStyle(n)}catch{return""}return t?t.getPropertyValue(e)||t[e]:""}return""}function rk(n){[...he.styleSheets].forEach(e=>{try{const t=[...e.cssRules].map(s=>s.cssText).join(""),i=he.createElement("style");i.textContent=t,n.document.head.appendChild(i)}catch{const i=he.createElement("link");i.rel="stylesheet",i.type=e.type,i.media=e.media.mediaText,i.href=e.href,n.document.head.appendChild(i)}})}var ok=Object.freeze({__proto__:null,isReal:ll,isEl:hl,isInFrame:W2,createEl:Le,textContent:Zr,prependTo:qg,hasClass:Oh,addClass:_o,removeClass:Wf,toggleClass:Y2,setAttributes:G2,getAttributes:Sr,getAttribute:K2,setAttribute:Na,removeAttribute:Zf,blockTextSelection:J2,unblockTextSelection:ek,getBoundingClientRect:Fa,findPosition:Vh,getPointerPosition:Yf,isTextNode:tk,emptyEl:Gf,normalizeContent:ik,appendContent:Ry,insertContent:nk,isSingleLeftClick:Uh,$:Ur,$$:sk,computedStyle:Va,copyStyleSheetsToWindow:rk});let ak=!1,zg;const SB=function(){if(zg.options.autoSetup===!1)return;const n=Array.prototype.slice.call(he.getElementsByTagName("video")),e=Array.prototype.slice.call(he.getElementsByTagName("audio")),t=Array.prototype.slice.call(he.getElementsByTagName("video-js")),i=n.concat(e,t);if(i&&i.length>0)for(let s=0,r=i.length;s<r;s++){const o=i[s];if(o&&o.getAttribute)o.player===void 0&&o.getAttribute("data-setup")!==null&&zg(o);else{jg(1);break}}else ak||jg(1)};function jg(n,e){ll()&&(e&&(zg=e),V.setTimeout(SB,n))}function Xg(){ak=!0,V.removeEventListener("load",Xg)}ll()&&(he.readyState==="complete"?Xg():V.addEventListener("load",Xg));const lk=function(n){const e=he.createElement("style");return e.className=n,e},hk=function(n,e){n.styleSheet?n.styleSheet.cssText=e:n.textContent=e};var Ii=new WeakMap;const xB=3;let TB=xB;function An(){return TB++}function oS(n,e){if(!Ii.has(n))return;const t=Ii.get(n);t.handlers[e].length===0&&(delete t.handlers[e],n.removeEventListener?n.removeEventListener(e,t.dispatcher,!1):n.detachEvent&&n.detachEvent("on"+e,t.dispatcher)),Object.getOwnPropertyNames(t.handlers).length<=0&&(delete t.handlers,delete t.dispatcher,delete t.disabled),Object.getOwnPropertyNames(t).length===0&&Ii.delete(n)}function Ly(n,e,t,i){t.forEach(function(s){n(e,s,i)})}function Kf(n){if(n.fixed_)return n;function e(){return!0}function t(){return!1}if(!n||!n.isPropagationStopped||!n.isImmediatePropagationStopped){const i=n||V.event;n={};const s=["layerX","layerY","keyLocation","path","webkitMovementX","webkitMovementY","mozPressure","mozInputSource"];for(const r in i)s.includes(r)||r==="returnValue"&&i.preventDefault||(n[r]=i[r]);if(n.target||(n.target=n.srcElement||he),n.relatedTarget||(n.relatedTarget=n.fromElement===n.target?n.toElement:n.fromElement),n.preventDefault=function(){i.preventDefault&&i.preventDefault(),n.returnValue=!1,i.returnValue=!1,n.defaultPrevented=!0},n.defaultPrevented=!1,n.stopPropagation=function(){i.stopPropagation&&i.stopPropagation(),n.cancelBubble=!0,i.cancelBubble=!0,n.isPropagationStopped=e},n.isPropagationStopped=t,n.stopImmediatePropagation=function(){i.stopImmediatePropagation&&i.stopImmediatePropagation(),n.isImmediatePropagationStopped=e,n.stopPropagation()},n.isImmediatePropagationStopped=t,n.clientX!==null&&n.clientX!==void 0){const r=he.documentElement,o=he.body;n.pageX=n.clientX+(r&&r.scrollLeft||o&&o.scrollLeft||0)-(r&&r.clientLeft||o&&o.clientLeft||0),n.pageY=n.clientY+(r&&r.scrollTop||o&&o.scrollTop||0)-(r&&r.clientTop||o&&o.clientTop||0)}n.which=n.charCode||n.keyCode,n.button!==null&&n.button!==void 0&&(n.button=n.button&1?0:n.button&4?1:n.button&2?2:0)}return n.fixed_=!0,n}let cc;const wB=function(){if(typeof cc!="boolean"){cc=!1;try{const n=Object.defineProperty({},"passive",{get(){cc=!0}});V.addEventListener("test",null,n),V.removeEventListener("test",null,n)}catch{}}return cc},_B=["touchstart","touchmove"];function cn(n,e,t){if(Array.isArray(e))return Ly(cn,n,e,t);Ii.has(n)||Ii.set(n,{});const i=Ii.get(n);if(i.handlers||(i.handlers={}),i.handlers[e]||(i.handlers[e]=[]),t.guid||(t.guid=An()),i.handlers[e].push(t),i.dispatcher||(i.disabled=!1,i.dispatcher=function(s,r){if(i.disabled)return;s=Kf(s);const o=i.handlers[s.type];if(o){const a=o.slice(0);for(let l=0,h=a.length;l<h&&!s.isImmediatePropagationStopped();l++)try{a[l].call(n,s,r)}catch(u){ze.error(u)}}}),i.handlers[e].length===1)if(n.addEventListener){let s=!1;wB()&&_B.indexOf(e)>-1&&(s={passive:!0}),n.addEventListener(e,i.dispatcher,s)}else n.attachEvent&&n.attachEvent("on"+e,i.dispatcher)}function bi(n,e,t){if(!Ii.has(n))return;const i=Ii.get(n);if(!i.handlers)return;if(Array.isArray(e))return Ly(bi,n,e,t);const s=function(o,a){i.handlers[a]=[],oS(o,a)};if(e===void 0){for(const o in i.handlers)Object.prototype.hasOwnProperty.call(i.handlers||{},o)&&s(n,o);return}const r=i.handlers[e];if(r){if(!t){s(n,e);return}if(t.guid)for(let o=0;o<r.length;o++)r[o].guid===t.guid&&r.splice(o--,1);oS(n,e)}}function ul(n,e,t){const i=Ii.has(n)?Ii.get(n):{},s=n.parentNode||n.ownerDocument;if(typeof e=="string"?e={type:e,target:n}:e.target||(e.target=n),e=Kf(e),i.dispatcher&&i.dispatcher.call(n,e,t),s&&!e.isPropagationStopped()&&e.bubbles===!0)ul.call(null,s,e,t);else if(!s&&!e.defaultPrevented&&e.target&&e.target[e.type]){Ii.has(e.target)||Ii.set(e.target,{});const r=Ii.get(e.target);e.target[e.type]&&(r.disabled=!0,typeof e.target[e.type]=="function"&&e.target[e.type](),r.disabled=!1)}return!e.defaultPrevented}function Jf(n,e,t){if(Array.isArray(e))return Ly(Jf,n,e,t);const i=function(){bi(n,e,i),t.apply(this,arguments)};i.guid=t.guid=t.guid||An(),cn(n,e,i)}function $y(n,e,t){const i=function(){bi(n,e,i),t.apply(this,arguments)};i.guid=t.guid=t.guid||An(),cn(n,e,i)}var kB=Object.freeze({__proto__:null,fixEvent:Kf,on:cn,off:bi,trigger:ul,one:Jf,any:$y});const Pn=30,pt=function(n,e,t){e.guid||(e.guid=An());const i=e.bind(n);return i.guid=t?t+"_"+e.guid:e.guid,i},Ps=function(n,e){let t=V.performance.now();return function(...s){const r=V.performance.now();r-t>=e&&(n(...s),t=r)}},uk=function(n,e,t,i=V){let s;const r=()=>{i.clearTimeout(s),s=null},o=function(){const a=this,l=arguments;let h=function(){s=null,h=null,t||n.apply(a,l)};!s&&t&&n.apply(a,l),i.clearTimeout(s),s=i.setTimeout(h,e)};return o.cancel=r,o};var CB=Object.freeze({__proto__:null,UPDATE_REFRESH_INTERVAL:Pn,bind_:pt,throttle:Ps,debounce:uk});let Ql;class dn{on(e,t){const i=this.addEventListener;this.addEventListener=()=>{},cn(this,e,t),this.addEventListener=i}off(e,t){bi(this,e,t)}one(e,t){const i=this.addEventListener;this.addEventListener=()=>{},Jf(this,e,t),this.addEventListener=i}any(e,t){const i=this.addEventListener;this.addEventListener=()=>{},$y(this,e,t),this.addEventListener=i}trigger(e){const t=e.type||e;typeof e=="string"&&(e={type:t}),e=Kf(e),this.allowedEvents_[t]&&this["on"+t]&&this["on"+t](e),ul(this,e)}queueTrigger(e){Ql||(Ql=new Map);const t=e.type||e;let i=Ql.get(this);i||(i=new Map,Ql.set(this,i));const s=i.get(t);i.delete(t),V.clearTimeout(s);const r=V.setTimeout(()=>{i.delete(t),i.size===0&&(i=null,Ql.delete(this)),this.trigger(e)},0);i.set(t,r)}}dn.prototype.allowedEvents_={};dn.prototype.addEventListener=dn.prototype.on;dn.prototype.removeEventListener=dn.prototype.off;dn.prototype.dispatchEvent=dn.prototype.trigger;const ep=n=>typeof n.name=="function"?n.name():typeof n.name=="string"?n.name:n.name_?n.name_:n.constructor&&n.constructor.name?n.constructor.name:typeof n,tr=n=>n instanceof dn||!!n.eventBusEl_&&["on","one","off","trigger"].every(e=>typeof n[e]=="function"),EB=(n,e)=>{tr(n)?e():(n.eventedCallbacks||(n.eventedCallbacks=[]),n.eventedCallbacks.push(e))},Hg=n=>typeof n=="string"&&/\S/.test(n)||Array.isArray(n)&&!!n.length,Ld=(n,e,t)=>{if(!n||!n.nodeName&&!tr(n))throw new Error(`Invalid target for ${ep(e)}#${t}; must be a DOM node or evented object.`)},ck=(n,e,t)=>{if(!Hg(n))throw new Error(`Invalid event type for ${ep(e)}#${t}; must be a non-empty string or array.`)},dk=(n,e,t)=>{if(typeof n!="function")throw new Error(`Invalid listener for ${ep(e)}#${t}; must be a function.`)},cm=(n,e,t)=>{const i=e.length<3||e[0]===n||e[0]===n.eventBusEl_;let s,r,o;return i?(s=n.eventBusEl_,e.length>=3&&e.shift(),[r,o]=e):(s=e[0],r=e[1],o=e[2]),Ld(s,n,t),ck(r,n,t),dk(o,n,t),o=pt(n,o),{isTargetingSelf:i,target:s,type:r,listener:o}},no=(n,e,t,i)=>{Ld(n,n,e),n.nodeName?kB[e](n,t,i):n[e](t,i)},AB={on(...n){const{isTargetingSelf:e,target:t,type:i,listener:s}=cm(this,n,"on");if(no(t,"on",i,s),!e){const r=()=>this.off(t,i,s);r.guid=s.guid;const o=()=>this.off("dispose",r);o.guid=s.guid,no(this,"on","dispose",r),no(t,"on","dispose",o)}},one(...n){const{isTargetingSelf:e,target:t,type:i,listener:s}=cm(this,n,"one");if(e)no(t,"one",i,s);else{const r=(...o)=>{this.off(t,i,r),s.apply(null,o)};r.guid=s.guid,no(t,"one",i,r)}},any(...n){const{isTargetingSelf:e,target:t,type:i,listener:s}=cm(this,n,"any");if(e)no(t,"any",i,s);else{const r=(...o)=>{this.off(t,i,r),s.apply(null,o)};r.guid=s.guid,no(t,"any",i,r)}},off(n,e,t){if(!n||Hg(n))bi(this.eventBusEl_,n,e);else{const i=n,s=e;Ld(i,this,"off"),ck(s,this,"off"),dk(t,this,"off"),t=pt(this,t),this.off("dispose",t),i.nodeName?(bi(i,s,t),bi(i,"dispose",t)):tr(i)&&(i.off(s,t),i.off("dispose",t))}},trigger(n,e){Ld(this.eventBusEl_,this,"trigger");const t=n&&typeof n!="string"?n.type:n;if(!Hg(t))throw new Error(`Invalid event type for ${ep(this)}#trigger; must be a non-empty string or object with a type key that has a non-empty value.`);return ul(this.eventBusEl_,n,e)}};function Qy(n,e={}){const{eventBusKey:t}=e;if(t){if(!n[t].nodeName)throw new Error(`The eventBusKey "${t}" does not refer to an element.`);n.eventBusEl_=n[t]}else n.eventBusEl_=Le("span",{className:"vjs-event-bus"});return Object.assign(n,AB),n.eventedCallbacks&&n.eventedCallbacks.forEach(i=>{i()}),n.on("dispose",()=>{n.off(),[n,n.el_,n.eventBusEl_].forEach(function(i){i&&Ii.has(i)&&Ii.delete(i)}),V.setTimeout(()=>{n.eventBusEl_=null},0)}),n}const PB={state:{},setState(n){typeof n=="function"&&(n=n());let e;return ma(n,(t,i)=>{this.state[i]!==t&&(e=e||{},e[i]={from:this.state[i],to:t}),this.state[i]=t}),e&&tr(this)&&this.trigger({changes:e,type:"statechanged"}),e}};function fk(n,e){return Object.assign(n,PB),n.state=Object.assign({},n.state,e),typeof n.handleStateChanged=="function"&&tr(n)&&n.on("statechanged",n.handleStateChanged),n}const yh=function(n){return typeof n!="string"?n:n.replace(/./,e=>e.toLowerCase())},Dt=function(n){return typeof n!="string"?n:n.replace(/./,e=>e.toUpperCase())},pk=function(n,e){return Dt(n)===Dt(e)};var DB=Object.freeze({__proto__:null,toLowerCase:yh,toTitleCase:Dt,titleCaseEquals:pk});class ie{constructor(e,t,i){if(!e&&this.play?this.player_=e=this:this.player_=e,this.isDisposed_=!1,this.parentComponent_=null,this.options_=at({},this.options_),t=this.options_=at(this.options_,t),this.id_=t.id||t.el&&t.el.id,!this.id_){const s=e&&e.id&&e.id()||"no_player";this.id_=`${s}_component_${An()}`}this.name_=t.name||null,t.el?this.el_=t.el:t.createEl!==!1&&(this.el_=this.createEl()),t.className&&this.el_&&t.className.split(" ").forEach(s=>this.addClass(s)),["on","off","one","any","trigger"].forEach(s=>{this[s]=void 0}),t.evented!==!1&&(Qy(this,{eventBusKey:this.el_?"el_":null}),this.handleLanguagechange=this.handleLanguagechange.bind(this),this.on(this.player_,"languagechange",this.handleLanguagechange)),fk(this,this.constructor.defaultState),this.children_=[],this.childIndex_={},this.childNameIndex_={},this.setTimeoutIds_=new Set,this.setIntervalIds_=new Set,this.rafIds_=new Set,this.namedRafs_=new Map,this.clearingTimersOnDispose_=!1,t.initChildren!==!1&&this.initChildren(),this.ready(i),t.reportTouchActivity!==!1&&this.enableTouchActivity()}dispose(e={}){if(!this.isDisposed_){if(this.readyQueue_&&(this.readyQueue_.length=0),this.trigger({type:"dispose",bubbles:!1}),this.isDisposed_=!0,this.children_)for(let t=this.children_.length-1;t>=0;t--)this.children_[t].dispose&&this.children_[t].dispose();this.children_=null,this.childIndex_=null,this.childNameIndex_=null,this.parentComponent_=null,this.el_&&(this.el_.parentNode&&(e.restoreEl?this.el_.parentNode.replaceChild(e.restoreEl,this.el_):this.el_.parentNode.removeChild(this.el_)),this.el_=null),this.player_=null}}isDisposed(){return!!this.isDisposed_}player(){return this.player_}options(e){return e?(this.options_=at(this.options_,e),this.options_):this.options_}el(){return this.el_}createEl(e,t,i){return Le(e,t,i)}localize(e,t,i=e){const s=this.player_.language&&this.player_.language(),r=this.player_.languages&&this.player_.languages(),o=r&&r[s],a=s&&s.split("-")[0],l=r&&r[a];let h=i;return o&&o[e]?h=o[e]:l&&l[e]&&(h=l[e]),t&&(h=h.replace(/\{(\d+)\}/g,function(u,c){const f=t[c-1];let p=f;return typeof f>"u"&&(p=u),p})),h}handleLanguagechange(){}contentEl(){return this.contentEl_||this.el_}id(){return this.id_}name(){return this.name_}children(){return this.children_}getChildById(e){return this.childIndex_[e]}getChild(e){if(e)return this.childNameIndex_[e]}getDescendant(...e){e=e.reduce((i,s)=>i.concat(s),[]);let t=this;for(let i=0;i<e.length;i++)if(t=t.getChild(e[i]),!t||!t.getChild)return;return t}setIcon(e,t=this.el()){if(!this.player_.options_.experimentalSvgIcons)return;const i="http://www.w3.org/2000/svg",s=Le("span",{className:"vjs-icon-placeholder vjs-svg-icon"},{"aria-hidden":"true"}),r=he.createElementNS(i,"svg");r.setAttributeNS(null,"viewBox","0 0 512 512");const o=he.createElementNS(i,"use");return r.appendChild(o),o.setAttributeNS(null,"href",`#vjs-icon-${e}`),s.appendChild(r),this.iconIsSet_?t.replaceChild(s,t.querySelector(".vjs-icon-placeholder")):t.appendChild(s),this.iconIsSet_=!0,s}addChild(e,t={},i=this.children_.length){let s,r;if(typeof e=="string"){r=Dt(e);const o=t.componentClass||r;t.name=r;const a=ie.getComponent(o);if(!a)throw new Error(`Component ${o} does not exist`);if(typeof a!="function")return null;s=new a(this.player_||this,t)}else s=e;if(s.parentComponent_&&s.parentComponent_.removeChild(s),this.children_.splice(i,0,s),s.parentComponent_=this,typeof s.id=="function"&&(this.childIndex_[s.id()]=s),r=r||s.name&&Dt(s.name()),r&&(this.childNameIndex_[r]=s,this.childNameIndex_[yh(r)]=s),typeof s.el=="function"&&s.el()){let o=null;this.children_[i+1]&&(this.children_[i+1].el_?o=this.children_[i+1].el_:hl(this.children_[i+1])&&(o=this.children_[i+1])),this.contentEl().insertBefore(s.el(),o)}return s}removeChild(e){if(typeof e=="string"&&(e=this.getChild(e)),!e||!this.children_)return;let t=!1;for(let s=this.children_.length-1;s>=0;s--)if(this.children_[s]===e){t=!0,this.children_.splice(s,1);break}if(!t)return;e.parentComponent_=null,this.childIndex_[e.id()]=null,this.childNameIndex_[Dt(e.name())]=null,this.childNameIndex_[yh(e.name())]=null;const i=e.el();i&&i.parentNode===this.contentEl()&&this.contentEl().removeChild(e.el())}initChildren(){const e=this.options_.children;if(e){const t=this.options_,i=o=>{const a=o.name;let l=o.opts;if(t[a]!==void 0&&(l=t[a]),l===!1)return;l===!0&&(l={}),l.playerOptions=this.options_.playerOptions;const h=this.addChild(a,l);h&&(this[a]=h)};let s;const r=ie.getComponent("Tech");Array.isArray(e)?s=e:s=Object.keys(e),s.concat(Object.keys(this.options_).filter(function(o){return!s.some(function(a){return typeof a=="string"?o===a:o===a.name})})).map(o=>{let a,l;return typeof o=="string"?(a=o,l=e[a]||this.options_[a]||{}):(a=o.name,l=o),{name:a,opts:l}}).filter(o=>{const a=ie.getComponent(o.opts.componentClass||Dt(o.name));return a&&!r.isTech(a)}).forEach(i)}}buildCSSClass(){return""}ready(e,t=!1){if(e){if(!this.isReady_){this.readyQueue_=this.readyQueue_||[],this.readyQueue_.push(e);return}t?e.call(this):this.setTimeout(e,1)}}triggerReady(){this.isReady_=!0,this.setTimeout(function(){const e=this.readyQueue_;this.readyQueue_=[],e&&e.length>0&&e.forEach(function(t){t.call(this)},this),this.trigger("ready")},1)}$(e,t){return Ur(e,t||this.contentEl())}$$(e,t){return sk(e,t||this.contentEl())}hasClass(e){return Oh(this.el_,e)}addClass(...e){_o(this.el_,...e)}removeClass(...e){Wf(this.el_,...e)}toggleClass(e,t){Y2(this.el_,e,t)}show(){this.removeClass("vjs-hidden")}hide(){this.addClass("vjs-hidden")}lockShowing(){this.addClass("vjs-lock-showing")}unlockShowing(){this.removeClass("vjs-lock-showing")}getAttribute(e){return K2(this.el_,e)}setAttribute(e,t){Na(this.el_,e,t)}removeAttribute(e){Zf(this.el_,e)}width(e,t){return this.dimension("width",e,t)}height(e,t){return this.dimension("height",e,t)}dimensions(e,t){this.width(e,!0),this.height(t)}dimension(e,t,i){if(t!==void 0){(t===null||t!==t)&&(t=0),(""+t).indexOf("%")!==-1||(""+t).indexOf("px")!==-1?this.el_.style[e]=t:t==="auto"?this.el_.style[e]="":this.el_.style[e]=t+"px",i||this.trigger("componentresize");return}if(!this.el_)return 0;const s=this.el_.style[e],r=s.indexOf("px");return parseInt(r!==-1?s.slice(0,r):this.el_["offset"+Dt(e)],10)}currentDimension(e){let t=0;if(e!=="width"&&e!=="height")throw new Error("currentDimension only accepts width or height value");if(t=Va(this.el_,e),t=parseFloat(t),t===0||isNaN(t)){const i=`offset${Dt(e)}`;t=this.el_[i]}return t}currentDimensions(){return{width:this.currentDimension("width"),height:this.currentDimension("height")}}currentWidth(){return this.currentDimension("width")}currentHeight(){return this.currentDimension("height")}getPositions(){const e=this.el_.getBoundingClientRect(),t={x:e.x,y:e.y,width:e.width,height:e.height,top:e.top,right:e.right,bottom:e.bottom,left:e.left},i={x:e.left+e.width/2,y:e.top+e.height/2,width:0,height:0,top:e.top+e.height/2,right:e.left+e.width/2,bottom:e.top+e.height/2,left:e.left+e.width/2};return{boundingClientRect:t,center:i}}focus(){this.el_.focus()}blur(){this.el_.blur()}handleKeyDown(e){this.player_&&(e.key!=="Tab"&&!(this.player_.options_.playerOptions.spatialNavigation&&this.player_.options_.playerOptions.spatialNavigation.enabled)&&e.stopPropagation(),this.player_.handleKeyDown(e))}handleKeyPress(e){this.handleKeyDown(e)}emitTapEvents(){let e=0,t=null;const i=10,s=200;let r;this.on("touchstart",function(a){a.touches.length===1&&(t={pageX:a.touches[0].pageX,pageY:a.touches[0].pageY},e=V.performance.now(),r=!0)}),this.on("touchmove",function(a){if(a.touches.length>1)r=!1;else if(t){const l=a.touches[0].pageX-t.pageX,h=a.touches[0].pageY-t.pageY;Math.sqrt(l*l+h*h)>i&&(r=!1)}});const o=function(){r=!1};this.on("touchleave",o),this.on("touchcancel",o),this.on("touchend",function(a){t=null,r===!0&&V.performance.now()-e<s&&(a.preventDefault(),this.trigger("tap"))})}enableTouchActivity(){if(!this.player()||!this.player().reportUserActivity)return;const e=pt(this.player(),this.player().reportUserActivity);let t;this.on("touchstart",function(){e(),this.clearInterval(t),t=this.setInterval(e,250)});const i=function(s){e(),this.clearInterval(t)};this.on("touchmove",e),this.on("touchend",i),this.on("touchcancel",i)}setTimeout(e,t){var i;return e=pt(this,e),this.clearTimersOnDispose_(),i=V.setTimeout(()=>{this.setTimeoutIds_.has(i)&&this.setTimeoutIds_.delete(i),e()},t),this.setTimeoutIds_.add(i),i}clearTimeout(e){return this.setTimeoutIds_.has(e)&&(this.setTimeoutIds_.delete(e),V.clearTimeout(e)),e}setInterval(e,t){e=pt(this,e),this.clearTimersOnDispose_();const i=V.setInterval(e,t);return this.setIntervalIds_.add(i),i}clearInterval(e){return this.setIntervalIds_.has(e)&&(this.setIntervalIds_.delete(e),V.clearInterval(e)),e}requestAnimationFrame(e){this.clearTimersOnDispose_();var t;return e=pt(this,e),t=V.requestAnimationFrame(()=>{this.rafIds_.has(t)&&this.rafIds_.delete(t),e()}),this.rafIds_.add(t),t}requestNamedAnimationFrame(e,t){this.namedRafs_.has(e)&&this.cancelNamedAnimationFrame(e),this.clearTimersOnDispose_(),t=pt(this,t);const i=this.requestAnimationFrame(()=>{t(),this.namedRafs_.has(e)&&this.namedRafs_.delete(e)});return this.namedRafs_.set(e,i),e}cancelNamedAnimationFrame(e){this.namedRafs_.has(e)&&(this.cancelAnimationFrame(this.namedRafs_.get(e)),this.namedRafs_.delete(e))}cancelAnimationFrame(e){return this.rafIds_.has(e)&&(this.rafIds_.delete(e),V.cancelAnimationFrame(e)),e}clearTimersOnDispose_(){this.clearingTimersOnDispose_||(this.clearingTimersOnDispose_=!0,this.one("dispose",()=>{[["namedRafs_","cancelNamedAnimationFrame"],["rafIds_","cancelAnimationFrame"],["setTimeoutIds_","clearTimeout"],["setIntervalIds_","clearInterval"]].forEach(([e,t])=>{this[e].forEach((i,s)=>this[t](s))}),this.clearingTimersOnDispose_=!1}))}getIsDisabled(){return!!this.el_.disabled}getIsExpresslyInert(){return this.el_.inert&&!this.el_.ownerDocument.documentElement.inert}getIsFocusable(e){return(e||this.el_).tabIndex>=0&&!(this.getIsDisabled()||this.getIsExpresslyInert())}getIsAvailableToBeFocused(e){function t(r){const o=V.getComputedStyle(r,null),a=o.getPropertyValue("visibility");return o.getPropertyValue("display")!=="none"&&!["hidden","collapse"].includes(a)}function i(r){return!(!t(r.parentElement)||!t(r)||r.style.opacity==="0"||V.getComputedStyle(r).height==="0px"||V.getComputedStyle(r).width==="0px")}function s(r){if(r.offsetWidth+r.offsetHeight+r.getBoundingClientRect().height+r.getBoundingClientRect().width===0)return!1;const o={x:r.getBoundingClientRect().left+r.offsetWidth/2,y:r.getBoundingClientRect().top+r.offsetHeight/2};if(o.x<0||o.x>(he.documentElement.clientWidth||V.innerWidth)||o.y<0||o.y>(he.documentElement.clientHeight||V.innerHeight))return!1;let a=he.elementFromPoint(o.x,o.y);for(;a;){if(a===r)return!0;if(a.parentNode)a=a.parentNode;else return!1}}return e||(e=this.el()),!!(s(e)&&i(e)&&(!e.parentElement||e.tabIndex>=0))}static registerComponent(e,t){if(typeof e!="string"||!e)throw new Error(`Illegal component name, "${e}"; must be a non-empty string.`);const i=ie.getComponent("Tech"),s=i&&i.isTech(t),r=ie===t||ie.prototype.isPrototypeOf(t.prototype);if(s||!r){let a;throw s?a="techs must be registered using Tech.registerTech()":a="must be a Component subclass",new Error(`Illegal component, "${e}"; ${a}.`)}e=Dt(e),ie.components_||(ie.components_={});const o=ie.getComponent("Player");if(e==="Player"&&o&&o.players){const a=o.players,l=Object.keys(a);if(a&&l.length>0){for(let h=0;h<l.length;h++)if(a[l[h]]!==null)throw new Error("Can not register Player component after player has been created.")}}return ie.components_[e]=t,ie.components_[yh(e)]=t,t}static getComponent(e){if(!(!e||!ie.components_))return ie.components_[e]}}ie.registerComponent("Component",ie);function MB(n,e,t){if(typeof e!="number"||e<0||e>t)throw new Error(`Failed to execute '${n}' on 'TimeRanges': The index provided (${e}) is non-numeric or out of bounds (0-${t}).`)}function aS(n,e,t,i){return MB(n,i,t.length-1),t[i][e]}function dm(n){let e;return n===void 0||n.length===0?e={length:0,start(){throw new Error("This TimeRanges object is empty")},end(){throw new Error("This TimeRanges object is empty")}}:e={length:n.length,start:aS.bind(null,"start",0,n),end:aS.bind(null,"end",1,n)},V.Symbol&&V.Symbol.iterator&&(e[V.Symbol.iterator]=()=>(n||[]).values()),e}function jn(n,e){return Array.isArray(n)?dm(n):n===void 0||e===void 0?dm():dm([[n,e]])}const mk=function(n,e){n=n<0?0:n;let t=Math.floor(n%60),i=Math.floor(n/60%60),s=Math.floor(n/3600);const r=Math.floor(e/60%60),o=Math.floor(e/3600);return(isNaN(n)||n===1/0)&&(s=i=t="-"),s=s>0||o>0?s+":":"",i=((s||r>=10)&&i<10?"0"+i:i)+":",t=t<10?"0"+t:t,s+i+t};let By=mk;function gk(n){By=n}function Ok(){By=mk}function Po(n,e=n){return By(n,e)}var IB=Object.freeze({__proto__:null,createTimeRanges:jn,createTimeRange:jn,setFormatTime:gk,resetFormatTime:Ok,formatTime:Po});function yk(n,e){let t=0,i,s;if(!e)return 0;(!n||!n.length)&&(n=jn(0,0));for(let r=0;r<n.length;r++)i=n.start(r),s=n.end(r),s>e&&(s=e),t+=s-i;return t/e}function Pt(n){if(n instanceof Pt)return n;typeof n=="number"?this.code=n:typeof n=="string"?this.message=n:Es(n)&&(typeof n.code=="number"&&(this.code=n.code),Object.assign(this,n)),this.message||(this.message=Pt.defaultMessages[this.code]||"")}Pt.prototype.code=0;Pt.prototype.message="";Pt.prototype.status=null;Pt.prototype.metadata=null;Pt.errorTypes=["MEDIA_ERR_CUSTOM","MEDIA_ERR_ABORTED","MEDIA_ERR_NETWORK","MEDIA_ERR_DECODE","MEDIA_ERR_SRC_NOT_SUPPORTED","MEDIA_ERR_ENCRYPTED"];Pt.defaultMessages={1:"You aborted the media playback",2:"A network error caused the media download to fail part-way.",3:"The media playback was aborted due to a corruption problem or because the media used features your browser did not support.",4:"The media could not be loaded, either because the server or network failed or because the format is not supported.",5:"The media is encrypted and we do not have the keys to decrypt it."};Pt.MEDIA_ERR_CUSTOM=0;Pt.prototype.MEDIA_ERR_CUSTOM=0;Pt.MEDIA_ERR_ABORTED=1;Pt.prototype.MEDIA_ERR_ABORTED=1;Pt.MEDIA_ERR_NETWORK=2;Pt.prototype.MEDIA_ERR_NETWORK=2;Pt.MEDIA_ERR_DECODE=3;Pt.prototype.MEDIA_ERR_DECODE=3;Pt.MEDIA_ERR_SRC_NOT_SUPPORTED=4;Pt.prototype.MEDIA_ERR_SRC_NOT_SUPPORTED=4;Pt.MEDIA_ERR_ENCRYPTED=5;Pt.prototype.MEDIA_ERR_ENCRYPTED=5;function bh(n){return n!=null&&typeof n.then=="function"}function ms(n){bh(n)&&n.then(null,e=>{})}const Wg=function(n){return["kind","label","language","id","inBandMetadataTrackDispatchType","mode","src"].reduce((t,i,s)=>(n[i]&&(t[i]=n[i]),t),{cues:n.cues&&Array.prototype.map.call(n.cues,function(t){return{startTime:t.startTime,endTime:t.endTime,text:t.text,id:t.id}})})},RB=function(n){const e=n.$$("track"),t=Array.prototype.map.call(e,s=>s.track);return Array.prototype.map.call(e,function(s){const r=Wg(s.track);return s.src&&(r.src=s.src),r}).concat(Array.prototype.filter.call(n.textTracks(),function(s){return t.indexOf(s)===-1}).map(Wg))},LB=function(n,e){return n.forEach(function(t){const i=e.addRemoteTextTrack(t).track;!t.src&&t.cues&&t.cues.forEach(s=>i.addCue(s))}),e.textTracks()};var Zg={textTracksToJson:RB,jsonToTextTracks:LB,trackToJson:Wg};const fm="vjs-modal-dialog";class cl extends ie{constructor(e,t){super(e,t),this.handleKeyDown_=i=>this.handleKeyDown(i),this.close_=i=>this.close(i),this.opened_=this.hasBeenOpened_=this.hasBeenFilled_=!1,this.closeable(!this.options_.uncloseable),this.content(this.options_.content),this.contentEl_=Le("div",{className:`${fm}-content`},{role:"document"}),this.descEl_=Le("p",{className:`${fm}-description vjs-control-text`,id:this.el().getAttribute("aria-describedby")}),Zr(this.descEl_,this.description()),this.el_.appendChild(this.descEl_),this.el_.appendChild(this.contentEl_)}createEl(){return super.createEl("div",{className:this.buildCSSClass(),tabIndex:-1},{"aria-describedby":`${this.id()}_description`,"aria-hidden":"true","aria-label":this.label(),role:"dialog","aria-live":"polite"})}dispose(){this.contentEl_=null,this.descEl_=null,this.previouslyActiveEl_=null,super.dispose()}buildCSSClass(){return`${fm} vjs-hidden ${super.buildCSSClass()}`}label(){return this.localize(this.options_.label||"Modal Window")}description(){let e=this.options_.description||this.localize("This is a modal window.");return this.closeable()&&(e+=" "+this.localize("This modal can be closed by pressing the Escape key or activating the close button.")),e}open(){if(this.opened_){this.options_.fillAlways&&this.fill();return}const e=this.player();this.trigger("beforemodalopen"),this.opened_=!0,(this.options_.fillAlways||!this.hasBeenOpened_&&!this.hasBeenFilled_)&&this.fill(),this.wasPlaying_=!e.paused(),this.options_.pauseOnOpen&&this.wasPlaying_&&e.pause(),this.on("keydown",this.handleKeyDown_),this.hadControls_=e.controls(),e.controls(!1),this.show(),this.conditionalFocus_(),this.el().setAttribute("aria-hidden","false"),this.trigger("modalopen"),this.hasBeenOpened_=!0}opened(e){return typeof e=="boolean"&&this[e?"open":"close"](),this.opened_}close(){if(!this.opened_)return;const e=this.player();this.trigger("beforemodalclose"),this.opened_=!1,this.wasPlaying_&&this.options_.pauseOnOpen&&e.play(),this.off("keydown",this.handleKeyDown_),this.hadControls_&&e.controls(!0),this.hide(),this.el().setAttribute("aria-hidden","true"),this.trigger({type:"modalclose",bubbles:!0}),this.conditionalBlur_(),this.options_.temporary&&this.dispose()}closeable(e){if(typeof e=="boolean"){const t=this.closeable_=!!e;let i=this.getChild("closeButton");if(t&&!i){const s=this.contentEl_;this.contentEl_=this.el_,i=this.addChild("closeButton",{controlText:"Close Modal Dialog"}),this.contentEl_=s,this.on(i,"close",this.close_)}!t&&i&&(this.off(i,"close",this.close_),this.removeChild(i),i.dispose())}return this.closeable_}fill(){this.fillWith(this.content())}fillWith(e){const t=this.contentEl(),i=t.parentNode,s=t.nextSibling;this.trigger("beforemodalfill"),this.hasBeenFilled_=!0,i.removeChild(t),this.empty(),nk(t,e),this.trigger("modalfill"),s?i.insertBefore(t,s):i.appendChild(t);const r=this.getChild("closeButton");r&&i.appendChild(r.el_),this.trigger("aftermodalfill")}empty(){this.trigger("beforemodalempty"),Gf(this.contentEl()),this.trigger("modalempty")}content(e){return typeof e<"u"&&(this.content_=e),this.content_}conditionalFocus_(){const e=he.activeElement,t=this.player_.el_;this.previouslyActiveEl_=null,(t.contains(e)||t===e)&&(this.previouslyActiveEl_=e,this.focus())}conditionalBlur_(){this.previouslyActiveEl_&&(this.previouslyActiveEl_.focus(),this.previouslyActiveEl_=null)}handleKeyDown(e){if(this.trigger({type:"modalKeydown",originalEvent:e,target:this,bubbles:!0}),e.stopPropagation(),e.key==="Escape"&&this.closeable()){e.preventDefault(),this.close();return}if(e.key!=="Tab")return;const t=this.focusableEls_(),i=this.el_.querySelector(":focus");let s;for(let r=0;r<t.length;r++)if(i===t[r]){s=r;break}he.activeElement===this.el_&&(s=0),e.shiftKey&&s===0?(t[t.length-1].focus(),e.preventDefault()):!e.shiftKey&&s===t.length-1&&(t[0].focus(),e.preventDefault())}focusableEls_(){const e=this.el_.querySelectorAll("*");return Array.prototype.filter.call(e,t=>(t instanceof V.HTMLAnchorElement||t instanceof V.HTMLAreaElement)&&t.hasAttribute("href")||(t instanceof V.HTMLInputElement||t instanceof V.HTMLSelectElement||t instanceof V.HTMLTextAreaElement||t instanceof V.HTMLButtonElement)&&!t.hasAttribute("disabled")||t instanceof V.HTMLIFrameElement||t instanceof V.HTMLObjectElement||t instanceof V.HTMLEmbedElement||t.hasAttribute("tabindex")&&t.getAttribute("tabindex")!==-1||t.hasAttribute("contenteditable"))}}cl.prototype.options_={pauseOnOpen:!0,temporary:!0};ie.registerComponent("ModalDialog",cl);class Do extends dn{constructor(e=[]){super(),this.tracks_=[],Object.defineProperty(this,"length",{get(){return this.tracks_.length}});for(let t=0;t<e.length;t++)this.addTrack(e[t])}addTrack(e){const t=this.tracks_.length;""+t in this||Object.defineProperty(this,t,{get(){return this.tracks_[t]}}),this.tracks_.indexOf(e)===-1&&(this.tracks_.push(e),this.trigger({track:e,type:"addtrack",target:this})),e.labelchange_=()=>{this.trigger({track:e,type:"labelchange",target:this})},tr(e)&&e.addEventListener("labelchange",e.labelchange_)}removeTrack(e){let t;for(let i=0,s=this.length;i<s;i++)if(this[i]===e){t=this[i],t.off&&t.off(),this.tracks_.splice(i,1);break}t&&this.trigger({track:t,type:"removetrack",target:this})}getTrackById(e){let t=null;for(let i=0,s=this.length;i<s;i++){const r=this[i];if(r.id===e){t=r;break}}return t}}Do.prototype.allowedEvents_={change:"change",addtrack:"addtrack",removetrack:"removetrack",labelchange:"labelchange"};for(const n in Do.prototype.allowedEvents_)Do.prototype["on"+n]=null;const pm=function(n,e){for(let t=0;t<n.length;t++)!Object.keys(n[t]).length||e.id===n[t].id||(n[t].enabled=!1)};class bk extends Do{constructor(e=[]){for(let t=e.length-1;t>=0;t--)if(e[t].enabled){pm(e,e[t]);break}super(e),this.changing_=!1}addTrack(e){e.enabled&&pm(this,e),super.addTrack(e),e.addEventListener&&(e.enabledChange_=()=>{this.changing_||(this.changing_=!0,pm(this,e),this.changing_=!1,this.trigger("change"))},e.addEventListener("enabledchange",e.enabledChange_))}removeTrack(e){super.removeTrack(e),e.removeEventListener&&e.enabledChange_&&(e.removeEventListener("enabledchange",e.enabledChange_),e.enabledChange_=null)}}const mm=function(n,e){for(let t=0;t<n.length;t++)!Object.keys(n[t]).length||e.id===n[t].id||(n[t].selected=!1)};class vk extends Do{constructor(e=[]){for(let t=e.length-1;t>=0;t--)if(e[t].selected){mm(e,e[t]);break}super(e),this.changing_=!1,Object.defineProperty(this,"selectedIndex",{get(){for(let t=0;t<this.length;t++)if(this[t].selected)return t;return-1},set(){}})}addTrack(e){e.selected&&mm(this,e),super.addTrack(e),e.addEventListener&&(e.selectedChange_=()=>{this.changing_||(this.changing_=!0,mm(this,e),this.changing_=!1,this.trigger("change"))},e.addEventListener("selectedchange",e.selectedChange_))}removeTrack(e){super.removeTrack(e),e.removeEventListener&&e.selectedChange_&&(e.removeEventListener("selectedchange",e.selectedChange_),e.selectedChange_=null)}}class Ny extends Do{addTrack(e){super.addTrack(e),this.queueChange_||(this.queueChange_=()=>this.queueTrigger("change")),this.triggerSelectedlanguagechange||(this.triggerSelectedlanguagechange_=()=>this.trigger("selectedlanguagechange")),e.addEventListener("modechange",this.queueChange_),["metadata","chapters"].indexOf(e.kind)===-1&&e.addEventListener("modechange",this.triggerSelectedlanguagechange_)}removeTrack(e){super.removeTrack(e),e.removeEventListener&&(this.queueChange_&&e.removeEventListener("modechange",this.queueChange_),this.selectedlanguagechange_&&e.removeEventListener("modechange",this.triggerSelectedlanguagechange_))}toJSON(){return this.tracks_.map(e=>e.toJSON())}}class $B{constructor(e=[]){this.trackElements_=[],Object.defineProperty(this,"length",{get(){return this.trackElements_.length}});for(let t=0,i=e.length;t<i;t++)this.addTrackElement_(e[t])}addTrackElement_(e){const t=this.trackElements_.length;""+t in this||Object.defineProperty(this,t,{get(){return this.trackElements_[t]}}),this.trackElements_.indexOf(e)===-1&&this.trackElements_.push(e)}getTrackElementByTrack_(e){let t;for(let i=0,s=this.trackElements_.length;i<s;i++)if(e===this.trackElements_[i].track){t=this.trackElements_[i];break}return t}removeTrackElement_(e){for(let t=0,i=this.trackElements_.length;t<i;t++)if(e===this.trackElements_[t]){this.trackElements_[t].track&&typeof this.trackElements_[t].track.off=="function"&&this.trackElements_[t].track.off(),typeof this.trackElements_[t].off=="function"&&this.trackElements_[t].off(),this.trackElements_.splice(t,1);break}}}class $d{constructor(e){$d.prototype.setCues_.call(this,e),Object.defineProperty(this,"length",{get(){return this.length_}})}setCues_(e){const t=this.length||0;let i=0;const s=e.length;this.cues_=e,this.length_=e.length;const r=function(o){""+o in this||Object.defineProperty(this,""+o,{get(){return this.cues_[o]}})};if(t<s)for(i=t;i<s;i++)r.call(this,i)}getCueById(e){let t=null;for(let i=0,s=this.length;i<s;i++){const r=this[i];if(r.id===e){t=r;break}}return t}}const QB={alternative:"alternative",captions:"captions",main:"main",sign:"sign",subtitles:"subtitles",commentary:"commentary"},BB={alternative:"alternative",descriptions:"descriptions",main:"main","main-desc":"main-desc",translation:"translation",commentary:"commentary"},NB={subtitles:"subtitles",captions:"captions",descriptions:"descriptions",chapters:"chapters",metadata:"metadata"},lS={disabled:"disabled",hidden:"hidden",showing:"showing"};class Fy extends dn{constructor(e={}){super();const t={id:e.id||"vjs_track_"+An(),kind:e.kind||"",language:e.language||""};let i=e.label||"";for(const s in t)Object.defineProperty(this,s,{get(){return t[s]},set(){}});Object.defineProperty(this,"label",{get(){return i},set(s){s!==i&&(i=s,this.trigger("labelchange"))}})}}const Vy=function(n){return new URL(n,he.baseURI)},Sk=function(n){return new URL(n,he.baseURI).href},Uy=function(n){if(typeof n=="string"){const t=n.split("?")[0].replace(/\/+$/,"").match(/\.([^.\/]+)$/);return t?t[1].toLowerCase():""}return""},tp=function(n,e=V.location){return Vy(n).origin!==e.origin};var FB=Object.freeze({__proto__:null,parseUrl:Vy,getAbsoluteURL:Sk,getFileExtension:Uy,isCrossOrigin:tp});const hS=function(n,e){const t=new V.WebVTT.Parser(V,V.vttjs,V.WebVTT.StringDecoder()),i=[];t.oncue=function(s){e.addCue(s)},t.onparsingerror=function(s){i.push(s)},t.onflush=function(){e.trigger({type:"loadeddata",target:e})},t.parse(n),i.length>0&&(V.console&&V.console.groupCollapsed&&V.console.groupCollapsed(`Text Track parsing errors for ${e.src}`),i.forEach(s=>ze.error(s)),V.console&&V.console.groupEnd&&V.console.groupEnd()),t.flush()},uS=function(n,e){const t={uri:n},i=tp(n);i&&(t.cors=i);const s=e.tech_.crossOrigin()==="use-credentials";s&&(t.withCredentials=s),T2(t,pt(this,function(r,o,a){if(r)return ze.error(r,o);e.loaded_=!0,typeof V.WebVTT!="function"?e.tech_&&e.tech_.any(["vttjsloaded","vttjserror"],l=>{if(l.type==="vttjserror"){ze.error(`vttjs failed to load, stopping trying to process ${e.src}`);return}return hS(a,e)}):hS(a,e)}))};class Su extends Fy{constructor(e={}){if(!e.tech)throw new Error("A tech was not provided.");const t=at(e,{kind:NB[e.kind]||"subtitles",language:e.language||e.srclang||""});let i=lS[t.mode]||"disabled";const s=t.default;(t.kind==="metadata"||t.kind==="chapters")&&(i="hidden"),super(t),this.tech_=t.tech,this.cues_=[],this.activeCues_=[],this.preload_=this.tech_.preloadTextTracks!==!1;const r=new $d(this.cues_),o=new $d(this.activeCues_);let a=!1;this.timeupdateHandler=pt(this,function(h={}){if(!this.tech_.isDisposed()){if(!this.tech_.isReady_){h.type!=="timeupdate"&&(this.rvf_=this.tech_.requestVideoFrameCallback(this.timeupdateHandler));return}this.activeCues=this.activeCues,a&&(this.trigger("cuechange"),a=!1),h.type!=="timeupdate"&&(this.rvf_=this.tech_.requestVideoFrameCallback(this.timeupdateHandler))}});const l=()=>{this.stopTracking()};this.tech_.one("dispose",l),i!=="disabled"&&this.startTracking(),Object.defineProperties(this,{default:{get(){return s},set(){}},mode:{get(){return i},set(h){lS[h]&&i!==h&&(i=h,!this.preload_&&i!=="disabled"&&this.cues.length===0&&uS(this.src,this),this.stopTracking(),i!=="disabled"&&this.startTracking(),this.trigger("modechange"))}},cues:{get(){return this.loaded_?r:null},set(){}},activeCues:{get(){if(!this.loaded_)return null;if(this.cues.length===0)return o;const h=this.tech_.currentTime(),u=[];for(let c=0,f=this.cues.length;c<f;c++){const p=this.cues[c];p.startTime<=h&&p.endTime>=h&&u.push(p)}if(a=!1,u.length!==this.activeCues_.length)a=!0;else for(let c=0;c<u.length;c++)this.activeCues_.indexOf(u[c])===-1&&(a=!0);return this.activeCues_=u,o.setCues_(this.activeCues_),o},set(){}}}),t.src?(this.src=t.src,this.preload_||(this.loaded_=!0),(this.preload_||t.kind!=="subtitles"&&t.kind!=="captions")&&uS(this.src,this)):this.loaded_=!0}startTracking(){this.rvf_=this.tech_.requestVideoFrameCallback(this.timeupdateHandler),this.tech_.on("timeupdate",this.timeupdateHandler)}stopTracking(){this.rvf_&&(this.tech_.cancelVideoFrameCallback(this.rvf_),this.rvf_=void 0),this.tech_.off("timeupdate",this.timeupdateHandler)}addCue(e){let t=e;if(!("getCueAsHTML"in t)){t=new V.vttjs.VTTCue(e.startTime,e.endTime,e.text);for(const s in e)s in t||(t[s]=e[s]);t.id=e.id,t.originalCue_=e}const i=this.tech_.textTracks();for(let s=0;s<i.length;s++)i[s]!==this&&i[s].removeCue(t);this.cues_.push(t),this.cues.setCues_(this.cues_)}toJSON(){return Zg.trackToJson(this)}removeCue(e){let t=this.cues_.length;for(;t--;){const i=this.cues_[t];if(i===e||i.originalCue_&&i.originalCue_===e){this.cues_.splice(t,1),this.cues.setCues_(this.cues_);break}}}}Su.prototype.allowedEvents_={cuechange:"cuechange"};class xk extends Fy{constructor(e={}){const t=at(e,{kind:BB[e.kind]||""});super(t);let i=!1;Object.defineProperty(this,"enabled",{get(){return i},set(s){typeof s!="boolean"||s===i||(i=s,this.trigger("enabledchange"))}}),t.enabled&&(this.enabled=t.enabled),this.loaded_=!0}}class Tk extends Fy{constructor(e={}){const t=at(e,{kind:QB[e.kind]||""});super(t);let i=!1;Object.defineProperty(this,"selected",{get(){return i},set(s){typeof s!="boolean"||s===i||(i=s,this.trigger("selectedchange"))}}),t.selected&&(this.selected=t.selected)}}class sr extends dn{constructor(e={}){super();let t;const i=new Su(e);this.kind=i.kind,this.src=i.src,this.srclang=i.language,this.label=i.label,this.default=i.default,Object.defineProperties(this,{readyState:{get(){return t}},track:{get(){return i}}}),t=sr.NONE,i.addEventListener("loadeddata",()=>{t=sr.LOADED,this.trigger({type:"load",target:this})})}}sr.prototype.allowedEvents_={load:"load"};sr.NONE=0;sr.LOADING=1;sr.LOADED=2;sr.ERROR=3;const Cn={audio:{ListClass:bk,TrackClass:xk,capitalName:"Audio"},video:{ListClass:vk,TrackClass:Tk,capitalName:"Video"},text:{ListClass:Ny,TrackClass:Su,capitalName:"Text"}};Object.keys(Cn).forEach(function(n){Cn[n].getterName=`${n}Tracks`,Cn[n].privateName=`${n}Tracks_`});const Ua={remoteText:{ListClass:Ny,TrackClass:Su,capitalName:"RemoteText",getterName:"remoteTextTracks",privateName:"remoteTextTracks_"},remoteTextEl:{ListClass:$B,TrackClass:sr,capitalName:"RemoteTextTrackEls",getterName:"remoteTextTrackEls",privateName:"remoteTextTrackEls_"}},Mi=Object.assign({},Cn,Ua);Ua.names=Object.keys(Ua);Cn.names=Object.keys(Cn);Mi.names=[].concat(Ua.names).concat(Cn.names);function VB(n,e,t,i,s={}){const r=n.textTracks();s.kind=e,t&&(s.label=t),i&&(s.language=i),s.tech=n;const o=new Mi.text.TrackClass(s);return r.addTrack(o),o}class Be extends ie{constructor(e={},t=function(){}){e.reportTouchActivity=!1,super(null,e,t),this.onDurationChange_=i=>this.onDurationChange(i),this.trackProgress_=i=>this.trackProgress(i),this.trackCurrentTime_=i=>this.trackCurrentTime(i),this.stopTrackingCurrentTime_=i=>this.stopTrackingCurrentTime(i),this.disposeSourceHandler_=i=>this.disposeSourceHandler(i),this.queuedHanders_=new Set,this.hasStarted_=!1,this.on("playing",function(){this.hasStarted_=!0}),this.on("loadstart",function(){this.hasStarted_=!1}),Mi.names.forEach(i=>{const s=Mi[i];e&&e[s.getterName]&&(this[s.privateName]=e[s.getterName])}),this.featuresProgressEvents||this.manualProgressOn(),this.featuresTimeupdateEvents||this.manualTimeUpdatesOn(),["Text","Audio","Video"].forEach(i=>{e[`native${i}Tracks`]===!1&&(this[`featuresNative${i}Tracks`]=!1)}),e.nativeCaptions===!1||e.nativeTextTracks===!1?this.featuresNativeTextTracks=!1:(e.nativeCaptions===!0||e.nativeTextTracks===!0)&&(this.featuresNativeTextTracks=!0),this.featuresNativeTextTracks||this.emulateTextTracks(),this.preloadTextTracks=e.preloadTextTracks!==!1,this.autoRemoteTextTracks_=new Mi.text.ListClass,this.initTrackListeners(),e.nativeControlsForTouch||this.emitTapEvents(),this.constructor&&(this.name_=this.constructor.name||"Unknown Tech")}triggerSourceset(e){this.isReady_||this.one("ready",()=>this.setTimeout(()=>this.triggerSourceset(e),1)),this.trigger({src:e,type:"sourceset"})}manualProgressOn(){this.on("durationchange",this.onDurationChange_),this.manualProgress=!0,this.one("ready",this.trackProgress_)}manualProgressOff(){this.manualProgress=!1,this.stopTrackingProgress(),this.off("durationchange",this.onDurationChange_)}trackProgress(e){this.stopTrackingProgress(),this.progressInterval=this.setInterval(pt(this,function(){const t=this.bufferedPercent();this.bufferedPercent_!==t&&this.trigger("progress"),this.bufferedPercent_=t,t===1&&this.stopTrackingProgress()}),500)}onDurationChange(e){this.duration_=this.duration()}buffered(){return jn(0,0)}bufferedPercent(){return yk(this.buffered(),this.duration_)}stopTrackingProgress(){this.clearInterval(this.progressInterval)}manualTimeUpdatesOn(){this.manualTimeUpdates=!0,this.on("play",this.trackCurrentTime_),this.on("pause",this.stopTrackingCurrentTime_)}manualTimeUpdatesOff(){this.manualTimeUpdates=!1,this.stopTrackingCurrentTime(),this.off("play",this.trackCurrentTime_),this.off("pause",this.stopTrackingCurrentTime_)}trackCurrentTime(){this.currentTimeInterval&&this.stopTrackingCurrentTime(),this.currentTimeInterval=this.setInterval(function(){this.trigger({type:"timeupdate",target:this,manuallyTriggered:!0})},250)}stopTrackingCurrentTime(){this.clearInterval(this.currentTimeInterval),this.trigger({type:"timeupdate",target:this,manuallyTriggered:!0})}dispose(){this.clearTracks(Cn.names),this.manualProgress&&this.manualProgressOff(),this.manualTimeUpdates&&this.manualTimeUpdatesOff(),super.dispose()}clearTracks(e){e=[].concat(e),e.forEach(t=>{const i=this[`${t}Tracks`]()||[];let s=i.length;for(;s--;){const r=i[s];t==="text"&&this.removeRemoteTextTrack(r),i.removeTrack(r)}})}cleanupAutoTextTracks(){const e=this.autoRemoteTextTracks_||[];let t=e.length;for(;t--;){const i=e[t];this.removeRemoteTextTrack(i)}}reset(){}crossOrigin(){}setCrossOrigin(){}error(e){return e!==void 0&&(this.error_=new Pt(e),this.trigger("error")),this.error_}played(){return this.hasStarted_?jn(0,0):jn()}play(){}setScrubbing(e){}scrubbing(){}setCurrentTime(e){this.manualTimeUpdates&&this.trigger({type:"timeupdate",target:this,manuallyTriggered:!0})}initTrackListeners(){Cn.names.forEach(e=>{const t=Cn[e],i=()=>{this.trigger(`${e}trackchange`)},s=this[t.getterName]();s.addEventListener("removetrack",i),s.addEventListener("addtrack",i),this.on("dispose",()=>{s.removeEventListener("removetrack",i),s.removeEventListener("addtrack",i)})})}addWebVttScript_(){if(!V.WebVTT)if(he.body.contains(this.el())){if(!this.options_["vtt.js"]&&Ba(R1)&&Object.keys(R1).length>0){this.trigger("vttjsloaded");return}const e=he.createElement("script");e.src=this.options_["vtt.js"]||"https://vjs.zencdn.net/vttjs/0.14.1/vtt.min.js",e.onload=()=>{this.trigger("vttjsloaded")},e.onerror=()=>{this.trigger("vttjserror")},this.on("dispose",()=>{e.onload=null,e.onerror=null}),V.WebVTT=!0,this.el().parentNode.appendChild(e)}else this.ready(this.addWebVttScript_)}emulateTextTracks(){const e=this.textTracks(),t=this.remoteTextTracks(),i=a=>e.addTrack(a.track),s=a=>e.removeTrack(a.track);t.on("addtrack",i),t.on("removetrack",s),this.addWebVttScript_();const r=()=>this.trigger("texttrackchange"),o=()=>{r();for(let a=0;a<e.length;a++){const l=e[a];l.removeEventListener("cuechange",r),l.mode==="showing"&&l.addEventListener("cuechange",r)}};o(),e.addEventListener("change",o),e.addEventListener("addtrack",o),e.addEventListener("removetrack",o),this.on("dispose",function(){t.off("addtrack",i),t.off("removetrack",s),e.removeEventListener("change",o),e.removeEventListener("addtrack",o),e.removeEventListener("removetrack",o);for(let a=0;a<e.length;a++)e[a].removeEventListener("cuechange",r)})}addTextTrack(e,t,i){if(!e)throw new Error("TextTrack kind is required but was not provided");return VB(this,e,t,i)}createRemoteTextTrack(e){const t=at(e,{tech:this});return new Ua.remoteTextEl.TrackClass(t)}addRemoteTextTrack(e={},t){const i=this.createRemoteTextTrack(e);return typeof t!="boolean"&&(t=!1),this.remoteTextTrackEls().addTrackElement_(i),this.remoteTextTracks().addTrack(i.track),t===!1&&this.ready(()=>this.autoRemoteTextTracks_.addTrack(i.track)),i}removeRemoteTextTrack(e){const t=this.remoteTextTrackEls().getTrackElementByTrack_(e);this.remoteTextTrackEls().removeTrackElement_(t),this.remoteTextTracks().removeTrack(e),this.autoRemoteTextTracks_.removeTrack(e)}getVideoPlaybackQuality(){return{}}requestPictureInPicture(){return Promise.reject()}disablePictureInPicture(){return!0}setDisablePictureInPicture(){}requestVideoFrameCallback(e){const t=An();return!this.isReady_||this.paused()?(this.queuedHanders_.add(t),this.one("playing",()=>{this.queuedHanders_.has(t)&&(this.queuedHanders_.delete(t),e())})):this.requestNamedAnimationFrame(t,e),t}cancelVideoFrameCallback(e){this.queuedHanders_.has(e)?this.queuedHanders_.delete(e):this.cancelNamedAnimationFrame(e)}setPoster(){}playsinline(){}setPlaysinline(){}overrideNativeAudioTracks(e){}overrideNativeVideoTracks(e){}canPlayType(e){return""}static canPlayType(e){return""}static canPlaySource(e,t){return Be.canPlayType(e.type)}static isTech(e){return e.prototype instanceof Be||e instanceof Be||e===Be}static registerTech(e,t){if(Be.techs_||(Be.techs_={}),!Be.isTech(t))throw new Error(`Tech ${e} must be a Tech`);if(!Be.canPlayType)throw new Error("Techs must have a static canPlayType method on them");if(!Be.canPlaySource)throw new Error("Techs must have a static canPlaySource method on them");return e=Dt(e),Be.techs_[e]=t,Be.techs_[yh(e)]=t,e!=="Tech"&&Be.defaultTechOrder_.push(e),t}static getTech(e){if(e){if(Be.techs_&&Be.techs_[e])return Be.techs_[e];if(e=Dt(e),V&&V.videojs&&V.videojs[e])return ze.warn(`The ${e} tech was added to the videojs object when it should be registered using videojs.registerTech(name, tech)`),V.videojs[e]}}}Mi.names.forEach(function(n){const e=Mi[n];Be.prototype[e.getterName]=function(){return this[e.privateName]=this[e.privateName]||new e.ListClass,this[e.privateName]}});Be.prototype.featuresVolumeControl=!0;Be.prototype.featuresMuteControl=!0;Be.prototype.featuresFullscreenResize=!1;Be.prototype.featuresPlaybackRate=!1;Be.prototype.featuresProgressEvents=!1;Be.prototype.featuresSourceset=!1;Be.prototype.featuresTimeupdateEvents=!1;Be.prototype.featuresNativeTextTracks=!1;Be.prototype.featuresVideoFrameCallback=!1;Be.withSourceHandlers=function(n){n.registerSourceHandler=function(t,i){let s=n.sourceHandlers;s||(s=n.sourceHandlers=[]),i===void 0&&(i=s.length),s.splice(i,0,t)},n.canPlayType=function(t){const i=n.sourceHandlers||[];let s;for(let r=0;r<i.length;r++)if(s=i[r].canPlayType(t),s)return s;return""},n.selectSourceHandler=function(t,i){const s=n.sourceHandlers||[];let r;for(let o=0;o<s.length;o++)if(r=s[o].canHandleSource(t,i),r)return s[o];return null},n.canPlaySource=function(t,i){const s=n.selectSourceHandler(t,i);return s?s.canHandleSource(t,i):""},["seekable","seeking","duration"].forEach(function(t){const i=this[t];typeof i=="function"&&(this[t]=function(){return this.sourceHandler_&&this.sourceHandler_[t]?this.sourceHandler_[t].apply(this.sourceHandler_,arguments):i.apply(this,arguments)})},n.prototype),n.prototype.setSource=function(t){let i=n.selectSourceHandler(t,this.options_);i||(n.nativeSourceHandler?i=n.nativeSourceHandler:ze.error("No source handler found for the current source.")),this.disposeSourceHandler(),this.off("dispose",this.disposeSourceHandler_),i!==n.nativeSourceHandler&&(this.currentSource_=t),this.sourceHandler_=i.handleSource(t,this,this.options_),this.one("dispose",this.disposeSourceHandler_)},n.prototype.disposeSourceHandler=function(){this.currentSource_&&(this.clearTracks(["audio","video"]),this.currentSource_=null),this.cleanupAutoTextTracks(),this.sourceHandler_&&(this.sourceHandler_.dispose&&this.sourceHandler_.dispose(),this.sourceHandler_=null)}};ie.registerComponent("Tech",Be);Be.registerTech("Tech",Be);Be.defaultTechOrder_=[];const ko={},Qd={},Bd={};function UB(n,e){ko[n]=ko[n]||[],ko[n].push(e)}function qB(n,e,t){n.setTimeout(()=>ao(e,ko[e.type],t,n),1)}function zB(n,e){n.forEach(t=>t.setTech&&t.setTech(e))}function jB(n,e,t){return n.reduceRight(qy(t),e[t]())}function XB(n,e,t,i){return e[t](n.reduce(qy(t),i))}function cS(n,e,t,i=null){const s="call"+Dt(t),r=n.reduce(qy(s),i),o=r===Bd,a=o?null:e[t](r);return ZB(n,t,a,o),a}const HB={buffered:1,currentTime:1,duration:1,muted:1,played:1,paused:1,seekable:1,volume:1,ended:1},WB={setCurrentTime:1,setMuted:1,setVolume:1},dS={play:1,pause:1};function qy(n){return(e,t)=>e===Bd?Bd:t[n]?t[n](e):e}function ZB(n,e,t,i){for(let s=n.length-1;s>=0;s--){const r=n[s];r[e]&&r[e](i,t)}}function YB(n){Qd.hasOwnProperty(n.id())&&delete Qd[n.id()]}function GB(n,e){const t=Qd[n.id()];let i=null;if(t==null)return i=e(n),Qd[n.id()]=[[e,i]],i;for(let s=0;s<t.length;s++){const[r,o]=t[s];r===e&&(i=o)}return i===null&&(i=e(n),t.push([e,i])),i}function ao(n={},e=[],t,i,s=[],r=!1){const[o,...a]=e;if(typeof o=="string")ao(n,ko[o],t,i,s,r);else if(o){const l=GB(i,o);if(!l.setSource)return s.push(l),ao(n,a,t,i,s,r);l.setSource(Object.assign({},n),function(h,u){if(h)return ao(n,a,t,i,s,r);s.push(l),ao(u,n.type===u.type?a:ko[u.type],t,i,s,r)})}else a.length?ao(n,a,t,i,s,r):r?t(n,s):ao(n,ko["*"],t,i,s,!0)}const KB={opus:"video/ogg",ogv:"video/ogg",mp4:"video/mp4",mov:"video/mp4",m4v:"video/mp4",mkv:"video/x-matroska",m4a:"audio/mp4",mp3:"audio/mpeg",aac:"audio/aac",caf:"audio/x-caf",flac:"audio/flac",oga:"audio/ogg",wav:"audio/wav",m3u8:"application/x-mpegURL",mpd:"application/dash+xml",jpg:"image/jpeg",jpeg:"image/jpeg",gif:"image/gif",png:"image/png",svg:"image/svg+xml",webp:"image/webp"},Nd=function(n=""){const e=Uy(n);return KB[e.toLowerCase()]||""},JB=(n,e)=>{if(!e)return"";if(n.cache_.source.src===e&&n.cache_.source.type)return n.cache_.source.type;const t=n.cache_.sources.filter(s=>s.src===e);if(t.length)return t[0].type;const i=n.$$("source");for(let s=0;s<i.length;s++){const r=i[s];if(r.type&&r.src&&r.src===e)return r.type}return Nd(e)},wk=function(n){if(Array.isArray(n)){let e=[];n.forEach(function(t){t=wk(t),Array.isArray(t)?e=e.concat(t):Es(t)&&e.push(t)}),n=e}else typeof n=="string"&&n.trim()?n=[fS({src:n})]:Es(n)&&typeof n.src=="string"&&n.src&&n.src.trim()?n=[fS(n)]:n=[];return n};function fS(n){if(!n.type){const e=Nd(n.src);e&&(n.type=e)}return n}var eN=`<svg xmlns="http://www.w3.org/2000/svg">
  <defs>
    <symbol viewBox="0 0 48 48" id="vjs-icon-play">
      <path d="M16 10v28l22-14z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-pause">
      <path d="M12 38h8V10h-8v28zm16-28v28h8V10h-8z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-audio">
      <path d="M24 2C14.06 2 6 10.06 6 20v14c0 3.31 2.69 6 6 6h6V24h-8v-4c0-7.73 6.27-14 14-14s14 6.27 14 14v4h-8v16h6c3.31 0 6-2.69 6-6V20c0-9.94-8.06-18-18-18z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-captions">
      <path d="M38 8H10c-2.21 0-4 1.79-4 4v24c0 2.21 1.79 4 4 4h28c2.21 0 4-1.79 4-4V12c0-2.21-1.79-4-4-4zM22 22h-3v-1h-4v6h4v-1h3v2a2 2 0 0 1-2 2h-6a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h6a2 2 0 0 1 2 2v2zm14 0h-3v-1h-4v6h4v-1h3v2a2 2 0 0 1-2 2h-6a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h6a2 2 0 0 1 2 2v2z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-subtitles">
      <path d="M40 8H8c-2.21 0-4 1.79-4 4v24c0 2.21 1.79 4 4 4h32c2.21 0 4-1.79 4-4V12c0-2.21-1.79-4-4-4zM8 24h8v4H8v-4zm20 12H8v-4h20v4zm12 0h-8v-4h8v4zm0-8H20v-4h20v4z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-fullscreen-enter">
      <path d="M14 28h-4v10h10v-4h-6v-6zm-4-8h4v-6h6v-4H10v10zm24 14h-6v4h10V28h-4v6zm-6-24v4h6v6h4V10H28z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-fullscreen-exit">
      <path d="M10 32h6v6h4V28H10v4zm6-16h-6v4h10V10h-4v6zm12 22h4v-6h6v-4H28v10zm4-22v-6h-4v10h10v-4h-6z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-play-circle">
      <path d="M20 33l12-9-12-9v18zm4-29C12.95 4 4 12.95 4 24s8.95 20 20 20 20-8.95 20-20S35.05 4 24 4zm0 36c-8.82 0-16-7.18-16-16S15.18 8 24 8s16 7.18 16 16-7.18 16-16 16z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-volume-mute">
      <path d="M33 24c0-3.53-2.04-6.58-5-8.05v4.42l4.91 4.91c.06-.42.09-.85.09-1.28zm5 0c0 1.88-.41 3.65-1.08 5.28l3.03 3.03C41.25 29.82 42 27 42 24c0-8.56-5.99-15.72-14-17.54v4.13c5.78 1.72 10 7.07 10 13.41zM8.55 6L6 8.55 15.45 18H6v12h8l10 10V26.55l8.51 8.51c-1.34 1.03-2.85 1.86-4.51 2.36v4.13a17.94 17.94 0 0 0 7.37-3.62L39.45 42 42 39.45l-18-18L8.55 6zM24 8l-4.18 4.18L24 16.36V8z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-volume-low">
      <path d="M14 18v12h8l10 10V8L22 18h-8z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-volume-medium">
      <path d="M37 24c0-3.53-2.04-6.58-5-8.05v16.11c2.96-1.48 5-4.53 5-8.06zm-27-6v12h8l10 10V8L18 18h-8z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-volume-high">
      <path d="M6 18v12h8l10 10V8L14 18H6zm27 6c0-3.53-2.04-6.58-5-8.05v16.11c2.96-1.48 5-4.53 5-8.06zM28 6.46v4.13c5.78 1.72 10 7.07 10 13.41s-4.22 11.69-10 13.41v4.13c8.01-1.82 14-8.97 14-17.54S36.01 8.28 28 6.46z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-spinner">
      <path d="M18.8 21l9.53-16.51C26.94 4.18 25.49 4 24 4c-4.8 0-9.19 1.69-12.64 4.51l7.33 12.69.11-.2zm24.28-3c-1.84-5.85-6.3-10.52-11.99-12.68L23.77 18h19.31zm.52 2H28.62l.58 1 9.53 16.5C41.99 33.94 44 29.21 44 24c0-1.37-.14-2.71-.4-4zm-26.53 4l-7.8-13.5C6.01 14.06 4 18.79 4 24c0 1.37.14 2.71.4 4h14.98l-2.31-4zM4.92 30c1.84 5.85 6.3 10.52 11.99 12.68L24.23 30H4.92zm22.54 0l-7.8 13.51c1.4.31 2.85.49 4.34.49 4.8 0 9.19-1.69 12.64-4.51L29.31 26.8 27.46 30z"></path>
    </symbol>
    <symbol viewBox="0 0 24 24" id="vjs-icon-hd">
      <path d="M19 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-8 12H9.5v-2h-2v2H6V9h1.5v2.5h2V9H11v6zm2-6h4c.55 0 1 .45 1 1v4c0 .55-.45 1-1 1h-4V9zm1.5 4.5h2v-3h-2v3z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-chapters">
      <path d="M6 26h4v-4H6v4zm0 8h4v-4H6v4zm0-16h4v-4H6v4zm8 8h28v-4H14v4zm0 8h28v-4H14v4zm0-20v4h28v-4H14z"></path>
    </symbol>
    <symbol viewBox="0 0 40 40" id="vjs-icon-downloading">
      <path d="M18.208 36.875q-3.208-.292-5.979-1.729-2.771-1.438-4.812-3.729-2.042-2.292-3.188-5.229-1.146-2.938-1.146-6.23 0-6.583 4.334-11.416 4.333-4.834 10.833-5.5v3.166q-5.167.75-8.583 4.646Q6.25 14.75 6.25 19.958q0 5.209 3.396 9.104 3.396 3.896 8.562 4.646zM20 28.417L11.542 20l2.083-2.083 4.917 4.916v-11.25h2.916v11.25l4.875-4.916L28.417 20zm1.792 8.458v-3.167q1.833-.25 3.541-.958 1.709-.708 3.167-1.875l2.333 2.292q-1.958 1.583-4.25 2.541-2.291.959-4.791 1.167zm6.791-27.792q-1.541-1.125-3.25-1.854-1.708-.729-3.541-1.021V3.042q2.5.25 4.77 1.208 2.271.958 4.271 2.5zm4.584 21.584l-2.25-2.25q1.166-1.5 1.854-3.209.687-1.708.937-3.541h3.209q-.292 2.5-1.229 4.791-.938 2.292-2.521 4.209zm.541-12.417q-.291-1.833-.958-3.562-.667-1.73-1.833-3.188l2.375-2.208q1.541 1.916 2.458 4.208.917 2.292 1.167 4.75z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-file-download">
      <path d="M10.8 40.55q-1.35 0-2.375-1T7.4 37.15v-7.7h3.4v7.7h26.35v-7.7h3.4v7.7q0 1.4-1 2.4t-2.4 1zM24 32.1L13.9 22.05l2.45-2.45 5.95 5.95V7.15h3.4v18.4l5.95-5.95 2.45 2.45z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-file-download-done">
      <path d="M9.8 40.5v-3.45h28.4v3.45zm9.2-9.05L7.4 19.85l2.45-2.35L19 26.65l19.2-19.2 2.4 2.4z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-file-download-off">
      <path d="M4.9 4.75L43.25 43.1 41 45.3l-4.75-4.75q-.05.05-.075.025-.025-.025-.075-.025H10.8q-1.35 0-2.375-1T7.4 37.15v-7.7h3.4v7.7h22.05l-7-7-1.85 1.8L13.9 21.9l1.85-1.85L2.7 7zm26.75 14.7l2.45 2.45-3.75 3.8-2.45-2.5zM25.7 7.15V21.1l-3.4-3.45V7.15z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-share">
      <path d="M36 32.17c-1.52 0-2.89.59-3.93 1.54L17.82 25.4c.11-.45.18-.92.18-1.4s-.07-.95-.18-1.4l14.1-8.23c1.07 1 2.5 1.62 4.08 1.62 3.31 0 6-2.69 6-6s-2.69-6-6-6-6 2.69-6 6c0 .48.07.95.18 1.4l-14.1 8.23c-1.07-1-2.5-1.62-4.08-1.62-3.31 0-6 2.69-6 6s2.69 6 6 6c1.58 0 3.01-.62 4.08-1.62l14.25 8.31c-.1.42-.16.86-.16 1.31A5.83 5.83 0 1 0 36 32.17z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-cog">
      <path d="M38.86 25.95c.08-.64.14-1.29.14-1.95s-.06-1.31-.14-1.95l4.23-3.31c.38-.3.49-.84.24-1.28l-4-6.93c-.25-.43-.77-.61-1.22-.43l-4.98 2.01c-1.03-.79-2.16-1.46-3.38-1.97L29 4.84c-.09-.47-.5-.84-1-.84h-8c-.5 0-.91.37-.99.84l-.75 5.3a14.8 14.8 0 0 0-3.38 1.97L9.9 10.1a1 1 0 0 0-1.22.43l-4 6.93c-.25.43-.14.97.24 1.28l4.22 3.31C9.06 22.69 9 23.34 9 24s.06 1.31.14 1.95l-4.22 3.31c-.38.3-.49.84-.24 1.28l4 6.93c.25.43.77.61 1.22.43l4.98-2.01c1.03.79 2.16 1.46 3.38 1.97l.75 5.3c.08.47.49.84.99.84h8c.5 0 .91-.37.99-.84l.75-5.3a14.8 14.8 0 0 0 3.38-1.97l4.98 2.01a1 1 0 0 0 1.22-.43l4-6.93c.25-.43.14-.97-.24-1.28l-4.22-3.31zM24 31c-3.87 0-7-3.13-7-7s3.13-7 7-7 7 3.13 7 7-3.13 7-7 7z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-square">
      <path d="M36 8H12c-2.21 0-4 1.79-4 4v24c0 2.21 1.79 4 4 4h24c2.21 0 4-1.79 4-4V12c0-2.21-1.79-4-4-4zm0 28H12V12h24v24z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-circle">
      <circle cx="24" cy="24" r="20"></circle>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-circle-outline">
      <path d="M24 4C12.95 4 4 12.95 4 24s8.95 20 20 20 20-8.95 20-20S35.05 4 24 4zm0 36c-8.82 0-16-7.18-16-16S15.18 8 24 8s16 7.18 16 16-7.18 16-16 16z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-circle-inner-circle">
      <path d="M24 4C12.97 4 4 12.97 4 24s8.97 20 20 20 20-8.97 20-20S35.03 4 24 4zm0 36c-8.82 0-16-7.18-16-16S15.18 8 24 8s16 7.18 16 16-7.18 16-16 16zm6-16c0 3.31-2.69 6-6 6s-6-2.69-6-6 2.69-6 6-6 6 2.69 6 6z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-cancel">
      <path d="M24 4C12.95 4 4 12.95 4 24s8.95 20 20 20 20-8.95 20-20S35.05 4 24 4zm10 27.17L31.17 34 24 26.83 16.83 34 14 31.17 21.17 24 14 16.83 16.83 14 24 21.17 31.17 14 34 16.83 26.83 24 34 31.17z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-replay">
      <path d="M24 10V2L14 12l10 10v-8c6.63 0 12 5.37 12 12s-5.37 12-12 12-12-5.37-12-12H8c0 8.84 7.16 16 16 16s16-7.16 16-16-7.16-16-16-16z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-repeat">
      <path d="M14 14h20v6l8-8-8-8v6H10v12h4v-8zm20 20H14v-6l-8 8 8 8v-6h24V26h-4v8z"></path>
    </symbol>
    <symbol viewBox="0 96 48 48" id="vjs-icon-replay-5">
      <path d="M17.689 98l-8.697 8.696 8.697 8.697 2.486-2.485-4.32-4.319h1.302c4.93 0 9.071 1.722 12.424 5.165 3.352 3.443 5.029 7.638 5.029 12.584h3.55c0-2.958-.553-5.73-1.658-8.313-1.104-2.583-2.622-4.841-4.555-6.774-1.932-1.932-4.19-3.45-6.773-4.555-2.584-1.104-5.355-1.657-8.313-1.657H15.5l4.615-4.615zm-8.08 21.659v13.861h11.357v5.008H9.609V143h12.7c.834 0 1.55-.298 2.146-.894.596-.597.895-1.31.895-2.145v-7.781c0-.835-.299-1.55-.895-2.147a2.929 2.929 0 0 0-2.147-.894h-8.227v-5.096H25.35v-4.384z"></path>
    </symbol>
    <symbol viewBox="0 96 48 48" id="vjs-icon-replay-10">
      <path d="M42.315 125.63c0-4.997-1.694-9.235-5.08-12.713-3.388-3.479-7.571-5.218-12.552-5.218h-1.315l4.363 4.363-2.51 2.51-8.787-8.786L25.221 97l2.45 2.45-4.662 4.663h1.375c2.988 0 5.788.557 8.397 1.673 2.61 1.116 4.892 2.65 6.844 4.602 1.953 1.953 3.487 4.234 4.602 6.844 1.116 2.61 1.674 5.41 1.674 8.398zM8.183 142v-19.657H3.176V117.8h9.643V142zm13.63 0c-1.156 0-2.127-.393-2.912-1.178-.778-.778-1.168-1.746-1.168-2.902v-16.04c0-1.156.393-2.127 1.178-2.912.779-.779 1.746-1.168 2.902-1.168h7.696c1.156 0 2.126.392 2.911 1.177.779.78 1.168 1.747 1.168 2.903v16.04c0 1.156-.392 2.127-1.177 2.912-.779.779-1.746 1.168-2.902 1.168zm.556-4.636h6.583v-15.02H22.37z"></path>
    </symbol>
    <symbol viewBox="0 96 48 48" id="vjs-icon-replay-30">
      <path d="M26.047 97l-8.733 8.732 8.733 8.733 2.496-2.494-4.336-4.338h1.307c4.95 0 9.108 1.73 12.474 5.187 3.367 3.458 5.051 7.668 5.051 12.635h3.565c0-2.97-.556-5.751-1.665-8.346-1.109-2.594-2.633-4.862-4.574-6.802-1.94-1.941-4.208-3.466-6.803-4.575-2.594-1.109-5.375-1.664-8.345-1.664H23.85l4.634-4.634zM2.555 117.531v4.688h10.297v5.25H5.873v4.687h6.979v5.156H2.555V142H13.36c1.061 0 1.95-.395 2.668-1.186.718-.79 1.076-1.772 1.076-2.94v-16.218c0-1.168-.358-2.149-1.076-2.94-.717-.79-1.607-1.185-2.668-1.185zm22.482.14c-1.149 0-2.11.39-2.885 1.165-.78.78-1.172 1.744-1.172 2.893v15.943c0 1.149.388 2.11 1.163 2.885.78.78 1.745 1.172 2.894 1.172h7.649c1.148 0 2.11-.388 2.884-1.163.78-.78 1.17-1.745 1.17-2.894v-15.943c0-1.15-.386-2.111-1.16-2.885-.78-.78-1.746-1.172-2.894-1.172zm.553 4.518h6.545v14.93H25.59z"></path>
    </symbol>
    <symbol viewBox="0 96 48 48" id="vjs-icon-forward-5">
      <path d="M29.508 97l-2.431 2.43 4.625 4.625h-1.364c-2.965 0-5.742.554-8.332 1.66-2.589 1.107-4.851 2.629-6.788 4.566-1.937 1.937-3.458 4.2-4.565 6.788-1.107 2.59-1.66 5.367-1.66 8.331h3.557c0-4.957 1.68-9.16 5.04-12.611 3.36-3.45 7.51-5.177 12.451-5.177h1.304l-4.326 4.33 2.49 2.49 8.715-8.716zm-9.783 21.61v13.89h11.382v5.018H19.725V142h12.727a2.93 2.93 0 0 0 2.15-.896 2.93 2.93 0 0 0 .896-2.15v-7.798c0-.837-.299-1.554-.896-2.152a2.93 2.93 0 0 0-2.15-.896h-8.245V123h11.29v-4.392z"></path>
    </symbol>
    <symbol viewBox="0 96 48 48" id="vjs-icon-forward-10">
      <path d="M23.119 97l-2.386 2.383 4.538 4.538h-1.339c-2.908 0-5.633.543-8.173 1.63-2.54 1.085-4.76 2.577-6.66 4.478-1.9 1.9-3.392 4.12-4.478 6.66-1.085 2.54-1.629 5.264-1.629 8.172h3.49c0-4.863 1.648-8.986 4.944-12.372 3.297-3.385 7.368-5.078 12.216-5.078h1.279l-4.245 4.247 2.443 2.442 8.55-8.55zm-9.52 21.45v4.42h4.871V142h4.513v-23.55zm18.136 0c-1.125 0-2.066.377-2.824 1.135-.764.764-1.148 1.709-1.148 2.834v15.612c0 1.124.38 2.066 1.139 2.824.764.764 1.708 1.145 2.833 1.145h7.489c1.125 0 2.066-.378 2.824-1.136.764-.764 1.145-1.709 1.145-2.833v-15.612c0-1.125-.378-2.067-1.136-2.825-.764-.764-1.708-1.145-2.833-1.145zm.54 4.42h6.408v14.617h-6.407z"></path>
    </symbol>
    <symbol viewBox="0 96 48 48" id="vjs-icon-forward-30">
      <path d="M25.549 97l-2.437 2.434 4.634 4.635H26.38c-2.97 0-5.753.555-8.347 1.664-2.594 1.109-4.861 2.633-6.802 4.574-1.94 1.94-3.465 4.207-4.574 6.802-1.109 2.594-1.664 5.377-1.664 8.347h3.565c0-4.967 1.683-9.178 5.05-12.636 3.366-3.458 7.525-5.187 12.475-5.187h1.307l-4.335 4.338 2.495 2.494 8.732-8.732zm-11.553 20.53v4.689h10.297v5.249h-6.978v4.688h6.978v5.156H13.996V142h10.808c1.06 0 1.948-.395 2.666-1.186.718-.79 1.077-1.771 1.077-2.94v-16.217c0-1.169-.36-2.15-1.077-2.94-.718-.79-1.605-1.186-2.666-1.186zm21.174.168c-1.149 0-2.11.389-2.884 1.163-.78.78-1.172 1.745-1.172 2.894v15.942c0 1.15.388 2.11 1.162 2.885.78.78 1.745 1.17 2.894 1.17h7.649c1.149 0 2.11-.386 2.885-1.16.78-.78 1.17-1.746 1.17-2.895v-15.942c0-1.15-.387-2.11-1.161-2.885-.78-.78-1.745-1.172-2.894-1.172zm.552 4.516h6.542v14.931h-6.542z"></path>
    </symbol>
    <symbol viewBox="0 0 512 512" id="vjs-icon-audio-description">
      <g fill-rule="evenodd"><path d="M227.29 381.351V162.993c50.38-1.017 89.108-3.028 117.631 17.126 27.374 19.342 48.734 56.965 44.89 105.325-4.067 51.155-41.335 94.139-89.776 98.475-24.085 2.155-71.972 0-71.972 0s-.84-1.352-.773-2.568m48.755-54.804c31.43 1.26 53.208-16.633 56.495-45.386 4.403-38.51-21.188-63.552-58.041-60.796v103.612c-.036 1.466.575 2.22 1.546 2.57"></path><path d="M383.78 381.328c13.336 3.71 17.387-11.06 23.215-21.408 12.722-22.571 22.294-51.594 22.445-84.774.221-47.594-18.343-82.517-35.6-106.182h-8.51c-.587 3.874 2.226 7.315 3.865 10.276 13.166 23.762 25.367 56.553 25.54 94.194.2 43.176-14.162 79.278-30.955 107.894"></path><path d="M425.154 381.328c13.336 3.71 17.384-11.061 23.215-21.408 12.721-22.571 22.291-51.594 22.445-84.774.221-47.594-18.343-82.517-35.6-106.182h-8.511c-.586 3.874 2.226 7.315 3.866 10.276 13.166 23.762 25.367 56.553 25.54 94.194.2 43.176-14.162 79.278-30.955 107.894"></path><path d="M466.26 381.328c13.337 3.71 17.385-11.061 23.216-21.408 12.722-22.571 22.292-51.594 22.445-84.774.221-47.594-18.343-82.517-35.6-106.182h-8.51c-.587 3.874 2.225 7.315 3.865 10.276 13.166 23.762 25.367 56.553 25.54 94.194.2 43.176-14.162 79.278-30.955 107.894M4.477 383.005H72.58l18.573-28.484 64.169-.135s.065 19.413.065 28.62h48.756V160.307h-58.816c-5.653 9.537-140.85 222.697-140.85 222.697zm152.667-145.282v71.158l-40.453-.27 40.453-70.888z"></path></g>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-next-item">
      <path d="M12 36l17-12-17-12v24zm20-24v24h4V12h-4z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-previous-item">
      <path d="M12 12h4v24h-4zm7 12l17 12V12z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-shuffle">
      <path d="M21.17 18.34L10.83 8 8 10.83l10.34 10.34 2.83-2.83zM29 8l4.09 4.09L8 37.17 10.83 40l25.09-25.09L40 19V8H29zm.66 18.83l-2.83 2.83 6.26 6.26L29 40h11V29l-4.09 4.09-6.25-6.26z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-cast">
      <path d="M42 6H6c-2.21 0-4 1.79-4 4v6h4v-6h36v28H28v4h14c2.21 0 4-1.79 4-4V10c0-2.21-1.79-4-4-4zM2 36v6h6c0-3.31-2.69-6-6-6zm0-8v4c5.52 0 10 4.48 10 10h4c0-7.73-6.27-14-14-14zm0-8v4c9.94 0 18 8.06 18 18h4c0-12.15-9.85-22-22-22z"></path>
    </symbol>
    <symbol viewBox="0 0 48 48" id="vjs-icon-picture-in-picture-enter">
      <path d="M38 22H22v11.99h16V22zm8 16V9.96C46 7.76 44.2 6 42 6H6C3.8 6 2 7.76 2 9.96V38c0 2.2 1.8 4 4 4h36c2.2 0 4-1.8 4-4zm-4 .04H6V9.94h36v28.1z"></path>
    </symbol>
    <symbol viewBox="0 0 22 18" id="vjs-icon-picture-in-picture-exit">
      <path d="M18 4H4v10h14V4zm4 12V1.98C22 .88 21.1 0 20 0H2C.9 0 0 .88 0 1.98V16c0 1.1.9 2 2 2h18c1.1 0 2-.9 2-2zm-2 .02H2V1.97h18v14.05z"></path>
      <path fill="none" d="M-1-3h24v24H-1z"></path>
    </symbol>
    <symbol viewBox="0 0 1792 1792" id="vjs-icon-facebook">
      <path d="M1343 12v264h-157q-86 0-116 36t-30 108v189h293l-39 296h-254v759H734V905H479V609h255V391q0-186 104-288.5T1115 0q147 0 228 12z"></path>
    </symbol>
    <symbol viewBox="0 0 1792 1792" id="vjs-icon-linkedin">
      <path d="M477 625v991H147V625h330zm21-306q1 73-50.5 122T312 490h-2q-82 0-132-49t-50-122q0-74 51.5-122.5T314 148t133 48.5T498 319zm1166 729v568h-329v-530q0-105-40.5-164.5T1168 862q-63 0-105.5 34.5T999 982q-11 30-11 81v553H659q2-399 2-647t-1-296l-1-48h329v144h-2q20-32 41-56t56.5-52 87-43.5T1285 602q171 0 275 113.5t104 332.5z"></path>
    </symbol>
    <symbol viewBox="0 0 1200 1227" id="vjs-icon-twitter">
      <path d="M714.163 519.284L1160.89 0H1055.03L667.137 450.887L357.328 0H0L468.492 681.821L0 1226.37H105.866L515.491 750.218L842.672 1226.37H1200L714.137 519.284H714.163ZM569.165 687.828L521.697 619.934L144.011 79.6944H306.615L611.412 515.685L658.88 583.579L1055.08 1150.3H892.476L569.165 687.854V687.828Z"/>
    </symbol>
    <symbol viewBox="0 0 1792 1792" id="vjs-icon-tumblr">
      <path d="M1328 1329l80 237q-23 35-111 66t-177 32q-104 2-190.5-26T787 1564t-95-106-55.5-120-16.5-118V676H452V461q72-26 129-69.5t91-90 58-102 34-99T779 12q1-5 4.5-8.5T791 0h244v424h333v252h-334v518q0 30 6.5 56t22.5 52.5 49.5 41.5 81.5 14q78-2 134-29z"></path>
    </symbol>
    <symbol viewBox="0 0 1792 1792" id="vjs-icon-pinterest">
      <path d="M1664 896q0 209-103 385.5T1281.5 1561 896 1664q-111 0-218-32 59-93 78-164 9-34 54-211 20 39 73 67.5t114 28.5q121 0 216-68.5t147-188.5 52-270q0-114-59.5-214T1180 449t-255-63q-105 0-196 29t-154.5 77-109 110.5-67 129.5T377 866q0 104 40 183t117 111q30 12 38-20 2-7 8-31t8-30q6-23-11-43-51-61-51-151 0-151 104.5-259.5T904 517q151 0 235.5 82t84.5 213q0 170-68.5 289T980 1220q-61 0-98-43.5T859 1072q8-35 26.5-93.5t30-103T927 800q0-50-27-83t-77-33q-62 0-105 57t-43 142q0 73 25 122l-99 418q-17 70-13 177-206-91-333-281T128 896q0-209 103-385.5T510.5 231 896 128t385.5 103T1561 510.5 1664 896z"></path>
    </symbol>
  </defs>
</svg>`;const pS=Md?10009:Id?461:8,Go={codes:{play:415,pause:19,ff:417,rw:412,back:pS},names:{415:"play",19:"pause",417:"ff",412:"rw",[pS]:"back"},isEventKey(n,e){return e=e.toLowerCase(),!!(this.names[n.keyCode]&&this.names[n.keyCode]===e)},getEventName(n){if(this.names[n.keyCode])return this.names[n.keyCode];if(this.codes[n.code]){const e=this.codes[n.code];return this.names[e]}return null}},mS=5;class tN extends dn{constructor(e){super(),this.player_=e,this.focusableComponents=[],this.isListening_=!1,this.isPaused_=!1,this.onKeyDown_=this.onKeyDown_.bind(this),this.lastFocusedComponent_=null}start(){this.isListening_||(this.player_.on("keydown",this.onKeyDown_),this.player_.on("modalKeydown",this.onKeyDown_),this.player_.on("loadedmetadata",()=>{this.focus(this.updateFocusableComponents()[0])}),this.player_.on("modalclose",()=>{this.refocusComponent()}),this.player_.on("focusin",this.handlePlayerFocus_.bind(this)),this.player_.on("focusout",this.handlePlayerBlur_.bind(this)),this.isListening_=!0,this.player_.errorDisplay&&this.player_.errorDisplay.on("aftermodalfill",()=>{this.updateFocusableComponents(),this.focusableComponents.length&&(this.focusableComponents.length>1?this.focusableComponents[1].focus():this.focusableComponents[0].focus())}))}stop(){this.player_.off("keydown",this.onKeyDown_),this.isListening_=!1}onKeyDown_(e){const t=e.originalEvent?e.originalEvent:e;if(["ArrowLeft","ArrowRight","ArrowUp","ArrowDown"].includes(t.key)){if(this.isPaused_)return;t.preventDefault();const i=t.key.substring(5).toLowerCase();this.move(i)}else if(Go.isEventKey(t,"play")||Go.isEventKey(t,"pause")||Go.isEventKey(t,"ff")||Go.isEventKey(t,"rw")){t.preventDefault();const i=Go.getEventName(t);this.performMediaAction_(i)}else Go.isEventKey(t,"Back")&&e.target&&typeof e.target.closeable=="function"&&e.target.closeable()&&(t.preventDefault(),e.target.close())}performMediaAction_(e){if(this.player_)switch(e){case"play":this.player_.paused()&&this.player_.play();break;case"pause":this.player_.paused()||this.player_.pause();break;case"ff":this.userSeek_(this.player_.currentTime()+mS);break;case"rw":this.userSeek_(this.player_.currentTime()-mS);break}}userSeek_(e){this.player_.liveTracker&&this.player_.liveTracker.isLive()&&this.player_.liveTracker.nextSeekedFromUser(),this.player_.currentTime(e)}pause(){this.isPaused_=!0}resume(){this.isPaused_=!1}handlePlayerBlur_(e){const t=e.relatedTarget;let i=null;const s=this.getCurrentComponent(e.target);t&&(i=!!t.closest(".video-js"),t.classList.contains("vjs-text-track-settings")&&!this.isPaused_&&this.searchForTrackSelect_()),(!e.currentTarget.contains(e.relatedTarget)&&!i||!t)&&(s&&s.name()==="CloseButton"?this.refocusComponent():(this.pause(),s&&s.el()&&(this.lastFocusedComponent_=s)))}handlePlayerFocus_(){this.getCurrentComponent()&&this.getCurrentComponent().getIsFocusable()&&this.resume()}updateFocusableComponents(){const e=this.player_,t=[];function i(s){for(const r of s)r.hasOwnProperty("el_")&&r.getIsFocusable()&&r.getIsAvailableToBeFocused(r.el())&&t.push(r),r.hasOwnProperty("children_")&&r.children_.length>0&&i(r.children_)}return e.children_.forEach(s=>{if(s.hasOwnProperty("el_"))if(s.getIsFocusable&&s.getIsAvailableToBeFocused&&s.getIsFocusable()&&s.getIsAvailableToBeFocused(s.el())){t.push(s);return}else s.hasOwnProperty("children_")&&s.children_.length>0?i(s.children_):s.hasOwnProperty("items")&&s.items.length>0?i(s.items):this.findSuitableDOMChild(s)&&t.push(s);if(s.name_==="ErrorDisplay"&&s.opened_){const r=s.el_.querySelector(".vjs-errors-ok-button-container");r&&r.querySelectorAll("button").forEach((a,l)=>{t.push({name:()=>"ModalButton"+(l+1),el:()=>a,getPositions:()=>{const h=a.getBoundingClientRect(),u={x:h.x,y:h.y,width:h.width,height:h.height,top:h.top,right:h.right,bottom:h.bottom,left:h.left},c={x:h.left+h.width/2,y:h.top+h.height/2,width:0,height:0,top:h.top+h.height/2,right:h.left+h.width/2,bottom:h.top+h.height/2,left:h.left+h.width/2};return{boundingClientRect:u,center:c}},getIsAvailableToBeFocused:()=>!0,getIsFocusable:h=>!0,focus:()=>a.focus()})})}}),this.focusableComponents=t,this.focusableComponents}findSuitableDOMChild(e){function t(i){if(e.getIsFocusable(i)&&e.getIsAvailableToBeFocused(i))return i;for(let s=0;s<i.children.length;s++){const r=i.children[s],o=t(r);if(o)return o}return null}return e.el()?t(e.el()):null}getCurrentComponent(e){this.updateFocusableComponents();const t=e||document.activeElement;if(this.focusableComponents.length){for(const i of this.focusableComponents)if(i.el()===t)return i}}add(e){const t=[...this.focusableComponents];e.hasOwnProperty("el_")&&e.getIsFocusable()&&e.getIsAvailableToBeFocused(e.el())&&t.push(e),this.focusableComponents=t,this.trigger({type:"focusableComponentsChanged",focusableComponents:this.focusableComponents})}remove(e){for(let t=0;t<this.focusableComponents.length;t++)if(this.focusableComponents[t].name()===e.name()){this.focusableComponents.splice(t,1),this.trigger({type:"focusableComponentsChanged",focusableComponents:this.focusableComponents});return}}clear(){this.focusableComponents.length>0&&(this.focusableComponents=[],this.trigger({type:"focusableComponentsChanged",focusableComponents:this.focusableComponents}))}move(e){const t=this.getCurrentComponent();if(!t)return;const i=t.getPositions(),s=this.focusableComponents.filter(o=>o!==t&&this.isInDirection_(i.boundingClientRect,o.getPositions().boundingClientRect,e)),r=this.findBestCandidate_(i.center,s,e);r?this.focus(r):this.trigger({type:"endOfFocusableComponents",direction:e,focusedComponent:t})}findBestCandidate_(e,t,i){let s=1/0,r=null;for(const o of t){const a=o.getPositions().center,l=this.calculateDistance_(e,a,i);l<s&&(s=l,r=o)}return r}isInDirection_(e,t,i){switch(i){case"right":return t.left>=e.right;case"left":return t.right<=e.left;case"down":return t.top>=e.bottom;case"up":return t.bottom<=e.top;default:return!1}}refocusComponent(){if(this.lastFocusedComponent_){this.player_.userActive()||this.player_.userActive(!0),this.updateFocusableComponents();for(let e=0;e<this.focusableComponents.length;e++)if(this.focusableComponents[e].name()===this.lastFocusedComponent_.name()){this.focus(this.focusableComponents[e]);return}}else this.focus(this.updateFocusableComponents()[0])}focus(e){typeof e=="object"&&(e.getIsAvailableToBeFocused(e.el())?e.focus():this.findSuitableDOMChild(e)&&this.findSuitableDOMChild(e).focus())}calculateDistance_(e,t,i){const s=Math.abs(e.x-t.x),r=Math.abs(e.y-t.y);let o;switch(i){case"right":case"left":o=s+r*100;break;case"up":o=r*2+s*.5;break;case"down":o=r*5+s;break;default:o=s+r}return o}searchForTrackSelect_(){const e=this;for(const t of e.updateFocusableComponents())if(t.constructor.name==="TextTrackSelect"){e.focus(t);break}}}class iN extends ie{constructor(e,t,i){const s=at({createEl:!1},t);if(super(e,s,i),!t.playerOptions.sources||t.playerOptions.sources.length===0)for(let r=0,o=t.playerOptions.techOrder;r<o.length;r++){const a=Dt(o[r]);let l=Be.getTech(a);if(a||(l=ie.getComponent(a)),l&&l.isSupported()){e.loadTech_(a);break}}else e.src(t.playerOptions.sources)}}ie.registerComponent("MediaLoader",iN);class ip extends ie{constructor(e,t){super(e,t),this.options_.controlText&&this.controlText(this.options_.controlText),this.handleMouseOver_=i=>this.handleMouseOver(i),this.handleMouseOut_=i=>this.handleMouseOut(i),this.handleClick_=i=>this.handleClick(i),this.handleKeyDown_=i=>this.handleKeyDown(i),this.emitTapEvents(),this.enable()}createEl(e="div",t={},i={}){t=Object.assign({className:this.buildCSSClass(),tabIndex:0},t),e==="button"&&ze.error(`Creating a ClickableComponent with an HTML element of ${e} is not supported; use a Button instead.`),i=Object.assign({role:"button"},i),this.tabIndex_=t.tabIndex;const s=Le(e,t,i);return this.player_.options_.experimentalSvgIcons||s.appendChild(Le("span",{className:"vjs-icon-placeholder"},{"aria-hidden":!0})),this.createControlTextEl(s),s}dispose(){this.controlTextEl_=null,super.dispose()}createControlTextEl(e){return this.controlTextEl_=Le("span",{className:"vjs-control-text"},{"aria-live":"polite"}),e&&e.appendChild(this.controlTextEl_),this.controlText(this.controlText_,e),this.controlTextEl_}controlText(e,t=this.el()){if(e===void 0)return this.controlText_||"Need Text";const i=this.localize(e);this.controlText_=e,Zr(this.controlTextEl_,i),!this.nonIconControl&&!this.player_.options_.noUITitleAttributes&&t.setAttribute("title",i)}buildCSSClass(){return`vjs-control vjs-button ${super.buildCSSClass()}`}enable(){this.enabled_||(this.enabled_=!0,this.removeClass("vjs-disabled"),this.el_.setAttribute("aria-disabled","false"),typeof this.tabIndex_<"u"&&this.el_.setAttribute("tabIndex",this.tabIndex_),this.on(["tap","click"],this.handleClick_),this.on("keydown",this.handleKeyDown_))}disable(){this.enabled_=!1,this.addClass("vjs-disabled"),this.el_.setAttribute("aria-disabled","true"),typeof this.tabIndex_<"u"&&this.el_.removeAttribute("tabIndex"),this.off("mouseover",this.handleMouseOver_),this.off("mouseout",this.handleMouseOut_),this.off(["tap","click"],this.handleClick_),this.off("keydown",this.handleKeyDown_)}handleLanguagechange(){this.controlText(this.controlText_)}handleClick(e){this.options_.clickHandler&&this.options_.clickHandler.call(this,arguments)}handleKeyDown(e){e.key===" "||e.key==="Enter"?(e.preventDefault(),e.stopPropagation(),this.trigger("click")):super.handleKeyDown(e)}}ie.registerComponent("ClickableComponent",ip);class Yg extends ip{constructor(e,t){super(e,t),this.update(),this.update_=i=>this.update(i),e.on("posterchange",this.update_)}dispose(){this.player().off("posterchange",this.update_),super.dispose()}createEl(){return Le("div",{className:"vjs-poster"})}crossOrigin(e){if(typeof e>"u")return this.$("img")?this.$("img").crossOrigin:this.player_.tech_&&this.player_.tech_.isReady_?this.player_.crossOrigin():this.player_.options_.crossOrigin||this.player_.options_.crossorigin||null;if(e!==null&&e!=="anonymous"&&e!=="use-credentials"){this.player_.log.warn(`crossOrigin must be null,  "anonymous" or "use-credentials", given "${e}"`);return}this.$("img")&&(this.$("img").crossOrigin=e)}update(e){const t=this.player().poster();this.setSrc(t),t?this.show():this.hide()}setSrc(e){if(!e){this.el_.textContent="";return}this.$("img")||this.el_.appendChild(Le("picture",{className:"vjs-poster",tabIndex:-1},{},Le("img",{loading:"lazy",crossOrigin:this.crossOrigin()},{alt:""}))),this.$("img").src=e}handleClick(e){this.player_.controls()&&(this.player_.tech(!0)&&this.player_.tech(!0).focus(),this.player_.paused()?ms(this.player_.play()):this.player_.pause())}}Yg.prototype.crossorigin=Yg.prototype.crossOrigin;ie.registerComponent("PosterImage",Yg);const On="#222",gS="#ccc",nN={monospace:"monospace",sansSerif:"sans-serif",serif:"serif",monospaceSansSerif:'"Andale Mono", "Lucida Console", monospace',monospaceSerif:'"Courier New", monospace',proportionalSansSerif:"sans-serif",proportionalSerif:"serif",casual:'"Comic Sans MS", Impact, fantasy',script:'"Monotype Corsiva", cursive',smallcaps:'"Andale Mono", "Lucida Console", monospace, sans-serif'};function gm(n,e){let t;if(n.length===4)t=n[1]+n[1]+n[2]+n[2]+n[3]+n[3];else if(n.length===7)t=n.slice(1);else throw new Error("Invalid color code provided, "+n+"; must be formatted as e.g. #f0e or #f604e2.");return"rgba("+parseInt(t.slice(0,2),16)+","+parseInt(t.slice(2,4),16)+","+parseInt(t.slice(4,6),16)+","+e+")"}function ts(n,e,t){try{n.style[e]=t}catch{return}}function OS(n){return n?`${n}px`:""}class sN extends ie{constructor(e,t,i){super(e,t,i);const s=o=>this.updateDisplay(o),r=o=>{this.updateDisplayOverlay(),this.updateDisplay(o)};e.on("loadstart",o=>this.toggleDisplay(o)),e.on("useractive",s),e.on("userinactive",s),e.on("texttrackchange",s),e.on("loadedmetadata",o=>{this.updateDisplayOverlay(),this.preselectTrack(o)}),e.ready(pt(this,function(){if(e.tech_&&e.tech_.featuresNativeTextTracks){this.hide();return}e.on("fullscreenchange",r),e.on("playerresize",r);const o=V.screen.orientation||V,a=V.screen.orientation?"change":"orientationchange";o.addEventListener(a,r),e.on("dispose",()=>o.removeEventListener(a,r));const l=this.options_.playerOptions.tracks||[];for(let h=0;h<l.length;h++)this.player_.addRemoteTextTrack(l[h],!0);this.preselectTrack()}))}preselectTrack(){const e={captions:1,subtitles:1},t=this.player_.textTracks(),i=this.player_.cache_.selectedLanguage;let s,r,o;for(let a=0;a<t.length;a++){const l=t[a];i&&i.enabled&&i.language&&i.language===l.language&&l.kind in e?l.kind===i.kind?o=l:o||(o=l):i&&!i.enabled?(o=null,s=null,r=null):l.default&&(l.kind==="descriptions"&&!s?s=l:l.kind in e&&!r&&(r=l))}o?o.mode="showing":r?r.mode="showing":s&&(s.mode="showing")}toggleDisplay(){this.player_.tech_&&this.player_.tech_.featuresNativeTextTracks?this.hide():this.show()}createEl(){return super.createEl("div",{className:"vjs-text-track-display"},{translate:"yes","aria-live":"off","aria-atomic":"true"})}clearDisplay(){typeof V.WebVTT=="function"&&V.WebVTT.processCues(V,[],this.el_)}updateDisplay(){const e=this.player_.textTracks(),t=this.options_.allowMultipleShowingTracks;if(this.clearDisplay(),t){const o=[];for(let a=0;a<e.length;++a){const l=e[a];l.mode==="showing"&&o.push(l)}this.updateForTrack(o);return}let i=null,s=null,r=e.length;for(;r--;){const o=e[r];o.mode==="showing"&&(o.kind==="descriptions"?i=o:s=o)}if(s?(this.getAttribute("aria-live")!=="off"&&this.setAttribute("aria-live","off"),this.updateForTrack(s)):i&&(this.getAttribute("aria-live")!=="assertive"&&this.setAttribute("aria-live","assertive"),this.updateForTrack(i)),!V.CSS.supports("inset","10px")){const o=this.el_,a=o.querySelectorAll(".vjs-text-track-cue"),l=this.player_.controlBar.el_.getBoundingClientRect().height,h=this.player_.el_.getBoundingClientRect().height;o.style="",ts(o,"position","relative"),ts(o,"height",h-l+"px"),ts(o,"top","unset"),Rd?ts(o,"bottom",h+"px"):ts(o,"bottom","0px"),a.length>0&&a.forEach(u=>{if(u.style.inset){const c=u.style.inset.split(" ");c.length===3&&Object.assign(u.style,{top:c[0],right:c[1],bottom:c[2],left:"unset"})}})}}updateDisplayOverlay(){if(!this.player_.videoHeight()||!V.CSS.supports("inset-inline: 10px"))return;const e=this.player_.currentWidth(),t=this.player_.currentHeight(),i=e/t,s=this.player_.videoWidth()/this.player_.videoHeight();let r=0,o=0;Math.abs(i-s)>.1&&(i>s?r=Math.round((e-t*s)/2):o=Math.round((t-e/s)/2)),ts(this.el_,"insetInline",OS(r)),ts(this.el_,"insetBlock",OS(o))}updateDisplayState(e){const t=this.player_.textTrackSettings.getValues(),i=e.activeCues;let s=i.length;for(;s--;){const r=i[s];if(!r)continue;const o=r.displayState;if(t.color&&(o.firstChild.style.color=t.color),t.textOpacity&&ts(o.firstChild,"color",gm(t.color||"#fff",t.textOpacity)),t.backgroundColor&&(o.firstChild.style.backgroundColor=t.backgroundColor),t.backgroundOpacity&&ts(o.firstChild,"backgroundColor",gm(t.backgroundColor||"#000",t.backgroundOpacity)),t.windowColor&&(t.windowOpacity?ts(o,"backgroundColor",gm(t.windowColor,t.windowOpacity)):o.style.backgroundColor=t.windowColor),t.edgeStyle&&(t.edgeStyle==="dropshadow"?o.firstChild.style.textShadow=`2px 2px 3px ${On}, 2px 2px 4px ${On}, 2px 2px 5px ${On}`:t.edgeStyle==="raised"?o.firstChild.style.textShadow=`1px 1px ${On}, 2px 2px ${On}, 3px 3px ${On}`:t.edgeStyle==="depressed"?o.firstChild.style.textShadow=`1px 1px ${gS}, 0 1px ${gS}, -1px -1px ${On}, 0 -1px ${On}`:t.edgeStyle==="uniform"&&(o.firstChild.style.textShadow=`0 0 4px ${On}, 0 0 4px ${On}, 0 0 4px ${On}, 0 0 4px ${On}`)),t.fontPercent&&t.fontPercent!==1){const a=V.parseFloat(o.style.fontSize);o.style.fontSize=a*t.fontPercent+"px",o.style.height="auto",o.style.top="auto"}t.fontFamily&&t.fontFamily!=="default"&&(t.fontFamily==="small-caps"?o.firstChild.style.fontVariant="small-caps":o.firstChild.style.fontFamily=nN[t.fontFamily])}}updateForTrack(e){if(Array.isArray(e)||(e=[e]),typeof V.WebVTT!="function"||e.every(i=>!i.activeCues))return;const t=[];for(let i=0;i<e.length;++i){const s=e[i];for(let r=0;r<s.activeCues.length;++r)t.push(s.activeCues[r])}V.WebVTT.processCues(V,t,this.el_);for(let i=0;i<e.length;++i){const s=e[i];for(let r=0;r<s.activeCues.length;++r){const o=s.activeCues[r].displayState;_o(o,"vjs-text-track-cue","vjs-text-track-cue-"+(s.language?s.language:i)),s.language&&Na(o,"lang",s.language)}this.player_.textTrackSettings&&this.updateDisplayState(s)}}}ie.registerComponent("TextTrackDisplay",sN);class rN extends ie{createEl(){const e=this.player_.isAudio(),t=this.localize(e?"Audio Player":"Video Player"),i=Le("span",{className:"vjs-control-text",textContent:this.localize("{1} is loading.",[t])}),s=super.createEl("div",{className:"vjs-loading-spinner",dir:"ltr"});return s.appendChild(i),s}handleLanguagechange(){this.$(".vjs-control-text").textContent=this.localize("{1} is loading.",[this.player_.isAudio()?"Audio Player":"Video Player"])}}ie.registerComponent("LoadingSpinner",rN);class vi extends ip{createEl(e,t={},i={}){e="button",t=Object.assign({className:this.buildCSSClass()},t),i=Object.assign({type:"button"},i);const s=Le(e,t,i);return this.player_.options_.experimentalSvgIcons||s.appendChild(Le("span",{className:"vjs-icon-placeholder"},{"aria-hidden":!0})),this.createControlTextEl(s),s}addChild(e,t={}){const i=this.constructor.name;return ze.warn(`Adding an actionable (user controllable) child to a Button (${i}) is not supported; use a ClickableComponent instead.`),ie.prototype.addChild.call(this,e,t)}enable(){super.enable(),this.el_.removeAttribute("disabled")}disable(){super.disable(),this.el_.setAttribute("disabled","disabled")}handleKeyDown(e){if(e.key===" "||e.key==="Enter"){e.stopPropagation();return}super.handleKeyDown(e)}}ie.registerComponent("Button",vi);class _k extends vi{constructor(e,t){super(e,t),this.mouseused_=!1,this.setIcon("play"),this.on("mousedown",i=>this.handleMouseDown(i))}buildCSSClass(){return"vjs-big-play-button"}handleClick(e){const t=this.player_.play();if(e.type==="tap"||this.mouseused_&&"clientX"in e&&"clientY"in e){ms(t),this.player_.tech(!0)&&this.player_.tech(!0).focus();return}const i=this.player_.getChild("controlBar"),s=i&&i.getChild("playToggle");if(!s){this.player_.tech(!0).focus();return}const r=()=>s.focus();bh(t)?t.then(r,()=>{}):this.setTimeout(r,1)}handleKeyDown(e){this.mouseused_=!1,super.handleKeyDown(e)}handleMouseDown(e){this.mouseused_=!0}}_k.prototype.controlText_="Play Video";ie.registerComponent("BigPlayButton",_k);class oN extends vi{constructor(e,t){super(e,t),this.setIcon("cancel"),this.controlText(t&&t.controlText||this.localize("Close"))}buildCSSClass(){return`vjs-close-button ${super.buildCSSClass()}`}handleClick(e){this.trigger({type:"close",bubbles:!1})}handleKeyDown(e){e.key==="Escape"?(e.preventDefault(),e.stopPropagation(),this.trigger("click")):super.handleKeyDown(e)}}ie.registerComponent("CloseButton",oN);class kk extends vi{constructor(e,t={}){super(e,t),t.replay=t.replay===void 0||t.replay,this.setIcon("play"),this.on(e,"play",i=>this.handlePlay(i)),this.on(e,"pause",i=>this.handlePause(i)),t.replay&&this.on(e,"ended",i=>this.handleEnded(i))}buildCSSClass(){return`vjs-play-control ${super.buildCSSClass()}`}handleClick(e){this.player_.paused()?ms(this.player_.play()):this.player_.pause()}handleSeeked(e){this.removeClass("vjs-ended"),this.player_.paused()?this.handlePause(e):this.handlePlay(e)}handlePlay(e){this.removeClass("vjs-ended","vjs-paused"),this.addClass("vjs-playing"),this.setIcon("pause"),this.controlText("Pause")}handlePause(e){this.removeClass("vjs-playing"),this.addClass("vjs-paused"),this.setIcon("play"),this.controlText("Play")}handleEnded(e){this.removeClass("vjs-playing"),this.addClass("vjs-ended"),this.setIcon("replay"),this.controlText("Replay"),this.one(this.player_,"seeked",t=>this.handleSeeked(t))}}kk.prototype.controlText_="Play";ie.registerComponent("PlayToggle",kk);class dl extends ie{constructor(e,t){super(e,t),this.on(e,["timeupdate","ended","seeking"],i=>this.update(i)),this.updateTextNode_()}createEl(){const e=this.buildCSSClass(),t=super.createEl("div",{className:`${e} vjs-time-control vjs-control`}),i=Le("span",{className:"vjs-control-text",textContent:`${this.localize(this.labelText_)} `},{role:"presentation"});return t.appendChild(i),this.contentEl_=Le("span",{className:`${e}-display`},{role:"presentation"}),t.appendChild(this.contentEl_),t}dispose(){this.contentEl_=null,this.textNode_=null,super.dispose()}update(e){!this.player_.options_.enableSmoothSeeking&&e.type==="seeking"||this.updateContent(e)}updateTextNode_(e=0){e=Po(e),this.formattedTime_!==e&&(this.formattedTime_=e,this.requestNamedAnimationFrame("TimeDisplay#updateTextNode_",()=>{if(!this.contentEl_)return;let t=this.textNode_;t&&this.contentEl_.firstChild!==t&&(t=null,ze.warn("TimeDisplay#updateTextnode_: Prevented replacement of text node element since it was no longer a child of this node. Appending a new node instead.")),this.textNode_=he.createTextNode(this.formattedTime_),this.textNode_&&(t?this.contentEl_.replaceChild(this.textNode_,t):this.contentEl_.appendChild(this.textNode_))}))}updateContent(e){}}dl.prototype.labelText_="Time";dl.prototype.controlText_="Time";ie.registerComponent("TimeDisplay",dl);class zy extends dl{buildCSSClass(){return"vjs-current-time"}updateContent(e){let t;this.player_.ended()?t=this.player_.duration():e&&e.target&&typeof e.target.pendingSeekTime=="function"?t=e.target.pendingSeekTime():t=this.player_.scrubbing()?this.player_.getCache().currentTime:this.player_.currentTime(),this.updateTextNode_(t)}}zy.prototype.labelText_="Current Time";zy.prototype.controlText_="Current Time";ie.registerComponent("CurrentTimeDisplay",zy);class jy extends dl{constructor(e,t){super(e,t);const i=s=>this.updateContent(s);this.on(e,"durationchange",i),this.on(e,"loadstart",i),this.on(e,"loadedmetadata",i)}buildCSSClass(){return"vjs-duration"}updateContent(e){const t=this.player_.duration();this.updateTextNode_(t)}}jy.prototype.labelText_="Duration";jy.prototype.controlText_="Duration";ie.registerComponent("DurationDisplay",jy);class aN extends ie{createEl(){const e=super.createEl("div",{className:"vjs-time-control vjs-time-divider"},{"aria-hidden":!0}),t=super.createEl("div"),i=super.createEl("span",{textContent:"/"});return t.appendChild(i),e.appendChild(t),e}}ie.registerComponent("TimeDivider",aN);class Xy extends dl{constructor(e,t){super(e,t),this.on(e,"durationchange",i=>this.updateContent(i))}buildCSSClass(){return"vjs-remaining-time"}createEl(){const e=super.createEl();return this.options_.displayNegative!==!1&&e.insertBefore(Le("span",{},{"aria-hidden":!0},"-"),this.contentEl_),e}updateContent(e){if(typeof this.player_.duration()!="number")return;let t;this.player_.ended()?t=0:this.player_.remainingTimeDisplay?t=this.player_.remainingTimeDisplay():t=this.player_.remainingTime(),this.updateTextNode_(t)}}Xy.prototype.labelText_="Remaining Time";Xy.prototype.controlText_="Remaining Time";ie.registerComponent("RemainingTimeDisplay",Xy);class lN extends ie{constructor(e,t){super(e,t),this.updateShowing(),this.on(this.player(),"durationchange",i=>this.updateShowing(i))}createEl(){const e=super.createEl("div",{className:"vjs-live-control vjs-control"});return this.contentEl_=Le("div",{className:"vjs-live-display"},{"aria-live":"off"}),this.contentEl_.appendChild(Le("span",{className:"vjs-control-text",textContent:`${this.localize("Stream Type")} `})),this.contentEl_.appendChild(he.createTextNode(this.localize("LIVE"))),e.appendChild(this.contentEl_),e}dispose(){this.contentEl_=null,super.dispose()}updateShowing(e){this.player().duration()===1/0?this.show():this.hide()}}ie.registerComponent("LiveDisplay",lN);class Ck extends vi{constructor(e,t){super(e,t),this.updateLiveEdgeStatus(),this.player_.liveTracker&&(this.updateLiveEdgeStatusHandler_=i=>this.updateLiveEdgeStatus(i),this.on(this.player_.liveTracker,"liveedgechange",this.updateLiveEdgeStatusHandler_))}createEl(){const e=super.createEl("button",{className:"vjs-seek-to-live-control vjs-control"});return this.setIcon("circle",e),this.textEl_=Le("span",{className:"vjs-seek-to-live-text",textContent:this.localize("LIVE")},{"aria-hidden":"true"}),e.appendChild(this.textEl_),e}updateLiveEdgeStatus(){!this.player_.liveTracker||this.player_.liveTracker.atLiveEdge()?(this.setAttribute("aria-disabled",!0),this.addClass("vjs-at-live-edge"),this.controlText("Seek to live, currently playing live")):(this.setAttribute("aria-disabled",!1),this.removeClass("vjs-at-live-edge"),this.controlText("Seek to live, currently behind live"))}handleClick(){this.player_.liveTracker.seekToLiveEdge()}dispose(){this.player_.liveTracker&&this.off(this.player_.liveTracker,"liveedgechange",this.updateLiveEdgeStatusHandler_),this.textEl_=null,super.dispose()}}Ck.prototype.controlText_="Seek to live, currently playing live";ie.registerComponent("SeekToLive",Ck);function xu(n,e,t){return n=Number(n),Math.min(t,Math.max(e,isNaN(n)?e:n))}var hN=Object.freeze({__proto__:null,clamp:xu});class Hy extends ie{constructor(e,t){super(e,t),this.handleMouseDown_=i=>this.handleMouseDown(i),this.handleMouseUp_=i=>this.handleMouseUp(i),this.handleKeyDown_=i=>this.handleKeyDown(i),this.handleClick_=i=>this.handleClick(i),this.handleMouseMove_=i=>this.handleMouseMove(i),this.update_=i=>this.update(i),this.bar=this.getChild(this.options_.barName),this.vertical(!!this.options_.vertical),this.enable()}enabled(){return this.enabled_}enable(){this.enabled()||(this.on("mousedown",this.handleMouseDown_),this.on("touchstart",this.handleMouseDown_),this.on("keydown",this.handleKeyDown_),this.on("click",this.handleClick_),this.on(this.player_,"controlsvisible",this.update),this.playerEvent&&this.on(this.player_,this.playerEvent,this.update),this.removeClass("disabled"),this.setAttribute("tabindex",0),this.enabled_=!0)}disable(){if(!this.enabled())return;const e=this.bar.el_.ownerDocument;this.off("mousedown",this.handleMouseDown_),this.off("touchstart",this.handleMouseDown_),this.off("keydown",this.handleKeyDown_),this.off("click",this.handleClick_),this.off(this.player_,"controlsvisible",this.update_),this.off(e,"mousemove",this.handleMouseMove_),this.off(e,"mouseup",this.handleMouseUp_),this.off(e,"touchmove",this.handleMouseMove_),this.off(e,"touchend",this.handleMouseUp_),this.removeAttribute("tabindex"),this.addClass("disabled"),this.playerEvent&&this.off(this.player_,this.playerEvent,this.update),this.enabled_=!1}createEl(e,t={},i={}){return t.className=t.className+" vjs-slider",t=Object.assign({tabIndex:0},t),i=Object.assign({role:"slider","aria-valuenow":0,"aria-valuemin":0,"aria-valuemax":100},i),super.createEl(e,t,i)}handleMouseDown(e){const t=this.bar.el_.ownerDocument;e.type==="mousedown"&&e.preventDefault(),e.type==="touchstart"&&!As&&e.preventDefault(),J2(),this.addClass("vjs-sliding"),this.trigger("slideractive"),this.on(t,"mousemove",this.handleMouseMove_),this.on(t,"mouseup",this.handleMouseUp_),this.on(t,"touchmove",this.handleMouseMove_),this.on(t,"touchend",this.handleMouseUp_),this.handleMouseMove(e,!0)}handleMouseMove(e){}handleMouseUp(e){const t=this.bar.el_.ownerDocument;ek(),this.removeClass("vjs-sliding"),this.trigger("sliderinactive"),this.off(t,"mousemove",this.handleMouseMove_),this.off(t,"mouseup",this.handleMouseUp_),this.off(t,"touchmove",this.handleMouseMove_),this.off(t,"touchend",this.handleMouseUp_),this.update()}update(){if(!this.el_||!this.bar)return;const e=this.getProgress();return e===this.progress_||(this.progress_=e,this.requestNamedAnimationFrame("Slider#update",()=>{const t=this.vertical()?"height":"width";this.bar.el().style[t]=(e*100).toFixed(2)+"%"})),e}getProgress(){return Number(xu(this.getPercent(),0,1).toFixed(4))}calculateDistance(e){const t=Yf(this.el_,e);return this.vertical()?t.y:t.x}handleKeyDown(e){const t=this.options_.playerOptions.spatialNavigation,i=t&&t.enabled,s=t&&t.horizontalSeek;i?s&&e.key==="ArrowLeft"||!s&&e.key==="ArrowDown"?(e.preventDefault(),e.stopPropagation(),this.stepBack()):s&&e.key==="ArrowRight"||!s&&e.key==="ArrowUp"?(e.preventDefault(),e.stopPropagation(),this.stepForward()):(this.pendingSeekTime()&&(this.pendingSeekTime(null),this.userSeek_(this.player_.currentTime())),super.handleKeyDown(e)):e.key==="ArrowLeft"||e.key==="ArrowDown"?(e.preventDefault(),e.stopPropagation(),this.stepBack()):e.key==="ArrowUp"||e.key==="ArrowRight"?(e.preventDefault(),e.stopPropagation(),this.stepForward()):super.handleKeyDown(e)}handleClick(e){e.stopPropagation(),e.preventDefault()}vertical(e){if(e===void 0)return this.vertical_||!1;this.vertical_=!!e,this.vertical_?this.addClass("vjs-slider-vertical"):this.addClass("vjs-slider-horizontal")}}ie.registerComponent("Slider",Hy);const Om=(n,e)=>xu(n/e*100,0,100).toFixed(2)+"%";class uN extends ie{constructor(e,t){super(e,t),this.partEls_=[],this.on(e,"progress",i=>this.update(i))}createEl(){const e=super.createEl("div",{className:"vjs-load-progress"}),t=Le("span",{className:"vjs-control-text"}),i=Le("span",{textContent:this.localize("Loaded")}),s=he.createTextNode(": ");return this.percentageEl_=Le("span",{className:"vjs-control-text-loaded-percentage",textContent:"0%"}),e.appendChild(t),t.appendChild(i),t.appendChild(s),t.appendChild(this.percentageEl_),e}dispose(){this.partEls_=null,this.percentageEl_=null,super.dispose()}update(e){this.requestNamedAnimationFrame("LoadProgressBar#update",()=>{const t=this.player_.liveTracker,i=this.player_.buffered(),s=t&&t.isLive()?t.seekableEnd():this.player_.duration(),r=this.player_.bufferedEnd(),o=this.partEls_,a=Om(r,s);this.percent_!==a&&(this.el_.style.width=a,Zr(this.percentageEl_,a),this.percent_=a);for(let l=0;l<i.length;l++){const h=i.start(l),u=i.end(l);let c=o[l];c||(c=this.el_.appendChild(Le()),o[l]=c),!(c.dataset.start===h&&c.dataset.end===u)&&(c.dataset.start=h,c.dataset.end=u,c.style.left=Om(h,r),c.style.width=Om(u-h,r))}for(let l=o.length;l>i.length;l--)this.el_.removeChild(o[l-1]);o.length=i.length})}}ie.registerComponent("LoadProgressBar",uN);class cN extends ie{constructor(e,t){super(e,t),this.update=Ps(pt(this,this.update),Pn)}createEl(){return super.createEl("div",{className:"vjs-time-tooltip"},{"aria-hidden":"true"})}update(e,t,i){const s=Vh(this.el_),r=Fa(this.player_.el()),o=e.width*t;if(!r||!s)return;let a=e.left-r.left+o,l=e.width-o+(r.right-e.right);l||(l=e.width-o,a=o);let h=s.width/2;a<h?h+=h-a:l<h&&(h=l),h<0?h=0:h>s.width&&(h=s.width),h=Math.round(h),this.el_.style.right=`-${h}px`,this.write(i)}write(e){Zr(this.el_,e)}updateTime(e,t,i,s){this.requestNamedAnimationFrame("TimeTooltip#updateTime",()=>{let r;const o=this.player_.duration();if(this.player_.liveTracker&&this.player_.liveTracker.isLive()){const a=this.player_.liveTracker.liveWindow(),l=a-t*a;r=(l<1?"":"-")+Po(l,a)}else r=Po(i,o);this.update(e,t,r),s&&s()})}}ie.registerComponent("TimeTooltip",cN);class Wy extends ie{constructor(e,t){super(e,t),this.setIcon("circle"),this.update=Ps(pt(this,this.update),Pn)}createEl(){return super.createEl("div",{className:"vjs-play-progress vjs-slider-bar"},{"aria-hidden":"true"})}update(e,t,i){const s=this.getChild("timeTooltip");if(!s)return;const r=i&&i.target&&typeof i.target.pendingSeekTime=="function"?i.target.pendingSeekTime():this.player_.scrubbing()?this.player_.getCache().currentTime:this.player_.currentTime();s.updateTime(e,t,r)}}Wy.prototype.options_={children:[]};!yi&&!Wn&&Wy.prototype.options_.children.push("timeTooltip");ie.registerComponent("PlayProgressBar",Wy);class Ek extends ie{constructor(e,t){super(e,t),this.update=Ps(pt(this,this.update),Pn)}createEl(){return super.createEl("div",{className:"vjs-mouse-display"})}update(e,t){const i=t*this.player_.duration();this.getChild("timeTooltip").updateTime(e,t,i,()=>{this.el_.style.left=`${e.width*t}px`})}}Ek.prototype.options_={children:["timeTooltip"]};ie.registerComponent("MouseTimeDisplay",Ek);class np extends Hy{constructor(e,t){t=at(np.prototype.options_,t),t.children=[...t.children];const i=e.options_.disableSeekWhileScrubbingOnMobile&&(yi||Wn)||e.options_.disableSeekWhileScrubbingOnSTV;(!yi&&!Wn||i)&&t.children.splice(1,0,"mouseTimeDisplay"),super(e,t),this.shouldDisableSeekWhileScrubbing_=i,this.pendingSeekTime_=null,this.setEventHandlers_()}setEventHandlers_(){this.update_=pt(this,this.update),this.update=Ps(this.update_,Pn),this.on(this.player_,["durationchange","timeupdate"],this.update),this.on(this.player_,["ended"],this.update_),this.player_.liveTracker&&this.on(this.player_.liveTracker,"liveedgechange",this.update),this.updateInterval=null,this.enableIntervalHandler_=e=>this.enableInterval_(e),this.disableIntervalHandler_=e=>this.disableInterval_(e),this.on(this.player_,["playing"],this.enableIntervalHandler_),this.on(this.player_,["ended","pause","waiting"],this.disableIntervalHandler_),"hidden"in he&&"visibilityState"in he&&this.on(he,"visibilitychange",this.toggleVisibility_)}toggleVisibility_(e){he.visibilityState==="hidden"?(this.cancelNamedAnimationFrame("SeekBar#update"),this.cancelNamedAnimationFrame("Slider#update"),this.disableInterval_(e)):(!this.player_.ended()&&!this.player_.paused()&&this.enableInterval_(),this.update())}enableInterval_(){this.updateInterval||(this.updateInterval=this.setInterval(this.update,Pn))}disableInterval_(e){this.player_.liveTracker&&this.player_.liveTracker.isLive()&&e&&e.type!=="ended"||this.updateInterval&&(this.clearInterval(this.updateInterval),this.updateInterval=null)}createEl(){return super.createEl("div",{className:"vjs-progress-holder"},{"aria-label":this.localize("Progress Bar")})}update(e){if(he.visibilityState==="hidden")return;const t=super.update();return this.requestNamedAnimationFrame("SeekBar#update",()=>{const i=this.player_.ended()?this.player_.duration():this.getCurrentTime_(),s=this.player_.liveTracker;let r=this.player_.duration();s&&s.isLive()&&(r=this.player_.liveTracker.liveCurrentTime()),this.percent_!==t&&(this.el_.setAttribute("aria-valuenow",(t*100).toFixed(2)),this.percent_=t),(this.currentTime_!==i||this.duration_!==r)&&(this.el_.setAttribute("aria-valuetext",this.localize("progress bar timing: currentTime={1} duration={2}",[Po(i,r),Po(r,r)],"{1} of {2}")),this.currentTime_=i,this.duration_=r),this.bar&&this.bar.update(Fa(this.el()),this.getProgress(),e)}),t}userSeek_(e){this.player_.liveTracker&&this.player_.liveTracker.isLive()&&this.player_.liveTracker.nextSeekedFromUser(),this.player_.currentTime(e)}getCurrentTime_(){return this.player_.scrubbing()?this.player_.getCache().currentTime:this.player_.currentTime()}pendingSeekTime(e){if(e!==void 0)if(e!==null){const t=this.player_.duration();this.pendingSeekTime_=Math.max(0,Math.min(e,t))}else this.pendingSeekTime_=null;return this.pendingSeekTime_}getPercent(){if(this.pendingSeekTime()!==null)return this.pendingSeekTime()/this.player_.duration();const e=this.getCurrentTime_();let t;const i=this.player_.liveTracker;return i&&i.isLive()?(t=(e-i.seekableStart())/i.liveWindow(),i.atLiveEdge()&&(t=1)):t=e/this.player_.duration(),t}handleMouseDown(e){Uh(e)&&(e.stopPropagation(),this.videoWasPlaying=!this.player_.paused(),this.shouldDisableSeekWhileScrubbing_||this.player_.pause(),super.handleMouseDown(e))}handleMouseMove(e,t=!1){if(!Uh(e)||isNaN(this.player_.duration()))return;!t&&!this.player_.scrubbing()&&this.player_.scrubbing(!0);let i;const s=this.calculateDistance(e),r=this.player_.liveTracker;if(!r||!r.isLive())i=s*this.player_.duration(),i===this.player_.duration()&&(i=i-.1);else{if(s>=.99){r.seekToLiveEdge();return}const o=r.seekableStart(),a=r.liveCurrentTime();if(i=o+s*r.liveWindow(),i>=a&&(i=a),i<=o&&(i=o+.1),i===1/0)return}this.shouldDisableSeekWhileScrubbing_?this.pendingSeekTime(i):this.userSeek_(i),this.player_.options_.enableSmoothSeeking&&this.update()}enable(){super.enable();const e=this.getChild("mouseTimeDisplay");e&&e.show()}disable(){super.disable();const e=this.getChild("mouseTimeDisplay");e&&e.hide()}handleMouseUp(e){super.handleMouseUp(e),e&&e.stopPropagation(),this.player_.scrubbing(!1),this.pendingSeekTime()!==null&&(this.userSeek_(this.pendingSeekTime()),this.pendingSeekTime(null)),this.player_.trigger({type:"timeupdate",target:this,manuallyTriggered:!0}),this.videoWasPlaying?ms(this.player_.play()):this.update_()}handlePendingSeek_(e){this.player_.paused()||this.player_.pause();const t=this.pendingSeekTime()!==null?this.pendingSeekTime():this.player_.currentTime();this.pendingSeekTime(t+e),this.player_.trigger({type:"timeupdate",target:this,manuallyTriggered:!0})}stepForward(){this.shouldDisableSeekWhileScrubbing_?this.handlePendingSeek_(this.options().stepSeconds):this.userSeek_(this.player_.currentTime()+this.options().stepSeconds)}stepBack(){this.shouldDisableSeekWhileScrubbing_?this.handlePendingSeek_(-this.options().stepSeconds):this.userSeek_(this.player_.currentTime()-this.options().stepSeconds)}handleAction(e){this.pendingSeekTime()!==null&&(this.userSeek_(this.pendingSeekTime()),this.pendingSeekTime(null)),this.player_.paused()?this.player_.play():this.player_.pause()}handleKeyDown(e){const t=this.player_.liveTracker;if(e.key===" "||e.key==="Enter")e.preventDefault(),e.stopPropagation(),this.handleAction(e);else if(e.key==="Home")e.preventDefault(),e.stopPropagation(),this.userSeek_(0);else if(e.key==="End")e.preventDefault(),e.stopPropagation(),t&&t.isLive()?this.userSeek_(t.liveCurrentTime()):this.userSeek_(this.player_.duration());else if(/^[0-9]$/.test(e.key)){e.preventDefault(),e.stopPropagation();const i=parseInt(e.key,10)*.1;t&&t.isLive()?this.userSeek_(t.seekableStart()+t.liveWindow()*i):this.userSeek_(this.player_.duration()*i)}else e.key==="PageDown"?(e.preventDefault(),e.stopPropagation(),this.userSeek_(this.player_.currentTime()-this.options().stepSeconds*this.options().pageMultiplier)):e.key==="PageUp"?(e.preventDefault(),e.stopPropagation(),this.userSeek_(this.player_.currentTime()+this.options().stepSeconds*this.options().pageMultiplier)):super.handleKeyDown(e)}dispose(){this.disableInterval_(),this.off(this.player_,["durationchange","timeupdate"],this.update),this.off(this.player_,["ended"],this.update_),this.player_.liveTracker&&this.off(this.player_.liveTracker,"liveedgechange",this.update),this.off(this.player_,["playing"],this.enableIntervalHandler_),this.off(this.player_,["ended","pause","waiting"],this.disableIntervalHandler_),"hidden"in he&&"visibilityState"in he&&this.off(he,"visibilitychange",this.toggleVisibility_),super.dispose()}}np.prototype.options_={children:["loadProgressBar","playProgressBar"],barName:"playProgressBar",stepSeconds:5,pageMultiplier:12};ie.registerComponent("SeekBar",np);class Ak extends ie{constructor(e,t){super(e,t),this.handleMouseMove=Ps(pt(this,this.handleMouseMove),Pn),this.throttledHandleMouseSeek=Ps(pt(this,this.handleMouseSeek),Pn),this.handleMouseUpHandler_=i=>this.handleMouseUp(i),this.handleMouseDownHandler_=i=>this.handleMouseDown(i),this.enable()}createEl(){return super.createEl("div",{className:"vjs-progress-control vjs-control"})}handleMouseMove(e){const t=this.getChild("seekBar");if(!t)return;const i=t.getChild("playProgressBar"),s=t.getChild("mouseTimeDisplay");if(!i&&!s)return;const r=t.el(),o=Vh(r);let a=Yf(r,e).x;a=xu(a,0,1),s&&s.update(o,a),i&&i.update(o,t.getProgress())}handleMouseSeek(e){const t=this.getChild("seekBar");t&&t.handleMouseMove(e)}enabled(){return this.enabled_}disable(){if(this.children().forEach(e=>e.disable&&e.disable()),!!this.enabled()&&(this.off(["mousedown","touchstart"],this.handleMouseDownHandler_),this.off(this.el_,["mousemove","touchmove"],this.handleMouseMove),this.removeListenersAddedOnMousedownAndTouchstart(),this.addClass("disabled"),this.enabled_=!1,this.player_.scrubbing())){const e=this.getChild("seekBar");this.player_.scrubbing(!1),e.videoWasPlaying&&ms(this.player_.play())}}enable(){this.children().forEach(e=>e.enable&&e.enable()),!this.enabled()&&(this.on(["mousedown","touchstart"],this.handleMouseDownHandler_),this.on(this.el_,["mousemove","touchmove"],this.handleMouseMove),this.removeClass("disabled"),this.enabled_=!0)}removeListenersAddedOnMousedownAndTouchstart(){const e=this.el_.ownerDocument;this.off(e,"mousemove",this.throttledHandleMouseSeek),this.off(e,"touchmove",this.throttledHandleMouseSeek),this.off(e,"mouseup",this.handleMouseUpHandler_),this.off(e,"touchend",this.handleMouseUpHandler_)}handleMouseDown(e){const t=this.el_.ownerDocument,i=this.getChild("seekBar");i&&i.handleMouseDown(e),this.on(t,"mousemove",this.throttledHandleMouseSeek),this.on(t,"touchmove",this.throttledHandleMouseSeek),this.on(t,"mouseup",this.handleMouseUpHandler_),this.on(t,"touchend",this.handleMouseUpHandler_)}handleMouseUp(e){const t=this.getChild("seekBar");t&&t.handleMouseUp(e),this.removeListenersAddedOnMousedownAndTouchstart()}}Ak.prototype.options_={children:["seekBar"]};ie.registerComponent("ProgressControl",Ak);class Pk extends vi{constructor(e,t){super(e,t),this.setIcon("picture-in-picture-enter"),this.on(e,["enterpictureinpicture","leavepictureinpicture"],i=>this.handlePictureInPictureChange(i)),this.on(e,["disablepictureinpicturechanged","loadedmetadata"],i=>this.handlePictureInPictureEnabledChange(i)),this.on(e,["loadedmetadata","audioonlymodechange","audiopostermodechange"],()=>this.handlePictureInPictureAudioModeChange()),this.disable()}buildCSSClass(){return`vjs-picture-in-picture-control vjs-hidden ${super.buildCSSClass()}`}handlePictureInPictureAudioModeChange(){if(!(this.player_.currentType().substring(0,5)==="audio"||this.player_.audioPosterMode()||this.player_.audioOnlyMode())){this.show();return}this.player_.isInPictureInPicture()&&this.player_.exitPictureInPicture(),this.hide()}handlePictureInPictureEnabledChange(){he.pictureInPictureEnabled&&this.player_.disablePictureInPicture()===!1||this.player_.options_.enableDocumentPictureInPicture&&"documentPictureInPicture"in V?this.enable():this.disable()}handlePictureInPictureChange(e){this.player_.isInPictureInPicture()?(this.setIcon("picture-in-picture-exit"),this.controlText("Exit Picture-in-Picture")):(this.setIcon("picture-in-picture-enter"),this.controlText("Picture-in-Picture")),this.handlePictureInPictureEnabledChange()}handleClick(e){this.player_.isInPictureInPicture()?this.player_.exitPictureInPicture():this.player_.requestPictureInPicture()}show(){typeof he.exitPictureInPicture=="function"&&super.show()}}Pk.prototype.controlText_="Picture-in-Picture";ie.registerComponent("PictureInPictureToggle",Pk);class Dk extends vi{constructor(e,t){super(e,t),this.setIcon("fullscreen-enter"),this.on(e,"fullscreenchange",i=>this.handleFullscreenChange(i)),he[e.fsApi_.fullscreenEnabled]===!1&&this.disable()}buildCSSClass(){return`vjs-fullscreen-control ${super.buildCSSClass()}`}handleFullscreenChange(e){this.player_.isFullscreen()?(this.controlText("Exit Fullscreen"),this.setIcon("fullscreen-exit")):(this.controlText("Fullscreen"),this.setIcon("fullscreen-enter"))}handleClick(e){this.player_.isFullscreen()?this.player_.exitFullscreen():this.player_.requestFullscreen()}}Dk.prototype.controlText_="Fullscreen";ie.registerComponent("FullscreenToggle",Dk);const dN=function(n,e){e.tech_&&!e.tech_.featuresVolumeControl&&n.addClass("vjs-hidden"),n.on(e,"loadstart",function(){e.tech_.featuresVolumeControl?n.removeClass("vjs-hidden"):n.addClass("vjs-hidden")})};class fN extends ie{createEl(){const e=super.createEl("div",{className:"vjs-volume-level"});return this.setIcon("circle",e),e.appendChild(super.createEl("span",{className:"vjs-control-text"})),e}}ie.registerComponent("VolumeLevel",fN);class pN extends ie{constructor(e,t){super(e,t),this.update=Ps(pt(this,this.update),Pn)}createEl(){return super.createEl("div",{className:"vjs-volume-tooltip"},{"aria-hidden":"true"})}update(e,t,i,s){if(!i){const r=Fa(this.el_),o=Fa(this.player_.el()),a=e.width*t;if(!o||!r)return;const l=e.left-o.left+a,h=e.width-a+(o.right-e.right);let u=r.width/2;l<u?u+=u-l:h<u&&(u=h),u<0?u=0:u>r.width&&(u=r.width),this.el_.style.right=`-${u}px`}this.write(`${s}%`)}write(e){Zr(this.el_,e)}updateVolume(e,t,i,s,r){this.requestNamedAnimationFrame("VolumeLevelTooltip#updateVolume",()=>{this.update(e,t,i,s.toFixed(0)),r&&r()})}}ie.registerComponent("VolumeLevelTooltip",pN);class Mk extends ie{constructor(e,t){super(e,t),this.update=Ps(pt(this,this.update),Pn)}createEl(){return super.createEl("div",{className:"vjs-mouse-display"})}update(e,t,i){const s=100*t;this.getChild("volumeLevelTooltip").updateVolume(e,t,i,s,()=>{i?this.el_.style.bottom=`${e.height*t}px`:this.el_.style.left=`${e.width*t}px`})}}Mk.prototype.options_={children:["volumeLevelTooltip"]};ie.registerComponent("MouseVolumeLevelDisplay",Mk);class sp extends Hy{constructor(e,t){super(e,t),this.on("slideractive",i=>this.updateLastVolume_(i)),this.on(e,"volumechange",i=>this.updateARIAAttributes(i)),e.ready(()=>this.updateARIAAttributes())}createEl(){return super.createEl("div",{className:"vjs-volume-bar vjs-slider-bar"},{"aria-label":this.localize("Volume Level"),"aria-live":"polite"})}handleMouseDown(e){Uh(e)&&super.handleMouseDown(e)}handleMouseMove(e){const t=this.getChild("mouseVolumeLevelDisplay");if(t){const i=this.el(),s=Fa(i),r=this.vertical();let o=Yf(i,e);o=r?o.y:o.x,o=xu(o,0,1),t.update(s,o,r)}Uh(e)&&(this.checkMuted(),this.player_.volume(this.calculateDistance(e)))}checkMuted(){this.player_.muted()&&this.player_.muted(!1)}getPercent(){return this.player_.muted()?0:this.player_.volume()}stepForward(){this.checkMuted(),this.player_.volume(this.player_.volume()+.1)}stepBack(){this.checkMuted(),this.player_.volume(this.player_.volume()-.1)}updateARIAAttributes(e){const t=this.player_.muted()?0:this.volumeAsPercentage_();this.el_.setAttribute("aria-valuenow",t),this.el_.setAttribute("aria-valuetext",t+"%")}volumeAsPercentage_(){return Math.round(this.player_.volume()*100)}updateLastVolume_(){const e=this.player_.volume();this.one("sliderinactive",()=>{this.player_.volume()===0&&this.player_.lastVolume_(e)})}}sp.prototype.options_={children:["volumeLevel"],barName:"volumeLevel"};!yi&&!Wn&&sp.prototype.options_.children.splice(0,0,"mouseVolumeLevelDisplay");sp.prototype.playerEvent="volumechange";ie.registerComponent("VolumeBar",sp);class Ik extends ie{constructor(e,t={}){t.vertical=t.vertical||!1,(typeof t.volumeBar>"u"||Ba(t.volumeBar))&&(t.volumeBar=t.volumeBar||{},t.volumeBar.vertical=t.vertical),super(e,t),dN(this,e),this.throttledHandleMouseMove=Ps(pt(this,this.handleMouseMove),Pn),this.handleMouseUpHandler_=i=>this.handleMouseUp(i),this.on("mousedown",i=>this.handleMouseDown(i)),this.on("touchstart",i=>this.handleMouseDown(i)),this.on("mousemove",i=>this.handleMouseMove(i)),this.on(this.volumeBar,["focus","slideractive"],()=>{this.volumeBar.addClass("vjs-slider-active"),this.addClass("vjs-slider-active"),this.trigger("slideractive")}),this.on(this.volumeBar,["blur","sliderinactive"],()=>{this.volumeBar.removeClass("vjs-slider-active"),this.removeClass("vjs-slider-active"),this.trigger("sliderinactive")})}createEl(){let e="vjs-volume-horizontal";return this.options_.vertical&&(e="vjs-volume-vertical"),super.createEl("div",{className:`vjs-volume-control vjs-control ${e}`})}handleMouseDown(e){const t=this.el_.ownerDocument;this.on(t,"mousemove",this.throttledHandleMouseMove),this.on(t,"touchmove",this.throttledHandleMouseMove),this.on(t,"mouseup",this.handleMouseUpHandler_),this.on(t,"touchend",this.handleMouseUpHandler_)}handleMouseUp(e){const t=this.el_.ownerDocument;this.off(t,"mousemove",this.throttledHandleMouseMove),this.off(t,"touchmove",this.throttledHandleMouseMove),this.off(t,"mouseup",this.handleMouseUpHandler_),this.off(t,"touchend",this.handleMouseUpHandler_)}handleMouseMove(e){this.volumeBar.handleMouseMove(e)}}Ik.prototype.options_={children:["volumeBar"]};ie.registerComponent("VolumeControl",Ik);const mN=function(n,e){e.tech_&&!e.tech_.featuresMuteControl&&n.addClass("vjs-hidden"),n.on(e,"loadstart",function(){e.tech_.featuresMuteControl?n.removeClass("vjs-hidden"):n.addClass("vjs-hidden")})};class Rk extends vi{constructor(e,t){super(e,t),mN(this,e),this.on(e,["loadstart","volumechange"],i=>this.update(i))}buildCSSClass(){return`vjs-mute-control ${super.buildCSSClass()}`}handleClick(e){const t=this.player_.volume(),i=this.player_.lastVolume_();if(t===0){const s=i<.1?.1:i;this.player_.volume(s),this.player_.muted(!1)}else this.player_.muted(!this.player_.muted())}update(e){this.updateIcon_(),this.updateControlText_()}updateIcon_(){const e=this.player_.volume();let t=3;this.setIcon("volume-high"),yi&&this.player_.tech_&&this.player_.tech_.el_&&this.player_.muted(this.player_.tech_.el_.muted),e===0||this.player_.muted()?(this.setIcon("volume-mute"),t=0):e<.33?(this.setIcon("volume-low"),t=1):e<.67&&(this.setIcon("volume-medium"),t=2),Wf(this.el_,[0,1,2,3].reduce((i,s)=>i+`${s?" ":""}vjs-vol-${s}`,"")),_o(this.el_,`vjs-vol-${t}`)}updateControlText_(){const t=this.player_.muted()||this.player_.volume()===0?"Unmute":"Mute";this.controlText()!==t&&this.controlText(t)}}Rk.prototype.controlText_="Mute";ie.registerComponent("MuteToggle",Rk);class Lk extends ie{constructor(e,t={}){typeof t.inline<"u"?t.inline=t.inline:t.inline=!0,(typeof t.volumeControl>"u"||Ba(t.volumeControl))&&(t.volumeControl=t.volumeControl||{},t.volumeControl.vertical=!t.inline),super(e,t),this.handleKeyPressHandler_=i=>this.handleKeyPress(i),this.on(e,["loadstart"],i=>this.volumePanelState_(i)),this.on(this.muteToggle,"keyup",i=>this.handleKeyPress(i)),this.on(this.volumeControl,"keyup",i=>this.handleVolumeControlKeyUp(i)),this.on("keydown",i=>this.handleKeyPress(i)),this.on("mouseover",i=>this.handleMouseOver(i)),this.on("mouseout",i=>this.handleMouseOut(i)),this.on(this.volumeControl,["slideractive"],this.sliderActive_),this.on(this.volumeControl,["sliderinactive"],this.sliderInactive_)}sliderActive_(){this.addClass("vjs-slider-active")}sliderInactive_(){this.removeClass("vjs-slider-active")}volumePanelState_(){this.volumeControl.hasClass("vjs-hidden")&&this.muteToggle.hasClass("vjs-hidden")&&this.addClass("vjs-hidden"),this.volumeControl.hasClass("vjs-hidden")&&!this.muteToggle.hasClass("vjs-hidden")&&this.addClass("vjs-mute-toggle-only")}createEl(){let e="vjs-volume-panel-horizontal";return this.options_.inline||(e="vjs-volume-panel-vertical"),super.createEl("div",{className:`vjs-volume-panel vjs-control ${e}`})}dispose(){this.handleMouseOut(),super.dispose()}handleVolumeControlKeyUp(e){e.key==="Escape"&&this.muteToggle.focus()}handleMouseOver(e){this.addClass("vjs-hover"),cn(he,"keyup",this.handleKeyPressHandler_)}handleMouseOut(e){this.removeClass("vjs-hover"),bi(he,"keyup",this.handleKeyPressHandler_)}handleKeyPress(e){e.key==="Escape"&&this.handleMouseOut()}}Lk.prototype.options_={children:["muteToggle","volumeControl"]};ie.registerComponent("VolumePanel",Lk);class $k extends vi{constructor(e,t){super(e,t),this.validOptions=[5,10,30],this.skipTime=this.getSkipForwardTime(),this.skipTime&&this.validOptions.includes(this.skipTime)?(this.setIcon(`forward-${this.skipTime}`),this.controlText(this.localize("Skip forward {1} seconds",[this.skipTime.toLocaleString(e.language())])),this.show()):this.hide()}getSkipForwardTime(){const e=this.options_.playerOptions;return e.controlBar&&e.controlBar.skipButtons&&e.controlBar.skipButtons.forward}buildCSSClass(){return`vjs-skip-forward-${this.getSkipForwardTime()} ${super.buildCSSClass()}`}handleClick(e){if(isNaN(this.player_.duration()))return;const t=this.player_.currentTime(),i=this.player_.liveTracker,s=i&&i.isLive()?i.seekableEnd():this.player_.duration();let r;t+this.skipTime<=s?r=t+this.skipTime:r=s,this.player_.currentTime(r)}handleLanguagechange(){this.controlText(this.localize("Skip forward {1} seconds",[this.skipTime]))}}$k.prototype.controlText_="Skip Forward";ie.registerComponent("SkipForward",$k);class Qk extends vi{constructor(e,t){super(e,t),this.validOptions=[5,10,30],this.skipTime=this.getSkipBackwardTime(),this.skipTime&&this.validOptions.includes(this.skipTime)?(this.setIcon(`replay-${this.skipTime}`),this.controlText(this.localize("Skip backward {1} seconds",[this.skipTime.toLocaleString(e.language())])),this.show()):this.hide()}getSkipBackwardTime(){const e=this.options_.playerOptions;return e.controlBar&&e.controlBar.skipButtons&&e.controlBar.skipButtons.backward}buildCSSClass(){return`vjs-skip-backward-${this.getSkipBackwardTime()} ${super.buildCSSClass()}`}handleClick(e){const t=this.player_.currentTime(),i=this.player_.liveTracker,s=i&&i.isLive()&&i.seekableStart();let r;s&&t-this.skipTime<=s?r=s:t>=this.skipTime?r=t-this.skipTime:r=0,this.player_.currentTime(r)}handleLanguagechange(){this.controlText(this.localize("Skip backward {1} seconds",[this.skipTime]))}}Qk.prototype.controlText_="Skip Backward";ie.registerComponent("SkipBackward",Qk);class Bk extends ie{constructor(e,t){super(e,t),t&&(this.menuButton_=t.menuButton),this.focusedChild_=-1,this.on("keydown",i=>this.handleKeyDown(i)),this.boundHandleBlur_=i=>this.handleBlur(i),this.boundHandleTapClick_=i=>this.handleTapClick(i)}addEventListenerForItem(e){e instanceof ie&&(this.on(e,"blur",this.boundHandleBlur_),this.on(e,["tap","click"],this.boundHandleTapClick_))}removeEventListenerForItem(e){e instanceof ie&&(this.off(e,"blur",this.boundHandleBlur_),this.off(e,["tap","click"],this.boundHandleTapClick_))}removeChild(e){typeof e=="string"&&(e=this.getChild(e)),this.removeEventListenerForItem(e),super.removeChild(e)}addItem(e){const t=this.addChild(e);t&&this.addEventListenerForItem(t)}createEl(){const e=this.options_.contentElType||"ul";this.contentEl_=Le(e,{className:"vjs-menu-content"}),this.contentEl_.setAttribute("role","menu");const t=super.createEl("div",{append:this.contentEl_,className:"vjs-menu"});return t.appendChild(this.contentEl_),cn(t,"click",function(i){i.preventDefault(),i.stopImmediatePropagation()}),t}dispose(){this.contentEl_=null,this.boundHandleBlur_=null,this.boundHandleTapClick_=null,super.dispose()}handleBlur(e){const t=e.relatedTarget||he.activeElement;if(!this.children().some(i=>i.el()===t)){const i=this.menuButton_;i&&i.buttonPressed_&&t!==i.el().firstChild&&i.unpressButton()}}handleTapClick(e){if(this.menuButton_){this.menuButton_.unpressButton();const t=this.children();if(!Array.isArray(t))return;const i=t.filter(s=>s.el()===e.target)[0];if(!i)return;i.name()!=="CaptionSettingsMenuItem"&&this.menuButton_.focus()}}handleKeyDown(e){e.key==="ArrowLeft"||e.key==="ArrowDown"?(e.preventDefault(),e.stopPropagation(),this.stepForward()):(e.key==="ArrowRight"||e.key==="ArrowUp")&&(e.preventDefault(),e.stopPropagation(),this.stepBack())}stepForward(){let e=0;this.focusedChild_!==void 0&&(e=this.focusedChild_+1),this.focus(e)}stepBack(){let e=0;this.focusedChild_!==void 0&&(e=this.focusedChild_-1),this.focus(e)}focus(e=0){const t=this.children().slice();t.length&&t[0].hasClass("vjs-menu-title")&&t.shift(),t.length>0&&(e<0?e=0:e>=t.length&&(e=t.length-1),this.focusedChild_=e,t[e].el_.focus())}}ie.registerComponent("Menu",Bk);class Zy extends ie{constructor(e,t={}){super(e,t),this.menuButton_=new vi(e,t),this.menuButton_.controlText(this.controlText_),this.menuButton_.el_.setAttribute("aria-haspopup","true");const i=vi.prototype.buildCSSClass();this.menuButton_.el_.className=this.buildCSSClass()+" "+i,this.menuButton_.removeClass("vjs-control"),this.addChild(this.menuButton_),this.update(),this.enabled_=!0;const s=r=>this.handleClick(r);this.handleMenuKeyUp_=r=>this.handleMenuKeyUp(r),this.on(this.menuButton_,"tap",s),this.on(this.menuButton_,"click",s),this.on(this.menuButton_,"keydown",r=>this.handleKeyDown(r)),this.on(this.menuButton_,"mouseenter",()=>{this.addClass("vjs-hover"),this.menu.show(),cn(he,"keyup",this.handleMenuKeyUp_)}),this.on("mouseleave",r=>this.handleMouseLeave(r)),this.on("keydown",r=>this.handleSubmenuKeyDown(r))}update(){const e=this.createMenu();this.menu&&(this.menu.dispose(),this.removeChild(this.menu)),this.menu=e,this.addChild(e),this.buttonPressed_=!1,this.menuButton_.el_.setAttribute("aria-expanded","false"),this.items&&this.items.length<=this.hideThreshold_?(this.hide(),this.menu.contentEl_.removeAttribute("role")):(this.show(),this.menu.contentEl_.setAttribute("role","menu"))}createMenu(){const e=new Bk(this.player_,{menuButton:this});if(this.hideThreshold_=0,this.options_.title){const t=Le("li",{className:"vjs-menu-title",textContent:Dt(this.options_.title),tabIndex:-1}),i=new ie(this.player_,{el:t});e.addItem(i)}if(this.items=this.createItems(),this.items)for(let t=0;t<this.items.length;t++)e.addItem(this.items[t]);return e}createItems(){}createEl(){return super.createEl("div",{className:this.buildWrapperCSSClass()},{})}setIcon(e){super.setIcon(e,this.menuButton_.el_)}buildWrapperCSSClass(){let e="vjs-menu-button";this.options_.inline===!0?e+="-inline":e+="-popup";const t=vi.prototype.buildCSSClass();return`vjs-menu-button ${e} ${t} ${super.buildCSSClass()}`}buildCSSClass(){let e="vjs-menu-button";return this.options_.inline===!0?e+="-inline":e+="-popup",`vjs-menu-button ${e} ${super.buildCSSClass()}`}controlText(e,t=this.menuButton_.el()){return this.menuButton_.controlText(e,t)}dispose(){this.handleMouseLeave(),super.dispose()}handleClick(e){this.buttonPressed_?this.unpressButton():this.pressButton()}handleMouseLeave(e){this.removeClass("vjs-hover"),bi(he,"keyup",this.handleMenuKeyUp_)}focus(){this.menuButton_.focus()}blur(){this.menuButton_.blur()}handleKeyDown(e){e.key==="Escape"||e.key==="Tab"?(this.buttonPressed_&&this.unpressButton(),!e.key==="Tab"&&(e.preventDefault(),this.menuButton_.focus())):(e.key==="Up"||e.key==="Down"&&!(this.player_.options_.playerOptions.spatialNavigation&&this.player_.options_.playerOptions.spatialNavigation.enabled))&&(this.buttonPressed_||(e.preventDefault(),this.pressButton()))}handleMenuKeyUp(e){(e.key==="Escape"||e.key==="Tab")&&this.removeClass("vjs-hover")}handleSubmenuKeyPress(e){this.handleSubmenuKeyDown(e)}handleSubmenuKeyDown(e){(e.key==="Escape"||e.key==="Tab")&&(this.buttonPressed_&&this.unpressButton(),!e.key==="Tab"&&(e.preventDefault(),this.menuButton_.focus()))}pressButton(){if(this.enabled_){if(this.buttonPressed_=!0,this.menu.show(),this.menu.lockShowing(),this.menuButton_.el_.setAttribute("aria-expanded","true"),yi&&W2())return;this.menu.focus()}}unpressButton(){this.enabled_&&(this.buttonPressed_=!1,this.menu.unlockShowing(),this.menu.hide(),this.menuButton_.el_.setAttribute("aria-expanded","false"))}disable(){this.unpressButton(),this.enabled_=!1,this.addClass("vjs-disabled"),this.menuButton_.disable()}enable(){this.enabled_=!0,this.removeClass("vjs-disabled"),this.menuButton_.enable()}}ie.registerComponent("MenuButton",Zy);class Yy extends Zy{constructor(e,t){const i=t.tracks;if(super(e,t),this.items.length<=1&&this.hide(),!i)return;const s=pt(this,this.update);i.addEventListener("removetrack",s),i.addEventListener("addtrack",s),i.addEventListener("labelchange",s),this.player_.on("ready",s),this.player_.on("dispose",function(){i.removeEventListener("removetrack",s),i.removeEventListener("addtrack",s),i.removeEventListener("labelchange",s)})}}ie.registerComponent("TrackButton",Yy);class Tu extends ip{constructor(e,t){super(e,t),this.selectable=t.selectable,this.isSelected_=t.selected||!1,this.multiSelectable=t.multiSelectable,this.selected(this.isSelected_),this.selectable?this.multiSelectable?this.el_.setAttribute("role","menuitemcheckbox"):this.el_.setAttribute("role","menuitemradio"):this.el_.setAttribute("role","menuitem")}createEl(e,t,i){this.nonIconControl=!0;const s=super.createEl("li",Object.assign({className:"vjs-menu-item",tabIndex:-1},t),i),r=Le("span",{className:"vjs-menu-item-text",textContent:this.localize(this.options_.label)});return this.player_.options_.experimentalSvgIcons?s.appendChild(r):s.replaceChild(r,s.querySelector(".vjs-icon-placeholder")),s}handleKeyDown(e){["Tab","Escape","ArrowUp","ArrowLeft","ArrowRight","ArrowDown"].includes(e.key)||super.handleKeyDown(e)}handleClick(e){this.selected(!0)}selected(e){this.selectable&&(e?(this.addClass("vjs-selected"),this.el_.setAttribute("aria-checked","true"),this.controlText(", selected"),this.isSelected_=!0):(this.removeClass("vjs-selected"),this.el_.setAttribute("aria-checked","false"),this.controlText(""),this.isSelected_=!1))}}ie.registerComponent("MenuItem",Tu);class wu extends Tu{constructor(e,t){const i=t.track,s=e.textTracks();t.label=i.label||i.language||"Unknown",t.selected=i.mode==="showing",super(e,t),this.track=i,this.kinds=(t.kinds||[t.kind||this.track.kind]).filter(Boolean);const r=(...a)=>{this.handleTracksChange.apply(this,a)},o=(...a)=>{this.handleSelectedLanguageChange.apply(this,a)};if(e.on(["loadstart","texttrackchange"],r),s.addEventListener("change",r),s.addEventListener("selectedlanguagechange",o),this.on("dispose",function(){e.off(["loadstart","texttrackchange"],r),s.removeEventListener("change",r),s.removeEventListener("selectedlanguagechange",o)}),s.onchange===void 0){let a;this.on(["tap","click"],function(){if(typeof V.Event!="object")try{a=new V.Event("change")}catch{}a||(a=he.createEvent("Event"),a.initEvent("change",!0,!0)),s.dispatchEvent(a)})}this.handleTracksChange()}handleClick(e){const t=this.track,i=this.player_.textTracks();if(super.handleClick(e),!!i)for(let s=0;s<i.length;s++){const r=i[s];this.kinds.indexOf(r.kind)!==-1&&(r===t?r.mode!=="showing"&&(r.mode="showing"):r.mode!=="disabled"&&(r.mode="disabled"))}}handleTracksChange(e){const t=this.track.mode==="showing";t!==this.isSelected_&&this.selected(t)}handleSelectedLanguageChange(e){if(this.track.mode==="showing"){const t=this.player_.cache_.selectedLanguage;if(t&&t.enabled&&t.language===this.track.language&&t.kind!==this.track.kind)return;this.player_.cache_.selectedLanguage={enabled:!0,language:this.track.language,kind:this.track.kind}}}dispose(){this.track=null,super.dispose()}}ie.registerComponent("TextTrackMenuItem",wu);class Nk extends wu{constructor(e,t){t.track={player:e,kind:t.kind,kinds:t.kinds,default:!1,mode:"disabled"},t.kinds||(t.kinds=[t.kind]),t.label?t.track.label=t.label:t.track.label=t.kinds.join(" and ")+" off",t.selectable=!0,t.multiSelectable=!1,super(e,t)}handleTracksChange(e){const t=this.player().textTracks();let i=!0;for(let s=0,r=t.length;s<r;s++){const o=t[s];if(this.options_.kinds.indexOf(o.kind)>-1&&o.mode==="showing"){i=!1;break}}i!==this.isSelected_&&this.selected(i)}handleSelectedLanguageChange(e){const t=this.player().textTracks();let i=!0;for(let s=0,r=t.length;s<r;s++){const o=t[s];if(["captions","descriptions","subtitles"].indexOf(o.kind)>-1&&o.mode==="showing"){i=!1;break}}i&&(this.player_.cache_.selectedLanguage={enabled:!1})}handleLanguagechange(){this.$(".vjs-menu-item-text").textContent=this.player_.localize(this.options_.label),super.handleLanguagechange()}}ie.registerComponent("OffTextTrackMenuItem",Nk);class fl extends Yy{constructor(e,t={}){t.tracks=e.textTracks(),super(e,t)}createItems(e=[],t=wu){let i;this.label_&&(i=`${this.label_} off`),e.push(new Nk(this.player_,{kinds:this.kinds_,kind:this.kind_,label:i})),this.hideThreshold_+=1;const s=this.player_.textTracks();Array.isArray(this.kinds_)||(this.kinds_=[this.kind_]);for(let r=0;r<s.length;r++){const o=s[r];if(this.kinds_.indexOf(o.kind)>-1){const a=new t(this.player_,{track:o,kinds:this.kinds_,kind:this.kind_,selectable:!0,multiSelectable:!1});a.addClass(`vjs-${o.kind}-menu-item`),e.push(a)}}return e}}ie.registerComponent("TextTrackButton",fl);class Fk extends Tu{constructor(e,t){const i=t.track,s=t.cue,r=e.currentTime();t.selectable=!0,t.multiSelectable=!1,t.label=s.text,t.selected=s.startTime<=r&&r<s.endTime,super(e,t),this.track=i,this.cue=s}handleClick(e){super.handleClick(),this.player_.currentTime(this.cue.startTime)}}ie.registerComponent("ChaptersTrackMenuItem",Fk);class Gy extends fl{constructor(e,t,i){super(e,t,i),this.setIcon("chapters"),this.selectCurrentItem_=()=>{this.items.forEach(s=>{s.selected(this.track_.activeCues[0]===s.cue)})}}buildCSSClass(){return`vjs-chapters-button ${super.buildCSSClass()}`}buildWrapperCSSClass(){return`vjs-chapters-button ${super.buildWrapperCSSClass()}`}update(e){if(e&&e.track&&e.track.kind!=="chapters")return;const t=this.findChaptersTrack();t!==this.track_?(this.setTrack(t),super.update()):(!this.items||t&&t.cues&&t.cues.length!==this.items.length)&&super.update()}setTrack(e){if(this.track_!==e){if(this.updateHandler_||(this.updateHandler_=this.update.bind(this)),this.track_){const t=this.player_.remoteTextTrackEls().getTrackElementByTrack_(this.track_);t&&t.removeEventListener("load",this.updateHandler_),this.track_.removeEventListener("cuechange",this.selectCurrentItem_),this.track_=null}if(this.track_=e,this.track_){this.track_.mode="hidden";const t=this.player_.remoteTextTrackEls().getTrackElementByTrack_(this.track_);t&&t.addEventListener("load",this.updateHandler_),this.track_.addEventListener("cuechange",this.selectCurrentItem_)}}}findChaptersTrack(){const e=this.player_.textTracks()||[];for(let t=e.length-1;t>=0;t--){const i=e[t];if(i.kind===this.kind_)return i}}getMenuCaption(){return this.track_&&this.track_.label?this.track_.label:this.localize(Dt(this.kind_))}createMenu(){return this.options_.title=this.getMenuCaption(),super.createMenu()}createItems(){const e=[];if(!this.track_)return e;const t=this.track_.cues;if(!t)return e;for(let i=0,s=t.length;i<s;i++){const r=t[i],o=new Fk(this.player_,{track:this.track_,cue:r});e.push(o)}return e}}Gy.prototype.kind_="chapters";Gy.prototype.controlText_="Chapters";ie.registerComponent("ChaptersButton",Gy);class Ky extends fl{constructor(e,t,i){super(e,t,i),this.setIcon("audio-description");const s=e.textTracks(),r=pt(this,this.handleTracksChange);s.addEventListener("change",r),this.on("dispose",function(){s.removeEventListener("change",r)})}handleTracksChange(e){const t=this.player().textTracks();let i=!1;for(let s=0,r=t.length;s<r;s++){const o=t[s];if(o.kind!==this.kind_&&o.mode==="showing"){i=!0;break}}i?this.disable():this.enable()}buildCSSClass(){return`vjs-descriptions-button ${super.buildCSSClass()}`}buildWrapperCSSClass(){return`vjs-descriptions-button ${super.buildWrapperCSSClass()}`}}Ky.prototype.kind_="descriptions";Ky.prototype.controlText_="Descriptions";ie.registerComponent("DescriptionsButton",Ky);class Jy extends fl{constructor(e,t,i){super(e,t,i),this.setIcon("subtitles")}buildCSSClass(){return`vjs-subtitles-button ${super.buildCSSClass()}`}buildWrapperCSSClass(){return`vjs-subtitles-button ${super.buildWrapperCSSClass()}`}}Jy.prototype.kind_="subtitles";Jy.prototype.controlText_="Subtitles";ie.registerComponent("SubtitlesButton",Jy);class eb extends wu{constructor(e,t){t.track={player:e,kind:t.kind,label:t.kind+" settings",selectable:!1,default:!1,mode:"disabled"},t.selectable=!1,t.name="CaptionSettingsMenuItem",super(e,t),this.addClass("vjs-texttrack-settings"),this.controlText(", opens "+t.kind+" settings dialog")}handleClick(e){this.player().getChild("textTrackSettings").open()}handleLanguagechange(){this.$(".vjs-menu-item-text").textContent=this.player_.localize(this.options_.kind+" settings"),super.handleLanguagechange()}}ie.registerComponent("CaptionSettingsMenuItem",eb);class tb extends fl{constructor(e,t,i){super(e,t,i),this.setIcon("captions")}buildCSSClass(){return`vjs-captions-button ${super.buildCSSClass()}`}buildWrapperCSSClass(){return`vjs-captions-button ${super.buildWrapperCSSClass()}`}createItems(){const e=[];return!(this.player().tech_&&this.player().tech_.featuresNativeTextTracks)&&this.player().getChild("textTrackSettings")&&(e.push(new eb(this.player_,{kind:this.kind_})),this.hideThreshold_+=1),super.createItems(e)}}tb.prototype.kind_="captions";tb.prototype.controlText_="Captions";ie.registerComponent("CaptionsButton",tb);class Vk extends wu{createEl(e,t,i){const s=super.createEl(e,t,i),r=s.querySelector(".vjs-menu-item-text");return this.options_.track.kind==="captions"&&(this.player_.options_.experimentalSvgIcons?this.setIcon("captions",s):r.appendChild(Le("span",{className:"vjs-icon-placeholder"},{"aria-hidden":!0})),r.appendChild(Le("span",{className:"vjs-control-text",textContent:` ${this.localize("Captions")}`}))),s}}ie.registerComponent("SubsCapsMenuItem",Vk);class ib extends fl{constructor(e,t={}){super(e,t),this.label_="subtitles",this.setIcon("subtitles"),["en","en-us","en-ca","fr-ca"].indexOf(this.player_.language_)>-1&&(this.label_="captions",this.setIcon("captions")),this.menuButton_.controlText(Dt(this.label_))}buildCSSClass(){return`vjs-subs-caps-button ${super.buildCSSClass()}`}buildWrapperCSSClass(){return`vjs-subs-caps-button ${super.buildWrapperCSSClass()}`}createItems(){let e=[];return!(this.player().tech_&&this.player().tech_.featuresNativeTextTracks)&&this.player().getChild("textTrackSettings")&&(e.push(new eb(this.player_,{kind:this.label_})),this.hideThreshold_+=1),e=super.createItems(e,Vk),e}}ib.prototype.kinds_=["captions","subtitles"];ib.prototype.controlText_="Subtitles";ie.registerComponent("SubsCapsButton",ib);class Uk extends Tu{constructor(e,t){const i=t.track,s=e.audioTracks();t.label=i.label||i.language||"Unknown",t.selected=i.enabled,super(e,t),this.track=i,this.addClass(`vjs-${i.kind}-menu-item`);const r=(...o)=>{this.handleTracksChange.apply(this,o)};s.addEventListener("change",r),this.on("dispose",()=>{s.removeEventListener("change",r)})}createEl(e,t,i){const s=super.createEl(e,t,i),r=s.querySelector(".vjs-menu-item-text");return["main-desc","descriptions"].indexOf(this.options_.track.kind)>=0&&(r.appendChild(Le("span",{className:"vjs-icon-placeholder"},{"aria-hidden":!0})),r.appendChild(Le("span",{className:"vjs-control-text",textContent:" "+this.localize("Descriptions")}))),s}handleClick(e){if(super.handleClick(e),this.track.enabled=!0,this.player_.tech_.featuresNativeAudioTracks){const t=this.player_.audioTracks();for(let i=0;i<t.length;i++){const s=t[i];s!==this.track&&(s.enabled=s===this.track)}}}handleTracksChange(e){this.selected(this.track.enabled)}}ie.registerComponent("AudioTrackMenuItem",Uk);class qk extends Yy{constructor(e,t={}){t.tracks=e.audioTracks(),super(e,t),this.setIcon("audio")}buildCSSClass(){return`vjs-audio-button ${super.buildCSSClass()}`}buildWrapperCSSClass(){return`vjs-audio-button ${super.buildWrapperCSSClass()}`}createItems(e=[]){this.hideThreshold_=1;const t=this.player_.audioTracks();for(let i=0;i<t.length;i++){const s=t[i];e.push(new Uk(this.player_,{track:s,selectable:!0,multiSelectable:!1}))}return e}}qk.prototype.controlText_="Audio Track";ie.registerComponent("AudioTrackButton",qk);class nb extends Tu{constructor(e,t){const i=t.rate,s=parseFloat(i,10);t.label=i,t.selected=s===e.playbackRate(),t.selectable=!0,t.multiSelectable=!1,super(e,t),this.label=i,this.rate=s,this.on(e,"ratechange",r=>this.update(r))}handleClick(e){super.handleClick(),this.player().playbackRate(this.rate)}update(e){this.selected(this.player().playbackRate()===this.rate)}}nb.prototype.contentElType="button";ie.registerComponent("PlaybackRateMenuItem",nb);class zk extends Zy{constructor(e,t){super(e,t),this.menuButton_.el_.setAttribute("aria-describedby",this.labelElId_),this.updateVisibility(),this.updateLabel(),this.on(e,"loadstart",i=>this.updateVisibility(i)),this.on(e,"ratechange",i=>this.updateLabel(i)),this.on(e,"playbackrateschange",i=>this.handlePlaybackRateschange(i))}createEl(){const e=super.createEl();return this.labelElId_="vjs-playback-rate-value-label-"+this.id_,this.labelEl_=Le("div",{className:"vjs-playback-rate-value",id:this.labelElId_,textContent:"1x"}),e.appendChild(this.labelEl_),e}dispose(){this.labelEl_=null,super.dispose()}buildCSSClass(){return`vjs-playback-rate ${super.buildCSSClass()}`}buildWrapperCSSClass(){return`vjs-playback-rate ${super.buildWrapperCSSClass()}`}createItems(){const e=this.playbackRates(),t=[];for(let i=e.length-1;i>=0;i--)t.push(new nb(this.player(),{rate:e[i]+"x"}));return t}handlePlaybackRateschange(e){this.update()}playbackRates(){const e=this.player();return e.playbackRates&&e.playbackRates()||[]}playbackRateSupported(){return this.player().tech_&&this.player().tech_.featuresPlaybackRate&&this.playbackRates()&&this.playbackRates().length>0}updateVisibility(e){this.playbackRateSupported()?this.removeClass("vjs-hidden"):this.addClass("vjs-hidden")}updateLabel(e){this.playbackRateSupported()&&(this.labelEl_.textContent=this.player().playbackRate()+"x")}}zk.prototype.controlText_="Playback Rate";ie.registerComponent("PlaybackRateMenuButton",zk);class jk extends ie{buildCSSClass(){return`vjs-spacer ${super.buildCSSClass()}`}createEl(e="div",t={},i={}){return t.className||(t.className=this.buildCSSClass()),super.createEl(e,t,i)}}ie.registerComponent("Spacer",jk);class gN extends jk{buildCSSClass(){return`vjs-custom-control-spacer ${super.buildCSSClass()}`}createEl(){return super.createEl("div",{className:this.buildCSSClass(),textContent:" "})}}ie.registerComponent("CustomControlSpacer",gN);class Xk extends ie{createEl(){return super.createEl("div",{className:"vjs-control-bar",dir:"ltr"})}}Xk.prototype.options_={children:["playToggle","skipBackward","skipForward","volumePanel","currentTimeDisplay","timeDivider","durationDisplay","progressControl","liveDisplay","seekToLive","remainingTimeDisplay","customControlSpacer","playbackRateMenuButton","chaptersButton","descriptionsButton","subsCapsButton","audioTrackButton","pictureInPictureToggle","fullscreenToggle"]};ie.registerComponent("ControlBar",Xk);class Hk extends cl{constructor(e,t){super(e,t),this.on(e,"error",i=>{this.open(i)})}buildCSSClass(){return`vjs-error-display ${super.buildCSSClass()}`}content(){const e=this.player().error();return e?this.localize(e.message):""}}Hk.prototype.options_=Object.assign({},cl.prototype.options_,{pauseOnOpen:!1,fillAlways:!0,temporary:!1,uncloseable:!0});ie.registerComponent("ErrorDisplay",Hk);class Wk extends ie{constructor(e,t={}){super(e,t),this.el_.setAttribute("aria-labelledby",this.selectLabelledbyIds)}createEl(){return this.selectLabelledbyIds=[this.options_.legendId,this.options_.labelId].join(" ").trim(),Le("select",{id:this.options_.id},{},this.options_.SelectOptions.map(t=>{const i=(this.options_.labelId?this.options_.labelId:`vjs-track-option-${An()}`)+"-"+t[1].replace(/\W+/g,""),s=Le("option",{id:i,value:this.localize(t[0]),textContent:this.localize(t[1])});return s.setAttribute("aria-labelledby",`${this.selectLabelledbyIds} ${i}`),s}))}}ie.registerComponent("TextTrackSelect",Wk);class Co extends ie{constructor(e,t={}){super(e,t);const i=Le("legend",{textContent:this.localize(this.options_.legendText),id:this.options_.legendId});this.el().appendChild(i);const s=this.options_.selects;for(const r of s){const o=this.options_.selectConfigs[r],a=o.className,l=o.id.replace("%s",this.options_.id_);let h=null;const u=`vjs_select_${An()}`;if(this.options_.type==="colors"){h=Le("span",{className:a});const f=Le("label",{id:l,className:"vjs-label",textContent:this.localize(o.label)});f.setAttribute("for",u),h.appendChild(f)}const c=new Wk(e,{SelectOptions:o.options,legendId:this.options_.legendId,id:u,labelId:l});this.addChild(c),this.options_.type==="colors"&&(h.appendChild(c.el()),this.el().appendChild(h))}}createEl(){return Le("fieldset",{className:this.options_.className})}}ie.registerComponent("TextTrackFieldset",Co);class Zk extends ie{constructor(e,t={}){super(e,t);const i=this.options_.textTrackComponentid,s=new Co(e,{id_:i,legendId:`captions-text-legend-${i}`,legendText:this.localize("Text"),className:"vjs-fg vjs-track-setting",selects:this.options_.fieldSets[0],selectConfigs:this.options_.selectConfigs,type:"colors"});this.addChild(s);const r=new Co(e,{id_:i,legendId:`captions-background-${i}`,legendText:this.localize("Text Background"),className:"vjs-bg vjs-track-setting",selects:this.options_.fieldSets[1],selectConfigs:this.options_.selectConfigs,type:"colors"});this.addChild(r);const o=new Co(e,{id_:i,legendId:`captions-window-${i}`,legendText:this.localize("Caption Area Background"),className:"vjs-window vjs-track-setting",selects:this.options_.fieldSets[2],selectConfigs:this.options_.selectConfigs,type:"colors"});this.addChild(o)}createEl(){return Le("div",{className:"vjs-track-settings-colors"})}}ie.registerComponent("TextTrackSettingsColors",Zk);class Yk extends ie{constructor(e,t={}){super(e,t);const i=this.options_.textTrackComponentid,s=new Co(e,{id_:i,legendId:`captions-font-size-${i}`,legendText:"Font Size",className:"vjs-font-percent vjs-track-setting",selects:this.options_.fieldSets[0],selectConfigs:this.options_.selectConfigs,type:"font"});this.addChild(s);const r=new Co(e,{id_:i,legendId:`captions-edge-style-${i}`,legendText:this.localize("Text Edge Style"),className:"vjs-edge-style vjs-track-setting",selects:this.options_.fieldSets[1],selectConfigs:this.options_.selectConfigs,type:"font"});this.addChild(r);const o=new Co(e,{id_:i,legendId:`captions-font-family-${i}`,legendText:this.localize("Font Family"),className:"vjs-font-family vjs-track-setting",selects:this.options_.fieldSets[2],selectConfigs:this.options_.selectConfigs,type:"font"});this.addChild(o)}createEl(){return Le("div",{className:"vjs-track-settings-font"})}}ie.registerComponent("TextTrackSettingsFont",Yk);class Gk extends ie{constructor(e,t={}){super(e,t);const i=new vi(e,{controlText:this.localize("restore all settings to the default values"),className:"vjs-default-button"});i.el().classList.remove("vjs-control","vjs-button"),i.el().textContent=this.localize("Reset"),this.addChild(i);const s=this.localize("Done"),r=new vi(e,{controlText:s,className:"vjs-done-button"});r.el().classList.remove("vjs-control","vjs-button"),r.el().textContent=s,this.addChild(r)}createEl(){return Le("div",{className:"vjs-track-settings-controls"})}}ie.registerComponent("TrackSettingsControls",Gk);const ym="vjs-text-track-settings",yS=["#000","Black"],bS=["#00F","Blue"],vS=["#0FF","Cyan"],SS=["#0F0","Green"],xS=["#F0F","Magenta"],TS=["#F00","Red"],wS=["#FFF","White"],_S=["#FF0","Yellow"],bm=["1","Opaque"],vm=["0.5","Semi-Transparent"],kS=["0","Transparent"],xr={backgroundColor:{selector:".vjs-bg-color > select",id:"captions-background-color-%s",label:"Color",options:[yS,wS,TS,SS,bS,_S,xS,vS],className:"vjs-bg-color"},backgroundOpacity:{selector:".vjs-bg-opacity > select",id:"captions-background-opacity-%s",label:"Opacity",options:[bm,vm,kS],className:"vjs-bg-opacity vjs-opacity"},color:{selector:".vjs-text-color > select",id:"captions-foreground-color-%s",label:"Color",options:[wS,yS,TS,SS,bS,_S,xS,vS],className:"vjs-text-color"},edgeStyle:{selector:".vjs-edge-style > select",id:"",label:"Text Edge Style",options:[["none","None"],["raised","Raised"],["depressed","Depressed"],["uniform","Uniform"],["dropshadow","Drop shadow"]]},fontFamily:{selector:".vjs-font-family > select",id:"",label:"Font Family",options:[["proportionalSansSerif","Proportional Sans-Serif"],["monospaceSansSerif","Monospace Sans-Serif"],["proportionalSerif","Proportional Serif"],["monospaceSerif","Monospace Serif"],["casual","Casual"],["script","Script"],["small-caps","Small Caps"]]},fontPercent:{selector:".vjs-font-percent > select",id:"",label:"Font Size",options:[["0.50","50%"],["0.75","75%"],["1.00","100%"],["1.25","125%"],["1.50","150%"],["1.75","175%"],["2.00","200%"],["3.00","300%"],["4.00","400%"]],default:2,parser:n=>n==="1.00"?null:Number(n)},textOpacity:{selector:".vjs-text-opacity > select",id:"captions-foreground-opacity-%s",label:"Opacity",options:[bm,vm],className:"vjs-text-opacity vjs-opacity"},windowColor:{selector:".vjs-window-color > select",id:"captions-window-color-%s",label:"Color",className:"vjs-window-color"},windowOpacity:{selector:".vjs-window-opacity > select",id:"captions-window-opacity-%s",label:"Opacity",options:[kS,vm,bm],className:"vjs-window-opacity vjs-opacity"}};xr.windowColor.options=xr.backgroundColor.options;function Kk(n,e){if(e&&(n=e(n)),n&&n!=="none")return n}function ON(n,e){const t=n.options[n.options.selectedIndex].value;return Kk(t,e)}function yN(n,e,t){if(e){for(let i=0;i<n.options.length;i++)if(Kk(n.options[i].value,t)===e){n.selectedIndex=i;break}}}class bN extends cl{constructor(e,t){t.temporary=!1,super(e,t),this.updateDisplay=this.updateDisplay.bind(this),this.fill(),this.hasBeenOpened_=this.hasBeenFilled_=!0,this.renderModalComponents(e),this.endDialog=Le("p",{className:"vjs-control-text",textContent:this.localize("End of dialog window.")}),this.el().appendChild(this.endDialog),this.setDefaults(),t.persistTextTrackSettings===void 0&&(this.options_.persistTextTrackSettings=this.options_.playerOptions.persistTextTrackSettings),this.bindFunctionsToSelectsAndButtons(),this.options_.persistTextTrackSettings&&this.restoreSettings()}renderModalComponents(e){const t=new Zk(e,{textTrackComponentid:this.id_,selectConfigs:xr,fieldSets:[["color","textOpacity"],["backgroundColor","backgroundOpacity"],["windowColor","windowOpacity"]]});this.addChild(t);const i=new Yk(e,{textTrackComponentid:this.id_,selectConfigs:xr,fieldSets:[["fontPercent"],["edgeStyle"],["fontFamily"]]});this.addChild(i);const s=new Gk(e);this.addChild(s)}bindFunctionsToSelectsAndButtons(){this.on(this.$(".vjs-done-button"),["click","tap"],()=>{this.saveSettings(),this.close()}),this.on(this.$(".vjs-default-button"),["click","tap"],()=>{this.setDefaults(),this.updateDisplay()}),ma(xr,e=>{this.on(this.$(e.selector),"change",this.updateDisplay)})}dispose(){this.endDialog=null,super.dispose()}label(){return this.localize("Caption Settings Dialog")}description(){return this.localize("Beginning of dialog window. Escape will cancel and close the window.")}buildCSSClass(){return super.buildCSSClass()+" vjs-text-track-settings"}getValues(){return V2(xr,(e,t,i)=>{const s=ON(this.$(t.selector),t.parser);return s!==void 0&&(e[i]=s),e},{})}setValues(e){ma(xr,(t,i)=>{yN(this.$(t.selector),e[i],t.parser)})}setDefaults(){ma(xr,e=>{const t=e.hasOwnProperty("default")?e.default:0;this.$(e.selector).selectedIndex=t})}restoreSettings(){let e;try{e=JSON.parse(V.localStorage.getItem(ym))}catch(t){ze.warn(t)}e&&this.setValues(e)}saveSettings(){if(!this.options_.persistTextTrackSettings)return;const e=this.getValues();try{Object.keys(e).length?V.localStorage.setItem(ym,JSON.stringify(e)):V.localStorage.removeItem(ym)}catch(t){ze.warn(t)}}updateDisplay(){const e=this.player_.getChild("textTrackDisplay");e&&e.updateDisplay()}handleLanguagechange(){this.fill(),this.renderModalComponents(this.player_),this.bindFunctionsToSelectsAndButtons()}}ie.registerComponent("TextTrackSettings",bN);class vN extends ie{constructor(e,t){let i=t.ResizeObserver||V.ResizeObserver;t.ResizeObserver===null&&(i=!1);const s=at({createEl:!i,reportTouchActivity:!1},t);super(e,s),this.ResizeObserver=t.ResizeObserver||V.ResizeObserver,this.loadListener_=null,this.resizeObserver_=null,this.debouncedHandler_=uk(()=>{this.resizeHandler()},100,!1,this),i?(this.resizeObserver_=new this.ResizeObserver(this.debouncedHandler_),this.resizeObserver_.observe(e.el())):(this.loadListener_=()=>{if(!this.el_||!this.el_.contentWindow)return;const r=this.debouncedHandler_;let o=this.unloadListener_=function(){bi(this,"resize",r),bi(this,"unload",o),o=null};cn(this.el_.contentWindow,"unload",o),cn(this.el_.contentWindow,"resize",r)},this.one("load",this.loadListener_))}createEl(){return super.createEl("iframe",{className:"vjs-resize-manager",tabIndex:-1,title:this.localize("No content")},{"aria-hidden":"true"})}resizeHandler(){!this.player_||!this.player_.trigger||this.player_.trigger("playerresize")}dispose(){this.debouncedHandler_&&this.debouncedHandler_.cancel(),this.resizeObserver_&&(this.player_.el()&&this.resizeObserver_.unobserve(this.player_.el()),this.resizeObserver_.disconnect()),this.loadListener_&&this.off("load",this.loadListener_),this.el_&&this.el_.contentWindow&&this.unloadListener_&&this.unloadListener_.call(this.el_.contentWindow),this.ResizeObserver=null,this.resizeObserver=null,this.debouncedHandler_=null,this.loadListener_=null,super.dispose()}}ie.registerComponent("ResizeManager",vN);const SN={trackingThreshold:20,liveTolerance:15};class xN extends ie{constructor(e,t){const i=at(SN,t,{createEl:!1});super(e,i),this.trackLiveHandler_=()=>this.trackLive_(),this.handlePlay_=s=>this.handlePlay(s),this.handleFirstTimeupdate_=s=>this.handleFirstTimeupdate(s),this.handleSeeked_=s=>this.handleSeeked(s),this.seekToLiveEdge_=s=>this.seekToLiveEdge(s),this.reset_(),this.on(this.player_,"durationchange",s=>this.handleDurationchange(s)),this.on(this.player_,"canplay",()=>this.toggleTracking())}trackLive_(){const e=this.player_.seekable();if(!e||!e.length)return;const t=Number(V.performance.now().toFixed(4)),i=this.lastTime_===-1?0:(t-this.lastTime_)/1e3;this.lastTime_=t,this.pastSeekEnd_=this.pastSeekEnd()+i;const s=this.liveCurrentTime(),r=this.player_.currentTime();let o=this.player_.paused()||this.seekedBehindLive_||Math.abs(s-r)>this.options_.liveTolerance;(!this.timeupdateSeen_||s===1/0)&&(o=!1),o!==this.behindLiveEdge_&&(this.behindLiveEdge_=o,this.trigger("liveedgechange"))}handleDurationchange(){this.toggleTracking()}toggleTracking(){this.player_.duration()===1/0&&this.liveWindow()>=this.options_.trackingThreshold?(this.player_.options_.liveui&&this.player_.addClass("vjs-liveui"),this.startTracking()):(this.player_.removeClass("vjs-liveui"),this.stopTracking())}startTracking(){this.isTracking()||(this.timeupdateSeen_||(this.timeupdateSeen_=this.player_.hasStarted()),this.trackingInterval_=this.setInterval(this.trackLiveHandler_,Pn),this.trackLive_(),this.on(this.player_,["play","pause"],this.trackLiveHandler_),this.timeupdateSeen_?this.on(this.player_,"seeked",this.handleSeeked_):(this.one(this.player_,"play",this.handlePlay_),this.one(this.player_,"timeupdate",this.handleFirstTimeupdate_)))}handleFirstTimeupdate(){this.timeupdateSeen_=!0,this.on(this.player_,"seeked",this.handleSeeked_)}handleSeeked(){const e=Math.abs(this.liveCurrentTime()-this.player_.currentTime());this.seekedBehindLive_=this.nextSeekedFromUser_&&e>2,this.nextSeekedFromUser_=!1,this.trackLive_()}handlePlay(){this.one(this.player_,"timeupdate",this.seekToLiveEdge_)}reset_(){this.lastTime_=-1,this.pastSeekEnd_=0,this.lastSeekEnd_=-1,this.behindLiveEdge_=!0,this.timeupdateSeen_=!1,this.seekedBehindLive_=!1,this.nextSeekedFromUser_=!1,this.clearInterval(this.trackingInterval_),this.trackingInterval_=null,this.off(this.player_,["play","pause"],this.trackLiveHandler_),this.off(this.player_,"seeked",this.handleSeeked_),this.off(this.player_,"play",this.handlePlay_),this.off(this.player_,"timeupdate",this.handleFirstTimeupdate_),this.off(this.player_,"timeupdate",this.seekToLiveEdge_)}nextSeekedFromUser(){this.nextSeekedFromUser_=!0}stopTracking(){this.isTracking()&&(this.reset_(),this.trigger("liveedgechange"))}seekableEnd(){const e=this.player_.seekable(),t=[];let i=e?e.length:0;for(;i--;)t.push(e.end(i));return t.length?t.sort()[t.length-1]:1/0}seekableStart(){const e=this.player_.seekable(),t=[];let i=e?e.length:0;for(;i--;)t.push(e.start(i));return t.length?t.sort()[0]:0}liveWindow(){const e=this.liveCurrentTime();return e===1/0?0:e-this.seekableStart()}isLive(){return this.isTracking()}atLiveEdge(){return!this.behindLiveEdge()}liveCurrentTime(){return this.pastSeekEnd()+this.seekableEnd()}pastSeekEnd(){const e=this.seekableEnd();return this.lastSeekEnd_!==-1&&e!==this.lastSeekEnd_&&(this.pastSeekEnd_=0),this.lastSeekEnd_=e,this.pastSeekEnd_}behindLiveEdge(){return this.behindLiveEdge_}isTracking(){return typeof this.trackingInterval_=="number"}seekToLiveEdge(){this.seekedBehindLive_=!1,!this.atLiveEdge()&&(this.nextSeekedFromUser_=!1,this.player_.currentTime(this.liveCurrentTime()))}dispose(){this.stopTracking(),super.dispose()}}ie.registerComponent("LiveTracker",xN);class TN extends ie{constructor(e,t){super(e,t),this.on("statechanged",i=>this.updateDom_()),this.updateDom_()}createEl(){return this.els={title:Le("div",{className:"vjs-title-bar-title",id:`vjs-title-bar-title-${An()}`}),description:Le("div",{className:"vjs-title-bar-description",id:`vjs-title-bar-description-${An()}`})},Le("div",{className:"vjs-title-bar"},{},U2(this.els))}updateDom_(){const e=this.player_.tech_,t=e&&e.el_,i={title:"aria-labelledby",description:"aria-describedby"};["title","description"].forEach(s=>{const r=this.state[s],o=this.els[s],a=i[s];Gf(o),r&&Zr(o,r),t&&(t.removeAttribute(a),r&&t.setAttribute(a,o.id))}),this.state.title||this.state.description?this.show():this.hide()}update(e){this.setState(e)}dispose(){const e=this.player_.tech_,t=e&&e.el_;t&&(t.removeAttribute("aria-labelledby"),t.removeAttribute("aria-describedby")),super.dispose(),this.els=null}}ie.registerComponent("TitleBar",TN);const wN={initialDisplay:4e3,position:[],takeFocus:!1};class _N extends vi{constructor(e,t){t=at(wN,t),super(e,t),this.controlText(t.controlText),this.hide(),this.on(this.player_,["useractive","userinactive"],i=>{this.removeClass("force-display")})}buildCSSClass(){return`vjs-transient-button focus-visible ${this.options_.position.map(e=>`vjs-${e}`).join(" ")}`}createEl(){const e=Le("button",{},{type:"button",class:this.buildCSSClass()},Le("span"));return this.controlTextEl_=e.querySelector("span"),e}show(){super.show(),this.addClass("force-display"),this.options_.takeFocus&&this.el().focus({preventScroll:!0}),this.forceDisplayTimeout=this.player_.setTimeout(()=>{this.removeClass("force-display")},this.options_.initialDisplay)}hide(){this.removeClass("force-display"),super.hide()}dispose(){this.player_.clearTimeout(this.forceDisplayTimeout),super.dispose()}}ie.registerComponent("TransientButton",_N);const Gg=n=>{const e=n.el();if(e.hasAttribute("src"))return n.triggerSourceset(e.src),!0;const t=n.$$("source"),i=[];let s="";if(!t.length)return!1;for(let r=0;r<t.length;r++){const o=t[r].src;o&&i.indexOf(o)===-1&&i.push(o)}return i.length?(i.length===1&&(s=i[0]),n.triggerSourceset(s),!0):!1},kN=Object.defineProperty({},"innerHTML",{get(){return this.cloneNode(!0).innerHTML},set(n){const e=he.createElement(this.nodeName.toLowerCase());e.innerHTML=n;const t=he.createDocumentFragment();for(;e.childNodes.length;)t.appendChild(e.childNodes[0]);return this.innerText="",V.Element.prototype.appendChild.call(this,t),this.innerHTML}}),Jk=(n,e)=>{let t={};for(let i=0;i<n.length&&(t=Object.getOwnPropertyDescriptor(n[i],e),!(t&&t.set&&t.get));i++);return t.enumerable=!0,t.configurable=!0,t},CN=n=>Jk([n.el(),V.HTMLMediaElement.prototype,V.Element.prototype,kN],"innerHTML"),CS=function(n){const e=n.el();if(e.resetSourceWatch_)return;const t={},i=CN(n),s=r=>(...o)=>{const a=r.apply(e,o);return Gg(n),a};["append","appendChild","insertAdjacentHTML"].forEach(r=>{e[r]&&(t[r]=e[r],e[r]=s(t[r]))}),Object.defineProperty(e,"innerHTML",at(i,{set:s(i.set)})),e.resetSourceWatch_=()=>{e.resetSourceWatch_=null,Object.keys(t).forEach(r=>{e[r]=t[r]}),Object.defineProperty(e,"innerHTML",i)},n.one("sourceset",e.resetSourceWatch_)},EN=Object.defineProperty({},"src",{get(){return this.hasAttribute("src")?Sk(V.Element.prototype.getAttribute.call(this,"src")):""},set(n){return V.Element.prototype.setAttribute.call(this,"src",n),n}}),AN=n=>Jk([n.el(),V.HTMLMediaElement.prototype,EN],"src"),PN=function(n){if(!n.featuresSourceset)return;const e=n.el();if(e.resetSourceset_)return;const t=AN(n),i=e.setAttribute,s=e.load;Object.defineProperty(e,"src",at(t,{set:r=>{const o=t.set.call(e,r);return n.triggerSourceset(e.src),o}})),e.setAttribute=(r,o)=>{const a=i.call(e,r,o);return/src/i.test(r)&&n.triggerSourceset(e.src),a},e.load=()=>{const r=s.call(e);return Gg(n)||(n.triggerSourceset(""),CS(n)),r},e.currentSrc?n.triggerSourceset(e.currentSrc):Gg(n)||CS(n),e.resetSourceset_=()=>{e.resetSourceset_=null,e.load=s,e.setAttribute=i,Object.defineProperty(e,"src",t),e.resetSourceWatch_&&e.resetSourceWatch_()}};class ye extends Be{constructor(e,t){super(e,t);const i=e.source;let s=!1;if(this.featuresVideoFrameCallback=this.featuresVideoFrameCallback&&this.el_.tagName==="VIDEO",i&&(this.el_.currentSrc!==i.src||e.tag&&e.tag.initNetworkState_===3)?this.setSource(i):this.handleLateInit_(this.el_),e.enableSourceset&&this.setupSourcesetHandling_(),this.isScrubbing_=!1,this.el_.hasChildNodes()){const r=this.el_.childNodes;let o=r.length;const a=[];for(;o--;){const l=r[o];l.nodeName.toLowerCase()==="track"&&(this.featuresNativeTextTracks?(this.remoteTextTrackEls().addTrackElement_(l),this.remoteTextTracks().addTrack(l.track),this.textTracks().addTrack(l.track),!s&&!this.el_.hasAttribute("crossorigin")&&tp(l.src)&&(s=!0)):a.push(l))}for(let l=0;l<a.length;l++)this.el_.removeChild(a[l])}this.proxyNativeTracks_(),this.featuresNativeTextTracks&&s&&ze.warn(`Text Tracks are being loaded from another origin but the crossorigin attribute isn't used.
This may prevent text tracks from loading.`),this.restoreMetadataTracksInIOSNativePlayer_(),(Fh||Xf)&&e.nativeControlsForTouch===!0&&this.setControls(!0),this.proxyWebkitFullscreen_(),this.triggerReady()}dispose(){this.el_&&this.el_.resetSourceset_&&this.el_.resetSourceset_(),ye.disposeMediaElement(this.el_),this.options_=null,super.dispose()}setupSourcesetHandling_(){PN(this)}restoreMetadataTracksInIOSNativePlayer_(){const e=this.textTracks();let t;const i=()=>{t=[];for(let r=0;r<e.length;r++){const o=e[r];o.kind==="metadata"&&t.push({track:o,storedMode:o.mode})}};i(),e.addEventListener("change",i),this.on("dispose",()=>e.removeEventListener("change",i));const s=()=>{for(let r=0;r<t.length;r++){const o=t[r];o.track.mode==="disabled"&&o.track.mode!==o.storedMode&&(o.track.mode=o.storedMode)}e.removeEventListener("change",s)};this.on("webkitbeginfullscreen",()=>{e.removeEventListener("change",i),e.removeEventListener("change",s),e.addEventListener("change",s)}),this.on("webkitendfullscreen",()=>{e.removeEventListener("change",i),e.addEventListener("change",i),e.removeEventListener("change",s)})}overrideNative_(e,t){if(t!==this[`featuresNative${e}Tracks`])return;const i=e.toLowerCase();this[`${i}TracksListeners_`]&&Object.keys(this[`${i}TracksListeners_`]).forEach(s=>{this.el()[`${i}Tracks`].removeEventListener(s,this[`${i}TracksListeners_`][s])}),this[`featuresNative${e}Tracks`]=!t,this[`${i}TracksListeners_`]=null,this.proxyNativeTracksForType_(i)}overrideNativeAudioTracks(e){this.overrideNative_("Audio",e)}overrideNativeVideoTracks(e){this.overrideNative_("Video",e)}proxyNativeTracksForType_(e){const t=Cn[e],i=this.el()[t.getterName],s=this[t.getterName]();if(!this[`featuresNative${t.capitalName}Tracks`]||!i||!i.addEventListener)return;const r={change:a=>{const l={type:"change",target:s,currentTarget:s,srcElement:s};s.trigger(l),e==="text"&&this[Ua.remoteText.getterName]().trigger(l)},addtrack(a){s.addTrack(a.track)},removetrack(a){s.removeTrack(a.track)}},o=function(){const a=[];for(let l=0;l<s.length;l++){let h=!1;for(let u=0;u<i.length;u++)if(i[u]===s[l]){h=!0;break}h||a.push(s[l])}for(;a.length;)s.removeTrack(a.shift())};this[t.getterName+"Listeners_"]=r,Object.keys(r).forEach(a=>{const l=r[a];i.addEventListener(a,l),this.on("dispose",h=>i.removeEventListener(a,l))}),this.on("loadstart",o),this.on("dispose",a=>this.off("loadstart",o))}proxyNativeTracks_(){Cn.names.forEach(e=>{this.proxyNativeTracksForType_(e)})}createEl(){let e=this.options_.tag;if(!e||!(this.options_.playerElIngest||this.movingMediaElementInDOM)){if(e){const i=e.cloneNode(!0);e.parentNode&&e.parentNode.insertBefore(i,e),ye.disposeMediaElement(e),e=i}else{e=he.createElement("video");const i=this.options_.tag&&Sr(this.options_.tag),s=at({},i);(!Fh||this.options_.nativeControlsForTouch!==!0)&&delete s.controls,G2(e,Object.assign(s,{id:this.options_.techId,class:"vjs-tech"}))}e.playerId=this.options_.playerId}typeof this.options_.preload<"u"&&Na(e,"preload",this.options_.preload),this.options_.disablePictureInPicture!==void 0&&(e.disablePictureInPicture=this.options_.disablePictureInPicture);const t=["loop","muted","playsinline","autoplay"];for(let i=0;i<t.length;i++){const s=t[i],r=this.options_[s];typeof r<"u"&&(r?Na(e,s,s):Zf(e,s),e[s]=r)}return e}handleLateInit_(e){if(e.networkState===0||e.networkState===3)return;if(e.readyState===0){let i=!1;const s=function(){i=!0};this.on("loadstart",s);const r=function(){i||this.trigger("loadstart")};this.on("loadedmetadata",r),this.ready(function(){this.off("loadstart",s),this.off("loadedmetadata",r),i||this.trigger("loadstart")});return}const t=["loadstart"];t.push("loadedmetadata"),e.readyState>=2&&t.push("loadeddata"),e.readyState>=3&&t.push("canplay"),e.readyState>=4&&t.push("canplaythrough"),this.ready(function(){t.forEach(function(i){this.trigger(i)},this)})}setScrubbing(e){this.isScrubbing_=e}scrubbing(){return this.isScrubbing_}setCurrentTime(e){try{this.isScrubbing_&&this.el_.fastSeek&&Hf?this.el_.fastSeek(e):this.el_.currentTime=e}catch(t){ze(t,"Video is not ready. (Video.js)")}}duration(){if(this.el_.duration===1/0&&Wn&&As&&this.el_.currentTime===0){const e=()=>{this.el_.currentTime>0&&(this.el_.duration===1/0&&this.trigger("durationchange"),this.off("timeupdate",e))};return this.on("timeupdate",e),NaN}return this.el_.duration||NaN}width(){return this.el_.offsetWidth}height(){return this.el_.offsetHeight}proxyWebkitFullscreen_(){if(!("webkitDisplayingFullscreen"in this.el_))return;const e=function(){this.trigger("fullscreenchange",{isFullscreen:!1}),this.el_.controls&&!this.options_.nativeControlsForTouch&&this.controls()&&(this.el_.controls=!1)},t=function(){"webkitPresentationMode"in this.el_&&this.el_.webkitPresentationMode!=="picture-in-picture"&&(this.one("webkitendfullscreen",e),this.trigger("fullscreenchange",{isFullscreen:!0,nativeIOSFullscreen:!0}))};this.on("webkitbeginfullscreen",t),this.on("dispose",()=>{this.off("webkitbeginfullscreen",t),this.off("webkitendfullscreen",e)})}supportsFullScreen(){return typeof this.el_.webkitEnterFullScreen=="function"}enterFullScreen(){const e=this.el_;if(e.paused&&e.networkState<=e.HAVE_METADATA)ms(this.el_.play()),this.setTimeout(function(){e.pause();try{e.webkitEnterFullScreen()}catch(t){this.trigger("fullscreenerror",t)}},0);else try{e.webkitEnterFullScreen()}catch(t){this.trigger("fullscreenerror",t)}}exitFullScreen(){if(!this.el_.webkitDisplayingFullscreen){this.trigger("fullscreenerror",new Error("The video is not fullscreen"));return}this.el_.webkitExitFullScreen()}requestPictureInPicture(){return this.el_.requestPictureInPicture()}requestVideoFrameCallback(e){return this.featuresVideoFrameCallback&&!this.el_.webkitKeys?this.el_.requestVideoFrameCallback(e):super.requestVideoFrameCallback(e)}cancelVideoFrameCallback(e){this.featuresVideoFrameCallback&&!this.el_.webkitKeys?this.el_.cancelVideoFrameCallback(e):super.cancelVideoFrameCallback(e)}src(e){if(e===void 0)return this.el_.src;this.setSrc(e)}addSourceElement(e,t){if(!e)return ze.error("Invalid source URL."),!1;const i={src:e};t&&(i.type=t);const s=Le("source",{},i);return this.el_.appendChild(s),!0}removeSourceElement(e){if(!e)return ze.error("Source URL is required to remove the source element."),!1;const t=this.el_.querySelectorAll("source");for(const i of t)if(i.src===e)return this.el_.removeChild(i),!0;return ze.warn(`No matching source element found with src: ${e}`),!1}reset(){ye.resetMediaElement(this.el_)}currentSrc(){return this.currentSource_?this.currentSource_.src:this.el_.currentSrc}setControls(e){this.el_.controls=!!e}addTextTrack(e,t,i){return this.featuresNativeTextTracks?this.el_.addTextTrack(e,t,i):super.addTextTrack(e,t,i)}createRemoteTextTrack(e){if(!this.featuresNativeTextTracks)return super.createRemoteTextTrack(e);const t=he.createElement("track");return e.kind&&(t.kind=e.kind),e.label&&(t.label=e.label),(e.language||e.srclang)&&(t.srclang=e.language||e.srclang),e.default&&(t.default=e.default),e.id&&(t.id=e.id),e.src&&(t.src=e.src),t}addRemoteTextTrack(e,t){const i=super.addRemoteTextTrack(e,t);return this.featuresNativeTextTracks&&this.el().appendChild(i),i}removeRemoteTextTrack(e){if(super.removeRemoteTextTrack(e),this.featuresNativeTextTracks){const t=this.$$("track");let i=t.length;for(;i--;)(e===t[i]||e===t[i].track)&&this.el().removeChild(t[i])}}getVideoPlaybackQuality(){if(typeof this.el().getVideoPlaybackQuality=="function")return this.el().getVideoPlaybackQuality();const e={};return typeof this.el().webkitDroppedFrameCount<"u"&&typeof this.el().webkitDecodedFrameCount<"u"&&(e.droppedVideoFrames=this.el().webkitDroppedFrameCount,e.totalVideoFrames=this.el().webkitDecodedFrameCount),V.performance&&(e.creationTime=V.performance.now()),e}}qf(ye,"TEST_VID",function(){if(!ll())return;const n=he.createElement("video"),e=he.createElement("track");return e.kind="captions",e.srclang="en",e.label="English",n.appendChild(e),n});ye.isSupported=function(){try{ye.TEST_VID.volume=.5}catch{return!1}return!!(ye.TEST_VID&&ye.TEST_VID.canPlayType)};ye.canPlayType=function(n){return ye.TEST_VID.canPlayType(n)};ye.canPlaySource=function(n,e){return ye.canPlayType(n.type)};ye.canControlVolume=function(){try{const n=ye.TEST_VID.volume;ye.TEST_VID.volume=n/2+.1;const e=n!==ye.TEST_VID.volume;return e&&yi?(V.setTimeout(()=>{ye&&ye.prototype&&(ye.prototype.featuresVolumeControl=n!==ye.TEST_VID.volume)}),!1):e}catch{return!1}};ye.canMuteVolume=function(){try{const n=ye.TEST_VID.muted;return ye.TEST_VID.muted=!n,ye.TEST_VID.muted?Na(ye.TEST_VID,"muted","muted"):Zf(ye.TEST_VID,"muted","muted"),n!==ye.TEST_VID.muted}catch{return!1}};ye.canControlPlaybackRate=function(){if(Wn&&As&&zf<58)return!1;try{const n=ye.TEST_VID.playbackRate;return ye.TEST_VID.playbackRate=n/2+.1,n!==ye.TEST_VID.playbackRate}catch{return!1}};ye.canOverrideAttributes=function(){try{const n=()=>{};Object.defineProperty(he.createElement("video"),"src",{get:n,set:n}),Object.defineProperty(he.createElement("audio"),"src",{get:n,set:n}),Object.defineProperty(he.createElement("video"),"innerHTML",{get:n,set:n}),Object.defineProperty(he.createElement("audio"),"innerHTML",{get:n,set:n})}catch{return!1}return!0};ye.supportsNativeTextTracks=function(){return Hf||yi&&As};ye.supportsNativeVideoTracks=function(){return!!(ye.TEST_VID&&ye.TEST_VID.videoTracks)};ye.supportsNativeAudioTracks=function(){return!!(ye.TEST_VID&&ye.TEST_VID.audioTracks)};ye.Events=["loadstart","suspend","abort","error","emptied","stalled","loadedmetadata","loadeddata","canplay","canplaythrough","playing","waiting","seeking","seeked","ended","durationchange","timeupdate","progress","play","pause","ratechange","resize","volumechange"];[["featuresMuteControl","canMuteVolume"],["featuresPlaybackRate","canControlPlaybackRate"],["featuresSourceset","canOverrideAttributes"],["featuresNativeTextTracks","supportsNativeTextTracks"],["featuresNativeVideoTracks","supportsNativeVideoTracks"],["featuresNativeAudioTracks","supportsNativeAudioTracks"]].forEach(function([n,e]){qf(ye.prototype,n,()=>ye[e](),!0)});ye.prototype.featuresVolumeControl=ye.canControlVolume();ye.prototype.movingMediaElementInDOM=!yi;ye.prototype.featuresFullscreenResize=!0;ye.prototype.featuresProgressEvents=!0;ye.prototype.featuresTimeupdateEvents=!0;ye.prototype.featuresVideoFrameCallback=!!(ye.TEST_VID&&ye.TEST_VID.requestVideoFrameCallback);ye.disposeMediaElement=function(n){if(n){for(n.parentNode&&n.parentNode.removeChild(n);n.hasChildNodes();)n.removeChild(n.firstChild);n.removeAttribute("src"),typeof n.load=="function"&&(function(){try{n.load()}catch{}})()}};ye.resetMediaElement=function(n){if(!n)return;const e=n.querySelectorAll("source");let t=e.length;for(;t--;)n.removeChild(e[t]);n.removeAttribute("src"),typeof n.load=="function"&&(function(){try{n.load()}catch{}})()};["muted","defaultMuted","autoplay","controls","loop","playsinline"].forEach(function(n){ye.prototype[n]=function(){return this.el_[n]||this.el_.hasAttribute(n)}});["muted","defaultMuted","autoplay","loop","playsinline"].forEach(function(n){ye.prototype["set"+Dt(n)]=function(e){this.el_[n]=e,e?this.el_.setAttribute(n,n):this.el_.removeAttribute(n)}});["paused","currentTime","buffered","volume","poster","preload","error","seeking","seekable","ended","playbackRate","defaultPlaybackRate","disablePictureInPicture","played","networkState","readyState","videoWidth","videoHeight","crossOrigin"].forEach(function(n){ye.prototype[n]=function(){return this.el_[n]}});["volume","src","poster","preload","playbackRate","defaultPlaybackRate","disablePictureInPicture","crossOrigin"].forEach(function(n){ye.prototype["set"+Dt(n)]=function(e){this.el_[n]=e}});["pause","load","play"].forEach(function(n){ye.prototype[n]=function(){return this.el_[n]()}});Be.withSourceHandlers(ye);ye.nativeSourceHandler={};ye.nativeSourceHandler.canPlayType=function(n){try{return ye.TEST_VID.canPlayType(n)}catch{return""}};ye.nativeSourceHandler.canHandleSource=function(n,e){if(n.type)return ye.nativeSourceHandler.canPlayType(n.type);if(n.src){const t=Uy(n.src);return ye.nativeSourceHandler.canPlayType(`video/${t}`)}return""};ye.nativeSourceHandler.handleSource=function(n,e,t){e.setSrc(n.src)};ye.nativeSourceHandler.dispose=function(){};ye.registerSourceHandler(ye.nativeSourceHandler);Be.registerTech("Html5",ye);const eC=["progress","abort","suspend","emptied","stalled","loadedmetadata","loadeddata","timeupdate","resize","volumechange","texttrackchange"],Sm={canplay:"CanPlay",canplaythrough:"CanPlayThrough",playing:"Playing",seeked:"Seeked"},Kg=["tiny","xsmall","small","medium","large","xlarge","huge"],Gc={};Kg.forEach(n=>{const e=n.charAt(0)==="x"?`x-${n.substring(1)}`:n;Gc[n]=`vjs-layout-${e}`});const DN={tiny:210,xsmall:320,small:425,medium:768,large:1440,xlarge:2560,huge:1/0};class Je extends ie{constructor(e,t,i){if(e.id=e.id||t.id||`vjs_video_${An()}`,t=Object.assign(Je.getTagSettings(e),t),t.initChildren=!1,t.createEl=!1,t.evented=!1,t.reportTouchActivity=!1,!t.language){const o=e.closest("[lang]");o&&(t.language=o.getAttribute("lang"))}if(super(null,t,i),this.boundDocumentFullscreenChange_=o=>this.documentFullscreenChange_(o),this.boundFullWindowOnEscKey_=o=>this.fullWindowOnEscKey(o),this.boundUpdateStyleEl_=o=>this.updateStyleEl_(o),this.boundApplyInitTime_=o=>this.applyInitTime_(o),this.boundUpdateCurrentBreakpoint_=o=>this.updateCurrentBreakpoint_(o),this.boundHandleTechClick_=o=>this.handleTechClick_(o),this.boundHandleTechDoubleClick_=o=>this.handleTechDoubleClick_(o),this.boundHandleTechTouchStart_=o=>this.handleTechTouchStart_(o),this.boundHandleTechTouchMove_=o=>this.handleTechTouchMove_(o),this.boundHandleTechTouchEnd_=o=>this.handleTechTouchEnd_(o),this.boundHandleTechTap_=o=>this.handleTechTap_(o),this.boundUpdatePlayerHeightOnAudioOnlyMode_=o=>this.updatePlayerHeightOnAudioOnlyMode_(o),this.isFullscreen_=!1,this.log=N2(this.id_),this.fsApi_=Ad,this.isPosterFromTech_=!1,this.queuedCallbacks_=[],this.isReady_=!1,this.hasStarted_=!1,this.userActive_=!1,this.debugEnabled_=!1,this.audioOnlyMode_=!1,this.audioPosterMode_=!1,this.audioOnlyCache_={controlBarHeight:null,playerHeight:null,hiddenChildren:[]},!this.options_||!this.options_.techOrder||!this.options_.techOrder.length)throw new Error("No techOrder specified. Did you overwrite videojs.options instead of just changing the properties you want to override?");if(this.tag=e,this.tagAttributes=e&&Sr(e),this.language(this.options_.language),t.languages){const o={};Object.getOwnPropertyNames(t.languages).forEach(function(a){o[a.toLowerCase()]=t.languages[a]}),this.languages_=o}else this.languages_=Je.prototype.options_.languages;this.resetCache_(),this.poster_=t.poster||"",this.controls_=!!t.controls,e.controls=!1,e.removeAttribute("controls"),this.changingSrc_=!1,this.playCallbacks_=[],this.playTerminatedQueue_=[],e.hasAttribute("autoplay")?this.autoplay(!0):this.autoplay(this.options_.autoplay),t.plugins&&Object.keys(t.plugins).forEach(o=>{if(typeof this[o]!="function")throw new Error(`plugin "${o}" does not exist`)}),this.scrubbing_=!1,this.el_=this.createEl(),Qy(this,{eventBusKey:"el_"}),this.fsApi_.requestFullscreen&&(cn(he,this.fsApi_.fullscreenchange,this.boundDocumentFullscreenChange_),this.on(this.fsApi_.fullscreenchange,this.boundDocumentFullscreenChange_)),this.fluid_&&this.on(["playerreset","resize"],this.boundUpdateStyleEl_);const s=at(this.options_);if(t.plugins&&Object.keys(t.plugins).forEach(o=>{this[o](t.plugins[o])}),t.debug&&this.debug(!0),this.options_.playerOptions=s,this.middleware_=[],this.playbackRates(t.playbackRates),t.experimentalSvgIcons){const a=new V.DOMParser().parseFromString(eN,"image/svg+xml");if(a.querySelector("parsererror"))ze.warn("Failed to load SVG Icons. Falling back to Font Icons."),this.options_.experimentalSvgIcons=null;else{const h=a.documentElement;h.style.display="none",this.el_.appendChild(h),this.addClass("vjs-svg-icons-enabled")}}this.initChildren(),this.isAudio(e.nodeName.toLowerCase()==="audio"),this.controls()?this.addClass("vjs-controls-enabled"):this.addClass("vjs-controls-disabled"),this.el_.setAttribute("role","region"),this.isAudio()?this.el_.setAttribute("aria-label",this.localize("Audio Player")):this.el_.setAttribute("aria-label",this.localize("Video Player")),this.isAudio()&&this.addClass("vjs-audio"),t.spatialNavigation&&t.spatialNavigation.enabled&&(this.spatialNavigation=new tN(this),this.addClass("vjs-spatial-navigation-enabled")),Fh&&this.addClass("vjs-touch-enabled"),yi||this.addClass("vjs-workinghover"),Je.players[this.id_]=this;const r=Vg.split(".")[0];this.addClass(`vjs-v${r}`),this.userActive(!0),this.reportUserActivity(),this.one("play",o=>this.listenForUserActivity_(o)),this.on("keydown",o=>this.handleKeyDown(o)),this.on("languagechange",o=>this.handleLanguagechange(o)),this.breakpoints(this.options_.breakpoints),this.responsive(this.options_.responsive),this.on("ready",()=>{this.audioPosterMode(this.options_.audioPosterMode),this.audioOnlyMode(this.options_.audioOnlyMode)})}dispose(){this.trigger("dispose"),this.off("dispose"),bi(he,this.fsApi_.fullscreenchange,this.boundDocumentFullscreenChange_),bi(he,"keydown",this.boundFullWindowOnEscKey_),this.styleEl_&&this.styleEl_.parentNode&&(this.styleEl_.parentNode.removeChild(this.styleEl_),this.styleEl_=null),Je.players[this.id_]=null,this.tag&&this.tag.player&&(this.tag.player=null),this.el_&&this.el_.player&&(this.el_.player=null),this.tech_&&(this.tech_.dispose(),this.isPosterFromTech_=!1,this.poster_=""),this.playerElIngest_&&(this.playerElIngest_=null),this.tag&&(this.tag=null),YB(this),Mi.names.forEach(e=>{const t=Mi[e],i=this[t.getterName]();i&&i.off&&i.off()}),super.dispose({restoreEl:this.options_.restoreEl})}createEl(){let e=this.tag,t,i=this.playerElIngest_=e.parentNode&&e.parentNode.hasAttribute&&e.parentNode.hasAttribute("data-vjs-player");const s=this.tag.tagName.toLowerCase()==="video-js";i?t=this.el_=e.parentNode:s||(t=this.el_=super.createEl("div"));const r=Sr(e);if(s){for(t=this.el_=e,e=this.tag=he.createElement("video");t.children.length;)e.appendChild(t.firstChild);Oh(t,"video-js")||_o(t,"video-js"),t.appendChild(e),i=this.playerElIngest_=t,Object.keys(t).forEach(l=>{try{e[l]=t[l]}catch{}})}e.setAttribute("tabindex","-1"),r.tabindex="-1",As&&jf&&(e.setAttribute("role","application"),r.role="application"),e.removeAttribute("width"),e.removeAttribute("height"),"width"in r&&delete r.width,"height"in r&&delete r.height,Object.getOwnPropertyNames(r).forEach(function(l){s&&l==="class"||t.setAttribute(l,r[l]),s&&e.setAttribute(l,r[l])}),e.playerId=e.id,e.id+="_html5_api",e.className="vjs-tech",e.player=t.player=this,this.addClass("vjs-paused");const o=["IS_SMART_TV","IS_TIZEN","IS_WEBOS","IS_ANDROID","IS_IPAD","IS_IPHONE","IS_CHROMECAST_RECEIVER"].filter(l=>H2[l]).map(l=>"vjs-device-"+l.substring(3).toLowerCase().replace(/\_/g,"-"));if(this.addClass(...o),V.VIDEOJS_NO_DYNAMIC_STYLE!==!0){this.styleEl_=lk("vjs-styles-dimensions");const l=Ur(".vjs-styles-defaults"),h=Ur("head");h.insertBefore(this.styleEl_,l?l.nextSibling:h.firstChild)}this.fill_=!1,this.fluid_=!1,this.width(this.options_.width),this.height(this.options_.height),this.fill(this.options_.fill),this.fluid(this.options_.fluid),this.aspectRatio(this.options_.aspectRatio),this.crossOrigin(this.options_.crossOrigin||this.options_.crossorigin);const a=e.getElementsByTagName("a");for(let l=0;l<a.length;l++){const h=a.item(l);_o(h,"vjs-hidden"),h.setAttribute("hidden","hidden")}return e.initNetworkState_=e.networkState,e.parentNode&&!i&&e.parentNode.insertBefore(t,e),qg(e,t),this.children_.unshift(e),this.el_.setAttribute("lang",this.language_),this.el_.setAttribute("translate","no"),this.el_=t,t}crossOrigin(e){if(typeof e>"u")return this.techGet_("crossOrigin");if(e!==null&&e!=="anonymous"&&e!=="use-credentials"){ze.warn(`crossOrigin must be null,  "anonymous" or "use-credentials", given "${e}"`);return}this.techCall_("setCrossOrigin",e),this.posterImage&&this.posterImage.crossOrigin(e)}width(e){return this.dimension("width",e)}height(e){return this.dimension("height",e)}dimension(e,t){const i=e+"_";if(t===void 0)return this[i]||0;if(t===""||t==="auto"){this[i]=void 0,this.updateStyleEl_();return}const s=parseFloat(t);if(isNaN(s)){ze.error(`Improper value "${t}" supplied for for ${e}`);return}this[i]=s,this.updateStyleEl_()}fluid(e){if(e===void 0)return!!this.fluid_;this.fluid_=!!e,tr(this)&&this.off(["playerreset","resize"],this.boundUpdateStyleEl_),e?(this.addClass("vjs-fluid"),this.fill(!1),EB(this,()=>{this.on(["playerreset","resize"],this.boundUpdateStyleEl_)})):this.removeClass("vjs-fluid"),this.updateStyleEl_()}fill(e){if(e===void 0)return!!this.fill_;this.fill_=!!e,e?(this.addClass("vjs-fill"),this.fluid(!1)):this.removeClass("vjs-fill")}aspectRatio(e){if(e===void 0)return this.aspectRatio_;if(!/^\d+\:\d+$/.test(e))throw new Error("Improper value supplied for aspect ratio. The format should be width:height, for example 16:9.");this.aspectRatio_=e,this.fluid(!0),this.updateStyleEl_()}updateStyleEl_(){if(V.VIDEOJS_NO_DYNAMIC_STYLE===!0){const a=typeof this.width_=="number"?this.width_:this.options_.width,l=typeof this.height_=="number"?this.height_:this.options_.height,h=this.tech_&&this.tech_.el();h&&(a>=0&&(h.width=a),l>=0&&(h.height=l));return}let e,t,i,s;this.aspectRatio_!==void 0&&this.aspectRatio_!=="auto"?i=this.aspectRatio_:this.videoWidth()>0?i=this.videoWidth()+":"+this.videoHeight():i="16:9";const r=i.split(":"),o=r[1]/r[0];this.width_!==void 0?e=this.width_:this.height_!==void 0?e=this.height_/o:e=this.videoWidth()||300,this.height_!==void 0?t=this.height_:t=e*o,/^[^a-zA-Z]/.test(this.id())?s="dimensions-"+this.id():s=this.id()+"-dimensions",this.addClass(s),hk(this.styleEl_,`
      .${s} {
        width: ${e}px;
        height: ${t}px;
      }

      .${s}.vjs-fluid:not(.vjs-audio-only-mode) {
        padding-top: ${o*100}%;
      }
    `)}loadTech_(e,t){this.tech_&&this.unloadTech_();const i=Dt(e),s=e.charAt(0).toLowerCase()+e.slice(1);i!=="Html5"&&this.tag&&(Be.getTech("Html5").disposeMediaElement(this.tag),this.tag.player=null,this.tag=null),this.techName_=i,this.isReady_=!1;let r=this.autoplay();(typeof this.autoplay()=="string"||this.autoplay()===!0&&this.options_.normalizeAutoplay)&&(r=!1);const o={source:t,autoplay:r,nativeControlsForTouch:this.options_.nativeControlsForTouch,playerId:this.id(),techId:`${this.id()}_${s}_api`,playsinline:this.options_.playsinline,preload:this.options_.preload,loop:this.options_.loop,disablePictureInPicture:this.options_.disablePictureInPicture,muted:this.options_.muted,poster:this.poster(),language:this.language(),playerElIngest:this.playerElIngest_||!1,"vtt.js":this.options_["vtt.js"],canOverridePoster:!!this.options_.techCanOverridePoster,enableSourceset:this.options_.enableSourceset};Mi.names.forEach(l=>{const h=Mi[l];o[h.getterName]=this[h.privateName]}),Object.assign(o,this.options_[i]),Object.assign(o,this.options_[s]),Object.assign(o,this.options_[e.toLowerCase()]),this.tag&&(o.tag=this.tag),t&&t.src===this.cache_.src&&this.cache_.currentTime>0&&(o.startTime=this.cache_.currentTime);const a=Be.getTech(e);if(!a)throw new Error(`No Tech named '${i}' exists! '${i}' should be registered using videojs.registerTech()'`);this.tech_=new a(o),this.tech_.ready(pt(this,this.handleTechReady_),!0),Zg.jsonToTextTracks(this.textTracksJson_||[],this.tech_),eC.forEach(l=>{this.on(this.tech_,l,h=>this[`handleTech${Dt(l)}_`](h))}),Object.keys(Sm).forEach(l=>{this.on(this.tech_,l,h=>{if(this.tech_.playbackRate()===0&&this.tech_.seeking()){this.queuedCallbacks_.push({callback:this[`handleTech${Sm[l]}_`].bind(this),event:h});return}this[`handleTech${Sm[l]}_`](h)})}),this.on(this.tech_,"loadstart",l=>this.handleTechLoadStart_(l)),this.on(this.tech_,"sourceset",l=>this.handleTechSourceset_(l)),this.on(this.tech_,"waiting",l=>this.handleTechWaiting_(l)),this.on(this.tech_,"ended",l=>this.handleTechEnded_(l)),this.on(this.tech_,"seeking",l=>this.handleTechSeeking_(l)),this.on(this.tech_,"play",l=>this.handleTechPlay_(l)),this.on(this.tech_,"pause",l=>this.handleTechPause_(l)),this.on(this.tech_,"durationchange",l=>this.handleTechDurationChange_(l)),this.on(this.tech_,"fullscreenchange",(l,h)=>this.handleTechFullscreenChange_(l,h)),this.on(this.tech_,"fullscreenerror",(l,h)=>this.handleTechFullscreenError_(l,h)),this.on(this.tech_,"enterpictureinpicture",l=>this.handleTechEnterPictureInPicture_(l)),this.on(this.tech_,"leavepictureinpicture",l=>this.handleTechLeavePictureInPicture_(l)),this.on(this.tech_,"error",l=>this.handleTechError_(l)),this.on(this.tech_,"posterchange",l=>this.handleTechPosterChange_(l)),this.on(this.tech_,"textdata",l=>this.handleTechTextData_(l)),this.on(this.tech_,"ratechange",l=>this.handleTechRateChange_(l)),this.on(this.tech_,"loadedmetadata",this.boundUpdateStyleEl_),this.usingNativeControls(this.techGet_("controls")),this.controls()&&!this.usingNativeControls()&&this.addTechControlsListeners_(),this.tech_.el().parentNode!==this.el()&&(i!=="Html5"||!this.tag)&&qg(this.tech_.el(),this.el()),this.tag&&(this.tag.player=null,this.tag=null)}unloadTech_(){Mi.names.forEach(e=>{const t=Mi[e];this[t.privateName]=this[t.getterName]()}),this.textTracksJson_=Zg.textTracksToJson(this.tech_),this.isReady_=!1,this.tech_.dispose(),this.tech_=!1,this.isPosterFromTech_&&(this.poster_="",this.trigger("posterchange")),this.isPosterFromTech_=!1}tech(e){return e===void 0&&ze.warn(`Using the tech directly can be dangerous. I hope you know what you're doing.
See https://github.com/videojs/video.js/issues/2617 for more info.
`),this.tech_}version(){return{"video.js":Vg}}addTechControlsListeners_(){this.removeTechControlsListeners_(),this.on(this.tech_,"click",this.boundHandleTechClick_),this.on(this.tech_,"dblclick",this.boundHandleTechDoubleClick_),this.on(this.tech_,"touchstart",this.boundHandleTechTouchStart_),this.on(this.tech_,"touchmove",this.boundHandleTechTouchMove_),this.on(this.tech_,"touchend",this.boundHandleTechTouchEnd_),this.on(this.tech_,"tap",this.boundHandleTechTap_)}removeTechControlsListeners_(){this.off(this.tech_,"tap",this.boundHandleTechTap_),this.off(this.tech_,"touchstart",this.boundHandleTechTouchStart_),this.off(this.tech_,"touchmove",this.boundHandleTechTouchMove_),this.off(this.tech_,"touchend",this.boundHandleTechTouchEnd_),this.off(this.tech_,"click",this.boundHandleTechClick_),this.off(this.tech_,"dblclick",this.boundHandleTechDoubleClick_)}handleTechReady_(){this.triggerReady(),this.cache_.volume&&this.techCall_("setVolume",this.cache_.volume),this.handleTechPosterChange_(),this.handleTechDurationChange_()}handleTechLoadStart_(){this.removeClass("vjs-ended","vjs-seeking"),this.error(null),this.handleTechDurationChange_(),this.paused()?(this.hasStarted(!1),this.trigger("loadstart")):this.trigger("loadstart"),this.manualAutoplay_(this.autoplay()===!0&&this.options_.normalizeAutoplay?"play":this.autoplay())}manualAutoplay_(e){if(!this.tech_||typeof e!="string")return;const t=()=>{const s=this.muted();this.muted(!0);const r=()=>{this.muted(s)};this.playTerminatedQueue_.push(r);const o=this.play();if(bh(o))return o.catch(a=>{throw r(),new Error(`Rejection at manualAutoplay. Restoring muted value. ${a||""}`)})};let i;if(e==="any"&&!this.muted()?(i=this.play(),bh(i)&&(i=i.catch(t))):e==="muted"&&!this.muted()?i=t():i=this.play(),!!bh(i))return i.then(()=>{this.trigger({type:"autoplay-success",autoplay:e})}).catch(()=>{this.trigger({type:"autoplay-failure",autoplay:e})})}updateSourceCaches_(e=""){let t=e,i="";typeof t!="string"&&(t=e.src,i=e.type),this.cache_.source=this.cache_.source||{},this.cache_.sources=this.cache_.sources||[],t&&!i&&(i=JB(this,t)),this.cache_.source=at({},e,{src:t,type:i});const s=this.cache_.sources.filter(l=>l.src&&l.src===t),r=[],o=this.$$("source"),a=[];for(let l=0;l<o.length;l++){const h=Sr(o[l]);r.push(h),h.src&&h.src===t&&a.push(h.src)}a.length&&!s.length?this.cache_.sources=r:s.length||(this.cache_.sources=[this.cache_.source]),this.cache_.src=t}handleTechSourceset_(e){if(!this.changingSrc_){let t=r=>this.updateSourceCaches_(r);const i=this.currentSource().src,s=e.src;i&&!/^blob:/.test(i)&&/^blob:/.test(s)&&(!this.lastSource_||this.lastSource_.tech!==s&&this.lastSource_.player!==i)&&(t=()=>{}),t(s),e.src||this.tech_.any(["sourceset","loadstart"],r=>{if(r.type==="sourceset")return;const o=this.techGet_("currentSrc");this.lastSource_.tech=o,this.updateSourceCaches_(o)})}this.lastSource_={player:this.currentSource().src,tech:e.src},this.trigger({src:e.src,type:"sourceset"})}hasStarted(e){if(e===void 0)return this.hasStarted_;e!==this.hasStarted_&&(this.hasStarted_=e,this.hasStarted_?this.addClass("vjs-has-started"):this.removeClass("vjs-has-started"))}handleTechPlay_(){this.removeClass("vjs-ended","vjs-paused"),this.addClass("vjs-playing"),this.hasStarted(!0),this.trigger("play")}handleTechRateChange_(){this.tech_.playbackRate()>0&&this.cache_.lastPlaybackRate===0&&(this.queuedCallbacks_.forEach(e=>e.callback(e.event)),this.queuedCallbacks_=[]),this.cache_.lastPlaybackRate=this.tech_.playbackRate(),this.trigger("ratechange")}handleTechWaiting_(){this.addClass("vjs-waiting"),this.trigger("waiting");const e=this.currentTime(),t=()=>{e!==this.currentTime()&&(this.removeClass("vjs-waiting"),this.off("timeupdate",t))};this.on("timeupdate",t)}handleTechCanPlay_(){this.removeClass("vjs-waiting"),this.trigger("canplay")}handleTechCanPlayThrough_(){this.removeClass("vjs-waiting"),this.trigger("canplaythrough")}handleTechPlaying_(){this.removeClass("vjs-waiting"),this.trigger("playing")}handleTechSeeking_(){this.addClass("vjs-seeking"),this.trigger("seeking")}handleTechSeeked_(){this.removeClass("vjs-seeking","vjs-ended"),this.trigger("seeked")}handleTechPause_(){this.removeClass("vjs-playing"),this.addClass("vjs-paused"),this.trigger("pause")}handleTechEnded_(){this.addClass("vjs-ended"),this.removeClass("vjs-waiting"),this.options_.loop?(this.currentTime(0),this.play()):this.paused()||this.pause(),this.trigger("ended")}handleTechDurationChange_(){this.duration(this.techGet_("duration"))}handleTechClick_(e){this.controls_&&(this.options_===void 0||this.options_.userActions===void 0||this.options_.userActions.click===void 0||this.options_.userActions.click!==!1)&&(this.options_!==void 0&&this.options_.userActions!==void 0&&typeof this.options_.userActions.click=="function"?this.options_.userActions.click.call(this,e):this.paused()?ms(this.play()):this.pause())}handleTechDoubleClick_(e){if(!this.controls_)return;Array.prototype.some.call(this.$$(".vjs-control-bar, .vjs-modal-dialog"),i=>i.contains(e.target))||(this.options_===void 0||this.options_.userActions===void 0||this.options_.userActions.doubleClick===void 0||this.options_.userActions.doubleClick!==!1)&&(this.options_!==void 0&&this.options_.userActions!==void 0&&typeof this.options_.userActions.doubleClick=="function"?this.options_.userActions.doubleClick.call(this,e):this.isInPictureInPicture()&&!he.pictureInPictureElement?this.exitPictureInPicture():this.isFullscreen()?this.exitFullscreen():this.requestFullscreen())}handleTechTap_(){this.userActive(!this.userActive())}handleTechTouchStart_(){this.userWasActive=this.userActive()}handleTechTouchMove_(){this.userWasActive&&this.reportUserActivity()}handleTechTouchEnd_(e){e.cancelable&&e.preventDefault()}toggleFullscreenClass_(){this.isFullscreen()?this.addClass("vjs-fullscreen"):this.removeClass("vjs-fullscreen")}documentFullscreenChange_(e){const t=e.target.player;if(t&&t!==this)return;const i=this.el();let s=he[this.fsApi_.fullscreenElement]===i;!s&&i.matches&&(s=i.matches(":"+this.fsApi_.fullscreen)),this.isFullscreen(s)}handleTechFullscreenChange_(e,t){t&&(t.nativeIOSFullscreen&&(this.addClass("vjs-ios-native-fs"),this.tech_.one("webkitendfullscreen",()=>{this.removeClass("vjs-ios-native-fs")})),this.isFullscreen(t.isFullscreen))}handleTechFullscreenError_(e,t){this.trigger("fullscreenerror",t)}togglePictureInPictureClass_(){this.isInPictureInPicture()?this.addClass("vjs-picture-in-picture"):this.removeClass("vjs-picture-in-picture")}handleTechEnterPictureInPicture_(e){this.isInPictureInPicture(!0)}handleTechLeavePictureInPicture_(e){this.isInPictureInPicture(!1)}handleTechError_(){const e=this.tech_.error();e&&this.error(e)}handleTechTextData_(){let e=null;arguments.length>1&&(e=arguments[1]),this.trigger("textdata",e)}getCache(){return this.cache_}resetCache_(){this.cache_={currentTime:0,initTime:0,inactivityTimeout:this.options_.inactivityTimeout,duration:NaN,lastVolume:1,lastPlaybackRate:this.defaultPlaybackRate(),media:null,src:"",source:{},sources:[],playbackRates:[],volume:1}}techCall_(e,t){this.ready(function(){if(e in WB)return XB(this.middleware_,this.tech_,e,t);if(e in dS)return cS(this.middleware_,this.tech_,e,t);try{this.tech_&&this.tech_[e](t)}catch(i){throw ze(i),i}},!0)}techGet_(e){if(!(!this.tech_||!this.tech_.isReady_)){if(e in HB)return jB(this.middleware_,this.tech_,e);if(e in dS)return cS(this.middleware_,this.tech_,e);try{return this.tech_[e]()}catch(t){throw this.tech_[e]===void 0?(ze(`Video.js: ${e} method not defined for ${this.techName_} playback technology.`,t),t):t.name==="TypeError"?(ze(`Video.js: ${e} unavailable on ${this.techName_} playback technology element.`,t),this.tech_.isReady_=!1,t):(ze(t),t)}}}play(){return new Promise(e=>{this.play_(e)})}play_(e=ms){this.playCallbacks_.push(e);const t=!!(!this.changingSrc_&&(this.src()||this.currentSrc())),i=!!(Hf||yi);if(this.waitToPlay_&&(this.off(["ready","loadstart"],this.waitToPlay_),this.waitToPlay_=null),!this.isReady_||!t){this.waitToPlay_=o=>{this.play_()},this.one(["ready","loadstart"],this.waitToPlay_),!t&&i&&this.load();return}const s=this.techGet_("play");i&&this.hasClass("vjs-ended")&&this.resetProgressBar_(),s===null?this.runPlayTerminatedQueue_():this.runPlayCallbacks_(s)}runPlayTerminatedQueue_(){const e=this.playTerminatedQueue_.slice(0);this.playTerminatedQueue_=[],e.forEach(function(t){t()})}runPlayCallbacks_(e){const t=this.playCallbacks_.slice(0);this.playCallbacks_=[],this.playTerminatedQueue_=[],t.forEach(function(i){i(e)})}pause(){this.techCall_("pause")}paused(){return this.techGet_("paused")!==!1}played(){return this.techGet_("played")||jn(0,0)}scrubbing(e){if(typeof e>"u")return this.scrubbing_;this.scrubbing_=!!e,this.techCall_("setScrubbing",this.scrubbing_),e?this.addClass("vjs-scrubbing"):this.removeClass("vjs-scrubbing")}currentTime(e){if(e===void 0)return this.cache_.currentTime=this.techGet_("currentTime")||0,this.cache_.currentTime;if(e<0&&(e=0),!this.isReady_||this.changingSrc_||!this.tech_||!this.tech_.isReady_){this.cache_.initTime=e,this.off("canplay",this.boundApplyInitTime_),this.one("canplay",this.boundApplyInitTime_);return}this.techCall_("setCurrentTime",e),this.cache_.initTime=0,isFinite(e)&&(this.cache_.currentTime=Number(e))}applyInitTime_(){this.currentTime(this.cache_.initTime)}duration(e){if(e===void 0)return this.cache_.duration!==void 0?this.cache_.duration:NaN;e=parseFloat(e),e<0&&(e=1/0),e!==this.cache_.duration&&(this.cache_.duration=e,e===1/0?this.addClass("vjs-live"):this.removeClass("vjs-live"),isNaN(e)||this.trigger("durationchange"))}remainingTime(){return this.duration()-this.currentTime()}remainingTimeDisplay(){return Math.floor(this.duration())-Math.floor(this.currentTime())}buffered(){let e=this.techGet_("buffered");return(!e||!e.length)&&(e=jn(0,0)),e}seekable(){let e=this.techGet_("seekable");return(!e||!e.length)&&(e=jn(0,0)),e}seeking(){return this.techGet_("seeking")}ended(){return this.techGet_("ended")}networkState(){return this.techGet_("networkState")}readyState(){return this.techGet_("readyState")}bufferedPercent(){return yk(this.buffered(),this.duration())}bufferedEnd(){const e=this.buffered(),t=this.duration();let i=e.end(e.length-1);return i>t&&(i=t),i}volume(e){let t;if(e!==void 0){t=Math.max(0,Math.min(1,e)),this.cache_.volume=t,this.techCall_("setVolume",t),t>0&&this.lastVolume_(t);return}return t=parseFloat(this.techGet_("volume")),isNaN(t)?1:t}muted(e){if(e!==void 0){this.techCall_("setMuted",e);return}return this.techGet_("muted")||!1}defaultMuted(e){return e!==void 0&&this.techCall_("setDefaultMuted",e),this.techGet_("defaultMuted")||!1}lastVolume_(e){if(e!==void 0&&e!==0){this.cache_.lastVolume=e;return}return this.cache_.lastVolume}supportsFullScreen(){return this.techGet_("supportsFullScreen")||!1}isFullscreen(e){if(e!==void 0){const t=this.isFullscreen_;this.isFullscreen_=!!e,this.isFullscreen_!==t&&this.fsApi_.prefixed&&this.trigger("fullscreenchange"),this.toggleFullscreenClass_();return}return this.isFullscreen_}requestFullscreen(e){this.isInPictureInPicture()&&this.exitPictureInPicture();const t=this;return new Promise((i,s)=>{function r(){t.off("fullscreenerror",a),t.off("fullscreenchange",o)}function o(){r(),i()}function a(h,u){r(),s(u)}t.one("fullscreenchange",o),t.one("fullscreenerror",a);const l=t.requestFullscreenHelper_(e);l&&(l.then(r,r),l.then(i,s))})}requestFullscreenHelper_(e){let t;if(this.fsApi_.prefixed||(t=this.options_.fullscreen&&this.options_.fullscreen.options||{},e!==void 0&&(t=e)),this.fsApi_.requestFullscreen){const i=this.el_[this.fsApi_.requestFullscreen](t);return i&&i.then(()=>this.isFullscreen(!0),()=>this.isFullscreen(!1)),i}else this.tech_.supportsFullScreen()&&!this.options_.preferFullWindow?this.techCall_("enterFullScreen"):this.enterFullWindow()}exitFullscreen(){const e=this;return new Promise((t,i)=>{function s(){e.off("fullscreenerror",o),e.off("fullscreenchange",r)}function r(){s(),t()}function o(l,h){s(),i(h)}e.one("fullscreenchange",r),e.one("fullscreenerror",o);const a=e.exitFullscreenHelper_();a&&(a.then(s,s),a.then(t,i))})}exitFullscreenHelper_(){if(this.fsApi_.requestFullscreen){const e=he[this.fsApi_.exitFullscreen]();return e&&ms(e.then(()=>this.isFullscreen(!1))),e}else this.tech_.supportsFullScreen()&&!this.options_.preferFullWindow?this.techCall_("exitFullScreen"):this.exitFullWindow()}enterFullWindow(){this.isFullscreen(!0),this.isFullWindow=!0,this.docOrigOverflow=he.documentElement.style.overflow,cn(he,"keydown",this.boundFullWindowOnEscKey_),he.documentElement.style.overflow="hidden",_o(he.body,"vjs-full-window"),this.trigger("enterFullWindow")}fullWindowOnEscKey(e){e.key==="Escape"&&this.isFullscreen()===!0&&(this.isFullWindow?this.exitFullWindow():this.exitFullscreen())}exitFullWindow(){this.isFullscreen(!1),this.isFullWindow=!1,bi(he,"keydown",this.boundFullWindowOnEscKey_),he.documentElement.style.overflow=this.docOrigOverflow,Wf(he.body,"vjs-full-window"),this.trigger("exitFullWindow")}disablePictureInPicture(e){if(e===void 0)return this.techGet_("disablePictureInPicture");this.techCall_("setDisablePictureInPicture",e),this.options_.disablePictureInPicture=e,this.trigger("disablepictureinpicturechanged")}isInPictureInPicture(e){if(e!==void 0){this.isInPictureInPicture_=!!e,this.togglePictureInPictureClass_();return}return!!this.isInPictureInPicture_}requestPictureInPicture(){if(this.options_.enableDocumentPictureInPicture&&V.documentPictureInPicture){const e=he.createElement(this.el().tagName);return e.classList=this.el().classList,e.classList.add("vjs-pip-container"),this.posterImage&&e.appendChild(this.posterImage.el().cloneNode(!0)),this.titleBar&&e.appendChild(this.titleBar.el().cloneNode(!0)),e.appendChild(Le("p",{className:"vjs-pip-text"},{},this.localize("Playing in picture-in-picture"))),V.documentPictureInPicture.requestWindow({width:this.videoWidth(),height:this.videoHeight()}).then(t=>(rk(t),this.el_.parentNode.insertBefore(e,this.el_),t.document.body.appendChild(this.el_),t.document.body.classList.add("vjs-pip-window"),this.player_.isInPictureInPicture(!0),this.player_.trigger({type:"enterpictureinpicture",pipWindow:t}),t.addEventListener("pagehide",i=>{const s=i.target.querySelector(".video-js");e.parentNode.replaceChild(s,e),this.player_.isInPictureInPicture(!1),this.player_.trigger("leavepictureinpicture")}),t))}return"pictureInPictureEnabled"in he&&this.disablePictureInPicture()===!1?this.techGet_("requestPictureInPicture"):Promise.reject("No PiP mode is available")}exitPictureInPicture(){if(V.documentPictureInPicture&&V.documentPictureInPicture.window)return V.documentPictureInPicture.window.close(),Promise.resolve();if("pictureInPictureEnabled"in he)return he.exitPictureInPicture()}handleKeyDown(e){const{userActions:t}=this.options_;!t||!t.hotkeys||(s=>{const r=s.tagName.toLowerCase();if(s.isContentEditable)return!0;const o=["button","checkbox","hidden","radio","reset","submit"];return r==="input"?o.indexOf(s.type)===-1:["textarea"].indexOf(r)!==-1})(this.el_.ownerDocument.activeElement)||(typeof t.hotkeys=="function"?t.hotkeys.call(this,e):this.handleHotkeys(e))}handleHotkeys(e){const t=this.options_.userActions?this.options_.userActions.hotkeys:{},{fullscreenKey:i=o=>e.key.toLowerCase()==="f",muteKey:s=o=>e.key.toLowerCase()==="m",playPauseKey:r=o=>e.key.toLowerCase()==="k"||e.key.toLowerCase()===" "}=t;if(i.call(this,e)){e.preventDefault(),e.stopPropagation();const o=ie.getComponent("FullscreenToggle");he[this.fsApi_.fullscreenEnabled]!==!1&&o.prototype.handleClick.call(this,e)}else s.call(this,e)?(e.preventDefault(),e.stopPropagation(),ie.getComponent("MuteToggle").prototype.handleClick.call(this,e)):r.call(this,e)&&(e.preventDefault(),e.stopPropagation(),ie.getComponent("PlayToggle").prototype.handleClick.call(this,e))}canPlayType(e){let t;for(let i=0,s=this.options_.techOrder;i<s.length;i++){const r=s[i];let o=Be.getTech(r);if(o||(o=ie.getComponent(r)),!o){ze.error(`The "${r}" tech is undefined. Skipped browser support check for that tech.`);continue}if(o.isSupported()&&(t=o.canPlayType(e),t))return t}return""}selectSource(e){const t=this.options_.techOrder.map(a=>[a,Be.getTech(a)]).filter(([a,l])=>l?l.isSupported():(ze.error(`The "${a}" tech is undefined. Skipped browser support check for that tech.`),!1)),i=function(a,l,h){let u;return a.some(c=>l.some(f=>{if(u=h(c,f),u)return!0})),u};let s;const r=a=>(l,h)=>a(h,l),o=([a,l],h)=>{if(l.canPlaySource(h,this.options_[a.toLowerCase()]))return{source:h,tech:a}};return this.options_.sourceOrder?s=i(e,t,r(o)):s=i(t,e,o),s||!1}handleSrc_(e,t){if(typeof e>"u")return this.cache_.src||"";this.resetRetryOnError_&&this.resetRetryOnError_();const i=wk(e);if(!i.length){this.setTimeout(function(){this.error({code:4,message:this.options_.notSupportedMessage})},0);return}if(this.changingSrc_=!0,t||(this.cache_.sources=i),this.updateSourceCaches_(i[0]),qB(this,i[0],(s,r)=>{if(this.middleware_=r,t||(this.cache_.sources=i),this.updateSourceCaches_(s),this.src_(s)){if(i.length>1)return this.handleSrc_(i.slice(1));this.changingSrc_=!1,this.setTimeout(function(){this.error({code:4,message:this.options_.notSupportedMessage})},0),this.triggerReady();return}zB(r,this.tech_)}),i.length>1){const s=()=>{this.error(null),this.handleSrc_(i.slice(1),!0)},r=()=>{this.off("error",s)};this.one("error",s),this.one("playing",r),this.resetRetryOnError_=()=>{this.off("error",s),this.off("playing",r)}}}src(e){return this.handleSrc_(e,!1)}src_(e){const t=this.selectSource([e]);return t?pk(t.tech,this.techName_)?(this.ready(function(){this.tech_.constructor.prototype.hasOwnProperty("setSource")?this.techCall_("setSource",e):this.techCall_("src",e.src),this.changingSrc_=!1},!0),!1):(this.changingSrc_=!0,this.loadTech_(t.tech,t.source),this.tech_.ready(()=>{this.changingSrc_=!1}),!1):!0}addSourceElement(e,t){return this.tech_?this.tech_.addSourceElement(e,t):!1}removeSourceElement(e){return this.tech_?this.tech_.removeSourceElement(e):!1}load(){if(this.tech_&&this.tech_.vhs){this.src(this.currentSource());return}this.techCall_("load")}reset(){if(this.paused())this.doReset_();else{const e=this.play();ms(e.then(()=>this.doReset_()))}}doReset_(){this.tech_&&this.tech_.clearTracks("text"),this.removeClass("vjs-playing"),this.addClass("vjs-paused"),this.resetCache_(),this.poster(""),this.loadTech_(this.options_.techOrder[0],null),this.techCall_("reset"),this.resetControlBarUI_(),this.error(null),this.titleBar&&this.titleBar.update({title:void 0,description:void 0}),tr(this)&&this.trigger("playerreset")}resetControlBarUI_(){this.resetProgressBar_(),this.resetPlaybackRate_(),this.resetVolumeBar_()}resetProgressBar_(){this.currentTime(0);const{currentTimeDisplay:e,durationDisplay:t,progressControl:i,remainingTimeDisplay:s}=this.controlBar||{},{seekBar:r}=i||{};e&&e.updateContent(),t&&t.updateContent(),s&&s.updateContent(),r&&(r.update(),r.loadProgressBar&&r.loadProgressBar.update())}resetPlaybackRate_(){this.playbackRate(this.defaultPlaybackRate()),this.handleTechRateChange_()}resetVolumeBar_(){this.volume(1),this.trigger("volumechange")}currentSources(){const e=this.currentSource(),t=[];return Object.keys(e).length!==0&&t.push(e),this.cache_.sources||t}currentSource(){return this.cache_.source||{}}currentSrc(){return this.currentSource()&&this.currentSource().src||""}currentType(){return this.currentSource()&&this.currentSource().type||""}preload(e){if(e!==void 0){this.techCall_("setPreload",e),this.options_.preload=e;return}return this.techGet_("preload")}autoplay(e){if(e===void 0)return this.options_.autoplay||!1;let t;typeof e=="string"&&/(any|play|muted)/.test(e)||e===!0&&this.options_.normalizeAutoplay?(this.options_.autoplay=e,this.manualAutoplay_(typeof e=="string"?e:"play"),t=!1):e?this.options_.autoplay=!0:this.options_.autoplay=!1,t=typeof t>"u"?this.options_.autoplay:t,this.tech_&&this.techCall_("setAutoplay",t)}playsinline(e){return e!==void 0&&(this.techCall_("setPlaysinline",e),this.options_.playsinline=e),this.techGet_("playsinline")}loop(e){if(e!==void 0){this.techCall_("setLoop",e),this.options_.loop=e;return}return this.techGet_("loop")}poster(e){if(e===void 0)return this.poster_;e||(e=""),e!==this.poster_&&(this.poster_=e,this.techCall_("setPoster",e),this.isPosterFromTech_=!1,this.trigger("posterchange"))}handleTechPosterChange_(){if((!this.poster_||this.options_.techCanOverridePoster)&&this.tech_&&this.tech_.poster){const e=this.tech_.poster()||"";e!==this.poster_&&(this.poster_=e,this.isPosterFromTech_=!0,this.trigger("posterchange"))}}controls(e){if(e===void 0)return!!this.controls_;e=!!e,this.controls_!==e&&(this.controls_=e,this.usingNativeControls()&&this.techCall_("setControls",e),this.controls_?(this.removeClass("vjs-controls-disabled"),this.addClass("vjs-controls-enabled"),this.trigger("controlsenabled"),this.usingNativeControls()||this.addTechControlsListeners_()):(this.removeClass("vjs-controls-enabled"),this.addClass("vjs-controls-disabled"),this.trigger("controlsdisabled"),this.usingNativeControls()||this.removeTechControlsListeners_()))}usingNativeControls(e){if(e===void 0)return!!this.usingNativeControls_;e=!!e,this.usingNativeControls_!==e&&(this.usingNativeControls_=e,this.usingNativeControls_?(this.addClass("vjs-using-native-controls"),this.trigger("usingnativecontrols")):(this.removeClass("vjs-using-native-controls"),this.trigger("usingcustomcontrols")))}error(e){if(e===void 0)return this.error_||null;if(Vr("beforeerror").forEach(t=>{const i=t(this,e);if(!(Es(i)&&!Array.isArray(i)||typeof i=="string"||typeof i=="number"||i===null)){this.log.error("please return a value that MediaError expects in beforeerror hooks");return}e=i}),this.options_.suppressNotSupportedError&&e&&e.code===4){const t=function(){this.error(e)};this.options_.suppressNotSupportedError=!1,this.any(["click","touchstart"],t),this.one("loadstart",function(){this.off(["click","touchstart"],t)});return}if(e===null){this.error_=null,this.removeClass("vjs-error"),this.errorDisplay&&this.errorDisplay.close();return}this.error_=new Pt(e),this.addClass("vjs-error"),ze.error(`(CODE:${this.error_.code} ${Pt.errorTypes[this.error_.code]})`,this.error_.message,this.error_),this.trigger("error"),Vr("error").forEach(t=>t(this,this.error_))}reportUserActivity(e){this.userActivity_=!0}userActive(e){if(e===void 0)return this.userActive_;if(e=!!e,e!==this.userActive_){if(this.userActive_=e,this.userActive_){this.userActivity_=!0,this.removeClass("vjs-user-inactive"),this.addClass("vjs-user-active"),this.trigger("useractive");return}this.tech_&&this.tech_.one("mousemove",function(t){t.stopPropagation(),t.preventDefault()}),this.userActivity_=!1,this.removeClass("vjs-user-active"),this.addClass("vjs-user-inactive"),this.trigger("userinactive")}}listenForUserActivity_(){let e,t,i;const s=pt(this,this.reportUserActivity),r=function(c){(c.screenX!==t||c.screenY!==i)&&(t=c.screenX,i=c.screenY,s())},o=function(){s(),this.clearInterval(e),e=this.setInterval(s,250)},a=function(c){s(),this.clearInterval(e)};this.on("mousedown",o),this.on("mousemove",r),this.on("mouseup",a),this.on("mouseleave",a);const l=this.getChild("controlBar");l&&!yi&&!Wn&&(l.on("mouseenter",function(c){this.player().options_.inactivityTimeout!==0&&(this.player().cache_.inactivityTimeout=this.player().options_.inactivityTimeout),this.player().options_.inactivityTimeout=0}),l.on("mouseleave",function(c){this.player().options_.inactivityTimeout=this.player().cache_.inactivityTimeout})),this.on("keydown",s),this.on("keyup",s);let h;const u=function(){if(!this.userActivity_)return;this.userActivity_=!1,this.userActive(!0),this.clearTimeout(h);const c=this.options_.inactivityTimeout;c<=0||(h=this.setTimeout(function(){this.userActivity_||this.userActive(!1)},c))};this.setInterval(u,250)}playbackRate(e){if(e!==void 0){this.techCall_("setPlaybackRate",e);return}return this.tech_&&this.tech_.featuresPlaybackRate?this.cache_.lastPlaybackRate||this.techGet_("playbackRate"):1}defaultPlaybackRate(e){return e!==void 0?this.techCall_("setDefaultPlaybackRate",e):this.tech_&&this.tech_.featuresPlaybackRate?this.techGet_("defaultPlaybackRate"):1}isAudio(e){if(e!==void 0){this.isAudio_=!!e;return}return!!this.isAudio_}updatePlayerHeightOnAudioOnlyMode_(){const e=this.getChild("ControlBar");!e||this.audioOnlyCache_.controlBarHeight===e.currentHeight()||(this.audioOnlyCache_.controlBarHeight=e.currentHeight(),this.height(this.audioOnlyCache_.controlBarHeight))}enableAudioOnlyUI_(){this.addClass("vjs-audio-only-mode");const e=this.children(),t=this.getChild("ControlBar"),i=t&&t.currentHeight();e.forEach(s=>{s!==t&&s.el_&&!s.hasClass("vjs-hidden")&&(s.hide(),this.audioOnlyCache_.hiddenChildren.push(s))}),this.audioOnlyCache_.playerHeight=this.currentHeight(),this.audioOnlyCache_.controlBarHeight=i,this.on("playerresize",this.boundUpdatePlayerHeightOnAudioOnlyMode_),this.height(i),this.trigger("audioonlymodechange")}disableAudioOnlyUI_(){this.removeClass("vjs-audio-only-mode"),this.off("playerresize",this.boundUpdatePlayerHeightOnAudioOnlyMode_),this.audioOnlyCache_.hiddenChildren.forEach(e=>e.show()),this.height(this.audioOnlyCache_.playerHeight),this.trigger("audioonlymodechange")}audioOnlyMode(e){if(typeof e!="boolean"||e===this.audioOnlyMode_)return this.audioOnlyMode_;if(this.audioOnlyMode_=e,e){const t=[];return this.isInPictureInPicture()&&t.push(this.exitPictureInPicture()),this.isFullscreen()&&t.push(this.exitFullscreen()),this.audioPosterMode()&&t.push(this.audioPosterMode(!1)),Promise.all(t).then(()=>this.enableAudioOnlyUI_())}return Promise.resolve().then(()=>this.disableAudioOnlyUI_())}enablePosterModeUI_(){(this.tech_&&this.tech_).hide(),this.addClass("vjs-audio-poster-mode"),this.trigger("audiopostermodechange")}disablePosterModeUI_(){(this.tech_&&this.tech_).show(),this.removeClass("vjs-audio-poster-mode"),this.trigger("audiopostermodechange")}audioPosterMode(e){return typeof e!="boolean"||e===this.audioPosterMode_?this.audioPosterMode_:(this.audioPosterMode_=e,e?this.audioOnlyMode()?this.audioOnlyMode(!1).then(()=>{this.enablePosterModeUI_()}):Promise.resolve().then(()=>{this.enablePosterModeUI_()}):Promise.resolve().then(()=>{this.disablePosterModeUI_()}))}addTextTrack(e,t,i){if(this.tech_)return this.tech_.addTextTrack(e,t,i)}addRemoteTextTrack(e,t){if(this.tech_)return this.tech_.addRemoteTextTrack(e,t)}removeRemoteTextTrack(e={}){let{track:t}=e;if(t||(t=e),this.tech_)return this.tech_.removeRemoteTextTrack(t)}getVideoPlaybackQuality(){return this.techGet_("getVideoPlaybackQuality")}videoWidth(){return this.tech_&&this.tech_.videoWidth&&this.tech_.videoWidth()||0}videoHeight(){return this.tech_&&this.tech_.videoHeight&&this.tech_.videoHeight()||0}language(e){if(e===void 0)return this.language_;this.language_!==String(e).toLowerCase()&&(this.language_=String(e).toLowerCase(),tr(this)&&this.trigger("languagechange"))}languages(){return at(Je.prototype.options_.languages,this.languages_)}toJSON(){const e=at(this.options_),t=e.tracks;e.tracks=[];for(let i=0;i<t.length;i++){let s=t[i];s=at(s),s.player=void 0,e.tracks[i]=s}return e}createModal(e,t){t=t||{},t.content=e||"";const i=new cl(this,t);return this.addChild(i),i.on("dispose",()=>{this.removeChild(i)}),i.open(),i}updateCurrentBreakpoint_(){if(!this.responsive())return;const e=this.currentBreakpoint(),t=this.currentWidth();for(let i=0;i<Kg.length;i++){const s=Kg[i],r=this.breakpoints_[s];if(t<=r){if(e===s)return;e&&this.removeClass(Gc[e]),this.addClass(Gc[s]),this.breakpoint_=s;break}}}removeCurrentBreakpoint_(){const e=this.currentBreakpointClass();this.breakpoint_="",e&&this.removeClass(e)}breakpoints(e){return e===void 0?Object.assign(this.breakpoints_):(this.breakpoint_="",this.breakpoints_=Object.assign({},DN,e),this.updateCurrentBreakpoint_(),Object.assign(this.breakpoints_))}responsive(e){if(e===void 0)return this.responsive_;e=!!e;const t=this.responsive_;if(e!==t)return this.responsive_=e,e?(this.on("playerresize",this.boundUpdateCurrentBreakpoint_),this.updateCurrentBreakpoint_()):(this.off("playerresize",this.boundUpdateCurrentBreakpoint_),this.removeCurrentBreakpoint_()),e}currentBreakpoint(){return this.breakpoint_}currentBreakpointClass(){return Gc[this.breakpoint_]||""}loadMedia(e,t){if(!e||typeof e!="object")return;const i=this.crossOrigin();this.reset(),this.cache_.media=at(e);const{artist:s,artwork:r,description:o,poster:a,src:l,textTracks:h,title:u}=this.cache_.media;!r&&a&&(this.cache_.media.artwork=[{src:a,type:Nd(a)}]),i&&this.crossOrigin(i),l&&this.src(l),a&&this.poster(a),Array.isArray(h)&&h.forEach(c=>this.addRemoteTextTrack(c,!1)),this.titleBar&&this.titleBar.update({title:u,description:o||s||""}),this.ready(t)}getMedia(){if(!this.cache_.media){const e=this.poster(),t=this.currentSources(),i=Array.prototype.map.call(this.remoteTextTracks(),r=>({kind:r.kind,label:r.label,language:r.language,src:r.src})),s={src:t,textTracks:i};return e&&(s.poster=e,s.artwork=[{src:s.poster,type:Nd(s.poster)}]),s}return at(this.cache_.media)}static getTagSettings(e){const t={sources:[],tracks:[]},i=Sr(e),s=i["data-setup"];if(Oh(e,"vjs-fill")&&(i.fill=!0),Oh(e,"vjs-fluid")&&(i.fluid=!0),s!==null)try{Object.assign(i,JSON.parse(s||"{}"))}catch(r){ze.error("data-setup",r)}if(Object.assign(t,i),e.hasChildNodes()){const r=e.childNodes;for(let o=0,a=r.length;o<a;o++){const l=r[o],h=l.nodeName.toLowerCase();h==="source"?t.sources.push(Sr(l)):h==="track"&&t.tracks.push(Sr(l))}}return t}debug(e){if(e===void 0)return this.debugEnabled_;e?(this.trigger("debugon"),this.previousLogLevel_=this.log.level,this.log.level("debug"),this.debugEnabled_=!0):(this.trigger("debugoff"),this.log.level(this.previousLogLevel_),this.previousLogLevel_=void 0,this.debugEnabled_=!1)}playbackRates(e){if(e===void 0)return this.cache_.playbackRates;Array.isArray(e)&&e.every(t=>typeof t=="number")&&(this.cache_.playbackRates=e,this.trigger("playbackrateschange"))}}Je.prototype.videoTracks=()=>{};Je.prototype.audioTracks=()=>{};Je.prototype.textTracks=()=>{};Je.prototype.remoteTextTracks=()=>{};Je.prototype.remoteTextTrackEls=()=>{};Mi.names.forEach(function(n){const e=Mi[n];Je.prototype[e.getterName]=function(){return this.tech_?this.tech_[e.getterName]():(this[e.privateName]=this[e.privateName]||new e.ListClass,this[e.privateName])}});Je.prototype.crossorigin=Je.prototype.crossOrigin;Je.players={};const Bl=V.navigator;Je.prototype.options_={techOrder:Be.defaultTechOrder_,html5:{},enableSourceset:!0,inactivityTimeout:2e3,playbackRates:[],liveui:!1,children:["mediaLoader","posterImage","titleBar","textTrackDisplay","loadingSpinner","bigPlayButton","liveTracker","controlBar","errorDisplay","textTrackSettings","resizeManager"],language:Bl&&(Bl.languages&&Bl.languages[0]||Bl.userLanguage||Bl.language)||"en",languages:{},notSupportedMessage:"No compatible source was found for this media.",normalizeAutoplay:!1,fullscreen:{options:{navigationUI:"hide"}},breakpoints:{},responsive:!1,audioOnlyMode:!1,audioPosterMode:!1,spatialNavigation:{enabled:!1,horizontalSeek:!1},enableSmoothSeeking:!1,disableSeekWhileScrubbingOnMobile:!1,disableSeekWhileScrubbingOnSTV:!1};eC.forEach(function(n){Je.prototype[`handleTech${Dt(n)}_`]=function(){return this.trigger(n)}});ie.registerComponent("Player",Je);const Fd="plugin",ya="activePlugins_",aa={},Vd=n=>aa.hasOwnProperty(n),Kc=n=>Vd(n)?aa[n]:void 0,tC=(n,e)=>{n[ya]=n[ya]||{},n[ya][e]=!0},Ud=(n,e,t)=>{const i=(t?"before":"")+"pluginsetup";n.trigger(i,e),n.trigger(i+":"+e.name,e)},MN=function(n,e){const t=function(){Ud(this,{name:n,plugin:e,instance:null},!0);const i=e.apply(this,arguments);return tC(this,n),Ud(this,{name:n,plugin:e,instance:i}),i};return Object.keys(e).forEach(function(i){t[i]=e[i]}),t},ES=(n,e)=>(e.prototype.name=n,function(...t){Ud(this,{name:n,plugin:e,instance:null},!0);const i=new e(this,...t);return this[n]=()=>i,Ud(this,i.getEventHash()),i});class Hi{constructor(e){if(this.constructor===Hi)throw new Error("Plugin must be sub-classed; not directly instantiated.");this.player=e,this.log||(this.log=this.player.log.createLogger(this.name)),Qy(this),delete this.trigger,fk(this,this.constructor.defaultState),tC(e,this.name),this.dispose=this.dispose.bind(this),e.on("dispose",this.dispose)}version(){return this.constructor.VERSION}getEventHash(e={}){return e.name=this.name,e.plugin=this.constructor,e.instance=this,e}trigger(e,t={}){return ul(this.eventBusEl_,e,this.getEventHash(t))}handleStateChanged(e){}dispose(){const{name:e,player:t}=this;this.trigger("dispose"),this.off(),t.off("dispose",this.dispose),t[ya][e]=!1,this.player=this.state=null,t[e]=ES(e,aa[e])}static isBasic(e){const t=typeof e=="string"?Kc(e):e;return typeof t=="function"&&!Hi.prototype.isPrototypeOf(t.prototype)}static registerPlugin(e,t){if(typeof e!="string")throw new Error(`Illegal plugin name, "${e}", must be a string, was ${typeof e}.`);if(Vd(e))ze.warn(`A plugin named "${e}" already exists. You may want to avoid re-registering plugins!`);else if(Je.prototype.hasOwnProperty(e))throw new Error(`Illegal plugin name, "${e}", cannot share a name with an existing player method!`);if(typeof t!="function")throw new Error(`Illegal plugin for "${e}", must be a function, was ${typeof t}.`);return aa[e]=t,e!==Fd&&(Hi.isBasic(t)?Je.prototype[e]=MN(e,t):Je.prototype[e]=ES(e,t)),t}static deregisterPlugin(e){if(e===Fd)throw new Error("Cannot de-register base plugin.");Vd(e)&&(delete aa[e],delete Je.prototype[e])}static getPlugins(e=Object.keys(aa)){let t;return e.forEach(i=>{const s=Kc(i);s&&(t=t||{},t[i]=s)}),t}static getPluginVersion(e){const t=Kc(e);return t&&t.VERSION||""}}Hi.getPlugin=Kc;Hi.BASE_PLUGIN_NAME=Fd;Hi.registerPlugin(Fd,Hi);Je.prototype.usingPlugin=function(n){return!!this[ya]&&this[ya][n]===!0};Je.prototype.hasPlugin=function(n){return!!Vd(n)};function IN(n,e){let t=!1;return function(...i){return t||ze.warn(n),t=!0,e.apply(this,i)}}function Yn(n,e,t,i){return IN(`${e} is deprecated and will be removed in ${n}.0; please use ${t} instead.`,i)}var RN={NetworkBadStatus:"networkbadstatus",NetworkRequestFailed:"networkrequestfailed",NetworkRequestAborted:"networkrequestaborted",NetworkRequestTimeout:"networkrequesttimeout",NetworkBodyParserFailed:"networkbodyparserfailed",StreamingHlsPlaylistParserError:"streaminghlsplaylistparsererror",StreamingDashManifestParserError:"streamingdashmanifestparsererror",StreamingContentSteeringParserError:"streamingcontentsteeringparsererror",StreamingVttParserError:"streamingvttparsererror",StreamingFailedToSelectNextSegment:"streamingfailedtoselectnextsegment",StreamingFailedToDecryptSegment:"streamingfailedtodecryptsegment",StreamingFailedToTransmuxSegment:"streamingfailedtotransmuxsegment",StreamingFailedToAppendSegment:"streamingfailedtoappendsegment",StreamingCodecsChangeError:"streamingcodecschangeerror"};const iC=n=>n.indexOf("#")===0?n.slice(1):n;function Y(n,e,t){let i=Y.getPlayer(n);if(i)return e&&ze.warn(`Player "${n}" is already initialised. Options will not be applied.`),t&&i.ready(t),i;const s=typeof n=="string"?Ur("#"+iC(n)):n;if(!hl(s))throw new TypeError("The element or ID supplied is not valid. (videojs)");const o=("getRootNode"in s?s.getRootNode()instanceof V.ShadowRoot:!1)?s.getRootNode():s.ownerDocument.body;(!s.ownerDocument.defaultView||!o.contains(s))&&ze.warn("The element supplied is not included in the DOM"),e=e||{},e.restoreEl===!0&&(e.restoreEl=(s.parentNode&&s.parentNode.hasAttribute&&s.parentNode.hasAttribute("data-vjs-player")?s.parentNode:s).cloneNode(!0)),Vr("beforesetup").forEach(l=>{const h=l(s,at(e));if(!Es(h)||Array.isArray(h)){ze.error("please return an object in beforesetup hooks");return}e=at(e,h)});const a=ie.getComponent("Player");return i=new a(s,e,t),Vr("setup").forEach(l=>l(i)),i}Y.hooks_=Gs;Y.hooks=Vr;Y.hook=pB;Y.hookOnce=mB;Y.removeHook=B2;if(V.VIDEOJS_NO_DYNAMIC_STYLE!==!0&&ll()){let n=Ur(".vjs-styles-defaults");if(!n){n=lk("vjs-styles-defaults");const e=Ur("head");e&&e.insertBefore(n,e.firstChild),hk(n,`
      .video-js {
        width: 300px;
        height: 150px;
      }

      .vjs-fluid:not(.vjs-audio-only-mode) {
        padding-top: 56.25%
      }
    `)}}jg(1,Y);Y.VERSION=Vg;Y.options=Je.prototype.options_;Y.getPlayers=()=>Je.players;Y.getPlayer=n=>{const e=Je.players;let t;if(typeof n=="string"){const i=iC(n),s=e[i];if(s)return s;t=Ur("#"+i)}else t=n;if(hl(t)){const{player:i,playerId:s}=t;if(i||e[s])return i||e[s]}};Y.getAllPlayers=()=>Object.keys(Je.players).map(n=>Je.players[n]).filter(Boolean);Y.players=Je.players;Y.getComponent=ie.getComponent;Y.registerComponent=(n,e)=>(Be.isTech(e)&&ze.warn(`The ${n} tech was registered as a component. It should instead be registered using videojs.registerTech(name, tech)`),ie.registerComponent.call(ie,n,e));Y.getTech=Be.getTech;Y.registerTech=Be.registerTech;Y.use=UB;Object.defineProperty(Y,"middleware",{value:{},writeable:!1,enumerable:!0});Object.defineProperty(Y.middleware,"TERMINATOR",{value:Bd,writeable:!1,enumerable:!0});Y.browser=H2;Y.obj=yB;Y.mergeOptions=Yn(9,"videojs.mergeOptions","videojs.obj.merge",at);Y.defineLazyProperty=Yn(9,"videojs.defineLazyProperty","videojs.obj.defineLazyProperty",qf);Y.bind=Yn(9,"videojs.bind","native Function.prototype.bind",pt);Y.registerPlugin=Hi.registerPlugin;Y.deregisterPlugin=Hi.deregisterPlugin;Y.plugin=(n,e)=>(ze.warn("videojs.plugin() is deprecated; use videojs.registerPlugin() instead"),Hi.registerPlugin(n,e));Y.getPlugins=Hi.getPlugins;Y.getPlugin=Hi.getPlugin;Y.getPluginVersion=Hi.getPluginVersion;Y.addLanguage=function(n,e){return n=(""+n).toLowerCase(),Y.options.languages=at(Y.options.languages,{[n]:e}),Y.options.languages[n]};Y.log=ze;Y.createLogger=N2;Y.time=IB;Y.createTimeRange=Yn(9,"videojs.createTimeRange","videojs.time.createTimeRanges",jn);Y.createTimeRanges=Yn(9,"videojs.createTimeRanges","videojs.time.createTimeRanges",jn);Y.formatTime=Yn(9,"videojs.formatTime","videojs.time.formatTime",Po);Y.setFormatTime=Yn(9,"videojs.setFormatTime","videojs.time.setFormatTime",gk);Y.resetFormatTime=Yn(9,"videojs.resetFormatTime","videojs.time.resetFormatTime",Ok);Y.parseUrl=Yn(9,"videojs.parseUrl","videojs.url.parseUrl",Vy);Y.isCrossOrigin=Yn(9,"videojs.isCrossOrigin","videojs.url.isCrossOrigin",tp);Y.EventTarget=dn;Y.any=$y;Y.on=cn;Y.one=Jf;Y.off=bi;Y.trigger=ul;Y.xhr=T2;Y.TrackList=Do;Y.TextTrack=Su;Y.TextTrackList=Ny;Y.AudioTrack=xk;Y.AudioTrackList=bk;Y.VideoTrack=Tk;Y.VideoTrackList=vk;["isEl","isTextNode","createEl","hasClass","addClass","removeClass","toggleClass","setAttributes","getAttributes","emptyEl","appendContent","insertContent"].forEach(n=>{Y[n]=function(){return ze.warn(`videojs.${n}() is deprecated; use videojs.dom.${n}() instead`),ok[n].apply(null,arguments)}});Y.computedStyle=Yn(9,"videojs.computedStyle","videojs.dom.computedStyle",Va);Y.dom=ok;Y.fn=CB;Y.num=hN;Y.str=DB;Y.url=FB;Y.Error=RN;/*! @name videojs-contrib-quality-levels @version 4.1.0 @license Apache-2.0 */class LN{constructor(e){let t=this;return t.id=e.id,t.label=t.id,t.width=e.width,t.height=e.height,t.bitrate=e.bandwidth,t.frameRate=e.frameRate,t.enabled_=e.enabled,Object.defineProperty(t,"enabled",{get(){return t.enabled_()},set(i){t.enabled_(i)}}),t}}class qd extends Y.EventTarget{constructor(){super();let e=this;return e.levels_=[],e.selectedIndex_=-1,Object.defineProperty(e,"selectedIndex",{get(){return e.selectedIndex_}}),Object.defineProperty(e,"length",{get(){return e.levels_.length}}),e[Symbol.iterator]=()=>e.levels_.values(),e}addQualityLevel(e){let t=this.getQualityLevelById(e.id);if(t)return t;const i=this.levels_.length;return t=new LN(e),""+i in this||Object.defineProperty(this,i,{get(){return this.levels_[i]}}),this.levels_.push(t),this.trigger({qualityLevel:t,type:"addqualitylevel"}),t}removeQualityLevel(e){let t=null;for(let i=0,s=this.length;i<s;i++)if(this[i]===e){t=this.levels_.splice(i,1)[0],this.selectedIndex_===i?this.selectedIndex_=-1:this.selectedIndex_>i&&this.selectedIndex_--;break}return t&&this.trigger({qualityLevel:e,type:"removequalitylevel"}),t}getQualityLevelById(e){for(let t=0,i=this.length;t<i;t++){const s=this[t];if(s.id===e)return s}return null}dispose(){this.selectedIndex_=-1,this.levels_.length=0}}qd.prototype.allowedEvents_={change:"change",addqualitylevel:"addqualitylevel",removequalitylevel:"removequalitylevel"};for(const n in qd.prototype.allowedEvents_)qd.prototype["on"+n]=null;var nC="4.1.0";const $N=function(n,e){const t=n.qualityLevels,i=new qd,s=function(){i.dispose(),n.qualityLevels=t,n.off("dispose",s)};return n.on("dispose",s),n.qualityLevels=()=>i,n.qualityLevels.VERSION=nC,i},sC=function(n){return $N(this,Y.obj.merge({},n))};Y.registerPlugin("qualityLevels",sC);sC.VERSION=nC;/*! @name @videojs/http-streaming @version 3.17.2 @license Apache-2.0 */const qi=Nf,zd=(n,e)=>e&&e.responseURL&&n!==e.responseURL?e.responseURL:n,Mn=n=>Y.log.debug?Y.log.debug.bind(Y,"VHS:",`${n} >`):function(){};function et(...n){const e=Y.obj||Y;return(e.merge||e.mergeOptions).apply(e,n)}function ti(...n){const e=Y.time||Y;return(e.createTimeRanges||e.createTimeRanges).apply(e,n)}function QN(n){if(n.length===0)return"Buffered Ranges are empty";let e=`Buffered Ranges: 
`;for(let t=0;t<n.length;t++){const i=n.start(t),s=n.end(t);e+=`${i} --> ${s}. Duration (${s-i})
`}return e}const gs=1/30,Os=gs*3,rC=function(n,e){const t=[];let i;if(n&&n.length)for(i=0;i<n.length;i++)e(n.start(i),n.end(i))&&t.push([n.start(i),n.end(i)]);return ti(t)},la=function(n,e){return rC(n,function(t,i){return t-Os<=e&&i+Os>=e})},dc=function(n,e){return rC(n,function(t){return t-gs>=e})},BN=function(n){if(n.length<2)return ti();const e=[];for(let t=1;t<n.length;t++){const i=n.end(t-1),s=n.start(t);e.push([i,s])}return ti(e)},NN=function(n,e){let t=null,i=null,s=0;const r=[],o=[];if(!n||!n.length||!e||!e.length)return ti();let a=n.length;for(;a--;)r.push({time:n.start(a),type:"start"}),r.push({time:n.end(a),type:"end"});for(a=e.length;a--;)r.push({time:e.start(a),type:"start"}),r.push({time:e.end(a),type:"end"});for(r.sort(function(l,h){return l.time-h.time}),a=0;a<r.length;a++)r[a].type==="start"?(s++,s===2&&(t=r[a].time)):r[a].type==="end"&&(s--,s===1&&(i=r[a].time)),t!==null&&i!==null&&(o.push([t,i]),t=null,i=null);return ti(o)},oC=n=>{const e=[];if(!n||!n.length)return"";for(let t=0;t<n.length;t++)e.push(n.start(t)+" => "+n.end(t));return e.join(", ")},FN=function(n,e,t=1){return((n.length?n.end(n.length-1):0)-e)/t},go=n=>{const e=[];for(let t=0;t<n.length;t++)e.push({start:n.start(t),end:n.end(t)});return e},VN=function(n,e){if(n===e)return!1;if(!n&&e||!e&&n||n.length!==e.length)return!0;for(let t=0;t<n.length;t++)if(n.start(t)!==e.start(t)||n.end(t)!==e.end(t))return!0;return!1},xm=function(n){if(!(!n||!n.length||!n.end))return n.end(n.length-1)},sb=function(n,e){let t=0;if(!n||!n.length)return t;for(let i=0;i<n.length;i++){const s=n.start(i),r=n.end(i);if(!(e>r)){if(e>s&&e<=r){t+=r-e;continue}t+=r-s}}return t},rb=(n,e)=>{if(!e.preload)return e.duration;let t=0;return(e.parts||[]).forEach(function(i){t+=i.duration}),(e.preloadHints||[]).forEach(function(i){i.type==="PART"&&(t+=n.partTargetDuration)}),t},Jg=n=>(n.segments||[]).reduce((e,t,i)=>(t.parts?t.parts.forEach(function(s,r){e.push({duration:s.duration,segmentIndex:i,partIndex:r,part:s,segment:t})}):e.push({duration:t.duration,segmentIndex:i,partIndex:null,segment:t,part:null}),e),[]),aC=n=>{const e=n.segments&&n.segments.length&&n.segments[n.segments.length-1];return e&&e.parts||[]},lC=({preloadSegment:n})=>{if(!n)return;const{parts:e,preloadHints:t}=n;let i=(t||[]).reduce((s,r)=>s+(r.type==="PART"?1:0),0);return i+=e&&e.length?e.length:0,i},hC=(n,e)=>{if(e.endList)return 0;if(n&&n.suggestedPresentationDelay)return n.suggestedPresentationDelay;const t=aC(e).length>0;return t&&e.serverControl&&e.serverControl.partHoldBack?e.serverControl.partHoldBack:t&&e.partTargetDuration?e.partTargetDuration*3:e.serverControl&&e.serverControl.holdBack?e.serverControl.holdBack:e.targetDuration?e.targetDuration*3:0},UN=function(n,e){let t=0,i=e-n.mediaSequence,s=n.segments[i];if(s){if(typeof s.start<"u")return{result:s.start,precise:!0};if(typeof s.end<"u")return{result:s.end-s.duration,precise:!0}}for(;i--;){if(s=n.segments[i],typeof s.end<"u")return{result:t+s.end,precise:!0};if(t+=rb(n,s),typeof s.start<"u")return{result:t+s.start,precise:!0}}return{result:t,precise:!1}},qN=function(n,e){let t=0,i,s=e-n.mediaSequence;for(;s<n.segments.length;s++){if(i=n.segments[s],typeof i.start<"u")return{result:i.start-t,precise:!0};if(t+=rb(n,i),typeof i.end<"u")return{result:i.end-t,precise:!0}}return{result:-1,precise:!1}},uC=function(n,e,t){if(typeof e>"u"&&(e=n.mediaSequence+n.segments.length),e<n.mediaSequence)return 0;const i=UN(n,e);if(i.precise)return i.result;const s=qN(n,e);return s.precise?s.result:i.result+t},cC=function(n,e,t){if(!n)return 0;if(typeof t!="number"&&(t=0),typeof e>"u"){if(n.totalDuration)return n.totalDuration;if(!n.endList)return V.Infinity}return uC(n,e,t)},vh=function({defaultDuration:n,durationList:e,startIndex:t,endIndex:i}){let s=0;if(t>i&&([t,i]=[i,t]),t<0){for(let r=t;r<Math.min(0,i);r++)s+=n;t=0}for(let r=t;r<i;r++)s+=e[r].duration;return s},dC=function(n,e,t,i){if(!n||!n.segments)return null;if(n.endList)return cC(n);if(e===null)return null;e=e||0;let s=uC(n,n.mediaSequence+n.segments.length,e);return t&&(i=typeof i=="number"?i:hC(null,n),s-=i),Math.max(0,s)},zN=function(n,e,t){const s=e||0;let r=dC(n,e,!0,t);return r===null?ti():(r<s&&(r=s),ti(s,r))},jN=function({playlist:n,currentTime:e,startingSegmentIndex:t,startingPartIndex:i,startTime:s,exactManifestTimings:r}){let o=e-s;const a=Jg(n);let l=0;for(let h=0;h<a.length;h++){const u=a[h];if(t===u.segmentIndex&&!(typeof i=="number"&&typeof u.partIndex=="number"&&i!==u.partIndex)){l=h;break}}if(o<0){if(l>0)for(let h=l-1;h>=0;h--){const u=a[h];if(o+=u.duration,r){if(o<0)continue}else if(o+gs<=0)continue;return{partIndex:u.partIndex,segmentIndex:u.segmentIndex,startTime:s-vh({defaultDuration:n.targetDuration,durationList:a,startIndex:l,endIndex:h})}}return{partIndex:a[0]&&a[0].partIndex||null,segmentIndex:a[0]&&a[0].segmentIndex||0,startTime:e}}if(l<0){for(let h=l;h<0;h++)if(o-=n.targetDuration,o<0)return{partIndex:a[0]&&a[0].partIndex||null,segmentIndex:a[0]&&a[0].segmentIndex||0,startTime:e};l=0}for(let h=l;h<a.length;h++){const u=a[h];o-=u.duration;const c=u.duration>gs,f=o===0,p=c&&o+gs>=0;if(!((f||p)&&h!==a.length-1)){if(r){if(o>0)continue}else if(o-gs>=0)continue;return{partIndex:u.partIndex,segmentIndex:u.segmentIndex,startTime:s+vh({defaultDuration:n.targetDuration,durationList:a,startIndex:l,endIndex:h})}}}return{segmentIndex:a[a.length-1].segmentIndex,partIndex:a[a.length-1].partIndex,startTime:e}},fC=function(n){return n.excludeUntil&&n.excludeUntil>Date.now()},ob=function(n){return n.excludeUntil&&n.excludeUntil===1/0},rp=function(n){const e=fC(n);return!n.disabled&&!e},XN=function(n){return n.disabled},HN=function(n){for(let e=0;e<n.segments.length;e++)if(n.segments[e].key)return!0;return!1},pC=function(n,e){return e.attributes&&e.attributes[n]},WN=function(n,e,t,i=0){return pC("BANDWIDTH",t)?(n*t.attributes.BANDWIDTH-i*8)/e:NaN},e0=(n,e)=>{if(n.playlists.length===1)return!0;const t=e.attributes.BANDWIDTH||Number.MAX_VALUE;return n.playlists.filter(i=>rp(i)?(i.attributes.BANDWIDTH||0)<t:!1).length===0},ab=(n,e)=>!n&&!e||!n&&e||n&&!e?!1:!!(n===e||n.id&&e.id&&n.id===e.id||n.resolvedUri&&e.resolvedUri&&n.resolvedUri===e.resolvedUri||n.uri&&e.uri&&n.uri===e.uri),AS=function(n,e){const t=n&&n.mediaGroups&&n.mediaGroups.AUDIO||{};let i=!1;for(const s in t){for(const r in t[s])if(i=e(t[s][r]),i)break;if(i)break}return!!i},_u=n=>{if(!n||!n.playlists||!n.playlists.length)return AS(n,t=>t.playlists&&t.playlists.length||t.uri);for(let e=0;e<n.playlists.length;e++){const t=n.playlists[e],i=t.attributes&&t.attributes.CODECS;if(!(i&&i.split(",").every(r=>k2(r))||AS(n,r=>ab(t,r))))return!1}return!0};var ji={liveEdgeDelay:hC,duration:cC,seekable:zN,getMediaInfoForTime:jN,isEnabled:rp,isDisabled:XN,isExcluded:fC,isIncompatible:ob,playlistEnd:dC,isAes:HN,hasAttribute:pC,estimateSegmentRequestTime:WN,isLowestEnabledRendition:e0,isAudioOnly:_u,playlistMatch:ab,segmentDurationWithParts:rb};const{log:mC}=Y,ba=(n,e)=>`${n}-${e}`,gC=(n,e,t)=>`placeholder-uri-${n}-${e}-${t}`,ZN=({onwarn:n,oninfo:e,manifestString:t,customTagParsers:i=[],customTagMappers:s=[],llhls:r})=>{const o=new $5;n&&o.on("warn",n),e&&o.on("info",e),i.forEach(h=>o.addParser(h)),s.forEach(h=>o.addTagMapper(h)),o.push(t),o.end();const a=o.manifest;if(r||(["preloadSegment","skip","serverControl","renditionReports","partInf","partTargetDuration"].forEach(function(h){a.hasOwnProperty(h)&&delete a[h]}),a.segments&&a.segments.forEach(function(h){["parts","preloadHints"].forEach(function(u){h.hasOwnProperty(u)&&delete h[u]})})),!a.targetDuration){let h=10;a.segments&&a.segments.length&&(h=a.segments.reduce((u,c)=>Math.max(u,c.duration),0)),n&&n({message:`manifest has no targetDuration defaulting to ${h}`}),a.targetDuration=h}const l=aC(a);if(l.length&&!a.partTargetDuration){const h=l.reduce((u,c)=>Math.max(u,c.duration),0);n&&(n({message:`manifest has no partTargetDuration defaulting to ${h}`}),mC.error("LL-HLS manifest has parts but lacks required #EXT-X-PART-INF:PART-TARGET value. See https://datatracker.ietf.org/doc/html/draft-pantos-hls-rfc8216bis-09#section-4.4.3.7. Playback is not guaranteed.")),a.partTargetDuration=h}return a},pl=(n,e)=>{n.mediaGroups&&["AUDIO","SUBTITLES"].forEach(t=>{if(n.mediaGroups[t])for(const i in n.mediaGroups[t])for(const s in n.mediaGroups[t][i]){const r=n.mediaGroups[t][i][s];e(r,t,i,s)}})},OC=({playlist:n,uri:e,id:t})=>{n.id=t,n.playlistErrors_=0,e&&(n.uri=e),n.attributes=n.attributes||{}},YN=n=>{let e=n.playlists.length;for(;e--;){const t=n.playlists[e];OC({playlist:t,id:ba(e,t.uri)}),t.resolvedUri=qi(n.uri,t.uri),n.playlists[t.id]=t,n.playlists[t.uri]=t,t.attributes.BANDWIDTH||mC.warn("Invalid playlist STREAM-INF detected. Missing BANDWIDTH attribute.")}},GN=n=>{pl(n,e=>{e.uri&&(e.resolvedUri=qi(n.uri,e.uri))})},KN=(n,e)=>{const t=ba(0,e),i={mediaGroups:{AUDIO:{},VIDEO:{},"CLOSED-CAPTIONS":{},SUBTITLES:{}},uri:V.location.href,resolvedUri:V.location.href,playlists:[{uri:e,id:t,resolvedUri:e,attributes:{}}]};return i.playlists[t]=i.playlists[0],i.playlists[e]=i.playlists[0],i},yC=(n,e,t=gC)=>{n.uri=e;for(let s=0;s<n.playlists.length;s++)if(!n.playlists[s].uri){const r=`placeholder-uri-${s}`;n.playlists[s].uri=r}const i=_u(n);pl(n,(s,r,o,a)=>{if(!s.playlists||!s.playlists.length){if(i&&r==="AUDIO"&&!s.uri)for(let l=0;l<n.playlists.length;l++){const h=n.playlists[l];if(h.attributes&&h.attributes.AUDIO&&h.attributes.AUDIO===o)return}s.playlists=[Nt({},s)]}s.playlists.forEach(function(l,h){const u=t(r,o,a,l),c=ba(h,u);l.uri?l.resolvedUri=l.resolvedUri||qi(n.uri,l.uri):(l.uri=h===0?u:c,l.resolvedUri=l.uri),l.id=l.id||c,l.attributes=l.attributes||{},n.playlists[l.id]=l,n.playlists[l.uri]=l})}),YN(n),GN(n)};class PS{constructor(){this.offset_=null,this.pendingDateRanges_=new Map,this.processedDateRanges_=new Map}setOffset(e=[]){if(this.offset_!==null||!e.length)return;const[t]=e;t.programDateTime!==void 0&&(this.offset_=t.programDateTime/1e3)}setPendingDateRanges(e=[]){if(!e.length)return;const[t]=e,i=t.startDate.getTime();this.trimProcessedDateRanges_(i),this.pendingDateRanges_=e.reduce((s,r)=>(s.set(r.id,r),s),new Map)}processDateRange(e){this.pendingDateRanges_.delete(e.id),this.processedDateRanges_.set(e.id,e)}getDateRangesToProcess(){if(this.offset_===null)return[];const e={},t=[];this.pendingDateRanges_.forEach((i,s)=>{if(!this.processedDateRanges_.has(s)&&(i.startTime=i.startDate.getTime()/1e3-this.offset_,i.processDateRange=()=>this.processDateRange(i),t.push(i),!!i.class))if(e[i.class]){const r=e[i.class].push(i);i.classListIndex=r-1}else e[i.class]=[i],i.classListIndex=0});for(const i of t){const s=e[i.class]||[];i.endDate?i.endTime=i.endDate.getTime()/1e3-this.offset_:i.endOnNext&&s[i.classListIndex+1]?i.endTime=s[i.classListIndex+1].startTime:i.duration?i.endTime=i.startTime+i.duration:i.plannedDuration?i.endTime=i.startTime+i.plannedDuration:i.endTime=i.startTime}return t}trimProcessedDateRanges_(e){new Map(this.processedDateRanges_).forEach((i,s)=>{i.startDate.getTime()<e&&this.processedDateRanges_.delete(s)})}}const bC=22,Eo=({requestType:n,request:e,error:t,parseFailure:i})=>{const s=e.status<200||e.status>299,r=e.status>=400&&e.status<=499,o={uri:e.uri,requestType:n},a=s&&!r||i;if(t&&r)o.error=Nt({},t),o.errorType=Y.Error.NetworkRequestFailed;else if(e.aborted)o.errorType=Y.Error.NetworkRequestAborted;else if(e.timedout)o.errorType=Y.Error.NetworkRequestTimeout;else if(a){const l=i?Y.Error.NetworkBodyParserFailed:Y.Error.NetworkBadStatus;o.errorType=l,o.status=e.status,o.headers=e.headers}return o},JN=Mn("CodecUtils"),vC=function(n){const e=n.attributes||{};if(e.CODECS)return ds(e.CODECS)},SC=(n,e)=>{const t=e.attributes||{};return n&&n.mediaGroups&&n.mediaGroups.AUDIO&&t.AUDIO&&n.mediaGroups.AUDIO[t.AUDIO]},e8=(n,e)=>{if(!SC(n,e))return!0;const t=e.attributes||{},i=n.mediaGroups.AUDIO[t.AUDIO];for(const s in i)if(!i[s].uri&&!i[s].playlists)return!0;return!1},qh=function(n){const e={};return n.forEach(({mediaType:t,type:i,details:s})=>{e[t]=e[t]||[],e[t].push(_2(`${i}${s}`))}),Object.keys(e).forEach(function(t){if(e[t].length>1){JN(`multiple ${t} codecs found as attributes: ${e[t].join(", ")}. Setting playlist codecs to null so that we wait for mux.js to probe segments for real codecs.`),e[t]=null;return}e[t]=e[t][0]}),e},DS=function(n){let e=0;return n.audio&&e++,n.video&&e++,e},Sh=function(n,e){const t=e.attributes||{},i=qh(vC(e)||[]);if(SC(n,e)&&!i.audio&&!e8(n,e)){const s=qh(B5(n,t.AUDIO)||[]);s.audio&&(i.audio=s.audio)}return i},{EventTarget:t8}=Y,i8=(n,e)=>{if(e.endList||!e.serverControl)return n;const t={};if(e.serverControl.canBlockReload){const{preloadSegment:i}=e;let s=e.mediaSequence+e.segments.length;if(i){const r=i.parts||[],o=lC(e)-1;o>-1&&o!==r.length-1&&(t._HLS_part=o),(o>-1||r.length)&&s--}t._HLS_msn=s}if(e.serverControl&&e.serverControl.canSkipUntil&&(t._HLS_skip=e.serverControl.canSkipDateranges?"v2":"YES"),Object.keys(t).length){const i=new V.URL(n);["_HLS_skip","_HLS_msn","_HLS_part"].forEach(function(s){t.hasOwnProperty(s)&&i.searchParams.set(s,t[s])}),n=i.toString()}return n},n8=(n,e)=>{if(!n)return e;const t=et(n,e);if(n.preloadHints&&!e.preloadHints&&delete t.preloadHints,n.parts&&!e.parts)delete t.parts;else if(n.parts&&e.parts)for(let i=0;i<e.parts.length;i++)n.parts&&n.parts[i]&&(t.parts[i]=et(n.parts[i],e.parts[i]));return!n.skipped&&e.skipped&&(t.skipped=!1),n.preload&&!e.preload&&(t.preload=!1),t},s8=(n,e,t)=>{const i=n.slice(),s=e.slice();t=t||0;const r=[];let o;for(let a=0;a<s.length;a++){const l=i[a+t],h=s[a];l?(o=l.map||o,r.push(n8(l,h))):(o&&!h.map&&(h.map=o),r.push(h))}return r},xC=(n,e)=>{!n.resolvedUri&&n.uri&&(n.resolvedUri=qi(e,n.uri)),n.key&&!n.key.resolvedUri&&(n.key.resolvedUri=qi(e,n.key.uri)),n.map&&!n.map.resolvedUri&&(n.map.resolvedUri=qi(e,n.map.uri)),n.map&&n.map.key&&!n.map.key.resolvedUri&&(n.map.key.resolvedUri=qi(e,n.map.key.uri)),n.parts&&n.parts.length&&n.parts.forEach(t=>{t.resolvedUri||(t.resolvedUri=qi(e,t.uri))}),n.preloadHints&&n.preloadHints.length&&n.preloadHints.forEach(t=>{t.resolvedUri||(t.resolvedUri=qi(e,t.uri))})},TC=function(n){const e=n.segments||[],t=n.preloadSegment;if(t&&t.parts&&t.parts.length){if(t.preloadHints){for(let i=0;i<t.preloadHints.length;i++)if(t.preloadHints[i].type==="MAP")return e}t.duration=n.targetDuration,t.preload=!0,e.push(t)}return e},wC=(n,e)=>n===e||n.segments&&e.segments&&n.segments.length===e.segments.length&&n.endList===e.endList&&n.mediaSequence===e.mediaSequence&&n.preloadSegment===e.preloadSegment,t0=(n,e,t=wC)=>{const i=et(n,{}),s=i.playlists[e.id];if(!s||t(s,e))return null;e.segments=TC(e);const r=et(s,e);if(r.preloadSegment&&!e.preloadSegment&&delete r.preloadSegment,s.segments){if(e.skip){e.segments=e.segments||[];for(let o=0;o<e.skip.skippedSegments;o++)e.segments.unshift({skipped:!0})}r.segments=s8(s.segments,e.segments,e.mediaSequence-s.mediaSequence)}r.segments.forEach(o=>{xC(o,r.resolvedUri)});for(let o=0;o<i.playlists.length;o++)i.playlists[o].id===e.id&&(i.playlists[o]=r);return i.playlists[e.id]=r,i.playlists[e.uri]=r,pl(n,(o,a,l,h)=>{if(o.playlists)for(let u=0;u<o.playlists.length;u++)e.id===o.playlists[u].id&&(o.playlists[u]=r)}),i},i0=(n,e)=>{const t=n.segments||[],i=t[t.length-1],s=i&&i.parts&&i.parts[i.parts.length-1],r=s&&s.duration||i&&i.duration;return e&&r?r*1e3:(n.partTargetDuration||n.targetDuration||10)*500},MS=(n,e,t)=>{if(!n)return;const i=[];return n.forEach(s=>{if(!s.attributes)return;const{BANDWIDTH:r,RESOLUTION:o,CODECS:a}=s.attributes;i.push({id:s.id,bandwidth:r,resolution:o,codecs:a})}),{type:e,isLive:t,renditions:i}};class ha extends t8{constructor(e,t,i={}){if(super(),!e)throw new Error("A non-empty playlist URL or object is required");this.logger_=Mn("PlaylistLoader");const{withCredentials:s=!1}=i;this.src=e,this.vhs_=t,this.withCredentials=s,this.addDateRangesToTextTrack_=i.addDateRangesToTextTrack;const r=t.options_;this.customTagParsers=r&&r.customTagParsers||[],this.customTagMappers=r&&r.customTagMappers||[],this.llhls=r&&r.llhls,this.dateRangesStorage_=new PS,this.state="HAVE_NOTHING",this.handleMediaupdatetimeout_=this.handleMediaupdatetimeout_.bind(this),this.on("mediaupdatetimeout",this.handleMediaupdatetimeout_),this.on("loadedplaylist",this.handleLoadedPlaylist_.bind(this))}handleLoadedPlaylist_(){const e=this.media();if(!e)return;this.dateRangesStorage_.setOffset(e.segments),this.dateRangesStorage_.setPendingDateRanges(e.dateRanges);const t=this.dateRangesStorage_.getDateRangesToProcess();!t.length||!this.addDateRangesToTextTrack_||this.addDateRangesToTextTrack_(t)}handleMediaupdatetimeout_(){if(this.state!=="HAVE_METADATA")return;const e=this.media();let t=qi(this.main.uri,e.uri);this.llhls&&(t=i8(t,e)),this.state="HAVE_CURRENT_METADATA",this.request=this.vhs_.xhr({uri:t,withCredentials:this.withCredentials,requestType:"hls-playlist"},(i,s)=>{if(this.request){if(i)return this.playlistRequestError(this.request,this.media(),"HAVE_METADATA");this.haveMetadata({playlistString:this.request.responseText,url:this.media().uri,id:this.media().id})}})}playlistRequestError(e,t,i){const{uri:s,id:r}=t;this.request=null,i&&(this.state=i),this.error={playlist:this.main.playlists[r],status:e.status,message:`HLS playlist request error at URL: ${s}.`,responseText:e.responseText,code:e.status>=500?4:2,metadata:Eo({requestType:e.requestType,request:e,error:e.error})},this.trigger("error")}parseManifest_({url:e,manifestString:t}){try{const i=ZN({onwarn:({message:s})=>this.logger_(`m3u8-parser warn for ${e}: ${s}`),oninfo:({message:s})=>this.logger_(`m3u8-parser info for ${e}: ${s}`),manifestString:t,customTagParsers:this.customTagParsers,customTagMappers:this.customTagMappers,llhls:this.llhls});return!i.playlists||!i.playlists.length||this.excludeAudioOnlyVariants(i.playlists),i}catch(i){this.error=i,this.error.metadata={errorType:Y.Error.StreamingHlsPlaylistParserError,error:i}}}excludeAudioOnlyVariants(e){const t=i=>{const s=i.attributes||{},{width:r,height:o}=s.RESOLUTION||{};if(r&&o)return!0;const a=vC(i)||[];return!!qh(a).video};e.some(t)&&e.forEach(i=>{t(i)||(i.excludeUntil=1/0)})}haveMetadata({playlistString:e,playlistObject:t,url:i,id:s}){this.request=null,this.state="HAVE_METADATA";const r={playlistInfo:{type:"media",uri:i}};this.trigger({type:"playlistparsestart",metadata:r});const o=t||this.parseManifest_({url:i,manifestString:e});o.lastRequest=Date.now(),OC({playlist:o,uri:i,id:s});const a=t0(this.main,o);this.targetDuration=o.partTargetDuration||o.targetDuration,this.pendingMedia_=null,a?(this.main=a,this.media_=this.main.playlists[s]):this.trigger("playlistunchanged"),this.updateMediaUpdateTimeout_(i0(this.media(),!!a)),r.parsedPlaylist=MS(this.main.playlists,r.playlistInfo.type,!this.media_.endList),this.trigger({type:"playlistparsecomplete",metadata:r}),this.trigger("loadedplaylist")}dispose(){this.trigger("dispose"),this.stopRequest(),V.clearTimeout(this.mediaUpdateTimeout),V.clearTimeout(this.finalRenditionTimeout),this.dateRangesStorage_=new PS,this.off()}stopRequest(){if(this.request){const e=this.request;this.request=null,e.onreadystatechange=null,e.abort()}}media(e,t){if(!e)return this.media_;if(this.state==="HAVE_NOTHING")throw new Error("Cannot switch media playlist from "+this.state);if(typeof e=="string"){if(!this.main.playlists[e])throw new Error("Unknown playlist URI: "+e);e=this.main.playlists[e]}if(V.clearTimeout(this.finalRenditionTimeout),t){const a=(e.partTargetDuration||e.targetDuration)/2*1e3||5e3;this.finalRenditionTimeout=V.setTimeout(this.media.bind(this,e,!1),a);return}const i=this.state,s=!this.media_||e.id!==this.media_.id,r=this.main.playlists[e.id];if(r&&r.endList||e.endList&&e.segments.length){this.request&&(this.request.onreadystatechange=null,this.request.abort(),this.request=null),this.state="HAVE_METADATA",this.media_=e,s&&(this.trigger("mediachanging"),i==="HAVE_MAIN_MANIFEST"?this.trigger("loadedmetadata"):this.trigger("mediachange"));return}if(this.updateMediaUpdateTimeout_(i0(e,!0)),!s)return;if(this.state="SWITCHING_MEDIA",this.request){if(e.resolvedUri===this.request.url)return;this.request.onreadystatechange=null,this.request.abort(),this.request=null}this.media_&&this.trigger("mediachanging"),this.pendingMedia_=e;const o={playlistInfo:{type:"media",uri:e.uri}};this.trigger({type:"playlistrequeststart",metadata:o}),this.request=this.vhs_.xhr({uri:e.resolvedUri,withCredentials:this.withCredentials,requestType:"hls-playlist"},(a,l)=>{if(this.request){if(e.lastRequest=Date.now(),e.resolvedUri=zd(e.resolvedUri,l),a)return this.playlistRequestError(this.request,e,i);this.trigger({type:"playlistrequestcomplete",metadata:o}),this.haveMetadata({playlistString:l.responseText,url:e.uri,id:e.id}),i==="HAVE_MAIN_MANIFEST"?this.trigger("loadedmetadata"):this.trigger("mediachange")}})}pause(){this.mediaUpdateTimeout&&(V.clearTimeout(this.mediaUpdateTimeout),this.mediaUpdateTimeout=null),this.stopRequest(),this.state==="HAVE_NOTHING"&&(this.started=!1),this.state==="SWITCHING_MEDIA"?this.media_?this.state="HAVE_METADATA":this.state="HAVE_MAIN_MANIFEST":this.state==="HAVE_CURRENT_METADATA"&&(this.state="HAVE_METADATA")}load(e){this.mediaUpdateTimeout&&(V.clearTimeout(this.mediaUpdateTimeout),this.mediaUpdateTimeout=null);const t=this.media();if(e){const i=t?(t.partTargetDuration||t.targetDuration)/2*1e3:5e3;this.mediaUpdateTimeout=V.setTimeout(()=>{this.mediaUpdateTimeout=null,this.load()},i);return}if(!this.started){this.start();return}t&&!t.endList?this.trigger("mediaupdatetimeout"):this.trigger("loadedplaylist")}updateMediaUpdateTimeout_(e){this.mediaUpdateTimeout&&(V.clearTimeout(this.mediaUpdateTimeout),this.mediaUpdateTimeout=null),!(!this.media()||this.media().endList)&&(this.mediaUpdateTimeout=V.setTimeout(()=>{this.mediaUpdateTimeout=null,this.trigger("mediaupdatetimeout"),this.updateMediaUpdateTimeout_(e)},e))}start(){if(this.started=!0,typeof this.src=="object"){this.src.uri||(this.src.uri=V.location.href),this.src.resolvedUri=this.src.uri,setTimeout(()=>{this.setupInitialPlaylist(this.src)},0);return}const e={playlistInfo:{type:"multivariant",uri:this.src}};this.trigger({type:"playlistrequeststart",metadata:e}),this.request=this.vhs_.xhr({uri:this.src,withCredentials:this.withCredentials,requestType:"hls-playlist"},(t,i)=>{if(!this.request)return;if(this.request=null,t)return this.error={status:i.status,message:`HLS playlist request error at URL: ${this.src}.`,responseText:i.responseText,code:2,metadata:Eo({requestType:i.requestType,request:i,error:t})},this.state==="HAVE_NOTHING"&&(this.started=!1),this.trigger("error");this.trigger({type:"playlistrequestcomplete",metadata:e}),this.src=zd(this.src,i),this.trigger({type:"playlistparsestart",metadata:e});const s=this.parseManifest_({manifestString:i.responseText,url:this.src});e.parsedPlaylist=MS(s.playlists,e.playlistInfo.type,!1),this.trigger({type:"playlistparsecomplete",metadata:e}),this.setupInitialPlaylist(s)})}srcUri(){return typeof this.src=="string"?this.src:this.src.uri}setupInitialPlaylist(e){if(this.state="HAVE_MAIN_MANIFEST",e.playlists){this.main=e,yC(this.main,this.srcUri()),e.playlists.forEach(i=>{i.segments=TC(i),i.segments.forEach(s=>{xC(s,i.resolvedUri)})}),this.trigger("loadedplaylist"),this.request||this.media(this.main.playlists[0]);return}const t=this.srcUri()||V.location.href;this.main=KN(e,t),this.haveMetadata({playlistObject:e,url:t,id:this.main.playlists[0].id}),this.trigger("loadedmetadata")}updateOrDeleteClone(e,t){const i=this.main,s=e.ID;let r=i.playlists.length;for(;r--;){const o=i.playlists[r];if(o.attributes["PATHWAY-ID"]===s){const a=o.resolvedUri,l=o.id;if(t){const h=this.createCloneURI_(o.resolvedUri,e),u=ba(s,h),c=this.createCloneAttributes_(s,o.attributes),f=this.createClonePlaylist_(o,u,e,c);i.playlists[r]=f,i.playlists[u]=f,i.playlists[h]=f}else i.playlists.splice(r,1);delete i.playlists[l],delete i.playlists[a]}}this.updateOrDeleteCloneMedia(e,t)}updateOrDeleteCloneMedia(e,t){const i=this.main,s=e.ID;["AUDIO","SUBTITLES","CLOSED-CAPTIONS"].forEach(r=>{if(!(!i.mediaGroups[r]||!i.mediaGroups[r][s])){for(const o in i.mediaGroups[r])if(o===s){for(const a in i.mediaGroups[r][o])i.mediaGroups[r][o][a].playlists.forEach((h,u)=>{const c=i.playlists[h.id],f=c.id,p=c.resolvedUri;delete i.playlists[f],delete i.playlists[p]});delete i.mediaGroups[r][o]}}}),t&&this.createClonedMediaGroups_(e)}addClonePathway(e,t={}){const i=this.main,s=i.playlists.length,r=this.createCloneURI_(t.resolvedUri,e),o=ba(e.ID,r),a=this.createCloneAttributes_(e.ID,t.attributes),l=this.createClonePlaylist_(t,o,e,a);i.playlists[s]=l,i.playlists[o]=l,i.playlists[r]=l,this.createClonedMediaGroups_(e)}createClonedMediaGroups_(e){const t=e.ID,i=e["BASE-ID"],s=this.main;["AUDIO","SUBTITLES","CLOSED-CAPTIONS"].forEach(r=>{if(!(!s.mediaGroups[r]||s.mediaGroups[r][t]))for(const o in s.mediaGroups[r]){if(o===i)s.mediaGroups[r][t]={};else continue;for(const a in s.mediaGroups[r][o]){const l=s.mediaGroups[r][o][a];s.mediaGroups[r][t][a]=Nt({},l);const h=s.mediaGroups[r][t][a],u=this.createCloneURI_(l.resolvedUri,e);h.resolvedUri=u,h.uri=u,h.playlists=[],l.playlists.forEach((c,f)=>{const p=s.playlists[c.id],b=gC(r,t,a),y=ba(t,b);if(p&&!s.playlists[y]){const _=this.createClonePlaylist_(p,y,e),T=_.resolvedUri;s.playlists[y]=_,s.playlists[T]=_}h.playlists[f]=this.createClonePlaylist_(c,y,e)})}}})}createClonePlaylist_(e,t,i,s){const r=this.createCloneURI_(e.resolvedUri,i),o={resolvedUri:r,uri:r,id:t};return e.segments&&(o.segments=[]),s&&(o.attributes=s),et(e,o)}createCloneURI_(e,t){const i=new URL(e);i.hostname=t["URI-REPLACEMENT"].HOST;const s=t["URI-REPLACEMENT"].PARAMS;for(const r of Object.keys(s))i.searchParams.set(r,s[r]);return i.href}createCloneAttributes_(e,t){const i={"PATHWAY-ID":e};return["AUDIO","SUBTITLES","CLOSED-CAPTIONS"].forEach(s=>{t[s]&&(i[s]=e)}),i}getKeyIdSet(e){const t=new Set;if(!e||!e.contentProtection)return t;for(const i in e.contentProtection)if(e.contentProtection[i]&&e.contentProtection[i].attributes&&e.contentProtection[i].attributes.keyId){const s=e.contentProtection[i].attributes.keyId;t.add(s.toLowerCase())}return t}}const n0=function(n,e,t,i){const s=n.responseType==="arraybuffer"?n.response:n.responseText;!e&&s&&(n.responseTime=Date.now(),n.roundTripTime=n.responseTime-n.requestTime,n.bytesReceived=s.byteLength||s.length,n.bandwidth||(n.bandwidth=Math.floor(n.bytesReceived/n.roundTripTime*8*1e3))),t.headers&&(n.responseHeaders=t.headers),e&&e.code==="ETIMEDOUT"&&(n.timedout=!0),!e&&!n.aborted&&t.statusCode!==200&&t.statusCode!==206&&t.statusCode!==0&&(e=new Error("XHR Failed with a response of: "+(n&&(s||n.responseText)))),i(e,n)},r8=(n,e)=>{if(!n||!n.size)return;let t=e;return n.forEach(i=>{t=i(t)}),t},o8=(n,e,t,i)=>{!n||!n.size||n.forEach(s=>{s(e,t,i)})},_C=function(){const n=function e(t,i){t=et({timeout:45e3},t);const s=e.beforeRequest||Y.Vhs.xhr.beforeRequest,r=e._requestCallbackSet||Y.Vhs.xhr._requestCallbackSet||new Set,o=e._responseCallbackSet||Y.Vhs.xhr._responseCallbackSet;s&&typeof s=="function"&&(Y.log.warn("beforeRequest is deprecated, use onRequest instead."),r.add(s));const a=Y.Vhs.xhr.original===!0?Y.xhr:Y.Vhs.xhr,l=r8(r,t);r.delete(s);const h=a(l||t,function(c,f){return o8(o,h,c,f),n0(h,c,f,i)}),u=h.abort;return h.abort=function(){return h.aborted=!0,u.apply(h,arguments)},h.uri=t.uri,h.requestType=t.requestType,h.requestTime=Date.now(),h};return n.original=!0,n},a8=function(n){let e;const t=n.offset;return typeof n.offset=="bigint"||typeof n.length=="bigint"?e=V.BigInt(n.offset)+V.BigInt(n.length)-V.BigInt(1):e=n.offset+n.length-1,"bytes="+t+"-"+e},s0=function(n){const e={};return n.byterange&&(e.Range=a8(n.byterange)),e},l8=function(n,e){return n.start(e)+"-"+n.end(e)},h8=function(n,e){const t=n.toString(16);return"00".substring(0,2-t.length)+t+(e%2?" ":"")},u8=function(n){return n>=32&&n<126?String.fromCharCode(n):"."},kC=function(n){const e={};return Object.keys(n).forEach(t=>{const i=n[t];E2(i)?e[t]={bytes:i.buffer,byteOffset:i.byteOffset,byteLength:i.byteLength}:e[t]=i}),e},jd=function(n){const e=n.byterange||{length:1/0,offset:0};return[e.length,e.offset,n.resolvedUri].join(",")},CC=function(n){return n.resolvedUri},EC=n=>{const e=Array.prototype.slice.call(n),t=16;let i="",s,r;for(let o=0;o<e.length/t;o++)s=e.slice(o*t,o*t+t).map(h8).join(""),r=e.slice(o*t,o*t+t).map(u8).join(""),i+=s+" "+r+`
`;return i},c8=({bytes:n})=>EC(n),d8=n=>{let e="",t;for(t=0;t<n.length;t++)e+=l8(n,t)+" ";return e};var f8=Object.freeze({__proto__:null,createTransferableMessage:kC,initSegmentId:jd,segmentKeyId:CC,hexDump:EC,tagDump:c8,textRanges:d8});const AC=.25,p8=(n,e)=>{if(!e.dateTimeObject)return null;const t=e.videoTimingInfo.transmuxerPrependedSeconds,s=e.videoTimingInfo.transmuxedPresentationStart+t,r=n-s;return new Date(e.dateTimeObject.getTime()+r*1e3)},m8=n=>n.transmuxedPresentationEnd-n.transmuxedPresentationStart-n.transmuxerPrependedSeconds,g8=(n,e)=>{let t;try{t=new Date(n)}catch{return null}if(!e||!e.segments||e.segments.length===0)return null;let i=e.segments[0];if(t<new Date(i.dateTimeObject))return null;for(let l=0;l<e.segments.length-1;l++){i=e.segments[l];const h=new Date(e.segments[l+1].dateTimeObject);if(t<h)break}const s=e.segments[e.segments.length-1],r=s.dateTimeObject,o=s.videoTimingInfo?m8(s.videoTimingInfo):s.duration+s.duration*AC,a=new Date(r.getTime()+o*1e3);return t>a?null:(t>new Date(r)&&(i=s),{segment:i,estimatedStart:i.videoTimingInfo?i.videoTimingInfo.transmuxedPresentationStart:ji.duration(e,e.mediaSequence+e.segments.indexOf(i)),type:i.videoTimingInfo?"accurate":"estimate"})},O8=(n,e)=>{if(!e||!e.segments||e.segments.length===0)return null;let t=0,i;for(let r=0;r<e.segments.length&&(i=e.segments[r],t=i.videoTimingInfo?i.videoTimingInfo.transmuxedPresentationEnd:t+i.duration,!(n<=t));r++);const s=e.segments[e.segments.length-1];if(s.videoTimingInfo&&s.videoTimingInfo.transmuxedPresentationEnd<n)return null;if(n>t){if(n>t+s.duration*AC)return null;i=s}return{segment:i,estimatedStart:i.videoTimingInfo?i.videoTimingInfo.transmuxedPresentationStart:t-i.duration,type:i.videoTimingInfo?"accurate":"estimate"}},y8=(n,e)=>{let t,i;try{t=new Date(n),i=new Date(e)}catch{}const s=t.getTime();return(i.getTime()-s)/1e3},b8=n=>{if(!n.segments||n.segments.length===0)return!1;for(let e=0;e<n.segments.length;e++)if(!n.segments[e].dateTimeObject)return!1;return!0},v8=({playlist:n,time:e=void 0,callback:t})=>{if(!t)throw new Error("getProgramTime: callback must be provided");if(!n||e===void 0)return t({message:"getProgramTime: playlist and time must be provided"});const i=O8(e,n);if(!i)return t({message:"valid programTime was not found"});if(i.type==="estimate")return t({message:"Accurate programTime could not be determined. Please seek to e.seekTime and try again",seekTime:i.estimatedStart});const s={mediaSeconds:e},r=p8(e,i.segment);return r&&(s.programDateTime=r.toISOString()),t(null,s)},PC=({programTime:n,playlist:e,retryCount:t=2,seekTo:i,pauseAfterSeek:s=!0,tech:r,callback:o})=>{if(!o)throw new Error("seekToProgramTime: callback must be provided");if(typeof n>"u"||!e||!i)return o({message:"seekToProgramTime: programTime, seekTo and playlist must be provided"});if(!e.endList&&!r.hasStarted_)return o({message:"player must be playing a live stream to start buffering"});if(!b8(e))return o({message:"programDateTime tags must be provided in the manifest "+e.resolvedUri});const a=g8(n,e);if(!a)return o({message:`${n} was not found in the stream`});const l=a.segment,h=y8(l.dateTimeObject,n);if(a.type==="estimate"){if(t===0)return o({message:`${n} is not buffered yet. Try again`});i(a.estimatedStart+h),r.one("seeked",()=>{PC({programTime:n,playlist:e,retryCount:t-1,seekTo:i,pauseAfterSeek:s,tech:r,callback:o})});return}const u=l.start+h,c=()=>o(null,r.currentTime());r.one("seeked",c),s&&r.pause(),i(u)},Tm=(n,e)=>{if(n.readyState===4)return e()},S8=(n,e,t,i)=>{let s=[],r,o=!1;const a=function(c,f,p,b){return f.abort(),o=!0,t(c,f,p,b)},l=function(c,f){if(o)return;if(c)return c.metadata=Eo({requestType:i,request:f,error:c}),a(c,f,"",s);const p=f.responseText.substring(s&&s.byteLength||0,f.responseText.length);if(s=W5(s,A2(p,!0)),r=r||Kl(s),s.length<10||r&&s.length<r+2)return Tm(f,()=>a(c,f,"",s));const b=Dy(s);return b==="ts"&&s.length<188?Tm(f,()=>a(c,f,"",s)):!b&&s.length<376?Tm(f,()=>a(c,f,"",s)):a(null,f,b,s)},u=e({uri:n,beforeSend(c){c.overrideMimeType("text/plain; charset=x-user-defined"),c.addEventListener("progress",function({total:f,loaded:p}){return n0(c,null,{statusCode:c.status},l)})}},function(c,f){return n0(u,c,f,l)});return u},{EventTarget:x8}=Y,IS=function(n,e){if(!wC(n,e)||n.sidx&&e.sidx&&(n.sidx.offset!==e.sidx.offset||n.sidx.length!==e.sidx.length))return!1;if(!n.sidx&&e.sidx||n.sidx&&!e.sidx||n.segments&&!e.segments||!n.segments&&e.segments)return!1;if(!n.segments&&!e.segments)return!0;for(let t=0;t<n.segments.length;t++){const i=n.segments[t],s=e.segments[t];if(i.uri!==s.uri)return!1;if(!i.byterange&&!s.byterange)continue;const r=i.byterange,o=s.byterange;if(r&&!o||!r&&o||r.offset!==o.offset||r.length!==o.length)return!1}return!0},T8=(n,e,t,i)=>{const s=i.attributes.NAME||t;return`placeholder-uri-${n}-${e}-${s}`},w8=({mainXml:n,srcUrl:e,clientOffset:t,sidxMapping:i,previousManifest:s})=>{const r=X4(n,{manifestUri:e,clientOffset:t,sidxMapping:i,previousManifest:s});return yC(r,e,T8),r},_8=(n,e)=>{pl(n,(t,i,s,r)=>{(!e.mediaGroups[i][s]||!(r in e.mediaGroups[i][s]))&&delete n.mediaGroups[i][s][r]})},k8=(n,e,t)=>{let i=!0,s=et(n,{duration:e.duration,minimumUpdatePeriod:e.minimumUpdatePeriod,timelineStarts:e.timelineStarts});for(let r=0;r<e.playlists.length;r++){const o=e.playlists[r];if(o.sidx){const l=Vf(o.sidx);t&&t[l]&&t[l].sidx&&Ey(o,t[l].sidx,o.sidx.resolvedUri)}const a=t0(s,o,IS);a&&(s=a,i=!1)}return pl(e,(r,o,a,l)=>{if(r.playlists&&r.playlists.length){const h=r.playlists[0].id,u=t0(s,r.playlists[0],IS);u&&(s=u,l in s.mediaGroups[o][a]||(s.mediaGroups[o][a][l]=r),s.mediaGroups[o][a][l].playlists[0]=s.playlists[h],i=!1)}}),_8(s,e),e.minimumUpdatePeriod!==n.minimumUpdatePeriod&&(i=!1),i?null:s},C8=(n,e)=>(!n.map&&!e.map||!!(n.map&&e.map&&n.map.byterange.offset===e.map.byterange.offset&&n.map.byterange.length===e.map.byterange.length))&&n.uri===e.uri&&n.byterange.offset===e.byterange.offset&&n.byterange.length===e.byterange.length,RS=(n,e)=>{const t={};for(const i in n){const r=n[i].sidx;if(r){const o=Vf(r);if(!e[o])break;const a=e[o].sidxInfo;C8(a,r)&&(t[o]=e[o])}}return t},E8=(n,e)=>{let i=RS(n.playlists,e);return pl(n,(s,r,o,a)=>{if(s.playlists&&s.playlists.length){const l=s.playlists;i=et(i,RS(l,e))}}),i};class r0 extends x8{constructor(e,t,i={},s){super(),this.isPaused_=!0,this.mainPlaylistLoader_=s||this,s||(this.isMain_=!0);const{withCredentials:r=!1}=i;if(this.vhs_=t,this.withCredentials=r,this.addMetadataToTextTrack=i.addMetadataToTextTrack,!e)throw new Error("A non-empty playlist URL or object is required");this.on("minimumUpdatePeriod",()=>{this.refreshXml_()}),this.on("mediaupdatetimeout",()=>{this.refreshMedia_(this.media().id)}),this.state="HAVE_NOTHING",this.loadedPlaylists_={},this.logger_=Mn("DashPlaylistLoader"),this.isMain_?(this.mainPlaylistLoader_.srcUrl=e,this.mainPlaylistLoader_.sidxMapping_={}):this.childPlaylist_=e}get isPaused(){return this.isPaused_}requestErrored_(e,t,i){if(!this.request)return!0;if(this.request=null,e)return this.error=typeof e=="object"&&!(e instanceof Error)?e:{status:t.status,message:"DASH request error at URL: "+t.uri,response:t.response,code:2,metadata:e.metadata},i&&(this.state=i),this.trigger("error"),!0}addSidxSegments_(e,t,i){const s=e.sidx&&Vf(e.sidx);if(!e.sidx||!s||this.mainPlaylistLoader_.sidxMapping_[s]){V.clearTimeout(this.mediaRequest_),this.mediaRequest_=V.setTimeout(()=>i(!1),0);return}const r=zd(e.sidx.resolvedUri),o=(l,h)=>{if(this.requestErrored_(l,h,t))return;const u=this.mainPlaylistLoader_.sidxMapping_,{requestType:c}=h;let f;try{f=G4(De(h.response).subarray(8))}catch(p){p.metadata=Eo({requestType:c,request:h,parseFailure:!0}),this.requestErrored_(p,h,t);return}return u[s]={sidxInfo:e.sidx,sidx:f},Ey(e,f,e.sidx.resolvedUri),i(!0)},a="dash-sidx";this.request=S8(r,this.vhs_.xhr,(l,h,u,c)=>{if(l)return o(l,h);if(!u||u!=="mp4"){const b=u||"unknown";return o({status:h.status,message:`Unsupported ${b} container type for sidx segment at URL: ${r}`,response:"",playlist:e,internal:!0,playlistExclusionDuration:1/0,code:2},h)}const{offset:f,length:p}=e.sidx.byterange;if(c.length>=p+f)return o(l,{response:c.subarray(f,f+p),status:h.status,uri:h.uri});this.request=this.vhs_.xhr({uri:r,responseType:"arraybuffer",requestType:"dash-sidx",headers:s0({byterange:e.sidx.byterange})},o)},a)}dispose(){this.isPaused_=!0,this.trigger("dispose"),this.stopRequest(),this.loadedPlaylists_={},V.clearTimeout(this.minimumUpdatePeriodTimeout_),V.clearTimeout(this.mediaRequest_),V.clearTimeout(this.mediaUpdateTimeout),this.mediaUpdateTimeout=null,this.mediaRequest_=null,this.minimumUpdatePeriodTimeout_=null,this.mainPlaylistLoader_.createMupOnMedia_&&(this.off("loadedmetadata",this.mainPlaylistLoader_.createMupOnMedia_),this.mainPlaylistLoader_.createMupOnMedia_=null),this.off()}hasPendingRequest(){return this.request||this.mediaRequest_}stopRequest(){if(this.request){const e=this.request;this.request=null,e.onreadystatechange=null,e.abort()}}media(e){if(!e)return this.media_;if(this.state==="HAVE_NOTHING")throw new Error("Cannot switch media playlist from "+this.state);const t=this.state;if(typeof e=="string"){if(!this.mainPlaylistLoader_.main.playlists[e])throw new Error("Unknown playlist URI: "+e);e=this.mainPlaylistLoader_.main.playlists[e]}const i=!this.media_||e.id!==this.media_.id;if(i&&this.loadedPlaylists_[e.id]&&this.loadedPlaylists_[e.id].endList){this.state="HAVE_METADATA",this.media_=e,i&&(this.trigger("mediachanging"),this.trigger("mediachange"));return}i&&(this.media_&&this.trigger("mediachanging"),this.addSidxSegments_(e,t,s=>{this.haveMetadata({startingState:t,playlist:e})}))}haveMetadata({startingState:e,playlist:t}){this.state="HAVE_METADATA",this.loadedPlaylists_[t.id]=t,V.clearTimeout(this.mediaRequest_),this.mediaRequest_=null,this.refreshMedia_(t.id),e==="HAVE_MAIN_MANIFEST"?this.trigger("loadedmetadata"):this.trigger("mediachange")}pause(){this.isPaused_=!0,this.mainPlaylistLoader_.createMupOnMedia_&&(this.off("loadedmetadata",this.mainPlaylistLoader_.createMupOnMedia_),this.mainPlaylistLoader_.createMupOnMedia_=null),this.stopRequest(),V.clearTimeout(this.mediaUpdateTimeout),this.mediaUpdateTimeout=null,this.isMain_&&(V.clearTimeout(this.mainPlaylistLoader_.minimumUpdatePeriodTimeout_),this.mainPlaylistLoader_.minimumUpdatePeriodTimeout_=null),this.state==="HAVE_NOTHING"&&(this.started=!1)}load(e){this.isPaused_=!1,V.clearTimeout(this.mediaUpdateTimeout),this.mediaUpdateTimeout=null;const t=this.media();if(e){const i=t?t.targetDuration/2*1e3:5e3;this.mediaUpdateTimeout=V.setTimeout(()=>this.load(),i);return}if(!this.started){this.start();return}t&&!t.endList?(this.isMain_&&!this.minimumUpdatePeriodTimeout_&&(this.trigger("minimumUpdatePeriod"),this.updateMinimumUpdatePeriodTimeout_()),this.trigger("mediaupdatetimeout")):this.trigger("loadedplaylist")}start(){if(this.started=!0,!this.isMain_){V.clearTimeout(this.mediaRequest_),this.mediaRequest_=V.setTimeout(()=>this.haveMain_(),0);return}this.requestMain_((e,t)=>{this.haveMain_(),!this.hasPendingRequest()&&!this.media_&&this.media(this.mainPlaylistLoader_.main.playlists[0])})}requestMain_(e){const t={manifestInfo:{uri:this.mainPlaylistLoader_.srcUrl}};this.trigger({type:"manifestrequeststart",metadata:t}),this.request=this.vhs_.xhr({uri:this.mainPlaylistLoader_.srcUrl,withCredentials:this.withCredentials,requestType:"dash-manifest"},(i,s)=>{if(i){const{requestType:o}=s;i.metadata=Eo({requestType:o,request:s,error:i})}if(this.requestErrored_(i,s)){this.state==="HAVE_NOTHING"&&(this.started=!1);return}this.trigger({type:"manifestrequestcomplete",metadata:t});const r=s.responseText!==this.mainPlaylistLoader_.mainXml_;if(this.mainPlaylistLoader_.mainXml_=s.responseText,s.responseHeaders&&s.responseHeaders.date?this.mainLoaded_=Date.parse(s.responseHeaders.date):this.mainLoaded_=Date.now(),this.mainPlaylistLoader_.srcUrl=zd(this.mainPlaylistLoader_.srcUrl,s),r){this.handleMain_(),this.syncClientServerClock_(()=>e(s,r));return}return e(s,r)})}syncClientServerClock_(e){const t=H4(this.mainPlaylistLoader_.mainXml_);if(t===null)return this.mainPlaylistLoader_.clientOffset_=this.mainLoaded_-Date.now(),e();if(t.method==="DIRECT")return this.mainPlaylistLoader_.clientOffset_=t.value-Date.now(),e();this.request=this.vhs_.xhr({uri:qi(this.mainPlaylistLoader_.srcUrl,t.value),method:t.method,withCredentials:this.withCredentials,requestType:"dash-clock-sync"},(i,s)=>{if(!this.request)return;if(i){const{requestType:o}=s;return this.error.metadata=Eo({requestType:o,request:s,error:i}),this.mainPlaylistLoader_.clientOffset_=this.mainLoaded_-Date.now(),e()}let r;t.method==="HEAD"?!s.responseHeaders||!s.responseHeaders.date?r=this.mainLoaded_:r=Date.parse(s.responseHeaders.date):r=Date.parse(s.responseText),this.mainPlaylistLoader_.clientOffset_=r-Date.now(),e()})}haveMain_(){this.state="HAVE_MAIN_MANIFEST",this.isMain_?this.trigger("loadedplaylist"):this.media_||this.media(this.childPlaylist_)}handleMain_(){V.clearTimeout(this.mediaRequest_),this.mediaRequest_=null;const e=this.mainPlaylistLoader_.main,t={manifestInfo:{uri:this.mainPlaylistLoader_.srcUrl}};this.trigger({type:"manifestparsestart",metadata:t});let i;try{i=w8({mainXml:this.mainPlaylistLoader_.mainXml_,srcUrl:this.mainPlaylistLoader_.srcUrl,clientOffset:this.mainPlaylistLoader_.clientOffset_,sidxMapping:this.mainPlaylistLoader_.sidxMapping_,previousManifest:e})}catch(r){this.error=r,this.error.metadata={errorType:Y.Error.StreamingDashManifestParserError,error:r},this.trigger("error")}e&&(i=k8(e,i,this.mainPlaylistLoader_.sidxMapping_)),this.mainPlaylistLoader_.main=i||e;const s=this.mainPlaylistLoader_.main.locations&&this.mainPlaylistLoader_.main.locations[0];if(s&&s!==this.mainPlaylistLoader_.srcUrl&&(this.mainPlaylistLoader_.srcUrl=s),(!e||i&&i.minimumUpdatePeriod!==e.minimumUpdatePeriod)&&this.updateMinimumUpdatePeriodTimeout_(),this.addEventStreamToMetadataTrack_(i),i){const{duration:r,endList:o}=i,a=[];i.playlists.forEach(h=>{a.push({id:h.id,bandwidth:h.attributes.BANDWIDTH,resolution:h.attributes.RESOLUTION,codecs:h.attributes.CODECS})});const l={duration:r,isLive:!o,renditions:a};t.parsedManifest=l,this.trigger({type:"manifestparsecomplete",metadata:t})}return!!i}updateMinimumUpdatePeriodTimeout_(){const e=this.mainPlaylistLoader_;e.createMupOnMedia_&&(e.off("loadedmetadata",e.createMupOnMedia_),e.createMupOnMedia_=null),e.minimumUpdatePeriodTimeout_&&(V.clearTimeout(e.minimumUpdatePeriodTimeout_),e.minimumUpdatePeriodTimeout_=null);let t=e.main&&e.main.minimumUpdatePeriod;if(t===0&&(e.media()?t=e.media().targetDuration*1e3:(e.createMupOnMedia_=e.updateMinimumUpdatePeriodTimeout_,e.one("loadedmetadata",e.createMupOnMedia_))),typeof t!="number"||t<=0){t<0&&this.logger_(`found invalid minimumUpdatePeriod of ${t}, not setting a timeout`);return}this.createMUPTimeout_(t)}createMUPTimeout_(e){const t=this.mainPlaylistLoader_;t.minimumUpdatePeriodTimeout_=V.setTimeout(()=>{t.minimumUpdatePeriodTimeout_=null,t.trigger("minimumUpdatePeriod"),t.createMUPTimeout_(e)},e)}refreshXml_(){this.requestMain_((e,t)=>{t&&(this.media_&&(this.media_=this.mainPlaylistLoader_.main.playlists[this.media_.id]),this.mainPlaylistLoader_.sidxMapping_=E8(this.mainPlaylistLoader_.main,this.mainPlaylistLoader_.sidxMapping_),this.addSidxSegments_(this.media(),this.state,i=>{this.refreshMedia_(this.media().id)}))})}refreshMedia_(e){if(!e)throw new Error("refreshMedia_ must take a media id");this.media_&&this.isMain_&&this.handleMain_();const t=this.mainPlaylistLoader_.main.playlists,i=!this.media_||this.media_!==t[e];if(i?this.media_=t[e]:this.trigger("playlistunchanged"),!this.mediaUpdateTimeout){const s=()=>{this.media().endList||(this.mediaUpdateTimeout=V.setTimeout(()=>{this.trigger("mediaupdatetimeout"),s()},i0(this.media(),!!i)))};s()}this.trigger("loadedplaylist")}addEventStreamToMetadataTrack_(e){if(e&&this.mainPlaylistLoader_.main.eventStream){const t=this.mainPlaylistLoader_.main.eventStream.map(i=>({cueTime:i.start,frames:[{data:i.messageData}]}));this.addMetadataToTextTrack("EventStream",t,this.mainPlaylistLoader_.main.duration)}}getKeyIdSet(e){if(e.contentProtection){const t=new Set;for(const i in e.contentProtection){const s=e.contentProtection[i].attributes["cenc:default_KID"];s&&t.add(s.replace(/-/g,"").toLowerCase())}return t}}}var Jt={GOAL_BUFFER_LENGTH:30,MAX_GOAL_BUFFER_LENGTH:60,BACK_BUFFER_LENGTH:30,GOAL_BUFFER_LENGTH_RATE:1,INITIAL_BANDWIDTH:4194304,BANDWIDTH_VARIANCE:1.2,BUFFER_LOW_WATER_LINE:0,MAX_BUFFER_LOW_WATER_LINE:30,EXPERIMENTAL_MAX_BUFFER_LOW_WATER_LINE:16,BUFFER_LOW_WATER_LINE_RATE:1,BUFFER_HIGH_WATER_LINE:30};const A8=n=>{const e=new Uint8Array(new ArrayBuffer(n.length));for(let t=0;t<n.length;t++)e[t]=n.charCodeAt(t);return e.buffer},DC=function(n){return n.on=n.addEventListener,n.off=n.removeEventListener,n},P8=function(n){try{return URL.createObjectURL(new Blob([n],{type:"application/javascript"}))}catch{const t=new BlobBuilder;return t.append(n),URL.createObjectURL(t.getBlob())}},MC=function(n){return function(){const e=P8(n),t=DC(new Worker(e));t.objURL=e;const i=t.terminate;return t.on=t.addEventListener,t.off=t.removeEventListener,t.terminate=function(){return URL.revokeObjectURL(e),i.call(this)},t}},IC=function(n){return`var browserWorkerPolyFill = ${DC.toString()};
browserWorkerPolyFill(self);
`+n},RC=function(n){return n.toString().replace(/^function.+?{/,"").slice(0,-1)},D8=IC(RC(function(){var n=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},e=function(){this.init=function(){var d={};this.on=function(m,O){d[m]||(d[m]=[]),d[m]=d[m].concat(O)},this.off=function(m,O){var g;return d[m]?(g=d[m].indexOf(O),d[m]=d[m].slice(),d[m].splice(g,1),g>-1):!1},this.trigger=function(m){var O,g,x,E;if(O=d[m],!!O)if(arguments.length===2)for(x=O.length,g=0;g<x;++g)O[g].call(this,arguments[1]);else{for(E=[],g=arguments.length,g=1;g<arguments.length;++g)E.push(arguments[g]);for(x=O.length,g=0;g<x;++g)O[g].apply(this,E)}},this.dispose=function(){d={}}}};e.prototype.pipe=function(d){return this.on("data",function(m){d.push(m)}),this.on("done",function(m){d.flush(m)}),this.on("partialdone",function(m){d.partialFlush(m)}),this.on("endedtimeline",function(m){d.endTimeline(m)}),this.on("reset",function(m){d.reset(m)}),d},e.prototype.push=function(d){this.trigger("data",d)},e.prototype.flush=function(d){this.trigger("done",d)},e.prototype.partialFlush=function(d){this.trigger("partialdone",d)},e.prototype.endTimeline=function(d){this.trigger("endedtimeline",d)},e.prototype.reset=function(d){this.trigger("reset",d)};var t=e,i=Math.pow(2,32),s=function(d){var m=new DataView(d.buffer,d.byteOffset,d.byteLength),O;return m.getBigUint64?(O=m.getBigUint64(0),O<Number.MAX_SAFE_INTEGER?Number(O):O):m.getUint32(0)*i+m.getUint32(4)},r={getUint64:s,MAX_UINT32:i},o=r.MAX_UINT32,a,l,h,u,c,f,p,b,y,_,T,w,v,S,k,A,M,B,P,R,q,z,X,Z,K,oe,G,ee,te,re,ne,ve,xe,Pe,Se,ct;(function(){var d;if(X={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],mvex:[],mvhd:[],pasp:[],sdtp:[],smhd:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],styp:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[]},!(typeof Uint8Array>"u")){for(d in X)X.hasOwnProperty(d)&&(X[d]=[d.charCodeAt(0),d.charCodeAt(1),d.charCodeAt(2),d.charCodeAt(3)]);Z=new Uint8Array([105,115,111,109]),oe=new Uint8Array([97,118,99,49]),K=new Uint8Array([0,0,0,1]),G=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),ee=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]),te={video:G,audio:ee},ve=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),ne=new Uint8Array([0,0,0,0,0,0,0,0]),xe=new Uint8Array([0,0,0,0,0,0,0,0]),Pe=xe,Se=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),ct=xe,re=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0])}})(),a=function(d){var m=[],O=0,g,x,E;for(g=1;g<arguments.length;g++)m.push(arguments[g]);for(g=m.length;g--;)O+=m[g].byteLength;for(x=new Uint8Array(O+8),E=new DataView(x.buffer,x.byteOffset,x.byteLength),E.setUint32(0,x.byteLength),x.set(d,4),g=0,O=8;g<m.length;g++)x.set(m[g],O),O+=m[g].byteLength;return x},l=function(){return a(X.dinf,a(X.dref,ve))},h=function(d){return a(X.esds,new Uint8Array([0,0,0,0,3,25,0,0,0,4,17,64,21,0,6,0,0,0,218,192,0,0,218,192,5,2,d.audioobjecttype<<3|d.samplingfrequencyindex>>>1,d.samplingfrequencyindex<<7|d.channelcount<<3,6,1,2]))},u=function(){return a(X.ftyp,Z,K,Z,oe)},A=function(d){return a(X.hdlr,te[d])},c=function(d){return a(X.mdat,d)},k=function(d){var m=new Uint8Array([0,0,0,0,0,0,0,2,0,0,0,3,0,1,95,144,d.duration>>>24&255,d.duration>>>16&255,d.duration>>>8&255,d.duration&255,85,196,0,0]);return d.samplerate&&(m[12]=d.samplerate>>>24&255,m[13]=d.samplerate>>>16&255,m[14]=d.samplerate>>>8&255,m[15]=d.samplerate&255),a(X.mdhd,m)},S=function(d){return a(X.mdia,k(d),A(d.type),p(d))},f=function(d){return a(X.mfhd,new Uint8Array([0,0,0,0,(d&4278190080)>>24,(d&16711680)>>16,(d&65280)>>8,d&255]))},p=function(d){return a(X.minf,d.type==="video"?a(X.vmhd,re):a(X.smhd,ne),l(),B(d))},b=function(d,m){for(var O=[],g=m.length;g--;)O[g]=R(m[g]);return a.apply(null,[X.moof,f(d)].concat(O))},y=function(d){for(var m=d.length,O=[];m--;)O[m]=w(d[m]);return a.apply(null,[X.moov,T(4294967295)].concat(O).concat(_(d)))},_=function(d){for(var m=d.length,O=[];m--;)O[m]=q(d[m]);return a.apply(null,[X.mvex].concat(O))},T=function(d){var m=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,2,0,1,95,144,(d&4278190080)>>24,(d&16711680)>>16,(d&65280)>>8,d&255,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return a(X.mvhd,m)},M=function(d){var m=d.samples||[],O=new Uint8Array(4+m.length),g,x;for(x=0;x<m.length;x++)g=m[x].flags,O[x+4]=g.dependsOn<<4|g.isDependedOn<<2|g.hasRedundancy;return a(X.sdtp,O)},B=function(d){return a(X.stbl,P(d),a(X.stts,ct),a(X.stsc,Pe),a(X.stsz,Se),a(X.stco,xe))},(function(){var d,m;P=function(O){return a(X.stsd,new Uint8Array([0,0,0,0,0,0,0,1]),O.type==="video"?d(O):m(O))},d=function(O){var g=O.sps||[],x=O.pps||[],E=[],$=[],Q,F;for(Q=0;Q<g.length;Q++)E.push((g[Q].byteLength&65280)>>>8),E.push(g[Q].byteLength&255),E=E.concat(Array.prototype.slice.call(g[Q]));for(Q=0;Q<x.length;Q++)$.push((x[Q].byteLength&65280)>>>8),$.push(x[Q].byteLength&255),$=$.concat(Array.prototype.slice.call(x[Q]));if(F=[X.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,(O.width&65280)>>8,O.width&255,(O.height&65280)>>8,O.height&255,0,72,0,0,0,72,0,0,0,0,0,0,0,1,19,118,105,100,101,111,106,115,45,99,111,110,116,114,105,98,45,104,108,115,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),a(X.avcC,new Uint8Array([1,O.profileIdc,O.profileCompatibility,O.levelIdc,255].concat([g.length],E,[x.length],$))),a(X.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192]))],O.sarRatio){var U=O.sarRatio[0],H=O.sarRatio[1];F.push(a(X.pasp,new Uint8Array([(U&4278190080)>>24,(U&16711680)>>16,(U&65280)>>8,U&255,(H&4278190080)>>24,(H&16711680)>>16,(H&65280)>>8,H&255])))}return a.apply(null,F)},m=function(O){return a(X.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,(O.channelcount&65280)>>8,O.channelcount&255,(O.samplesize&65280)>>8,O.samplesize&255,0,0,0,0,(O.samplerate&65280)>>8,O.samplerate&255,0,0]),h(O))}})(),v=function(d){var m=new Uint8Array([0,0,0,7,0,0,0,0,0,0,0,0,(d.id&4278190080)>>24,(d.id&16711680)>>16,(d.id&65280)>>8,d.id&255,0,0,0,0,(d.duration&4278190080)>>24,(d.duration&16711680)>>16,(d.duration&65280)>>8,d.duration&255,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,(d.width&65280)>>8,d.width&255,0,0,(d.height&65280)>>8,d.height&255,0,0]);return a(X.tkhd,m)},R=function(d){var m,O,g,x,E,$,Q;return m=a(X.tfhd,new Uint8Array([0,0,0,58,(d.id&4278190080)>>24,(d.id&16711680)>>16,(d.id&65280)>>8,d.id&255,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0])),$=Math.floor(d.baseMediaDecodeTime/o),Q=Math.floor(d.baseMediaDecodeTime%o),O=a(X.tfdt,new Uint8Array([1,0,0,0,$>>>24&255,$>>>16&255,$>>>8&255,$&255,Q>>>24&255,Q>>>16&255,Q>>>8&255,Q&255])),E=92,d.type==="audio"?(g=z(d,E),a(X.traf,m,O,g)):(x=M(d),g=z(d,x.length+E),a(X.traf,m,O,g,x))},w=function(d){return d.duration=d.duration||4294967295,a(X.trak,v(d),S(d))},q=function(d){var m=new Uint8Array([0,0,0,0,(d.id&4278190080)>>24,(d.id&16711680)>>16,(d.id&65280)>>8,d.id&255,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]);return d.type!=="video"&&(m[m.length-1]=0),a(X.trex,m)},(function(){var d,m,O;O=function(g,x){var E=0,$=0,Q=0,F=0;return g.length&&(g[0].duration!==void 0&&(E=1),g[0].size!==void 0&&($=2),g[0].flags!==void 0&&(Q=4),g[0].compositionTimeOffset!==void 0&&(F=8)),[0,0,E|$|Q|F,1,(g.length&4278190080)>>>24,(g.length&16711680)>>>16,(g.length&65280)>>>8,g.length&255,(x&4278190080)>>>24,(x&16711680)>>>16,(x&65280)>>>8,x&255]},m=function(g,x){var E,$,Q,F,U,H;for(F=g.samples||[],x+=20+16*F.length,Q=O(F,x),$=new Uint8Array(Q.length+F.length*16),$.set(Q),E=Q.length,H=0;H<F.length;H++)U=F[H],$[E++]=(U.duration&4278190080)>>>24,$[E++]=(U.duration&16711680)>>>16,$[E++]=(U.duration&65280)>>>8,$[E++]=U.duration&255,$[E++]=(U.size&4278190080)>>>24,$[E++]=(U.size&16711680)>>>16,$[E++]=(U.size&65280)>>>8,$[E++]=U.size&255,$[E++]=U.flags.isLeading<<2|U.flags.dependsOn,$[E++]=U.flags.isDependedOn<<6|U.flags.hasRedundancy<<4|U.flags.paddingValue<<1|U.flags.isNonSyncSample,$[E++]=U.flags.degradationPriority&61440,$[E++]=U.flags.degradationPriority&15,$[E++]=(U.compositionTimeOffset&4278190080)>>>24,$[E++]=(U.compositionTimeOffset&16711680)>>>16,$[E++]=(U.compositionTimeOffset&65280)>>>8,$[E++]=U.compositionTimeOffset&255;return a(X.trun,$)},d=function(g,x){var E,$,Q,F,U,H;for(F=g.samples||[],x+=20+8*F.length,Q=O(F,x),E=new Uint8Array(Q.length+F.length*8),E.set(Q),$=Q.length,H=0;H<F.length;H++)U=F[H],E[$++]=(U.duration&4278190080)>>>24,E[$++]=(U.duration&16711680)>>>16,E[$++]=(U.duration&65280)>>>8,E[$++]=U.duration&255,E[$++]=(U.size&4278190080)>>>24,E[$++]=(U.size&16711680)>>>16,E[$++]=(U.size&65280)>>>8,E[$++]=U.size&255;return a(X.trun,E)},z=function(g,x){return g.type==="audio"?d(g,x):m(g,x)}})();var vt={ftyp:u,mdat:c,moof:b,moov:y,initSegment:function(d){var m=u(),O=y(d),g;return g=new Uint8Array(m.byteLength+O.byteLength),g.set(m),g.set(O,m.byteLength),g}},rt=function(d){var m,O,g=[],x=[];for(x.byteLength=0,x.nalCount=0,x.duration=0,g.byteLength=0,m=0;m<d.length;m++)O=d[m],O.nalUnitType==="access_unit_delimiter_rbsp"?(g.length&&(g.duration=O.dts-g.dts,x.byteLength+=g.byteLength,x.nalCount+=g.length,x.duration+=g.duration,x.push(g)),g=[O],g.byteLength=O.data.byteLength,g.pts=O.pts,g.dts=O.dts):(O.nalUnitType==="slice_layer_without_partitioning_rbsp_idr"&&(g.keyFrame=!0),g.duration=O.dts-g.dts,g.byteLength+=O.data.byteLength,g.push(O));return x.length&&(!g.duration||g.duration<=0)&&(g.duration=x[x.length-1].duration),x.byteLength+=g.byteLength,x.nalCount+=g.length,x.duration+=g.duration,x.push(g),x},It=function(d){var m,O,g=[],x=[];for(g.byteLength=0,g.nalCount=0,g.duration=0,g.pts=d[0].pts,g.dts=d[0].dts,x.byteLength=0,x.nalCount=0,x.duration=0,x.pts=d[0].pts,x.dts=d[0].dts,m=0;m<d.length;m++)O=d[m],O.keyFrame?(g.length&&(x.push(g),x.byteLength+=g.byteLength,x.nalCount+=g.nalCount,x.duration+=g.duration),g=[O],g.nalCount=O.length,g.byteLength=O.byteLength,g.pts=O.pts,g.dts=O.dts,g.duration=O.duration):(g.duration+=O.duration,g.nalCount+=O.length,g.byteLength+=O.byteLength,g.push(O));return x.length&&g.duration<=0&&(g.duration=x[x.length-1].duration),x.byteLength+=g.byteLength,x.nalCount+=g.nalCount,x.duration+=g.duration,x.push(g),x},Bi=function(d){var m;return!d[0][0].keyFrame&&d.length>1&&(m=d.shift(),d.byteLength-=m.byteLength,d.nalCount-=m.nalCount,d[0][0].dts=m.dts,d[0][0].pts=m.pts,d[0][0].duration+=m.duration),d},Vt=function(){return{size:0,flags:{isLeading:0,dependsOn:1,isDependedOn:0,hasRedundancy:0,degradationPriority:0,isNonSyncSample:1}}},Ut=function(d,m){var O=Vt();return O.dataOffset=m,O.compositionTimeOffset=d.pts-d.dts,O.duration=d.duration,O.size=4*d.length,O.size+=d.byteLength,d.keyFrame&&(O.flags.dependsOn=2,O.flags.isNonSyncSample=0),O},Gn=function(d,m){var O,g,x,E,$,Q=m||0,F=[];for(O=0;O<d.length;O++)for(E=d[O],g=0;g<E.length;g++)$=E[g],x=Ut($,Q),Q+=x.size,F.push(x);return F},qt=function(d){var m,O,g,x,E,$,Q=0,F=d.byteLength,U=d.nalCount,H=F+4*U,J=new Uint8Array(H),de=new DataView(J.buffer);for(m=0;m<d.length;m++)for(x=d[m],O=0;O<x.length;O++)for(E=x[O],g=0;g<E.length;g++)$=E[g],de.setUint32(Q,$.data.byteLength),Q+=4,J.set($.data,Q),Q+=$.data.byteLength;return J},Ln=function(d,m){var O,g=m||0,x=[];return O=Ut(d,g),x.push(O),x},Rt=function(d){var m,O,g=0,x=d.byteLength,E=d.length,$=x+4*E,Q=new Uint8Array($),F=new DataView(Q.buffer);for(m=0;m<d.length;m++)O=d[m],F.setUint32(g,O.data.byteLength),g+=4,Q.set(O.data,g),g+=O.data.byteLength;return Q},Qs={groupNalsIntoFrames:rt,groupFramesIntoGops:It,extendFirstKeyFrame:Bi,generateSampleTable:Gn,concatenateNalData:qt,generateSampleTableForFrame:Ln,concatenateNalDataForFrame:Rt},di=[33,16,5,32,164,27],ni=[33,65,108,84,1,2,4,8,168,2,4,8,17,191,252],Fe=function(d){for(var m=[];d--;)m.push(0);return m},lt=function(d){return Object.keys(d).reduce(function(m,O){return m[O]=new Uint8Array(d[O].reduce(function(g,x){return g.concat(x)},[])),m},{})},ht,pn=function(){if(!ht){var d={96e3:[di,[227,64],Fe(154),[56]],88200:[di,[231],Fe(170),[56]],64e3:[di,[248,192],Fe(240),[56]],48e3:[di,[255,192],Fe(268),[55,148,128],Fe(54),[112]],44100:[di,[255,192],Fe(268),[55,163,128],Fe(84),[112]],32e3:[di,[255,192],Fe(268),[55,234],Fe(226),[112]],24e3:[di,[255,192],Fe(268),[55,255,128],Fe(268),[111,112],Fe(126),[224]],16e3:[di,[255,192],Fe(268),[55,255,128],Fe(268),[111,255],Fe(269),[223,108],Fe(195),[1,192]],12e3:[ni,Fe(268),[3,127,248],Fe(268),[6,255,240],Fe(268),[13,255,224],Fe(268),[27,253,128],Fe(259),[56]],11025:[ni,Fe(268),[3,127,248],Fe(268),[6,255,240],Fe(268),[13,255,224],Fe(268),[27,255,192],Fe(268),[55,175,128],Fe(108),[112]],8e3:[ni,Fe(268),[3,121,16],Fe(47),[7]]};ht=lt(d)}return ht},mn=9e4,gn,Bs,$n,Kn,hr,Gr,ur;gn=function(d){return d*mn},Bs=function(d,m){return d*m},$n=function(d){return d/mn},Kn=function(d,m){return d/m},hr=function(d,m){return gn(Kn(d,m))},Gr=function(d,m){return Bs($n(d),m)},ur=function(d,m,O){return $n(O?d:d-m)};var He={ONE_SECOND_IN_TS:mn,secondsToVideoTs:gn,secondsToAudioTs:Bs,videoTsToSeconds:$n,audioTsToSeconds:Kn,audioTsToVideoTs:hr,videoTsToAudioTs:Gr,metadataTsToSeconds:ur},Kr=pn,Ns=He,ot=function(d){var m,O,g=0;for(m=0;m<d.length;m++)O=d[m],g+=O.data.byteLength;return g},cr=function(d,m,O,g){var x,E=0,$=0,Q=0,F=0,U,H,J;if(m.length&&(x=Ns.audioTsToVideoTs(d.baseMediaDecodeTime,d.samplerate),E=Math.ceil(Ns.ONE_SECOND_IN_TS/(d.samplerate/1024)),O&&g&&($=x-Math.max(O,g),Q=Math.floor($/E),F=Q*E),!(Q<1||F>Ns.ONE_SECOND_IN_TS/2))){for(U=Kr()[d.samplerate],U||(U=m[0].data),H=0;H<Q;H++)J=m[0],m.splice(0,0,{data:U,dts:J.dts-E,pts:J.pts-E});return d.baseMediaDecodeTime-=Math.floor(Ns.videoTsToAudioTs(F,d.samplerate)),F}},Fs=function(d,m,O){return m.minSegmentDts>=O?d:(m.minSegmentDts=1/0,d.filter(function(g){return g.dts>=O?(m.minSegmentDts=Math.min(m.minSegmentDts,g.dts),m.minSegmentPts=m.minSegmentDts,!0):!1}))},Jn=function(d){var m,O,g=[];for(m=0;m<d.length;m++)O=d[m],g.push({size:O.data.byteLength,duration:1024});return g},Vs=function(d){var m,O,g=0,x=new Uint8Array(ot(d));for(m=0;m<d.length;m++)O=d[m],x.set(O.data,g),g+=O.data.byteLength;return x},Us={prefixWithSilence:cr,trimAdtsFramesByEarliestDts:Fs,generateSampleTable:Jn,concatenateFrameData:Vs},Ni=He.ONE_SECOND_IN_TS,I=function(d,m){typeof m.pts=="number"&&(d.timelineStartInfo.pts===void 0&&(d.timelineStartInfo.pts=m.pts),d.minSegmentPts===void 0?d.minSegmentPts=m.pts:d.minSegmentPts=Math.min(d.minSegmentPts,m.pts),d.maxSegmentPts===void 0?d.maxSegmentPts=m.pts:d.maxSegmentPts=Math.max(d.maxSegmentPts,m.pts)),typeof m.dts=="number"&&(d.timelineStartInfo.dts===void 0&&(d.timelineStartInfo.dts=m.dts),d.minSegmentDts===void 0?d.minSegmentDts=m.dts:d.minSegmentDts=Math.min(d.minSegmentDts,m.dts),d.maxSegmentDts===void 0?d.maxSegmentDts=m.dts:d.maxSegmentDts=Math.max(d.maxSegmentDts,m.dts))},L=function(d){delete d.minSegmentDts,delete d.maxSegmentDts,delete d.minSegmentPts,delete d.maxSegmentPts},C=function(d,m){var O,g,x=d.minSegmentDts;return m||(x-=d.timelineStartInfo.dts),O=d.timelineStartInfo.baseMediaDecodeTime,O+=x,O=Math.max(0,O),d.type==="audio"&&(g=d.samplerate/Ni,O*=g,O=Math.floor(O)),O},D={clearDtsInfo:L,calculateTrackBaseMediaDecodeTime:C,collectDtsInfo:I},N=4,W=128,ae=function(d){for(var m=0,O={payloadType:-1,payloadSize:0},g=0,x=0;m<d.byteLength&&d[m]!==W;){for(;d[m]===255;)g+=255,m++;for(g+=d[m++];d[m]===255;)x+=255,m++;if(x+=d[m++],!O.payload&&g===N){var E=String.fromCharCode(d[m+3],d[m+4],d[m+5],d[m+6]);if(E==="GA94"){O.payloadType=g,O.payloadSize=x,O.payload=d.subarray(m,m+x);break}else O.payload=void 0}m+=x,g=0,x=0}return O},ce=function(d){return d.payload[0]!==181||(d.payload[1]<<8|d.payload[2])!==49||String.fromCharCode(d.payload[3],d.payload[4],d.payload[5],d.payload[6])!=="GA94"||d.payload[7]!==3?null:d.payload.subarray(8,d.payload.length-1)},Ee=function(d,m){var O=[],g,x,E,$;if(!(m[0]&64))return O;for(x=m[0]&31,g=0;g<x;g++)E=g*3,$={type:m[E+2]&3,pts:d},m[E+2]&4&&($.ccData=m[E+3]<<8|m[E+4],O.push($));return O},Oe=function(d){for(var m=d.byteLength,O=[],g=1,x,E;g<m-2;)d[g]===0&&d[g+1]===0&&d[g+2]===3?(O.push(g+2),g+=2):g++;if(O.length===0)return d;x=m-O.length,E=new Uint8Array(x);var $=0;for(g=0;g<x;$++,g++)$===O[0]&&($++,O.shift()),E[g]=d[$];return E},Me={parseSei:ae,parseUserData:ce,parseCaptionPackets:Ee,discardEmulationPreventionBytes:Oe,USER_DATA_REGISTERED_ITU_T_T35:N},me=t,Te=Me,Re=function(d){d=d||{},Re.prototype.init.call(this),this.parse708captions_=typeof d.parse708captions=="boolean"?d.parse708captions:!0,this.captionPackets_=[],this.ccStreams_=[new dt(0,0),new dt(0,1),new dt(1,0),new dt(1,1)],this.parse708captions_&&(this.cc708Stream_=new je({captionServices:d.captionServices})),this.reset(),this.ccStreams_.forEach(function(m){m.on("data",this.trigger.bind(this,"data")),m.on("partialdone",this.trigger.bind(this,"partialdone")),m.on("done",this.trigger.bind(this,"done"))},this),this.parse708captions_&&(this.cc708Stream_.on("data",this.trigger.bind(this,"data")),this.cc708Stream_.on("partialdone",this.trigger.bind(this,"partialdone")),this.cc708Stream_.on("done",this.trigger.bind(this,"done")))};Re.prototype=new me,Re.prototype.push=function(d){var m,O,g;if(d.nalUnitType==="sei_rbsp"&&(m=Te.parseSei(d.escapedRBSP),!!m.payload&&m.payloadType===Te.USER_DATA_REGISTERED_ITU_T_T35&&(O=Te.parseUserData(m),!!O))){if(d.dts<this.latestDts_){this.ignoreNextEqualDts_=!0;return}else if(d.dts===this.latestDts_&&this.ignoreNextEqualDts_){this.numSameDts_--,this.numSameDts_||(this.ignoreNextEqualDts_=!1);return}g=Te.parseCaptionPackets(d.pts,O),this.captionPackets_=this.captionPackets_.concat(g),this.latestDts_!==d.dts&&(this.numSameDts_=0),this.numSameDts_++,this.latestDts_=d.dts}},Re.prototype.flushCCStreams=function(d){this.ccStreams_.forEach(function(m){return d==="flush"?m.flush():m.partialFlush()},this)},Re.prototype.flushStream=function(d){if(!this.captionPackets_.length){this.flushCCStreams(d);return}this.captionPackets_.forEach(function(m,O){m.presortIndex=O}),this.captionPackets_.sort(function(m,O){return m.pts===O.pts?m.presortIndex-O.presortIndex:m.pts-O.pts}),this.captionPackets_.forEach(function(m){m.type<2?this.dispatchCea608Packet(m):this.dispatchCea708Packet(m)},this),this.captionPackets_.length=0,this.flushCCStreams(d)},Re.prototype.flush=function(){return this.flushStream("flush")},Re.prototype.partialFlush=function(){return this.flushStream("partialFlush")},Re.prototype.reset=function(){this.latestDts_=null,this.ignoreNextEqualDts_=!1,this.numSameDts_=0,this.activeCea608Channel_=[null,null],this.ccStreams_.forEach(function(d){d.reset()})},Re.prototype.dispatchCea608Packet=function(d){this.setsTextOrXDSActive(d)?this.activeCea608Channel_[d.type]=null:this.setsChannel1Active(d)?this.activeCea608Channel_[d.type]=0:this.setsChannel2Active(d)&&(this.activeCea608Channel_[d.type]=1),this.activeCea608Channel_[d.type]!==null&&this.ccStreams_[(d.type<<1)+this.activeCea608Channel_[d.type]].push(d)},Re.prototype.setsChannel1Active=function(d){return(d.ccData&30720)===4096},Re.prototype.setsChannel2Active=function(d){return(d.ccData&30720)===6144},Re.prototype.setsTextOrXDSActive=function(d){return(d.ccData&28928)===256||(d.ccData&30974)===4138||(d.ccData&30974)===6186},Re.prototype.dispatchCea708Packet=function(d){this.parse708captions_&&this.cc708Stream_.push(d)};var wt={127:9834,4128:32,4129:160,4133:8230,4138:352,4140:338,4144:9608,4145:8216,4146:8217,4147:8220,4148:8221,4149:8226,4153:8482,4154:353,4156:339,4157:8480,4159:376,4214:8539,4215:8540,4216:8541,4217:8542,4218:9168,4219:9124,4220:9123,4221:9135,4222:9126,4223:9121,4256:12600},_t=function(d){var m=wt[d]||d;return d&4096&&d===m?"":String.fromCharCode(m)},fi=function(d){return 32<=d&&d<=127||160<=d&&d<=255},We=function(d){this.windowNum=d,this.reset()};We.prototype.reset=function(){this.clearText(),this.pendingNewLine=!1,this.winAttr={},this.penAttr={},this.penLoc={},this.penColor={},this.visible=0,this.rowLock=0,this.columnLock=0,this.priority=0,this.relativePositioning=0,this.anchorVertical=0,this.anchorHorizontal=0,this.anchorPoint=0,this.rowCount=1,this.virtualRowCount=this.rowCount+1,this.columnCount=41,this.windowStyle=0,this.penStyle=0},We.prototype.getText=function(){return this.rows.join(`
`)},We.prototype.clearText=function(){this.rows=[""],this.rowIdx=0},We.prototype.newLine=function(d){for(this.rows.length>=this.virtualRowCount&&typeof this.beforeRowOverflow=="function"&&this.beforeRowOverflow(d),this.rows.length>0&&(this.rows.push(""),this.rowIdx++);this.rows.length>this.virtualRowCount;)this.rows.shift(),this.rowIdx--},We.prototype.isEmpty=function(){return this.rows.length===0?!0:this.rows.length===1?this.rows[0]==="":!1},We.prototype.addText=function(d){this.rows[this.rowIdx]+=d},We.prototype.backspace=function(){if(!this.isEmpty()){var d=this.rows[this.rowIdx];this.rows[this.rowIdx]=d.substr(0,d.length-1)}};var qs=function(d,m,O){this.serviceNum=d,this.text="",this.currentWindow=new We(-1),this.windows=[],this.stream=O,typeof m=="string"&&this.createTextDecoder(m)};qs.prototype.init=function(d,m){this.startPts=d;for(var O=0;O<8;O++)this.windows[O]=new We(O),typeof m=="function"&&(this.windows[O].beforeRowOverflow=m)},qs.prototype.setCurrentWindow=function(d){this.currentWindow=this.windows[d]},qs.prototype.createTextDecoder=function(d){if(typeof TextDecoder>"u")this.stream.trigger("log",{level:"warn",message:"The `encoding` option is unsupported without TextDecoder support"});else try{this.textDecoder_=new TextDecoder(d)}catch(m){this.stream.trigger("log",{level:"warn",message:"TextDecoder could not be created with "+d+" encoding. "+m})}};var je=function(d){d=d||{},je.prototype.init.call(this);var m=this,O=d.captionServices||{},g={},x;Object.keys(O).forEach(E=>{x=O[E],/^SERVICE/.test(E)&&(g[E]=x.encoding)}),this.serviceEncodings=g,this.current708Packet=null,this.services={},this.push=function(E){E.type===3?(m.new708Packet(),m.add708Bytes(E)):(m.current708Packet===null&&m.new708Packet(),m.add708Bytes(E))}};je.prototype=new me,je.prototype.new708Packet=function(){this.current708Packet!==null&&this.push708Packet(),this.current708Packet={data:[],ptsVals:[]}},je.prototype.add708Bytes=function(d){var m=d.ccData,O=m>>>8,g=m&255;this.current708Packet.ptsVals.push(d.pts),this.current708Packet.data.push(O),this.current708Packet.data.push(g)},je.prototype.push708Packet=function(){var d=this.current708Packet,m=d.data,O=null,g=null,x=0,E=m[x++];for(d.seq=E>>6,d.sizeCode=E&63;x<m.length;x++)E=m[x++],O=E>>5,g=E&31,O===7&&g>0&&(E=m[x++],O=E),this.pushServiceBlock(O,x,g),g>0&&(x+=g-1)},je.prototype.pushServiceBlock=function(d,m,O){var g,x=m,E=this.current708Packet.data,$=this.services[d];for($||($=this.initService(d,x));x<m+O&&x<E.length;x++)g=E[x],fi(g)?x=this.handleText(x,$):g===24?x=this.multiByteCharacter(x,$):g===16?x=this.extendedCommands(x,$):128<=g&&g<=135?x=this.setCurrentWindow(x,$):152<=g&&g<=159?x=this.defineWindow(x,$):g===136?x=this.clearWindows(x,$):g===140?x=this.deleteWindows(x,$):g===137?x=this.displayWindows(x,$):g===138?x=this.hideWindows(x,$):g===139?x=this.toggleWindows(x,$):g===151?x=this.setWindowAttributes(x,$):g===144?x=this.setPenAttributes(x,$):g===145?x=this.setPenColor(x,$):g===146?x=this.setPenLocation(x,$):g===143?$=this.reset(x,$):g===8?$.currentWindow.backspace():g===12?$.currentWindow.clearText():g===13?$.currentWindow.pendingNewLine=!0:g===14?$.currentWindow.clearText():g===141&&x++},je.prototype.extendedCommands=function(d,m){var O=this.current708Packet.data,g=O[++d];return fi(g)&&(d=this.handleText(d,m,{isExtended:!0})),d},je.prototype.getPts=function(d){return this.current708Packet.ptsVals[Math.floor(d/2)]},je.prototype.initService=function(d,m){var g="SERVICE"+d,O=this,g,x;return g in this.serviceEncodings&&(x=this.serviceEncodings[g]),this.services[d]=new qs(d,x,O),this.services[d].init(this.getPts(m),function(E){O.flushDisplayed(E,O.services[d])}),this.services[d]},je.prototype.handleText=function(d,m,O){var g=O&&O.isExtended,x=O&&O.isMultiByte,E=this.current708Packet.data,$=g?4096:0,Q=E[d],F=E[d+1],U=m.currentWindow,H,J;function de(se){return se.map(Ae=>("0"+(Ae&255).toString(16)).slice(-2)).join("")}if(x?(J=[Q,F],d++):J=[Q],m.textDecoder_&&!g)H=m.textDecoder_.decode(new Uint8Array(J));else if(x){const se=de(J);H=String.fromCharCode(parseInt(se,16))}else H=_t($|Q);return U.pendingNewLine&&!U.isEmpty()&&U.newLine(this.getPts(d)),U.pendingNewLine=!1,U.addText(H),d},je.prototype.multiByteCharacter=function(d,m){var O=this.current708Packet.data,g=O[d+1],x=O[d+2];return fi(g)&&fi(x)&&(d=this.handleText(++d,m,{isMultiByte:!0})),d},je.prototype.setCurrentWindow=function(d,m){var O=this.current708Packet.data,g=O[d],x=g&7;return m.setCurrentWindow(x),d},je.prototype.defineWindow=function(d,m){var O=this.current708Packet.data,g=O[d],x=g&7;m.setCurrentWindow(x);var E=m.currentWindow;return g=O[++d],E.visible=(g&32)>>5,E.rowLock=(g&16)>>4,E.columnLock=(g&8)>>3,E.priority=g&7,g=O[++d],E.relativePositioning=(g&128)>>7,E.anchorVertical=g&127,g=O[++d],E.anchorHorizontal=g,g=O[++d],E.anchorPoint=(g&240)>>4,E.rowCount=g&15,g=O[++d],E.columnCount=g&63,g=O[++d],E.windowStyle=(g&56)>>3,E.penStyle=g&7,E.virtualRowCount=E.rowCount+1,d},je.prototype.setWindowAttributes=function(d,m){var O=this.current708Packet.data,g=O[d],x=m.currentWindow.winAttr;return g=O[++d],x.fillOpacity=(g&192)>>6,x.fillRed=(g&48)>>4,x.fillGreen=(g&12)>>2,x.fillBlue=g&3,g=O[++d],x.borderType=(g&192)>>6,x.borderRed=(g&48)>>4,x.borderGreen=(g&12)>>2,x.borderBlue=g&3,g=O[++d],x.borderType+=(g&128)>>5,x.wordWrap=(g&64)>>6,x.printDirection=(g&48)>>4,x.scrollDirection=(g&12)>>2,x.justify=g&3,g=O[++d],x.effectSpeed=(g&240)>>4,x.effectDirection=(g&12)>>2,x.displayEffect=g&3,d},je.prototype.flushDisplayed=function(d,m){for(var O=[],g=0;g<8;g++)m.windows[g].visible&&!m.windows[g].isEmpty()&&O.push(m.windows[g].getText());m.endPts=d,m.text=O.join(`

`),this.pushCaption(m),m.startPts=d},je.prototype.pushCaption=function(d){d.text!==""&&(this.trigger("data",{startPts:d.startPts,endPts:d.endPts,text:d.text,stream:"cc708_"+d.serviceNum}),d.text="",d.startPts=d.endPts)},je.prototype.displayWindows=function(d,m){var O=this.current708Packet.data,g=O[++d],x=this.getPts(d);this.flushDisplayed(x,m);for(var E=0;E<8;E++)g&1<<E&&(m.windows[E].visible=1);return d},je.prototype.hideWindows=function(d,m){var O=this.current708Packet.data,g=O[++d],x=this.getPts(d);this.flushDisplayed(x,m);for(var E=0;E<8;E++)g&1<<E&&(m.windows[E].visible=0);return d},je.prototype.toggleWindows=function(d,m){var O=this.current708Packet.data,g=O[++d],x=this.getPts(d);this.flushDisplayed(x,m);for(var E=0;E<8;E++)g&1<<E&&(m.windows[E].visible^=1);return d},je.prototype.clearWindows=function(d,m){var O=this.current708Packet.data,g=O[++d],x=this.getPts(d);this.flushDisplayed(x,m);for(var E=0;E<8;E++)g&1<<E&&m.windows[E].clearText();return d},je.prototype.deleteWindows=function(d,m){var O=this.current708Packet.data,g=O[++d],x=this.getPts(d);this.flushDisplayed(x,m);for(var E=0;E<8;E++)g&1<<E&&m.windows[E].reset();return d},je.prototype.setPenAttributes=function(d,m){var O=this.current708Packet.data,g=O[d],x=m.currentWindow.penAttr;return g=O[++d],x.textTag=(g&240)>>4,x.offset=(g&12)>>2,x.penSize=g&3,g=O[++d],x.italics=(g&128)>>7,x.underline=(g&64)>>6,x.edgeType=(g&56)>>3,x.fontStyle=g&7,d},je.prototype.setPenColor=function(d,m){var O=this.current708Packet.data,g=O[d],x=m.currentWindow.penColor;return g=O[++d],x.fgOpacity=(g&192)>>6,x.fgRed=(g&48)>>4,x.fgGreen=(g&12)>>2,x.fgBlue=g&3,g=O[++d],x.bgOpacity=(g&192)>>6,x.bgRed=(g&48)>>4,x.bgGreen=(g&12)>>2,x.bgBlue=g&3,g=O[++d],x.edgeRed=(g&48)>>4,x.edgeGreen=(g&12)>>2,x.edgeBlue=g&3,d},je.prototype.setPenLocation=function(d,m){var O=this.current708Packet.data,g=O[d],x=m.currentWindow.penLoc;return m.currentWindow.pendingNewLine=!0,g=O[++d],x.row=g&15,g=O[++d],x.column=g&63,d},je.prototype.reset=function(d,m){var O=this.getPts(d);return this.flushDisplayed(O,m),this.initService(m.serviceNum,d)};var Uo={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,304:174,305:176,306:189,307:191,308:8482,309:162,310:163,311:9834,312:224,313:160,314:232,315:226,316:234,317:238,318:244,319:251,544:193,545:201,546:211,547:218,548:220,549:252,550:8216,551:161,552:42,553:39,554:8212,555:169,556:8480,557:8226,558:8220,559:8221,560:192,561:194,562:199,563:200,564:202,565:203,566:235,567:206,568:207,569:239,570:212,571:217,572:249,573:219,574:171,575:187,800:195,801:227,802:205,803:204,804:236,805:210,806:242,807:213,808:245,809:123,810:125,811:92,812:94,813:95,814:124,815:126,816:196,817:228,818:214,819:246,820:223,821:165,822:164,823:9474,824:197,825:229,826:216,827:248,828:9484,829:9488,830:9492,831:9496},qo=function(d){return d===null?"":(d=Uo[d]||d,String.fromCharCode(d))},zo=14,Ap=[4352,4384,4608,4640,5376,5408,5632,5664,5888,5920,4096,4864,4896,5120,5152],zs=function(){for(var d=[],m=zo+1;m--;)d.push({text:"",indent:0,offset:0});return d},dt=function(d,m){dt.prototype.init.call(this),this.field_=d||0,this.dataChannel_=m||0,this.name_="CC"+((this.field_<<1|this.dataChannel_)+1),this.setConstants(),this.reset(),this.push=function(O){var g,x,E,$,Q;if(g=O.ccData&32639,g===this.lastControlCode_){this.lastControlCode_=null;return}if((g&61440)===4096?this.lastControlCode_=g:g!==this.PADDING_&&(this.lastControlCode_=null),E=g>>>8,$=g&255,g!==this.PADDING_)if(g===this.RESUME_CAPTION_LOADING_)this.mode_="popOn";else if(g===this.END_OF_CAPTION_)this.mode_="popOn",this.clearFormatting(O.pts),this.flushDisplayed(O.pts),x=this.displayed_,this.displayed_=this.nonDisplayed_,this.nonDisplayed_=x,this.startPts_=O.pts;else if(g===this.ROLL_UP_2_ROWS_)this.rollUpRows_=2,this.setRollUp(O.pts);else if(g===this.ROLL_UP_3_ROWS_)this.rollUpRows_=3,this.setRollUp(O.pts);else if(g===this.ROLL_UP_4_ROWS_)this.rollUpRows_=4,this.setRollUp(O.pts);else if(g===this.CARRIAGE_RETURN_)this.clearFormatting(O.pts),this.flushDisplayed(O.pts),this.shiftRowsUp_(),this.startPts_=O.pts;else if(g===this.BACKSPACE_)this.mode_==="popOn"?this.nonDisplayed_[this.row_].text=this.nonDisplayed_[this.row_].text.slice(0,-1):this.displayed_[this.row_].text=this.displayed_[this.row_].text.slice(0,-1);else if(g===this.ERASE_DISPLAYED_MEMORY_)this.flushDisplayed(O.pts),this.displayed_=zs();else if(g===this.ERASE_NON_DISPLAYED_MEMORY_)this.nonDisplayed_=zs();else if(g===this.RESUME_DIRECT_CAPTIONING_)this.mode_!=="paintOn"&&(this.flushDisplayed(O.pts),this.displayed_=zs()),this.mode_="paintOn",this.startPts_=O.pts;else if(this.isSpecialCharacter(E,$))E=(E&3)<<8,Q=qo(E|$),this[this.mode_](O.pts,Q),this.column_++;else if(this.isExtCharacter(E,$))this.mode_==="popOn"?this.nonDisplayed_[this.row_].text=this.nonDisplayed_[this.row_].text.slice(0,-1):this.displayed_[this.row_].text=this.displayed_[this.row_].text.slice(0,-1),E=(E&3)<<8,Q=qo(E|$),this[this.mode_](O.pts,Q),this.column_++;else if(this.isMidRowCode(E,$))this.clearFormatting(O.pts),this[this.mode_](O.pts," "),this.column_++,($&14)===14&&this.addFormatting(O.pts,["i"]),($&1)===1&&this.addFormatting(O.pts,["u"]);else if(this.isOffsetControlCode(E,$)){const U=$&3;this.nonDisplayed_[this.row_].offset=U,this.column_+=U}else if(this.isPAC(E,$)){var F=Ap.indexOf(g&7968);if(this.mode_==="rollUp"&&(F-this.rollUpRows_+1<0&&(F=this.rollUpRows_-1),this.setRollUp(O.pts,F)),F!==this.row_&&F>=0&&F<=14&&(this.clearFormatting(O.pts),this.row_=F),$&1&&this.formatting_.indexOf("u")===-1&&this.addFormatting(O.pts,["u"]),(g&16)===16){const U=(g&14)>>1;this.column_=U*4,this.nonDisplayed_[this.row_].indent+=U}this.isColorPAC($)&&($&14)===14&&this.addFormatting(O.pts,["i"])}else this.isNormalChar(E)&&($===0&&($=null),Q=qo(E),Q+=qo($),this[this.mode_](O.pts,Q),this.column_+=Q.length)}};dt.prototype=new me,dt.prototype.flushDisplayed=function(d){const m=g=>{this.trigger("log",{level:"warn",message:"Skipping a malformed 608 caption at index "+g+"."})},O=[];this.displayed_.forEach((g,x)=>{if(g&&g.text&&g.text.length){try{g.text=g.text.trim()}catch{m(x)}g.text.length&&O.push({text:g.text,line:x+1,position:10+Math.min(70,g.indent*10)+g.offset*2.5})}else g==null&&m(x)}),O.length&&this.trigger("data",{startPts:this.startPts_,endPts:d,content:O,stream:this.name_})},dt.prototype.reset=function(){this.mode_="popOn",this.topRow_=0,this.startPts_=0,this.displayed_=zs(),this.nonDisplayed_=zs(),this.lastControlCode_=null,this.column_=0,this.row_=zo,this.rollUpRows_=2,this.formatting_=[]},dt.prototype.setConstants=function(){this.dataChannel_===0?(this.BASE_=16,this.EXT_=17,this.CONTROL_=(20|this.field_)<<8,this.OFFSET_=23):this.dataChannel_===1&&(this.BASE_=24,this.EXT_=25,this.CONTROL_=(28|this.field_)<<8,this.OFFSET_=31),this.PADDING_=0,this.RESUME_CAPTION_LOADING_=this.CONTROL_|32,this.END_OF_CAPTION_=this.CONTROL_|47,this.ROLL_UP_2_ROWS_=this.CONTROL_|37,this.ROLL_UP_3_ROWS_=this.CONTROL_|38,this.ROLL_UP_4_ROWS_=this.CONTROL_|39,this.CARRIAGE_RETURN_=this.CONTROL_|45,this.RESUME_DIRECT_CAPTIONING_=this.CONTROL_|41,this.BACKSPACE_=this.CONTROL_|33,this.ERASE_DISPLAYED_MEMORY_=this.CONTROL_|44,this.ERASE_NON_DISPLAYED_MEMORY_=this.CONTROL_|46},dt.prototype.isSpecialCharacter=function(d,m){return d===this.EXT_&&m>=48&&m<=63},dt.prototype.isExtCharacter=function(d,m){return(d===this.EXT_+1||d===this.EXT_+2)&&m>=32&&m<=63},dt.prototype.isMidRowCode=function(d,m){return d===this.EXT_&&m>=32&&m<=47},dt.prototype.isOffsetControlCode=function(d,m){return d===this.OFFSET_&&m>=33&&m<=35},dt.prototype.isPAC=function(d,m){return d>=this.BASE_&&d<this.BASE_+8&&m>=64&&m<=127},dt.prototype.isColorPAC=function(d){return d>=64&&d<=79||d>=96&&d<=127},dt.prototype.isNormalChar=function(d){return d>=32&&d<=127},dt.prototype.setRollUp=function(d,m){if(this.mode_!=="rollUp"&&(this.row_=zo,this.mode_="rollUp",this.flushDisplayed(d),this.nonDisplayed_=zs(),this.displayed_=zs()),m!==void 0&&m!==this.row_)for(var O=0;O<this.rollUpRows_;O++)this.displayed_[m-O]=this.displayed_[this.row_-O],this.displayed_[this.row_-O]={text:"",indent:0,offset:0};m===void 0&&(m=this.row_),this.topRow_=m-this.rollUpRows_+1},dt.prototype.addFormatting=function(d,m){this.formatting_=this.formatting_.concat(m);var O=m.reduce(function(g,x){return g+"<"+x+">"},"");this[this.mode_](d,O)},dt.prototype.clearFormatting=function(d){if(this.formatting_.length){var m=this.formatting_.reverse().reduce(function(O,g){return O+"</"+g+">"},"");this.formatting_=[],this[this.mode_](d,m)}},dt.prototype.popOn=function(d,m){var O=this.nonDisplayed_[this.row_].text;O+=m,this.nonDisplayed_[this.row_].text=O},dt.prototype.rollUp=function(d,m){var O=this.displayed_[this.row_].text;O+=m,this.displayed_[this.row_].text=O},dt.prototype.shiftRowsUp_=function(){var d;for(d=0;d<this.topRow_;d++)this.displayed_[d]={text:"",indent:0,offset:0};for(d=this.row_+1;d<zo+1;d++)this.displayed_[d]={text:"",indent:0,offset:0};for(d=this.topRow_;d<this.row_;d++)this.displayed_[d]=this.displayed_[d+1];this.displayed_[this.row_]={text:"",indent:0,offset:0}},dt.prototype.paintOn=function(d,m){var O=this.displayed_[this.row_].text;O+=m,this.displayed_[this.row_].text=O};var Bu={CaptionStream:Re,Cea608Stream:dt,Cea708Stream:je},jo={H264_STREAM_TYPE:27,ADTS_STREAM_TYPE:15,METADATA_STREAM_TYPE:21},oR=t,aR=8589934592,lR=4294967296,gv="shared",Pp=function(d,m){var O=1;for(d>m&&(O=-1);Math.abs(m-d)>lR;)d+=O*aR;return d},Dp=function(d){var m,O;Dp.prototype.init.call(this),this.type_=d||gv,this.push=function(g){if(g.type==="metadata"){this.trigger("data",g);return}this.type_!==gv&&g.type!==this.type_||(O===void 0&&(O=g.dts),g.dts=Pp(g.dts,O),g.pts=Pp(g.pts,O),m=g.dts,this.trigger("data",g))},this.flush=function(){O=m,this.trigger("done")},this.endTimeline=function(){this.flush(),this.trigger("endedtimeline")},this.discontinuity=function(){O=void 0,m=void 0},this.reset=function(){this.discontinuity(),this.trigger("reset")}};Dp.prototype=new oR;var Ov={TimestampRolloverStream:Dp,handleRollover:Pp},hR=(d,m,O)=>{if(!d)return-1;for(var g=O;g<d.length;g++)if(d[g]===m)return g;return-1},uR={typedArrayIndexOf:hR},Nu=uR.typedArrayIndexOf,Fu={Utf8:3},yv=function(d,m,O){var g,x="";for(g=m;g<O;g++)x+="%"+("00"+d[g].toString(16)).slice(-2);return x},bl=function(d,m,O){return decodeURIComponent(yv(d,m,O))},vl=function(d,m,O){return unescape(yv(d,m,O))},Sl=function(d){return d[0]<<21|d[1]<<14|d[2]<<7|d[3]},xl={APIC:function(d){var m=1,O,g,x="-->";d.data[0]===Fu.Utf8&&(O=Nu(d.data,0,m),!(O<0)&&(d.mimeType=vl(d.data,m,O),m=O+1,d.pictureType=d.data[m],m++,g=Nu(d.data,0,m),!(g<0)&&(d.description=bl(d.data,m,g),m=g+1,d.mimeType===x?d.url=vl(d.data,m,d.data.length):d.pictureData=d.data.subarray(m,d.data.length))))},"T*":function(d){d.data[0]===Fu.Utf8&&(d.value=bl(d.data,1,d.data.length).replace(/\0*$/,""),d.values=d.value.split("\0"))},TXXX:function(d){var m;d.data[0]===Fu.Utf8&&(m=Nu(d.data,0,1),m!==-1&&(d.description=bl(d.data,1,m),d.value=bl(d.data,m+1,d.data.length).replace(/\0*$/,""),d.data=d.value))},"W*":function(d){d.url=vl(d.data,0,d.data.length).replace(/\0.*$/,"")},WXXX:function(d){var m;d.data[0]===Fu.Utf8&&(m=Nu(d.data,0,1),m!==-1&&(d.description=bl(d.data,1,m),d.url=vl(d.data,m+1,d.data.length).replace(/\0.*$/,"")))},PRIV:function(d){var m;for(m=0;m<d.data.length;m++)if(d.data[m]===0){d.owner=vl(d.data,0,m);break}d.privateData=d.data.subarray(m+1),d.data=d.privateData}},cR=function(d){var m,O,g=10,x=0,E=[];if(!(d.length<10||d[0]!==73||d[1]!==68||d[2]!==51)){x=Sl(d.subarray(6,10)),x+=10;var $=d[5]&64;$&&(g+=4,g+=Sl(d.subarray(10,14)),x-=Sl(d.subarray(16,20)));do{if(m=Sl(d.subarray(g+4,g+8)),m<1)break;O=String.fromCharCode(d[g],d[g+1],d[g+2],d[g+3]);var Q={id:O,data:d.subarray(g+10,g+m+10)};Q.key=Q.id,xl[Q.id]?xl[Q.id](Q):Q.id[0]==="T"?xl["T*"](Q):Q.id[0]==="W"&&xl["W*"](Q),E.push(Q),g+=10,g+=m}while(g<x);return E}},bv={parseId3Frames:cR,parseSyncSafeInteger:Sl,frameParsers:xl},dR=t,fR=jo,dr=bv,Vu;Vu=function(d){var m={descriptor:d&&d.descriptor},O=0,g=[],x=0,E;if(Vu.prototype.init.call(this),this.dispatchType=fR.METADATA_STREAM_TYPE.toString(16),m.descriptor)for(E=0;E<m.descriptor.length;E++)this.dispatchType+=("00"+m.descriptor[E].toString(16)).slice(-2);this.push=function($){var Q,F,U,H,J,de;if($.type==="timed-metadata"){if($.dataAlignmentIndicator&&(x=0,g.length=0),g.length===0&&($.data.length<10||$.data[0]!==73||$.data[1]!==68||$.data[2]!==51)){this.trigger("log",{level:"warn",message:"Skipping unrecognized metadata packet"});return}if(g.push($),x+=$.data.byteLength,g.length===1&&(O=dr.parseSyncSafeInteger($.data.subarray(6,10)),O+=10),!(x<O)){for(Q={data:new Uint8Array(O),frames:[],pts:g[0].pts,dts:g[0].dts},J=0;J<O;)Q.data.set(g[0].data.subarray(0,O-J),J),J+=g[0].data.byteLength,x-=g[0].data.byteLength,g.shift();F=10,Q.data[5]&64&&(F+=4,F+=dr.parseSyncSafeInteger(Q.data.subarray(10,14)),O-=dr.parseSyncSafeInteger(Q.data.subarray(16,20)));do{if(U=dr.parseSyncSafeInteger(Q.data.subarray(F+4,F+8)),U<1){this.trigger("log",{level:"warn",message:"Malformed ID3 frame encountered. Skipping remaining metadata parsing."});break}if(de=String.fromCharCode(Q.data[F],Q.data[F+1],Q.data[F+2],Q.data[F+3]),H={id:de,data:Q.data.subarray(F+10,F+U+10)},H.key=H.id,dr.frameParsers[H.id]?dr.frameParsers[H.id](H):H.id[0]==="T"?dr.frameParsers["T*"](H):H.id[0]==="W"&&dr.frameParsers["W*"](H),H.owner==="com.apple.streaming.transportStreamTimestamp"){var se=H.data,Ae=(se[3]&1)<<30|se[4]<<22|se[5]<<14|se[6]<<6|se[7]>>>2;Ae*=4,Ae+=se[7]&3,H.timeStamp=Ae,Q.pts===void 0&&Q.dts===void 0&&(Q.pts=H.timeStamp,Q.dts=H.timeStamp),this.trigger("timestamp",H)}Q.frames.push(H),F+=10,F+=U}while(F<O);this.trigger("data",Q)}}}},Vu.prototype=new dR;var pR=Vu,Mp=t,Ip=Bu,Qn=jo,mR=Ov.TimestampRolloverStream,Uu,Tl,qu,Xo=188,Rp=71;Uu=function(){var d=new Uint8Array(Xo),m=0;Uu.prototype.init.call(this),this.push=function(O){var g=0,x=Xo,E;for(m?(E=new Uint8Array(O.byteLength+m),E.set(d.subarray(0,m)),E.set(O,m),m=0):E=O;x<E.byteLength;){if(E[g]===Rp&&E[x]===Rp){this.trigger("data",E.subarray(g,x)),g+=Xo,x+=Xo;continue}g++,x++}g<E.byteLength&&(d.set(E.subarray(g),0),m=E.byteLength-g)},this.flush=function(){m===Xo&&d[0]===Rp&&(this.trigger("data",d),m=0),this.trigger("done")},this.endTimeline=function(){this.flush(),this.trigger("endedtimeline")},this.reset=function(){m=0,this.trigger("reset")}},Uu.prototype=new Mp,Tl=function(){var d,m,O,g;Tl.prototype.init.call(this),g=this,this.packetsWaitingForPmt=[],this.programMapTable=void 0,d=function(x,E){var $=0;E.payloadUnitStartIndicator&&($+=x[$]+1),E.type==="pat"?m(x.subarray($),E):O(x.subarray($),E)},m=function(x,E){E.section_number=x[7],E.last_section_number=x[8],g.pmtPid=(x[10]&31)<<8|x[11],E.pmtPid=g.pmtPid},O=function(x,E){var $,Q,F,U;if(x[5]&1){for(g.programMapTable={video:null,audio:null,"timed-metadata":{}},$=(x[1]&15)<<8|x[2],Q=3+$-4,F=(x[10]&15)<<8|x[11],U=12+F;U<Q;){var H=x[U],J=(x[U+1]&31)<<8|x[U+2];H===Qn.H264_STREAM_TYPE&&g.programMapTable.video===null?g.programMapTable.video=J:H===Qn.ADTS_STREAM_TYPE&&g.programMapTable.audio===null?g.programMapTable.audio=J:H===Qn.METADATA_STREAM_TYPE&&(g.programMapTable["timed-metadata"][J]=H),U+=((x[U+3]&15)<<8|x[U+4])+5}E.programMapTable=g.programMapTable}},this.push=function(x){var E={},$=4;if(E.payloadUnitStartIndicator=!!(x[1]&64),E.pid=x[1]&31,E.pid<<=8,E.pid|=x[2],(x[3]&48)>>>4>1&&($+=x[$]+1),E.pid===0)E.type="pat",d(x.subarray($),E),this.trigger("data",E);else if(E.pid===this.pmtPid)for(E.type="pmt",d(x.subarray($),E),this.trigger("data",E);this.packetsWaitingForPmt.length;)this.processPes_.apply(this,this.packetsWaitingForPmt.shift());else this.programMapTable===void 0?this.packetsWaitingForPmt.push([x,$,E]):this.processPes_(x,$,E)},this.processPes_=function(x,E,$){$.pid===this.programMapTable.video?$.streamType=Qn.H264_STREAM_TYPE:$.pid===this.programMapTable.audio?$.streamType=Qn.ADTS_STREAM_TYPE:$.streamType=this.programMapTable["timed-metadata"][$.pid],$.type="pes",$.data=x.subarray(E),this.trigger("data",$)}},Tl.prototype=new Mp,Tl.STREAM_TYPES={h264:27,adts:15},qu=function(){var d=this,m=!1,O={data:[],size:0},g={data:[],size:0},x={data:[],size:0},E,$=function(F,U){var H;const J=F[0]<<16|F[1]<<8|F[2];U.data=new Uint8Array,J===1&&(U.packetLength=6+(F[4]<<8|F[5]),U.dataAlignmentIndicator=(F[6]&4)!==0,H=F[7],H&192&&(U.pts=(F[9]&14)<<27|(F[10]&255)<<20|(F[11]&254)<<12|(F[12]&255)<<5|(F[13]&254)>>>3,U.pts*=4,U.pts+=(F[13]&6)>>>1,U.dts=U.pts,H&64&&(U.dts=(F[14]&14)<<27|(F[15]&255)<<20|(F[16]&254)<<12|(F[17]&255)<<5|(F[18]&254)>>>3,U.dts*=4,U.dts+=(F[18]&6)>>>1)),U.data=F.subarray(9+F[8]))},Q=function(F,U,H){var J=new Uint8Array(F.size),de={type:U},se=0,Ae=0,Ne=!1,Gt;if(!(!F.data.length||F.size<9)){for(de.trackId=F.data[0].pid,se=0;se<F.data.length;se++)Gt=F.data[se],J.set(Gt.data,Ae),Ae+=Gt.data.byteLength;$(J,de),Ne=U==="video"||de.packetLength<=F.size,(H||Ne)&&(F.size=0,F.data.length=0),Ne&&d.trigger("data",de)}};qu.prototype.init.call(this),this.push=function(F){({pat:function(){},pes:function(){var U,H;switch(F.streamType){case Qn.H264_STREAM_TYPE:U=O,H="video";break;case Qn.ADTS_STREAM_TYPE:U=g,H="audio";break;case Qn.METADATA_STREAM_TYPE:U=x,H="timed-metadata";break;default:return}F.payloadUnitStartIndicator&&Q(U,H,!0),U.data.push(F),U.size+=F.data.byteLength},pmt:function(){var U={type:"metadata",tracks:[]};E=F.programMapTable,E.video!==null&&U.tracks.push({timelineStartInfo:{baseMediaDecodeTime:0},id:+E.video,codec:"avc",type:"video"}),E.audio!==null&&U.tracks.push({timelineStartInfo:{baseMediaDecodeTime:0},id:+E.audio,codec:"adts",type:"audio"}),m=!0,d.trigger("data",U)}})[F.type]()},this.reset=function(){O.size=0,O.data.length=0,g.size=0,g.data.length=0,this.trigger("reset")},this.flushStreams_=function(){Q(O,"video"),Q(g,"audio"),Q(x,"timed-metadata")},this.flush=function(){if(!m&&E){var F={type:"metadata",tracks:[]};E.video!==null&&F.tracks.push({timelineStartInfo:{baseMediaDecodeTime:0},id:+E.video,codec:"avc",type:"video"}),E.audio!==null&&F.tracks.push({timelineStartInfo:{baseMediaDecodeTime:0},id:+E.audio,codec:"adts",type:"audio"}),d.trigger("data",F)}m=!1,this.flushStreams_(),this.trigger("done")}},qu.prototype=new Mp;var vv={PAT_PID:0,MP2T_PACKET_LENGTH:Xo,TransportPacketStream:Uu,TransportParseStream:Tl,ElementaryStream:qu,TimestampRolloverStream:mR,CaptionStream:Ip.CaptionStream,Cea608Stream:Ip.Cea608Stream,Cea708Stream:Ip.Cea708Stream,MetadataStream:pR};for(var Lp in Qn)Qn.hasOwnProperty(Lp)&&(vv[Lp]=Qn[Lp]);var gR=vv,OR=t,yR=He.ONE_SECOND_IN_TS,zu,Sv=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];zu=function(d){var m,O=0;zu.prototype.init.call(this),this.skipWarn_=function(g,x){this.trigger("log",{level:"warn",message:`adts skiping bytes ${g} to ${x} in frame ${O} outside syncword`})},this.push=function(g){var x=0,E,$,Q,F,U;if(d||(O=0),g.type==="audio"){m&&m.length?(Q=m,m=new Uint8Array(Q.byteLength+g.data.byteLength),m.set(Q),m.set(g.data,Q.byteLength)):m=g.data;for(var H;x+7<m.length;){if(m[x]!==255||(m[x+1]&246)!==240){typeof H!="number"&&(H=x),x++;continue}if(typeof H=="number"&&(this.skipWarn_(H,x),H=null),$=(~m[x+1]&1)*2,E=(m[x+3]&3)<<11|m[x+4]<<3|(m[x+5]&224)>>5,F=((m[x+6]&3)+1)*1024,U=F*yR/Sv[(m[x+2]&60)>>>2],m.byteLength-x<E)break;this.trigger("data",{pts:g.pts+O*U,dts:g.dts+O*U,sampleCount:F,audioobjecttype:(m[x+2]>>>6&3)+1,channelcount:(m[x+2]&1)<<2|(m[x+3]&192)>>>6,samplerate:Sv[(m[x+2]&60)>>>2],samplingfrequencyindex:(m[x+2]&60)>>>2,samplesize:16,data:m.subarray(x+7+$,x+E)}),O++,x+=E}typeof H=="number"&&(this.skipWarn_(H,x),H=null),m=m.subarray(x)}},this.flush=function(){O=0,this.trigger("done")},this.reset=function(){m=void 0,this.trigger("reset")},this.endTimeline=function(){m=void 0,this.trigger("endedtimeline")}},zu.prototype=new OR;var bR=zu,xv;xv=function(d){var m=d.byteLength,O=0,g=0;this.length=function(){return 8*m},this.bitsAvailable=function(){return 8*m+g},this.loadWord=function(){var x=d.byteLength-m,E=new Uint8Array(4),$=Math.min(4,m);if($===0)throw new Error("no bytes available");E.set(d.subarray(x,x+$)),O=new DataView(E.buffer).getUint32(0),g=$*8,m-=$},this.skipBits=function(x){var E;g>x?(O<<=x,g-=x):(x-=g,E=Math.floor(x/8),x-=E*8,m-=E,this.loadWord(),O<<=x,g-=x)},this.readBits=function(x){var E=Math.min(g,x),$=O>>>32-E;return g-=E,g>0?O<<=E:m>0&&this.loadWord(),E=x-E,E>0?$<<E|this.readBits(E):$},this.skipLeadingZeros=function(){var x;for(x=0;x<g;++x)if((O&2147483648>>>x)!==0)return O<<=x,g-=x,x;return this.loadWord(),x+this.skipLeadingZeros()},this.skipUnsignedExpGolomb=function(){this.skipBits(1+this.skipLeadingZeros())},this.skipExpGolomb=function(){this.skipBits(1+this.skipLeadingZeros())},this.readUnsignedExpGolomb=function(){var x=this.skipLeadingZeros();return this.readBits(x+1)-1},this.readExpGolomb=function(){var x=this.readUnsignedExpGolomb();return 1&x?1+x>>>1:-1*(x>>>1)},this.readBoolean=function(){return this.readBits(1)===1},this.readUnsignedByte=function(){return this.readBits(8)},this.loadWord()};var vR=xv,Tv=t,SR=vR,ju,Xu,wv;Xu=function(){var d=0,m,O;Xu.prototype.init.call(this),this.push=function(g){var x;O?(x=new Uint8Array(O.byteLength+g.data.byteLength),x.set(O),x.set(g.data,O.byteLength),O=x):O=g.data;for(var E=O.byteLength;d<E-3;d++)if(O[d+2]===1){m=d+5;break}for(;m<E;)switch(O[m]){case 0:if(O[m-1]!==0){m+=2;break}else if(O[m-2]!==0){m++;break}d+3!==m-2&&this.trigger("data",O.subarray(d+3,m-2));do m++;while(O[m]!==1&&m<E);d=m-2,m+=3;break;case 1:if(O[m-1]!==0||O[m-2]!==0){m+=3;break}this.trigger("data",O.subarray(d+3,m-2)),d=m-2,m+=3;break;default:m+=3;break}O=O.subarray(d),m-=d,d=0},this.reset=function(){O=null,d=0,this.trigger("reset")},this.flush=function(){O&&O.byteLength>3&&this.trigger("data",O.subarray(d+3)),O=null,d=0,this.trigger("done")},this.endTimeline=function(){this.flush(),this.trigger("endedtimeline")}},Xu.prototype=new Tv,wv={100:!0,110:!0,122:!0,244:!0,44:!0,83:!0,86:!0,118:!0,128:!0,138:!0,139:!0,134:!0},ju=function(){var d=new Xu,m,O,g,x,E,$,Q;ju.prototype.init.call(this),m=this,this.push=function(F){F.type==="video"&&(O=F.trackId,g=F.pts,x=F.dts,d.push(F))},d.on("data",function(F){var U={trackId:O,pts:g,dts:x,data:F,nalUnitTypeCode:F[0]&31};switch(U.nalUnitTypeCode){case 5:U.nalUnitType="slice_layer_without_partitioning_rbsp_idr";break;case 6:U.nalUnitType="sei_rbsp",U.escapedRBSP=E(F.subarray(1));break;case 7:U.nalUnitType="seq_parameter_set_rbsp",U.escapedRBSP=E(F.subarray(1)),U.config=$(U.escapedRBSP);break;case 8:U.nalUnitType="pic_parameter_set_rbsp";break;case 9:U.nalUnitType="access_unit_delimiter_rbsp";break}m.trigger("data",U)}),d.on("done",function(){m.trigger("done")}),d.on("partialdone",function(){m.trigger("partialdone")}),d.on("reset",function(){m.trigger("reset")}),d.on("endedtimeline",function(){m.trigger("endedtimeline")}),this.flush=function(){d.flush()},this.partialFlush=function(){d.partialFlush()},this.reset=function(){d.reset()},this.endTimeline=function(){d.endTimeline()},Q=function(F,U){var H=8,J=8,de,se;for(de=0;de<F;de++)J!==0&&(se=U.readExpGolomb(),J=(H+se+256)%256),H=J===0?H:J},E=function(F){for(var U=F.byteLength,H=[],J=1,de,se;J<U-2;)F[J]===0&&F[J+1]===0&&F[J+2]===3?(H.push(J+2),J+=2):J++;if(H.length===0)return F;de=U-H.length,se=new Uint8Array(de);var Ae=0;for(J=0;J<de;Ae++,J++)Ae===H[0]&&(Ae++,H.shift()),se[J]=F[Ae];return se},$=function(F){var U=0,H=0,J=0,de=0,se,Ae,Ne,Gt,Zi,pr,Pl,Dl,Ml,Il,sc,gt=[1,1],Rl,Nn;if(se=new SR(F),Ae=se.readUnsignedByte(),Gt=se.readUnsignedByte(),Ne=se.readUnsignedByte(),se.skipUnsignedExpGolomb(),wv[Ae]&&(Zi=se.readUnsignedExpGolomb(),Zi===3&&se.skipBits(1),se.skipUnsignedExpGolomb(),se.skipUnsignedExpGolomb(),se.skipBits(1),se.readBoolean()))for(sc=Zi!==3?8:12,Nn=0;Nn<sc;Nn++)se.readBoolean()&&(Nn<6?Q(16,se):Q(64,se));if(se.skipUnsignedExpGolomb(),pr=se.readUnsignedExpGolomb(),pr===0)se.readUnsignedExpGolomb();else if(pr===1)for(se.skipBits(1),se.skipExpGolomb(),se.skipExpGolomb(),Pl=se.readUnsignedExpGolomb(),Nn=0;Nn<Pl;Nn++)se.skipExpGolomb();if(se.skipUnsignedExpGolomb(),se.skipBits(1),Dl=se.readUnsignedExpGolomb(),Ml=se.readUnsignedExpGolomb(),Il=se.readBits(1),Il===0&&se.skipBits(1),se.skipBits(1),se.readBoolean()&&(U=se.readUnsignedExpGolomb(),H=se.readUnsignedExpGolomb(),J=se.readUnsignedExpGolomb(),de=se.readUnsignedExpGolomb()),se.readBoolean()&&se.readBoolean()){switch(Rl=se.readUnsignedByte(),Rl){case 1:gt=[1,1];break;case 2:gt=[12,11];break;case 3:gt=[10,11];break;case 4:gt=[16,11];break;case 5:gt=[40,33];break;case 6:gt=[24,11];break;case 7:gt=[20,11];break;case 8:gt=[32,11];break;case 9:gt=[80,33];break;case 10:gt=[18,11];break;case 11:gt=[15,11];break;case 12:gt=[64,33];break;case 13:gt=[160,99];break;case 14:gt=[4,3];break;case 15:gt=[3,2];break;case 16:gt=[2,1];break;case 255:{gt=[se.readUnsignedByte()<<8|se.readUnsignedByte(),se.readUnsignedByte()<<8|se.readUnsignedByte()];break}}gt&&gt[0]/gt[1]}return{profileIdc:Ae,levelIdc:Ne,profileCompatibility:Gt,width:(Dl+1)*16-U*2-H*2,height:(2-Il)*(Ml+1)*16-J*2-de*2,sarRatio:gt}}},ju.prototype=new Tv;var xR={H264Stream:ju},TR=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350],_v=function(d,m){var O=d[m+6]<<21|d[m+7]<<14|d[m+8]<<7|d[m+9],g=d[m+5],x=(g&16)>>4;return O=O>=0?O:0,x?O+20:O+10},kv=function(d,m){return d.length-m<10||d[m]!==73||d[m+1]!==68||d[m+2]!==51?m:(m+=_v(d,m),kv(d,m))},wR=function(d){var m=kv(d,0);return d.length>=m+2&&(d[m]&255)===255&&(d[m+1]&240)===240&&(d[m+1]&22)===16},Cv=function(d){return d[0]<<21|d[1]<<14|d[2]<<7|d[3]},_R=function(d,m,O){var g,x="";for(g=m;g<O;g++)x+="%"+("00"+d[g].toString(16)).slice(-2);return x},kR=function(d,m,O){return unescape(_R(d,m,O))},CR=function(d,m){var O=(d[m+5]&224)>>5,g=d[m+4]<<3,x=d[m+3]&6144;return x|g|O},ER=function(d,m){return d[m]===73&&d[m+1]===68&&d[m+2]===51?"timed-metadata":d[m]&!0&&(d[m+1]&240)===240?"audio":null},AR=function(d){for(var m=0;m+5<d.length;){if(d[m]!==255||(d[m+1]&246)!==240){m++;continue}return TR[(d[m+2]&60)>>>2]}return null},PR=function(d){var m,O,g,x;m=10,d[5]&64&&(m+=4,m+=Cv(d.subarray(10,14)));do{if(O=Cv(d.subarray(m+4,m+8)),O<1)return null;if(x=String.fromCharCode(d[m],d[m+1],d[m+2],d[m+3]),x==="PRIV"){g=d.subarray(m+10,m+O+10);for(var E=0;E<g.byteLength;E++)if(g[E]===0){var $=kR(g,0,E);if($==="com.apple.streaming.transportStreamTimestamp"){var Q=g.subarray(E+1),F=(Q[3]&1)<<30|Q[4]<<22|Q[5]<<14|Q[6]<<6|Q[7]>>>2;return F*=4,F+=Q[7]&3,F}break}}m+=10,m+=O}while(m<d.byteLength);return null},$p={isLikelyAacData:wR,parseId3TagSize:_v,parseAdtsSize:CR,parseType:ER,parseSampleRate:AR,parseAacTimestamp:PR},DR=t,Ev=$p,Hu;Hu=function(){var d=new Uint8Array,m=0;Hu.prototype.init.call(this),this.setTimestamp=function(O){m=O},this.push=function(O){var g=0,x=0,E,$,Q,F;for(d.length?(F=d.length,d=new Uint8Array(O.byteLength+F),d.set(d.subarray(0,F)),d.set(O,F)):d=O;d.length-x>=3;){if(d[x]===73&&d[x+1]===68&&d[x+2]===51){if(d.length-x<10||(g=Ev.parseId3TagSize(d,x),x+g>d.length))break;$={type:"timed-metadata",data:d.subarray(x,x+g)},this.trigger("data",$),x+=g;continue}else if((d[x]&255)===255&&(d[x+1]&240)===240){if(d.length-x<7||(g=Ev.parseAdtsSize(d,x),x+g>d.length))break;Q={type:"audio",data:d.subarray(x,x+g),pts:m,dts:m},this.trigger("data",Q),x+=g;continue}x++}E=d.length-x,E>0?d=d.subarray(x):d=new Uint8Array},this.reset=function(){d=new Uint8Array,this.trigger("reset")},this.endTimeline=function(){d=new Uint8Array,this.trigger("endedtimeline")}},Hu.prototype=new DR;var MR=Hu,IR=["audioobjecttype","channelcount","samplerate","samplingfrequencyindex","samplesize"],RR=IR,LR=["width","height","profileIdc","levelIdc","profileCompatibility","sarRatio"],$R=LR,Wu=t,wl=vt,_l=Qs,Zu=Us,Bn=D,js=gR,Yu=He,Av=bR,QR=xR.H264Stream,BR=MR,NR=$p.isLikelyAacData,FR=He.ONE_SECOND_IN_TS,Pv=RR,Dv=$R,Gu,kl,Ku,Jr,VR=function(d,m){m.stream=d,this.trigger("log",m)},Mv=function(d,m){for(var O=Object.keys(m),g=0;g<O.length;g++){var x=O[g];x==="headOfPipeline"||!m[x].on||m[x].on("log",VR.bind(d,x))}},Iv=function(d,m){var O;if(d.length!==m.length)return!1;for(O=0;O<d.length;O++)if(d[O]!==m[O])return!1;return!0},Rv=function(d,m,O,g,x,E){var $=O-m,Q=g-m,F=x-O;return{start:{dts:d,pts:d+$},end:{dts:d+Q,pts:d+F},prependedContentDuration:E,baseMediaDecodeTime:d}};kl=function(d,m){var O=[],g,x=0,E=0,$=1/0;m=m||{},g=m.firstSequenceNumber||0,kl.prototype.init.call(this),this.push=function(Q){Bn.collectDtsInfo(d,Q),d&&Pv.forEach(function(F){d[F]=Q[F]}),O.push(Q)},this.setEarliestDts=function(Q){x=Q},this.setVideoBaseMediaDecodeTime=function(Q){$=Q},this.setAudioAppendStart=function(Q){E=Q},this.flush=function(){var Q,F,U,H,J,de,se;if(O.length===0){this.trigger("done","AudioSegmentStream");return}Q=Zu.trimAdtsFramesByEarliestDts(O,d,x),d.baseMediaDecodeTime=Bn.calculateTrackBaseMediaDecodeTime(d,m.keepOriginalTimestamps),se=Zu.prefixWithSilence(d,Q,E,$),d.samples=Zu.generateSampleTable(Q),U=wl.mdat(Zu.concatenateFrameData(Q)),O=[],F=wl.moof(g,[d]),H=new Uint8Array(F.byteLength+U.byteLength),g++,H.set(F),H.set(U,F.byteLength),Bn.clearDtsInfo(d),J=Math.ceil(FR*1024/d.samplerate),Q.length&&(de=Q.length*J,this.trigger("segmentTimingInfo",Rv(Yu.audioTsToVideoTs(d.baseMediaDecodeTime,d.samplerate),Q[0].dts,Q[0].pts,Q[0].dts+de,Q[0].pts+de,se||0)),this.trigger("timingInfo",{start:Q[0].pts,end:Q[0].pts+de})),this.trigger("data",{track:d,boxes:H}),this.trigger("done","AudioSegmentStream")},this.reset=function(){Bn.clearDtsInfo(d),O=[],this.trigger("reset")}},kl.prototype=new Wu,Gu=function(d,m){var O,g=[],x=[],E,$;m=m||{},O=m.firstSequenceNumber||0,Gu.prototype.init.call(this),delete d.minPTS,this.gopCache_=[],this.push=function(Q){Bn.collectDtsInfo(d,Q),Q.nalUnitType==="seq_parameter_set_rbsp"&&!E&&(E=Q.config,d.sps=[Q.data],Dv.forEach(function(F){d[F]=E[F]},this)),Q.nalUnitType==="pic_parameter_set_rbsp"&&!$&&($=Q.data,d.pps=[Q.data]),g.push(Q)},this.flush=function(){for(var Q,F,U,H,J,de,se=0,Ae,Ne;g.length&&g[0].nalUnitType!=="access_unit_delimiter_rbsp";)g.shift();if(g.length===0){this.resetStream_(),this.trigger("done","VideoSegmentStream");return}if(Q=_l.groupNalsIntoFrames(g),U=_l.groupFramesIntoGops(Q),U[0][0].keyFrame||(F=this.getGopForFusion_(g[0],d),F?(se=F.duration,U.unshift(F),U.byteLength+=F.byteLength,U.nalCount+=F.nalCount,U.pts=F.pts,U.dts=F.dts,U.duration+=F.duration):U=_l.extendFirstKeyFrame(U)),x.length){var Gt;if(m.alignGopsAtEnd?Gt=this.alignGopsAtEnd_(U):Gt=this.alignGopsAtStart_(U),!Gt){this.gopCache_.unshift({gop:U.pop(),pps:d.pps,sps:d.sps}),this.gopCache_.length=Math.min(6,this.gopCache_.length),g=[],this.resetStream_(),this.trigger("done","VideoSegmentStream");return}Bn.clearDtsInfo(d),U=Gt}Bn.collectDtsInfo(d,U),d.samples=_l.generateSampleTable(U),J=wl.mdat(_l.concatenateNalData(U)),d.baseMediaDecodeTime=Bn.calculateTrackBaseMediaDecodeTime(d,m.keepOriginalTimestamps),this.trigger("processedGopsInfo",U.map(function(Zi){return{pts:Zi.pts,dts:Zi.dts,byteLength:Zi.byteLength}})),Ae=U[0],Ne=U[U.length-1],this.trigger("segmentTimingInfo",Rv(d.baseMediaDecodeTime,Ae.dts,Ae.pts,Ne.dts+Ne.duration,Ne.pts+Ne.duration,se)),this.trigger("timingInfo",{start:U[0].pts,end:U[U.length-1].pts+U[U.length-1].duration}),this.gopCache_.unshift({gop:U.pop(),pps:d.pps,sps:d.sps}),this.gopCache_.length=Math.min(6,this.gopCache_.length),g=[],this.trigger("baseMediaDecodeTime",d.baseMediaDecodeTime),this.trigger("timelineStartInfo",d.timelineStartInfo),H=wl.moof(O,[d]),de=new Uint8Array(H.byteLength+J.byteLength),O++,de.set(H),de.set(J,H.byteLength),this.trigger("data",{track:d,boxes:de}),this.resetStream_(),this.trigger("done","VideoSegmentStream")},this.reset=function(){this.resetStream_(),g=[],this.gopCache_.length=0,x.length=0,this.trigger("reset")},this.resetStream_=function(){Bn.clearDtsInfo(d),E=void 0,$=void 0},this.getGopForFusion_=function(Q){var F=45e3,U=1/0,H,J,de,se,Ae;for(Ae=0;Ae<this.gopCache_.length;Ae++)se=this.gopCache_[Ae],de=se.gop,!(!(d.pps&&Iv(d.pps[0],se.pps[0]))||!(d.sps&&Iv(d.sps[0],se.sps[0])))&&(de.dts<d.timelineStartInfo.dts||(H=Q.dts-de.dts-de.duration,H>=-1e4&&H<=F&&(!J||U>H)&&(J=se,U=H)));return J?J.gop:null},this.alignGopsAtStart_=function(Q){var F,U,H,J,de,se,Ae,Ne;for(de=Q.byteLength,se=Q.nalCount,Ae=Q.duration,F=U=0;F<x.length&&U<Q.length&&(H=x[F],J=Q[U],H.pts!==J.pts);){if(J.pts>H.pts){F++;continue}U++,de-=J.byteLength,se-=J.nalCount,Ae-=J.duration}return U===0?Q:U===Q.length?null:(Ne=Q.slice(U),Ne.byteLength=de,Ne.duration=Ae,Ne.nalCount=se,Ne.pts=Ne[0].pts,Ne.dts=Ne[0].dts,Ne)},this.alignGopsAtEnd_=function(Q){var F,U,H,J,de,se;for(F=x.length-1,U=Q.length-1,de=null,se=!1;F>=0&&U>=0;){if(H=x[F],J=Q[U],H.pts===J.pts){se=!0;break}if(H.pts>J.pts){F--;continue}F===x.length-1&&(de=U),U--}if(!se&&de===null)return null;var Ae;if(se?Ae=U:Ae=de,Ae===0)return Q;var Ne=Q.slice(Ae),Gt=Ne.reduce(function(Zi,pr){return Zi.byteLength+=pr.byteLength,Zi.duration+=pr.duration,Zi.nalCount+=pr.nalCount,Zi},{byteLength:0,duration:0,nalCount:0});return Ne.byteLength=Gt.byteLength,Ne.duration=Gt.duration,Ne.nalCount=Gt.nalCount,Ne.pts=Ne[0].pts,Ne.dts=Ne[0].dts,Ne},this.alignGopsWith=function(Q){x=Q}},Gu.prototype=new Wu,Jr=function(d,m){this.numberOfTracks=0,this.metadataStream=m,d=d||{},typeof d.remux<"u"?this.remuxTracks=!!d.remux:this.remuxTracks=!0,typeof d.keepOriginalTimestamps=="boolean"?this.keepOriginalTimestamps=d.keepOriginalTimestamps:this.keepOriginalTimestamps=!1,this.pendingTracks=[],this.videoTrack=null,this.pendingBoxes=[],this.pendingCaptions=[],this.pendingMetadata=[],this.pendingBytes=0,this.emittedTracks=0,Jr.prototype.init.call(this),this.push=function(O){if(O.content||O.text)return this.pendingCaptions.push(O);if(O.frames)return this.pendingMetadata.push(O);this.pendingTracks.push(O.track),this.pendingBytes+=O.boxes.byteLength,O.track.type==="video"&&(this.videoTrack=O.track,this.pendingBoxes.push(O.boxes)),O.track.type==="audio"&&(this.audioTrack=O.track,this.pendingBoxes.unshift(O.boxes))}},Jr.prototype=new Wu,Jr.prototype.flush=function(d){var m=0,O={captions:[],captionStreams:{},metadata:[],info:{}},g,x,E,$=0,Q;if(this.pendingTracks.length<this.numberOfTracks){if(d!=="VideoSegmentStream"&&d!=="AudioSegmentStream")return;if(this.remuxTracks)return;if(this.pendingTracks.length===0){this.emittedTracks++,this.emittedTracks>=this.numberOfTracks&&(this.trigger("done"),this.emittedTracks=0);return}}if(this.videoTrack?($=this.videoTrack.timelineStartInfo.pts,Dv.forEach(function(F){O.info[F]=this.videoTrack[F]},this)):this.audioTrack&&($=this.audioTrack.timelineStartInfo.pts,Pv.forEach(function(F){O.info[F]=this.audioTrack[F]},this)),this.videoTrack||this.audioTrack){for(this.pendingTracks.length===1?O.type=this.pendingTracks[0].type:O.type="combined",this.emittedTracks+=this.pendingTracks.length,E=wl.initSegment(this.pendingTracks),O.initSegment=new Uint8Array(E.byteLength),O.initSegment.set(E),O.data=new Uint8Array(this.pendingBytes),Q=0;Q<this.pendingBoxes.length;Q++)O.data.set(this.pendingBoxes[Q],m),m+=this.pendingBoxes[Q].byteLength;for(Q=0;Q<this.pendingCaptions.length;Q++)g=this.pendingCaptions[Q],g.startTime=Yu.metadataTsToSeconds(g.startPts,$,this.keepOriginalTimestamps),g.endTime=Yu.metadataTsToSeconds(g.endPts,$,this.keepOriginalTimestamps),O.captionStreams[g.stream]=!0,O.captions.push(g);for(Q=0;Q<this.pendingMetadata.length;Q++)x=this.pendingMetadata[Q],x.cueTime=Yu.metadataTsToSeconds(x.pts,$,this.keepOriginalTimestamps),O.metadata.push(x);for(O.metadata.dispatchType=this.metadataStream.dispatchType,this.pendingTracks.length=0,this.videoTrack=null,this.pendingBoxes.length=0,this.pendingCaptions.length=0,this.pendingBytes=0,this.pendingMetadata.length=0,this.trigger("data",O),Q=0;Q<O.captions.length;Q++)g=O.captions[Q],this.trigger("caption",g);for(Q=0;Q<O.metadata.length;Q++)x=O.metadata[Q],this.trigger("id3Frame",x)}this.emittedTracks>=this.numberOfTracks&&(this.trigger("done"),this.emittedTracks=0)},Jr.prototype.setRemux=function(d){this.remuxTracks=d},Ku=function(d){var m=this,O=!0,g,x;Ku.prototype.init.call(this),d=d||{},this.baseMediaDecodeTime=d.baseMediaDecodeTime||0,this.transmuxPipeline_={},this.setupAacPipeline=function(){var E={};this.transmuxPipeline_=E,E.type="aac",E.metadataStream=new js.MetadataStream,E.aacStream=new BR,E.audioTimestampRolloverStream=new js.TimestampRolloverStream("audio"),E.timedMetadataTimestampRolloverStream=new js.TimestampRolloverStream("timed-metadata"),E.adtsStream=new Av,E.coalesceStream=new Jr(d,E.metadataStream),E.headOfPipeline=E.aacStream,E.aacStream.pipe(E.audioTimestampRolloverStream).pipe(E.adtsStream),E.aacStream.pipe(E.timedMetadataTimestampRolloverStream).pipe(E.metadataStream).pipe(E.coalesceStream),E.metadataStream.on("timestamp",function($){E.aacStream.setTimestamp($.timeStamp)}),E.aacStream.on("data",function($){$.type!=="timed-metadata"&&$.type!=="audio"||E.audioSegmentStream||(x=x||{timelineStartInfo:{baseMediaDecodeTime:m.baseMediaDecodeTime},codec:"adts",type:"audio"},E.coalesceStream.numberOfTracks++,E.audioSegmentStream=new kl(x,d),E.audioSegmentStream.on("log",m.getLogTrigger_("audioSegmentStream")),E.audioSegmentStream.on("timingInfo",m.trigger.bind(m,"audioTimingInfo")),E.adtsStream.pipe(E.audioSegmentStream).pipe(E.coalesceStream),m.trigger("trackinfo",{hasAudio:!!x,hasVideo:!!g}))}),E.coalesceStream.on("data",this.trigger.bind(this,"data")),E.coalesceStream.on("done",this.trigger.bind(this,"done")),Mv(this,E)},this.setupTsPipeline=function(){var E={};this.transmuxPipeline_=E,E.type="ts",E.metadataStream=new js.MetadataStream,E.packetStream=new js.TransportPacketStream,E.parseStream=new js.TransportParseStream,E.elementaryStream=new js.ElementaryStream,E.timestampRolloverStream=new js.TimestampRolloverStream,E.adtsStream=new Av,E.h264Stream=new QR,E.captionStream=new js.CaptionStream(d),E.coalesceStream=new Jr(d,E.metadataStream),E.headOfPipeline=E.packetStream,E.packetStream.pipe(E.parseStream).pipe(E.elementaryStream).pipe(E.timestampRolloverStream),E.timestampRolloverStream.pipe(E.h264Stream),E.timestampRolloverStream.pipe(E.adtsStream),E.timestampRolloverStream.pipe(E.metadataStream).pipe(E.coalesceStream),E.h264Stream.pipe(E.captionStream).pipe(E.coalesceStream),E.elementaryStream.on("data",function($){var Q;if($.type==="metadata"){for(Q=$.tracks.length;Q--;)!g&&$.tracks[Q].type==="video"?(g=$.tracks[Q],g.timelineStartInfo.baseMediaDecodeTime=m.baseMediaDecodeTime):!x&&$.tracks[Q].type==="audio"&&(x=$.tracks[Q],x.timelineStartInfo.baseMediaDecodeTime=m.baseMediaDecodeTime);g&&!E.videoSegmentStream&&(E.coalesceStream.numberOfTracks++,E.videoSegmentStream=new Gu(g,d),E.videoSegmentStream.on("log",m.getLogTrigger_("videoSegmentStream")),E.videoSegmentStream.on("timelineStartInfo",function(F){x&&!d.keepOriginalTimestamps&&(x.timelineStartInfo=F,E.audioSegmentStream.setEarliestDts(F.dts-m.baseMediaDecodeTime))}),E.videoSegmentStream.on("processedGopsInfo",m.trigger.bind(m,"gopInfo")),E.videoSegmentStream.on("segmentTimingInfo",m.trigger.bind(m,"videoSegmentTimingInfo")),E.videoSegmentStream.on("baseMediaDecodeTime",function(F){x&&E.audioSegmentStream.setVideoBaseMediaDecodeTime(F)}),E.videoSegmentStream.on("timingInfo",m.trigger.bind(m,"videoTimingInfo")),E.h264Stream.pipe(E.videoSegmentStream).pipe(E.coalesceStream)),x&&!E.audioSegmentStream&&(E.coalesceStream.numberOfTracks++,E.audioSegmentStream=new kl(x,d),E.audioSegmentStream.on("log",m.getLogTrigger_("audioSegmentStream")),E.audioSegmentStream.on("timingInfo",m.trigger.bind(m,"audioTimingInfo")),E.audioSegmentStream.on("segmentTimingInfo",m.trigger.bind(m,"audioSegmentTimingInfo")),E.adtsStream.pipe(E.audioSegmentStream).pipe(E.coalesceStream)),m.trigger("trackinfo",{hasAudio:!!x,hasVideo:!!g})}}),E.coalesceStream.on("data",this.trigger.bind(this,"data")),E.coalesceStream.on("id3Frame",function($){$.dispatchType=E.metadataStream.dispatchType,m.trigger("id3Frame",$)}),E.coalesceStream.on("caption",this.trigger.bind(this,"caption")),E.coalesceStream.on("done",this.trigger.bind(this,"done")),Mv(this,E)},this.setBaseMediaDecodeTime=function(E){var $=this.transmuxPipeline_;d.keepOriginalTimestamps||(this.baseMediaDecodeTime=E),x&&(x.timelineStartInfo.dts=void 0,x.timelineStartInfo.pts=void 0,Bn.clearDtsInfo(x),$.audioTimestampRolloverStream&&$.audioTimestampRolloverStream.discontinuity()),g&&($.videoSegmentStream&&($.videoSegmentStream.gopCache_=[]),g.timelineStartInfo.dts=void 0,g.timelineStartInfo.pts=void 0,Bn.clearDtsInfo(g),$.captionStream.reset()),$.timestampRolloverStream&&$.timestampRolloverStream.discontinuity()},this.setAudioAppendStart=function(E){x&&this.transmuxPipeline_.audioSegmentStream.setAudioAppendStart(E)},this.setRemux=function(E){var $=this.transmuxPipeline_;d.remux=E,$&&$.coalesceStream&&$.coalesceStream.setRemux(E)},this.alignGopsWith=function(E){g&&this.transmuxPipeline_.videoSegmentStream&&this.transmuxPipeline_.videoSegmentStream.alignGopsWith(E)},this.getLogTrigger_=function(E){var $=this;return function(Q){Q.stream=E,$.trigger("log",Q)}},this.push=function(E){if(O){var $=NR(E);$&&this.transmuxPipeline_.type!=="aac"?this.setupAacPipeline():!$&&this.transmuxPipeline_.type!=="ts"&&this.setupTsPipeline(),O=!1}this.transmuxPipeline_.headOfPipeline.push(E)},this.flush=function(){O=!0,this.transmuxPipeline_.headOfPipeline.flush()},this.endTimeline=function(){this.transmuxPipeline_.headOfPipeline.endTimeline()},this.reset=function(){this.transmuxPipeline_.headOfPipeline&&this.transmuxPipeline_.headOfPipeline.reset()},this.resetCaptions=function(){this.transmuxPipeline_.captionStream&&this.transmuxPipeline_.captionStream.reset()}},Ku.prototype=new Wu;var UR={Transmuxer:Ku},qR=function(d){return d>>>0},zR=function(d){return("00"+d.toString(16)).slice(-2)},Ju={toUnsigned:qR,toHexString:zR},jR=function(d){var m="";return m+=String.fromCharCode(d[0]),m+=String.fromCharCode(d[1]),m+=String.fromCharCode(d[2]),m+=String.fromCharCode(d[3]),m},Lv=jR,XR=Ju.toUnsigned,HR=Lv,$v=function(d,m){var O=[],g,x,E,$,Q;if(!m.length)return null;for(g=0;g<d.byteLength;)x=XR(d[g]<<24|d[g+1]<<16|d[g+2]<<8|d[g+3]),E=HR(d.subarray(g+4,g+8)),$=x>1?g+x:d.byteLength,E===m[0]&&(m.length===1?O.push(d.subarray(g+8,$)):(Q=$v(d.subarray(g+8,$),m.slice(1)),Q.length&&(O=O.concat(Q)))),g=$;return O},Qp=$v,WR=Ju.toUnsigned,ZR=r.getUint64,YR=function(d){var m={version:d[0],flags:new Uint8Array(d.subarray(1,4))};return m.version===1?m.baseMediaDecodeTime=ZR(d.subarray(4)):m.baseMediaDecodeTime=WR(d[4]<<24|d[5]<<16|d[6]<<8|d[7]),m},Bp=YR,GR=function(d){var m=new DataView(d.buffer,d.byteOffset,d.byteLength),O={version:d[0],flags:new Uint8Array(d.subarray(1,4)),trackId:m.getUint32(4)},g=O.flags[2]&1,x=O.flags[2]&2,E=O.flags[2]&8,$=O.flags[2]&16,Q=O.flags[2]&32,F=O.flags[0]&65536,U=O.flags[0]&131072,H;return H=8,g&&(H+=4,O.baseDataOffset=m.getUint32(12),H+=4),x&&(O.sampleDescriptionIndex=m.getUint32(H),H+=4),E&&(O.defaultSampleDuration=m.getUint32(H),H+=4),$&&(O.defaultSampleSize=m.getUint32(H),H+=4),Q&&(O.defaultSampleFlags=m.getUint32(H)),F&&(O.durationIsEmpty=!0),!g&&U&&(O.baseDataOffsetIsMoof=!0),O},Qv=GR,KR=function(d){return{isLeading:(d[0]&12)>>>2,dependsOn:d[0]&3,isDependedOn:(d[1]&192)>>>6,hasRedundancy:(d[1]&48)>>>4,paddingValue:(d[1]&14)>>>1,isNonSyncSample:d[1]&1,degradationPriority:d[2]<<8|d[3]}},JR=KR,Bv=JR,eL=function(d){var m={version:d[0],flags:new Uint8Array(d.subarray(1,4)),samples:[]},O=new DataView(d.buffer,d.byteOffset,d.byteLength),g=m.flags[2]&1,x=m.flags[2]&4,E=m.flags[1]&1,$=m.flags[1]&2,Q=m.flags[1]&4,F=m.flags[1]&8,U=O.getUint32(4),H=8,J;for(g&&(m.dataOffset=O.getInt32(H),H+=4),x&&U&&(J={flags:Bv(d.subarray(H,H+4))},H+=4,E&&(J.duration=O.getUint32(H),H+=4),$&&(J.size=O.getUint32(H),H+=4),F&&(m.version===1?J.compositionTimeOffset=O.getInt32(H):J.compositionTimeOffset=O.getUint32(H),H+=4),m.samples.push(J),U--);U--;)J={},E&&(J.duration=O.getUint32(H),H+=4),$&&(J.size=O.getUint32(H),H+=4),Q&&(J.flags=Bv(d.subarray(H,H+4)),H+=4),F&&(m.version===1?J.compositionTimeOffset=O.getInt32(H):J.compositionTimeOffset=O.getUint32(H),H+=4),m.samples.push(J);return m},Nv=eL,Fv={tfdt:Bp,trun:Nv},Vv={parseTfdt:Fv.tfdt,parseTrun:Fv.trun},tL=function(d){for(var m=0,O=String.fromCharCode(d[m]),g="";O!=="\0";)g+=O,m++,O=String.fromCharCode(d[m]);return g+=O,g},iL={uint8ToCString:tL},ec=iL.uint8ToCString,nL=r.getUint64,sL=function(d){var m=4,O=d[0],g,x,E,$,Q,F,U,H;if(O===0){g=ec(d.subarray(m)),m+=g.length,x=ec(d.subarray(m)),m+=x.length;var J=new DataView(d.buffer);E=J.getUint32(m),m+=4,Q=J.getUint32(m),m+=4,F=J.getUint32(m),m+=4,U=J.getUint32(m),m+=4}else if(O===1){var J=new DataView(d.buffer);E=J.getUint32(m),m+=4,$=nL(d.subarray(m)),m+=8,F=J.getUint32(m),m+=4,U=J.getUint32(m),m+=4,g=ec(d.subarray(m)),m+=g.length,x=ec(d.subarray(m)),m+=x.length}H=new Uint8Array(d.subarray(m,d.byteLength));var de={scheme_id_uri:g,value:x,timescale:E||1,presentation_time:$,presentation_time_delta:Q,event_duration:F,id:U,message_data:H};return oL(O,de)?de:void 0},rL=function(d,m,O,g){return d||d===0?d/m:g+O/m},oL=function(d,m){var O=m.scheme_id_uri!=="\0",g=d===0&&Uv(m.presentation_time_delta)&&O,x=d===1&&Uv(m.presentation_time)&&O;return!(d>1)&&g||x},Uv=function(d){return d!==void 0||d!==null},aL={parseEmsgBox:sL,scaleTime:rL},Cl;typeof window<"u"?Cl=window:typeof n<"u"?Cl=n:typeof self<"u"?Cl=self:Cl={};var qv=Cl,tc=Ju.toUnsigned,El=Ju.toHexString,Lt=Qp,Ho=Lv,Np=aL,lL=Qv,hL=Nv,uL=Bp,cL=r.getUint64,zv,jv,Xv,Hv,Wv,Fp,Zv,Vp=qv,dL=bv.parseId3Frames;zv=function(d){var m={},O=Lt(d,["moov","trak"]);return O.reduce(function(g,x){var E,$,Q,F,U;return E=Lt(x,["tkhd"])[0],!E||($=E[0],Q=$===0?12:20,F=tc(E[Q]<<24|E[Q+1]<<16|E[Q+2]<<8|E[Q+3]),U=Lt(x,["mdia","mdhd"])[0],!U)?null:($=U[0],Q=$===0?12:20,g[F]=tc(U[Q]<<24|U[Q+1]<<16|U[Q+2]<<8|U[Q+3]),g)},m)},jv=function(d,m){var O;O=Lt(m,["moof","traf"]);var g=O.reduce(function(x,E){var $=Lt(E,["tfhd"])[0],Q=tc($[4]<<24|$[5]<<16|$[6]<<8|$[7]),F=d[Q]||9e4,U=Lt(E,["tfdt"])[0],H=new DataView(U.buffer,U.byteOffset,U.byteLength),J;U[0]===1?J=cL(U.subarray(4,12)):J=H.getUint32(4);let de;return typeof J=="bigint"?de=J/Vp.BigInt(F):typeof J=="number"&&!isNaN(J)&&(de=J/F),de<Number.MAX_SAFE_INTEGER&&(de=Number(de)),de<x&&(x=de),x},1/0);return typeof g=="bigint"||isFinite(g)?g:0},Xv=function(d,m){var O=Lt(m,["moof","traf"]),g=0,x=0,E;if(O&&O.length){var $=Lt(O[0],["tfhd"])[0],Q=Lt(O[0],["trun"])[0],F=Lt(O[0],["tfdt"])[0];if($){var U=lL($);E=U.trackId}if(F){var H=uL(F);g=H.baseMediaDecodeTime}if(Q){var J=hL(Q);J.samples&&J.samples.length&&(x=J.samples[0].compositionTimeOffset||0)}}var de=d[E]||9e4;typeof g=="bigint"&&(x=Vp.BigInt(x),de=Vp.BigInt(de));var se=(g+x)/de;return typeof se=="bigint"&&se<Number.MAX_SAFE_INTEGER&&(se=Number(se)),se},Hv=function(d){var m=Lt(d,["moov","trak"]),O=[];return m.forEach(function(g){var x=Lt(g,["mdia","hdlr"]),E=Lt(g,["tkhd"]);x.forEach(function($,Q){var F=Ho($.subarray(8,12)),U=E[Q],H,J,de;F==="vide"&&(H=new DataView(U.buffer,U.byteOffset,U.byteLength),J=H.getUint8(0),de=J===0?H.getUint32(12):H.getUint32(20),O.push(de))})}),O},Fp=function(d){var m=d[0],O=m===0?12:20;return tc(d[O]<<24|d[O+1]<<16|d[O+2]<<8|d[O+3])},Wv=function(d){var m=Lt(d,["moov","trak"]),O=[];return m.forEach(function(g){var x={},E=Lt(g,["tkhd"])[0],$,Q;E&&($=new DataView(E.buffer,E.byteOffset,E.byteLength),Q=$.getUint8(0),x.id=Q===0?$.getUint32(12):$.getUint32(20));var F=Lt(g,["mdia","hdlr"])[0];if(F){var U=Ho(F.subarray(8,12));U==="vide"?x.type="video":U==="soun"?x.type="audio":x.type=U}var H=Lt(g,["mdia","minf","stbl","stsd"])[0];if(H){var J=H.subarray(8);x.codec=Ho(J.subarray(4,8));var de=Lt(J,[x.codec])[0],se,Ae;de&&(/^[asm]vc[1-9]$/i.test(x.codec)?(se=de.subarray(78),Ae=Ho(se.subarray(4,8)),Ae==="avcC"&&se.length>11?(x.codec+=".",x.codec+=El(se[9]),x.codec+=El(se[10]),x.codec+=El(se[11])):x.codec="avc1.4d400d"):/^mp4[a,v]$/i.test(x.codec)?(se=de.subarray(28),Ae=Ho(se.subarray(4,8)),Ae==="esds"&&se.length>20&&se[19]!==0?(x.codec+="."+El(se[19]),x.codec+="."+El(se[20]>>>2&63).replace(/^0/,"")):x.codec="mp4a.40.2"):x.codec=x.codec.toLowerCase())}var Ne=Lt(g,["mdia","mdhd"])[0];Ne&&(x.timescale=Fp(Ne)),O.push(x)}),O},Zv=function(d,m=0){var O=Lt(d,["emsg"]);return O.map(g=>{var x=Np.parseEmsgBox(new Uint8Array(g)),E=dL(x.message_data);return{cueTime:Np.scaleTime(x.presentation_time,x.timescale,x.presentation_time_delta,m),duration:Np.scaleTime(x.event_duration,x.timescale),frames:E}})};var Al={findBox:Lt,parseType:Ho,timescale:zv,startTime:jv,compositionStartTime:Xv,videoTrackIds:Hv,tracks:Wv,getTimescaleFromMediaHeader:Fp,getEmsgID3:Zv};const{parseTrun:fL}=Vv,{findBox:Yv}=Al;var Gv=qv,pL=function(d){var m=Yv(d,["moof","traf"]),O=Yv(d,["mdat"]),g=[];return O.forEach(function(x,E){var $=m[E];g.push({mdat:x,traf:$})}),g},mL=function(d,m,O){var g=m,x=O.defaultSampleDuration||0,E=O.defaultSampleSize||0,$=O.trackId,Q=[];return d.forEach(function(F){var U=fL(F),H=U.samples;H.forEach(function(J){J.duration===void 0&&(J.duration=x),J.size===void 0&&(J.size=E),J.trackId=$,J.dts=g,J.compositionTimeOffset===void 0&&(J.compositionTimeOffset=0),typeof g=="bigint"?(J.pts=g+Gv.BigInt(J.compositionTimeOffset),g+=Gv.BigInt(J.duration)):(J.pts=g+J.compositionTimeOffset,g+=J.duration)}),Q=Q.concat(H)}),Q},Kv={getMdatTrafPairs:pL,parseSamples:mL},gL=Me.discardEmulationPreventionBytes,OL=Bu.CaptionStream,Up=Qp,yL=Bp,bL=Qv,{getMdatTrafPairs:vL,parseSamples:SL}=Kv,xL=function(d,m){for(var O=d,g=0;g<m.length;g++){var x=m[g];if(O<x.size)return x;O-=x.size}return null},TL=function(d,m,O){var g=new DataView(d.buffer,d.byteOffset,d.byteLength),x={logs:[],seiNals:[]},E,$,Q,F;for($=0;$+4<d.length;$+=Q)if(Q=g.getUint32($),$+=4,!(Q<=0))switch(d[$]&31){case 6:var U=d.subarray($+1,$+1+Q),H=xL($,m);if(E={nalUnitType:"sei_rbsp",size:Q,data:U,escapedRBSP:gL(U),trackId:O},H)E.pts=H.pts,E.dts=H.dts,F=H;else if(F)E.pts=F.pts,E.dts=F.dts;else{x.logs.push({level:"warn",message:"We've encountered a nal unit without data at "+$+" for trackId "+O+". See mux.js#223."});break}x.seiNals.push(E);break}return x},wL=function(d,m){var O={},g=vL(d);return g.forEach(function(x){var E=x.mdat,$=x.traf,Q=Up($,["tfhd"]),F=bL(Q[0]),U=F.trackId,H=Up($,["tfdt"]),J=H.length>0?yL(H[0]).baseMediaDecodeTime:0,de=Up($,["trun"]),se,Ae;m===U&&de.length>0&&(se=SL(de,J,F),Ae=TL(E,se,U),O[U]||(O[U]={seiNals:[],logs:[]}),O[U].seiNals=O[U].seiNals.concat(Ae.seiNals),O[U].logs=O[U].logs.concat(Ae.logs))}),O},_L=function(d,m,O){var g;if(m===null)return null;g=wL(d,m);var x=g[m]||{};return{seiNals:x.seiNals,logs:x.logs,timescale:O}},kL=function(){var d=!1,m,O,g,x,E,$;this.isInitialized=function(){return d},this.init=function(Q){m=new OL,d=!0,$=Q?Q.isPartial:!1,m.on("data",function(F){F.startTime=F.startPts/x,F.endTime=F.endPts/x,E.captions.push(F),E.captionStreams[F.stream]=!0}),m.on("log",function(F){E.logs.push(F)})},this.isNewInit=function(Q,F){return Q&&Q.length===0||F&&typeof F=="object"&&Object.keys(F).length===0?!1:g!==Q[0]||x!==F[g]},this.parse=function(Q,F,U){var H;if(this.isInitialized()){if(!F||!U)return null;if(this.isNewInit(F,U))g=F[0],x=U[g];else if(g===null||!x)return O.push(Q),null}else return null;for(;O.length>0;){var J=O.shift();this.parse(J,F,U)}return H=_L(Q,g,x),H&&H.logs&&(E.logs=E.logs.concat(H.logs)),H===null||!H.seiNals?E.logs.length?{logs:E.logs,captions:[],captionStreams:[]}:null:(this.pushNals(H.seiNals),this.flushStream(),E)},this.pushNals=function(Q){if(!this.isInitialized()||!Q||Q.length===0)return null;Q.forEach(function(F){m.push(F)})},this.flushStream=function(){if(!this.isInitialized())return null;$?m.partialFlush():m.flush()},this.clearParsedCaptions=function(){E.captions=[],E.captionStreams={},E.logs=[]},this.resetCaptionStream=function(){if(!this.isInitialized())return null;m.reset()},this.clearAllCaptions=function(){this.clearParsedCaptions(),this.resetCaptionStream()},this.reset=function(){O=[],g=null,x=null,E?this.clearParsedCaptions():E={captions:[],captionStreams:{},logs:[]},this.resetCaptionStream()},this.reset()},CL=kL;const{parseTfdt:EL}=Vv,fr=Qp,{getTimescaleFromMediaHeader:AL}=Al,{parseSamples:PL,getMdatTrafPairs:DL}=Kv;var Jv=function(){let d=9e4;this.init=function(m){const O=fr(m,["moov","trak","mdia","mdhd"])[0];O&&(d=AL(O))},this.parseSegment=function(m){const O=[],g=DL(m);let x=0;return g.forEach(function(E){const $=E.mdat,Q=E.traf,F=fr(Q,["tfdt"])[0],U=fr(Q,["tfhd"])[0],H=fr(Q,["trun"]);if(F&&(x=EL(F).baseMediaDecodeTime),H.length&&U){const J=PL(H,x,U);let de=0;J.forEach(function(se){const Ae="utf-8",Ne=new TextDecoder(Ae),Gt=$.slice(de,de+se.size);if(fr(Gt,["vtte"])[0]){de+=se.size;return}fr(Gt,["vttc"]).forEach(function(Pl){const Dl=fr(Pl,["payl"])[0],Ml=fr(Pl,["sttg"])[0],Il=se.pts/d,sc=(se.pts+se.duration)/d;let gt,Rl;if(Dl)try{gt=Ne.decode(Dl)}catch(Nn){console.error(Nn)}if(Ml)try{Rl=Ne.decode(Ml)}catch(Nn){console.error(Nn)}se.duration&&gt&&O.push({cueText:gt,start:Il,end:sc,settings:Rl})}),de+=se.size})}}),O}},qp=jo,e1=function(d){var m=d[1]&31;return m<<=8,m|=d[2],m},ic=function(d){return!!(d[1]&64)},nc=function(d){var m=0;return(d[3]&48)>>>4>1&&(m+=d[4]+1),m},ML=function(d,m){var O=e1(d);return O===0?"pat":O===m?"pmt":m?"pes":null},IL=function(d){var m=ic(d),O=4+nc(d);return m&&(O+=d[O]+1),(d[O+10]&31)<<8|d[O+11]},RL=function(d){var m={},O=ic(d),g=4+nc(d);if(O&&(g+=d[g]+1),!!(d[g+5]&1)){var x,E,$;x=(d[g+1]&15)<<8|d[g+2],E=3+x-4,$=(d[g+10]&15)<<8|d[g+11];for(var Q=12+$;Q<E;){var F=g+Q;m[(d[F+1]&31)<<8|d[F+2]]=d[F],Q+=((d[F+3]&15)<<8|d[F+4])+5}return m}},LL=function(d,m){var O=e1(d),g=m[O];switch(g){case qp.H264_STREAM_TYPE:return"video";case qp.ADTS_STREAM_TYPE:return"audio";case qp.METADATA_STREAM_TYPE:return"timed-metadata";default:return null}},$L=function(d){var m=ic(d);if(!m)return null;var O=4+nc(d);if(O>=d.byteLength)return null;var g=null,x;return x=d[O+7],x&192&&(g={},g.pts=(d[O+9]&14)<<27|(d[O+10]&255)<<20|(d[O+11]&254)<<12|(d[O+12]&255)<<5|(d[O+13]&254)>>>3,g.pts*=4,g.pts+=(d[O+13]&6)>>>1,g.dts=g.pts,x&64&&(g.dts=(d[O+14]&14)<<27|(d[O+15]&255)<<20|(d[O+16]&254)<<12|(d[O+17]&255)<<5|(d[O+18]&254)>>>3,g.dts*=4,g.dts+=(d[O+18]&6)>>>1)),g},zp=function(d){switch(d){case 5:return"slice_layer_without_partitioning_rbsp_idr";case 6:return"sei_rbsp";case 7:return"seq_parameter_set_rbsp";case 8:return"pic_parameter_set_rbsp";case 9:return"access_unit_delimiter_rbsp";default:return null}},QL=function(d){for(var m=4+nc(d),O=d.subarray(m),g=0,x=0,E=!1,$;x<O.byteLength-3;x++)if(O[x+2]===1){g=x+5;break}for(;g<O.byteLength;)switch(O[g]){case 0:if(O[g-1]!==0){g+=2;break}else if(O[g-2]!==0){g++;break}x+3!==g-2&&($=zp(O[x+3]&31),$==="slice_layer_without_partitioning_rbsp_idr"&&(E=!0));do g++;while(O[g]!==1&&g<O.length);x=g-2,g+=3;break;case 1:if(O[g-1]!==0||O[g-2]!==0){g+=3;break}$=zp(O[x+3]&31),$==="slice_layer_without_partitioning_rbsp_idr"&&(E=!0),x=g-2,g+=3;break;default:g+=3;break}return O=O.subarray(x),g-=x,x=0,O&&O.byteLength>3&&($=zp(O[x+3]&31),$==="slice_layer_without_partitioning_rbsp_idr"&&(E=!0)),E},BL={parseType:ML,parsePat:IL,parsePmt:RL,parsePayloadUnitStartIndicator:ic,parsePesType:LL,parsePesTime:$L,videoPacketContainsKeyFrame:QL},t1=jo,Wo=Ov.handleRollover,it={};it.ts=BL,it.aac=$p;var eo=He.ONE_SECOND_IN_TS,_i=188,es=71,NL=function(d,m){for(var O=0,g=_i,x,E;g<d.byteLength;){if(d[O]===es&&d[g]===es){switch(x=d.subarray(O,g),E=it.ts.parseType(x,m.pid),E){case"pat":m.pid=it.ts.parsePat(x);break;case"pmt":var $=it.ts.parsePmt(x);m.table=m.table||{},Object.keys($).forEach(function(Q){m.table[Q]=$[Q]});break}O+=_i,g+=_i;continue}O++,g++}},i1=function(d,m,O){for(var g=0,x=_i,E,$,Q,F,U,H=!1;x<=d.byteLength;){if(d[g]===es&&(d[x]===es||x===d.byteLength)){switch(E=d.subarray(g,x),$=it.ts.parseType(E,m.pid),$){case"pes":Q=it.ts.parsePesType(E,m.table),F=it.ts.parsePayloadUnitStartIndicator(E),Q==="audio"&&F&&(U=it.ts.parsePesTime(E),U&&(U.type="audio",O.audio.push(U),H=!0));break}if(H)break;g+=_i,x+=_i;continue}g++,x++}for(x=d.byteLength,g=x-_i,H=!1;g>=0;){if(d[g]===es&&(d[x]===es||x===d.byteLength)){switch(E=d.subarray(g,x),$=it.ts.parseType(E,m.pid),$){case"pes":Q=it.ts.parsePesType(E,m.table),F=it.ts.parsePayloadUnitStartIndicator(E),Q==="audio"&&F&&(U=it.ts.parsePesTime(E),U&&(U.type="audio",O.audio.push(U),H=!0));break}if(H)break;g-=_i,x-=_i;continue}g--,x--}},FL=function(d,m,O){for(var g=0,x=_i,E,$,Q,F,U,H,J,de,se=!1,Ae={data:[],size:0};x<d.byteLength;){if(d[g]===es&&d[x]===es){switch(E=d.subarray(g,x),$=it.ts.parseType(E,m.pid),$){case"pes":if(Q=it.ts.parsePesType(E,m.table),F=it.ts.parsePayloadUnitStartIndicator(E),Q==="video"&&(F&&!se&&(U=it.ts.parsePesTime(E),U&&(U.type="video",O.video.push(U),se=!0)),!O.firstKeyFrame)){if(F&&Ae.size!==0){for(H=new Uint8Array(Ae.size),J=0;Ae.data.length;)de=Ae.data.shift(),H.set(de,J),J+=de.byteLength;if(it.ts.videoPacketContainsKeyFrame(H)){var Ne=it.ts.parsePesTime(H);Ne?(O.firstKeyFrame=Ne,O.firstKeyFrame.type="video"):console.warn("Failed to extract PTS/DTS from PES at first keyframe. This could be an unusual TS segment, or else mux.js did not parse your TS segment correctly. If you know your TS segments do contain PTS/DTS on keyframes please file a bug report! You can try ffprobe to double check for yourself.")}Ae.size=0}Ae.data.push(E),Ae.size+=E.byteLength}break}if(se&&O.firstKeyFrame)break;g+=_i,x+=_i;continue}g++,x++}for(x=d.byteLength,g=x-_i,se=!1;g>=0;){if(d[g]===es&&d[x]===es){switch(E=d.subarray(g,x),$=it.ts.parseType(E,m.pid),$){case"pes":Q=it.ts.parsePesType(E,m.table),F=it.ts.parsePayloadUnitStartIndicator(E),Q==="video"&&F&&(U=it.ts.parsePesTime(E),U&&(U.type="video",O.video.push(U),se=!0));break}if(se)break;g-=_i,x-=_i;continue}g--,x--}},VL=function(d,m){if(d.audio&&d.audio.length){var O=m;(typeof O>"u"||isNaN(O))&&(O=d.audio[0].dts),d.audio.forEach(function(E){E.dts=Wo(E.dts,O),E.pts=Wo(E.pts,O),E.dtsTime=E.dts/eo,E.ptsTime=E.pts/eo})}if(d.video&&d.video.length){var g=m;if((typeof g>"u"||isNaN(g))&&(g=d.video[0].dts),d.video.forEach(function(E){E.dts=Wo(E.dts,g),E.pts=Wo(E.pts,g),E.dtsTime=E.dts/eo,E.ptsTime=E.pts/eo}),d.firstKeyFrame){var x=d.firstKeyFrame;x.dts=Wo(x.dts,g),x.pts=Wo(x.pts,g),x.dtsTime=x.dts/eo,x.ptsTime=x.pts/eo}}},UL=function(d){for(var m=!1,O=0,g=null,x=null,E=0,$=0,Q;d.length-$>=3;){var F=it.aac.parseType(d,$);switch(F){case"timed-metadata":if(d.length-$<10){m=!0;break}if(E=it.aac.parseId3TagSize(d,$),E>d.length){m=!0;break}x===null&&(Q=d.subarray($,$+E),x=it.aac.parseAacTimestamp(Q)),$+=E;break;case"audio":if(d.length-$<7){m=!0;break}if(E=it.aac.parseAdtsSize(d,$),E>d.length){m=!0;break}g===null&&(Q=d.subarray($,$+E),g=it.aac.parseSampleRate(Q)),O++,$+=E;break;default:$++;break}if(m)return null}if(g===null||x===null)return null;var U=eo/g,H={audio:[{type:"audio",dts:x,pts:x},{type:"audio",dts:x+O*1024*U,pts:x+O*1024*U}]};return H},qL=function(d){var m={pid:null,table:null},O={};NL(d,m);for(var g in m.table)if(m.table.hasOwnProperty(g)){var x=m.table[g];switch(x){case t1.H264_STREAM_TYPE:O.video=[],FL(d,m,O),O.video.length===0&&delete O.video;break;case t1.ADTS_STREAM_TYPE:O.audio=[],i1(d,m,O),O.audio.length===0&&delete O.audio;break}}return O},zL=function(d,m){var O=it.aac.isLikelyAacData(d),g;return O?g=UL(d):g=qL(d),!g||!g.audio&&!g.video?null:(VL(g,m),g)},jL={inspect:zL,parseAudioPes_:i1};const XL=function(d,m){m.on("data",function(O){const g=O.initSegment;O.initSegment={data:g.buffer,byteOffset:g.byteOffset,byteLength:g.byteLength};const x=O.data;O.data=x.buffer,d.postMessage({action:"data",segment:O,byteOffset:x.byteOffset,byteLength:x.byteLength},[O.data])}),m.on("done",function(O){d.postMessage({action:"done"})}),m.on("gopInfo",function(O){d.postMessage({action:"gopInfo",gopInfo:O})}),m.on("videoSegmentTimingInfo",function(O){const g={start:{decode:He.videoTsToSeconds(O.start.dts),presentation:He.videoTsToSeconds(O.start.pts)},end:{decode:He.videoTsToSeconds(O.end.dts),presentation:He.videoTsToSeconds(O.end.pts)},baseMediaDecodeTime:He.videoTsToSeconds(O.baseMediaDecodeTime)};O.prependedContentDuration&&(g.prependedContentDuration=He.videoTsToSeconds(O.prependedContentDuration)),d.postMessage({action:"videoSegmentTimingInfo",videoSegmentTimingInfo:g})}),m.on("audioSegmentTimingInfo",function(O){const g={start:{decode:He.videoTsToSeconds(O.start.dts),presentation:He.videoTsToSeconds(O.start.pts)},end:{decode:He.videoTsToSeconds(O.end.dts),presentation:He.videoTsToSeconds(O.end.pts)},baseMediaDecodeTime:He.videoTsToSeconds(O.baseMediaDecodeTime)};O.prependedContentDuration&&(g.prependedContentDuration=He.videoTsToSeconds(O.prependedContentDuration)),d.postMessage({action:"audioSegmentTimingInfo",audioSegmentTimingInfo:g})}),m.on("id3Frame",function(O){d.postMessage({action:"id3Frame",id3Frame:O})}),m.on("caption",function(O){d.postMessage({action:"caption",caption:O})}),m.on("trackinfo",function(O){d.postMessage({action:"trackinfo",trackInfo:O})}),m.on("audioTimingInfo",function(O){d.postMessage({action:"audioTimingInfo",audioTimingInfo:{start:He.videoTsToSeconds(O.start),end:He.videoTsToSeconds(O.end)}})}),m.on("videoTimingInfo",function(O){d.postMessage({action:"videoTimingInfo",videoTimingInfo:{start:He.videoTsToSeconds(O.start),end:He.videoTsToSeconds(O.end)}})}),m.on("log",function(O){d.postMessage({action:"log",log:O})})};class n1{constructor(m,O){this.options=O||{},this.self=m,this.init()}init(){this.transmuxer&&this.transmuxer.dispose(),this.transmuxer=new UR.Transmuxer(this.options),XL(this.self,this.transmuxer)}pushMp4Captions(m){this.captionParser||(this.captionParser=new CL,this.captionParser.init());const O=new Uint8Array(m.data,m.byteOffset,m.byteLength),g=this.captionParser.parse(O,m.trackIds,m.timescales);this.self.postMessage({action:"mp4Captions",captions:g&&g.captions||[],logs:g&&g.logs||[],data:O.buffer},[O.buffer])}initMp4WebVttParser(m){this.webVttParser||(this.webVttParser=new Jv);const O=new Uint8Array(m.data,m.byteOffset,m.byteLength);this.webVttParser.init(O)}getMp4WebVttText(m){this.webVttParser||(this.webVttParser=new Jv);const O=new Uint8Array(m.data,m.byteOffset,m.byteLength),g=this.webVttParser.parseSegment(O);this.self.postMessage({action:"getMp4WebVttText",mp4VttCues:g||[],data:O.buffer},[O.buffer])}probeMp4StartTime({timescales:m,data:O}){const g=Al.startTime(m,O);this.self.postMessage({action:"probeMp4StartTime",startTime:g,data:O},[O.buffer])}probeMp4Tracks({data:m}){const O=Al.tracks(m);this.self.postMessage({action:"probeMp4Tracks",tracks:O,data:m},[m.buffer])}probeEmsgID3({data:m,offset:O}){const g=Al.getEmsgID3(m,O);this.self.postMessage({action:"probeEmsgID3",id3Frames:g,emsgData:m},[m.buffer])}probeTs({data:m,baseStartTime:O}){const g=typeof O=="number"&&!isNaN(O)?O*He.ONE_SECOND_IN_TS:void 0,x=jL.inspect(m,g);let E=null;x&&(E={hasVideo:x.video&&x.video.length===2||!1,hasAudio:x.audio&&x.audio.length===2||!1},E.hasVideo&&(E.videoStart=x.video[0].ptsTime),E.hasAudio&&(E.audioStart=x.audio[0].ptsTime)),this.self.postMessage({action:"probeTs",result:E,data:m},[m.buffer])}clearAllMp4Captions(){this.captionParser&&this.captionParser.clearAllCaptions()}clearParsedMp4Captions(){this.captionParser&&this.captionParser.clearParsedCaptions()}push(m){const O=new Uint8Array(m.data,m.byteOffset,m.byteLength);this.transmuxer.push(O)}reset(){this.transmuxer.reset()}setTimestampOffset(m){const O=m.timestampOffset||0;this.transmuxer.setBaseMediaDecodeTime(Math.round(He.secondsToVideoTs(O)))}setAudioAppendStart(m){this.transmuxer.setAudioAppendStart(Math.ceil(He.secondsToVideoTs(m.appendStart)))}setRemux(m){this.transmuxer.setRemux(m.remux)}flush(m){this.transmuxer.flush(),self.postMessage({action:"done",type:"transmuxed"})}endTimeline(){this.transmuxer.endTimeline(),self.postMessage({action:"endedtimeline",type:"transmuxed"})}alignGopsWith(m){this.transmuxer.alignGopsWith(m.gopsToAlignWith.slice())}}self.onmessage=function(d){if(d.data.action==="init"&&d.data.options){this.messageHandlers=new n1(self,d.data.options);return}this.messageHandlers||(this.messageHandlers=new n1(self)),d.data&&d.data.action&&d.data.action!=="init"&&this.messageHandlers[d.data.action]&&this.messageHandlers[d.data.action](d.data)}}));var M8=MC(D8);const I8=(n,e,t)=>{const{type:i,initSegment:s,captions:r,captionStreams:o,metadata:a,videoFrameDtsTime:l,videoFramePtsTime:h}=n.data.segment;e.buffer.push({captions:r,captionStreams:o,metadata:a});const u=n.data.segment.boxes||{data:n.data.segment.data},c={type:i,data:new Uint8Array(u.data,u.data.byteOffset,u.data.byteLength),initSegment:new Uint8Array(s.data,s.byteOffset,s.byteLength)};typeof l<"u"&&(c.videoFrameDtsTime=l),typeof h<"u"&&(c.videoFramePtsTime=h),t(c)},R8=({transmuxedData:n,callback:e})=>{n.buffer=[],e(n)},L8=(n,e)=>{e.gopInfo=n.data.gopInfo},LC=n=>{const{transmuxer:e,bytes:t,audioAppendStart:i,gopsToAlignWith:s,remux:r,onData:o,onTrackInfo:a,onAudioTimingInfo:l,onVideoTimingInfo:h,onVideoSegmentTimingInfo:u,onAudioSegmentTimingInfo:c,onId3:f,onCaptions:p,onDone:b,onEndedTimeline:y,onTransmuxerLog:_,isEndOfTimeline:T,segment:w,triggerSegmentEventFn:v}=n,S={buffer:[]};let k=T;const A=B=>{e.currentTransmux===n&&(B.data.action==="data"&&I8(B,S,o),B.data.action==="trackinfo"&&a(B.data.trackInfo),B.data.action==="gopInfo"&&L8(B,S),B.data.action==="audioTimingInfo"&&l(B.data.audioTimingInfo),B.data.action==="videoTimingInfo"&&h(B.data.videoTimingInfo),B.data.action==="videoSegmentTimingInfo"&&u(B.data.videoSegmentTimingInfo),B.data.action==="audioSegmentTimingInfo"&&c(B.data.audioSegmentTimingInfo),B.data.action==="id3Frame"&&f([B.data.id3Frame],B.data.id3Frame.dispatchType),B.data.action==="caption"&&p(B.data.caption),B.data.action==="endedtimeline"&&(k=!1,y()),B.data.action==="log"&&_(B.data.log),B.data.type==="transmuxed"&&(k||(e.onmessage=null,R8({transmuxedData:S,callback:b}),$C(e))))},M=()=>{const B={message:"Received an error message from the transmuxer worker",metadata:{errorType:Y.Error.StreamingFailedToTransmuxSegment,segmentInfo:uo({segment:w})}};b(null,B)};if(e.onmessage=A,e.onerror=M,i&&e.postMessage({action:"setAudioAppendStart",appendStart:i}),Array.isArray(s)&&e.postMessage({action:"alignGopsWith",gopsToAlignWith:s}),typeof r<"u"&&e.postMessage({action:"setRemux",remux:r}),t.byteLength){const B=t instanceof ArrayBuffer?t:t.buffer,P=t instanceof ArrayBuffer?0:t.byteOffset;v({type:"segmenttransmuxingstart",segment:w}),e.postMessage({action:"push",data:B,byteOffset:P,byteLength:t.byteLength},[B])}T&&e.postMessage({action:"endTimeline"}),e.postMessage({action:"flush"})},$C=n=>{n.currentTransmux=null,n.transmuxQueue.length&&(n.currentTransmux=n.transmuxQueue.shift(),typeof n.currentTransmux=="function"?n.currentTransmux():LC(n.currentTransmux))},LS=(n,e)=>{n.postMessage({action:e}),$C(n)},QC=(n,e)=>{if(!e.currentTransmux){e.currentTransmux=n,LS(e,n);return}e.transmuxQueue.push(LS.bind(null,e,n))},$8=n=>{QC("reset",n)},Q8=n=>{QC("endTimeline",n)},BC=n=>{if(!n.transmuxer.currentTransmux){n.transmuxer.currentTransmux=n,LC(n);return}n.transmuxer.transmuxQueue.push(n)},B8=n=>{const e=new M8;e.currentTransmux=null,e.transmuxQueue=[];const t=e.terminate;return e.terminate=()=>(e.currentTransmux=null,e.transmuxQueue.length=0,t.call(e)),e.postMessage({action:"init",options:n}),e};var wm={reset:$8,endTimeline:Q8,transmux:BC,createTransmuxer:B8};const va=function(n){const e=n.transmuxer,t=n.endAction||n.action,i=n.callback,s=Nt({},n,{endAction:null,transmuxer:null,callback:null}),r=o=>{o.data.action===t&&(e.removeEventListener("message",r),o.data.data&&(o.data.data=new Uint8Array(o.data.data,n.byteOffset||0,n.byteLength||o.data.data.byteLength),n.data&&(n.data=o.data.data)),i(o.data))};if(e.addEventListener("message",r),n.data){const o=n.data instanceof ArrayBuffer;s.byteOffset=o?0:n.data.byteOffset,s.byteLength=n.data.byteLength;const a=[o?n.data:n.data.buffer];e.postMessage(s,a)}else e.postMessage(s)},ys={FAILURE:2,TIMEOUT:-101,ABORTED:-102},NC="wvtt",o0=n=>{n.forEach(e=>{e.abort()})},N8=n=>({bandwidth:n.bandwidth,bytesReceived:n.bytesReceived||0,roundTripTime:n.roundTripTime||0}),F8=n=>{const e=n.target,i={bandwidth:1/0,bytesReceived:0,roundTripTime:Date.now()-e.requestTime||0};return i.bytesReceived=n.loaded,i.bandwidth=Math.floor(i.bytesReceived/i.roundTripTime*8*1e3),i},lb=(n,e)=>{const{requestType:t}=e,i=Eo({requestType:t,request:e,error:n});return e.timedout?{status:e.status,message:"HLS request timed-out at URL: "+e.uri,code:ys.TIMEOUT,xhr:e,metadata:i}:e.aborted?{status:e.status,message:"HLS request aborted at URL: "+e.uri,code:ys.ABORTED,xhr:e,metadata:i}:n?{status:e.status,message:"HLS request errored at URL: "+e.uri,code:ys.FAILURE,xhr:e,metadata:i}:e.responseType==="arraybuffer"&&e.response.byteLength===0?{status:e.status,message:"Empty HLS response at URL: "+e.uri,code:ys.FAILURE,xhr:e,metadata:i}:null},$S=(n,e,t,i)=>(s,r)=>{const o=r.response,a=lb(s,r);if(a)return t(a,n);if(o.byteLength!==16)return t({status:r.status,message:"Invalid HLS key at URL: "+r.uri,code:ys.FAILURE,xhr:r},n);const l=new DataView(o),h=new Uint32Array([l.getUint32(0),l.getUint32(4),l.getUint32(8),l.getUint32(12)]);for(let c=0;c<e.length;c++)e[c].bytes=h;const u={uri:r.uri};return i({type:"segmentkeyloadcomplete",segment:n,keyInfo:u}),t(null,n)},V8=(n,e)=>{e===NC&&n.transmuxer.postMessage({action:"initMp4WebVttParser",data:n.map.bytes})},U8=(n,e,t)=>{e===NC&&va({action:"getMp4WebVttText",data:n.bytes,transmuxer:n.transmuxer,callback:({data:i,mp4VttCues:s})=>{n.bytes=i,t(null,n,{mp4VttCues:s})}})},FC=(n,e)=>{const t=Dy(n.map.bytes);if(t!=="mp4"){const i=n.map.resolvedUri||n.map.uri,s=t||"unknown";return e({internal:!0,message:`Found unsupported ${s} container for initialization segment at URL: ${i}`,code:ys.FAILURE,metadata:{mediaType:s}})}va({action:"probeMp4Tracks",data:n.map.bytes,transmuxer:n.transmuxer,callback:({tracks:i,data:s})=>(n.map.bytes=s,i.forEach(function(r){n.map.tracks=n.map.tracks||{},!n.map.tracks[r.type]&&(n.map.tracks[r.type]=r,typeof r.id=="number"&&r.timescale&&(n.map.timescales=n.map.timescales||{},n.map.timescales[r.id]=r.timescale),r.type==="text"&&V8(n,r.codec))}),e(null))})},q8=({segment:n,finishProcessingFn:e,triggerSegmentEventFn:t})=>(i,s)=>{const r=lb(i,s);if(r)return e(r,n);const o=new Uint8Array(s.response);if(t({type:"segmentloaded",segment:n}),n.map.key)return n.map.encryptedBytes=o,e(null,n);n.map.bytes=o,FC(n,function(a){if(a)return a.xhr=s,a.status=s.status,e(a,n);e(null,n)})},z8=({segment:n,finishProcessingFn:e,responseType:t,triggerSegmentEventFn:i})=>(s,r)=>{const o=lb(s,r);if(o)return e(o,n);i({type:"segmentloaded",segment:n});const a=t==="arraybuffer"||!r.responseText?r.response:A8(r.responseText.substring(n.lastReachedChar||0));return n.stats=N8(r),n.key?n.encryptedBytes=new Uint8Array(a):n.bytes=new Uint8Array(a),e(null,n)},j8=({segment:n,bytes:e,trackInfoFn:t,timingInfoFn:i,videoSegmentTimingInfoFn:s,audioSegmentTimingInfoFn:r,id3Fn:o,captionsFn:a,isEndOfTimeline:l,endedTimelineFn:h,dataFn:u,doneFn:c,onTransmuxerLog:f,triggerSegmentEventFn:p})=>{const b=n.map&&n.map.tracks||{},y=!!(b.audio&&b.video);let _=i.bind(null,n,"audio","start");const T=i.bind(null,n,"audio","end");let w=i.bind(null,n,"video","start");const v=i.bind(null,n,"video","end"),S=()=>BC({bytes:e,transmuxer:n.transmuxer,audioAppendStart:n.audioAppendStart,gopsToAlignWith:n.gopsToAlignWith,remux:y,onData:k=>{k.type=k.type==="combined"?"video":k.type,u(n,k)},onTrackInfo:k=>{t&&(y&&(k.isMuxed=!0),t(n,k))},onAudioTimingInfo:k=>{_&&typeof k.start<"u"&&(_(k.start),_=null),T&&typeof k.end<"u"&&T(k.end)},onVideoTimingInfo:k=>{w&&typeof k.start<"u"&&(w(k.start),w=null),v&&typeof k.end<"u"&&v(k.end)},onVideoSegmentTimingInfo:k=>{const A={pts:{start:k.start.presentation,end:k.end.presentation},dts:{start:k.start.decode,end:k.end.decode}};p({type:"segmenttransmuxingtiminginfoavailable",segment:n,timingInfo:A}),s(k)},onAudioSegmentTimingInfo:k=>{const A={pts:{start:k.start.pts,end:k.end.pts},dts:{start:k.start.dts,end:k.end.dts}};p({type:"segmenttransmuxingtiminginfoavailable",segment:n,timingInfo:A}),r(k)},onId3:(k,A)=>{o(n,k,A)},onCaptions:k=>{a(n,[k])},isEndOfTimeline:l,onEndedTimeline:()=>{h()},onTransmuxerLog:f,onDone:(k,A)=>{c&&(k.type=k.type==="combined"?"video":k.type,p({type:"segmenttransmuxingcomplete",segment:n}),c(A,n,k))},segment:n,triggerSegmentEventFn:p});va({action:"probeTs",transmuxer:n.transmuxer,data:e,baseStartTime:n.baseStartTime,callback:k=>{n.bytes=e=k.data;const A=k.result;A&&(t(n,{hasAudio:A.hasAudio,hasVideo:A.hasVideo,isMuxed:y}),t=null),S()}})},VC=({segment:n,bytes:e,trackInfoFn:t,timingInfoFn:i,videoSegmentTimingInfoFn:s,audioSegmentTimingInfoFn:r,id3Fn:o,captionsFn:a,isEndOfTimeline:l,endedTimelineFn:h,dataFn:u,doneFn:c,onTransmuxerLog:f,triggerSegmentEventFn:p})=>{let b=new Uint8Array(e);if(dB(b)){n.isFmp4=!0;const{tracks:y}=n.map;if(y.text&&(!y.audio||!y.video)){u(n,{data:b,type:"text"}),U8(n,y.text.codec,c);return}const T={isFmp4:!0,hasVideo:!!y.video,hasAudio:!!y.audio};y.audio&&y.audio.codec&&y.audio.codec!=="enca"&&(T.audioCodec=y.audio.codec),y.video&&y.video.codec&&y.video.codec!=="encv"&&(T.videoCodec=y.video.codec),y.video&&y.audio&&(T.isMuxed=!0),t(n,T);const w=(v,S)=>{u(n,{data:b,type:T.hasAudio&&!T.isMuxed?"audio":"video"}),S&&S.length&&o(n,S),v&&v.length&&a(n,v),c(null,n,{})};va({action:"probeMp4StartTime",timescales:n.map.timescales,data:b,transmuxer:n.transmuxer,callback:({data:v,startTime:S})=>{e=v.buffer,n.bytes=b=v,T.hasAudio&&!T.isMuxed&&i(n,"audio","start",S),T.hasVideo&&i(n,"video","start",S),va({action:"probeEmsgID3",data:b,transmuxer:n.transmuxer,offset:S,callback:({emsgData:k,id3Frames:A})=>{if(e=k.buffer,n.bytes=b=k,!y.video||!k.byteLength||!n.transmuxer){w(void 0,A);return}va({action:"pushMp4Captions",endAction:"mp4Captions",transmuxer:n.transmuxer,data:b,timescales:n.map.timescales,trackIds:[y.video.id],callback:M=>{e=M.data.buffer,n.bytes=b=M.data,M.logs.forEach(function(B){f(et(B,{stream:"mp4CaptionParser"}))}),w(M.captions,A)}})}})}});return}if(!n.transmuxer){c(null,n,{});return}if(typeof n.container>"u"&&(n.container=Dy(b)),n.container!=="ts"&&n.container!=="aac"){t(n,{hasAudio:!1,hasVideo:!1}),c(null,n,{});return}j8({segment:n,bytes:e,trackInfoFn:t,timingInfoFn:i,videoSegmentTimingInfoFn:s,audioSegmentTimingInfoFn:r,id3Fn:o,captionsFn:a,isEndOfTimeline:l,endedTimelineFn:h,dataFn:u,doneFn:c,onTransmuxerLog:f,triggerSegmentEventFn:p})},UC=function({id:n,key:e,encryptedBytes:t,decryptionWorker:i,segment:s,doneFn:r},o){const a=h=>{if(h.data.source===n){i.removeEventListener("message",a);const u=h.data.decrypted;o(new Uint8Array(u.bytes,u.byteOffset,u.byteLength))}};i.onerror=()=>{const h="An error occurred in the decryption worker",u=uo({segment:s}),c={message:h,metadata:{error:new Error(h),errorType:Y.Error.StreamingFailedToDecryptSegment,segmentInfo:u,keyInfo:{uri:s.key.resolvedUri||s.map.key.resolvedUri}}};r(c,s)},i.addEventListener("message",a);let l;e.bytes.slice?l=e.bytes.slice():l=new Uint32Array(Array.prototype.slice.call(e.bytes)),i.postMessage(kC({source:n,encrypted:t,key:l,iv:e.iv}),[t.buffer,l.buffer])},X8=({decryptionWorker:n,segment:e,trackInfoFn:t,timingInfoFn:i,videoSegmentTimingInfoFn:s,audioSegmentTimingInfoFn:r,id3Fn:o,captionsFn:a,isEndOfTimeline:l,endedTimelineFn:h,dataFn:u,doneFn:c,onTransmuxerLog:f,triggerSegmentEventFn:p})=>{p({type:"segmentdecryptionstart"}),UC({id:e.requestId,key:e.key,encryptedBytes:e.encryptedBytes,decryptionWorker:n,segment:e,doneFn:c},b=>{e.bytes=b,p({type:"segmentdecryptioncomplete",segment:e}),VC({segment:e,bytes:e.bytes,trackInfoFn:t,timingInfoFn:i,videoSegmentTimingInfoFn:s,audioSegmentTimingInfoFn:r,id3Fn:o,captionsFn:a,isEndOfTimeline:l,endedTimelineFn:h,dataFn:u,doneFn:c,onTransmuxerLog:f,triggerSegmentEventFn:p})})},H8=({activeXhrs:n,decryptionWorker:e,trackInfoFn:t,timingInfoFn:i,videoSegmentTimingInfoFn:s,audioSegmentTimingInfoFn:r,id3Fn:o,captionsFn:a,isEndOfTimeline:l,endedTimelineFn:h,dataFn:u,doneFn:c,onTransmuxerLog:f,triggerSegmentEventFn:p})=>{let b=0,y=!1;return(_,T)=>{if(!y){if(_)return y=!0,o0(n),c(_,T);if(b+=1,b===n.length){const w=function(){if(T.encryptedBytes)return X8({decryptionWorker:e,segment:T,trackInfoFn:t,timingInfoFn:i,videoSegmentTimingInfoFn:s,audioSegmentTimingInfoFn:r,id3Fn:o,captionsFn:a,isEndOfTimeline:l,endedTimelineFn:h,dataFn:u,doneFn:c,onTransmuxerLog:f,triggerSegmentEventFn:p});VC({segment:T,bytes:T.bytes,trackInfoFn:t,timingInfoFn:i,videoSegmentTimingInfoFn:s,audioSegmentTimingInfoFn:r,id3Fn:o,captionsFn:a,isEndOfTimeline:l,endedTimelineFn:h,dataFn:u,doneFn:c,onTransmuxerLog:f,triggerSegmentEventFn:p})};if(T.endOfAllRequests=Date.now(),T.map&&T.map.encryptedBytes&&!T.map.bytes)return p({type:"segmentdecryptionstart",segment:T}),UC({decryptionWorker:e,id:T.requestId+"-init",encryptedBytes:T.map.encryptedBytes,key:T.map.key,segment:T,doneFn:c},v=>{T.map.bytes=v,p({type:"segmentdecryptioncomplete",segment:T}),FC(T,S=>{if(S)return o0(n),c(S,T);w()})});w()}}}},W8=({loadendState:n,abortFn:e})=>t=>{t.target.aborted&&e&&!n.calledAbortFn&&(e(),n.calledAbortFn=!0)},Z8=({segment:n,progressFn:e,trackInfoFn:t,timingInfoFn:i,videoSegmentTimingInfoFn:s,audioSegmentTimingInfoFn:r,id3Fn:o,captionsFn:a,isEndOfTimeline:l,endedTimelineFn:h,dataFn:u})=>c=>{if(!c.target.aborted)return n.stats=et(n.stats,F8(c)),!n.stats.firstBytesReceivedAt&&n.stats.bytesReceived&&(n.stats.firstBytesReceivedAt=Date.now()),e(c,n)},Y8=({xhr:n,xhrOptions:e,decryptionWorker:t,segment:i,abortFn:s,progressFn:r,trackInfoFn:o,timingInfoFn:a,videoSegmentTimingInfoFn:l,audioSegmentTimingInfoFn:h,id3Fn:u,captionsFn:c,isEndOfTimeline:f,endedTimelineFn:p,dataFn:b,doneFn:y,onTransmuxerLog:_,triggerSegmentEventFn:T})=>{const w=[],v=H8({activeXhrs:w,decryptionWorker:t,trackInfoFn:o,timingInfoFn:a,videoSegmentTimingInfoFn:l,audioSegmentTimingInfoFn:h,id3Fn:u,captionsFn:c,isEndOfTimeline:f,endedTimelineFn:p,dataFn:b,doneFn:y,onTransmuxerLog:_,triggerSegmentEventFn:T});if(i.key&&!i.key.bytes){const B=[i.key];i.map&&!i.map.bytes&&i.map.key&&i.map.key.resolvedUri===i.key.resolvedUri&&B.push(i.map.key);const P=et(e,{uri:i.key.resolvedUri,responseType:"arraybuffer",requestType:"segment-key"}),R=$S(i,B,v,T),q={uri:i.key.resolvedUri};T({type:"segmentkeyloadstart",segment:i,keyInfo:q});const z=n(P,R);w.push(z)}if(i.map&&!i.map.bytes){if(i.map.key&&(!i.key||i.key.resolvedUri!==i.map.key.resolvedUri)){const z=et(e,{uri:i.map.key.resolvedUri,responseType:"arraybuffer",requestType:"segment-key"}),X=$S(i,[i.map.key],v,T),Z={uri:i.map.key.resolvedUri};T({type:"segmentkeyloadstart",segment:i,keyInfo:Z});const K=n(z,X);w.push(K)}const P=et(e,{uri:i.map.resolvedUri,responseType:"arraybuffer",headers:s0(i.map),requestType:"segment-media-initialization"}),R=q8({segment:i,finishProcessingFn:v,triggerSegmentEventFn:T});T({type:"segmentloadstart",segment:i});const q=n(P,R);w.push(q)}const S=et(e,{uri:i.part&&i.part.resolvedUri||i.resolvedUri,responseType:"arraybuffer",headers:s0(i),requestType:"segment"}),k=z8({segment:i,finishProcessingFn:v,responseType:S.responseType,triggerSegmentEventFn:T});T({type:"segmentloadstart",segment:i});const A=n(S,k);A.addEventListener("progress",Z8({segment:i,progressFn:r,trackInfoFn:o,timingInfoFn:a,videoSegmentTimingInfoFn:l,audioSegmentTimingInfoFn:h,id3Fn:u,captionsFn:c,isEndOfTimeline:f,endedTimelineFn:p,dataFn:b})),w.push(A);const M={};return w.forEach(B=>{B.addEventListener("loadend",W8({loadendState:M,abortFn:s}))}),()=>o0(w)},fc=Mn("PlaylistSelector"),QS=function(n){if(!n||!n.playlist)return;const e=n.playlist;return JSON.stringify({id:e.id,bandwidth:n.bandwidth,width:n.width,height:n.height,codecs:e.attributes&&e.attributes.CODECS||""})},Sa=function(n,e){if(!n)return"";const t=V.getComputedStyle(n);return t?t[e]:""},xa=function(n,e){const t=n.slice();n.sort(function(i,s){const r=e(i,s);return r===0?t.indexOf(i)-t.indexOf(s):r})},hb=function(n,e){let t,i;return n.attributes.BANDWIDTH&&(t=n.attributes.BANDWIDTH),t=t||V.Number.MAX_VALUE,e.attributes.BANDWIDTH&&(i=e.attributes.BANDWIDTH),i=i||V.Number.MAX_VALUE,t-i},G8=function(n,e){let t,i;return n.attributes.RESOLUTION&&n.attributes.RESOLUTION.width&&(t=n.attributes.RESOLUTION.width),t=t||V.Number.MAX_VALUE,e.attributes.RESOLUTION&&e.attributes.RESOLUTION.width&&(i=e.attributes.RESOLUTION.width),i=i||V.Number.MAX_VALUE,t===i&&n.attributes.BANDWIDTH&&e.attributes.BANDWIDTH?n.attributes.BANDWIDTH-e.attributes.BANDWIDTH:t-i};let qC=function(n){const{main:e,bandwidth:t,playerWidth:i,playerHeight:s,playerObjectFit:r,limitRenditionByPlayerDimensions:o,playlistController:a}=n;if(!e)return;const l={bandwidth:t,width:i,height:s,limitRenditionByPlayerDimensions:o};let h=e.playlists;ji.isAudioOnly(e)&&(h=a.getAudioTrackPlaylists_(),l.audioOnly=!0);let u=h.map(M=>{let B;const P=M.attributes&&M.attributes.RESOLUTION&&M.attributes.RESOLUTION.width,R=M.attributes&&M.attributes.RESOLUTION&&M.attributes.RESOLUTION.height;return B=M.attributes&&M.attributes.BANDWIDTH,B=B||V.Number.MAX_VALUE,{bandwidth:B,width:P,height:R,playlist:M}});xa(u,(M,B)=>M.bandwidth-B.bandwidth),u=u.filter(M=>!ji.isIncompatible(M.playlist));let c=u.filter(M=>ji.isEnabled(M.playlist));c.length||(c=u.filter(M=>!ji.isDisabled(M.playlist)));const f=c.filter(M=>M.bandwidth*Jt.BANDWIDTH_VARIANCE<t);let p=f[f.length-1];const b=f.filter(M=>M.bandwidth===p.bandwidth)[0];if(o===!1){const M=b||c[0]||u[0];if(M&&M.playlist){let B="sortedPlaylistReps";return b&&(B="bandwidthBestRep"),c[0]&&(B="enabledPlaylistReps"),fc(`choosing ${QS(M)} using ${B} with options`,l),M.playlist}return fc("could not choose a playlist with options",l),null}const y=f.filter(M=>M.width&&M.height);xa(y,(M,B)=>M.width-B.width);const _=y.filter(M=>M.width===i&&M.height===s);p=_[_.length-1];const T=_.filter(M=>M.bandwidth===p.bandwidth)[0];let w,v,S;T||(w=y.filter(M=>r==="cover"?M.width>i&&M.height>s:M.width>i||M.height>s),v=w.filter(M=>M.width===w[0].width&&M.height===w[0].height),p=v[v.length-1],S=v.filter(M=>M.bandwidth===p.bandwidth)[0]);let k;if(a.leastPixelDiffSelector){const M=y.map(B=>(B.pixelDiff=Math.abs(B.width-i)+Math.abs(B.height-s),B));xa(M,(B,P)=>B.pixelDiff===P.pixelDiff?P.bandwidth-B.bandwidth:B.pixelDiff-P.pixelDiff),k=M[0]}const A=k||S||T||b||c[0]||u[0];if(A&&A.playlist){let M="sortedPlaylistReps";return k?M="leastPixelDiffRep":S?M="resolutionPlusOneRep":T?M="resolutionBestRep":b?M="bandwidthBestRep":c[0]&&(M="enabledPlaylistReps"),fc(`choosing ${QS(A)} using ${M} with options`,l),A.playlist}return fc("could not choose a playlist with options",l),null};const BS=function(){let n=this.useDevicePixelRatio&&V.devicePixelRatio||1;return isNaN(this.customPixelRatio)||(n=this.customPixelRatio),qC({main:this.playlists.main,bandwidth:this.systemBandwidth,playerWidth:parseInt(Sa(this.tech_.el(),"width"),10)*n,playerHeight:parseInt(Sa(this.tech_.el(),"height"),10)*n,playerObjectFit:this.usePlayerObjectFit?Sa(this.tech_.el(),"objectFit"):"",limitRenditionByPlayerDimensions:this.limitRenditionByPlayerDimensions,playlistController:this.playlistController_})},K8=function(n){let e=-1,t=-1;if(n<0||n>1)throw new Error("Moving average bandwidth decay must be between 0 and 1.");return function(){let i=this.useDevicePixelRatio&&V.devicePixelRatio||1;return isNaN(this.customPixelRatio)||(i=this.customPixelRatio),e<0&&(e=this.systemBandwidth,t=this.systemBandwidth),this.systemBandwidth>0&&this.systemBandwidth!==t&&(e=n*this.systemBandwidth+(1-n)*e,t=this.systemBandwidth),qC({main:this.playlists.main,bandwidth:e,playerWidth:parseInt(Sa(this.tech_.el(),"width"),10)*i,playerHeight:parseInt(Sa(this.tech_.el(),"height"),10)*i,playerObjectFit:this.usePlayerObjectFit?Sa(this.tech_.el(),"objectFit"):"",limitRenditionByPlayerDimensions:this.limitRenditionByPlayerDimensions,playlistController:this.playlistController_})}},J8=function(n){const{main:e,currentTime:t,bandwidth:i,duration:s,segmentDuration:r,timeUntilRebuffer:o,currentTimeline:a,syncController:l}=n,h=e.playlists.filter(b=>!ji.isIncompatible(b));let u=h.filter(ji.isEnabled);u.length||(u=h.filter(b=>!ji.isDisabled(b)));const f=u.filter(ji.hasAttribute.bind(null,"BANDWIDTH")).map(b=>{const _=l.getSyncPoint(b,s,a,t)?1:2,w=ji.estimateSegmentRequestTime(r,i,b)*_-o;return{playlist:b,rebufferingImpact:w}}),p=f.filter(b=>b.rebufferingImpact<=0);return xa(p,(b,y)=>hb(y.playlist,b.playlist)),p.length?p[0]:(xa(f,(b,y)=>b.rebufferingImpact-y.rebufferingImpact),f[0]||null)},eF=function(){const n=this.playlists.main.playlists.filter(ji.isEnabled);return xa(n,(t,i)=>hb(t,i)),n.filter(t=>!!Sh(this.playlists.main,t).video)[0]||null},tF=n=>{let e=0,t;return n.bytes&&(t=new Uint8Array(n.bytes),n.segments.forEach(i=>{t.set(i,e),e+=i.byteLength})),t};function zC(n){try{return new URL(n).pathname.split("/").slice(-2).join("/")}catch{return""}}const iF=function(n,e,t){if(!n[t]){e.trigger({type:"usage",name:"vhs-608"});let i=t;/^cc708_/.test(t)&&(i="SERVICE"+t.split("_")[1]);const s=e.textTracks().getTrackById(i);if(s)n[t]=s;else{const r=e.options_.vhs&&e.options_.vhs.captionServices||{};let o=t,a=t,l=!1;const h=r[i];h&&(o=h.label,a=h.language,l=h.default),n[t]=e.addRemoteTextTrack({kind:"captions",id:i,default:l,label:o,language:a},!1).track}}},nF=function({inbandTextTracks:n,captionArray:e,timestampOffset:t}){if(!e)return;const i=V.WebKitDataCue||V.VTTCue;e.forEach(s=>{const r=s.stream;s.content?s.content.forEach(o=>{const a=new i(s.startTime+t,s.endTime+t,o.text);a.line=o.line,a.align="left",a.position=o.position,a.positionAlign="line-left",n[r].addCue(a)}):n[r].addCue(new i(s.startTime+t,s.endTime+t,s.text))})},sF=function(n){Object.defineProperties(n.frame,{id:{get(){return Y.log.warn("cue.frame.id is deprecated. Use cue.value.key instead."),n.value.key}},value:{get(){return Y.log.warn("cue.frame.value is deprecated. Use cue.value.data instead."),n.value.data}},privateData:{get(){return Y.log.warn("cue.frame.privateData is deprecated. Use cue.value.data instead."),n.value.data}}})},rF=({inbandTextTracks:n,metadataArray:e,timestampOffset:t,videoDuration:i})=>{if(!e)return;const s=V.WebKitDataCue||V.VTTCue,r=n.metadataTrack_;if(!r||(e.forEach(u=>{const c=u.cueTime+t;typeof c!="number"||V.isNaN(c)||c<0||!(c<1/0)||!u.frames||!u.frames.length||u.frames.forEach(f=>{const p=new s(c,c,f.value||f.url||f.data||"");p.frame=f,p.value=f,sF(p),r.addCue(p)})}),!r.cues||!r.cues.length))return;const o=r.cues,a=[];for(let u=0;u<o.length;u++)o[u]&&a.push(o[u]);const l=a.reduce((u,c)=>{const f=u[c.startTime]||[];return f.push(c),u[c.startTime]=f,u},{}),h=Object.keys(l).sort((u,c)=>Number(u)-Number(c));h.forEach((u,c)=>{const f=l[u],p=isFinite(i)?i:u,b=Number(h[c+1])||p;f.forEach(y=>{y.endTime=b})})},oF={id:"ID",class:"CLASS",startDate:"START-DATE",duration:"DURATION",endDate:"END-DATE",endOnNext:"END-ON-NEXT",plannedDuration:"PLANNED-DURATION",scte35Out:"SCTE35-OUT",scte35In:"SCTE35-IN"},aF=new Set(["id","class","startDate","duration","endDate","endOnNext","startTime","endTime","processDateRange"]),lF=({inbandTextTracks:n,dateRanges:e})=>{const t=n.metadataTrack_;if(!t)return;const i=V.WebKitDataCue||V.VTTCue;e.forEach(s=>{for(const r of Object.keys(s)){if(aF.has(r))continue;const o=new i(s.startTime,s.endTime,"");o.id=s.id,o.type="com.apple.quicktime.HLS",o.value={key:oF[r],data:s[r]},(r==="scte35Out"||r==="scte35In")&&(o.value.data=new Uint8Array(o.value.data.match(/[\da-f]{2}/gi)).buffer),t.addCue(o)}s.processDateRange()})},NS=(n,e,t)=>{n.metadataTrack_||(n.metadataTrack_=t.addRemoteTextTrack({kind:"metadata",label:"Timed Metadata"},!1).track,Y.browser.IS_ANY_SAFARI||(n.metadataTrack_.inBandMetadataTrackDispatchType=e))},eh=function(n,e,t){let i,s;if(t&&t.cues)for(i=t.cues.length;i--;)s=t.cues[i],s.startTime>=n&&s.endTime<=e&&t.removeCue(s)},hF=function(n){const e=n.cues;if(!e)return;const t={};for(let i=e.length-1;i>=0;i--){const s=e[i],r=`${s.startTime}-${s.endTime}-${s.text}`;t[r]?n.removeCue(s):t[r]=s}},uF=(n,e,t)=>{if(typeof e>"u"||e===null||!n.length)return[];const i=Math.ceil((e-t+3)*mo.ONE_SECOND_IN_TS);let s;for(s=0;s<n.length&&!(n[s].pts>i);s++);return n.slice(s)},cF=(n,e,t)=>{if(!e.length)return n;if(t)return e.slice();const i=e[0].pts;let s=0;for(s;s<n.length&&!(n[s].pts>=i);s++);return n.slice(0,s).concat(e)},dF=(n,e,t,i)=>{const s=Math.ceil((e-i)*mo.ONE_SECOND_IN_TS),r=Math.ceil((t-i)*mo.ONE_SECOND_IN_TS),o=n.slice();let a=n.length;for(;a--&&!(n[a].pts<=r););if(a===-1)return o;let l=a+1;for(;l--&&!(n[l].pts<=s););return l=Math.max(l,0),o.splice(l,a-l+1),o},fF=function(n,e){if(!n&&!e||!n&&e||n&&!e)return!1;if(n===e)return!0;const t=Object.keys(n).sort(),i=Object.keys(e).sort();if(t.length!==i.length)return!1;for(let s=0;s<t.length;s++){const r=t[s];if(r!==i[s]||n[r]!==e[r])return!1}return!0},pF=function(n,e,t){e=e||[];const i=[];let s=0;for(let r=0;r<e.length;r++){const o=e[r];if(n===o.timeline&&(i.push(r),s+=o.duration,s>t))return r}return i.length===0?0:i[i.length-1]},Nl=1,mF=500,FS=n=>typeof n=="number"&&isFinite(n),pc=1/60,gF=(n,e,t)=>n!=="main"||!e||!t?null:!t.hasAudio&&!t.hasVideo?"Neither audio nor video found in segment.":e.hasVideo&&!t.hasVideo?"Only audio found in segment when we expected video. We can't switch to audio only from a stream that had video. To get rid of this message, please add codec information to the manifest.":!e.hasVideo&&t.hasVideo?"Video found in segment when we expected only audio. We can't switch to a stream with video from an audio only stream. To get rid of this message, please add codec information to the manifest.":null,OF=(n,e,t)=>{let i=e-Jt.BACK_BUFFER_LENGTH;n.length&&(i=Math.max(i,n.start(0)));const s=e-t;return Math.min(s,i)},Ko=n=>{const{startOfSegment:e,duration:t,segment:i,part:s,playlist:{mediaSequence:r,id:o,segments:a=[]},mediaIndex:l,partIndex:h,timeline:u}=n,c=a.length-1;let f="mediaIndex/partIndex increment";n.getMediaInfoForTime?f=`getMediaInfoForTime (${n.getMediaInfoForTime})`:n.isSyncRequest&&(f="getSyncSegmentCandidate (isSyncRequest)"),n.independent&&(f+=` with independent ${n.independent}`);const p=typeof h=="number",b=n.segment.uri?"segment":"pre-segment",y=p?lC({preloadSegment:i})-1:0;return`${b} [${r+l}/${r+c}]`+(p?` part [${h}/${y}]`:"")+` segment start/end [${i.start} => ${i.end}]`+(p?` part start/end [${s.start} => ${s.end}]`:"")+` startOfSegment [${e}] duration [${t}] timeline [${u}] selected by [${f}] playlist [${o}]`},VS=n=>`${n}TimingInfo`,yF=({segmentTimeline:n,currentTimeline:e,startOfSegment:t,buffered:i,overrideCheck:s})=>!s&&n===e?null:n<e?t:i.length?i.end(i.length-1):t,a0=({timelineChangeController:n,currentTimeline:e,segmentTimeline:t,loaderType:i,audioDisabled:s})=>{if(e===t)return!1;if(i==="audio"){const r=n.lastTimelineChange({type:"main"});return!r||r.to!==t}if(i==="main"&&s){const r=n.pendingTimelineChange({type:"audio"});return!(r&&r.to===t)}return!1},bF=n=>{if(!n)return!1;const e=n.pendingTimelineChange({type:"audio"}),t=n.pendingTimelineChange({type:"main"}),i=e&&t,s=i&&e.to!==t.to;return!!(i&&e.from!==-1&&t.from!==-1&&s)},vF=n=>{const e=n.timelineChangeController_.pendingTimelineChange({type:"audio"}),t=n.timelineChangeController_.pendingTimelineChange({type:"main"});return e&&t&&e.to<t.to},Or=n=>{const e=n.pendingSegment_;if(!e)return;if(a0({timelineChangeController:n.timelineChangeController_,currentTimeline:n.currentTimeline_,segmentTimeline:e.timeline,loaderType:n.loaderType_,audioDisabled:n.audioDisabled_})&&bF(n.timelineChangeController_)){if(vF(n)){n.timelineChangeController_.trigger("audioTimelineBehind");return}n.timelineChangeController_.trigger("fixBadTimelineChange")}},SF=n=>{let e=0;return["video","audio"].forEach(function(t){const i=n[`${t}TimingInfo`];if(!i)return;const{start:s,end:r}=i;let o;typeof s=="bigint"||typeof r=="bigint"?o=V.BigInt(r)-V.BigInt(s):typeof s=="number"&&typeof r=="number"&&(o=r-s),typeof o<"u"&&o>e&&(e=o)}),typeof e=="bigint"&&e<Number.MAX_SAFE_INTEGER&&(e=Number(e)),e},US=({segmentDuration:n,maxDuration:e})=>n?Math.round(n)>e+gs:!1,xF=(n,e)=>{if(e!=="hls")return null;const t=SF({audioTimingInfo:n.audioTimingInfo,videoTimingInfo:n.videoTimingInfo});if(!t)return null;const i=n.playlist.targetDuration,s=US({segmentDuration:t,maxDuration:i*2}),r=US({segmentDuration:t,maxDuration:i}),o=`Segment with index ${n.mediaIndex} from playlist ${n.playlist.id} has a duration of ${t} when the reported duration is ${n.duration} and the target duration is ${i}. For HLS content, a duration in excess of the target duration may result in playback issues. See the HLS specification section on EXT-X-TARGETDURATION for more details: https://tools.ietf.org/html/draft-pantos-http-live-streaming-23#section-4.3.3.1`;return s||r?{severity:s?"warn":"info",message:o}:null},uo=({type:n,segment:e})=>{if(!e)return;const t=!!(e.key||e.map&&e.map.ke),i=!!(e.map&&!e.map.bytes),s=e.startOfSegment===void 0?e.start:e.startOfSegment;return{type:n||e.type,uri:e.resolvedUri||e.uri,start:s,duration:e.duration,isEncrypted:t,isMediaInitialization:i}};class l0 extends Y.EventTarget{constructor(e,t={}){if(super(),!e)throw new TypeError("Initialization settings are required");if(typeof e.currentTime!="function")throw new TypeError("No currentTime getter specified");if(!e.mediaSource)throw new TypeError("No MediaSource specified");this.bandwidth=e.bandwidth,this.throughput={rate:0,count:0},this.roundTrip=NaN,this.resetStats_(),this.mediaIndex=null,this.partIndex=null,this.hasPlayed_=e.hasPlayed,this.currentTime_=e.currentTime,this.seekable_=e.seekable,this.seeking_=e.seeking,this.duration_=e.duration,this.mediaSource_=e.mediaSource,this.vhs_=e.vhs,this.loaderType_=e.loaderType,this.currentMediaInfo_=void 0,this.startingMediaInfo_=void 0,this.segmentMetadataTrack_=e.segmentMetadataTrack,this.goalBufferLength_=e.goalBufferLength,this.sourceType_=e.sourceType,this.sourceUpdater_=e.sourceUpdater,this.inbandTextTracks_=e.inbandTextTracks,this.state_="INIT",this.timelineChangeController_=e.timelineChangeController,this.shouldSaveSegmentTimingInfo_=!0,this.parse708captions_=e.parse708captions,this.useDtsForTimestampOffset_=e.useDtsForTimestampOffset,this.captionServices_=e.captionServices,this.exactManifestTimings=e.exactManifestTimings,this.addMetadataToTextTrack=e.addMetadataToTextTrack,this.checkBufferTimeout_=null,this.error_=void 0,this.currentTimeline_=-1,this.shouldForceTimestampOffsetAfterResync_=!1,this.pendingSegment_=null,this.xhrOptions_=null,this.pendingSegments_=[],this.audioDisabled_=!1,this.isPendingTimestampOffset_=!1,this.gopBuffer_=[],this.timeMapping_=0,this.safeAppend_=!1,this.appendInitSegment_={audio:!0,video:!0},this.playlistOfLastInitSegment_={audio:null,video:null},this.callQueue_=[],this.loadQueue_=[],this.metadataQueue_={id3:[],caption:[]},this.waitingOnRemove_=!1,this.quotaExceededErrorRetryTimeout_=null,this.activeInitSegmentId_=null,this.initSegments_={},this.cacheEncryptionKeys_=e.cacheEncryptionKeys,this.keyCache_={},this.decrypter_=e.decrypter,this.syncController_=e.syncController,this.syncPoint_={segmentIndex:0,time:0},this.transmuxer_=this.createTransmuxer_(),this.triggerSyncInfoUpdate_=()=>this.trigger("syncinfoupdate"),this.syncController_.on("syncinfoupdate",this.triggerSyncInfoUpdate_),this.mediaSource_.addEventListener("sourceopen",()=>{this.isEndOfStream_()||(this.ended_=!1)}),this.fetchAtBuffer_=!1,this.logger_=Mn(`SegmentLoader[${this.loaderType_}]`),Object.defineProperty(this,"state",{get(){return this.state_},set(i){i!==this.state_&&(this.logger_(`${this.state_} -> ${i}`),this.state_=i,this.trigger("statechange"))}}),this.sourceUpdater_.on("ready",()=>{this.hasEnoughInfoToAppend_()?this.processCallQueue_():Or(this)}),this.sourceUpdater_.on("codecschange",i=>{this.trigger(Nt({type:"codecschange"},i))}),this.loaderType_==="main"&&this.timelineChangeController_.on("pendingtimelinechange",()=>{this.hasEnoughInfoToAppend_()?this.processCallQueue_():Or(this)}),this.loaderType_==="audio"&&this.timelineChangeController_.on("timelinechange",i=>{this.trigger(Nt({type:"timelinechange"},i)),this.hasEnoughInfoToLoad_()?this.processLoadQueue_():Or(this),this.hasEnoughInfoToAppend_()?this.processCallQueue_():Or(this)})}get mediaSequenceSync_(){return this.syncController_.getMediaSequenceSync(this.loaderType_)}createTransmuxer_(){return wm.createTransmuxer({remux:!1,alignGopsAtEnd:this.safeAppend_,keepOriginalTimestamps:!0,parse708captions:this.parse708captions_,captionServices:this.captionServices_})}resetStats_(){this.mediaBytesTransferred=0,this.mediaRequests=0,this.mediaRequestsAborted=0,this.mediaRequestsTimedout=0,this.mediaRequestsErrored=0,this.mediaTransferDuration=0,this.mediaSecondsLoaded=0,this.mediaAppends=0}dispose(){this.trigger("dispose"),this.state="DISPOSED",this.pause(),this.abort_(),this.transmuxer_&&this.transmuxer_.terminate(),this.resetStats_(),this.checkBufferTimeout_&&V.clearTimeout(this.checkBufferTimeout_),this.syncController_&&this.triggerSyncInfoUpdate_&&this.syncController_.off("syncinfoupdate",this.triggerSyncInfoUpdate_),this.off()}setAudio(e){this.audioDisabled_=!e,e?this.appendInitSegment_.audio=!0:this.sourceUpdater_.removeAudio(0,this.duration_())}abort(){if(this.state!=="WAITING"){this.pendingSegment_&&(this.pendingSegment_=null),this.timelineChangeController_.clearPendingTimelineChange(this.loaderType_);return}this.abort_(),this.state="READY",this.paused()||this.monitorBuffer_()}abort_(){this.pendingSegment_&&this.pendingSegment_.abortRequests&&this.pendingSegment_.abortRequests(),this.pendingSegment_=null,this.callQueue_=[],this.loadQueue_=[],this.metadataQueue_.id3=[],this.metadataQueue_.caption=[],this.timelineChangeController_.clearPendingTimelineChange(this.loaderType_),this.waitingOnRemove_=!1,V.clearTimeout(this.quotaExceededErrorRetryTimeout_),this.quotaExceededErrorRetryTimeout_=null}checkForAbort_(e){return this.state==="APPENDING"&&!this.pendingSegment_?(this.state="READY",!0):!this.pendingSegment_||this.pendingSegment_.requestId!==e}error(e){return typeof e<"u"&&(this.logger_("error occurred:",e),this.error_=e),this.pendingSegment_=null,this.error_}endOfStream(){this.ended_=!0,this.transmuxer_&&wm.reset(this.transmuxer_),this.gopBuffer_.length=0,this.pause(),this.trigger("ended")}buffered_(){const e=this.getMediaInfo_();if(!this.sourceUpdater_||!e)return ti();if(this.loaderType_==="main"){const{hasAudio:t,hasVideo:i,isMuxed:s}=e;if(i&&t&&!this.audioDisabled_&&!s)return this.sourceUpdater_.buffered();if(i)return this.sourceUpdater_.videoBuffered()}return this.sourceUpdater_.audioBuffered()}initSegmentForMap(e,t=!1){if(!e)return null;const i=jd(e);let s=this.initSegments_[i];return t&&!s&&e.bytes&&(this.initSegments_[i]=s={resolvedUri:e.resolvedUri,byterange:e.byterange,bytes:e.bytes,tracks:e.tracks,timescales:e.timescales}),s||e}segmentKey(e,t=!1){if(!e)return null;const i=CC(e);let s=this.keyCache_[i];this.cacheEncryptionKeys_&&t&&!s&&e.bytes&&(this.keyCache_[i]=s={resolvedUri:e.resolvedUri,bytes:e.bytes});const r={resolvedUri:(s||e).resolvedUri};return s&&(r.bytes=s.bytes),r}couldBeginLoading_(){return this.playlist_&&!this.paused()}load(){if(this.monitorBuffer_(),!!this.playlist_){if(this.state==="INIT"&&this.couldBeginLoading_())return this.init_();!this.couldBeginLoading_()||this.state!=="READY"&&this.state!=="INIT"||(this.state="READY")}}init_(){return this.state="READY",this.resetEverything(),this.monitorBuffer_()}playlist(e,t={}){if(!e||this.playlist_&&this.playlist_.endList&&e.endList&&this.playlist_.uri===e.uri)return;const i=this.playlist_,s=this.pendingSegment_;this.playlist_=e,this.xhrOptions_=t,this.state==="INIT"&&(e.syncInfo={mediaSequence:e.mediaSequence,time:0},this.loaderType_==="main"&&this.syncController_.setDateTimeMappingForStart(e));let r=null;if(i&&(i.id?r=i.id:i.uri&&(r=i.uri)),this.logger_(`playlist update [${r} => ${e.id||e.uri}]`),this.mediaSequenceSync_&&(this.mediaSequenceSync_.update(e,this.currentTime_()),this.logger_(`Playlist update:
currentTime: ${this.currentTime_()}
bufferedEnd: ${xm(this.buffered_())}
`,this.mediaSequenceSync_.diagnostics)),this.trigger("syncinfoupdate"),this.state==="INIT"&&this.couldBeginLoading_())return this.init_();if(!i||i.uri!==e.uri){this.mediaIndex!==null&&(!e.endList&&typeof e.partTargetDuration=="number"?this.resetLoader():this.resyncLoader()),this.currentMediaInfo_=void 0,this.trigger("playlistupdate");return}const o=e.mediaSequence-i.mediaSequence;if(this.logger_(`live window shift [${o}]`),this.mediaIndex!==null)if(this.mediaIndex-=o,this.mediaIndex<0)this.mediaIndex=null,this.partIndex=null;else{const a=this.playlist_.segments[this.mediaIndex];if(this.partIndex&&(!a.parts||!a.parts.length||!a.parts[this.partIndex])){const l=this.mediaIndex;this.logger_(`currently processing part (index ${this.partIndex}) no longer exists.`),this.resetLoader(),this.mediaIndex=l}}s&&(s.mediaIndex-=o,s.mediaIndex<0?(s.mediaIndex=null,s.partIndex=null):(s.mediaIndex>=0&&(s.segment=e.segments[s.mediaIndex]),s.partIndex>=0&&s.segment.parts&&(s.part=s.segment.parts[s.partIndex]))),this.syncController_.saveExpiredSegmentInfo(i,e)}pause(){this.checkBufferTimeout_&&(V.clearTimeout(this.checkBufferTimeout_),this.checkBufferTimeout_=null)}paused(){return this.checkBufferTimeout_===null}resetEverything(e){this.ended_=!1,this.activeInitSegmentId_=null,this.appendInitSegment_={audio:!0,video:!0},this.resetLoader(),this.remove(0,1/0,e),this.transmuxer_&&(this.transmuxer_.postMessage({action:"clearAllMp4Captions"}),this.transmuxer_.postMessage({action:"reset"}))}resetLoader(){this.fetchAtBuffer_=!1,this.mediaSequenceSync_&&this.mediaSequenceSync_.resetAppendedStatus(),this.resyncLoader()}resyncLoader(){this.transmuxer_&&wm.reset(this.transmuxer_),this.mediaIndex=null,this.partIndex=null,this.syncPoint_=null,this.isPendingTimestampOffset_=!1;const e=this.currentMediaInfo_&&this.currentMediaInfo_.isFmp4;this.sourceType_==="hls"&&!e&&(this.shouldForceTimestampOffsetAfterResync_=!0),this.callQueue_=[],this.loadQueue_=[],this.metadataQueue_.id3=[],this.metadataQueue_.caption=[],this.abort(),this.transmuxer_&&this.transmuxer_.postMessage({action:"clearParsedMp4Captions"})}remove(e,t,i=()=>{},s=!1){if(t===1/0&&(t=this.duration_()),t<=e){this.logger_("skipping remove because end ${end} is <= start ${start}");return}if(!this.sourceUpdater_||!this.getMediaInfo_()){this.logger_("skipping remove because no source updater or starting media info");return}let r=1;const o=()=>{r--,r===0&&i()};(s||!this.audioDisabled_)&&(r++,this.sourceUpdater_.removeAudio(e,t,o)),(s||this.loaderType_==="main")&&(this.gopBuffer_=dF(this.gopBuffer_,e,t,this.timeMapping_),r++,this.sourceUpdater_.removeVideo(e,t,o));for(const a in this.inbandTextTracks_)eh(e,t,this.inbandTextTracks_[a]);eh(e,t,this.segmentMetadataTrack_),o()}monitorBuffer_(){this.checkBufferTimeout_&&V.clearTimeout(this.checkBufferTimeout_),this.checkBufferTimeout_=V.setTimeout(this.monitorBufferTick_.bind(this),1)}monitorBufferTick_(){this.state==="READY"&&this.fillBuffer_(),this.checkBufferTimeout_&&V.clearTimeout(this.checkBufferTimeout_),this.checkBufferTimeout_=V.setTimeout(this.monitorBufferTick_.bind(this),mF)}fillBuffer_(){if(this.sourceUpdater_.updating())return;const e=this.chooseNextRequest_();if(!e)return;const t={segmentInfo:uo({type:this.loaderType_,segment:e})};this.trigger({type:"segmentselected",metadata:t}),typeof e.timestampOffset=="number"&&(this.isPendingTimestampOffset_=!1,this.timelineChangeController_.pendingTimelineChange({type:this.loaderType_,from:this.currentTimeline_,to:e.timeline})),this.loadSegment_(e)}isEndOfStream_(e=this.mediaIndex,t=this.playlist_,i=this.partIndex){if(!t||!this.mediaSource_)return!1;const s=typeof e=="number"&&t.segments[e],r=e+1===t.segments.length,o=!s||!s.parts||i+1===s.parts.length;return t.endList&&this.mediaSource_.readyState==="open"&&r&&o}chooseNextRequest_(){const e=this.buffered_(),t=xm(e)||0,i=sb(e,this.currentTime_()),s=!this.hasPlayed_()&&i>=1,r=i>=this.goalBufferLength_(),o=this.playlist_.segments;if(!o.length||s||r)return null;this.syncPoint_=this.syncPoint_||this.syncController_.getSyncPoint(this.playlist_,this.duration_(),this.currentTimeline_,this.currentTime_(),this.loaderType_);const a={partIndex:null,mediaIndex:null,startOfSegment:null,playlist:this.playlist_,isSyncRequest:!this.syncPoint_};if(a.isSyncRequest)a.mediaIndex=pF(this.currentTimeline_,o,t),this.logger_(`choose next request. Can not find sync point. Fallback to media Index: ${a.mediaIndex}`);else if(this.mediaIndex!==null){const f=o[this.mediaIndex],p=typeof this.partIndex=="number"?this.partIndex:-1;a.startOfSegment=f.end?f.end:t,f.parts&&f.parts[p+1]?(a.mediaIndex=this.mediaIndex,a.partIndex=p+1):a.mediaIndex=this.mediaIndex+1}else{let f,p,b;const y=this.fetchAtBuffer_?t:this.currentTime_();if(this.mediaSequenceSync_&&this.logger_(`chooseNextRequest_ request after Quality Switch:
For TargetTime: ${y}.
CurrentTime: ${this.currentTime_()}
BufferedEnd: ${t}
Fetch At Buffer: ${this.fetchAtBuffer_}
`,this.mediaSequenceSync_.diagnostics),this.mediaSequenceSync_&&this.mediaSequenceSync_.isReliable){const _=this.getSyncInfoFromMediaSequenceSync_(y);if(!_){const T="No sync info found while using media sequence sync";return this.error({message:T,metadata:{errorType:Y.Error.StreamingFailedToSelectNextSegment,error:new Error(T)}}),this.logger_("chooseNextRequest_ - no sync info found using media sequence sync"),null}this.logger_(`chooseNextRequest_ mediaSequence syncInfo (${_.start} --> ${_.end})`),f=_.segmentIndex,p=_.partIndex,b=_.start}else{this.logger_("chooseNextRequest_ - fallback to a regular segment selection algorithm, based on a syncPoint.");const _=ji.getMediaInfoForTime({exactManifestTimings:this.exactManifestTimings,playlist:this.playlist_,currentTime:y,startingPartIndex:this.syncPoint_.partIndex,startingSegmentIndex:this.syncPoint_.segmentIndex,startTime:this.syncPoint_.time});f=_.segmentIndex,p=_.partIndex,b=_.startTime}a.getMediaInfoForTime=this.fetchAtBuffer_?`bufferedEnd ${y}`:`currentTime ${y}`,a.mediaIndex=f,a.startOfSegment=b,a.partIndex=p,this.logger_(`choose next request. Playlist switched and we have a sync point. Media Index: ${a.mediaIndex} `)}const l=o[a.mediaIndex];let h=l&&typeof a.partIndex=="number"&&l.parts&&l.parts[a.partIndex];if(!l||typeof a.partIndex=="number"&&!h)return null;typeof a.partIndex!="number"&&l.parts&&(a.partIndex=0,h=l.parts[0]);const u=this.vhs_.playlists&&this.vhs_.playlists.main&&this.vhs_.playlists.main.independentSegments||this.playlist_.independentSegments;if(!i&&h&&!u&&!h.independent)if(a.partIndex===0){const f=o[a.mediaIndex-1],p=f.parts&&f.parts.length&&f.parts[f.parts.length-1];p&&p.independent&&(a.mediaIndex-=1,a.partIndex=f.parts.length-1,a.independent="previous segment")}else l.parts[a.partIndex-1].independent&&(a.partIndex-=1,a.independent="previous part");const c=this.mediaSource_&&this.mediaSource_.readyState==="ended";return a.mediaIndex>=o.length-1&&c&&!this.seeking_()?null:(this.shouldForceTimestampOffsetAfterResync_&&(this.shouldForceTimestampOffsetAfterResync_=!1,a.forceTimestampOffset=!0,this.logger_("choose next request. Force timestamp offset after loader resync")),this.generateSegmentInfo_(a))}getSyncInfoFromMediaSequenceSync_(e){if(!this.mediaSequenceSync_)return null;const t=Math.max(e,this.mediaSequenceSync_.start);e!==t&&this.logger_(`getSyncInfoFromMediaSequenceSync_. Pulled target time from ${e} to ${t}`);const i=this.mediaSequenceSync_.getSyncInfoForTime(t);if(!i)return null;if(!i.isAppended)return i;const s=this.mediaSequenceSync_.getSyncInfoForTime(i.end);return s?(s.isAppended&&this.logger_("getSyncInfoFromMediaSequenceSync_: We encounter unexpected scenario where next media sequence sync info is also appended!"),s):null}generateSegmentInfo_(e){const{independent:t,playlist:i,mediaIndex:s,startOfSegment:r,isSyncRequest:o,partIndex:a,forceTimestampOffset:l,getMediaInfoForTime:h}=e,u=i.segments[s],c=typeof a=="number"&&u.parts[a],f={requestId:"segment-loader-"+Math.random(),uri:c&&c.resolvedUri||u.resolvedUri,mediaIndex:s,partIndex:c?a:null,isSyncRequest:o,startOfSegment:r,playlist:i,bytes:null,encryptedBytes:null,timestampOffset:null,timeline:u.timeline,duration:c&&c.duration||u.duration,segment:u,part:c,byteLength:0,transmuxer:this.transmuxer_,getMediaInfoForTime:h,independent:t},p=typeof l<"u"?l:this.isPendingTimestampOffset_;f.timestampOffset=this.timestampOffsetForSegment_({segmentTimeline:u.timeline,currentTimeline:this.currentTimeline_,startOfSegment:r,buffered:this.buffered_(),overrideCheck:p});const b=xm(this.sourceUpdater_.audioBuffered());return typeof b=="number"&&(f.audioAppendStart=b-this.sourceUpdater_.audioTimestampOffset()),this.sourceUpdater_.videoBuffered().length&&(f.gopsToAlignWith=uF(this.gopBuffer_,this.currentTime_()-this.sourceUpdater_.videoTimestampOffset(),this.timeMapping_)),f}timestampOffsetForSegment_(e){return yF(e)}earlyAbortWhenNeeded_(e){if(this.vhs_.tech_.paused()||!this.xhrOptions_.timeout||!this.playlist_.attributes.BANDWIDTH||Date.now()-(e.firstBytesReceivedAt||Date.now())<1e3)return;const t=this.currentTime_(),i=e.bandwidth,s=this.pendingSegment_.duration,r=ji.estimateSegmentRequestTime(s,i,this.playlist_,e.bytesReceived),o=FN(this.buffered_(),t,this.vhs_.tech_.playbackRate())-1;if(r<=o)return;const a=J8({main:this.vhs_.playlists.main,currentTime:t,bandwidth:i,duration:this.duration_(),segmentDuration:s,timeUntilRebuffer:o,currentTimeline:this.currentTimeline_,syncController:this.syncController_});if(!a)return;const h=r-o-a.rebufferingImpact;let u=.5;o<=gs&&(u=1),!(!a.playlist||a.playlist.uri===this.playlist_.uri||h<u)&&(this.bandwidth=a.playlist.attributes.BANDWIDTH*Jt.BANDWIDTH_VARIANCE+1,this.trigger("earlyabort"))}handleAbort_(e){this.logger_(`Aborting ${Ko(e)}`),this.mediaRequestsAborted+=1}handleProgress_(e,t){this.earlyAbortWhenNeeded_(t.stats),!this.checkForAbort_(t.requestId)&&this.trigger("progress")}handleTrackInfo_(e,t){const{hasAudio:i,hasVideo:s}=t,r={segmentInfo:uo({type:this.loaderType_,segment:e}),trackInfo:{hasAudio:i,hasVideo:s}};this.trigger({type:"segmenttransmuxingtrackinfoavailable",metadata:r}),this.earlyAbortWhenNeeded_(e.stats),!this.checkForAbort_(e.requestId)&&(this.checkForIllegalMediaSwitch(t)||(t=t||{},fF(this.currentMediaInfo_,t)||(this.appendInitSegment_={audio:!0,video:!0},this.startingMediaInfo_=t,this.currentMediaInfo_=t,this.logger_("trackinfo update",t),this.trigger("trackinfo")),!this.checkForAbort_(e.requestId)&&(this.pendingSegment_.trackInfo=t,this.hasEnoughInfoToAppend_()?this.processCallQueue_():Or(this))))}handleTimingInfo_(e,t,i,s){if(this.earlyAbortWhenNeeded_(e.stats),this.checkForAbort_(e.requestId))return;const r=this.pendingSegment_,o=VS(t);r[o]=r[o]||{},r[o][i]=s,this.logger_(`timinginfo: ${t} - ${i} - ${s}`),this.hasEnoughInfoToAppend_()?this.processCallQueue_():Or(this)}handleCaptions_(e,t){if(this.earlyAbortWhenNeeded_(e.stats),this.checkForAbort_(e.requestId))return;if(t.length===0){this.logger_("SegmentLoader received no captions from a caption event");return}if(!this.pendingSegment_.hasAppendedData_){this.metadataQueue_.caption.push(this.handleCaptions_.bind(this,e,t));return}const s=this.sourceUpdater_.videoTimestampOffset()===null?this.sourceUpdater_.audioTimestampOffset():this.sourceUpdater_.videoTimestampOffset(),r={};t.forEach(o=>{r[o.stream]=r[o.stream]||{startTime:1/0,captions:[],endTime:0};const a=r[o.stream];a.startTime=Math.min(a.startTime,o.startTime+s),a.endTime=Math.max(a.endTime,o.endTime+s),a.captions.push(o)}),Object.keys(r).forEach(o=>{const{startTime:a,endTime:l,captions:h}=r[o],u=this.inbandTextTracks_;this.logger_(`adding cues from ${a} -> ${l} for ${o}`),iF(u,this.vhs_.tech_,o),eh(a,l,u[o]),nF({captionArray:h,inbandTextTracks:u,timestampOffset:s})}),this.transmuxer_&&this.transmuxer_.postMessage({action:"clearParsedMp4Captions"})}handleId3_(e,t,i){if(this.earlyAbortWhenNeeded_(e.stats),this.checkForAbort_(e.requestId))return;if(!this.pendingSegment_.hasAppendedData_){this.metadataQueue_.id3.push(this.handleId3_.bind(this,e,t,i));return}this.addMetadataToTextTrack(i,t,this.duration_())}processMetadataQueue_(){this.metadataQueue_.id3.forEach(e=>e()),this.metadataQueue_.caption.forEach(e=>e()),this.metadataQueue_.id3=[],this.metadataQueue_.caption=[]}processCallQueue_(){const e=this.callQueue_;this.callQueue_=[],e.forEach(t=>t())}processLoadQueue_(){const e=this.loadQueue_;this.loadQueue_=[],e.forEach(t=>t())}hasEnoughInfoToLoad_(){if(this.loaderType_!=="audio")return!0;const e=this.pendingSegment_;return e?this.getCurrentMediaInfo_()?!a0({timelineChangeController:this.timelineChangeController_,currentTimeline:this.currentTimeline_,segmentTimeline:e.timeline,loaderType:this.loaderType_,audioDisabled:this.audioDisabled_}):!0:!1}getCurrentMediaInfo_(e=this.pendingSegment_){return e&&e.trackInfo||this.currentMediaInfo_}getMediaInfo_(e=this.pendingSegment_){return this.getCurrentMediaInfo_(e)||this.startingMediaInfo_}getPendingSegmentPlaylist(){return this.pendingSegment_?this.pendingSegment_.playlist:null}hasEnoughInfoToAppend_(){if(!this.sourceUpdater_.ready()||this.waitingOnRemove_||this.quotaExceededErrorRetryTimeout_)return!1;const e=this.pendingSegment_,t=this.getCurrentMediaInfo_();if(!e||!t)return!1;const{hasAudio:i,hasVideo:s,isMuxed:r}=t;return!(s&&!e.videoTimingInfo||i&&!this.audioDisabled_&&!r&&!e.audioTimingInfo||a0({timelineChangeController:this.timelineChangeController_,currentTimeline:this.currentTimeline_,segmentTimeline:e.timeline,loaderType:this.loaderType_,audioDisabled:this.audioDisabled_}))}handleData_(e,t){if(this.earlyAbortWhenNeeded_(e.stats),this.checkForAbort_(e.requestId))return;if(this.callQueue_.length||!this.hasEnoughInfoToAppend_()){Or(this),this.callQueue_.push(this.handleData_.bind(this,e,t));return}const i=this.pendingSegment_;if(this.setTimeMapping_(i.timeline),this.updateMediaSecondsLoaded_(i.part||i.segment),this.mediaSource_.readyState!=="closed"){if(e.map&&(e.map=this.initSegmentForMap(e.map,!0),i.segment.map=e.map),e.key&&this.segmentKey(e.key,!0),i.isFmp4=e.isFmp4,i.timingInfo=i.timingInfo||{},i.isFmp4)this.trigger("fmp4"),i.timingInfo.start=i[VS(t.type)].start;else{const s=this.getCurrentMediaInfo_(),r=this.loaderType_==="main"&&s&&s.hasVideo;let o;r&&(o=i.videoTimingInfo.start),i.timingInfo.start=this.trueSegmentStart_({currentStart:i.timingInfo.start,playlist:i.playlist,mediaIndex:i.mediaIndex,currentVideoTimestampOffset:this.sourceUpdater_.videoTimestampOffset(),useVideoTimingInfo:r,firstVideoFrameTimeForData:o,videoTimingInfo:i.videoTimingInfo,audioTimingInfo:i.audioTimingInfo})}if(this.updateAppendInitSegmentStatus(i,t.type),this.updateSourceBufferTimestampOffset_(i),i.isSyncRequest){this.updateTimingInfoEnd_(i),this.syncController_.saveSegmentTimingInfo({segmentInfo:i,shouldSaveTimelineMapping:this.loaderType_==="main"});const s=this.chooseNextRequest_();if(s.mediaIndex!==i.mediaIndex||s.partIndex!==i.partIndex){this.logger_("sync segment was incorrect, not appending");return}this.logger_("sync segment was correct, appending")}i.hasAppendedData_=!0,this.processMetadataQueue_(),this.appendData_(i,t)}}updateAppendInitSegmentStatus(e,t){this.loaderType_==="main"&&typeof e.timestampOffset=="number"&&!e.changedTimestampOffset&&(this.appendInitSegment_={audio:!0,video:!0}),this.playlistOfLastInitSegment_[t]!==e.playlist&&(this.appendInitSegment_[t]=!0)}getInitSegmentAndUpdateState_({type:e,initSegment:t,map:i,playlist:s}){if(i){const r=jd(i);if(this.activeInitSegmentId_===r)return null;t=this.initSegmentForMap(i,!0).bytes,this.activeInitSegmentId_=r}return t&&this.appendInitSegment_[e]?(this.playlistOfLastInitSegment_[e]=s,this.appendInitSegment_[e]=!1,this.activeInitSegmentId_=null,t):null}handleQuotaExceededError_({segmentInfo:e,type:t,bytes:i},s){const r=this.sourceUpdater_.audioBuffered(),o=this.sourceUpdater_.videoBuffered();r.length>1&&this.logger_("On QUOTA_EXCEEDED_ERR, found gaps in the audio buffer: "+go(r).join(", ")),o.length>1&&this.logger_("On QUOTA_EXCEEDED_ERR, found gaps in the video buffer: "+go(o).join(", "));const a=r.length?r.start(0):0,l=r.length?r.end(r.length-1):0,h=o.length?o.start(0):0,u=o.length?o.end(o.length-1):0;if(l-a<=Nl&&u-h<=Nl){this.logger_(`On QUOTA_EXCEEDED_ERR, single segment too large to append to buffer, triggering an error. Appended byte length: ${i.byteLength}, audio buffer: ${go(r).join(", ")}, video buffer: ${go(o).join(", ")}, `),this.error({message:"Quota exceeded error with append of a single segment of content",excludeUntil:1/0}),this.trigger("error");return}this.waitingOnRemove_=!0,this.callQueue_.push(this.appendToSourceBuffer_.bind(this,{segmentInfo:e,type:t,bytes:i}));const f=this.currentTime_()-Nl;this.logger_(`On QUOTA_EXCEEDED_ERR, removing audio/video from 0 to ${f}`),this.remove(0,f,()=>{this.logger_(`On QUOTA_EXCEEDED_ERR, retrying append in ${Nl}s`),this.waitingOnRemove_=!1,this.quotaExceededErrorRetryTimeout_=V.setTimeout(()=>{this.logger_("On QUOTA_EXCEEDED_ERR, re-processing call queue"),this.quotaExceededErrorRetryTimeout_=null,this.processCallQueue_()},Nl*1e3)},!0)}handleAppendError_({segmentInfo:e,type:t,bytes:i},s){if(s){if(s.code===bC){this.handleQuotaExceededError_({segmentInfo:e,type:t,bytes:i});return}this.logger_("Received non QUOTA_EXCEEDED_ERR on append",s),this.error({message:`${t} append of ${i.length}b failed for segment #${e.mediaIndex} in playlist ${e.playlist.id}`,metadata:{errorType:Y.Error.StreamingFailedToAppendSegment}}),this.trigger("appenderror")}}appendToSourceBuffer_({segmentInfo:e,type:t,initSegment:i,data:s,bytes:r}){if(!r){const a=[s];let l=s.byteLength;i&&(a.unshift(i),l+=i.byteLength),r=tF({bytes:l,segments:a})}const o={segmentInfo:uo({type:this.loaderType_,segment:e})};this.trigger({type:"segmentappendstart",metadata:o}),this.sourceUpdater_.appendBuffer({segmentInfo:e,type:t,bytes:r},this.handleAppendError_.bind(this,{segmentInfo:e,type:t,bytes:r}))}handleSegmentTimingInfo_(e,t,i){if(!this.pendingSegment_||t!==this.pendingSegment_.requestId)return;const s=this.pendingSegment_.segment,r=`${e}TimingInfo`;s[r]||(s[r]={}),s[r].transmuxerPrependedSeconds=i.prependedContentDuration||0,s[r].transmuxedPresentationStart=i.start.presentation,s[r].transmuxedDecodeStart=i.start.decode,s[r].transmuxedPresentationEnd=i.end.presentation,s[r].transmuxedDecodeEnd=i.end.decode,s[r].baseMediaDecodeTime=i.baseMediaDecodeTime}appendData_(e,t){const{type:i,data:s}=t;if(!s||!s.byteLength||i==="audio"&&this.audioDisabled_)return;const r=this.getInitSegmentAndUpdateState_({type:i,initSegment:t.initSegment,playlist:e.playlist,map:e.isFmp4?e.segment.map:null});this.appendToSourceBuffer_({segmentInfo:e,type:i,initSegment:r,data:s})}loadSegment_(e){if(this.state="WAITING",this.pendingSegment_=e,this.trimBackBuffer_(e),typeof e.timestampOffset=="number"&&this.transmuxer_&&this.transmuxer_.postMessage({action:"clearAllMp4Captions"}),!this.hasEnoughInfoToLoad_()){Or(this),this.loadQueue_.push(()=>{const t=Nt({},e,{forceTimestampOffset:!0});Nt(e,this.generateSegmentInfo_(t)),this.isPendingTimestampOffset_=!1,this.updateTransmuxerAndRequestSegment_(e)});return}this.updateTransmuxerAndRequestSegment_(e)}updateTransmuxerAndRequestSegment_(e){this.shouldUpdateTransmuxerTimestampOffset_(e.timestampOffset)&&(this.gopBuffer_.length=0,e.gopsToAlignWith=[],this.timeMapping_=0,this.transmuxer_.postMessage({action:"reset"}),this.transmuxer_.postMessage({action:"setTimestampOffset",timestampOffset:e.timestampOffset}));const t=this.createSimplifiedSegmentObj_(e),i=this.isEndOfStream_(e.mediaIndex,e.playlist,e.partIndex),s=this.mediaIndex!==null,r=e.timeline!==this.currentTimeline_&&e.timeline>0,o=i||s&&r;this.logger_(`Requesting
${zC(e.uri)}
${Ko(e)}`),t.map&&!t.map.bytes&&(this.logger_("going to request init segment."),this.appendInitSegment_={video:!0,audio:!0}),e.abortRequests=Y8({xhr:this.vhs_.xhr,xhrOptions:this.xhrOptions_,decryptionWorker:this.decrypter_,segment:t,abortFn:this.handleAbort_.bind(this,e),progressFn:this.handleProgress_.bind(this),trackInfoFn:this.handleTrackInfo_.bind(this),timingInfoFn:this.handleTimingInfo_.bind(this),videoSegmentTimingInfoFn:this.handleSegmentTimingInfo_.bind(this,"video",e.requestId),audioSegmentTimingInfoFn:this.handleSegmentTimingInfo_.bind(this,"audio",e.requestId),captionsFn:this.handleCaptions_.bind(this),isEndOfTimeline:o,endedTimelineFn:()=>{this.logger_("received endedtimeline callback")},id3Fn:this.handleId3_.bind(this),dataFn:this.handleData_.bind(this),doneFn:this.segmentRequestFinished_.bind(this),onTransmuxerLog:({message:a,level:l,stream:h})=>{this.logger_(`${Ko(e)} logged from transmuxer stream ${h} as a ${l}: ${a}`)},triggerSegmentEventFn:({type:a,segment:l,keyInfo:h,trackInfo:u,timingInfo:c})=>{const p={segmentInfo:uo({segment:l})};h&&(p.keyInfo=h),u&&(p.trackInfo=u),c&&(p.timingInfo=c),this.trigger({type:a,metadata:p})}})}trimBackBuffer_(e){const t=OF(this.seekable_(),this.currentTime_(),this.playlist_.targetDuration||10);t>0&&this.remove(0,t)}createSimplifiedSegmentObj_(e){const t=e.segment,i=e.part,s=e.segment.key||e.segment.map&&e.segment.map.key,r=e.segment.map&&!e.segment.map.bytes,o={resolvedUri:i?i.resolvedUri:t.resolvedUri,byterange:i?i.byterange:t.byterange,requestId:e.requestId,transmuxer:e.transmuxer,audioAppendStart:e.audioAppendStart,gopsToAlignWith:e.gopsToAlignWith,part:e.part,type:this.loaderType_,start:e.startOfSegment,duration:e.duration,isEncrypted:s,isMediaInitialization:r},a=e.playlist.segments[e.mediaIndex-1];if(a&&a.timeline===t.timeline&&(a.videoTimingInfo?o.baseStartTime=a.videoTimingInfo.transmuxedDecodeEnd:a.audioTimingInfo&&(o.baseStartTime=a.audioTimingInfo.transmuxedDecodeEnd)),t.key){const l=t.key.iv||new Uint32Array([0,0,0,e.mediaIndex+e.playlist.mediaSequence]);o.key=this.segmentKey(t.key),o.key.iv=l}return t.map&&(o.map=this.initSegmentForMap(t.map)),o}saveTransferStats_(e){this.mediaRequests+=1,e&&(this.mediaBytesTransferred+=e.bytesReceived,this.mediaTransferDuration+=e.roundTripTime)}saveBandwidthRelatedStats_(e,t){if(this.pendingSegment_.byteLength=t.bytesReceived,e<pc){this.logger_(`Ignoring segment's bandwidth because its duration of ${e} is less than the min to record ${pc}`);return}const i={bandwidthInfo:{from:this.bandwidth,to:t.bandwidth}};this.trigger({type:"bandwidthupdated",metadata:i}),this.bandwidth=t.bandwidth,this.roundTrip=t.roundTripTime}handleTimeout_(){this.mediaRequestsTimedout+=1,this.bandwidth=1,this.roundTrip=NaN,this.trigger("bandwidthupdate"),this.trigger("timeout")}segmentRequestFinished_(e,t,i){if(this.callQueue_.length){this.callQueue_.push(this.segmentRequestFinished_.bind(this,e,t,i));return}if(this.saveTransferStats_(t.stats),!this.pendingSegment_||t.requestId!==this.pendingSegment_.requestId)return;if(e){if(this.pendingSegment_=null,this.state="READY",e.code===ys.ABORTED)return;if(this.pause(),e.code===ys.TIMEOUT){this.handleTimeout_();return}this.mediaRequestsErrored+=1,this.error(e),this.trigger("error");return}const s=this.pendingSegment_;this.saveBandwidthRelatedStats_(s.duration,t.stats),s.endOfAllRequests=t.endOfAllRequests,i.gopInfo&&(this.gopBuffer_=cF(this.gopBuffer_,i.gopInfo,this.safeAppend_)),this.state="APPENDING",this.trigger("appending"),this.waitForAppendsToComplete_(s)}setTimeMapping_(e){const t=this.syncController_.mappingForTimeline(e);t!==null&&(this.timeMapping_=t)}updateMediaSecondsLoaded_(e){typeof e.start=="number"&&typeof e.end=="number"?this.mediaSecondsLoaded+=e.end-e.start:this.mediaSecondsLoaded+=e.duration}shouldUpdateTransmuxerTimestampOffset_(e){return e===null?!1:this.loaderType_==="main"&&e!==this.sourceUpdater_.videoTimestampOffset()||!this.audioDisabled_&&e!==this.sourceUpdater_.audioTimestampOffset()}trueSegmentStart_({currentStart:e,playlist:t,mediaIndex:i,firstVideoFrameTimeForData:s,currentVideoTimestampOffset:r,useVideoTimingInfo:o,videoTimingInfo:a,audioTimingInfo:l}){if(typeof e<"u")return e;if(!o)return l.start;const h=t.segments[i-1];return i===0||!h||typeof h.start>"u"||h.end!==s+r?s:a.start}waitForAppendsToComplete_(e){const t=this.getCurrentMediaInfo_(e);if(!t){this.error({message:"No starting media returned, likely due to an unsupported media format.",playlistExclusionDuration:1/0}),this.trigger("error");return}const{hasAudio:i,hasVideo:s,isMuxed:r}=t,o=this.loaderType_==="main"&&s,a=!this.audioDisabled_&&i&&!r;if(e.waitingOnAppends=0,!e.hasAppendedData_){!e.timingInfo&&typeof e.timestampOffset=="number"&&(this.isPendingTimestampOffset_=!0),e.timingInfo={start:0},e.waitingOnAppends++,this.isPendingTimestampOffset_||(this.updateSourceBufferTimestampOffset_(e),this.processMetadataQueue_()),this.checkAppendsDone_(e);return}o&&e.waitingOnAppends++,a&&e.waitingOnAppends++,o&&this.sourceUpdater_.videoQueueCallback(this.checkAppendsDone_.bind(this,e)),a&&this.sourceUpdater_.audioQueueCallback(this.checkAppendsDone_.bind(this,e))}checkAppendsDone_(e){this.checkForAbort_(e.requestId)||(e.waitingOnAppends--,e.waitingOnAppends===0&&this.handleAppendsDone_())}checkForIllegalMediaSwitch(e){const t=gF(this.loaderType_,this.getCurrentMediaInfo_(),e);return t?(this.error({message:t,playlistExclusionDuration:1/0}),this.trigger("error"),!0):!1}updateSourceBufferTimestampOffset_(e){if(e.timestampOffset===null||typeof e.timingInfo.start!="number"||e.changedTimestampOffset||this.loaderType_!=="main")return;let t=!1;e.timestampOffset-=this.getSegmentStartTimeForTimestampOffsetCalculation_({videoTimingInfo:e.segment.videoTimingInfo,audioTimingInfo:e.segment.audioTimingInfo,timingInfo:e.timingInfo}),e.changedTimestampOffset=!0,e.timestampOffset!==this.sourceUpdater_.videoTimestampOffset()&&(this.sourceUpdater_.videoTimestampOffset(e.timestampOffset),t=!0),e.timestampOffset!==this.sourceUpdater_.audioTimestampOffset()&&(this.sourceUpdater_.audioTimestampOffset(e.timestampOffset),t=!0),t&&this.trigger("timestampoffset")}getSegmentStartTimeForTimestampOffsetCalculation_({videoTimingInfo:e,audioTimingInfo:t,timingInfo:i}){return this.useDtsForTimestampOffset_?e&&typeof e.transmuxedDecodeStart=="number"?e.transmuxedDecodeStart:t&&typeof t.transmuxedDecodeStart=="number"?t.transmuxedDecodeStart:i.start:i.start}updateTimingInfoEnd_(e){e.timingInfo=e.timingInfo||{};const t=this.getMediaInfo_(),s=this.loaderType_==="main"&&t&&t.hasVideo&&e.videoTimingInfo?e.videoTimingInfo:e.audioTimingInfo;s&&(e.timingInfo.end=typeof s.end=="number"?s.end:s.start+e.duration)}handleAppendsDone_(){if(this.pendingSegment_){const l={segmentInfo:uo({type:this.loaderType_,segment:this.pendingSegment_})};this.trigger({type:"appendsdone",metadata:l})}if(!this.pendingSegment_){this.state="READY",this.paused()||this.monitorBuffer_();return}const e=this.pendingSegment_;e.part&&e.part.syncInfo?e.part.syncInfo.markAppended():e.segment.syncInfo&&e.segment.syncInfo.markAppended(),this.updateTimingInfoEnd_(e),this.shouldSaveSegmentTimingInfo_&&this.syncController_.saveSegmentTimingInfo({segmentInfo:e,shouldSaveTimelineMapping:this.loaderType_==="main"});const t=xF(e,this.sourceType_);if(t&&(t.severity==="warn"?Y.log.warn(t.message):this.logger_(t.message)),this.recordThroughput_(e),this.pendingSegment_=null,this.state="READY",e.isSyncRequest&&(this.trigger("syncinfoupdate"),!e.hasAppendedData_)){this.logger_(`Throwing away un-appended sync request ${Ko(e)}`);return}this.logger_(`Appended ${Ko(e)}`),this.addSegmentMetadataCue_(e),this.fetchAtBuffer_=!0,this.currentTimeline_!==e.timeline&&(this.timelineChangeController_.lastTimelineChange({type:this.loaderType_,from:this.currentTimeline_,to:e.timeline}),this.loaderType_==="main"&&!this.audioDisabled_&&this.timelineChangeController_.lastTimelineChange({type:"audio",from:this.currentTimeline_,to:e.timeline})),this.currentTimeline_=e.timeline,this.trigger("syncinfoupdate");const i=e.segment,s=e.part,r=i.end&&this.currentTime_()-i.end>e.playlist.targetDuration*3,o=s&&s.end&&this.currentTime_()-s.end>e.playlist.partTargetDuration*3;if(r||o){this.logger_(`bad ${r?"segment":"part"} ${Ko(e)}`),this.resetEverything();return}this.mediaIndex!==null&&this.trigger("bandwidthupdate"),this.trigger("progress"),this.mediaIndex=e.mediaIndex,this.partIndex=e.partIndex,this.isEndOfStream_(e.mediaIndex,e.playlist,e.partIndex)&&this.endOfStream(),this.trigger("appended"),e.hasAppendedData_&&this.mediaAppends++,this.paused()||this.monitorBuffer_()}recordThroughput_(e){if(e.duration<pc){this.logger_(`Ignoring segment's throughput because its duration of ${e.duration} is less than the min to record ${pc}`);return}const t=this.throughput.rate,i=Date.now()-e.endOfAllRequests+1,s=Math.floor(e.byteLength/i*8*1e3);this.throughput.rate+=(s-t)/++this.throughput.count}addSegmentMetadataCue_(e){if(!this.segmentMetadataTrack_)return;const t=e.segment,i=t.start,s=t.end;if(!FS(i)||!FS(s))return;eh(i,s,this.segmentMetadataTrack_);const r=V.WebKitDataCue||V.VTTCue,o={custom:t.custom,dateTimeObject:t.dateTimeObject,dateTimeString:t.dateTimeString,programDateTime:t.programDateTime,bandwidth:e.playlist.attributes.BANDWIDTH,resolution:e.playlist.attributes.RESOLUTION,codecs:e.playlist.attributes.CODECS,byteLength:e.byteLength,uri:e.uri,timeline:e.timeline,playlist:e.playlist.id,start:i,end:s},a=JSON.stringify(o),l=new r(i,s,a);l.value=o,this.segmentMetadataTrack_.addCue(l)}}function Ks(){}const jC=function(n){return typeof n!="string"?n:n.replace(/./,e=>e.toUpperCase())},TF=["video","audio"],h0=(n,e)=>{const t=e[`${n}Buffer`];return t&&t.updating||e.queuePending[n]},wF=(n,e)=>{for(let t=0;t<e.length;t++){const i=e[t];if(i.type==="mediaSource")return null;if(i.type===n)return t}return null},Ta=(n,e)=>{if(e.queue.length===0)return;let t=0,i=e.queue[t];if(i.type==="mediaSource"){!e.updating()&&e.mediaSource.readyState!=="closed"&&(e.queue.shift(),i.action(e),i.doneFn&&i.doneFn(),Ta("audio",e),Ta("video",e));return}if(n!=="mediaSource"&&!(!e.ready()||e.mediaSource.readyState==="closed"||h0(n,e))){if(i.type!==n){if(t=wF(n,e.queue),t===null)return;i=e.queue[t]}if(e.queue.splice(t,1),e.queuePending[n]=i,i.action(n,e),!i.doneFn){e.queuePending[n]=null,Ta(n,e);return}}},XC=(n,e)=>{const t=e[`${n}Buffer`],i=jC(n);t&&(t.removeEventListener("updateend",e[`on${i}UpdateEnd_`]),t.removeEventListener("error",e[`on${i}Error_`]),e.codecs[n]=null,e[`${n}Buffer`]=null)},fs=(n,e)=>n&&e&&Array.prototype.indexOf.call(n.sourceBuffers,e)!==-1,Yi={appendBuffer:(n,e,t)=>(i,s)=>{const r=s[`${i}Buffer`];if(fs(s.mediaSource,r)){s.logger_(`Appending segment ${e.mediaIndex}'s ${n.length} bytes to ${i}Buffer`);try{r.appendBuffer(n)}catch(o){s.logger_(`Error with code ${o.code} `+(o.code===bC?"(QUOTA_EXCEEDED_ERR) ":"")+`when appending segment ${e.mediaIndex} to ${i}Buffer`),s.queuePending[i]=null,t(o)}}},remove:(n,e)=>(t,i)=>{const s=i[`${t}Buffer`];if(fs(i.mediaSource,s)){i.logger_(`Removing ${n} to ${e} from ${t}Buffer`);try{s.remove(n,e)}catch{i.logger_(`Remove ${n} to ${e} from ${t}Buffer failed`)}}},timestampOffset:n=>(e,t)=>{const i=t[`${e}Buffer`];fs(t.mediaSource,i)&&(t.logger_(`Setting ${e}timestampOffset to ${n}`),i.timestampOffset=n)},callback:n=>(e,t)=>{n()},endOfStream:n=>e=>{if(e.mediaSource.readyState==="open"){e.logger_(`Calling mediaSource endOfStream(${n||""})`);try{e.mediaSource.endOfStream(n)}catch(t){Y.log.warn("Failed to call media source endOfStream",t)}}},duration:n=>e=>{e.logger_(`Setting mediaSource duration to ${n}`);try{e.mediaSource.duration=n}catch(t){Y.log.warn("Failed to set media source duration",t)}},abort:()=>(n,e)=>{if(e.mediaSource.readyState!=="open")return;const t=e[`${n}Buffer`];if(fs(e.mediaSource,t)){e.logger_(`calling abort on ${n}Buffer`);try{t.abort()}catch(i){Y.log.warn(`Failed to abort on ${n}Buffer`,i)}}},addSourceBuffer:(n,e)=>t=>{const i=jC(n),s=Ra(e);t.logger_(`Adding ${n}Buffer with codec ${e} to mediaSource`);const r=t.mediaSource.addSourceBuffer(s);r.addEventListener("updateend",t[`on${i}UpdateEnd_`]),r.addEventListener("error",t[`on${i}Error_`]),t.codecs[n]=e,t[`${n}Buffer`]=r},removeSourceBuffer:n=>e=>{const t=e[`${n}Buffer`];if(XC(n,e),!!fs(e.mediaSource,t)){e.logger_(`Removing ${n}Buffer with codec ${e.codecs[n]} from mediaSource`);try{e.mediaSource.removeSourceBuffer(t)}catch(i){Y.log.warn(`Failed to removeSourceBuffer ${n}Buffer`,i)}}},changeType:n=>(e,t)=>{const i=t[`${e}Buffer`],s=Ra(n);if(!fs(t.mediaSource,i))return;const r=n.substring(0,n.indexOf(".")),o=t.codecs[e];if(o.substring(0,o.indexOf("."))===r)return;const l={codecsChangeInfo:{from:o,to:n}};t.trigger({type:"codecschange",metadata:l}),t.logger_(`changing ${e}Buffer codec from ${o} to ${n}`);try{i.changeType(s),t.codecs[e]=n}catch(h){l.errorType=Y.Error.StreamingCodecsChangeError,l.error=h,h.metadata=l,t.error_=h,t.trigger("error"),Y.log.warn(`Failed to changeType on ${e}Buffer`,h)}}},Gi=({type:n,sourceUpdater:e,action:t,doneFn:i,name:s})=>{e.queue.push({type:n,action:t,doneFn:i,name:s}),Ta(n,e)},qS=(n,e)=>t=>{const i=e[`${n}Buffered`](),s=QN(i);if(e.logger_(`received "updateend" event for ${n} Source Buffer: `,s),e.queuePending[n]){const r=e.queuePending[n].doneFn;e.queuePending[n]=null,r&&r(e[`${n}Error_`])}Ta(n,e)};class HC extends Y.EventTarget{constructor(e){super(),this.mediaSource=e,this.sourceopenListener_=()=>Ta("mediaSource",this),this.mediaSource.addEventListener("sourceopen",this.sourceopenListener_),this.logger_=Mn("SourceUpdater"),this.audioTimestampOffset_=0,this.videoTimestampOffset_=0,this.queue=[],this.queuePending={audio:null,video:null},this.delayedAudioAppendQueue_=[],this.videoAppendQueued_=!1,this.codecs={},this.onVideoUpdateEnd_=qS("video",this),this.onAudioUpdateEnd_=qS("audio",this),this.onVideoError_=t=>{this.videoError_=t},this.onAudioError_=t=>{this.audioError_=t},this.createdSourceBuffers_=!1,this.initializedEme_=!1,this.triggeredReady_=!1}initializedEme(){this.initializedEme_=!0,this.triggerReady()}hasCreatedSourceBuffers(){return this.createdSourceBuffers_}hasInitializedAnyEme(){return this.initializedEme_}ready(){return this.hasCreatedSourceBuffers()&&this.hasInitializedAnyEme()}createSourceBuffers(e){this.hasCreatedSourceBuffers()||(this.addOrChangeSourceBuffers(e),this.createdSourceBuffers_=!0,this.trigger("createdsourcebuffers"),this.triggerReady())}triggerReady(){this.ready()&&!this.triggeredReady_&&(this.triggeredReady_=!0,this.trigger("ready"))}addSourceBuffer(e,t){Gi({type:"mediaSource",sourceUpdater:this,action:Yi.addSourceBuffer(e,t),name:"addSourceBuffer"})}abort(e){Gi({type:e,sourceUpdater:this,action:Yi.abort(e),name:"abort"})}removeSourceBuffer(e){if(!this.canRemoveSourceBuffer()){Y.log.error("removeSourceBuffer is not supported!");return}Gi({type:"mediaSource",sourceUpdater:this,action:Yi.removeSourceBuffer(e),name:"removeSourceBuffer"})}canRemoveSourceBuffer(){return!Y.browser.IS_FIREFOX&&V.MediaSource&&V.MediaSource.prototype&&typeof V.MediaSource.prototype.removeSourceBuffer=="function"}static canChangeType(){return V.SourceBuffer&&V.SourceBuffer.prototype&&typeof V.SourceBuffer.prototype.changeType=="function"}canChangeType(){return this.constructor.canChangeType()}changeType(e,t){if(!this.canChangeType()){Y.log.error("changeType is not supported!");return}Gi({type:e,sourceUpdater:this,action:Yi.changeType(t),name:"changeType"})}addOrChangeSourceBuffers(e){if(!e||typeof e!="object"||Object.keys(e).length===0)throw new Error("Cannot addOrChangeSourceBuffers to undefined codecs");Object.keys(e).forEach(t=>{const i=e[t];if(!this.hasCreatedSourceBuffers())return this.addSourceBuffer(t,i);this.canChangeType()&&this.changeType(t,i)})}appendBuffer(e,t){const{segmentInfo:i,type:s,bytes:r}=e;if(this.processedAppend_=!0,s==="audio"&&this.videoBuffer&&!this.videoAppendQueued_){this.delayedAudioAppendQueue_.push([e,t]),this.logger_(`delayed audio append of ${r.length} until video append`);return}const o=t;if(Gi({type:s,sourceUpdater:this,action:Yi.appendBuffer(r,i||{mediaIndex:-1},o),doneFn:t,name:"appendBuffer"}),s==="video"){if(this.videoAppendQueued_=!0,!this.delayedAudioAppendQueue_.length)return;const a=this.delayedAudioAppendQueue_.slice();this.logger_(`queuing delayed audio ${a.length} appendBuffers`),this.delayedAudioAppendQueue_.length=0,a.forEach(l=>{this.appendBuffer.apply(this,l)})}}audioBuffered(){return fs(this.mediaSource,this.audioBuffer)&&this.audioBuffer.buffered?this.audioBuffer.buffered:ti()}videoBuffered(){return fs(this.mediaSource,this.videoBuffer)&&this.videoBuffer.buffered?this.videoBuffer.buffered:ti()}buffered(){const e=fs(this.mediaSource,this.videoBuffer)?this.videoBuffer:null,t=fs(this.mediaSource,this.audioBuffer)?this.audioBuffer:null;return t&&!e?this.audioBuffered():e&&!t?this.videoBuffered():NN(this.audioBuffered(),this.videoBuffered())}setDuration(e,t=Ks){Gi({type:"mediaSource",sourceUpdater:this,action:Yi.duration(e),name:"duration",doneFn:t})}endOfStream(e=null,t=Ks){typeof e!="string"&&(e=void 0),Gi({type:"mediaSource",sourceUpdater:this,action:Yi.endOfStream(e),name:"endOfStream",doneFn:t})}removeAudio(e,t,i=Ks){if(!this.audioBuffered().length||this.audioBuffered().end(0)===0){i();return}Gi({type:"audio",sourceUpdater:this,action:Yi.remove(e,t),doneFn:i,name:"remove"})}removeVideo(e,t,i=Ks){if(!this.videoBuffered().length||this.videoBuffered().end(0)===0){i();return}Gi({type:"video",sourceUpdater:this,action:Yi.remove(e,t),doneFn:i,name:"remove"})}updating(){return!!(h0("audio",this)||h0("video",this))}audioTimestampOffset(e){return typeof e<"u"&&this.audioBuffer&&this.audioTimestampOffset_!==e&&(Gi({type:"audio",sourceUpdater:this,action:Yi.timestampOffset(e),name:"timestampOffset"}),this.audioTimestampOffset_=e),this.audioTimestampOffset_}videoTimestampOffset(e){return typeof e<"u"&&this.videoBuffer&&this.videoTimestampOffset_!==e&&(Gi({type:"video",sourceUpdater:this,action:Yi.timestampOffset(e),name:"timestampOffset"}),this.videoTimestampOffset_=e),this.videoTimestampOffset_}audioQueueCallback(e){this.audioBuffer&&Gi({type:"audio",sourceUpdater:this,action:Yi.callback(e),name:"callback"})}videoQueueCallback(e){this.videoBuffer&&Gi({type:"video",sourceUpdater:this,action:Yi.callback(e),name:"callback"})}dispose(){this.trigger("dispose"),TF.forEach(e=>{this.abort(e),this.canRemoveSourceBuffer()?this.removeSourceBuffer(e):this[`${e}QueueCallback`](()=>XC(e,this))}),this.videoAppendQueued_=!1,this.delayedAudioAppendQueue_.length=0,this.sourceopenListener_&&this.mediaSource.removeEventListener("sourceopen",this.sourceopenListener_),this.off()}}const zS=n=>decodeURIComponent(escape(String.fromCharCode.apply(null,n))),_F=n=>{const e=new Uint8Array(n);return Array.from(e).map(t=>t.toString(16).padStart(2,"0")).join("")},jS=new Uint8Array(`

`.split("").map(n=>n.charCodeAt(0)));class kF extends Error{constructor(){super("Trying to parse received VTT cues, but there is no WebVTT. Make sure vtt.js is loaded.")}}class CF extends l0{constructor(e,t={}){super(e,t),this.mediaSource_=null,this.subtitlesTrack_=null,this.featuresNativeTextTracks_=e.featuresNativeTextTracks,this.loadVttJs=e.loadVttJs,this.shouldSaveSegmentTimingInfo_=!1}buffered_(){if(!this.subtitlesTrack_||!this.subtitlesTrack_.cues||!this.subtitlesTrack_.cues.length)return ti();const e=this.subtitlesTrack_.cues,t=e[0].startTime,i=e[e.length-1].startTime;return ti([[t,i]])}initSegmentForMap(e,t=!1){if(!e)return null;const i=jd(e);let s=this.initSegments_[i];if(t&&!s&&e.bytes){const r=jS.byteLength+e.bytes.byteLength,o=new Uint8Array(r);o.set(e.bytes),o.set(jS,e.bytes.byteLength),this.initSegments_[i]=s={resolvedUri:e.resolvedUri,byterange:e.byterange,bytes:o}}return s||e}couldBeginLoading_(){return this.playlist_&&this.subtitlesTrack_&&!this.paused()}init_(){return this.state="READY",this.resetEverything(),this.monitorBuffer_()}track(e){return typeof e>"u"?this.subtitlesTrack_:(this.subtitlesTrack_=e,this.state==="INIT"&&this.couldBeginLoading_()&&this.init_(),this.subtitlesTrack_)}remove(e,t){eh(e,t,this.subtitlesTrack_)}fillBuffer_(){const e=this.chooseNextRequest_();if(e){if(this.syncController_.timestampOffsetForTimeline(e.timeline)===null){const t=()=>{this.state="READY",this.paused()||this.monitorBuffer_()};this.syncController_.one("timestampoffset",t),this.state="WAITING_ON_TIMELINE";return}this.loadSegment_(e)}}timestampOffsetForSegment_(){return null}chooseNextRequest_(){return this.skipEmptySegments_(super.chooseNextRequest_())}skipEmptySegments_(e){for(;e&&e.segment.empty;){if(e.mediaIndex+1>=e.playlist.segments.length){e=null;break}e=this.generateSegmentInfo_({playlist:e.playlist,mediaIndex:e.mediaIndex+1,startOfSegment:e.startOfSegment+e.duration,isSyncRequest:e.isSyncRequest})}return e}stopForError(e){this.error(e),this.state="READY",this.pause(),this.trigger("error")}segmentRequestFinished_(e,t,i){if(!this.subtitlesTrack_){this.state="READY";return}if(this.saveTransferStats_(t.stats),!this.pendingSegment_){this.state="READY",this.mediaRequestsAborted+=1;return}if(e){e.code===ys.TIMEOUT&&this.handleTimeout_(),e.code===ys.ABORTED?this.mediaRequestsAborted+=1:this.mediaRequestsErrored+=1,this.stopForError(e);return}const s=this.pendingSegment_,r=i.mp4VttCues&&i.mp4VttCues.length;r&&(s.mp4VttCues=i.mp4VttCues),this.saveBandwidthRelatedStats_(s.duration,t.stats),t.key&&this.segmentKey(t.key,!0),this.state="APPENDING",this.trigger("appending");const o=s.segment;if(o.map&&(o.map.bytes=t.map.bytes),s.bytes=t.bytes,typeof V.WebVTT!="function"&&typeof this.loadVttJs=="function"){this.state="WAITING_ON_VTTJS",this.loadVttJs().then(()=>this.segmentRequestFinished_(e,t,i),()=>this.stopForError({message:"Error loading vtt.js"}));return}o.requested=!0;try{this.parseVTTCues_(s)}catch(a){this.stopForError({message:a.message,metadata:{errorType:Y.Error.StreamingVttParserError,error:a}});return}if(r||this.updateTimeMapping_(s,this.syncController_.timelines[s.timeline],this.playlist_),s.cues.length?s.timingInfo={start:s.cues[0].startTime,end:s.cues[s.cues.length-1].endTime}:s.timingInfo={start:s.startOfSegment,end:s.startOfSegment+s.duration},s.isSyncRequest){this.trigger("syncinfoupdate"),this.pendingSegment_=null,this.state="READY";return}s.byteLength=s.bytes.byteLength,this.mediaSecondsLoaded+=o.duration,s.cues.forEach(a=>{this.subtitlesTrack_.addCue(this.featuresNativeTextTracks_?new V.VTTCue(a.startTime,a.endTime,a.text):a)}),hF(this.subtitlesTrack_),this.handleAppendsDone_()}handleData_(e,t){const i=e&&e.type==="vtt",s=t&&t.type==="text";i&&s&&super.handleData_(e,t)}updateTimingInfoEnd_(){}parseMp4VttCues_(e){const t=this.sourceUpdater_.videoTimestampOffset()===null?this.sourceUpdater_.audioTimestampOffset():this.sourceUpdater_.videoTimestampOffset();e.mp4VttCues.forEach(i=>{const s=i.start+t,r=i.end+t,o=new V.VTTCue(s,r,i.cueText);i.settings&&i.settings.split(" ").forEach(a=>{const l=a.split(":"),h=l[0],u=l[1];o[h]=isNaN(u)?u:Number(u)}),e.cues.push(o)})}parseVTTCues_(e){let t,i=!1;if(typeof V.WebVTT!="function")throw new kF;if(e.cues=[],e.timestampmap={MPEGTS:0,LOCAL:0},e.mp4VttCues){this.parseMp4VttCues_(e);return}typeof V.TextDecoder=="function"?t=new V.TextDecoder("utf8"):(t=V.WebVTT.StringDecoder(),i=!0);const s=new V.WebVTT.Parser(V,V.vttjs,t);if(s.oncue=e.cues.push.bind(e.cues),s.ontimestampmap=o=>{e.timestampmap=o},s.onparsingerror=o=>{Y.log.warn("Error encountered when parsing cues: "+o.message)},e.segment.map){let o=e.segment.map.bytes;i&&(o=zS(o)),s.parse(o)}let r=e.bytes;i&&(r=zS(r)),s.parse(r),s.flush()}updateTimeMapping_(e,t,i){const s=e.segment;if(!t)return;if(!e.cues.length){s.empty=!0;return}const{MPEGTS:r,LOCAL:o}=e.timestampmap,l=r/mo.ONE_SECOND_IN_TS-o+t.mapping;if(e.cues.forEach(h=>{const u=h.endTime-h.startTime,c=this.handleRollover_(h.startTime+l,t.time);h.startTime=Math.max(c,0),h.endTime=Math.max(c+u,0)}),!i.syncInfo){const h=e.cues[0].startTime,u=e.cues[e.cues.length-1].startTime;i.syncInfo={mediaSequence:i.mediaSequence+e.mediaIndex,time:Math.min(h,u-s.duration)}}}handleRollover_(e,t){if(t===null)return e;let i=e*mo.ONE_SECOND_IN_TS;const s=t*mo.ONE_SECOND_IN_TS;let r;for(s<i?r=-8589934592:r=8589934592;Math.abs(i-s)>4294967296;)i+=r;return i/mo.ONE_SECOND_IN_TS}}const EF=function(n,e){const t=n.cues;for(let i=0;i<t.length;i++){const s=t[i];if(e>=s.adStartTime&&e<=s.adEndTime)return s}return null},AF=function(n,e,t=0){if(!n.segments)return;let i=t,s;for(let r=0;r<n.segments.length;r++){const o=n.segments[r];if(s||(s=EF(e,i+o.duration/2)),s){if("cueIn"in o){s.endTime=i,s.adEndTime=i,i+=o.duration,s=null;continue}if(i<s.endTime){i+=o.duration;continue}s.endTime+=o.duration}else if("cueOut"in o&&(s=new V.VTTCue(i,i+o.duration,o.cueOut),s.adStartTime=i,s.adEndTime=i+parseFloat(o.cueOut),e.addCue(s)),"cueOutCont"in o){const[a,l]=o.cueOutCont.split("/").map(parseFloat);s=new V.VTTCue(i,i+o.duration,""),s.adStartTime=i-a,s.adEndTime=s.adStartTime+l,e.addCue(s)}i+=o.duration}};class XS{constructor({start:e,end:t,segmentIndex:i,partIndex:s=null,appended:r=!1}){this.start_=e,this.end_=t,this.segmentIndex_=i,this.partIndex_=s,this.appended_=r}isInRange(e){return e>=this.start&&e<this.end}markAppended(){this.appended_=!0}resetAppendedStatus(){this.appended_=!1}get isAppended(){return this.appended_}get start(){return this.start_}get end(){return this.end_}get segmentIndex(){return this.segmentIndex_}get partIndex(){return this.partIndex_}}class PF{constructor(e,t=[]){this.segmentSyncInfo_=e,this.partsSyncInfo_=t}get segmentSyncInfo(){return this.segmentSyncInfo_}get partsSyncInfo(){return this.partsSyncInfo_}get hasPartsSyncInfo(){return this.partsSyncInfo_.length>0}resetAppendStatus(){this.segmentSyncInfo_.resetAppendedStatus(),this.partsSyncInfo_.forEach(e=>e.resetAppendedStatus())}}class WC{constructor(){this.storage_=new Map,this.diagnostics_="",this.isReliable_=!1,this.start_=-1/0,this.end_=1/0}get start(){return this.start_}get end(){return this.end_}get diagnostics(){return this.diagnostics_}get isReliable(){return this.isReliable_}resetAppendedStatus(){this.storage_.forEach(e=>e.resetAppendStatus())}update(e,t){const{mediaSequence:i,segments:s}=e;if(this.isReliable_=this.isReliablePlaylist_(i,s),!!this.isReliable_)return this.updateStorage_(s,i,this.calculateBaseTime_(i,s,t))}getSyncInfoForTime(e){for(const{segmentSyncInfo:t,partsSyncInfo:i}of this.storage_.values())if(i.length){for(const s of i)if(s.isInRange(e))return s}else if(t.isInRange(e))return t;return null}getSyncInfoForMediaSequence(e){return this.storage_.get(e)}updateStorage_(e,t,i){const s=new Map;let r=`
`,o=i,a=t;this.start_=o,e.forEach((l,h)=>{const u=this.storage_.get(a),c=o,f=c+l.duration,p=!!(u&&u.segmentSyncInfo&&u.segmentSyncInfo.isAppended),b=new XS({start:c,end:f,appended:p,segmentIndex:h});l.syncInfo=b;let y=o;const _=(l.parts||[]).map((T,w)=>{const v=y,S=y+T.duration,k=!!(u&&u.partsSyncInfo&&u.partsSyncInfo[w]&&u.partsSyncInfo[w].isAppended),A=new XS({start:v,end:S,appended:k,segmentIndex:h,partIndex:w});return y=S,r+=`Media Sequence: ${a}.${w} | Range: ${v} --> ${S} | Appended: ${k}
`,T.syncInfo=A,A});s.set(a,new PF(b,_)),r+=`${zC(l.resolvedUri)} | Media Sequence: ${a} | Range: ${c} --> ${f} | Appended: ${p}
`,a++,o=f}),this.end_=o,this.storage_=s,this.diagnostics_=r}calculateBaseTime_(e,t,i){if(!this.storage_.size)return 0;if(this.storage_.has(e))return this.storage_.get(e).segmentSyncInfo.start;const s=Math.min(...this.storage_.keys());if(e<s){const r=s-e;let o=this.storage_.get(s).segmentSyncInfo.start;for(let a=0;a<r;a++){const l=t[a];o-=l.duration}return o}return i}isReliablePlaylist_(e,t){return e!=null&&Array.isArray(t)&&t.length}}class HS extends WC{constructor(e){super(),this.parent_=e}calculateBaseTime_(e,t,i){if(!this.storage_.size){const s=this.parent_.getSyncInfoForMediaSequence(e);return s?s.segmentSyncInfo.start:0}return super.calculateBaseTime_(e,t,i)}}const DF=86400,_m=[{name:"VOD",run:(n,e,t,i,s)=>t!==1/0?{time:0,segmentIndex:0,partIndex:null}:null},{name:"MediaSequence",run:(n,e,t,i,s,r)=>{const o=n.getMediaSequenceSync(r);if(!o||!o.isReliable)return null;const a=o.getSyncInfoForTime(s);return a?{time:a.start,partIndex:a.partIndex,segmentIndex:a.segmentIndex}:null}},{name:"ProgramDateTime",run:(n,e,t,i,s)=>{if(!Object.keys(n.timelineToDatetimeMappings).length)return null;let r=null,o=null;const a=Jg(e);s=s||0;for(let l=0;l<a.length;l++){const h=e.endList||s===0?l:a.length-(l+1),u=a[h],c=u.segment,f=n.timelineToDatetimeMappings[c.timeline];if(!f||!c.dateTimeObject)continue;let b=c.dateTimeObject.getTime()/1e3+f;if(c.parts&&typeof u.partIndex=="number")for(let _=0;_<u.partIndex;_++)b+=c.parts[_].duration;const y=Math.abs(s-b);if(o!==null&&(y===0||o<y))break;o=y,r={time:b,segmentIndex:u.segmentIndex,partIndex:u.partIndex}}return r}},{name:"Segment",run:(n,e,t,i,s)=>{let r=null,o=null;s=s||0;const a=Jg(e);for(let l=0;l<a.length;l++){const h=e.endList||s===0?l:a.length-(l+1),u=a[h],c=u.segment,f=u.part&&u.part.start||c&&c.start;if(c.timeline===i&&typeof f<"u"){const p=Math.abs(s-f);if(o!==null&&o<p)break;(!r||o===null||o>=p)&&(o=p,r={time:f,segmentIndex:u.segmentIndex,partIndex:u.partIndex})}}return r}},{name:"Discontinuity",run:(n,e,t,i,s)=>{let r=null;if(s=s||0,e.discontinuityStarts&&e.discontinuityStarts.length){let o=null;for(let a=0;a<e.discontinuityStarts.length;a++){const l=e.discontinuityStarts[a],h=e.discontinuitySequence+a+1,u=n.discontinuities[h];if(u){const c=Math.abs(s-u.time);if(o!==null&&o<c)break;(!r||o===null||o>=c)&&(o=c,r={time:u.time,segmentIndex:l,partIndex:null})}}}return r}},{name:"Playlist",run:(n,e,t,i,s)=>e.syncInfo?{time:e.syncInfo.time,segmentIndex:e.syncInfo.mediaSequence-e.mediaSequence,partIndex:null}:null}];class MF extends Y.EventTarget{constructor(e={}){super(),this.timelines=[],this.discontinuities=[],this.timelineToDatetimeMappings={};const t=new WC,i=new HS(t),s=new HS(t);this.mediaSequenceStorage_={main:t,audio:i,vtt:s},this.logger_=Mn("SyncController")}getMediaSequenceSync(e){return this.mediaSequenceStorage_[e]||null}getSyncPoint(e,t,i,s,r){if(t!==1/0)return _m.find(({name:l})=>l==="VOD").run(this,e,t);const o=this.runStrategies_(e,t,i,s,r);if(!o.length)return null;for(const a of o){const{syncPoint:l,strategy:h}=a,{segmentIndex:u,time:c}=l;if(u<0)continue;const f=e.segments[u],p=c,b=p+f.duration;if(this.logger_(`Strategy: ${h}. Current time: ${s}. selected segment: ${u}. Time: [${p} -> ${b}]}`),s>=p&&s<b)return this.logger_("Found sync point with exact match: ",l),l}return this.selectSyncPoint_(o,{key:"time",value:s})}getExpiredTime(e,t){if(!e||!e.segments)return null;const i=this.runStrategies_(e,t,e.discontinuitySequence,0);if(!i.length)return null;const s=this.selectSyncPoint_(i,{key:"segmentIndex",value:0});return s.segmentIndex>0&&(s.time*=-1),Math.abs(s.time+vh({defaultDuration:e.targetDuration,durationList:e.segments,startIndex:s.segmentIndex,endIndex:0}))}runStrategies_(e,t,i,s,r){const o=[];for(let a=0;a<_m.length;a++){const l=_m[a],h=l.run(this,e,t,i,s,r);h&&(h.strategy=l.name,o.push({strategy:l.name,syncPoint:h}))}return o}selectSyncPoint_(e,t){let i=e[0].syncPoint,s=Math.abs(e[0].syncPoint[t.key]-t.value),r=e[0].strategy;for(let o=1;o<e.length;o++){const a=Math.abs(e[o].syncPoint[t.key]-t.value);a<s&&(s=a,i=e[o].syncPoint,r=e[o].strategy)}return this.logger_(`syncPoint for [${t.key}: ${t.value}] chosen with strategy [${r}]: [time:${i.time}, segmentIndex:${i.segmentIndex}`+(typeof i.partIndex=="number"?`,partIndex:${i.partIndex}`:"")+"]"),i}saveExpiredSegmentInfo(e,t){const i=t.mediaSequence-e.mediaSequence;if(i>DF){Y.log.warn(`Not saving expired segment info. Media sequence gap ${i} is too large.`);return}for(let s=i-1;s>=0;s--){const r=e.segments[s];if(r&&typeof r.start<"u"){t.syncInfo={mediaSequence:e.mediaSequence+s,time:r.start},this.logger_(`playlist refresh sync: [time:${t.syncInfo.time}, mediaSequence: ${t.syncInfo.mediaSequence}]`),this.trigger("syncinfoupdate");break}}}setDateTimeMappingForStart(e){if(this.timelineToDatetimeMappings={},e.segments&&e.segments.length&&e.segments[0].dateTimeObject){const t=e.segments[0],i=t.dateTimeObject.getTime()/1e3;this.timelineToDatetimeMappings[t.timeline]=-i}}saveSegmentTimingInfo({segmentInfo:e,shouldSaveTimelineMapping:t}){const i=this.calculateSegmentTimeMapping_(e,e.timingInfo,t),s=e.segment;i&&(this.saveDiscontinuitySyncInfo_(e),e.playlist.syncInfo||(e.playlist.syncInfo={mediaSequence:e.playlist.mediaSequence+e.mediaIndex,time:s.start}));const r=s.dateTimeObject;s.discontinuity&&t&&r&&(this.timelineToDatetimeMappings[s.timeline]=-(r.getTime()/1e3))}timestampOffsetForTimeline(e){return typeof this.timelines[e]>"u"?null:this.timelines[e].time}mappingForTimeline(e){return typeof this.timelines[e]>"u"?null:this.timelines[e].mapping}calculateSegmentTimeMapping_(e,t,i){const s=e.segment,r=e.part;let o=this.timelines[e.timeline],a,l;if(typeof e.timestampOffset=="number")o={time:e.startOfSegment,mapping:e.startOfSegment-t.start},i&&(this.timelines[e.timeline]=o,this.trigger("timestampoffset"),this.logger_(`time mapping for timeline ${e.timeline}: [time: ${o.time}] [mapping: ${o.mapping}]`)),a=e.startOfSegment,l=t.end+o.mapping;else if(o)a=t.start+o.mapping,l=t.end+o.mapping;else return!1;return r&&(r.start=a,r.end=l),(!s.start||a<s.start)&&(s.start=a),s.end=l,!0}saveDiscontinuitySyncInfo_(e){const t=e.playlist,i=e.segment;if(i.discontinuity)this.discontinuities[i.timeline]={time:i.start,accuracy:0};else if(t.discontinuityStarts&&t.discontinuityStarts.length)for(let s=0;s<t.discontinuityStarts.length;s++){const r=t.discontinuityStarts[s],o=t.discontinuitySequence+s+1,a=r-e.mediaIndex,l=Math.abs(a);if(!this.discontinuities[o]||this.discontinuities[o].accuracy>l){let h;a<0?h=i.start-vh({defaultDuration:t.targetDuration,durationList:t.segments,startIndex:e.mediaIndex,endIndex:r}):h=i.end+vh({defaultDuration:t.targetDuration,durationList:t.segments,startIndex:e.mediaIndex+1,endIndex:r}),this.discontinuities[o]={time:h,accuracy:l}}}}dispose(){this.trigger("dispose"),this.off()}}class IF extends Y.EventTarget{constructor(){super(),this.pendingTimelineChanges_={},this.lastTimelineChanges_={}}clearPendingTimelineChange(e){this.pendingTimelineChanges_[e]=null,this.trigger("pendingtimelinechange")}pendingTimelineChange({type:e,from:t,to:i}){return typeof t=="number"&&typeof i=="number"&&(this.pendingTimelineChanges_[e]={type:e,from:t,to:i},this.trigger("pendingtimelinechange")),this.pendingTimelineChanges_[e]}lastTimelineChange({type:e,from:t,to:i}){if(typeof t=="number"&&typeof i=="number"){this.lastTimelineChanges_[e]={type:e,from:t,to:i},delete this.pendingTimelineChanges_[e];const s={timelineChangeInfo:{from:t,to:i}};this.trigger({type:"timelinechange",metadata:s})}return this.lastTimelineChanges_[e]}dispose(){this.trigger("dispose"),this.pendingTimelineChanges_={},this.lastTimelineChanges_={},this.off()}}const RF=IC(RC(function(){var n=(function(){function y(){this.listeners={}}var _=y.prototype;return _.on=function(w,v){this.listeners[w]||(this.listeners[w]=[]),this.listeners[w].push(v)},_.off=function(w,v){if(!this.listeners[w])return!1;var S=this.listeners[w].indexOf(v);return this.listeners[w]=this.listeners[w].slice(0),this.listeners[w].splice(S,1),S>-1},_.trigger=function(w){var v=this.listeners[w];if(v)if(arguments.length===2)for(var S=v.length,k=0;k<S;++k)v[k].call(this,arguments[1]);else for(var A=Array.prototype.slice.call(arguments,1),M=v.length,B=0;B<M;++B)v[B].apply(this,A)},_.dispose=function(){this.listeners={}},_.pipe=function(w){this.on("data",function(v){w.push(v)})},y})();/*! @name pkcs7 @version 1.0.4 @license Apache-2.0 */function e(y){return y.subarray(0,y.byteLength-y[y.byteLength-1])}/*! @name aes-decrypter @version 4.0.2 @license Apache-2.0 */const t=function(){const y=[[[],[],[],[],[]],[[],[],[],[],[]]],_=y[0],T=y[1],w=_[4],v=T[4];let S,k,A;const M=[],B=[];let P,R,q,z,X,Z;for(S=0;S<256;S++)B[(M[S]=S<<1^(S>>7)*283)^S]=S;for(k=A=0;!w[k];k^=P||1,A=B[A]||1)for(z=A^A<<1^A<<2^A<<3^A<<4,z=z>>8^z&255^99,w[k]=z,v[z]=k,q=M[R=M[P=M[k]]],Z=q*16843009^R*65537^P*257^k*16843008,X=M[z]*257^z*16843008,S=0;S<4;S++)_[S][k]=X=X<<24^X>>>8,T[S][z]=Z=Z<<24^Z>>>8;for(S=0;S<5;S++)_[S]=_[S].slice(0),T[S]=T[S].slice(0);return y};let i=null;class s{constructor(_){i||(i=t()),this._tables=[[i[0][0].slice(),i[0][1].slice(),i[0][2].slice(),i[0][3].slice(),i[0][4].slice()],[i[1][0].slice(),i[1][1].slice(),i[1][2].slice(),i[1][3].slice(),i[1][4].slice()]];let T,w,v;const S=this._tables[0][4],k=this._tables[1],A=_.length;let M=1;if(A!==4&&A!==6&&A!==8)throw new Error("Invalid aes key size");const B=_.slice(0),P=[];for(this._key=[B,P],T=A;T<4*A+28;T++)v=B[T-1],(T%A===0||A===8&&T%A===4)&&(v=S[v>>>24]<<24^S[v>>16&255]<<16^S[v>>8&255]<<8^S[v&255],T%A===0&&(v=v<<8^v>>>24^M<<24,M=M<<1^(M>>7)*283)),B[T]=B[T-A]^v;for(w=0;T;w++,T--)v=B[w&3?T:T-4],T<=4||w<4?P[w]=v:P[w]=k[0][S[v>>>24]]^k[1][S[v>>16&255]]^k[2][S[v>>8&255]]^k[3][S[v&255]]}decrypt(_,T,w,v,S,k){const A=this._key[1];let M=_^A[0],B=v^A[1],P=w^A[2],R=T^A[3],q,z,X;const Z=A.length/4-2;let K,oe=4;const G=this._tables[1],ee=G[0],te=G[1],re=G[2],ne=G[3],ve=G[4];for(K=0;K<Z;K++)q=ee[M>>>24]^te[B>>16&255]^re[P>>8&255]^ne[R&255]^A[oe],z=ee[B>>>24]^te[P>>16&255]^re[R>>8&255]^ne[M&255]^A[oe+1],X=ee[P>>>24]^te[R>>16&255]^re[M>>8&255]^ne[B&255]^A[oe+2],R=ee[R>>>24]^te[M>>16&255]^re[B>>8&255]^ne[P&255]^A[oe+3],oe+=4,M=q,B=z,P=X;for(K=0;K<4;K++)S[(3&-K)+k]=ve[M>>>24]<<24^ve[B>>16&255]<<16^ve[P>>8&255]<<8^ve[R&255]^A[oe++],q=M,M=B,B=P,P=R,R=q}}class r extends n{constructor(){super(n),this.jobs=[],this.delay=1,this.timeout_=null}processJob_(){this.jobs.shift()(),this.jobs.length?this.timeout_=setTimeout(this.processJob_.bind(this),this.delay):this.timeout_=null}push(_){this.jobs.push(_),this.timeout_||(this.timeout_=setTimeout(this.processJob_.bind(this),this.delay))}}const o=function(y){return y<<24|(y&65280)<<8|(y&16711680)>>8|y>>>24},a=function(y,_,T){const w=new Int32Array(y.buffer,y.byteOffset,y.byteLength>>2),v=new s(Array.prototype.slice.call(_)),S=new Uint8Array(y.byteLength),k=new Int32Array(S.buffer);let A,M,B,P,R,q,z,X,Z;for(A=T[0],M=T[1],B=T[2],P=T[3],Z=0;Z<w.length;Z+=4)R=o(w[Z]),q=o(w[Z+1]),z=o(w[Z+2]),X=o(w[Z+3]),v.decrypt(R,q,z,X,k,Z),k[Z]=o(k[Z]^A),k[Z+1]=o(k[Z+1]^M),k[Z+2]=o(k[Z+2]^B),k[Z+3]=o(k[Z+3]^P),A=R,M=q,B=z,P=X;return S};class l{constructor(_,T,w,v){const S=l.STEP,k=new Int32Array(_.buffer),A=new Uint8Array(_.byteLength);let M=0;for(this.asyncStream_=new r,this.asyncStream_.push(this.decryptChunk_(k.subarray(M,M+S),T,w,A)),M=S;M<k.length;M+=S)w=new Uint32Array([o(k[M-4]),o(k[M-3]),o(k[M-2]),o(k[M-1])]),this.asyncStream_.push(this.decryptChunk_(k.subarray(M,M+S),T,w,A));this.asyncStream_.push(function(){v(null,e(A))})}static get STEP(){return 32e3}decryptChunk_(_,T,w,v){return function(){const S=a(_,T,w);v.set(S,_.byteOffset)}}}var h=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},u;typeof window<"u"?u=window:typeof h<"u"?u=h:typeof self<"u"?u=self:u={};var c=u,f=function(_){return ArrayBuffer.isView==="function"?ArrayBuffer.isView(_):_&&_.buffer instanceof ArrayBuffer},p=c.BigInt||Number;p("0x1"),p("0x100"),p("0x10000"),p("0x1000000"),p("0x100000000"),p("0x10000000000"),p("0x1000000000000"),p("0x100000000000000"),p("0x10000000000000000"),(function(){var y=new Uint16Array([65484]),_=new Uint8Array(y.buffer,y.byteOffset,y.byteLength);return _[0]===255?"big":_[0]===204?"little":"unknown"})();const b=function(y){const _={};return Object.keys(y).forEach(T=>{const w=y[T];f(w)?_[T]={bytes:w.buffer,byteOffset:w.byteOffset,byteLength:w.byteLength}:_[T]=w}),_};self.onmessage=function(y){const _=y.data,T=new Uint8Array(_.encrypted.bytes,_.encrypted.byteOffset,_.encrypted.byteLength),w=new Uint32Array(_.key.bytes,_.key.byteOffset,_.key.byteLength/4),v=new Uint32Array(_.iv.bytes,_.iv.byteOffset,_.iv.byteLength/4);new l(T,w,v,function(S,k){self.postMessage(b({source:_.source,decrypted:k}),[k.buffer])})}}));var LF=MC(RF);const $F=n=>{let e=n.default?"main":"alternative";return n.characteristics&&n.characteristics.indexOf("public.accessibility.describes-video")>=0&&(e="main-desc"),e},ZC=(n,e)=>{n.abort(),n.pause(),e&&e.activePlaylistLoader&&(e.activePlaylistLoader.pause(),e.activePlaylistLoader=null)},u0=(n,e)=>{e.activePlaylistLoader=n,n.load()},QF=(n,e)=>()=>{const{segmentLoaders:{[n]:t,main:i},mediaTypes:{[n]:s}}=e,r=s.activeTrack(),o=s.getActiveGroup(),a=s.activePlaylistLoader,l=s.lastGroup_;if(!(o&&l&&o.id===l.id)&&(s.lastGroup_=o,s.lastTrack_=r,ZC(t,s),!(!o||o.isMainPlaylist))){if(!o.playlistLoader){a&&i.resetEverything();return}t.resyncLoader(),u0(o.playlistLoader,s)}},BF=(n,e)=>()=>{const{segmentLoaders:{[n]:t},mediaTypes:{[n]:i}}=e;i.lastGroup_=null,t.abort(),t.pause()},NF=(n,e)=>()=>{const{mainPlaylistLoader:t,segmentLoaders:{[n]:i,main:s},mediaTypes:{[n]:r}}=e,o=r.activeTrack(),a=r.getActiveGroup(),l=r.activePlaylistLoader,h=r.lastTrack_;if(!(h&&o&&h.id===o.id)&&(r.lastGroup_=a,r.lastTrack_=o,ZC(i,r),!!a)){if(a.isMainPlaylist){if(!o||!h||o.id===h.id)return;const u=e.vhs.playlistController_,c=u.selectPlaylist();if(u.media()===c)return;r.logger_(`track change. Switching main audio from ${h.id} to ${o.id}`),t.pause(),s.resetEverything(),u.fastQualityChange_(c);return}if(n==="AUDIO"){if(!a.playlistLoader){s.setAudio(!0),s.resetEverything();return}i.setAudio(!0),s.setAudio(!1)}if(l===a.playlistLoader){u0(a.playlistLoader,r);return}i.track&&i.track(o),i.resetEverything(),u0(a.playlistLoader,r)}},Xd={AUDIO:(n,e)=>()=>{const{mediaTypes:{[n]:t},excludePlaylist:i}=e,s=t.activeTrack(),r=t.activeGroup(),o=(r.filter(l=>l.default)[0]||r[0]).id,a=t.tracks[o];if(s===a){i({error:{message:"Problem encountered loading the default audio track."}});return}Y.log.warn("Problem encountered loading the alternate audio track.Switching back to default.");for(const l in t.tracks)t.tracks[l].enabled=t.tracks[l]===a;t.onTrackChanged()},SUBTITLES:(n,e)=>()=>{const{mediaTypes:{[n]:t}}=e;Y.log.warn("Problem encountered loading the subtitle track.Disabling subtitle track.");const i=t.activeTrack();i&&(i.mode="disabled"),t.onTrackChanged()}},WS={AUDIO:(n,e,t)=>{if(!e)return;const{tech:i,requestOptions:s,segmentLoaders:{[n]:r}}=t;e.on("loadedmetadata",()=>{const o=e.media();r.playlist(o,s),(!i.paused()||o.endList&&i.preload()!=="none")&&r.load()}),e.on("loadedplaylist",()=>{r.playlist(e.media(),s),i.paused()||r.load()}),e.on("error",Xd[n](n,t))},SUBTITLES:(n,e,t)=>{const{tech:i,requestOptions:s,segmentLoaders:{[n]:r},mediaTypes:{[n]:o}}=t;e.on("loadedmetadata",()=>{const a=e.media();r.playlist(a,s),r.track(o.activeTrack()),(!i.paused()||a.endList&&i.preload()!=="none")&&r.load()}),e.on("loadedplaylist",()=>{r.playlist(e.media(),s),i.paused()||r.load()}),e.on("error",Xd[n](n,t))}},FF={AUDIO:(n,e)=>{const{vhs:t,sourceType:i,segmentLoaders:{[n]:s},requestOptions:r,main:{mediaGroups:o},mediaTypes:{[n]:{groups:a,tracks:l,logger_:h}},mainPlaylistLoader:u}=e,c=_u(u.main);(!o[n]||Object.keys(o[n]).length===0)&&(o[n]={main:{default:{default:!0}}},c&&(o[n].main.default.playlists=u.main.playlists));for(const f in o[n]){a[f]||(a[f]=[]);for(const p in o[n][f]){let b=o[n][f][p],y;if(c?(h(`AUDIO group '${f}' label '${p}' is a main playlist`),b.isMainPlaylist=!0,y=null):i==="vhs-json"&&b.playlists?y=new ha(b.playlists[0],t,r):b.resolvedUri?y=new ha(b.resolvedUri,t,r):b.playlists&&i==="dash"?y=new r0(b.playlists[0],t,r,u):y=null,b=et({id:p,playlistLoader:y},b),WS[n](n,b.playlistLoader,e),a[f].push(b),typeof l[p]>"u"){const _=new Y.AudioTrack({id:p,kind:$F(b),enabled:!1,language:b.language,default:b.default,label:p});l[p]=_}}}s.on("error",Xd[n](n,e))},SUBTITLES:(n,e)=>{const{tech:t,vhs:i,sourceType:s,segmentLoaders:{[n]:r},requestOptions:o,main:{mediaGroups:a},mediaTypes:{[n]:{groups:l,tracks:h}},mainPlaylistLoader:u}=e;for(const c in a[n]){l[c]||(l[c]=[]);for(const f in a[n][c]){if(!i.options_.useForcedSubtitles&&a[n][c][f].forced)continue;let p=a[n][c][f],b;if(s==="hls")b=new ha(p.resolvedUri,i,o);else if(s==="dash"){if(!p.playlists.filter(_=>_.excludeUntil!==1/0).length)return;b=new r0(p.playlists[0],i,o,u)}else s==="vhs-json"&&(b=new ha(p.playlists?p.playlists[0]:p.resolvedUri,i,o));if(p=et({id:f,playlistLoader:b},p),WS[n](n,p.playlistLoader,e),l[c].push(p),typeof h[f]>"u"){const y=t.addRemoteTextTrack({id:f,kind:"subtitles",default:p.default&&p.autoselect,language:p.language,label:f},!1).track;h[f]=y}}}r.on("error",Xd[n](n,e))},"CLOSED-CAPTIONS":(n,e)=>{const{tech:t,main:{mediaGroups:i},mediaTypes:{[n]:{groups:s,tracks:r}}}=e;for(const o in i[n]){s[o]||(s[o]=[]);for(const a in i[n][o]){const l=i[n][o][a];if(!/^(?:CC|SERVICE)/.test(l.instreamId))continue;const h=t.options_.vhs&&t.options_.vhs.captionServices||{};let u={label:a,language:l.language,instreamId:l.instreamId,default:l.default&&l.autoselect};if(h[u.instreamId]&&(u=et(u,h[u.instreamId])),u.default===void 0&&delete u.default,s[o].push(et({id:a},l)),typeof r[a]>"u"){const c=t.addRemoteTextTrack({id:u.instreamId,kind:"captions",default:u.default,language:u.language,label:u.label},!1).track;r[a]=c}}}}},YC=(n,e)=>{for(let t=0;t<n.length;t++)if(ab(e,n[t])||n[t].playlists&&YC(n[t].playlists,e))return!0;return!1},VF=(n,e)=>t=>{const{mainPlaylistLoader:i,mediaTypes:{[n]:{groups:s}}}=e,r=i.media();if(!r)return null;let o=null;r.attributes[n]&&(o=s[r.attributes[n]]);const a=Object.keys(s);if(!o)if(n==="AUDIO"&&a.length>1&&_u(e.main))for(let l=0;l<a.length;l++){const h=s[a[l]];if(YC(h,r)){o=h;break}}else s.main?o=s.main:a.length===1&&(o=s[a[0]]);return typeof t>"u"?o:t===null||!o?null:o.filter(l=>l.id===t.id)[0]||null},UF={AUDIO:(n,e)=>()=>{const{mediaTypes:{[n]:{tracks:t}}}=e;for(const i in t)if(t[i].enabled)return t[i];return null},SUBTITLES:(n,e)=>()=>{const{mediaTypes:{[n]:{tracks:t}}}=e;for(const i in t)if(t[i].mode==="showing"||t[i].mode==="hidden")return t[i];return null}},qF=(n,{mediaTypes:e})=>()=>{const t=e[n].activeTrack();return t?e[n].activeGroup(t):null},zF=n=>{["AUDIO","SUBTITLES","CLOSED-CAPTIONS"].forEach(h=>{FF[h](h,n)});const{mediaTypes:e,mainPlaylistLoader:t,tech:i,vhs:s,segmentLoaders:{["AUDIO"]:r,main:o}}=n;["AUDIO","SUBTITLES"].forEach(h=>{e[h].activeGroup=VF(h,n),e[h].activeTrack=UF[h](h,n),e[h].onGroupChanged=QF(h,n),e[h].onGroupChanging=BF(h,n),e[h].onTrackChanged=NF(h,n),e[h].getActiveGroup=qF(h,n)});const a=e.AUDIO.activeGroup();if(a){const h=(a.filter(c=>c.default)[0]||a[0]).id;e.AUDIO.tracks[h].enabled=!0,e.AUDIO.onGroupChanged(),e.AUDIO.onTrackChanged(),e.AUDIO.getActiveGroup().playlistLoader?(o.setAudio(!1),r.setAudio(!0)):o.setAudio(!0)}t.on("mediachange",()=>{["AUDIO","SUBTITLES"].forEach(h=>e[h].onGroupChanged())}),t.on("mediachanging",()=>{["AUDIO","SUBTITLES"].forEach(h=>e[h].onGroupChanging())});const l=()=>{e.AUDIO.onTrackChanged(),i.trigger({type:"usage",name:"vhs-audio-change"})};i.audioTracks().addEventListener("change",l),i.remoteTextTracks().addEventListener("change",e.SUBTITLES.onTrackChanged),s.on("dispose",()=>{i.audioTracks().removeEventListener("change",l),i.remoteTextTracks().removeEventListener("change",e.SUBTITLES.onTrackChanged)}),i.clearTracks("audio");for(const h in e.AUDIO.tracks)i.audioTracks().addTrack(e.AUDIO.tracks[h])},jF=()=>{const n={};return["AUDIO","SUBTITLES","CLOSED-CAPTIONS"].forEach(e=>{n[e]={groups:{},tracks:{},activePlaylistLoader:null,activeGroup:Ks,activeTrack:Ks,getActiveGroup:Ks,onGroupChanged:Ks,onTrackChanged:Ks,lastTrack_:null,logger_:Mn(`MediaGroups[${e}]`)}}),n};class ZS{constructor(){this.priority_=[],this.pathwayClones_=new Map}set version(e){e===1&&(this.version_=e)}set ttl(e){this.ttl_=e||300}set reloadUri(e){e&&(this.reloadUri_=qi(this.reloadUri_,e))}set priority(e){e&&e.length&&(this.priority_=e)}set pathwayClones(e){e&&e.length&&(this.pathwayClones_=new Map(e.map(t=>[t.ID,t])))}get version(){return this.version_}get ttl(){return this.ttl_}get reloadUri(){return this.reloadUri_}get priority(){return this.priority_}get pathwayClones(){return this.pathwayClones_}}class XF extends Y.EventTarget{constructor(e,t){super(),this.currentPathway=null,this.defaultPathway=null,this.queryBeforeStart=!1,this.availablePathways_=new Set,this.steeringManifest=new ZS,this.proxyServerUrl_=null,this.manifestType_=null,this.ttlTimeout_=null,this.request_=null,this.currentPathwayClones=new Map,this.nextPathwayClones=new Map,this.excludedSteeringManifestURLs=new Set,this.logger_=Mn("Content Steering"),this.xhr_=e,this.getBandwidth_=t}assignTagProperties(e,t){this.manifestType_=t.serverUri?"HLS":"DASH";const i=t.serverUri||t.serverURL;if(!i){this.logger_(`steering manifest URL is ${i}, cannot request steering manifest.`),this.trigger("error");return}if(i.startsWith("data:")){this.decodeDataUriManifest_(i.substring(i.indexOf(",")+1));return}this.steeringManifest.reloadUri=qi(e,i),this.defaultPathway=t.pathwayId||t.defaultServiceLocation,this.queryBeforeStart=t.queryBeforeStart,this.proxyServerUrl_=t.proxyServerURL,this.defaultPathway&&!this.queryBeforeStart&&this.trigger("content-steering")}requestSteeringManifest(e){const t=this.steeringManifest.reloadUri;if(!t)return;const i=e?t:this.getRequestURI(t);if(!i){this.logger_("No valid content steering manifest URIs. Stopping content steering."),this.trigger("error"),this.dispose();return}const s={contentSteeringInfo:{uri:i}};this.trigger({type:"contentsteeringloadstart",metadata:s}),this.request_=this.xhr_({uri:i,requestType:"content-steering-manifest"},(r,o)=>{if(r){if(o.status===410){this.logger_(`manifest request 410 ${r}.`),this.logger_(`There will be no more content steering requests to ${i} this session.`),this.excludedSteeringManifestURLs.add(i);return}if(o.status===429){const h=o.responseHeaders["retry-after"];this.logger_(`manifest request 429 ${r}.`),this.logger_(`content steering will retry in ${h} seconds.`),this.startTTLTimeout_(parseInt(h,10));return}this.logger_(`manifest failed to load ${r}.`),this.startTTLTimeout_();return}this.trigger({type:"contentsteeringloadcomplete",metadata:s});let a;try{a=JSON.parse(this.request_.responseText)}catch(h){const u={errorType:Y.Error.StreamingContentSteeringParserError,error:h};this.trigger({type:"error",metadata:u})}this.assignSteeringProperties_(a);const l={contentSteeringInfo:s.contentSteeringInfo,contentSteeringManifest:{version:this.steeringManifest.version,reloadUri:this.steeringManifest.reloadUri,priority:this.steeringManifest.priority}};this.trigger({type:"contentsteeringparsed",metadata:l}),this.startTTLTimeout_()})}setProxyServerUrl_(e){const t=new V.URL(e),i=new V.URL(this.proxyServerUrl_);return i.searchParams.set("url",encodeURI(t.toString())),this.setSteeringParams_(i.toString())}decodeDataUriManifest_(e){const t=JSON.parse(V.atob(e));this.assignSteeringProperties_(t)}setSteeringParams_(e){const t=new V.URL(e),i=this.getPathway(),s=this.getBandwidth_();if(i){const r=`_${this.manifestType_}_pathway`;t.searchParams.set(r,i)}if(s){const r=`_${this.manifestType_}_throughput`;t.searchParams.set(r,s)}return t.toString()}assignSteeringProperties_(e){if(this.steeringManifest.version=e.VERSION,!this.steeringManifest.version){this.logger_(`manifest version is ${e.VERSION}, which is not supported.`),this.trigger("error");return}this.steeringManifest.ttl=e.TTL,this.steeringManifest.reloadUri=e["RELOAD-URI"],this.steeringManifest.priority=e["PATHWAY-PRIORITY"]||e["SERVICE-LOCATION-PRIORITY"],this.steeringManifest.pathwayClones=e["PATHWAY-CLONES"],this.nextPathwayClones=this.steeringManifest.pathwayClones,this.availablePathways_.size||(this.logger_("There are no available pathways for content steering. Ending content steering."),this.trigger("error"),this.dispose());const i=(s=>{for(const r of s)if(this.availablePathways_.has(r))return r;return[...this.availablePathways_][0]})(this.steeringManifest.priority);this.currentPathway!==i&&(this.currentPathway=i,this.trigger("content-steering"))}getPathway(){return this.currentPathway||this.defaultPathway}getRequestURI(e){if(!e)return null;const t=s=>this.excludedSteeringManifestURLs.has(s);if(this.proxyServerUrl_){const s=this.setProxyServerUrl_(e);if(!t(s))return s}const i=this.setSteeringParams_(e);return t(i)?null:i}startTTLTimeout_(e=this.steeringManifest.ttl){const t=e*1e3;this.ttlTimeout_=V.setTimeout(()=>{this.requestSteeringManifest()},t)}clearTTLTimeout_(){V.clearTimeout(this.ttlTimeout_),this.ttlTimeout_=null}abort(){this.request_&&this.request_.abort(),this.request_=null}dispose(){this.off("content-steering"),this.off("error"),this.abort(),this.clearTTLTimeout_(),this.currentPathway=null,this.defaultPathway=null,this.queryBeforeStart=null,this.proxyServerUrl_=null,this.manifestType_=null,this.ttlTimeout_=null,this.request_=null,this.excludedSteeringManifestURLs=new Set,this.availablePathways_=new Set,this.steeringManifest=new ZS}addAvailablePathway(e){e&&this.availablePathways_.add(e)}clearAvailablePathways(){this.availablePathways_.clear()}excludePathway(e){return this.availablePathways_.delete(e)}didDASHTagChange(e,t){return!t&&this.steeringManifest.reloadUri||t&&(qi(e,t.serverURL)!==this.steeringManifest.reloadUri||t.defaultServiceLocation!==this.defaultPathway||t.queryBeforeStart!==this.queryBeforeStart||t.proxyServerURL!==this.proxyServerUrl_)}getAvailablePathways(){return this.availablePathways_}}const HF=(n,e)=>{let t=null;return(...i)=>{clearTimeout(t),t=setTimeout(()=>{n.apply(null,i)},e)}},WF=10;let yr;const ZF=["mediaRequests","mediaRequestsAborted","mediaRequestsTimedout","mediaRequestsErrored","mediaTransferDuration","mediaBytesTransferred","mediaAppends"],YF=function(n){return this.audioSegmentLoader_[n]+this.mainSegmentLoader_[n]},GF=function({currentPlaylist:n,buffered:e,currentTime:t,nextPlaylist:i,bufferLowWaterLine:s,bufferHighWaterLine:r,duration:o,bufferBasedABR:a,log:l}){if(!i)return Y.log.warn("We received no playlist to switch to. Please check your stream."),!1;const h=`allowing switch ${n&&n.id||"null"} -> ${i.id}`;if(!n)return l(`${h} as current playlist is not set`),!0;if(i.id===n.id)return!1;const u=!!la(e,t).length;if(!n.endList)return!u&&typeof n.partTargetDuration=="number"?(l(`not ${h} as current playlist is live llhls, but currentTime isn't in buffered.`),!1):(l(`${h} as current playlist is live`),!0);const c=sb(e,t),f=a?Jt.EXPERIMENTAL_MAX_BUFFER_LOW_WATER_LINE:Jt.MAX_BUFFER_LOW_WATER_LINE;if(o<f)return l(`${h} as duration < max low water line (${o} < ${f})`),!0;const p=i.attributes.BANDWIDTH,b=n.attributes.BANDWIDTH;if(p<b&&(!a||c<r)){let y=`${h} as next bandwidth < current bandwidth (${p} < ${b})`;return a&&(y+=` and forwardBuffer < bufferHighWaterLine (${c} < ${r})`),l(y),!0}if((!a||p>b)&&c>=s){let y=`${h} as forwardBuffer >= bufferLowWaterLine (${c} >= ${s})`;return a&&(y+=` and next bandwidth > current bandwidth (${p} > ${b})`),l(y),!0}return l(`not ${h} as no switching criteria met`),!1};class KF extends Y.EventTarget{constructor(e){super(),this.fastQualityChange_=HF(this.fastQualityChange_.bind(this),100);const{src:t,withCredentials:i,tech:s,bandwidth:r,externVhs:o,useCueTags:a,playlistExclusionDuration:l,enableLowInitialPlaylist:h,sourceType:u,cacheEncryptionKeys:c,bufferBasedABR:f,leastPixelDiffSelector:p,captionServices:b,experimentalUseMMS:y}=e;if(!t)throw new Error("A non-empty playlist URL or JSON manifest string is required");let{maxPlaylistRetries:_}=e;(_===null||typeof _>"u")&&(_=1/0),yr=o,this.bufferBasedABR=!!f,this.leastPixelDiffSelector=!!p,this.withCredentials=i,this.tech_=s,this.vhs_=s.vhs,this.player_=e.player_,this.sourceType_=u,this.useCueTags_=a,this.playlistExclusionDuration=l,this.maxPlaylistRetries=_,this.enableLowInitialPlaylist=h,this.usingManagedMediaSource_=!1,this.useCueTags_&&(this.cueTagsTrack_=this.tech_.addTextTrack("metadata","ad-cues"),this.cueTagsTrack_.inBandMetadataTrackDispatchType=""),this.requestOptions_={withCredentials:i,maxPlaylistRetries:_,timeout:null},this.on("error",this.pauseLoading),this.mediaTypes_=jF(),y&&V.ManagedMediaSource?(this.tech_.el_.disableRemotePlayback=!0,this.mediaSource=new V.ManagedMediaSource,this.usingManagedMediaSource_=!0,Y.log("Using ManagedMediaSource")):V.MediaSource&&(this.mediaSource=new V.MediaSource),this.handleDurationChange_=this.handleDurationChange_.bind(this),this.handleSourceOpen_=this.handleSourceOpen_.bind(this),this.handleSourceEnded_=this.handleSourceEnded_.bind(this),this.load=this.load.bind(this),this.pause=this.pause.bind(this),this.mediaSource.addEventListener("durationchange",this.handleDurationChange_),this.mediaSource.addEventListener("sourceopen",this.handleSourceOpen_),this.mediaSource.addEventListener("sourceended",this.handleSourceEnded_),this.mediaSource.addEventListener("startstreaming",this.load),this.mediaSource.addEventListener("endstreaming",this.pause),this.seekable_=ti(),this.hasPlayed_=!1,this.syncController_=new MF(e),this.segmentMetadataTrack_=s.addRemoteTextTrack({kind:"metadata",label:"segment-metadata"},!1).track,this.segmentMetadataTrack_.mode="hidden",this.decrypter_=new LF,this.sourceUpdater_=new HC(this.mediaSource),this.inbandTextTracks_={},this.timelineChangeController_=new IF,this.keyStatusMap_=new Map;const T={vhs:this.vhs_,parse708captions:e.parse708captions,useDtsForTimestampOffset:e.useDtsForTimestampOffset,captionServices:b,mediaSource:this.mediaSource,currentTime:this.tech_.currentTime.bind(this.tech_),seekable:()=>this.seekable(),seeking:()=>this.tech_.seeking(),duration:()=>this.duration(),hasPlayed:()=>this.hasPlayed_,goalBufferLength:()=>this.goalBufferLength(),bandwidth:r,syncController:this.syncController_,decrypter:this.decrypter_,sourceType:this.sourceType_,inbandTextTracks:this.inbandTextTracks_,cacheEncryptionKeys:c,sourceUpdater:this.sourceUpdater_,timelineChangeController:this.timelineChangeController_,exactManifestTimings:e.exactManifestTimings,addMetadataToTextTrack:this.addMetadataToTextTrack.bind(this)};this.mainPlaylistLoader_=this.sourceType_==="dash"?new r0(t,this.vhs_,et(this.requestOptions_,{addMetadataToTextTrack:this.addMetadataToTextTrack.bind(this)})):new ha(t,this.vhs_,et(this.requestOptions_,{addDateRangesToTextTrack:this.addDateRangesToTextTrack_.bind(this)})),this.setupMainPlaylistLoaderListeners_(),this.mainSegmentLoader_=new l0(et(T,{segmentMetadataTrack:this.segmentMetadataTrack_,loaderType:"main"}),e),this.audioSegmentLoader_=new l0(et(T,{loaderType:"audio"}),e),this.subtitleSegmentLoader_=new CF(et(T,{loaderType:"vtt",featuresNativeTextTracks:this.tech_.featuresNativeTextTracks,loadVttJs:()=>new Promise((S,k)=>{function A(){s.off("vttjserror",M),S()}function M(){s.off("vttjsloaded",A),k()}s.one("vttjsloaded",A),s.one("vttjserror",M),s.addWebVttScript_()})}),e);const w=()=>this.mainSegmentLoader_.bandwidth;this.contentSteeringController_=new XF(this.vhs_.xhr,w),this.setupSegmentLoaderListeners_(),this.bufferBasedABR&&(this.mainPlaylistLoader_.one("loadedplaylist",()=>this.startABRTimer_()),this.tech_.on("pause",()=>this.stopABRTimer_()),this.tech_.on("play",()=>this.startABRTimer_())),ZF.forEach(S=>{this[S+"_"]=YF.bind(this,S)}),this.logger_=Mn("pc"),this.triggeredFmp4Usage=!1,this.tech_.preload()==="none"?(this.loadOnPlay_=()=>{this.loadOnPlay_=null,this.mainPlaylistLoader_.load()},this.tech_.one("play",this.loadOnPlay_)):this.mainPlaylistLoader_.load(),this.timeToLoadedData__=-1,this.mainAppendsToLoadedData__=-1,this.audioAppendsToLoadedData__=-1;const v=this.tech_.preload()==="none"?"play":"loadstart";this.tech_.one(v,()=>{const S=Date.now();this.tech_.one("loadeddata",()=>{this.timeToLoadedData__=Date.now()-S,this.mainAppendsToLoadedData__=this.mainSegmentLoader_.mediaAppends,this.audioAppendsToLoadedData__=this.audioSegmentLoader_.mediaAppends})})}mainAppendsToLoadedData_(){return this.mainAppendsToLoadedData__}audioAppendsToLoadedData_(){return this.audioAppendsToLoadedData__}appendsToLoadedData_(){const e=this.mainAppendsToLoadedData_(),t=this.audioAppendsToLoadedData_();return e===-1||t===-1?-1:e+t}timeToLoadedData_(){return this.timeToLoadedData__}checkABR_(e="abr"){const t=this.selectPlaylist();t&&this.shouldSwitchToMedia_(t)&&this.switchMedia_(t,e)}switchMedia_(e,t,i){const s=this.media(),r=s&&(s.id||s.uri),o=e&&(e.id||e.uri);if(r&&r!==o){this.logger_(`switch media ${r} -> ${o} from ${t}`);const a={renditionInfo:{id:o,bandwidth:e.attributes.BANDWIDTH,resolution:e.attributes.RESOLUTION,codecs:e.attributes.CODECS},cause:t};this.trigger({type:"renditionselected",metadata:a}),this.tech_.trigger({type:"usage",name:`vhs-rendition-change-${t}`})}this.mainPlaylistLoader_.media(e,i)}switchMediaForDASHContentSteering_(){["AUDIO","SUBTITLES","CLOSED-CAPTIONS"].forEach(e=>{const t=this.mediaTypes_[e],i=t?t.activeGroup():null,s=this.contentSteeringController_.getPathway();if(i&&s){const o=(i.length?i[0].playlists:i.playlists).filter(a=>a.attributes.serviceLocation===s);o.length&&this.mediaTypes_[e].activePlaylistLoader.media(o[0])}})}startABRTimer_(){this.stopABRTimer_(),this.abrTimer_=V.setInterval(()=>this.checkABR_(),250)}stopABRTimer_(){this.tech_.scrubbing&&this.tech_.scrubbing()||(V.clearInterval(this.abrTimer_),this.abrTimer_=null)}getAudioTrackPlaylists_(){const e=this.main(),t=e&&e.playlists||[];if(!e||!e.mediaGroups||!e.mediaGroups.AUDIO)return t;const i=e.mediaGroups.AUDIO,s=Object.keys(i);let r;if(Object.keys(this.mediaTypes_.AUDIO.groups).length)r=this.mediaTypes_.AUDIO.activeTrack();else{const a=i.main||s.length&&i[s[0]];for(const l in a)if(a[l].default){r={label:l};break}}if(!r)return t;const o=[];for(const a in i)if(i[a][r.label]){const l=i[a][r.label];if(l.playlists&&l.playlists.length)o.push.apply(o,l.playlists);else if(l.uri)o.push(l);else if(e.playlists.length)for(let h=0;h<e.playlists.length;h++){const u=e.playlists[h];u.attributes&&u.attributes.AUDIO&&u.attributes.AUDIO===a&&o.push(u)}}return o.length?o:t}setupMainPlaylistLoaderListeners_(){this.mainPlaylistLoader_.on("loadedmetadata",()=>{const t=this.mainPlaylistLoader_.media(),i=t.targetDuration*1.5*1e3;e0(this.mainPlaylistLoader_.main,this.mainPlaylistLoader_.media())?this.requestOptions_.timeout=0:this.requestOptions_.timeout=i,t.endList&&this.tech_.preload()!=="none"&&(this.mainSegmentLoader_.playlist(t,this.requestOptions_),this.mainSegmentLoader_.load()),zF({sourceType:this.sourceType_,segmentLoaders:{AUDIO:this.audioSegmentLoader_,SUBTITLES:this.subtitleSegmentLoader_,main:this.mainSegmentLoader_},tech:this.tech_,requestOptions:this.requestOptions_,mainPlaylistLoader:this.mainPlaylistLoader_,vhs:this.vhs_,main:this.main(),mediaTypes:this.mediaTypes_,excludePlaylist:this.excludePlaylist.bind(this)}),this.triggerPresenceUsage_(this.main(),t),this.setupFirstPlay(),!this.mediaTypes_.AUDIO.activePlaylistLoader||this.mediaTypes_.AUDIO.activePlaylistLoader.media()?this.trigger("selectedinitialmedia"):this.mediaTypes_.AUDIO.activePlaylistLoader.one("loadedmetadata",()=>{this.trigger("selectedinitialmedia")})}),this.mainPlaylistLoader_.on("loadedplaylist",()=>{this.loadOnPlay_&&this.tech_.off("play",this.loadOnPlay_);let t=this.mainPlaylistLoader_.media();if(!t){this.attachContentSteeringListeners_(),this.initContentSteeringController_(),this.excludeUnsupportedVariants_();let i;if(this.enableLowInitialPlaylist&&(i=this.selectInitialPlaylist()),i||(i=this.selectPlaylist()),!i||!this.shouldSwitchToMedia_(i)||(this.initialMedia_=i,this.switchMedia_(this.initialMedia_,"initial"),!(this.sourceType_==="vhs-json"&&this.initialMedia_.segments)))return;t=this.initialMedia_}this.handleUpdatedMediaPlaylist(t)}),this.mainPlaylistLoader_.on("error",()=>{const t=this.mainPlaylistLoader_.error;this.excludePlaylist({playlistToExclude:t.playlist,error:t})}),this.mainPlaylistLoader_.on("mediachanging",()=>{this.mainSegmentLoader_.abort(),this.mainSegmentLoader_.pause()}),this.mainPlaylistLoader_.on("mediachange",()=>{const t=this.mainPlaylistLoader_.media(),i=t.targetDuration*1.5*1e3;e0(this.mainPlaylistLoader_.main,this.mainPlaylistLoader_.media())?this.requestOptions_.timeout=0:this.requestOptions_.timeout=i,this.sourceType_==="dash"&&this.mainPlaylistLoader_.isPaused&&this.mainPlaylistLoader_.load(),this.mainSegmentLoader_.pause(),this.mainSegmentLoader_.playlist(t,this.requestOptions_),this.waitingForFastQualityPlaylistReceived_?this.runFastQualitySwitch_():this.mainSegmentLoader_.load(),this.tech_.trigger({type:"mediachange",bubbles:!0})}),this.mainPlaylistLoader_.on("playlistunchanged",()=>{const t=this.mainPlaylistLoader_.media();if(t.lastExcludeReason_==="playlist-unchanged")return;this.stuckAtPlaylistEnd_(t)&&(this.excludePlaylist({error:{message:"Playlist no longer updating.",reason:"playlist-unchanged"}}),this.tech_.trigger("playliststuck"))}),this.mainPlaylistLoader_.on("renditiondisabled",()=>{this.tech_.trigger({type:"usage",name:"vhs-rendition-disabled"})}),this.mainPlaylistLoader_.on("renditionenabled",()=>{this.tech_.trigger({type:"usage",name:"vhs-rendition-enabled"})}),["manifestrequeststart","manifestrequestcomplete","manifestparsestart","manifestparsecomplete","playlistrequeststart","playlistrequestcomplete","playlistparsestart","playlistparsecomplete","renditiondisabled","renditionenabled"].forEach(t=>{this.mainPlaylistLoader_.on(t,i=>{this.player_.trigger(Nt({},i))})})}handleUpdatedMediaPlaylist(e){this.useCueTags_&&this.updateAdCues_(e),this.mainSegmentLoader_.pause(),this.mainSegmentLoader_.playlist(e,this.requestOptions_),this.waitingForFastQualityPlaylistReceived_&&this.runFastQualitySwitch_(),this.updateDuration(!e.endList),this.tech_.paused()||(this.mainSegmentLoader_.load(),this.audioSegmentLoader_&&this.audioSegmentLoader_.load())}triggerPresenceUsage_(e,t){const i=e.mediaGroups||{};let s=!0;const r=Object.keys(i.AUDIO);for(const o in i.AUDIO)for(const a in i.AUDIO[o])i.AUDIO[o][a].uri||(s=!1);s&&this.tech_.trigger({type:"usage",name:"vhs-demuxed"}),Object.keys(i.SUBTITLES).length&&this.tech_.trigger({type:"usage",name:"vhs-webvtt"}),yr.Playlist.isAes(t)&&this.tech_.trigger({type:"usage",name:"vhs-aes"}),r.length&&Object.keys(i.AUDIO[r[0]]).length>1&&this.tech_.trigger({type:"usage",name:"vhs-alternate-audio"}),this.useCueTags_&&this.tech_.trigger({type:"usage",name:"vhs-playlist-cue-tags"})}shouldSwitchToMedia_(e){const t=this.mainPlaylistLoader_.media()||this.mainPlaylistLoader_.pendingMedia_,i=this.tech_.currentTime(),s=this.bufferLowWaterLine(),r=this.bufferHighWaterLine(),o=this.tech_.buffered();return GF({buffered:o,currentTime:i,currentPlaylist:t,nextPlaylist:e,bufferLowWaterLine:s,bufferHighWaterLine:r,duration:this.duration(),bufferBasedABR:this.bufferBasedABR,log:this.logger_})}setupSegmentLoaderListeners_(){this.mainSegmentLoader_.on("bandwidthupdate",()=>{this.checkABR_("bandwidthupdate"),this.tech_.trigger("bandwidthupdate")}),this.mainSegmentLoader_.on("timeout",()=>{this.bufferBasedABR&&this.mainSegmentLoader_.load()}),this.bufferBasedABR||this.mainSegmentLoader_.on("progress",()=>{this.trigger("progress")}),this.mainSegmentLoader_.on("error",()=>{const i=this.mainSegmentLoader_.error();this.excludePlaylist({playlistToExclude:i.playlist,error:i})}),this.mainSegmentLoader_.on("appenderror",()=>{this.error=this.mainSegmentLoader_.error_,this.trigger("error")}),this.mainSegmentLoader_.on("syncinfoupdate",()=>{this.onSyncInfoUpdate_()}),this.mainSegmentLoader_.on("timestampoffset",()=>{this.tech_.trigger({type:"usage",name:"vhs-timestamp-offset"})}),this.audioSegmentLoader_.on("syncinfoupdate",()=>{this.onSyncInfoUpdate_()}),this.audioSegmentLoader_.on("appenderror",()=>{this.error=this.audioSegmentLoader_.error_,this.trigger("error")}),this.mainSegmentLoader_.on("ended",()=>{this.logger_("main segment loader ended"),this.onEndOfStream()}),this.timelineChangeController_.on("audioTimelineBehind",()=>{const i=this.audioSegmentLoader_.pendingSegment_;if(!i||!i.segment||!i.segment.syncInfo)return;const s=i.segment.syncInfo.end+.01;this.tech_.setCurrentTime(s)}),this.timelineChangeController_.on("fixBadTimelineChange",()=>{this.logger_("Fix bad timeline change. Restarting al segment loaders..."),this.mainSegmentLoader_.pause(),this.mainSegmentLoader_.resetEverything(),this.mediaTypes_.AUDIO.activePlaylistLoader&&(this.audioSegmentLoader_.pause(),this.audioSegmentLoader_.resetEverything()),this.mediaTypes_.SUBTITLES.activePlaylistLoader&&(this.subtitleSegmentLoader_.pause(),this.subtitleSegmentLoader_.resetEverything()),this.load()}),this.mainSegmentLoader_.on("earlyabort",i=>{this.bufferBasedABR||(this.delegateLoaders_("all",["abort"]),this.excludePlaylist({error:{message:"Aborted early because there isn't enough bandwidth to complete the request without rebuffering."},playlistExclusionDuration:WF}))});const e=()=>{if(!this.sourceUpdater_.hasCreatedSourceBuffers())return this.tryToCreateSourceBuffers_();const i=this.getCodecsOrExclude_();i&&this.sourceUpdater_.addOrChangeSourceBuffers(i)};this.mainSegmentLoader_.on("trackinfo",e),this.audioSegmentLoader_.on("trackinfo",e),this.mainSegmentLoader_.on("fmp4",()=>{this.triggeredFmp4Usage||(this.tech_.trigger({type:"usage",name:"vhs-fmp4"}),this.triggeredFmp4Usage=!0)}),this.audioSegmentLoader_.on("fmp4",()=>{this.triggeredFmp4Usage||(this.tech_.trigger({type:"usage",name:"vhs-fmp4"}),this.triggeredFmp4Usage=!0)}),this.audioSegmentLoader_.on("ended",()=>{this.logger_("audioSegmentLoader ended"),this.onEndOfStream()}),["segmentselected","segmentloadstart","segmentloaded","segmentkeyloadstart","segmentkeyloadcomplete","segmentdecryptionstart","segmentdecryptioncomplete","segmenttransmuxingstart","segmenttransmuxingcomplete","segmenttransmuxingtrackinfoavailable","segmenttransmuxingtiminginfoavailable","segmentappendstart","appendsdone","bandwidthupdated","timelinechange","codecschange"].forEach(i=>{this.mainSegmentLoader_.on(i,s=>{this.player_.trigger(Nt({},s))}),this.audioSegmentLoader_.on(i,s=>{this.player_.trigger(Nt({},s))}),this.subtitleSegmentLoader_.on(i,s=>{this.player_.trigger(Nt({},s))})})}mediaSecondsLoaded_(){return Math.max(this.audioSegmentLoader_.mediaSecondsLoaded+this.mainSegmentLoader_.mediaSecondsLoaded)}load(){this.mainSegmentLoader_.load(),this.mediaTypes_.AUDIO.activePlaylistLoader&&this.audioSegmentLoader_.load(),this.mediaTypes_.SUBTITLES.activePlaylistLoader&&this.subtitleSegmentLoader_.load()}pause(){this.mainSegmentLoader_.pause(),this.mediaTypes_.AUDIO.activePlaylistLoader&&this.audioSegmentLoader_.pause(),this.mediaTypes_.SUBTITLES.activePlaylistLoader&&this.subtitleSegmentLoader_.pause()}fastQualityChange_(e=this.selectPlaylist()){if(e&&e===this.mainPlaylistLoader_.media()){this.logger_("skipping fastQualityChange because new media is same as old");return}this.switchMedia_(e,"fast-quality"),this.waitingForFastQualityPlaylistReceived_=!0}runFastQualitySwitch_(){this.waitingForFastQualityPlaylistReceived_=!1,this.mainSegmentLoader_.pause(),this.mainSegmentLoader_.resetEverything(),this.mediaTypes_.AUDIO.activePlaylistLoader&&(this.audioSegmentLoader_.pause(),this.audioSegmentLoader_.resetEverything()),this.mediaTypes_.SUBTITLES.activePlaylistLoader&&(this.subtitleSegmentLoader_.pause(),this.subtitleSegmentLoader_.resetEverything()),this.load()}play(){if(this.setupFirstPlay())return;this.tech_.ended()&&this.tech_.setCurrentTime(0),this.hasPlayed_&&this.load();const e=this.tech_.seekable();if(this.tech_.duration()===1/0&&this.tech_.currentTime()<e.start(0))return this.tech_.setCurrentTime(e.end(e.length-1))}setupFirstPlay(){const e=this.mainPlaylistLoader_.media();if(!e||this.tech_.paused()||this.hasPlayed_)return!1;if(!e.endList||e.start){const t=this.seekable();if(!t.length)return!1;const i=t.end(0);let s=i;if(e.start){const r=e.start.timeOffset;r<0?s=Math.max(i+r,t.start(0)):s=Math.min(i,r)}this.trigger("firstplay"),this.tech_.setCurrentTime(s)}return this.hasPlayed_=!0,this.load(),!0}handleSourceOpen_(){if(this.tryToCreateSourceBuffers_(),this.tech_.autoplay()){const e=this.tech_.play();typeof e<"u"&&typeof e.then=="function"&&e.then(null,t=>{})}this.trigger("sourceopen")}handleSourceEnded_(){if(!this.inbandTextTracks_.metadataTrack_)return;const e=this.inbandTextTracks_.metadataTrack_.cues;if(!e||!e.length)return;const t=this.duration();e[e.length-1].endTime=isNaN(t)||Math.abs(t)===1/0?Number.MAX_VALUE:t}handleDurationChange_(){this.tech_.trigger("durationchange")}onEndOfStream(){let e=this.mainSegmentLoader_.ended_;if(this.mediaTypes_.AUDIO.activePlaylistLoader){const t=this.mainSegmentLoader_.getCurrentMediaInfo_();!t||t.hasVideo?e=e&&this.audioSegmentLoader_.ended_:e=this.audioSegmentLoader_.ended_}e&&(this.stopABRTimer_(),this.sourceUpdater_.endOfStream())}stuckAtPlaylistEnd_(e){if(!this.seekable().length)return!1;const i=this.syncController_.getExpiredTime(e,this.duration());if(i===null)return!1;const s=yr.Playlist.playlistEnd(e,i),r=this.tech_.currentTime(),o=this.tech_.buffered();if(!o.length)return s-r<=Os;const a=o.end(o.length-1);return a-r<=Os&&s-a<=Os}excludePlaylist({playlistToExclude:e=this.mainPlaylistLoader_.media(),error:t={},playlistExclusionDuration:i}){if(e=e||this.mainPlaylistLoader_.media(),i=i||t.playlistExclusionDuration||this.playlistExclusionDuration,!e){this.error=t,this.mediaSource.readyState!=="open"?this.trigger("error"):this.sourceUpdater_.endOfStream("network");return}e.playlistErrors_++;const s=this.mainPlaylistLoader_.main.playlists,r=s.filter(rp),o=r.length===1&&r[0]===e;if(s.length===1&&i!==1/0)return Y.log.warn(`Problem encountered with playlist ${e.id}. Trying again since it is the only playlist.`),this.tech_.trigger("retryplaylist"),this.mainPlaylistLoader_.load(o);if(o){if(this.main().contentSteering){const b=this.pathwayAttribute_(e),y=this.contentSteeringController_.steeringManifest.ttl*1e3;this.contentSteeringController_.excludePathway(b),this.excludeThenChangePathway_(),setTimeout(()=>{this.contentSteeringController_.addAvailablePathway(b)},y);return}let p=!1;s.forEach(b=>{if(b===e)return;const y=b.excludeUntil;typeof y<"u"&&y!==1/0&&(p=!0,delete b.excludeUntil)}),p&&(Y.log.warn("Removing other playlists from the exclusion list because the last rendition is about to be excluded."),this.tech_.trigger("retryplaylist"))}let a;e.playlistErrors_>this.maxPlaylistRetries?a=1/0:a=Date.now()+i*1e3,e.excludeUntil=a,t.reason&&(e.lastExcludeReason_=t.reason),this.tech_.trigger("excludeplaylist"),this.tech_.trigger({type:"usage",name:"vhs-rendition-excluded"});const l=this.selectPlaylist();if(!l){this.error="Playback cannot continue. No available working or supported playlists.",this.trigger("error");return}const h=t.internal?this.logger_:Y.log.warn,u=t.message?" "+t.message:"";h(`${t.internal?"Internal problem":"Problem"} encountered with playlist ${e.id}.${u} Switching to playlist ${l.id}.`),l.attributes.AUDIO!==e.attributes.AUDIO&&this.delegateLoaders_("audio",["abort","pause"]),l.attributes.SUBTITLES!==e.attributes.SUBTITLES&&this.delegateLoaders_("subtitle",["abort","pause"]),this.delegateLoaders_("main",["abort","pause"]);const c=l.targetDuration/2*1e3||5*1e3,f=typeof l.lastRequest=="number"&&Date.now()-l.lastRequest<=c;return this.switchMedia_(l,"exclude",o||f)}pauseLoading(){this.delegateLoaders_("all",["abort","pause"]),this.stopABRTimer_()}delegateLoaders_(e,t){const i=[],s=e==="all";(s||e==="main")&&i.push(this.mainPlaylistLoader_);const r=[];(s||e==="audio")&&r.push("AUDIO"),(s||e==="subtitle")&&(r.push("CLOSED-CAPTIONS"),r.push("SUBTITLES")),r.forEach(o=>{const a=this.mediaTypes_[o]&&this.mediaTypes_[o].activePlaylistLoader;a&&i.push(a)}),["main","audio","subtitle"].forEach(o=>{const a=this[`${o}SegmentLoader_`];a&&(e===o||e==="all")&&i.push(a)}),i.forEach(o=>t.forEach(a=>{typeof o[a]=="function"&&o[a]()}))}setCurrentTime(e){const t=la(this.tech_.buffered(),e);if(!(this.mainPlaylistLoader_&&this.mainPlaylistLoader_.media())||!this.mainPlaylistLoader_.media().segments)return 0;if(t&&t.length)return e;this.mainSegmentLoader_.pause(),this.mainSegmentLoader_.resetEverything(),this.mediaTypes_.AUDIO.activePlaylistLoader&&(this.audioSegmentLoader_.pause(),this.audioSegmentLoader_.resetEverything()),this.mediaTypes_.SUBTITLES.activePlaylistLoader&&(this.subtitleSegmentLoader_.pause(),this.subtitleSegmentLoader_.resetEverything()),this.load()}duration(){if(!this.mainPlaylistLoader_)return 0;const e=this.mainPlaylistLoader_.media();return e?e.endList?this.mediaSource?this.mediaSource.duration:yr.Playlist.duration(e):1/0:0}seekable(){return this.seekable_}getSeekableRange_(e,t){const i=e.media();if(!i)return null;const s=this.syncController_.getMediaSequenceSync(t);if(s&&s.isReliable){const a=s.start,l=s.end;if(!isFinite(a)||!isFinite(l))return null;const h=yr.Playlist.liveEdgeDelay(this.mainPlaylistLoader_.main,i),u=Math.max(a,l-h);return ti([[a,u]])}const r=this.syncController_.getExpiredTime(i,this.duration());if(r===null)return null;const o=yr.Playlist.seekable(i,r,yr.Playlist.liveEdgeDelay(this.mainPlaylistLoader_.main,i));return o.length?o:null}computeFinalSeekable_(e,t){if(!t)return e;const i=e.start(0),s=e.end(0),r=t.start(0),o=t.end(0);return r>s||i>o?e:ti([[Math.max(i,r),Math.min(s,o)]])}onSyncInfoUpdate_(){if(!this.mainPlaylistLoader_)return;const e=this.getSeekableRange_(this.mainPlaylistLoader_,"main");if(!e)return;let t;if(this.mediaTypes_.AUDIO.activePlaylistLoader&&(t=this.getSeekableRange_(this.mediaTypes_.AUDIO.activePlaylistLoader,"audio"),!t))return;const i=this.seekable_;if(this.seekable_=this.computeFinalSeekable_(e,t),!this.seekable_||i&&i.length&&this.seekable_.length&&i.start(0)===this.seekable_.start(0)&&i.end(0)===this.seekable_.end(0))return;this.logger_(`seekable updated [${oC(this.seekable_)}]`);const s={seekableRanges:this.seekable_};this.trigger({type:"seekablerangeschanged",metadata:s}),this.tech_.trigger("seekablechanged")}updateDuration(e){if(this.updateDuration_&&(this.mediaSource.removeEventListener("sourceopen",this.updateDuration_),this.updateDuration_=null),this.mediaSource.readyState!=="open"){this.updateDuration_=this.updateDuration.bind(this,e),this.mediaSource.addEventListener("sourceopen",this.updateDuration_);return}if(e){const s=this.seekable();if(!s.length)return;(isNaN(this.mediaSource.duration)||this.mediaSource.duration<s.end(s.length-1))&&this.sourceUpdater_.setDuration(s.end(s.length-1));return}const t=this.tech_.buffered();let i=yr.Playlist.duration(this.mainPlaylistLoader_.media());t.length>0&&(i=Math.max(i,t.end(t.length-1))),this.mediaSource.duration!==i&&this.sourceUpdater_.setDuration(i)}dispose(){this.trigger("dispose"),this.decrypter_.terminate(),this.mainPlaylistLoader_.dispose(),this.mainSegmentLoader_.dispose(),this.contentSteeringController_.dispose(),this.keyStatusMap_.clear(),this.loadOnPlay_&&this.tech_.off("play",this.loadOnPlay_),["AUDIO","SUBTITLES"].forEach(e=>{const t=this.mediaTypes_[e].groups;for(const i in t)t[i].forEach(s=>{s.playlistLoader&&s.playlistLoader.dispose()})}),this.audioSegmentLoader_.dispose(),this.subtitleSegmentLoader_.dispose(),this.sourceUpdater_.dispose(),this.timelineChangeController_.dispose(),this.stopABRTimer_(),this.updateDuration_&&this.mediaSource.removeEventListener("sourceopen",this.updateDuration_),this.mediaSource.removeEventListener("durationchange",this.handleDurationChange_),this.mediaSource.removeEventListener("sourceopen",this.handleSourceOpen_),this.mediaSource.removeEventListener("sourceended",this.handleSourceEnded_),this.off()}main(){return this.mainPlaylistLoader_.main}media(){return this.mainPlaylistLoader_.media()||this.initialMedia_}areMediaTypesKnown_(){const e=!!this.mediaTypes_.AUDIO.activePlaylistLoader,t=!!this.mainSegmentLoader_.getCurrentMediaInfo_(),i=e?!!this.audioSegmentLoader_.getCurrentMediaInfo_():!0;return!(!t||!i)}getCodecsOrExclude_(){const e={main:this.mainSegmentLoader_.getCurrentMediaInfo_()||{},audio:this.audioSegmentLoader_.getCurrentMediaInfo_()||{}},t=this.mainSegmentLoader_.getPendingSegmentPlaylist()||this.media();e.video=e.main;const i=Sh(this.main(),t),s={},r=!!this.mediaTypes_.AUDIO.activePlaylistLoader;if(e.main.hasVideo&&(s.video=i.video||e.main.videoCodec||F5),e.main.isMuxed&&(s.video+=`,${i.audio||e.main.audioCodec||B1}`),(e.main.hasAudio&&!e.main.isMuxed||e.audio.hasAudio||r)&&(s.audio=i.audio||e.main.audioCodec||e.audio.audioCodec||B1,e.audio.isFmp4=e.main.hasAudio&&!e.main.isMuxed?e.main.isFmp4:e.audio.isFmp4),!s.audio&&!s.video){this.excludePlaylist({playlistToExclude:t,error:{message:"Could not determine codecs for playlist."},playlistExclusionDuration:1/0});return}const o=(h,u)=>h?gh(u,this.usingManagedMediaSource_):rm(u),a={};let l;if(["video","audio"].forEach(function(h){if(s.hasOwnProperty(h)&&!o(e[h].isFmp4,s[h])){const u=e[h].isFmp4?"browser":"muxer";a[u]=a[u]||[],a[u].push(s[h]),h==="audio"&&(l=u)}}),r&&l&&t.attributes.AUDIO){const h=t.attributes.AUDIO;this.main().playlists.forEach(u=>{(u.attributes&&u.attributes.AUDIO)===h&&u!==t&&(u.excludeUntil=1/0)}),this.logger_(`excluding audio group ${h} as ${l} does not support codec(s): "${s.audio}"`)}if(Object.keys(a).length){const h=Object.keys(a).reduce((u,c)=>(u&&(u+=", "),u+=`${c} does not support codec(s): "${a[c].join(",")}"`,u),"")+".";this.excludePlaylist({playlistToExclude:t,error:{internal:!0,message:h},playlistExclusionDuration:1/0});return}if(this.sourceUpdater_.hasCreatedSourceBuffers()&&!this.sourceUpdater_.canChangeType()){const h=[];if(["video","audio"].forEach(u=>{const c=(ds(this.sourceUpdater_.codecs[u]||"")[0]||{}).type,f=(ds(s[u]||"")[0]||{}).type;c&&f&&c.toLowerCase()!==f.toLowerCase()&&h.push(`"${this.sourceUpdater_.codecs[u]}" -> "${s[u]}"`)}),h.length){this.excludePlaylist({playlistToExclude:t,error:{message:`Codec switching not supported: ${h.join(", ")}.`,internal:!0},playlistExclusionDuration:1/0});return}}return s}tryToCreateSourceBuffers_(){if(this.mediaSource.readyState!=="open"||this.sourceUpdater_.hasCreatedSourceBuffers()||!this.areMediaTypesKnown_())return;const e=this.getCodecsOrExclude_();if(!e)return;this.sourceUpdater_.createSourceBuffers(e);const t=[e.video,e.audio].filter(Boolean).join(",");this.excludeIncompatibleVariants_(t)}excludeUnsupportedVariants_(){const e=this.main().playlists,t=[];Object.keys(e).forEach(i=>{const s=e[i];if(t.indexOf(s.id)!==-1)return;t.push(s.id);const r=Sh(this.main,s),o=[];r.audio&&!rm(r.audio)&&!gh(r.audio,this.usingManagedMediaSource_)&&o.push(`audio codec ${r.audio}`),r.video&&!rm(r.video)&&!gh(r.video,this.usingManagedMediaSource_)&&o.push(`video codec ${r.video}`),r.text&&r.text==="stpp.ttml.im1t"&&o.push(`text codec ${r.text}`),o.length&&(s.excludeUntil=1/0,this.logger_(`excluding ${s.id} for unsupported: ${o.join(", ")}`))})}excludeIncompatibleVariants_(e){const t=[],i=this.main().playlists,s=qh(ds(e)),r=DS(s),o=s.video&&ds(s.video)[0]||null,a=s.audio&&ds(s.audio)[0]||null;Object.keys(i).forEach(l=>{const h=i[l];if(t.indexOf(h.id)!==-1||h.excludeUntil===1/0)return;t.push(h.id);const u=[],c=Sh(this.mainPlaylistLoader_.main,h),f=DS(c);if(!(!c.audio&&!c.video)){if(f!==r&&u.push(`codec count "${f}" !== "${r}"`),!this.sourceUpdater_.canChangeType()){const p=c.video&&ds(c.video)[0]||null,b=c.audio&&ds(c.audio)[0]||null;p&&o&&p.type.toLowerCase()!==o.type.toLowerCase()&&u.push(`video codec "${p.type}" !== "${o.type}"`),b&&a&&b.type.toLowerCase()!==a.type.toLowerCase()&&u.push(`audio codec "${b.type}" !== "${a.type}"`)}u.length&&(h.excludeUntil=1/0,this.logger_(`excluding ${h.id}: ${u.join(" && ")}`))}})}updateAdCues_(e){let t=0;const i=this.seekable();i.length&&(t=i.start(0)),AF(e,this.cueTagsTrack_,t)}goalBufferLength(){const e=this.tech_.currentTime(),t=Jt.GOAL_BUFFER_LENGTH,i=Jt.GOAL_BUFFER_LENGTH_RATE,s=Math.max(t,Jt.MAX_GOAL_BUFFER_LENGTH);return Math.min(t+e*i,s)}bufferLowWaterLine(){const e=this.tech_.currentTime(),t=Jt.BUFFER_LOW_WATER_LINE,i=Jt.BUFFER_LOW_WATER_LINE_RATE,s=Math.max(t,Jt.MAX_BUFFER_LOW_WATER_LINE),r=Math.max(t,Jt.EXPERIMENTAL_MAX_BUFFER_LOW_WATER_LINE);return Math.min(t+e*i,this.bufferBasedABR?r:s)}bufferHighWaterLine(){return Jt.BUFFER_HIGH_WATER_LINE}addDateRangesToTextTrack_(e){NS(this.inbandTextTracks_,"com.apple.streaming",this.tech_),lF({inbandTextTracks:this.inbandTextTracks_,dateRanges:e})}addMetadataToTextTrack(e,t,i){const s=this.sourceUpdater_.videoBuffer?this.sourceUpdater_.videoTimestampOffset():this.sourceUpdater_.audioTimestampOffset();NS(this.inbandTextTracks_,e,this.tech_),rF({inbandTextTracks:this.inbandTextTracks_,metadataArray:t,timestampOffset:s,videoDuration:i})}pathwayAttribute_(e){return e.attributes["PATHWAY-ID"]||e.attributes.serviceLocation}initContentSteeringController_(){const e=this.main();if(e.contentSteering){for(const t of e.playlists)this.contentSteeringController_.addAvailablePathway(this.pathwayAttribute_(t));if(this.contentSteeringController_.assignTagProperties(e.uri,e.contentSteering),this.contentSteeringController_.queryBeforeStart){this.contentSteeringController_.requestSteeringManifest(!0);return}this.tech_.one("canplay",()=>{this.contentSteeringController_.requestSteeringManifest()})}}resetContentSteeringController_(){this.contentSteeringController_.clearAvailablePathways(),this.contentSteeringController_.dispose(),this.initContentSteeringController_()}attachContentSteeringListeners_(){this.contentSteeringController_.on("content-steering",this.excludeThenChangePathway_.bind(this)),["contentsteeringloadstart","contentsteeringloadcomplete","contentsteeringparsed"].forEach(t=>{this.contentSteeringController_.on(t,i=>{this.trigger(Nt({},i))})}),this.sourceType_==="dash"&&this.mainPlaylistLoader_.on("loadedplaylist",()=>{const t=this.main();(this.contentSteeringController_.didDASHTagChange(t.uri,t.contentSteering)||(()=>{const r=this.contentSteeringController_.getAvailablePathways(),o=[];for(const a of t.playlists){const l=a.attributes.serviceLocation;if(l&&(o.push(l),!r.has(l)))return!0}return!!(!o.length&&r.size)})())&&this.resetContentSteeringController_()})}excludeThenChangePathway_(){const e=this.contentSteeringController_.getPathway();if(!e)return;this.handlePathwayClones_();const i=this.main().playlists,s=new Set;let r=!1;Object.keys(i).forEach(o=>{const a=i[o],l=this.pathwayAttribute_(a),h=l&&e!==l;a.excludeUntil===1/0&&a.lastExcludeReason_==="content-steering"&&!h&&(delete a.excludeUntil,delete a.lastExcludeReason_,r=!0);const c=!a.excludeUntil&&a.excludeUntil!==1/0;!s.has(a.id)&&h&&c&&(s.add(a.id),a.excludeUntil=1/0,a.lastExcludeReason_="content-steering",this.logger_(`excluding ${a.id} for ${a.lastExcludeReason_}`))}),this.contentSteeringController_.manifestType_==="DASH"&&Object.keys(this.mediaTypes_).forEach(o=>{const a=this.mediaTypes_[o];if(a.activePlaylistLoader){const l=a.activePlaylistLoader.media_;l&&l.attributes.serviceLocation!==e&&(r=!0)}}),r&&this.changeSegmentPathway_()}handlePathwayClones_(){const t=this.main().playlists,i=this.contentSteeringController_.currentPathwayClones,s=this.contentSteeringController_.nextPathwayClones;if(i&&i.size||s&&s.size){for(const[o,a]of i.entries())s.get(o)||(this.mainPlaylistLoader_.updateOrDeleteClone(a),this.contentSteeringController_.excludePathway(o));for(const[o,a]of s.entries()){const l=i.get(o);if(!l){t.filter(u=>u.attributes["PATHWAY-ID"]===a["BASE-ID"]).forEach(u=>{this.mainPlaylistLoader_.addClonePathway(a,u)}),this.contentSteeringController_.addAvailablePathway(o);continue}this.equalPathwayClones_(l,a)||(this.mainPlaylistLoader_.updateOrDeleteClone(a,!0),this.contentSteeringController_.addAvailablePathway(o))}this.contentSteeringController_.currentPathwayClones=new Map(JSON.parse(JSON.stringify([...s])))}}equalPathwayClones_(e,t){if(e["BASE-ID"]!==t["BASE-ID"]||e.ID!==t.ID||e["URI-REPLACEMENT"].HOST!==t["URI-REPLACEMENT"].HOST)return!1;const i=e["URI-REPLACEMENT"].PARAMS,s=t["URI-REPLACEMENT"].PARAMS;for(const r in i)if(i[r]!==s[r])return!1;for(const r in s)if(i[r]!==s[r])return!1;return!0}changeSegmentPathway_(){const e=this.selectPlaylist();this.pauseLoading(),this.contentSteeringController_.manifestType_==="DASH"&&this.switchMediaForDASHContentSteering_(),this.switchMedia_(e,"content-steering")}excludeNonUsablePlaylistsByKeyId_(){if(!this.mainPlaylistLoader_||!this.mainPlaylistLoader_.main)return;let e=0;const t="non-usable";this.mainPlaylistLoader_.main.playlists.forEach(i=>{const s=this.mainPlaylistLoader_.getKeyIdSet(i);!s||!s.size||s.forEach(r=>{const o="usable",a=this.keyStatusMap_.has(r)&&this.keyStatusMap_.get(r)===o,l=i.lastExcludeReason_===t&&i.excludeUntil===1/0;a?a&&l&&(delete i.excludeUntil,delete i.lastExcludeReason_,this.logger_(`enabling playlist ${i.id} because key ID ${r} is ${o}`)):(i.excludeUntil!==1/0&&i.lastExcludeReason_!==t&&(i.excludeUntil=1/0,i.lastExcludeReason_=t,this.logger_(`excluding playlist ${i.id} because the key ID ${r} doesn't exist in the keyStatusMap or is not ${o}`)),e++)})}),e>=this.mainPlaylistLoader_.main.playlists.length&&this.mainPlaylistLoader_.main.playlists.forEach(i=>{const s=i&&i.attributes&&i.attributes.RESOLUTION&&i.attributes.RESOLUTION.height<720,r=i.excludeUntil===1/0&&i.lastExcludeReason_===t;s&&r&&(delete i.excludeUntil,Y.log.warn(`enabling non-HD playlist ${i.id} because all playlists were excluded due to ${t} key IDs`))})}addKeyStatus_(e,t){const r=(typeof e=="string"?e:_F(e)).slice(0,32).toLowerCase();this.logger_(`KeyStatus '${t}' with key ID ${r} added to the keyStatusMap`),this.keyStatusMap_.set(r,t)}updatePlaylistByKeyStatus(e,t){this.addKeyStatus_(e,t),this.waitingForFastQualityPlaylistReceived_||this.excludeNonUsableThenChangePlaylist_(),this.mainPlaylistLoader_.off("loadedplaylist",this.excludeNonUsableThenChangePlaylist_.bind(this)),this.mainPlaylistLoader_.on("loadedplaylist",this.excludeNonUsableThenChangePlaylist_.bind(this))}excludeNonUsableThenChangePlaylist_(){this.excludeNonUsablePlaylistsByKeyId_(),this.fastQualityChange_()}}const JF=(n,e,t)=>i=>{const s=n.main.playlists[e],r=ob(s),o=rp(s);if(typeof i>"u")return o;i?delete s.disabled:s.disabled=!0;const a={renditionInfo:{id:e,bandwidth:s.attributes.BANDWIDTH,resolution:s.attributes.RESOLUTION,codecs:s.attributes.CODECS},cause:"fast-quality"};return i!==o&&!r&&(i?(t(s),n.trigger({type:"renditionenabled",metadata:a})):n.trigger({type:"renditiondisabled",metadata:a})),i};class e6{constructor(e,t,i){const{playlistController_:s}=e,r=s.fastQualityChange_.bind(s);if(t.attributes){const o=t.attributes.RESOLUTION;this.width=o&&o.width,this.height=o&&o.height,this.bandwidth=t.attributes.BANDWIDTH,this.frameRate=t.attributes["FRAME-RATE"]}this.codecs=Sh(s.main(),t),this.playlist=t,this.id=i,this.enabled=JF(e.playlists,t.id,r)}}const t6=function(n){n.representations=()=>{const e=n.playlistController_.main(),t=_u(e)?n.playlistController_.getAudioTrackPlaylists_():e.playlists;return t?t.filter(i=>!ob(i)).map((i,s)=>new e6(n,i,i.id)):[]}},YS=["seeking","seeked","pause","playing","error"];class i6 extends Y.EventTarget{constructor(e){super(),this.playlistController_=e.playlistController,this.tech_=e.tech,this.seekable=e.seekable,this.allowSeeksWithinUnsafeLiveWindow=e.allowSeeksWithinUnsafeLiveWindow,this.liveRangeSafeTimeDelta=e.liveRangeSafeTimeDelta,this.media=e.media,this.playedRanges_=[],this.consecutiveUpdates=0,this.lastRecordedTime=null,this.checkCurrentTimeTimeout_=null,this.logger_=Mn("PlaybackWatcher"),this.logger_("initialize");const t=()=>this.monitorCurrentTime_(),i=()=>this.monitorCurrentTime_(),s=()=>this.techWaiting_(),r=()=>this.resetTimeUpdate_(),o=this.playlistController_,a=["main","subtitle","audio"],l={};a.forEach(u=>{l[u]={reset:()=>this.resetSegmentDownloads_(u),updateend:()=>this.checkSegmentDownloads_(u)},o[`${u}SegmentLoader_`].on("appendsdone",l[u].updateend),o[`${u}SegmentLoader_`].on("playlistupdate",l[u].reset),this.tech_.on(["seeked","seeking"],l[u].reset)});const h=u=>{["main","audio"].forEach(c=>{o[`${c}SegmentLoader_`][u]("appended",this.seekingAppendCheck_)})};this.seekingAppendCheck_=()=>{this.fixesBadSeeks_()&&(this.consecutiveUpdates=0,this.lastRecordedTime=this.tech_.currentTime(),h("off"))},this.clearSeekingAppendCheck_=()=>h("off"),this.watchForBadSeeking_=()=>{this.clearSeekingAppendCheck_(),h("on")},this.tech_.on("seeked",this.clearSeekingAppendCheck_),this.tech_.on("seeking",this.watchForBadSeeking_),this.tech_.on("waiting",s),this.tech_.on(YS,r),this.tech_.on("canplay",i),this.tech_.one("play",t),this.dispose=()=>{this.clearSeekingAppendCheck_(),this.logger_("dispose"),this.tech_.off("waiting",s),this.tech_.off(YS,r),this.tech_.off("canplay",i),this.tech_.off("play",t),this.tech_.off("seeking",this.watchForBadSeeking_),this.tech_.off("seeked",this.clearSeekingAppendCheck_),a.forEach(u=>{o[`${u}SegmentLoader_`].off("appendsdone",l[u].updateend),o[`${u}SegmentLoader_`].off("playlistupdate",l[u].reset),this.tech_.off(["seeked","seeking"],l[u].reset)}),this.checkCurrentTimeTimeout_&&V.clearTimeout(this.checkCurrentTimeTimeout_),this.resetTimeUpdate_()}}monitorCurrentTime_(){this.checkCurrentTime_(),this.checkCurrentTimeTimeout_&&V.clearTimeout(this.checkCurrentTimeTimeout_),this.checkCurrentTimeTimeout_=V.setTimeout(this.monitorCurrentTime_.bind(this),250)}resetSegmentDownloads_(e){const t=this.playlistController_[`${e}SegmentLoader_`];this[`${e}StalledDownloads_`]>0&&this.logger_(`resetting possible stalled download count for ${e} loader`),this[`${e}StalledDownloads_`]=0,this[`${e}Buffered_`]=t.buffered_()}checkSegmentDownloads_(e){const t=this.playlistController_,i=t[`${e}SegmentLoader_`],s=i.buffered_(),r=VN(this[`${e}Buffered_`],s);if(this[`${e}Buffered_`]=s,r){const o={bufferedRanges:s};t.trigger({type:"bufferedrangeschanged",metadata:o}),this.resetSegmentDownloads_(e);return}this[`${e}StalledDownloads_`]++,this.logger_(`found #${this[`${e}StalledDownloads_`]} ${e} appends that did not increase buffer (possible stalled download)`,{playlistId:i.playlist_&&i.playlist_.id,buffered:go(s)}),!(this[`${e}StalledDownloads_`]<10)&&(this.logger_(`${e} loader stalled download exclusion`),this.resetSegmentDownloads_(e),this.tech_.trigger({type:"usage",name:`vhs-${e}-download-exclusion`}),e!=="subtitle"&&t.excludePlaylist({error:{message:`Excessive ${e} segment downloading detected.`},playlistExclusionDuration:1/0}))}checkCurrentTime_(){if(this.tech_.paused()||this.tech_.seeking())return;const e=this.tech_.currentTime(),t=this.tech_.buffered();if(this.lastRecordedTime===e&&(!t.length||e+Os>=t.end(t.length-1)))return this.techWaiting_();if(this.consecutiveUpdates>=5&&e===this.lastRecordedTime)this.consecutiveUpdates++,this.waiting_();else if(e===this.lastRecordedTime)this.consecutiveUpdates++;else{this.playedRanges_.push(ti([this.lastRecordedTime,e]));const i={playedRanges:this.playedRanges_};this.playlistController_.trigger({type:"playedrangeschanged",metadata:i}),this.consecutiveUpdates=0,this.lastRecordedTime=e}}resetTimeUpdate_(){this.consecutiveUpdates=0}fixesBadSeeks_(){if(!this.tech_.seeking())return!1;const t=this.seekable(),i=this.tech_.currentTime(),s=this.afterSeekableWindow_(t,i,this.media(),this.allowSeeksWithinUnsafeLiveWindow);let r;if(s&&(r=t.end(t.length-1)),this.beforeSeekableWindow_(t,i)){const b=t.start(0);r=b+(b===t.end(0)?0:Os)}if(typeof r<"u")return this.logger_(`Trying to seek outside of seekable at time ${i} with seekable range ${oC(t)}. Seeking to ${r}.`),this.tech_.setCurrentTime(r),!0;const o=this.playlistController_.sourceUpdater_,a=this.tech_.buffered(),l=o.audioBuffer?o.audioBuffered():null,h=o.videoBuffer?o.videoBuffered():null,u=this.media(),c=u.partTargetDuration?u.partTargetDuration:(u.targetDuration-gs)*2,f=[l,h];for(let b=0;b<f.length;b++){if(!f[b])continue;if(sb(f[b],i)<c)return!1}const p=dc(a,i);return p.length===0?!1:(r=p.start(0)+Os,this.logger_(`Buffered region starts (${p.start(0)})  just beyond seek point (${i}). Seeking to ${r}.`),this.tech_.setCurrentTime(r),!0)}waiting_(){if(this.techWaiting_())return;const e=this.tech_.currentTime(),t=this.tech_.buffered(),i=la(t,e);if(i.length&&e+3<=i.end(0)){this.resetTimeUpdate_(),this.tech_.setCurrentTime(e),this.logger_(`Stopped at ${e} while inside a buffered region [${i.start(0)} -> ${i.end(0)}]. Attempting to resume playback by seeking to the current time.`),this.tech_.trigger({type:"usage",name:"vhs-unknown-waiting"});return}}techWaiting_(){const e=this.seekable(),t=this.tech_.currentTime();if(this.tech_.seeking())return!0;if(this.beforeSeekableWindow_(e,t)){const a=e.end(e.length-1);return this.logger_(`Fell out of live window at time ${t}. Seeking to live point (seekable end) ${a}`),this.resetTimeUpdate_(),this.tech_.setCurrentTime(a),this.tech_.trigger({type:"usage",name:"vhs-live-resync"}),!0}const i=this.tech_.vhs.playlistController_.sourceUpdater_,s=this.tech_.buffered();if(this.videoUnderflow_({audioBuffered:i.audioBuffered(),videoBuffered:i.videoBuffered(),currentTime:t}))return this.resetTimeUpdate_(),this.tech_.setCurrentTime(t),this.tech_.trigger({type:"usage",name:"vhs-video-underflow"}),!0;const o=dc(s,t);return o.length>0?(this.logger_(`Stopped at ${t} and seeking to ${o.start(0)}`),this.resetTimeUpdate_(),this.skipTheGap_(t),!0):!1}afterSeekableWindow_(e,t,i,s=!1){if(!e.length)return!1;let r=e.end(e.length-1)+Os;const o=!i.endList,a=typeof i.partTargetDuration=="number";return o&&(a||s)&&(r=e.end(e.length-1)+i.targetDuration*3),t>r}beforeSeekableWindow_(e,t){return!!(e.length&&e.start(0)>0&&t<e.start(0)-this.liveRangeSafeTimeDelta)}videoUnderflow_({videoBuffered:e,audioBuffered:t,currentTime:i}){if(!e)return;let s;if(e.length&&t.length){const r=la(e,i-3),o=la(e,i),a=la(t,i);a.length&&!o.length&&r.length&&(s={start:r.end(0),end:a.end(0)})}else dc(e,i).length||(s=this.gapFromVideoUnderflow_(e,i));return s?(this.logger_(`Encountered a gap in video from ${s.start} to ${s.end}. Seeking to current time ${i}`),!0):!1}skipTheGap_(e){const t=this.tech_.buffered(),i=this.tech_.currentTime(),s=dc(t,i);if(this.resetTimeUpdate_(),s.length===0||i!==e)return;this.logger_("skipTheGap_:","currentTime:",i,"scheduled currentTime:",e,"nextRange start:",s.start(0)),this.tech_.setCurrentTime(s.start(0)+gs);const r={gapInfo:{from:i,to:s.start(0)}};this.playlistController_.trigger({type:"gapjumped",metadata:r}),this.tech_.trigger({type:"usage",name:"vhs-gap-skip"})}gapFromVideoUnderflow_(e,t){const i=BN(e);for(let s=0;s<i.length;s++){const r=i.start(s),o=i.end(s);if(t-r<4&&t-r>2)return{start:r,end:o}}return null}}const n6={errorInterval:30,getSource(n){const t=this.tech({IWillNotUseThisInPlugins:!0}).currentSource_||this.currentSource();return n(t)}},GC=function(n,e){let t=0,i=0;const s=et(n6,e);n.ready(()=>{n.trigger({type:"usage",name:"vhs-error-reload-initialized"})});const r=function(){i&&n.currentTime(i)},o=function(u){u!=null&&(i=n.duration()!==1/0&&n.currentTime()||0,n.one("loadedmetadata",r),n.src(u),n.trigger({type:"usage",name:"vhs-error-reload"}),n.play())},a=function(){if(Date.now()-t<s.errorInterval*1e3){n.trigger({type:"usage",name:"vhs-error-reload-canceled"});return}if(!s.getSource||typeof s.getSource!="function"){Y.log.error("ERROR: reloadSourceOnError - The option getSource must be a function!");return}return t=Date.now(),s.getSource.call(n,o)},l=function(){n.off("loadedmetadata",r),n.off("error",a),n.off("dispose",l)},h=function(u){l(),GC(n,u)};n.on("error",a),n.on("dispose",l),n.reloadSourceOnError=h},s6=function(n){GC(this,n)};var KC="3.17.2",r6="7.1.0",o6="1.3.1",a6="7.2.0",l6="4.0.2";const Et={PlaylistLoader:ha,Playlist:ji,utils:f8,STANDARD_PLAYLIST_SELECTOR:BS,INITIAL_PLAYLIST_SELECTOR:eF,lastBandwidthSelector:BS,movingAverageBandwidthSelector:K8,comparePlaylistBandwidth:hb,comparePlaylistResolution:G8,xhr:_C()};Object.keys(Jt).forEach(n=>{Object.defineProperty(Et,n,{get(){return Y.log.warn(`using Vhs.${n} is UNSAFE be sure you know what you are doing`),Jt[n]},set(e){if(Y.log.warn(`using Vhs.${n} is UNSAFE be sure you know what you are doing`),typeof e!="number"||e<0){Y.log.warn(`value of Vhs.${n} must be greater than or equal to 0`);return}Jt[n]=e}})});const JC="videojs-vhs",eE=function(n,e){const t=e.media();let i=-1;for(let s=0;s<n.length;s++)if(n[s].id===t.id){i=s;break}n.selectedIndex_=i,n.trigger({selectedIndex:i,type:"change"})},h6=function(n,e){e.representations().forEach(t=>{n.addQualityLevel(t)}),eE(n,e.playlists)};Et.canPlaySource=function(){return Y.log.warn("VHS is no longer a tech. Please remove it from your player's techOrder.")};const u6=(n,e,t)=>{if(!n)return n;let i={};e&&e.attributes&&e.attributes.CODECS&&(i=qh(ds(e.attributes.CODECS))),t&&t.attributes&&t.attributes.CODECS&&(i.audio=t.attributes.CODECS);const s=Ra(i.video),r=Ra(i.audio),o={};for(const a in n)o[a]={},r&&(o[a].audioContentType=r),s&&(o[a].videoContentType=s),e.contentProtection&&e.contentProtection[a]&&e.contentProtection[a].pssh&&(o[a].pssh=e.contentProtection[a].pssh),typeof n[a]=="string"&&(o[a].url=n[a]);return et(n,o)},c6=(n,e)=>n.reduce((t,i)=>{if(!i.contentProtection)return t;const s=e.reduce((r,o)=>{const a=i.contentProtection[o];return a&&a.pssh&&(r[o]={pssh:a.pssh}),r},{});return Object.keys(s).length&&t.push(s),t},[]),d6=({player:n,sourceKeySystems:e,audioMedia:t,mainPlaylists:i})=>{if(!n.eme.initializeMediaKeys)return Promise.resolve();const s=t?i.concat([t]):i,r=c6(s,Object.keys(e)),o=[],a=[];return r.forEach(l=>{a.push(new Promise((h,u)=>{n.tech_.one("keysessioncreated",h)})),o.push(new Promise((h,u)=>{n.eme.initializeMediaKeys({keySystems:l},c=>{if(c){u(c);return}h()})}))}),Promise.race([Promise.all(o),Promise.race(a)])},f6=({player:n,sourceKeySystems:e,media:t,audioMedia:i})=>{const s=u6(e,t,i);return s?(n.currentSource().keySystems=s,s&&!n.eme?(Y.log.warn("DRM encrypted source cannot be decrypted without a DRM plugin"),!1):!0):!1},tE=()=>{if(!V.localStorage)return null;const n=V.localStorage.getItem(JC);if(!n)return null;try{return JSON.parse(n)}catch{return null}},p6=n=>{if(!V.localStorage)return!1;let e=tE();e=e?et(e,n):n;try{V.localStorage.setItem(JC,JSON.stringify(e))}catch{return!1}return e},m6=n=>n.toLowerCase().indexOf("data:application/vnd.videojs.vhs+json,")===0?JSON.parse(n.substring(n.indexOf(",")+1)):n,iE=(n,e)=>{n._requestCallbackSet||(n._requestCallbackSet=new Set),n._requestCallbackSet.add(e)},nE=(n,e)=>{n._responseCallbackSet||(n._responseCallbackSet=new Set),n._responseCallbackSet.add(e)},sE=(n,e)=>{n._requestCallbackSet&&(n._requestCallbackSet.delete(e),n._requestCallbackSet.size||delete n._requestCallbackSet)},rE=(n,e)=>{n._responseCallbackSet&&(n._responseCallbackSet.delete(e),n._responseCallbackSet.size||delete n._responseCallbackSet)};Et.supportsNativeHls=(function(){if(!he||!he.createElement)return!1;const n=he.createElement("video");return Y.getTech("Html5").isSupported()?["application/vnd.apple.mpegurl","audio/mpegurl","audio/x-mpegurl","application/x-mpegurl","video/x-mpegurl","video/mpegurl","application/mpegurl"].some(function(t){return/maybe|probably/i.test(n.canPlayType(t))}):!1})();Et.supportsNativeDash=(function(){return!he||!he.createElement||!Y.getTech("Html5").isSupported()?!1:/maybe|probably/i.test(he.createElement("video").canPlayType("application/dash+xml"))})();Et.supportsTypeNatively=n=>n==="hls"?Et.supportsNativeHls:n==="dash"?Et.supportsNativeDash:!1;Et.isSupported=function(){return Y.log.warn("VHS is no longer a tech. Please remove it from your player's techOrder.")};Et.xhr.onRequest=function(n){iE(Et.xhr,n)};Et.xhr.onResponse=function(n){nE(Et.xhr,n)};Et.xhr.offRequest=function(n){sE(Et.xhr,n)};Et.xhr.offResponse=function(n){rE(Et.xhr,n)};const g6=Y.getComponent("Component");class oE extends g6{constructor(e,t,i){if(super(t,i.vhs),typeof i.initialBandwidth=="number"&&(this.options_.bandwidth=i.initialBandwidth),this.logger_=Mn("VhsHandler"),t.options_&&t.options_.playerId){const s=Y.getPlayer(t.options_.playerId);this.player_=s}if(this.tech_=t,this.source_=e,this.stats={},this.ignoreNextSeekingEvent_=!1,this.setOptions_(),this.options_.overrideNative&&t.overrideNativeAudioTracks&&t.overrideNativeVideoTracks)t.overrideNativeAudioTracks(!0),t.overrideNativeVideoTracks(!0);else if(this.options_.overrideNative&&(t.featuresNativeVideoTracks||t.featuresNativeAudioTracks))throw new Error("Overriding native VHS requires emulated tracks. See https://git.io/vMpjB");this.on(he,["fullscreenchange","webkitfullscreenchange","mozfullscreenchange","MSFullscreenChange"],s=>{const r=he.fullscreenElement||he.webkitFullscreenElement||he.mozFullScreenElement||he.msFullscreenElement;r&&r.contains(this.tech_.el())?this.playlistController_.fastQualityChange_():this.playlistController_.checkABR_()}),this.on(this.tech_,"seeking",function(){if(this.ignoreNextSeekingEvent_){this.ignoreNextSeekingEvent_=!1;return}this.setCurrentTime(this.tech_.currentTime())}),this.on(this.tech_,"error",function(){this.tech_.error()&&this.playlistController_&&this.playlistController_.pauseLoading()}),this.on(this.tech_,"play",this.play)}setOptions_(e={}){if(this.options_=et(this.options_,e),this.options_.withCredentials=this.options_.withCredentials||!1,this.options_.limitRenditionByPlayerDimensions=this.options_.limitRenditionByPlayerDimensions!==!1,this.options_.useDevicePixelRatio=this.options_.useDevicePixelRatio||!1,this.options_.usePlayerObjectFit=this.options_.usePlayerObjectFit||!1,this.options_.useBandwidthFromLocalStorage=typeof this.source_.useBandwidthFromLocalStorage<"u"?this.source_.useBandwidthFromLocalStorage:this.options_.useBandwidthFromLocalStorage||!1,this.options_.useForcedSubtitles=this.options_.useForcedSubtitles||!1,this.options_.useNetworkInformationApi=typeof this.options_.useNetworkInformationApi<"u"?this.options_.useNetworkInformationApi:!0,this.options_.useDtsForTimestampOffset=this.options_.useDtsForTimestampOffset||!1,this.options_.customTagParsers=this.options_.customTagParsers||[],this.options_.customTagMappers=this.options_.customTagMappers||[],this.options_.cacheEncryptionKeys=this.options_.cacheEncryptionKeys||!1,this.options_.llhls=this.options_.llhls!==!1,this.options_.bufferBasedABR=this.options_.bufferBasedABR||!1,typeof this.options_.playlistExclusionDuration!="number"&&(this.options_.playlistExclusionDuration=60),typeof this.options_.bandwidth!="number"&&this.options_.useBandwidthFromLocalStorage){const i=tE();i&&i.bandwidth&&(this.options_.bandwidth=i.bandwidth,this.tech_.trigger({type:"usage",name:"vhs-bandwidth-from-local-storage"})),i&&i.throughput&&(this.options_.throughput=i.throughput,this.tech_.trigger({type:"usage",name:"vhs-throughput-from-local-storage"}))}typeof this.options_.bandwidth!="number"&&(this.options_.bandwidth=Jt.INITIAL_BANDWIDTH),this.options_.enableLowInitialPlaylist=this.options_.enableLowInitialPlaylist&&this.options_.bandwidth===Jt.INITIAL_BANDWIDTH,["withCredentials","useDevicePixelRatio","usePlayerObjectFit","customPixelRatio","limitRenditionByPlayerDimensions","bandwidth","customTagParsers","customTagMappers","cacheEncryptionKeys","playlistSelector","initialPlaylistSelector","bufferBasedABR","liveRangeSafeTimeDelta","llhls","useForcedSubtitles","useNetworkInformationApi","useDtsForTimestampOffset","exactManifestTimings","leastPixelDiffSelector"].forEach(i=>{typeof this.source_[i]<"u"&&(this.options_[i]=this.source_[i])}),this.limitRenditionByPlayerDimensions=this.options_.limitRenditionByPlayerDimensions,this.useDevicePixelRatio=this.options_.useDevicePixelRatio,this.usePlayerObjectFit=this.options_.usePlayerObjectFit;const t=this.options_.customPixelRatio;typeof t=="number"&&t>=0&&(this.customPixelRatio=t)}setOptions(e={}){this.setOptions_(e)}src(e,t){if(!e)return;this.setOptions_(),this.options_.src=m6(this.source_.src),this.options_.tech=this.tech_,this.options_.externVhs=Et,this.options_.sourceType=C2(t),this.options_.seekTo=r=>{this.tech_.setCurrentTime(r)},this.options_.player_=this.player_,this.playlistController_=new KF(this.options_);const i=et({liveRangeSafeTimeDelta:Os},this.options_,{seekable:()=>this.seekable(),media:()=>this.playlistController_.media(),playlistController:this.playlistController_});this.playbackWatcher_=new i6(i),this.attachStreamingEventListeners_(),this.playlistController_.on("error",()=>{const r=Y.players[this.tech_.options_.playerId];let o=this.playlistController_.error;typeof o=="object"&&!o.code?o.code=3:typeof o=="string"&&(o={message:o,code:3}),r.error(o)});const s=this.options_.bufferBasedABR?Et.movingAverageBandwidthSelector(.55):Et.STANDARD_PLAYLIST_SELECTOR;this.playlistController_.selectPlaylist=this.selectPlaylist?this.selectPlaylist.bind(this):s.bind(this),this.playlistController_.selectInitialPlaylist=Et.INITIAL_PLAYLIST_SELECTOR.bind(this),this.playlists=this.playlistController_.mainPlaylistLoader_,this.mediaSource=this.playlistController_.mediaSource,Object.defineProperties(this,{selectPlaylist:{get(){return this.playlistController_.selectPlaylist},set(r){this.playlistController_.selectPlaylist=r.bind(this)}},throughput:{get(){return this.playlistController_.mainSegmentLoader_.throughput.rate},set(r){this.playlistController_.mainSegmentLoader_.throughput.rate=r,this.playlistController_.mainSegmentLoader_.throughput.count=1}},bandwidth:{get(){let r=this.playlistController_.mainSegmentLoader_.bandwidth;const o=V.navigator.connection||V.navigator.mozConnection||V.navigator.webkitConnection,a=1e7;if(this.options_.useNetworkInformationApi&&o){const l=o.downlink*1e3*1e3;l>=a&&r>=a?r=Math.max(r,l):r=l}return r},set(r){this.playlistController_.mainSegmentLoader_.bandwidth=r,this.playlistController_.mainSegmentLoader_.throughput={rate:0,count:0}}},systemBandwidth:{get(){const r=1/(this.bandwidth||1);let o;return this.throughput>0?o=1/this.throughput:o=0,Math.floor(1/(r+o))},set(){Y.log.error('The "systemBandwidth" property is read-only')}}}),this.options_.bandwidth&&(this.bandwidth=this.options_.bandwidth),this.options_.throughput&&(this.throughput=this.options_.throughput),Object.defineProperties(this.stats,{bandwidth:{get:()=>this.bandwidth||0,enumerable:!0},mediaRequests:{get:()=>this.playlistController_.mediaRequests_()||0,enumerable:!0},mediaRequestsAborted:{get:()=>this.playlistController_.mediaRequestsAborted_()||0,enumerable:!0},mediaRequestsTimedout:{get:()=>this.playlistController_.mediaRequestsTimedout_()||0,enumerable:!0},mediaRequestsErrored:{get:()=>this.playlistController_.mediaRequestsErrored_()||0,enumerable:!0},mediaTransferDuration:{get:()=>this.playlistController_.mediaTransferDuration_()||0,enumerable:!0},mediaBytesTransferred:{get:()=>this.playlistController_.mediaBytesTransferred_()||0,enumerable:!0},mediaSecondsLoaded:{get:()=>this.playlistController_.mediaSecondsLoaded_()||0,enumerable:!0},mediaAppends:{get:()=>this.playlistController_.mediaAppends_()||0,enumerable:!0},mainAppendsToLoadedData:{get:()=>this.playlistController_.mainAppendsToLoadedData_()||0,enumerable:!0},audioAppendsToLoadedData:{get:()=>this.playlistController_.audioAppendsToLoadedData_()||0,enumerable:!0},appendsToLoadedData:{get:()=>this.playlistController_.appendsToLoadedData_()||0,enumerable:!0},timeToLoadedData:{get:()=>this.playlistController_.timeToLoadedData_()||0,enumerable:!0},buffered:{get:()=>go(this.tech_.buffered()),enumerable:!0},currentTime:{get:()=>this.tech_.currentTime(),enumerable:!0},currentSource:{get:()=>this.tech_.currentSource_,enumerable:!0},currentTech:{get:()=>this.tech_.name_,enumerable:!0},duration:{get:()=>this.tech_.duration(),enumerable:!0},main:{get:()=>this.playlists.main,enumerable:!0},playerDimensions:{get:()=>this.tech_.currentDimensions(),enumerable:!0},seekable:{get:()=>go(this.tech_.seekable()),enumerable:!0},timestamp:{get:()=>Date.now(),enumerable:!0},videoPlaybackQuality:{get:()=>this.tech_.getVideoPlaybackQuality(),enumerable:!0}}),this.tech_.one("canplay",this.playlistController_.setupFirstPlay.bind(this.playlistController_)),this.tech_.on("bandwidthupdate",()=>{this.options_.useBandwidthFromLocalStorage&&p6({bandwidth:this.bandwidth,throughput:Math.round(this.throughput)})}),this.playlistController_.on("selectedinitialmedia",()=>{t6(this)}),this.playlistController_.sourceUpdater_.on("createdsourcebuffers",()=>{this.setupEme_()}),this.on(this.playlistController_,"progress",function(){this.tech_.trigger("progress")}),this.on(this.playlistController_,"firstplay",function(){this.ignoreNextSeekingEvent_=!0}),this.setupQualityLevels_(),this.tech_.el()&&(this.mediaSourceUrl_=V.URL.createObjectURL(this.playlistController_.mediaSource),(Y.browser.IS_ANY_SAFARI||Y.browser.IS_IOS)&&this.options_.overrideNative&&this.options_.sourceType==="hls"&&typeof this.tech_.addSourceElement=="function"?(this.tech_.addSourceElement(this.mediaSourceUrl_),this.tech_.addSourceElement(this.source_.src)):this.tech_.src(this.mediaSourceUrl_))}createKeySessions_(){const e=this.playlistController_.mediaTypes_.AUDIO.activePlaylistLoader;this.logger_("waiting for EME key session creation"),d6({player:this.player_,sourceKeySystems:this.source_.keySystems,audioMedia:e&&e.media(),mainPlaylists:this.playlists.main.playlists}).then(()=>{this.logger_("created EME key session"),this.playlistController_.sourceUpdater_.initializedEme()}).catch(t=>{this.logger_("error while creating EME key session",t),this.player_.error({message:"Failed to initialize media keys for EME",code:3})})}handleWaitingForKey_(){this.logger_("waitingforkey fired, attempting to create any new key sessions"),this.createKeySessions_()}setupEme_(){const e=this.playlistController_.mediaTypes_.AUDIO.activePlaylistLoader,t=f6({player:this.player_,sourceKeySystems:this.source_.keySystems,media:this.playlists.media(),audioMedia:e&&e.media()});if(this.player_.tech_.on("keystatuschange",i=>{this.playlistController_.updatePlaylistByKeyStatus(i.keyId,i.status)}),this.handleWaitingForKey_=this.handleWaitingForKey_.bind(this),this.player_.tech_.on("waitingforkey",this.handleWaitingForKey_),!t){this.playlistController_.sourceUpdater_.initializedEme();return}this.createKeySessions_()}setupQualityLevels_(){const e=Y.players[this.tech_.options_.playerId];!e||!e.qualityLevels||this.qualityLevels_||(this.qualityLevels_=e.qualityLevels(),this.playlistController_.on("selectedinitialmedia",()=>{h6(this.qualityLevels_,this)}),this.playlists.on("mediachange",()=>{eE(this.qualityLevels_,this.playlists)}))}static version(){return{"@videojs/http-streaming":KC,"mux.js":r6,"mpd-parser":o6,"m3u8-parser":a6,"aes-decrypter":l6}}version(){return this.constructor.version()}canChangeType(){return HC.canChangeType()}play(){this.playlistController_.play()}setCurrentTime(e){this.playlistController_.setCurrentTime(e)}duration(){return this.playlistController_.duration()}seekable(){return this.playlistController_.seekable()}dispose(){this.playbackWatcher_&&this.playbackWatcher_.dispose(),this.playlistController_&&this.playlistController_.dispose(),this.qualityLevels_&&this.qualityLevels_.dispose(),this.tech_&&this.tech_.vhs&&delete this.tech_.vhs,this.mediaSourceUrl_&&V.URL.revokeObjectURL&&(V.URL.revokeObjectURL(this.mediaSourceUrl_),this.mediaSourceUrl_=null),this.tech_&&this.tech_.off("waitingforkey",this.handleWaitingForKey_),super.dispose()}convertToProgramTime(e,t){return v8({playlist:this.playlistController_.media(),time:e,callback:t})}seekToProgramTime(e,t,i=!0,s=2){return PC({programTime:e,playlist:this.playlistController_.media(),retryCount:s,pauseAfterSeek:i,seekTo:this.options_.seekTo,tech:this.options_.tech,callback:t})}setupXhrHooks_(){this.xhr.onRequest=e=>{iE(this.xhr,e)},this.xhr.onResponse=e=>{nE(this.xhr,e)},this.xhr.offRequest=e=>{sE(this.xhr,e)},this.xhr.offResponse=e=>{rE(this.xhr,e)},this.player_.trigger("xhr-hooks-ready")}attachStreamingEventListeners_(){const e=["seekablerangeschanged","bufferedrangeschanged","contentsteeringloadstart","contentsteeringloadcomplete","contentsteeringparsed"],t=["gapjumped","playedrangeschanged"];e.forEach(i=>{this.playlistController_.on(i,s=>{this.player_.trigger(Nt({},s))})}),t.forEach(i=>{this.playbackWatcher_.on(i,s=>{this.player_.trigger(Nt({},s))})})}}const Hd={name:"videojs-http-streaming",VERSION:KC,canHandleSource(n,e={}){const t=et(Y.options,e);return!t.vhs.experimentalUseMMS&&!gh("avc1.4d400d,mp4a.40.2",!1)?!1:Hd.canPlayType(n.type,t)},handleSource(n,e,t={}){const i=et(Y.options,t);return e.vhs=new oE(n,e,i),e.vhs.xhr=_C(),e.vhs.setupXhrHooks_(),e.vhs.src(n.src,n.type),e.vhs},canPlayType(n,e){const t=C2(n);if(!t)return"";const i=Hd.getOverrideNative(e);return!Et.supportsTypeNatively(t)||i?"maybe":""},getOverrideNative(n={}){const{vhs:e={}}=n,t=!(Y.browser.IS_ANY_SAFARI||Y.browser.IS_IOS),{overrideNative:i=t}=e;return i}},O6=()=>gh("avc1.4d400d,mp4a.40.2",!0);O6()&&Y.getTech("Html5").registerSourceHandler(Hd,0);Y.VhsHandler=oE;Y.VhsSourceHandler=Hd;Y.Vhs=Et;Y.use||Y.registerComponent("Vhs",Et);Y.options.vhs=Y.options.vhs||{};(!Y.getPlugin||!Y.getPlugin("reloadSourceOnError"))&&Y.registerPlugin("reloadSourceOnError",s6);var km=["onChange","onClose","onDayCreate","onDestroy","onKeyDown","onMonthChange","onOpen","onParseConfig","onReady","onValueUpdate","onYearChange","onPreCalendarPosition"],wa={_disable:[],allowInput:!1,allowInvalidPreload:!1,altFormat:"F j, Y",altInput:!1,altInputClass:"form-control input",animate:typeof window=="object"&&window.navigator.userAgent.indexOf("MSIE")===-1,ariaDateFormat:"F j, Y",autoFillDefaultTime:!0,clickOpens:!0,closeOnSelect:!0,conjunction:", ",dateFormat:"Y-m-d",defaultHour:12,defaultMinute:0,defaultSeconds:0,disable:[],disableMobile:!1,enableSeconds:!1,enableTime:!1,errorHandler:function(n){return typeof console<"u"&&console.warn(n)},getWeek:function(n){var e=new Date(n.getTime());e.setHours(0,0,0,0),e.setDate(e.getDate()+3-(e.getDay()+6)%7);var t=new Date(e.getFullYear(),0,4);return 1+Math.round(((e.getTime()-t.getTime())/864e5-3+(t.getDay()+6)%7)/7)},hourIncrement:1,ignoredFocusElements:[],inline:!1,locale:"default",minuteIncrement:5,mode:"single",monthSelectorType:"dropdown",nextArrow:"<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 17 17'><g></g><path d='M13.207 8.472l-7.854 7.854-0.707-0.707 7.146-7.146-7.146-7.148 0.707-0.707 7.854 7.854z' /></svg>",noCalendar:!1,now:new Date,onChange:[],onClose:[],onDayCreate:[],onDestroy:[],onKeyDown:[],onMonthChange:[],onOpen:[],onParseConfig:[],onReady:[],onValueUpdate:[],onYearChange:[],onPreCalendarPosition:[],plugins:[],position:"auto",positionElement:void 0,prevArrow:"<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 17 17'><g></g><path d='M5.207 8.471l7.146 7.147-0.707 0.707-7.853-7.854 7.854-7.853 0.707 0.707-7.147 7.146z' /></svg>",shorthandCurrentMonth:!1,showMonths:1,static:!1,time_24hr:!1,weekNumbers:!1,wrap:!1},zh={weekdays:{shorthand:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],longhand:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},months:{shorthand:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],longhand:["January","February","March","April","May","June","July","August","September","October","November","December"]},daysInMonth:[31,28,31,30,31,30,31,31,30,31,30,31],firstDayOfWeek:0,ordinal:function(n){var e=n%100;if(e>3&&e<21)return"th";switch(e%10){case 1:return"st";case 2:return"nd";case 3:return"rd";default:return"th"}},rangeSeparator:" to ",weekAbbreviation:"Wk",scrollTitle:"Scroll to increment",toggleTitle:"Click to toggle",amPM:["AM","PM"],yearAriaLabel:"Year",monthAriaLabel:"Month",hourAriaLabel:"Hour",minuteAriaLabel:"Minute",time_24hr:!1},Ui=function(n,e){return e===void 0&&(e=2),("000"+n).slice(e*-1)},bn=function(n){return n===!0?1:0};function GS(n,e){var t;return function(){var i=this,s=arguments;clearTimeout(t),t=setTimeout(function(){return n.apply(i,s)},e)}}var Cm=function(n){return n instanceof Array?n:[n]};function Ei(n,e,t){if(t===!0)return n.classList.add(e);n.classList.remove(e)}function Ye(n,e,t){var i=window.document.createElement(n);return e=e||"",t=t||"",i.className=e,t!==void 0&&(i.textContent=t),i}function mc(n){for(;n.firstChild;)n.removeChild(n.firstChild)}function aE(n,e){if(e(n))return n;if(n.parentNode)return aE(n.parentNode,e)}function gc(n,e){var t=Ye("div","numInputWrapper"),i=Ye("input","numInput "+n),s=Ye("span","arrowUp"),r=Ye("span","arrowDown");if(navigator.userAgent.indexOf("MSIE 9.0")===-1?i.type="number":(i.type="text",i.pattern="\\d*"),e!==void 0)for(var o in e)i.setAttribute(o,e[o]);return t.appendChild(i),t.appendChild(s),t.appendChild(r),t}function Ki(n){try{if(typeof n.composedPath=="function"){var e=n.composedPath();return e[0]}return n.target}catch{return n.target}}var Em=function(){},Wd=function(n,e,t){return t.months[e?"shorthand":"longhand"][n]},y6={D:Em,F:function(n,e,t){n.setMonth(t.months.longhand.indexOf(e))},G:function(n,e){n.setHours((n.getHours()>=12?12:0)+parseFloat(e))},H:function(n,e){n.setHours(parseFloat(e))},J:function(n,e){n.setDate(parseFloat(e))},K:function(n,e,t){n.setHours(n.getHours()%12+12*bn(new RegExp(t.amPM[1],"i").test(e)))},M:function(n,e,t){n.setMonth(t.months.shorthand.indexOf(e))},S:function(n,e){n.setSeconds(parseFloat(e))},U:function(n,e){return new Date(parseFloat(e)*1e3)},W:function(n,e,t){var i=parseInt(e),s=new Date(n.getFullYear(),0,2+(i-1)*7,0,0,0,0);return s.setDate(s.getDate()-s.getDay()+t.firstDayOfWeek),s},Y:function(n,e){n.setFullYear(parseFloat(e))},Z:function(n,e){return new Date(e)},d:function(n,e){n.setDate(parseFloat(e))},h:function(n,e){n.setHours((n.getHours()>=12?12:0)+parseFloat(e))},i:function(n,e){n.setMinutes(parseFloat(e))},j:function(n,e){n.setDate(parseFloat(e))},l:Em,m:function(n,e){n.setMonth(parseFloat(e)-1)},n:function(n,e){n.setMonth(parseFloat(e)-1)},s:function(n,e){n.setSeconds(parseFloat(e))},u:function(n,e){return new Date(parseFloat(e))},w:Em,y:function(n,e){n.setFullYear(2e3+parseFloat(e))}},co={D:"",F:"",G:"(\\d\\d|\\d)",H:"(\\d\\d|\\d)",J:"(\\d\\d|\\d)\\w+",K:"",M:"",S:"(\\d\\d|\\d)",U:"(.+)",W:"(\\d\\d|\\d)",Y:"(\\d{4})",Z:"(.+)",d:"(\\d\\d|\\d)",h:"(\\d\\d|\\d)",i:"(\\d\\d|\\d)",j:"(\\d\\d|\\d)",l:"",m:"(\\d\\d|\\d)",n:"(\\d\\d|\\d)",s:"(\\d\\d|\\d)",u:"(.+)",w:"(\\d\\d|\\d)",y:"(\\d{2})"},xh={Z:function(n){return n.toISOString()},D:function(n,e,t){return e.weekdays.shorthand[xh.w(n,e,t)]},F:function(n,e,t){return Wd(xh.n(n,e,t)-1,!1,e)},G:function(n,e,t){return Ui(xh.h(n,e,t))},H:function(n){return Ui(n.getHours())},J:function(n,e){return e.ordinal!==void 0?n.getDate()+e.ordinal(n.getDate()):n.getDate()},K:function(n,e){return e.amPM[bn(n.getHours()>11)]},M:function(n,e){return Wd(n.getMonth(),!0,e)},S:function(n){return Ui(n.getSeconds())},U:function(n){return n.getTime()/1e3},W:function(n,e,t){return t.getWeek(n)},Y:function(n){return Ui(n.getFullYear(),4)},d:function(n){return Ui(n.getDate())},h:function(n){return n.getHours()%12?n.getHours()%12:12},i:function(n){return Ui(n.getMinutes())},j:function(n){return n.getDate()},l:function(n,e){return e.weekdays.longhand[n.getDay()]},m:function(n){return Ui(n.getMonth()+1)},n:function(n){return n.getMonth()+1},s:function(n){return n.getSeconds()},u:function(n){return n.getTime()},w:function(n){return n.getDay()},y:function(n){return String(n.getFullYear()).substring(2)}},lE=function(n){var e=n.config,t=e===void 0?wa:e,i=n.l10n,s=i===void 0?zh:i,r=n.isMobile,o=r===void 0?!1:r;return function(a,l,h){var u=h||s;return t.formatDate!==void 0&&!o?t.formatDate(a,l,u):l.split("").map(function(c,f,p){return xh[c]&&p[f-1]!=="\\"?xh[c](a,u,t):c!=="\\"?c:""}).join("")}},c0=function(n){var e=n.config,t=e===void 0?wa:e,i=n.l10n,s=i===void 0?zh:i;return function(r,o,a,l){if(!(r!==0&&!r)){var h=l||s,u,c=r;if(r instanceof Date)u=new Date(r.getTime());else if(typeof r!="string"&&r.toFixed!==void 0)u=new Date(r);else if(typeof r=="string"){var f=o||(t||wa).dateFormat,p=String(r).trim();if(p==="today")u=new Date,a=!0;else if(t&&t.parseDate)u=t.parseDate(r,f);else if(/Z$/.test(p)||/GMT$/.test(p))u=new Date(r);else{for(var b=void 0,y=[],_=0,T=0,w="";_<f.length;_++){var v=f[_],S=v==="\\",k=f[_-1]==="\\"||S;if(co[v]&&!k){w+=co[v];var A=new RegExp(w).exec(r);A&&(b=!0)&&y[v!=="Y"?"push":"unshift"]({fn:y6[v],val:A[++T]})}else S||(w+=".")}u=!t||!t.noCalendar?new Date(new Date().getFullYear(),0,1,0,0,0,0):new Date(new Date().setHours(0,0,0,0)),y.forEach(function(M){var B=M.fn,P=M.val;return u=B(u,P,h)||u}),u=b?u:void 0}}if(!(u instanceof Date&&!isNaN(u.getTime()))){t.errorHandler(new Error("Invalid date provided: "+c));return}return a===!0&&u.setHours(0,0,0,0),u}}};function tn(n,e,t){return t===void 0&&(t=!0),t!==!1?new Date(n.getTime()).setHours(0,0,0,0)-new Date(e.getTime()).setHours(0,0,0,0):n.getTime()-e.getTime()}var b6=function(n,e,t){return n>Math.min(e,t)&&n<Math.max(e,t)},Am=function(n,e,t){return n*3600+e*60+t},v6=function(n){var e=Math.floor(n/3600),t=(n-e*3600)/60;return[e,t,n-e*3600-t*60]},S6={DAY:864e5};function Pm(n){var e=n.defaultHour,t=n.defaultMinute,i=n.defaultSeconds;if(n.minDate!==void 0){var s=n.minDate.getHours(),r=n.minDate.getMinutes(),o=n.minDate.getSeconds();e<s&&(e=s),e===s&&t<r&&(t=r),e===s&&t===r&&i<o&&(i=n.minDate.getSeconds())}if(n.maxDate!==void 0){var a=n.maxDate.getHours(),l=n.maxDate.getMinutes();e=Math.min(e,a),e===a&&(t=Math.min(l,t)),e===a&&t===l&&(i=n.maxDate.getSeconds())}return{hours:e,minutes:t,seconds:i}}typeof Object.assign!="function"&&(Object.assign=function(n){for(var e=[],t=1;t<arguments.length;t++)e[t-1]=arguments[t];if(!n)throw TypeError("Cannot convert undefined or null to object");for(var i=function(a){a&&Object.keys(a).forEach(function(l){return n[l]=a[l]})},s=0,r=e;s<r.length;s++){var o=r[s];i(o)}return n});var pi=function(){return pi=Object.assign||function(n){for(var e,t=1,i=arguments.length;t<i;t++){e=arguments[t];for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&(n[s]=e[s])}return n},pi.apply(this,arguments)},KS=function(){for(var n=0,e=0,t=arguments.length;e<t;e++)n+=arguments[e].length;for(var i=Array(n),s=0,e=0;e<t;e++)for(var r=arguments[e],o=0,a=r.length;o<a;o++,s++)i[s]=r[o];return i},x6=300;function T6(n,e){var t={config:pi(pi({},wa),Bt.defaultConfig),l10n:zh};t.parseDate=c0({config:t.config,l10n:t.l10n}),t._handlers=[],t.pluginElements=[],t.loadedPlugins=[],t._bind=y,t._setHoursFromDate=f,t._positionCalendar=ni,t.changeMonth=ne,t.changeYear=vt,t.clear=ve,t.close=xe,t.onMouseOver=Ut,t._createElement=Ye,t.createDay=A,t.destroy=Pe,t.isEnabled=rt,t.jumpToDate=w,t.updateValue=Ni,t.open=qt,t.redraw=ht,t.set=Bs,t.setDate=Kn,t.toggle=Ns;function i(){t.utils={getDaysInMonth:function(C,D){return C===void 0&&(C=t.currentMonth),D===void 0&&(D=t.currentYear),C===1&&(D%4===0&&D%100!==0||D%400===0)?29:t.l10n.daysInMonth[C]}}}function s(){t.element=t.input=n,t.isOpen=!1,Rt(),di(),ur(),Gr(),i(),t.isMobile||k(),T(),(t.selectedDates.length||t.config.noCalendar)&&(t.config.enableTime&&f(t.config.noCalendar?t.latestSelectedDateObj:void 0),Ni(!1)),a();var C=/^((?!chrome|android).)*safari/i.test(navigator.userAgent);!t.isMobile&&C&&ni(),ot("onReady")}function r(){var C;return((C=t.calendarContainer)===null||C===void 0?void 0:C.getRootNode()).activeElement||document.activeElement}function o(C){return C.bind(t)}function a(){var C=t.config;C.weekNumbers===!1&&C.showMonths===1||C.noCalendar!==!0&&window.requestAnimationFrame(function(){if(t.calendarContainer!==void 0&&(t.calendarContainer.style.visibility="hidden",t.calendarContainer.style.display="block"),t.daysContainer!==void 0){var D=(t.days.offsetWidth+1)*C.showMonths;t.daysContainer.style.width=D+"px",t.calendarContainer.style.width=D+(t.weekWrapper!==void 0?t.weekWrapper.offsetWidth:0)+"px",t.calendarContainer.style.removeProperty("visibility"),t.calendarContainer.style.removeProperty("display")}})}function l(C){if(t.selectedDates.length===0){var D=t.config.minDate===void 0||tn(new Date,t.config.minDate)>=0?new Date:new Date(t.config.minDate.getTime()),N=Pm(t.config);D.setHours(N.hours,N.minutes,N.seconds,D.getMilliseconds()),t.selectedDates=[D],t.latestSelectedDateObj=D}C!==void 0&&C.type!=="blur"&&L(C);var W=t._input.value;c(),Ni(),t._input.value!==W&&t._debouncedChange()}function h(C,D){return C%12+12*bn(D===t.l10n.amPM[1])}function u(C){switch(C%24){case 0:case 12:return 12;default:return C%12}}function c(){if(!(t.hourElement===void 0||t.minuteElement===void 0)){var C=(parseInt(t.hourElement.value.slice(-2),10)||0)%24,D=(parseInt(t.minuteElement.value,10)||0)%60,N=t.secondElement!==void 0?(parseInt(t.secondElement.value,10)||0)%60:0;t.amPM!==void 0&&(C=h(C,t.amPM.textContent));var W=t.config.minTime!==void 0||t.config.minDate&&t.minDateHasTime&&t.latestSelectedDateObj&&tn(t.latestSelectedDateObj,t.config.minDate,!0)===0,ae=t.config.maxTime!==void 0||t.config.maxDate&&t.maxDateHasTime&&t.latestSelectedDateObj&&tn(t.latestSelectedDateObj,t.config.maxDate,!0)===0;if(t.config.maxTime!==void 0&&t.config.minTime!==void 0&&t.config.minTime>t.config.maxTime){var ce=Am(t.config.minTime.getHours(),t.config.minTime.getMinutes(),t.config.minTime.getSeconds()),Ee=Am(t.config.maxTime.getHours(),t.config.maxTime.getMinutes(),t.config.maxTime.getSeconds()),Oe=Am(C,D,N);if(Oe>Ee&&Oe<ce){var Me=v6(ce);C=Me[0],D=Me[1],N=Me[2]}}else{if(ae){var me=t.config.maxTime!==void 0?t.config.maxTime:t.config.maxDate;C=Math.min(C,me.getHours()),C===me.getHours()&&(D=Math.min(D,me.getMinutes())),D===me.getMinutes()&&(N=Math.min(N,me.getSeconds()))}if(W){var Te=t.config.minTime!==void 0?t.config.minTime:t.config.minDate;C=Math.max(C,Te.getHours()),C===Te.getHours()&&D<Te.getMinutes()&&(D=Te.getMinutes()),D===Te.getMinutes()&&(N=Math.max(N,Te.getSeconds()))}}p(C,D,N)}}function f(C){var D=C||t.latestSelectedDateObj;D&&D instanceof Date&&p(D.getHours(),D.getMinutes(),D.getSeconds())}function p(C,D,N){t.latestSelectedDateObj!==void 0&&t.latestSelectedDateObj.setHours(C%24,D,N||0,0),!(!t.hourElement||!t.minuteElement||t.isMobile)&&(t.hourElement.value=Ui(t.config.time_24hr?C:(12+C)%12+12*bn(C%12===0)),t.minuteElement.value=Ui(D),t.amPM!==void 0&&(t.amPM.textContent=t.l10n.amPM[bn(C>=12)]),t.secondElement!==void 0&&(t.secondElement.value=Ui(N)))}function b(C){var D=Ki(C),N=parseInt(D.value)+(C.delta||0);(N/1e3>1||C.key==="Enter"&&!/[^\d]/.test(N.toString()))&&vt(N)}function y(C,D,N,W){if(D instanceof Array)return D.forEach(function(ae){return y(C,ae,N,W)});if(C instanceof Array)return C.forEach(function(ae){return y(ae,D,N,W)});C.addEventListener(D,N,W),t._handlers.push({remove:function(){return C.removeEventListener(D,N,W)}})}function _(){ot("onChange")}function T(){if(t.config.wrap&&["open","close","toggle","clear"].forEach(function(N){Array.prototype.forEach.call(t.element.querySelectorAll("[data-"+N+"]"),function(W){return y(W,"click",t[N])})}),t.isMobile){Kr();return}var C=GS(Gn,50);if(t._debouncedChange=GS(_,x6),t.daysContainer&&!/iPhone|iPad|iPod/i.test(navigator.userAgent)&&y(t.daysContainer,"mouseover",function(N){t.config.mode==="range"&&Ut(Ki(N))}),y(t._input,"keydown",Vt),t.calendarContainer!==void 0&&y(t.calendarContainer,"keydown",Vt),!t.config.inline&&!t.config.static&&y(window,"resize",C),window.ontouchstart!==void 0?y(window.document,"touchstart",ct):y(window.document,"mousedown",ct),y(window.document,"focus",ct,{capture:!0}),t.config.clickOpens===!0&&(y(t._input,"focus",t.open),y(t._input,"click",t.open)),t.daysContainer!==void 0&&(y(t.monthNav,"click",I),y(t.monthNav,["keyup","increment"],b),y(t.daysContainer,"click",mn)),t.timeContainer!==void 0&&t.minuteElement!==void 0&&t.hourElement!==void 0){var D=function(N){return Ki(N).select()};y(t.timeContainer,["increment"],l),y(t.timeContainer,"blur",l,{capture:!0}),y(t.timeContainer,"click",v),y([t.hourElement,t.minuteElement],["focus","click"],D),t.secondElement!==void 0&&y(t.secondElement,"focus",function(){return t.secondElement&&t.secondElement.select()}),t.amPM!==void 0&&y(t.amPM,"click",function(N){l(N)})}t.config.allowInput&&y(t._input,"blur",Bi)}function w(C,D){var N=C!==void 0?t.parseDate(C):t.latestSelectedDateObj||(t.config.minDate&&t.config.minDate>t.now?t.config.minDate:t.config.maxDate&&t.config.maxDate<t.now?t.config.maxDate:t.now),W=t.currentYear,ae=t.currentMonth;try{N!==void 0&&(t.currentYear=N.getFullYear(),t.currentMonth=N.getMonth())}catch(ce){ce.message="Invalid date supplied: "+N,t.config.errorHandler(ce)}D&&t.currentYear!==W&&(ot("onYearChange"),X()),D&&(t.currentYear!==W||t.currentMonth!==ae)&&ot("onMonthChange"),t.redraw()}function v(C){var D=Ki(C);~D.className.indexOf("arrow")&&S(C,D.classList.contains("arrowUp")?1:-1)}function S(C,D,N){var W=C&&Ki(C),ae=N||W&&W.parentNode&&W.parentNode.firstChild,ce=cr("increment");ce.delta=D,ae&&ae.dispatchEvent(ce)}function k(){var C=window.document.createDocumentFragment();if(t.calendarContainer=Ye("div","flatpickr-calendar"),t.calendarContainer.tabIndex=-1,!t.config.noCalendar){if(C.appendChild(oe()),t.innerContainer=Ye("div","flatpickr-innerContainer"),t.config.weekNumbers){var D=re(),N=D.weekWrapper,W=D.weekNumbers;t.innerContainer.appendChild(N),t.weekNumbers=W,t.weekWrapper=N}t.rContainer=Ye("div","flatpickr-rContainer"),t.rContainer.appendChild(ee()),t.daysContainer||(t.daysContainer=Ye("div","flatpickr-days"),t.daysContainer.tabIndex=-1),z(),t.rContainer.appendChild(t.daysContainer),t.innerContainer.appendChild(t.rContainer),C.appendChild(t.innerContainer)}t.config.enableTime&&C.appendChild(G()),Ei(t.calendarContainer,"rangeMode",t.config.mode==="range"),Ei(t.calendarContainer,"animate",t.config.animate===!0),Ei(t.calendarContainer,"multiMonth",t.config.showMonths>1),t.calendarContainer.appendChild(C);var ae=t.config.appendTo!==void 0&&t.config.appendTo.nodeType!==void 0;if((t.config.inline||t.config.static)&&(t.calendarContainer.classList.add(t.config.inline?"inline":"static"),t.config.inline&&(!ae&&t.element.parentNode?t.element.parentNode.insertBefore(t.calendarContainer,t._input.nextSibling):t.config.appendTo!==void 0&&t.config.appendTo.appendChild(t.calendarContainer)),t.config.static)){var ce=Ye("div","flatpickr-wrapper");t.element.parentNode&&t.element.parentNode.insertBefore(ce,t.element),ce.appendChild(t.element),t.altInput&&ce.appendChild(t.altInput),ce.appendChild(t.calendarContainer)}!t.config.static&&!t.config.inline&&(t.config.appendTo!==void 0?t.config.appendTo:window.document.body).appendChild(t.calendarContainer)}function A(C,D,N,W){var ae=rt(D,!0),ce=Ye("span",C,D.getDate().toString());return ce.dateObj=D,ce.$i=W,ce.setAttribute("aria-label",t.formatDate(D,t.config.ariaDateFormat)),C.indexOf("hidden")===-1&&tn(D,t.now)===0&&(t.todayDateElem=ce,ce.classList.add("today"),ce.setAttribute("aria-current","date")),ae?(ce.tabIndex=-1,Fs(D)&&(ce.classList.add("selected"),t.selectedDateElem=ce,t.config.mode==="range"&&(Ei(ce,"startRange",t.selectedDates[0]&&tn(D,t.selectedDates[0],!0)===0),Ei(ce,"endRange",t.selectedDates[1]&&tn(D,t.selectedDates[1],!0)===0),C==="nextMonthDay"&&ce.classList.add("inRange")))):ce.classList.add("flatpickr-disabled"),t.config.mode==="range"&&Jn(D)&&!Fs(D)&&ce.classList.add("inRange"),t.weekNumbers&&t.config.showMonths===1&&C!=="prevMonthDay"&&W%7===6&&t.weekNumbers.insertAdjacentHTML("beforeend","<span class='flatpickr-day'>"+t.config.getWeek(D)+"</span>"),ot("onDayCreate",ce),ce}function M(C){C.focus(),t.config.mode==="range"&&Ut(C)}function B(C){for(var D=C>0?0:t.config.showMonths-1,N=C>0?t.config.showMonths:-1,W=D;W!=N;W+=C)for(var ae=t.daysContainer.children[W],ce=C>0?0:ae.children.length-1,Ee=C>0?ae.children.length:-1,Oe=ce;Oe!=Ee;Oe+=C){var Me=ae.children[Oe];if(Me.className.indexOf("hidden")===-1&&rt(Me.dateObj))return Me}}function P(C,D){for(var N=C.className.indexOf("Month")===-1?C.dateObj.getMonth():t.currentMonth,W=D>0?t.config.showMonths:-1,ae=D>0?1:-1,ce=N-t.currentMonth;ce!=W;ce+=ae)for(var Ee=t.daysContainer.children[ce],Oe=N-t.currentMonth===ce?C.$i+D:D<0?Ee.children.length-1:0,Me=Ee.children.length,me=Oe;me>=0&&me<Me&&me!=(D>0?Me:-1);me+=ae){var Te=Ee.children[me];if(Te.className.indexOf("hidden")===-1&&rt(Te.dateObj)&&Math.abs(C.$i-me)>=Math.abs(D))return M(Te)}t.changeMonth(ae),R(B(ae),0)}function R(C,D){var N=r(),W=It(N||document.body),ae=C!==void 0?C:W?N:t.selectedDateElem!==void 0&&It(t.selectedDateElem)?t.selectedDateElem:t.todayDateElem!==void 0&&It(t.todayDateElem)?t.todayDateElem:B(D>0?1:-1);ae===void 0?t._input.focus():W?P(ae,D):M(ae)}function q(C,D){for(var N=(new Date(C,D,1).getDay()-t.l10n.firstDayOfWeek+7)%7,W=t.utils.getDaysInMonth((D-1+12)%12,C),ae=t.utils.getDaysInMonth(D,C),ce=window.document.createDocumentFragment(),Ee=t.config.showMonths>1,Oe=Ee?"prevMonthDay hidden":"prevMonthDay",Me=Ee?"nextMonthDay hidden":"nextMonthDay",me=W+1-N,Te=0;me<=W;me++,Te++)ce.appendChild(A("flatpickr-day "+Oe,new Date(C,D-1,me),me,Te));for(me=1;me<=ae;me++,Te++)ce.appendChild(A("flatpickr-day",new Date(C,D,me),me,Te));for(var Re=ae+1;Re<=42-N&&(t.config.showMonths===1||Te%7!==0);Re++,Te++)ce.appendChild(A("flatpickr-day "+Me,new Date(C,D+1,Re%ae),Re,Te));var wt=Ye("div","dayContainer");return wt.appendChild(ce),wt}function z(){if(t.daysContainer!==void 0){mc(t.daysContainer),t.weekNumbers&&mc(t.weekNumbers);for(var C=document.createDocumentFragment(),D=0;D<t.config.showMonths;D++){var N=new Date(t.currentYear,t.currentMonth,1);N.setMonth(t.currentMonth+D),C.appendChild(q(N.getFullYear(),N.getMonth()))}t.daysContainer.appendChild(C),t.days=t.daysContainer.firstChild,t.config.mode==="range"&&t.selectedDates.length===1&&Ut()}}function X(){if(!(t.config.showMonths>1||t.config.monthSelectorType!=="dropdown")){var C=function(W){return t.config.minDate!==void 0&&t.currentYear===t.config.minDate.getFullYear()&&W<t.config.minDate.getMonth()?!1:!(t.config.maxDate!==void 0&&t.currentYear===t.config.maxDate.getFullYear()&&W>t.config.maxDate.getMonth())};t.monthsDropdownContainer.tabIndex=-1,t.monthsDropdownContainer.innerHTML="";for(var D=0;D<12;D++)if(C(D)){var N=Ye("option","flatpickr-monthDropdown-month");N.value=new Date(t.currentYear,D).getMonth().toString(),N.textContent=Wd(D,t.config.shorthandCurrentMonth,t.l10n),N.tabIndex=-1,t.currentMonth===D&&(N.selected=!0),t.monthsDropdownContainer.appendChild(N)}}}function Z(){var C=Ye("div","flatpickr-month"),D=window.document.createDocumentFragment(),N;t.config.showMonths>1||t.config.monthSelectorType==="static"?N=Ye("span","cur-month"):(t.monthsDropdownContainer=Ye("select","flatpickr-monthDropdown-months"),t.monthsDropdownContainer.setAttribute("aria-label",t.l10n.monthAriaLabel),y(t.monthsDropdownContainer,"change",function(Ee){var Oe=Ki(Ee),Me=parseInt(Oe.value,10);t.changeMonth(Me-t.currentMonth),ot("onMonthChange")}),X(),N=t.monthsDropdownContainer);var W=gc("cur-year",{tabindex:"-1"}),ae=W.getElementsByTagName("input")[0];ae.setAttribute("aria-label",t.l10n.yearAriaLabel),t.config.minDate&&ae.setAttribute("min",t.config.minDate.getFullYear().toString()),t.config.maxDate&&(ae.setAttribute("max",t.config.maxDate.getFullYear().toString()),ae.disabled=!!t.config.minDate&&t.config.minDate.getFullYear()===t.config.maxDate.getFullYear());var ce=Ye("div","flatpickr-current-month");return ce.appendChild(N),ce.appendChild(W),D.appendChild(ce),C.appendChild(D),{container:C,yearElement:ae,monthElement:N}}function K(){mc(t.monthNav),t.monthNav.appendChild(t.prevMonthNav),t.config.showMonths&&(t.yearElements=[],t.monthElements=[]);for(var C=t.config.showMonths;C--;){var D=Z();t.yearElements.push(D.yearElement),t.monthElements.push(D.monthElement),t.monthNav.appendChild(D.container)}t.monthNav.appendChild(t.nextMonthNav)}function oe(){return t.monthNav=Ye("div","flatpickr-months"),t.yearElements=[],t.monthElements=[],t.prevMonthNav=Ye("span","flatpickr-prev-month"),t.prevMonthNav.innerHTML=t.config.prevArrow,t.nextMonthNav=Ye("span","flatpickr-next-month"),t.nextMonthNav.innerHTML=t.config.nextArrow,K(),Object.defineProperty(t,"_hidePrevMonthArrow",{get:function(){return t.__hidePrevMonthArrow},set:function(C){t.__hidePrevMonthArrow!==C&&(Ei(t.prevMonthNav,"flatpickr-disabled",C),t.__hidePrevMonthArrow=C)}}),Object.defineProperty(t,"_hideNextMonthArrow",{get:function(){return t.__hideNextMonthArrow},set:function(C){t.__hideNextMonthArrow!==C&&(Ei(t.nextMonthNav,"flatpickr-disabled",C),t.__hideNextMonthArrow=C)}}),t.currentYearElement=t.yearElements[0],Vs(),t.monthNav}function G(){t.calendarContainer.classList.add("hasTime"),t.config.noCalendar&&t.calendarContainer.classList.add("noCalendar");var C=Pm(t.config);t.timeContainer=Ye("div","flatpickr-time"),t.timeContainer.tabIndex=-1;var D=Ye("span","flatpickr-time-separator",":"),N=gc("flatpickr-hour",{"aria-label":t.l10n.hourAriaLabel});t.hourElement=N.getElementsByTagName("input")[0];var W=gc("flatpickr-minute",{"aria-label":t.l10n.minuteAriaLabel});if(t.minuteElement=W.getElementsByTagName("input")[0],t.hourElement.tabIndex=t.minuteElement.tabIndex=-1,t.hourElement.value=Ui(t.latestSelectedDateObj?t.latestSelectedDateObj.getHours():t.config.time_24hr?C.hours:u(C.hours)),t.minuteElement.value=Ui(t.latestSelectedDateObj?t.latestSelectedDateObj.getMinutes():C.minutes),t.hourElement.setAttribute("step",t.config.hourIncrement.toString()),t.minuteElement.setAttribute("step",t.config.minuteIncrement.toString()),t.hourElement.setAttribute("min",t.config.time_24hr?"0":"1"),t.hourElement.setAttribute("max",t.config.time_24hr?"23":"12"),t.hourElement.setAttribute("maxlength","2"),t.minuteElement.setAttribute("min","0"),t.minuteElement.setAttribute("max","59"),t.minuteElement.setAttribute("maxlength","2"),t.timeContainer.appendChild(N),t.timeContainer.appendChild(D),t.timeContainer.appendChild(W),t.config.time_24hr&&t.timeContainer.classList.add("time24hr"),t.config.enableSeconds){t.timeContainer.classList.add("hasSeconds");var ae=gc("flatpickr-second");t.secondElement=ae.getElementsByTagName("input")[0],t.secondElement.value=Ui(t.latestSelectedDateObj?t.latestSelectedDateObj.getSeconds():C.seconds),t.secondElement.setAttribute("step",t.minuteElement.getAttribute("step")),t.secondElement.setAttribute("min","0"),t.secondElement.setAttribute("max","59"),t.secondElement.setAttribute("maxlength","2"),t.timeContainer.appendChild(Ye("span","flatpickr-time-separator",":")),t.timeContainer.appendChild(ae)}return t.config.time_24hr||(t.amPM=Ye("span","flatpickr-am-pm",t.l10n.amPM[bn((t.latestSelectedDateObj?t.hourElement.value:t.config.defaultHour)>11)]),t.amPM.title=t.l10n.toggleTitle,t.amPM.tabIndex=-1,t.timeContainer.appendChild(t.amPM)),t.timeContainer}function ee(){t.weekdayContainer?mc(t.weekdayContainer):t.weekdayContainer=Ye("div","flatpickr-weekdays");for(var C=t.config.showMonths;C--;){var D=Ye("div","flatpickr-weekdaycontainer");t.weekdayContainer.appendChild(D)}return te(),t.weekdayContainer}function te(){if(t.weekdayContainer){var C=t.l10n.firstDayOfWeek,D=KS(t.l10n.weekdays.shorthand);C>0&&C<D.length&&(D=KS(D.splice(C,D.length),D.splice(0,C)));for(var N=t.config.showMonths;N--;)t.weekdayContainer.children[N].innerHTML=`
      <span class='flatpickr-weekday'>
        `+D.join("</span><span class='flatpickr-weekday'>")+`
      </span>
      `}}function re(){t.calendarContainer.classList.add("hasWeeks");var C=Ye("div","flatpickr-weekwrapper");C.appendChild(Ye("span","flatpickr-weekday",t.l10n.weekAbbreviation));var D=Ye("div","flatpickr-weeks");return C.appendChild(D),{weekWrapper:C,weekNumbers:D}}function ne(C,D){D===void 0&&(D=!0);var N=D?C:C-t.currentMonth;N<0&&t._hidePrevMonthArrow===!0||N>0&&t._hideNextMonthArrow===!0||(t.currentMonth+=N,(t.currentMonth<0||t.currentMonth>11)&&(t.currentYear+=t.currentMonth>11?1:-1,t.currentMonth=(t.currentMonth+12)%12,ot("onYearChange"),X()),z(),ot("onMonthChange"),Vs())}function ve(C,D){if(C===void 0&&(C=!0),D===void 0&&(D=!0),t.input.value="",t.altInput!==void 0&&(t.altInput.value=""),t.mobileInput!==void 0&&(t.mobileInput.value=""),t.selectedDates=[],t.latestSelectedDateObj=void 0,D===!0&&(t.currentYear=t._initialDate.getFullYear(),t.currentMonth=t._initialDate.getMonth()),t.config.enableTime===!0){var N=Pm(t.config),W=N.hours,ae=N.minutes,ce=N.seconds;p(W,ae,ce)}t.redraw(),C&&ot("onChange")}function xe(){t.isOpen=!1,t.isMobile||(t.calendarContainer!==void 0&&t.calendarContainer.classList.remove("open"),t._input!==void 0&&t._input.classList.remove("active")),ot("onClose")}function Pe(){t.config!==void 0&&ot("onDestroy");for(var C=t._handlers.length;C--;)t._handlers[C].remove();if(t._handlers=[],t.mobileInput)t.mobileInput.parentNode&&t.mobileInput.parentNode.removeChild(t.mobileInput),t.mobileInput=void 0;else if(t.calendarContainer&&t.calendarContainer.parentNode)if(t.config.static&&t.calendarContainer.parentNode){var D=t.calendarContainer.parentNode;if(D.lastChild&&D.removeChild(D.lastChild),D.parentNode){for(;D.firstChild;)D.parentNode.insertBefore(D.firstChild,D);D.parentNode.removeChild(D)}}else t.calendarContainer.parentNode.removeChild(t.calendarContainer);t.altInput&&(t.input.type="text",t.altInput.parentNode&&t.altInput.parentNode.removeChild(t.altInput),delete t.altInput),t.input&&(t.input.type=t.input._type,t.input.classList.remove("flatpickr-input"),t.input.removeAttribute("readonly")),["_showTimeInput","latestSelectedDateObj","_hideNextMonthArrow","_hidePrevMonthArrow","__hideNextMonthArrow","__hidePrevMonthArrow","isMobile","isOpen","selectedDateElem","minDateHasTime","maxDateHasTime","days","daysContainer","_input","_positionElement","innerContainer","rContainer","monthNav","todayDateElem","calendarContainer","weekdayContainer","prevMonthNav","nextMonthNav","monthsDropdownContainer","currentMonthElement","currentYearElement","navigationCurrentMonth","selectedDateElem","config"].forEach(function(N){try{delete t[N]}catch{}})}function Se(C){return t.calendarContainer.contains(C)}function ct(C){if(t.isOpen&&!t.config.inline){var D=Ki(C),N=Se(D),W=D===t.input||D===t.altInput||t.element.contains(D)||C.path&&C.path.indexOf&&(~C.path.indexOf(t.input)||~C.path.indexOf(t.altInput)),ae=!W&&!N&&!Se(C.relatedTarget),ce=!t.config.ignoredFocusElements.some(function(Ee){return Ee.contains(D)});ae&&ce&&(t.config.allowInput&&t.setDate(t._input.value,!1,t.config.altInput?t.config.altFormat:t.config.dateFormat),t.timeContainer!==void 0&&t.minuteElement!==void 0&&t.hourElement!==void 0&&t.input.value!==""&&t.input.value!==void 0&&l(),t.close(),t.config&&t.config.mode==="range"&&t.selectedDates.length===1&&t.clear(!1))}}function vt(C){if(!(!C||t.config.minDate&&C<t.config.minDate.getFullYear()||t.config.maxDate&&C>t.config.maxDate.getFullYear())){var D=C,N=t.currentYear!==D;t.currentYear=D||t.currentYear,t.config.maxDate&&t.currentYear===t.config.maxDate.getFullYear()?t.currentMonth=Math.min(t.config.maxDate.getMonth(),t.currentMonth):t.config.minDate&&t.currentYear===t.config.minDate.getFullYear()&&(t.currentMonth=Math.max(t.config.minDate.getMonth(),t.currentMonth)),N&&(t.redraw(),ot("onYearChange"),X())}}function rt(C,D){var N;D===void 0&&(D=!0);var W=t.parseDate(C,void 0,D);if(t.config.minDate&&W&&tn(W,t.config.minDate,D!==void 0?D:!t.minDateHasTime)<0||t.config.maxDate&&W&&tn(W,t.config.maxDate,D!==void 0?D:!t.maxDateHasTime)>0)return!1;if(!t.config.enable&&t.config.disable.length===0)return!0;if(W===void 0)return!1;for(var ae=!!t.config.enable,ce=(N=t.config.enable)!==null&&N!==void 0?N:t.config.disable,Ee=0,Oe=void 0;Ee<ce.length;Ee++){if(Oe=ce[Ee],typeof Oe=="function"&&Oe(W))return ae;if(Oe instanceof Date&&W!==void 0&&Oe.getTime()===W.getTime())return ae;if(typeof Oe=="string"){var Me=t.parseDate(Oe,void 0,!0);return Me&&Me.getTime()===W.getTime()?ae:!ae}else if(typeof Oe=="object"&&W!==void 0&&Oe.from&&Oe.to&&W.getTime()>=Oe.from.getTime()&&W.getTime()<=Oe.to.getTime())return ae}return!ae}function It(C){return t.daysContainer!==void 0?C.className.indexOf("hidden")===-1&&C.className.indexOf("flatpickr-disabled")===-1&&t.daysContainer.contains(C):!1}function Bi(C){var D=C.target===t._input,N=t._input.value.trimEnd()!==Us();D&&N&&!(C.relatedTarget&&Se(C.relatedTarget))&&t.setDate(t._input.value,!0,C.target===t.altInput?t.config.altFormat:t.config.dateFormat)}function Vt(C){var D=Ki(C),N=t.config.wrap?n.contains(D):D===t._input,W=t.config.allowInput,ae=t.isOpen&&(!W||!N),ce=t.config.inline&&N&&!W;if(C.keyCode===13&&N){if(W)return t.setDate(t._input.value,!0,D===t.altInput?t.config.altFormat:t.config.dateFormat),t.close(),D.blur();t.open()}else if(Se(D)||ae||ce){var Ee=!!t.timeContainer&&t.timeContainer.contains(D);switch(C.keyCode){case 13:Ee?(C.preventDefault(),l(),pn()):mn(C);break;case 27:C.preventDefault(),pn();break;case 8:case 46:N&&!t.config.allowInput&&(C.preventDefault(),t.clear());break;case 37:case 39:if(!Ee&&!N){C.preventDefault();var Oe=r();if(t.daysContainer!==void 0&&(W===!1||Oe&&It(Oe))){var Me=C.keyCode===39?1:-1;C.ctrlKey?(C.stopPropagation(),ne(Me),R(B(1),0)):R(void 0,Me)}}else t.hourElement&&t.hourElement.focus();break;case 38:case 40:C.preventDefault();var me=C.keyCode===40?1:-1;t.daysContainer&&D.$i!==void 0||D===t.input||D===t.altInput?C.ctrlKey?(C.stopPropagation(),vt(t.currentYear-me),R(B(1),0)):Ee||R(void 0,me*7):D===t.currentYearElement?vt(t.currentYear-me):t.config.enableTime&&(!Ee&&t.hourElement&&t.hourElement.focus(),l(C),t._debouncedChange());break;case 9:if(Ee){var Te=[t.hourElement,t.minuteElement,t.secondElement,t.amPM].concat(t.pluginElements).filter(function(_t){return _t}),Re=Te.indexOf(D);if(Re!==-1){var wt=Te[Re+(C.shiftKey?-1:1)];C.preventDefault(),(wt||t._input).focus()}}else!t.config.noCalendar&&t.daysContainer&&t.daysContainer.contains(D)&&C.shiftKey&&(C.preventDefault(),t._input.focus());break}}if(t.amPM!==void 0&&D===t.amPM)switch(C.key){case t.l10n.amPM[0].charAt(0):case t.l10n.amPM[0].charAt(0).toLowerCase():t.amPM.textContent=t.l10n.amPM[0],c(),Ni();break;case t.l10n.amPM[1].charAt(0):case t.l10n.amPM[1].charAt(0).toLowerCase():t.amPM.textContent=t.l10n.amPM[1],c(),Ni();break}(N||Se(D))&&ot("onKeyDown",C)}function Ut(C,D){if(D===void 0&&(D="flatpickr-day"),!(t.selectedDates.length!==1||C&&(!C.classList.contains(D)||C.classList.contains("flatpickr-disabled")))){for(var N=C?C.dateObj.getTime():t.days.firstElementChild.dateObj.getTime(),W=t.parseDate(t.selectedDates[0],void 0,!0).getTime(),ae=Math.min(N,t.selectedDates[0].getTime()),ce=Math.max(N,t.selectedDates[0].getTime()),Ee=!1,Oe=0,Me=0,me=ae;me<ce;me+=S6.DAY)rt(new Date(me),!0)||(Ee=Ee||me>ae&&me<ce,me<W&&(!Oe||me>Oe)?Oe=me:me>W&&(!Me||me<Me)&&(Me=me));var Te=Array.from(t.rContainer.querySelectorAll("*:nth-child(-n+"+t.config.showMonths+") > ."+D));Te.forEach(function(Re){var wt=Re.dateObj,_t=wt.getTime(),fi=Oe>0&&_t<Oe||Me>0&&_t>Me;if(fi){Re.classList.add("notAllowed"),["inRange","startRange","endRange"].forEach(function(We){Re.classList.remove(We)});return}else if(Ee&&!fi)return;["startRange","inRange","endRange","notAllowed"].forEach(function(We){Re.classList.remove(We)}),C!==void 0&&(C.classList.add(N<=t.selectedDates[0].getTime()?"startRange":"endRange"),W<N&&_t===W?Re.classList.add("startRange"):W>N&&_t===W&&Re.classList.add("endRange"),_t>=Oe&&(Me===0||_t<=Me)&&b6(_t,W,N)&&Re.classList.add("inRange"))})}}function Gn(){t.isOpen&&!t.config.static&&!t.config.inline&&ni()}function qt(C,D){if(D===void 0&&(D=t._positionElement),t.isMobile===!0){if(C){C.preventDefault();var N=Ki(C);N&&N.blur()}t.mobileInput!==void 0&&(t.mobileInput.focus(),t.mobileInput.click()),ot("onOpen");return}else if(t._input.disabled||t.config.inline)return;var W=t.isOpen;t.isOpen=!0,W||(t.calendarContainer.classList.add("open"),t._input.classList.add("active"),ot("onOpen"),ni(D)),t.config.enableTime===!0&&t.config.noCalendar===!0&&t.config.allowInput===!1&&(C===void 0||!t.timeContainer.contains(C.relatedTarget))&&setTimeout(function(){return t.hourElement.select()},50)}function Ln(C){return function(D){var N=t.config["_"+C+"Date"]=t.parseDate(D,t.config.dateFormat),W=t.config["_"+(C==="min"?"max":"min")+"Date"];N!==void 0&&(t[C==="min"?"minDateHasTime":"maxDateHasTime"]=N.getHours()>0||N.getMinutes()>0||N.getSeconds()>0),t.selectedDates&&(t.selectedDates=t.selectedDates.filter(function(ae){return rt(ae)}),!t.selectedDates.length&&C==="min"&&f(N),Ni()),t.daysContainer&&(ht(),N!==void 0?t.currentYearElement[C]=N.getFullYear().toString():t.currentYearElement.removeAttribute(C),t.currentYearElement.disabled=!!W&&N!==void 0&&W.getFullYear()===N.getFullYear())}}function Rt(){var C=["wrap","weekNumbers","allowInput","allowInvalidPreload","clickOpens","time_24hr","enableTime","noCalendar","altInput","shorthandCurrentMonth","inline","static","enableSeconds","disableMobile"],D=pi(pi({},JSON.parse(JSON.stringify(n.dataset||{}))),e),N={};t.config.parseDate=D.parseDate,t.config.formatDate=D.formatDate,Object.defineProperty(t.config,"enable",{get:function(){return t.config._enable},set:function(Te){t.config._enable=hr(Te)}}),Object.defineProperty(t.config,"disable",{get:function(){return t.config._disable},set:function(Te){t.config._disable=hr(Te)}});var W=D.mode==="time";if(!D.dateFormat&&(D.enableTime||W)){var ae=Bt.defaultConfig.dateFormat||wa.dateFormat;N.dateFormat=D.noCalendar||W?"H:i"+(D.enableSeconds?":S":""):ae+" H:i"+(D.enableSeconds?":S":"")}if(D.altInput&&(D.enableTime||W)&&!D.altFormat){var ce=Bt.defaultConfig.altFormat||wa.altFormat;N.altFormat=D.noCalendar||W?"h:i"+(D.enableSeconds?":S K":" K"):ce+(" h:i"+(D.enableSeconds?":S":"")+" K")}Object.defineProperty(t.config,"minDate",{get:function(){return t.config._minDate},set:Ln("min")}),Object.defineProperty(t.config,"maxDate",{get:function(){return t.config._maxDate},set:Ln("max")});var Ee=function(Te){return function(Re){t.config[Te==="min"?"_minTime":"_maxTime"]=t.parseDate(Re,"H:i:S")}};Object.defineProperty(t.config,"minTime",{get:function(){return t.config._minTime},set:Ee("min")}),Object.defineProperty(t.config,"maxTime",{get:function(){return t.config._maxTime},set:Ee("max")}),D.mode==="time"&&(t.config.noCalendar=!0,t.config.enableTime=!0),Object.assign(t.config,N,D);for(var Oe=0;Oe<C.length;Oe++)t.config[C[Oe]]=t.config[C[Oe]]===!0||t.config[C[Oe]]==="true";km.filter(function(Te){return t.config[Te]!==void 0}).forEach(function(Te){t.config[Te]=Cm(t.config[Te]||[]).map(o)}),t.isMobile=!t.config.disableMobile&&!t.config.inline&&t.config.mode==="single"&&!t.config.disable.length&&!t.config.enable&&!t.config.weekNumbers&&/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);for(var Oe=0;Oe<t.config.plugins.length;Oe++){var Me=t.config.plugins[Oe](t)||{};for(var me in Me)km.indexOf(me)>-1?t.config[me]=Cm(Me[me]).map(o).concat(t.config[me]):typeof D[me]>"u"&&(t.config[me]=Me[me])}D.altInputClass||(t.config.altInputClass=Qs().className+" "+t.config.altInputClass),ot("onParseConfig")}function Qs(){return t.config.wrap?n.querySelector("[data-input]"):n}function di(){typeof t.config.locale!="object"&&typeof Bt.l10ns[t.config.locale]>"u"&&t.config.errorHandler(new Error("flatpickr: invalid locale "+t.config.locale)),t.l10n=pi(pi({},Bt.l10ns.default),typeof t.config.locale=="object"?t.config.locale:t.config.locale!=="default"?Bt.l10ns[t.config.locale]:void 0),co.D="("+t.l10n.weekdays.shorthand.join("|")+")",co.l="("+t.l10n.weekdays.longhand.join("|")+")",co.M="("+t.l10n.months.shorthand.join("|")+")",co.F="("+t.l10n.months.longhand.join("|")+")",co.K="("+t.l10n.amPM[0]+"|"+t.l10n.amPM[1]+"|"+t.l10n.amPM[0].toLowerCase()+"|"+t.l10n.amPM[1].toLowerCase()+")";var C=pi(pi({},e),JSON.parse(JSON.stringify(n.dataset||{})));C.time_24hr===void 0&&Bt.defaultConfig.time_24hr===void 0&&(t.config.time_24hr=t.l10n.time_24hr),t.formatDate=lE(t),t.parseDate=c0({config:t.config,l10n:t.l10n})}function ni(C){if(typeof t.config.position=="function")return void t.config.position(t,C);if(t.calendarContainer!==void 0){ot("onPreCalendarPosition");var D=C||t._positionElement,N=Array.prototype.reduce.call(t.calendarContainer.children,(function(Bu,jo){return Bu+jo.offsetHeight}),0),W=t.calendarContainer.offsetWidth,ae=t.config.position.split(" "),ce=ae[0],Ee=ae.length>1?ae[1]:null,Oe=D.getBoundingClientRect(),Me=window.innerHeight-Oe.bottom,me=ce==="above"||ce!=="below"&&Me<N&&Oe.top>N,Te=window.pageYOffset+Oe.top+(me?-N-2:D.offsetHeight+2);if(Ei(t.calendarContainer,"arrowTop",!me),Ei(t.calendarContainer,"arrowBottom",me),!t.config.inline){var Re=window.pageXOffset+Oe.left,wt=!1,_t=!1;Ee==="center"?(Re-=(W-Oe.width)/2,wt=!0):Ee==="right"&&(Re-=W-Oe.width,_t=!0),Ei(t.calendarContainer,"arrowLeft",!wt&&!_t),Ei(t.calendarContainer,"arrowCenter",wt),Ei(t.calendarContainer,"arrowRight",_t);var fi=window.document.body.offsetWidth-(window.pageXOffset+Oe.right),We=Re+W>window.document.body.offsetWidth,qs=fi+W>window.document.body.offsetWidth;if(Ei(t.calendarContainer,"rightMost",We),!t.config.static)if(t.calendarContainer.style.top=Te+"px",!We)t.calendarContainer.style.left=Re+"px",t.calendarContainer.style.right="auto";else if(!qs)t.calendarContainer.style.left="auto",t.calendarContainer.style.right=fi+"px";else{var je=Fe();if(je===void 0)return;var Uo=window.document.body.offsetWidth,qo=Math.max(0,Uo/2-W/2),zo=".flatpickr-calendar.centerMost:before",Ap=".flatpickr-calendar.centerMost:after",zs=je.cssRules.length,dt="{left:"+Oe.left+"px;right:auto;}";Ei(t.calendarContainer,"rightMost",!1),Ei(t.calendarContainer,"centerMost",!0),je.insertRule(zo+","+Ap+dt,zs),t.calendarContainer.style.left=qo+"px",t.calendarContainer.style.right="auto"}}}}function Fe(){for(var C=null,D=0;D<document.styleSheets.length;D++){var N=document.styleSheets[D];if(N.cssRules){try{N.cssRules}catch{continue}C=N;break}}return C??lt()}function lt(){var C=document.createElement("style");return document.head.appendChild(C),C.sheet}function ht(){t.config.noCalendar||t.isMobile||(X(),Vs(),z())}function pn(){t._input.focus(),window.navigator.userAgent.indexOf("MSIE")!==-1||navigator.msMaxTouchPoints!==void 0?setTimeout(t.close,0):t.close()}function mn(C){C.preventDefault(),C.stopPropagation();var D=function(Te){return Te.classList&&Te.classList.contains("flatpickr-day")&&!Te.classList.contains("flatpickr-disabled")&&!Te.classList.contains("notAllowed")},N=aE(Ki(C),D);if(N!==void 0){var W=N,ae=t.latestSelectedDateObj=new Date(W.dateObj.getTime()),ce=(ae.getMonth()<t.currentMonth||ae.getMonth()>t.currentMonth+t.config.showMonths-1)&&t.config.mode!=="range";if(t.selectedDateElem=W,t.config.mode==="single")t.selectedDates=[ae];else if(t.config.mode==="multiple"){var Ee=Fs(ae);Ee?t.selectedDates.splice(parseInt(Ee),1):t.selectedDates.push(ae)}else t.config.mode==="range"&&(t.selectedDates.length===2&&t.clear(!1,!1),t.latestSelectedDateObj=ae,t.selectedDates.push(ae),tn(ae,t.selectedDates[0],!0)!==0&&t.selectedDates.sort(function(Te,Re){return Te.getTime()-Re.getTime()}));if(c(),ce){var Oe=t.currentYear!==ae.getFullYear();t.currentYear=ae.getFullYear(),t.currentMonth=ae.getMonth(),Oe&&(ot("onYearChange"),X()),ot("onMonthChange")}if(Vs(),z(),Ni(),!ce&&t.config.mode!=="range"&&t.config.showMonths===1?M(W):t.selectedDateElem!==void 0&&t.hourElement===void 0&&t.selectedDateElem&&t.selectedDateElem.focus(),t.hourElement!==void 0&&t.hourElement!==void 0&&t.hourElement.focus(),t.config.closeOnSelect){var Me=t.config.mode==="single"&&!t.config.enableTime,me=t.config.mode==="range"&&t.selectedDates.length===2&&!t.config.enableTime;(Me||me)&&pn()}_()}}var gn={locale:[di,te],showMonths:[K,a,ee],minDate:[w],maxDate:[w],positionElement:[He],clickOpens:[function(){t.config.clickOpens===!0?(y(t._input,"focus",t.open),y(t._input,"click",t.open)):(t._input.removeEventListener("focus",t.open),t._input.removeEventListener("click",t.open))}]};function Bs(C,D){if(C!==null&&typeof C=="object"){Object.assign(t.config,C);for(var N in C)gn[N]!==void 0&&gn[N].forEach(function(W){return W()})}else t.config[C]=D,gn[C]!==void 0?gn[C].forEach(function(W){return W()}):km.indexOf(C)>-1&&(t.config[C]=Cm(D));t.redraw(),Ni(!0)}function $n(C,D){var N=[];if(C instanceof Array)N=C.map(function(W){return t.parseDate(W,D)});else if(C instanceof Date||typeof C=="number")N=[t.parseDate(C,D)];else if(typeof C=="string")switch(t.config.mode){case"single":case"time":N=[t.parseDate(C,D)];break;case"multiple":N=C.split(t.config.conjunction).map(function(W){return t.parseDate(W,D)});break;case"range":N=C.split(t.l10n.rangeSeparator).map(function(W){return t.parseDate(W,D)});break}else t.config.errorHandler(new Error("Invalid date supplied: "+JSON.stringify(C)));t.selectedDates=t.config.allowInvalidPreload?N:N.filter(function(W){return W instanceof Date&&rt(W,!1)}),t.config.mode==="range"&&t.selectedDates.sort(function(W,ae){return W.getTime()-ae.getTime()})}function Kn(C,D,N){if(D===void 0&&(D=!1),N===void 0&&(N=t.config.dateFormat),C!==0&&!C||C instanceof Array&&C.length===0)return t.clear(D);$n(C,N),t.latestSelectedDateObj=t.selectedDates[t.selectedDates.length-1],t.redraw(),w(void 0,D),f(),t.selectedDates.length===0&&t.clear(!1),Ni(D),D&&ot("onChange")}function hr(C){return C.slice().map(function(D){return typeof D=="string"||typeof D=="number"||D instanceof Date?t.parseDate(D,void 0,!0):D&&typeof D=="object"&&D.from&&D.to?{from:t.parseDate(D.from,void 0),to:t.parseDate(D.to,void 0)}:D}).filter(function(D){return D})}function Gr(){t.selectedDates=[],t.now=t.parseDate(t.config.now)||new Date;var C=t.config.defaultDate||((t.input.nodeName==="INPUT"||t.input.nodeName==="TEXTAREA")&&t.input.placeholder&&t.input.value===t.input.placeholder?null:t.input.value);C&&$n(C,t.config.dateFormat),t._initialDate=t.selectedDates.length>0?t.selectedDates[0]:t.config.minDate&&t.config.minDate.getTime()>t.now.getTime()?t.config.minDate:t.config.maxDate&&t.config.maxDate.getTime()<t.now.getTime()?t.config.maxDate:t.now,t.currentYear=t._initialDate.getFullYear(),t.currentMonth=t._initialDate.getMonth(),t.selectedDates.length>0&&(t.latestSelectedDateObj=t.selectedDates[0]),t.config.minTime!==void 0&&(t.config.minTime=t.parseDate(t.config.minTime,"H:i")),t.config.maxTime!==void 0&&(t.config.maxTime=t.parseDate(t.config.maxTime,"H:i")),t.minDateHasTime=!!t.config.minDate&&(t.config.minDate.getHours()>0||t.config.minDate.getMinutes()>0||t.config.minDate.getSeconds()>0),t.maxDateHasTime=!!t.config.maxDate&&(t.config.maxDate.getHours()>0||t.config.maxDate.getMinutes()>0||t.config.maxDate.getSeconds()>0)}function ur(){if(t.input=Qs(),!t.input){t.config.errorHandler(new Error("Invalid input element specified"));return}t.input._type=t.input.type,t.input.type="text",t.input.classList.add("flatpickr-input"),t._input=t.input,t.config.altInput&&(t.altInput=Ye(t.input.nodeName,t.config.altInputClass),t._input=t.altInput,t.altInput.placeholder=t.input.placeholder,t.altInput.disabled=t.input.disabled,t.altInput.required=t.input.required,t.altInput.tabIndex=t.input.tabIndex,t.altInput.type="text",t.input.setAttribute("type","hidden"),!t.config.static&&t.input.parentNode&&t.input.parentNode.insertBefore(t.altInput,t.input.nextSibling)),t.config.allowInput||t._input.setAttribute("readonly","readonly"),He()}function He(){t._positionElement=t.config.positionElement||t._input}function Kr(){var C=t.config.enableTime?t.config.noCalendar?"time":"datetime-local":"date";t.mobileInput=Ye("input",t.input.className+" flatpickr-mobile"),t.mobileInput.tabIndex=1,t.mobileInput.type=C,t.mobileInput.disabled=t.input.disabled,t.mobileInput.required=t.input.required,t.mobileInput.placeholder=t.input.placeholder,t.mobileFormatStr=C==="datetime-local"?"Y-m-d\\TH:i:S":C==="date"?"Y-m-d":"H:i:S",t.selectedDates.length>0&&(t.mobileInput.defaultValue=t.mobileInput.value=t.formatDate(t.selectedDates[0],t.mobileFormatStr)),t.config.minDate&&(t.mobileInput.min=t.formatDate(t.config.minDate,"Y-m-d")),t.config.maxDate&&(t.mobileInput.max=t.formatDate(t.config.maxDate,"Y-m-d")),t.input.getAttribute("step")&&(t.mobileInput.step=String(t.input.getAttribute("step"))),t.input.type="hidden",t.altInput!==void 0&&(t.altInput.type="hidden");try{t.input.parentNode&&t.input.parentNode.insertBefore(t.mobileInput,t.input.nextSibling)}catch{}y(t.mobileInput,"change",function(D){t.setDate(Ki(D).value,!1,t.mobileFormatStr),ot("onChange"),ot("onClose")})}function Ns(C){if(t.isOpen===!0)return t.close();t.open(C)}function ot(C,D){if(t.config!==void 0){var N=t.config[C];if(N!==void 0&&N.length>0)for(var W=0;N[W]&&W<N.length;W++)N[W](t.selectedDates,t.input.value,t,D);C==="onChange"&&(t.input.dispatchEvent(cr("change")),t.input.dispatchEvent(cr("input")))}}function cr(C){var D=document.createEvent("Event");return D.initEvent(C,!0,!0),D}function Fs(C){for(var D=0;D<t.selectedDates.length;D++){var N=t.selectedDates[D];if(N instanceof Date&&tn(N,C)===0)return""+D}return!1}function Jn(C){return t.config.mode!=="range"||t.selectedDates.length<2?!1:tn(C,t.selectedDates[0])>=0&&tn(C,t.selectedDates[1])<=0}function Vs(){t.config.noCalendar||t.isMobile||!t.monthNav||(t.yearElements.forEach(function(C,D){var N=new Date(t.currentYear,t.currentMonth,1);N.setMonth(t.currentMonth+D),t.config.showMonths>1||t.config.monthSelectorType==="static"?t.monthElements[D].textContent=Wd(N.getMonth(),t.config.shorthandCurrentMonth,t.l10n)+" ":t.monthsDropdownContainer.value=N.getMonth().toString(),C.value=N.getFullYear().toString()}),t._hidePrevMonthArrow=t.config.minDate!==void 0&&(t.currentYear===t.config.minDate.getFullYear()?t.currentMonth<=t.config.minDate.getMonth():t.currentYear<t.config.minDate.getFullYear()),t._hideNextMonthArrow=t.config.maxDate!==void 0&&(t.currentYear===t.config.maxDate.getFullYear()?t.currentMonth+1>t.config.maxDate.getMonth():t.currentYear>t.config.maxDate.getFullYear()))}function Us(C){var D=C||(t.config.altInput?t.config.altFormat:t.config.dateFormat);return t.selectedDates.map(function(N){return t.formatDate(N,D)}).filter(function(N,W,ae){return t.config.mode!=="range"||t.config.enableTime||ae.indexOf(N)===W}).join(t.config.mode!=="range"?t.config.conjunction:t.l10n.rangeSeparator)}function Ni(C){C===void 0&&(C=!0),t.mobileInput!==void 0&&t.mobileFormatStr&&(t.mobileInput.value=t.latestSelectedDateObj!==void 0?t.formatDate(t.latestSelectedDateObj,t.mobileFormatStr):""),t.input.value=Us(t.config.dateFormat),t.altInput!==void 0&&(t.altInput.value=Us(t.config.altFormat)),C!==!1&&ot("onValueUpdate")}function I(C){var D=Ki(C),N=t.prevMonthNav.contains(D),W=t.nextMonthNav.contains(D);N||W?ne(N?-1:1):t.yearElements.indexOf(D)>=0?D.select():D.classList.contains("arrowUp")?t.changeYear(t.currentYear+1):D.classList.contains("arrowDown")&&t.changeYear(t.currentYear-1)}function L(C){C.preventDefault();var D=C.type==="keydown",N=Ki(C),W=N;t.amPM!==void 0&&N===t.amPM&&(t.amPM.textContent=t.l10n.amPM[bn(t.amPM.textContent===t.l10n.amPM[0])]);var ae=parseFloat(W.getAttribute("min")),ce=parseFloat(W.getAttribute("max")),Ee=parseFloat(W.getAttribute("step")),Oe=parseInt(W.value,10),Me=C.delta||(D?C.which===38?1:-1:0),me=Oe+Ee*Me;if(typeof W.value<"u"&&W.value.length===2){var Te=W===t.hourElement,Re=W===t.minuteElement;me<ae?(me=ce+me+bn(!Te)+(bn(Te)&&bn(!t.amPM)),Re&&S(void 0,-1,t.hourElement)):me>ce&&(me=W===t.hourElement?me-ce-bn(!t.amPM):ae,Re&&S(void 0,1,t.hourElement)),t.amPM&&Te&&(Ee===1?me+Oe===23:Math.abs(me-Oe)>Ee)&&(t.amPM.textContent=t.l10n.amPM[bn(t.amPM.textContent===t.l10n.amPM[0])]),W.value=Ui(me)}}return s(),t}function _a(n,e){for(var t=Array.prototype.slice.call(n).filter(function(o){return o instanceof HTMLElement}),i=[],s=0;s<t.length;s++){var r=t[s];try{if(r.getAttribute("data-fp-omit")!==null)continue;r._flatpickr!==void 0&&(r._flatpickr.destroy(),r._flatpickr=void 0),r._flatpickr=T6(r,e||{}),i.push(r._flatpickr)}catch(o){console.error(o)}}return i.length===1?i[0]:i}typeof HTMLElement<"u"&&typeof HTMLCollection<"u"&&typeof NodeList<"u"&&(HTMLCollection.prototype.flatpickr=NodeList.prototype.flatpickr=function(n){return _a(this,n)},HTMLElement.prototype.flatpickr=function(n){return _a([this],n)});var Bt=function(n,e){return typeof n=="string"?_a(window.document.querySelectorAll(n),e):n instanceof Node?_a([n],e):_a(n,e)};Bt.defaultConfig={};Bt.l10ns={en:pi({},zh),default:pi({},zh)};Bt.localize=function(n){Bt.l10ns.default=pi(pi({},Bt.l10ns.default),n)};Bt.setDefaults=function(n){Bt.defaultConfig=pi(pi({},Bt.defaultConfig),n)};Bt.parseDate=c0({});Bt.formatDate=lE({});Bt.compareDates=tn;typeof jQuery<"u"&&typeof jQuery.fn<"u"&&(jQuery.fn.flatpickr=function(n){return _a(this,n)});Date.prototype.fp_incr=function(n){return new Date(this.getFullYear(),this.getMonth(),this.getDate()+(typeof n=="string"?parseInt(n,10):n))};typeof window<"u"&&(window.flatpickr=Bt);let d0=[],hE=[];(()=>{let n="lc,34,7n,7,7b,19,,,,2,,2,,,20,b,1c,l,g,,2t,7,2,6,2,2,,4,z,,u,r,2j,b,1m,9,9,,o,4,,9,,3,,5,17,3,3b,f,,w,1j,,,,4,8,4,,3,7,a,2,t,,1m,,,,2,4,8,,9,,a,2,q,,2,2,1l,,4,2,4,2,2,3,3,,u,2,3,,b,2,1l,,4,5,,2,4,,k,2,m,6,,,1m,,,2,,4,8,,7,3,a,2,u,,1n,,,,c,,9,,14,,3,,1l,3,5,3,,4,7,2,b,2,t,,1m,,2,,2,,3,,5,2,7,2,b,2,s,2,1l,2,,,2,4,8,,9,,a,2,t,,20,,4,,2,3,,,8,,29,,2,7,c,8,2q,,2,9,b,6,22,2,r,,,,,,1j,e,,5,,2,5,b,,10,9,,2u,4,,6,,2,2,2,p,2,4,3,g,4,d,,2,2,6,,f,,jj,3,qa,3,t,3,t,2,u,2,1s,2,,7,8,,2,b,9,,19,3,3b,2,y,,3a,3,4,2,9,,6,3,63,2,2,,1m,,,7,,,,,2,8,6,a,2,,1c,h,1r,4,1c,7,,,5,,14,9,c,2,w,4,2,2,,3,1k,,,2,3,,,3,1m,8,2,2,48,3,,d,,7,4,,6,,3,2,5i,1m,,5,ek,,5f,x,2da,3,3x,,2o,w,fe,6,2x,2,n9w,4,,a,w,2,28,2,7k,,3,,4,,p,2,5,,47,2,q,i,d,,12,8,p,b,1a,3,1c,,2,4,2,2,13,,1v,6,2,2,2,2,c,,8,,1b,,1f,,,3,2,2,5,2,,,16,2,8,,6m,,2,,4,,fn4,,kh,g,g,g,a6,2,gt,,6a,,45,5,1ae,3,,2,5,4,14,3,4,,4l,2,fx,4,ar,2,49,b,4w,,1i,f,1k,3,1d,4,2,2,1x,3,10,5,,8,1q,,c,2,1g,9,a,4,2,,2n,3,2,,,2,6,,4g,,3,8,l,2,1l,2,,,,,m,,e,7,3,5,5f,8,2,3,,,n,,29,,2,6,,,2,,,2,,2,6j,,2,4,6,2,,2,r,2,2d,8,2,,,2,2y,,,,2,6,,,2t,3,2,4,,5,77,9,,2,6t,,a,2,,,4,,40,4,2,2,4,,w,a,14,6,2,4,8,,9,6,2,3,1a,d,,2,ba,7,,6,,,2a,m,2,7,,2,,2,3e,6,3,,,2,,7,,,20,2,3,,,,9n,2,f0b,5,1n,7,t4,,1r,4,29,,f5k,2,43q,,,3,4,5,8,8,2,7,u,4,44,3,1iz,1j,4,1e,8,,e,,m,5,,f,11s,7,,h,2,7,,2,,5,79,7,c5,4,15s,7,31,7,240,5,gx7k,2o,3k,6o".split(",").map(e=>e?parseInt(e,36):1);for(let e=0,t=0;e<n.length;e++)(e%2?hE:d0).push(t=t+n[e])})();function w6(n){if(n<768)return!1;for(let e=0,t=d0.length;;){let i=e+t>>1;if(n<d0[i])t=i;else if(n>=hE[i])e=i+1;else return!0;if(e==t)return!1}}function JS(n){return n>=127462&&n<=127487}const ex=8205;function _6(n,e,t=!0,i=!0){return(t?uE:k6)(n,e,i)}function uE(n,e,t){if(e==n.length)return e;e&&cE(n.charCodeAt(e))&&dE(n.charCodeAt(e-1))&&e--;let i=Dm(n,e);for(e+=tx(i);e<n.length;){let s=Dm(n,e);if(i==ex||s==ex||t&&w6(s))e+=tx(s),i=s;else if(JS(s)){let r=0,o=e-2;for(;o>=0&&JS(Dm(n,o));)r++,o-=2;if(r%2==0)break;e+=2}else break}return e}function k6(n,e,t){for(;e>0;){let i=uE(n,e-2,t);if(i<e)return i;e--}return 0}function Dm(n,e){let t=n.charCodeAt(e);if(!dE(t)||e+1==n.length)return t;let i=n.charCodeAt(e+1);return cE(i)?(t-55296<<10)+(i-56320)+65536:t}function cE(n){return n>=56320&&n<57344}function dE(n){return n>=55296&&n<56320}function tx(n){return n<65536?1:2}let Ke=class fE{lineAt(e){if(e<0||e>this.length)throw new RangeError(`Invalid position ${e} in document of length ${this.length}`);return this.lineInner(e,!1,1,0)}line(e){if(e<1||e>this.lines)throw new RangeError(`Invalid line number ${e} in ${this.lines}-line document`);return this.lineInner(e,!0,1,0)}replace(e,t,i){[e,t]=qa(this,e,t);let s=[];return this.decompose(0,e,s,2),i.length&&i.decompose(0,i.length,s,3),this.decompose(t,this.length,s,1),Jc.from(s,this.length-(t-e)+i.length)}append(e){return this.replace(this.length,this.length,e)}slice(e,t=this.length){[e,t]=qa(this,e,t);let i=[];return this.decompose(e,t,i,0),Jc.from(i,t-e)}eq(e){if(e==this)return!0;if(e.length!=this.length||e.lines!=this.lines)return!1;let t=this.scanIdentical(e,1),i=this.length-this.scanIdentical(e,-1),s=new Th(this),r=new Th(e);for(let o=t,a=t;;){if(s.next(o),r.next(o),o=0,s.lineBreak!=r.lineBreak||s.done!=r.done||s.value!=r.value)return!1;if(a+=s.value.length,s.done||a>=i)return!0}}iter(e=1){return new Th(this,e)}iterRange(e,t=this.length){return new pE(this,e,t)}iterLines(e,t){let i;if(e==null)i=this.iter();else{t==null&&(t=this.lines+1);let s=this.line(e).from;i=this.iterRange(s,Math.max(s,t==this.lines+1?this.length:t<=1?0:this.line(t-1).to))}return new mE(i)}toString(){return this.sliceString(0)}toJSON(){let e=[];return this.flatten(e),e}constructor(){}static of(e){if(e.length==0)throw new RangeError("A document must have at least one line");return e.length==1&&!e[0]?fE.empty:e.length<=32?new qn(e):Jc.from(qn.split(e,[]))}},qn=class ls extends Ke{constructor(e,t=C6(e)){super(),this.text=e,this.length=t}get lines(){return this.text.length}get children(){return null}lineInner(e,t,i,s){for(let r=0;;r++){let o=this.text[r],a=s+o.length;if((t?i:a)>=e)return new E6(s,a,i,o);s=a+1,i++}}decompose(e,t,i,s){let r=e<=0&&t>=this.length?this:new ls(ix(this.text,e,t),Math.min(t,this.length)-Math.max(0,e));if(s&1){let o=i.pop(),a=ed(r.text,o.text.slice(),0,r.length);if(a.length<=32)i.push(new ls(a,o.length+r.length));else{let l=a.length>>1;i.push(new ls(a.slice(0,l)),new ls(a.slice(l)))}}else i.push(r)}replace(e,t,i){if(!(i instanceof ls))return super.replace(e,t,i);[e,t]=qa(this,e,t);let s=ed(this.text,ed(i.text,ix(this.text,0,e)),t),r=this.length+i.length-(t-e);return s.length<=32?new ls(s,r):Jc.from(ls.split(s,[]),r)}sliceString(e,t=this.length,i=`
`){[e,t]=qa(this,e,t);let s="";for(let r=0,o=0;r<=t&&o<this.text.length;o++){let a=this.text[o],l=r+a.length;r>e&&o&&(s+=i),e<l&&t>r&&(s+=a.slice(Math.max(0,e-r),t-r)),r=l+1}return s}flatten(e){for(let t of this.text)e.push(t)}scanIdentical(){return 0}static split(e,t){let i=[],s=-1;for(let r of e)i.push(r),s+=r.length+1,i.length==32&&(t.push(new ls(i,s)),i=[],s=-1);return s>-1&&t.push(new ls(i,s)),t}},Jc=class ea extends Ke{constructor(e,t){super(),this.children=e,this.length=t,this.lines=0;for(let i of e)this.lines+=i.lines}lineInner(e,t,i,s){for(let r=0;;r++){let o=this.children[r],a=s+o.length,l=i+o.lines-1;if((t?l:a)>=e)return o.lineInner(e,t,i,s);s=a+1,i=l+1}}decompose(e,t,i,s){for(let r=0,o=0;o<=t&&r<this.children.length;r++){let a=this.children[r],l=o+a.length;if(e<=l&&t>=o){let h=s&((o<=e?1:0)|(l>=t?2:0));o>=e&&l<=t&&!h?i.push(a):a.decompose(e-o,t-o,i,h)}o=l+1}}replace(e,t,i){if([e,t]=qa(this,e,t),i.lines<this.lines)for(let s=0,r=0;s<this.children.length;s++){let o=this.children[s],a=r+o.length;if(e>=r&&t<=a){let l=o.replace(e-r,t-r,i),h=this.lines-o.lines+l.lines;if(l.lines<h>>4&&l.lines>h>>6){let u=this.children.slice();return u[s]=l,new ea(u,this.length-(t-e)+i.length)}return super.replace(r,a,l)}r=a+1}return super.replace(e,t,i)}sliceString(e,t=this.length,i=`
`){[e,t]=qa(this,e,t);let s="";for(let r=0,o=0;r<this.children.length&&o<=t;r++){let a=this.children[r],l=o+a.length;o>e&&r&&(s+=i),e<l&&t>o&&(s+=a.sliceString(e-o,t-o,i)),o=l+1}return s}flatten(e){for(let t of this.children)t.flatten(e)}scanIdentical(e,t){if(!(e instanceof ea))return 0;let i=0,[s,r,o,a]=t>0?[0,0,this.children.length,e.children.length]:[this.children.length-1,e.children.length-1,-1,-1];for(;;s+=t,r+=t){if(s==o||r==a)return i;let l=this.children[s],h=e.children[r];if(l!=h)return i+l.scanIdentical(h,t);i+=l.length+1}}static from(e,t=e.reduce((i,s)=>i+s.length+1,-1)){let i=0;for(let p of e)i+=p.lines;if(i<32){let p=[];for(let b of e)b.flatten(p);return new qn(p,t)}let s=Math.max(32,i>>5),r=s<<1,o=s>>1,a=[],l=0,h=-1,u=[];function c(p){let b;if(p.lines>r&&p instanceof ea)for(let y of p.children)c(y);else p.lines>o&&(l>o||!l)?(f(),a.push(p)):p instanceof qn&&l&&(b=u[u.length-1])instanceof qn&&p.lines+b.lines<=32?(l+=p.lines,h+=p.length+1,u[u.length-1]=new qn(b.text.concat(p.text),b.length+1+p.length)):(l+p.lines>s&&f(),l+=p.lines,h+=p.length+1,u.push(p))}function f(){l!=0&&(a.push(u.length==1?u[0]:ea.from(u,h)),h=-1,l=u.length=0)}for(let p of e)c(p);return f(),a.length==1?a[0]:new ea(a,t)}};Ke.empty=new qn([""],0);function C6(n){let e=-1;for(let t of n)e+=t.length+1;return e}function ed(n,e,t=0,i=1e9){for(let s=0,r=0,o=!0;r<n.length&&s<=i;r++){let a=n[r],l=s+a.length;l>=t&&(l>i&&(a=a.slice(0,i-s)),s<t&&(a=a.slice(t-s)),o?(e[e.length-1]+=a,o=!1):e.push(a)),s=l+1}return e}function ix(n,e,t){return ed(n,[""],e,t)}let Th=class{constructor(e,t=1){this.dir=t,this.done=!1,this.lineBreak=!1,this.value="",this.nodes=[e],this.offsets=[t>0?1:(e instanceof qn?e.text.length:e.children.length)<<1]}nextInner(e,t){for(this.done=this.lineBreak=!1;;){let i=this.nodes.length-1,s=this.nodes[i],r=this.offsets[i],o=r>>1,a=s instanceof qn?s.text.length:s.children.length;if(o==(t>0?a:0)){if(i==0)return this.done=!0,this.value="",this;t>0&&this.offsets[i-1]++,this.nodes.pop(),this.offsets.pop()}else if((r&1)==(t>0?0:1)){if(this.offsets[i]+=t,e==0)return this.lineBreak=!0,this.value=`
`,this;e--}else if(s instanceof qn){let l=s.text[o+(t<0?-1:0)];if(this.offsets[i]+=t,l.length>Math.max(0,e))return this.value=e==0?l:t>0?l.slice(e):l.slice(0,l.length-e),this;e-=l.length}else{let l=s.children[o+(t<0?-1:0)];e>l.length?(e-=l.length,this.offsets[i]+=t):(t<0&&this.offsets[i]--,this.nodes.push(l),this.offsets.push(t>0?1:(l instanceof qn?l.text.length:l.children.length)<<1))}}}next(e=0){return e<0&&(this.nextInner(-e,-this.dir),e=this.value.length),this.nextInner(e,this.dir)}},pE=class{constructor(e,t,i){this.value="",this.done=!1,this.cursor=new Th(e,t>i?-1:1),this.pos=t>i?e.length:0,this.from=Math.min(t,i),this.to=Math.max(t,i)}nextInner(e,t){if(t<0?this.pos<=this.from:this.pos>=this.to)return this.value="",this.done=!0,this;e+=Math.max(0,t<0?this.pos-this.to:this.from-this.pos);let i=t<0?this.pos-this.from:this.to-this.pos;e>i&&(e=i),i-=e;let{value:s}=this.cursor.next(e);return this.pos+=(s.length+e)*t,this.value=s.length<=i?s:t<0?s.slice(s.length-i):s.slice(0,i),this.done=!this.value,this}next(e=0){return e<0?e=Math.max(e,this.from-this.pos):e>0&&(e=Math.min(e,this.to-this.pos)),this.nextInner(e,this.cursor.dir)}get lineBreak(){return this.cursor.lineBreak&&this.value!=""}},mE=class{constructor(e){this.inner=e,this.afterBreak=!0,this.value="",this.done=!1}next(e=0){let{done:t,lineBreak:i,value:s}=this.inner.next(e);return t&&this.afterBreak?(this.value="",this.afterBreak=!1):t?(this.done=!0,this.value=""):i?this.afterBreak?this.value="":(this.afterBreak=!0,this.next()):(this.value=s,this.afterBreak=!1),this}get lineBreak(){return!1}};typeof Symbol<"u"&&(Ke.prototype[Symbol.iterator]=function(){return this.iter()},Th.prototype[Symbol.iterator]=pE.prototype[Symbol.iterator]=mE.prototype[Symbol.iterator]=function(){return this});let E6=class{constructor(e,t,i,s){this.from=e,this.to=t,this.number=i,this.text=s}get length(){return this.to-this.from}};function qa(n,e,t){return e=Math.max(0,Math.min(n.length,e)),[e,Math.max(e,Math.min(n.length,t))]}function bs(n,e,t=!0,i=!0){return _6(n,e,t,i)}function A6(n){return n>=56320&&n<57344}function P6(n){return n>=55296&&n<56320}function D6(n,e){let t=n.charCodeAt(e);if(!P6(t)||e+1==n.length)return t;let i=n.charCodeAt(e+1);return A6(i)?(t-55296<<10)+(i-56320)+65536:t}function M6(n){return n<65536?1:2}const f0=/\r\n?|\n/;var Ri=(function(n){return n[n.Simple=0]="Simple",n[n.TrackDel=1]="TrackDel",n[n.TrackBefore=2]="TrackBefore",n[n.TrackAfter=3]="TrackAfter",n})(Ri||(Ri={}));let wh=class td{constructor(e){this.sections=e}get length(){let e=0;for(let t=0;t<this.sections.length;t+=2)e+=this.sections[t];return e}get newLength(){let e=0;for(let t=0;t<this.sections.length;t+=2){let i=this.sections[t+1];e+=i<0?this.sections[t]:i}return e}get empty(){return this.sections.length==0||this.sections.length==2&&this.sections[1]<0}iterGaps(e){for(let t=0,i=0,s=0;t<this.sections.length;){let r=this.sections[t++],o=this.sections[t++];o<0?(e(i,s,r),s+=r):s+=o,i+=r}}iterChangedRanges(e,t=!1){p0(this,e,t)}get invertedDesc(){let e=[];for(let t=0;t<this.sections.length;){let i=this.sections[t++],s=this.sections[t++];s<0?e.push(i,s):e.push(s,i)}return new td(e)}composeDesc(e){return this.empty?e:e.empty?this:gE(this,e)}mapDesc(e,t=!1){return e.empty?this:m0(this,e,t)}mapPos(e,t=-1,i=Ri.Simple){let s=0,r=0;for(let o=0;o<this.sections.length;){let a=this.sections[o++],l=this.sections[o++],h=s+a;if(l<0){if(h>e)return r+(e-s);r+=a}else{if(i!=Ri.Simple&&h>=e&&(i==Ri.TrackDel&&s<e&&h>e||i==Ri.TrackBefore&&s<e||i==Ri.TrackAfter&&h>e))return null;if(h>e||h==e&&t<0&&!a)return e==s||t<0?r:r+l;r+=l}s=h}if(e>s)throw new RangeError(`Position ${e} is out of range for changeset of length ${s}`);return r}touchesRange(e,t=e){for(let i=0,s=0;i<this.sections.length&&s<=t;){let r=this.sections[i++],o=this.sections[i++],a=s+r;if(o>=0&&s<=t&&a>=e)return s<e&&a>t?"cover":!0;s=a}return!1}toString(){let e="";for(let t=0;t<this.sections.length;){let i=this.sections[t++],s=this.sections[t++];e+=(e?" ":"")+i+(s>=0?":"+s:"")}return e}toJSON(){return this.sections}static fromJSON(e){if(!Array.isArray(e)||e.length%2||e.some(t=>typeof t!="number"))throw new RangeError("Invalid JSON representation of ChangeDesc");return new td(e)}static create(e){return new td(e)}},Ds=class br extends wh{constructor(e,t){super(e),this.inserted=t}apply(e){if(this.length!=e.length)throw new RangeError("Applying change set to a document with the wrong length");return p0(this,(t,i,s,r,o)=>e=e.replace(s,s+(i-t),o),!1),e}mapDesc(e,t=!1){return m0(this,e,t,!0)}invert(e){let t=this.sections.slice(),i=[];for(let s=0,r=0;s<t.length;s+=2){let o=t[s],a=t[s+1];if(a>=0){t[s]=a,t[s+1]=o;let l=s>>1;for(;i.length<l;)i.push(Ke.empty);i.push(o?e.slice(r,r+o):Ke.empty)}r+=o}return new br(t,i)}compose(e){return this.empty?e:e.empty?this:gE(this,e,!0)}map(e,t=!1){return e.empty?this:m0(this,e,t,!0)}iterChanges(e,t=!1){p0(this,e,t)}get desc(){return wh.create(this.sections)}filter(e){let t=[],i=[],s=[],r=new jh(this);e:for(let o=0,a=0;;){let l=o==e.length?1e9:e[o++];for(;a<l||a==l&&r.len==0;){if(r.done)break e;let u=Math.min(r.len,l-a);mi(s,u,-1);let c=r.ins==-1?-1:r.off==0?r.ins:0;mi(t,u,c),c>0&&Mr(i,t,r.text),r.forward(u),a+=u}let h=e[o++];for(;a<h;){if(r.done)break e;let u=Math.min(r.len,h-a);mi(t,u,-1),mi(s,u,r.ins==-1?-1:r.off==0?r.ins:0),r.forward(u),a+=u}}return{changes:new br(t,i),filtered:wh.create(s)}}toJSON(){let e=[];for(let t=0;t<this.sections.length;t+=2){let i=this.sections[t],s=this.sections[t+1];s<0?e.push(i):s==0?e.push([i]):e.push([i].concat(this.inserted[t>>1].toJSON()))}return e}static of(e,t,i){let s=[],r=[],o=0,a=null;function l(u=!1){if(!u&&!s.length)return;o<t&&mi(s,t-o,-1);let c=new br(s,r);a=a?a.compose(c.map(a)):c,s=[],r=[],o=0}function h(u){if(Array.isArray(u))for(let c of u)h(c);else if(u instanceof br){if(u.length!=t)throw new RangeError(`Mismatched change set length (got ${u.length}, expected ${t})`);l(),a=a?a.compose(u.map(a)):u}else{let{from:c,to:f=c,insert:p}=u;if(c>f||c<0||f>t)throw new RangeError(`Invalid change range ${c} to ${f} (in doc of length ${t})`);let b=p?typeof p=="string"?Ke.of(p.split(i||f0)):p:Ke.empty,y=b.length;if(c==f&&y==0)return;c<o&&l(),c>o&&mi(s,c-o,-1),mi(s,f-c,y),Mr(r,s,b),o=f}}return h(e),l(!a),a}static empty(e){return new br(e?[e,-1]:[],[])}static fromJSON(e){if(!Array.isArray(e))throw new RangeError("Invalid JSON representation of ChangeSet");let t=[],i=[];for(let s=0;s<e.length;s++){let r=e[s];if(typeof r=="number")t.push(r,-1);else{if(!Array.isArray(r)||typeof r[0]!="number"||r.some((o,a)=>a&&typeof o!="string"))throw new RangeError("Invalid JSON representation of ChangeSet");if(r.length==1)t.push(r[0],0);else{for(;i.length<s;)i.push(Ke.empty);i[s]=Ke.of(r.slice(1)),t.push(r[0],i[s].length)}}}return new br(t,i)}static createSet(e,t){return new br(e,t)}};function mi(n,e,t,i=!1){if(e==0&&t<=0)return;let s=n.length-2;s>=0&&t<=0&&t==n[s+1]?n[s]+=e:s>=0&&e==0&&n[s]==0?n[s+1]+=t:i?(n[s]+=e,n[s+1]+=t):n.push(e,t)}function Mr(n,e,t){if(t.length==0)return;let i=e.length-2>>1;if(i<n.length)n[n.length-1]=n[n.length-1].append(t);else{for(;n.length<i;)n.push(Ke.empty);n.push(t)}}function p0(n,e,t){let i=n.inserted;for(let s=0,r=0,o=0;o<n.sections.length;){let a=n.sections[o++],l=n.sections[o++];if(l<0)s+=a,r+=a;else{let h=s,u=r,c=Ke.empty;for(;h+=a,u+=l,l&&i&&(c=c.append(i[o-2>>1])),!(t||o==n.sections.length||n.sections[o+1]<0);)a=n.sections[o++],l=n.sections[o++];e(s,h,r,u,c),s=h,r=u}}}function m0(n,e,t,i=!1){let s=[],r=i?[]:null,o=new jh(n),a=new jh(e);for(let l=-1;;){if(o.done&&a.len||a.done&&o.len)throw new Error("Mismatched change set lengths");if(o.ins==-1&&a.ins==-1){let h=Math.min(o.len,a.len);mi(s,h,-1),o.forward(h),a.forward(h)}else if(a.ins>=0&&(o.ins<0||l==o.i||o.off==0&&(a.len<o.len||a.len==o.len&&!t))){let h=a.len;for(mi(s,a.ins,-1);h;){let u=Math.min(o.len,h);o.ins>=0&&l<o.i&&o.len<=u&&(mi(s,0,o.ins),r&&Mr(r,s,o.text),l=o.i),o.forward(u),h-=u}a.next()}else if(o.ins>=0){let h=0,u=o.len;for(;u;)if(a.ins==-1){let c=Math.min(u,a.len);h+=c,u-=c,a.forward(c)}else if(a.ins==0&&a.len<u)u-=a.len,a.next();else break;mi(s,h,l<o.i?o.ins:0),r&&l<o.i&&Mr(r,s,o.text),l=o.i,o.forward(o.len-u)}else{if(o.done&&a.done)return r?Ds.createSet(s,r):wh.create(s);throw new Error("Mismatched change set lengths")}}}function gE(n,e,t=!1){let i=[],s=t?[]:null,r=new jh(n),o=new jh(e);for(let a=!1;;){if(r.done&&o.done)return s?Ds.createSet(i,s):wh.create(i);if(r.ins==0)mi(i,r.len,0,a),r.next();else if(o.len==0&&!o.done)mi(i,0,o.ins,a),s&&Mr(s,i,o.text),o.next();else{if(r.done||o.done)throw new Error("Mismatched change set lengths");{let l=Math.min(r.len2,o.len),h=i.length;if(r.ins==-1){let u=o.ins==-1?-1:o.off?0:o.ins;mi(i,l,u,a),s&&u&&Mr(s,i,o.text)}else o.ins==-1?(mi(i,r.off?0:r.len,l,a),s&&Mr(s,i,r.textBit(l))):(mi(i,r.off?0:r.len,o.off?0:o.ins,a),s&&!o.off&&Mr(s,i,o.text));a=(r.ins>l||o.ins>=0&&o.len>l)&&(a||i.length>h),r.forward2(l),o.forward(l)}}}}let jh=class{constructor(e){this.set=e,this.i=0,this.next()}next(){let{sections:e}=this.set;this.i<e.length?(this.len=e[this.i++],this.ins=e[this.i++]):(this.len=0,this.ins=-2),this.off=0}get done(){return this.ins==-2}get len2(){return this.ins<0?this.len:this.ins}get text(){let{inserted:e}=this.set,t=this.i-2>>1;return t>=e.length?Ke.empty:e[t]}textBit(e){let{inserted:t}=this.set,i=this.i-2>>1;return i>=t.length&&!e?Ke.empty:t[i].slice(this.off,e==null?void 0:this.off+e)}forward(e){e==this.len?this.next():(this.len-=e,this.off+=e)}forward2(e){this.ins==-1?this.forward(e):e==this.ins?this.next():(this.ins-=e,this.off+=e)}},Oc=class g0{constructor(e,t,i){this.from=e,this.to=t,this.flags=i}get anchor(){return this.flags&32?this.to:this.from}get head(){return this.flags&32?this.from:this.to}get empty(){return this.from==this.to}get assoc(){return this.flags&8?-1:this.flags&16?1:0}get bidiLevel(){let e=this.flags&7;return e==7?null:e}get goalColumn(){let e=this.flags>>6;return e==16777215?void 0:e}map(e,t=-1){let i,s;return this.empty?i=s=e.mapPos(this.from,t):(i=e.mapPos(this.from,1),s=e.mapPos(this.to,-1)),i==this.from&&s==this.to?this:new g0(i,s,this.flags)}extend(e,t=e){if(e<=this.anchor&&t>=this.anchor)return ke.range(e,t);let i=Math.abs(e-this.anchor)>Math.abs(t-this.anchor)?e:t;return ke.range(this.anchor,i)}eq(e,t=!1){return this.anchor==e.anchor&&this.head==e.head&&(!t||!this.empty||this.assoc==e.assoc)}toJSON(){return{anchor:this.anchor,head:this.head}}static fromJSON(e){if(!e||typeof e.anchor!="number"||typeof e.head!="number")throw new RangeError("Invalid JSON representation for SelectionRange");return ke.range(e.anchor,e.head)}static create(e,t,i){return new g0(e,t,i)}},ke=class nn{constructor(e,t){this.ranges=e,this.mainIndex=t}map(e,t=-1){return e.empty?this:nn.create(this.ranges.map(i=>i.map(e,t)),this.mainIndex)}eq(e,t=!1){if(this.ranges.length!=e.ranges.length||this.mainIndex!=e.mainIndex)return!1;for(let i=0;i<this.ranges.length;i++)if(!this.ranges[i].eq(e.ranges[i],t))return!1;return!0}get main(){return this.ranges[this.mainIndex]}asSingle(){return this.ranges.length==1?this:new nn([this.main],0)}addRange(e,t=!0){return nn.create([e].concat(this.ranges),t?0:this.mainIndex+1)}replaceRange(e,t=this.mainIndex){let i=this.ranges.slice();return i[t]=e,nn.create(i,this.mainIndex)}toJSON(){return{ranges:this.ranges.map(e=>e.toJSON()),main:this.mainIndex}}static fromJSON(e){if(!e||!Array.isArray(e.ranges)||typeof e.main!="number"||e.main>=e.ranges.length)throw new RangeError("Invalid JSON representation for EditorSelection");return new nn(e.ranges.map(t=>Oc.fromJSON(t)),e.main)}static single(e,t=e){return new nn([nn.range(e,t)],0)}static create(e,t=0){if(e.length==0)throw new RangeError("A selection needs at least one range");for(let i=0,s=0;s<e.length;s++){let r=e[s];if(r.empty?r.from<=i:r.from<i)return nn.normalized(e.slice(),t);i=r.to}return new nn(e,t)}static cursor(e,t=0,i,s){return Oc.create(e,e,(t==0?0:t<0?8:16)|(i==null?7:Math.min(6,i))|(s??16777215)<<6)}static range(e,t,i,s){let r=(i??16777215)<<6|(s==null?7:Math.min(6,s));return t<e?Oc.create(t,e,48|r):Oc.create(e,t,(t>e?8:0)|r)}static normalized(e,t=0){let i=e[t];e.sort((s,r)=>s.from-r.from),t=e.indexOf(i);for(let s=1;s<e.length;s++){let r=e[s],o=e[s-1];if(r.empty?r.from<=o.to:r.from<o.to){let a=o.from,l=Math.max(r.to,o.to);s<=t&&t--,e.splice(--s,2,r.anchor>r.head?nn.range(l,a):nn.range(a,l))}}return new nn(e,t)}};function OE(n,e){for(let t of n.ranges)if(t.to>e)throw new RangeError("Selection points outside of document")}let ub=0,Qe=class yE{constructor(e,t,i,s,r){this.combine=e,this.compareInput=t,this.compare=i,this.isStatic=s,this.id=ub++,this.default=e([]),this.extensions=typeof r=="function"?r(this):r}get reader(){return this}static define(e={}){return new yE(e.combine||(t=>t),e.compareInput||((t,i)=>t===i),e.compare||(e.combine?(t,i)=>t===i:cb),!!e.static,e.enables)}of(e){return new id([],this,0,e)}compute(e,t){if(this.isStatic)throw new Error("Can't compute a static facet");return new id(e,this,1,t)}computeN(e,t){if(this.isStatic)throw new Error("Can't compute a static facet");return new id(e,this,2,t)}from(e,t){return t||(t=i=>i),this.compute([e],i=>t(i.field(e)))}};function cb(n,e){return n==e||n.length==e.length&&n.every((t,i)=>t===e[i])}let id=class{constructor(e,t,i,s){this.dependencies=e,this.facet=t,this.type=i,this.value=s,this.id=ub++}dynamicSlot(e){var t;let i=this.value,s=this.facet.compareInput,r=this.id,o=e[r]>>1,a=this.type==2,l=!1,h=!1,u=[];for(let c of this.dependencies)c=="doc"?l=!0:c=="selection"?h=!0:(((t=e[c.id])!==null&&t!==void 0?t:1)&1)==0&&u.push(e[c.id]);return{create(c){return c.values[o]=i(c),1},update(c,f){if(l&&f.docChanged||h&&(f.docChanged||f.selection)||O0(c,u)){let p=i(c);if(a?!nx(p,c.values[o],s):!s(p,c.values[o]))return c.values[o]=p,1}return 0},reconfigure:(c,f)=>{let p,b=f.config.address[r];if(b!=null){let y=Zd(f,b);if(this.dependencies.every(_=>_ instanceof Qe?f.facet(_)===c.facet(_):_ instanceof ml?f.field(_,!1)==c.field(_,!1):!0)||(a?nx(p=i(c),y,s):s(p=i(c),y)))return c.values[o]=y,0}else p=i(c);return c.values[o]=p,1}}}};function nx(n,e,t){if(n.length!=e.length)return!1;for(let i=0;i<n.length;i++)if(!t(n[i],e[i]))return!1;return!0}function O0(n,e){let t=!1;for(let i of e)_h(n,i)&1&&(t=!0);return t}function I6(n,e,t){let i=t.map(l=>n[l.id]),s=t.map(l=>l.type),r=i.filter(l=>!(l&1)),o=n[e.id]>>1;function a(l){let h=[];for(let u=0;u<i.length;u++){let c=Zd(l,i[u]);if(s[u]==2)for(let f of c)h.push(f);else h.push(c)}return e.combine(h)}return{create(l){for(let h of i)_h(l,h);return l.values[o]=a(l),1},update(l,h){if(!O0(l,r))return 0;let u=a(l);return e.compare(u,l.values[o])?0:(l.values[o]=u,1)},reconfigure(l,h){let u=O0(l,i),c=h.config.facets[e.id],f=h.facet(e);if(c&&!u&&cb(t,c))return l.values[o]=f,0;let p=a(l);return e.compare(p,f)?(l.values[o]=f,0):(l.values[o]=p,1)}}}const yc=Qe.define({static:!0});let ml=class bE{constructor(e,t,i,s,r){this.id=e,this.createF=t,this.updateF=i,this.compareF=s,this.spec=r,this.provides=void 0}static define(e){let t=new bE(ub++,e.create,e.update,e.compare||((i,s)=>i===s),e);return e.provide&&(t.provides=e.provide(t)),t}create(e){let t=e.facet(yc).find(i=>i.field==this);return(t?.create||this.createF)(e)}slot(e){let t=e[this.id]>>1;return{create:i=>(i.values[t]=this.create(i),1),update:(i,s)=>{let r=i.values[t],o=this.updateF(r,s);return this.compareF(r,o)?0:(i.values[t]=o,1)},reconfigure:(i,s)=>{let r=i.facet(yc),o=s.facet(yc),a;return(a=r.find(l=>l.field==this))&&a!=o.find(l=>l.field==this)?(i.values[t]=a.create(i),1):s.config.address[this.id]!=null?(i.values[t]=s.field(this),0):(i.values[t]=this.create(i),1)}}}init(e){return[this,yc.of({field:this,create:e})]}get extension(){return this}};const fo={lowest:4,low:3,default:2,high:1,highest:0};function Fl(n){return e=>new vE(e,n)}const ku={highest:Fl(fo.highest),high:Fl(fo.high),default:Fl(fo.default),low:Fl(fo.low),lowest:Fl(fo.lowest)};let vE=class{constructor(e,t){this.inner=e,this.prec=t}},SE=class xE{of(e){return new y0(this,e)}reconfigure(e){return xE.reconfigure.of({compartment:this,extension:e})}get(e){return e.config.compartments.get(this)}},y0=class{constructor(e,t){this.compartment=e,this.inner=t}},sx=class TE{constructor(e,t,i,s,r,o){for(this.base=e,this.compartments=t,this.dynamicSlots=i,this.address=s,this.staticValues=r,this.facets=o,this.statusTemplate=[];this.statusTemplate.length<i.length;)this.statusTemplate.push(0)}staticFacet(e){let t=this.address[e.id];return t==null?e.default:this.staticValues[t>>1]}static resolve(e,t,i){let s=[],r=Object.create(null),o=new Map;for(let f of R6(e,t,o))f instanceof ml?s.push(f):(r[f.facet.id]||(r[f.facet.id]=[])).push(f);let a=Object.create(null),l=[],h=[];for(let f of s)a[f.id]=h.length<<1,h.push(p=>f.slot(p));let u=i?.config.facets;for(let f in r){let p=r[f],b=p[0].facet,y=u&&u[f]||[];if(p.every(_=>_.type==0))if(a[b.id]=l.length<<1|1,cb(y,p))l.push(i.facet(b));else{let _=b.combine(p.map(T=>T.value));l.push(i&&b.compare(_,i.facet(b))?i.facet(b):_)}else{for(let _ of p)_.type==0?(a[_.id]=l.length<<1|1,l.push(_.value)):(a[_.id]=h.length<<1,h.push(T=>_.dynamicSlot(T)));a[b.id]=h.length<<1,h.push(_=>I6(_,b,p))}}let c=h.map(f=>f(a));return new TE(e,o,c,a,l,r)}};function R6(n,e,t){let i=[[],[],[],[],[]],s=new Map;function r(o,a){let l=s.get(o);if(l!=null){if(l<=a)return;let h=i[l].indexOf(o);h>-1&&i[l].splice(h,1),o instanceof y0&&t.delete(o.compartment)}if(s.set(o,a),Array.isArray(o))for(let h of o)r(h,a);else if(o instanceof y0){if(t.has(o.compartment))throw new RangeError("Duplicate use of compartment in extensions");let h=e.get(o.compartment)||o.inner;t.set(o.compartment,h),r(h,a)}else if(o instanceof vE)r(o.inner,o.prec);else if(o instanceof ml)i[a].push(o),o.provides&&r(o.provides,a);else if(o instanceof id)i[a].push(o),o.facet.extensions&&r(o.facet.extensions,fo.default);else{let h=o.extension;if(!h)throw new Error(`Unrecognized extension value in extension set (${o}). This sometimes happens because multiple instances of @codemirror/state are loaded, breaking instanceof checks.`);r(h,a)}}return r(n,fo.default),i.reduce((o,a)=>o.concat(a))}function _h(n,e){if(e&1)return 2;let t=e>>1,i=n.status[t];if(i==4)throw new Error("Cyclic dependency between fields and/or facets");if(i&2)return i;n.status[t]=4;let s=n.computeSlot(n,n.config.dynamicSlots[t]);return n.status[t]=2|s}function Zd(n,e){return e&1?n.config.staticValues[e>>1]:n.values[e>>1]}const wE=Qe.define(),b0=Qe.define({combine:n=>n.some(e=>e),static:!0}),_E=Qe.define({combine:n=>n.length?n[0]:void 0,static:!0}),kE=Qe.define(),CE=Qe.define(),EE=Qe.define(),AE=Qe.define({combine:n=>n.length?n[0]:!1});let Fo=class{constructor(e,t){this.type=e,this.value=t}static define(){return new L6}},L6=class{of(e){return new Fo(this,e)}},$6=class{constructor(e){this.map=e}of(e){return new jt(this,e)}},jt=class PE{constructor(e,t){this.type=e,this.value=t}map(e){let t=this.type.map(this.value,e);return t===void 0?void 0:t==this.value?this:new PE(this.type,t)}is(e){return this.type==e}static define(e={}){return new $6(e.map||(t=>t))}static mapEffects(e,t){if(!e.length)return e;let i=[];for(let s of e){let r=s.map(t);r&&i.push(r)}return i}};jt.reconfigure=jt.define();jt.appendConfig=jt.define();let En=class th{constructor(e,t,i,s,r,o){this.startState=e,this.changes=t,this.selection=i,this.effects=s,this.annotations=r,this.scrollIntoView=o,this._doc=null,this._state=null,i&&OE(i,t.newLength),r.some(a=>a.type==th.time)||(this.annotations=r.concat(th.time.of(Date.now())))}static create(e,t,i,s,r,o){return new th(e,t,i,s,r,o)}get newDoc(){return this._doc||(this._doc=this.changes.apply(this.startState.doc))}get newSelection(){return this.selection||this.startState.selection.map(this.changes)}get state(){return this._state||this.startState.applyTransaction(this),this._state}annotation(e){for(let t of this.annotations)if(t.type==e)return t.value}get docChanged(){return!this.changes.empty}get reconfigured(){return this.startState.config!=this.state.config}isUserEvent(e){let t=this.annotation(th.userEvent);return!!(t&&(t==e||t.length>e.length&&t.slice(0,e.length)==e&&t[e.length]=="."))}};En.time=Fo.define();En.userEvent=Fo.define();En.addToHistory=Fo.define();En.remote=Fo.define();function Q6(n,e){let t=[];for(let i=0,s=0;;){let r,o;if(i<n.length&&(s==e.length||e[s]>=n[i]))r=n[i++],o=n[i++];else if(s<e.length)r=e[s++],o=e[s++];else return t;!t.length||t[t.length-1]<r?t.push(r,o):t[t.length-1]<o&&(t[t.length-1]=o)}}function DE(n,e,t){var i;let s,r,o;return t?(s=e.changes,r=Ds.empty(e.changes.length),o=n.changes.compose(e.changes)):(s=e.changes.map(n.changes),r=n.changes.mapDesc(e.changes,!0),o=n.changes.compose(s)),{changes:o,selection:e.selection?e.selection.map(r):(i=n.selection)===null||i===void 0?void 0:i.map(s),effects:jt.mapEffects(n.effects,s).concat(jt.mapEffects(e.effects,r)),annotations:n.annotations.length?n.annotations.concat(e.annotations):e.annotations,scrollIntoView:n.scrollIntoView||e.scrollIntoView}}function v0(n,e,t){let i=e.selection,s=ka(e.annotations);return e.userEvent&&(s=s.concat(En.userEvent.of(e.userEvent))),{changes:e.changes instanceof Ds?e.changes:Ds.of(e.changes||[],t,n.facet(_E)),selection:i&&(i instanceof ke?i:ke.single(i.anchor,i.head)),effects:ka(e.effects),annotations:s,scrollIntoView:!!e.scrollIntoView}}function ME(n,e,t){let i=v0(n,e.length?e[0]:{},n.doc.length);e.length&&e[0].filter===!1&&(t=!1);for(let r=1;r<e.length;r++){e[r].filter===!1&&(t=!1);let o=!!e[r].sequential;i=DE(i,v0(n,e[r],o?i.changes.newLength:n.doc.length),o)}let s=En.create(n,i.changes,i.selection,i.effects,i.annotations,i.scrollIntoView);return N6(t?B6(s):s)}function B6(n){let e=n.startState,t=!0;for(let s of e.facet(kE)){let r=s(n);if(r===!1){t=!1;break}Array.isArray(r)&&(t=t===!0?r:Q6(t,r))}if(t!==!0){let s,r;if(t===!1)r=n.changes.invertedDesc,s=Ds.empty(e.doc.length);else{let o=n.changes.filter(t);s=o.changes,r=o.filtered.mapDesc(o.changes).invertedDesc}n=En.create(e,s,n.selection&&n.selection.map(r),jt.mapEffects(n.effects,r),n.annotations,n.scrollIntoView)}let i=e.facet(CE);for(let s=i.length-1;s>=0;s--){let r=i[s](n);r instanceof En?n=r:Array.isArray(r)&&r.length==1&&r[0]instanceof En?n=r[0]:n=ME(e,ka(r),!1)}return n}function N6(n){let e=n.startState,t=e.facet(EE),i=n;for(let s=t.length-1;s>=0;s--){let r=t[s](n);r&&Object.keys(r).length&&(i=DE(i,v0(e,r,n.changes.newLength),!0))}return i==n?n:En.create(e,n.changes,n.selection,i.effects,i.annotations,i.scrollIntoView)}const F6=[];function ka(n){return n==null?F6:Array.isArray(n)?n:[n]}var er=(function(n){return n[n.Word=0]="Word",n[n.Space=1]="Space",n[n.Other=2]="Other",n})(er||(er={}));const V6=/[\u00df\u0587\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/;let S0;try{S0=new RegExp("[\\p{Alphabetic}\\p{Number}_]","u")}catch{}function U6(n){if(S0)return S0.test(n);for(let e=0;e<n.length;e++){let t=n[e];if(/\w/.test(t)||t>""&&(t.toUpperCase()!=t.toLowerCase()||V6.test(t)))return!0}return!1}function q6(n){return e=>{if(!/\S/.test(e))return er.Space;if(U6(e))return er.Word;for(let t=0;t<n.length;t++)if(e.indexOf(n[t])>-1)return er.Word;return er.Other}}let Zt=class Fn{constructor(e,t,i,s,r,o){this.config=e,this.doc=t,this.selection=i,this.values=s,this.status=e.statusTemplate.slice(),this.computeSlot=r,o&&(o._state=this);for(let a=0;a<this.config.dynamicSlots.length;a++)_h(this,a<<1);this.computeSlot=null}field(e,t=!0){let i=this.config.address[e.id];if(i==null){if(t)throw new RangeError("Field is not present in this state");return}return _h(this,i),Zd(this,i)}update(...e){return ME(this,e,!0)}applyTransaction(e){let t=this.config,{base:i,compartments:s}=t;for(let a of e.effects)a.is(SE.reconfigure)?(t&&(s=new Map,t.compartments.forEach((l,h)=>s.set(h,l)),t=null),s.set(a.value.compartment,a.value.extension)):a.is(jt.reconfigure)?(t=null,i=a.value):a.is(jt.appendConfig)&&(t=null,i=ka(i).concat(a.value));let r;t?r=e.startState.values.slice():(t=sx.resolve(i,s,this),r=new Fn(t,this.doc,this.selection,t.dynamicSlots.map(()=>null),(l,h)=>h.reconfigure(l,this),null).values);let o=e.startState.facet(b0)?e.newSelection:e.newSelection.asSingle();new Fn(t,e.newDoc,o,r,(a,l)=>l.update(a,e),e)}replaceSelection(e){return typeof e=="string"&&(e=this.toText(e)),this.changeByRange(t=>({changes:{from:t.from,to:t.to,insert:e},range:ke.cursor(t.from+e.length)}))}changeByRange(e){let t=this.selection,i=e(t.ranges[0]),s=this.changes(i.changes),r=[i.range],o=ka(i.effects);for(let a=1;a<t.ranges.length;a++){let l=e(t.ranges[a]),h=this.changes(l.changes),u=h.map(s);for(let f=0;f<a;f++)r[f]=r[f].map(u);let c=s.mapDesc(h,!0);r.push(l.range.map(c)),s=s.compose(u),o=jt.mapEffects(o,u).concat(jt.mapEffects(ka(l.effects),c))}return{changes:s,selection:ke.create(r,t.mainIndex),effects:o}}changes(e=[]){return e instanceof Ds?e:Ds.of(e,this.doc.length,this.facet(Fn.lineSeparator))}toText(e){return Ke.of(e.split(this.facet(Fn.lineSeparator)||f0))}sliceDoc(e=0,t=this.doc.length){return this.doc.sliceString(e,t,this.lineBreak)}facet(e){let t=this.config.address[e.id];return t==null?e.default:(_h(this,t),Zd(this,t))}toJSON(e){let t={doc:this.sliceDoc(),selection:this.selection.toJSON()};if(e)for(let i in e){let s=e[i];s instanceof ml&&this.config.address[s.id]!=null&&(t[i]=s.spec.toJSON(this.field(e[i]),this))}return t}static fromJSON(e,t={},i){if(!e||typeof e.doc!="string")throw new RangeError("Invalid JSON representation for EditorState");let s=[];if(i){for(let r in i)if(Object.prototype.hasOwnProperty.call(e,r)){let o=i[r],a=e[r];s.push(o.init(l=>o.spec.fromJSON(a,l)))}}return Fn.create({doc:e.doc,selection:ke.fromJSON(e.selection),extensions:t.extensions?s.concat([t.extensions]):s})}static create(e={}){let t=sx.resolve(e.extensions||[],new Map),i=e.doc instanceof Ke?e.doc:Ke.of((e.doc||"").split(t.staticFacet(Fn.lineSeparator)||f0)),s=e.selection?e.selection instanceof ke?e.selection:ke.single(e.selection.anchor,e.selection.head):ke.single(0);return OE(s,i.length),t.staticFacet(b0)||(s=s.asSingle()),new Fn(t,i,s,t.dynamicSlots.map(()=>null),(r,o)=>o.create(r),null)}get tabSize(){return this.facet(Fn.tabSize)}get lineBreak(){return this.facet(Fn.lineSeparator)||`
`}get readOnly(){return this.facet(AE)}phrase(e,...t){for(let i of this.facet(Fn.phrases))if(Object.prototype.hasOwnProperty.call(i,e)){e=i[e];break}return t.length&&(e=e.replace(/\$(\$|\d*)/g,(i,s)=>{if(s=="$")return"$";let r=+(s||1);return!r||r>t.length?i:t[r-1]})),e}languageDataAt(e,t,i=-1){let s=[];for(let r of this.facet(wE))for(let o of r(this,t,i))Object.prototype.hasOwnProperty.call(o,e)&&s.push(o[e]);return s}charCategorizer(e){return q6(this.languageDataAt("wordChars",e).join(""))}wordAt(e){let{text:t,from:i,length:s}=this.doc.lineAt(e),r=this.charCategorizer(e),o=e-i,a=e-i;for(;o>0;){let l=bs(t,o,!1);if(r(t.slice(l,o))!=er.Word)break;o=l}for(;a<s;){let l=bs(t,a);if(r(t.slice(a,l))!=er.Word)break;a=l}return o==a?null:ke.range(o+i,a+i)}};Zt.allowMultipleSelections=b0;Zt.tabSize=Qe.define({combine:n=>n.length?n[0]:4});Zt.lineSeparator=_E;Zt.readOnly=AE;Zt.phrases=Qe.define({compare(n,e){let t=Object.keys(n),i=Object.keys(e);return t.length==i.length&&t.every(s=>n[s]==e[s])}});Zt.languageData=wE;Zt.changeFilter=kE;Zt.transactionFilter=CE;Zt.transactionExtender=EE;SE.reconfigure=jt.define();let Mo=class{eq(e){return this==e}range(e,t=e){return x0.create(e,t,this)}};Mo.prototype.startSide=Mo.prototype.endSide=0;Mo.prototype.point=!1;Mo.prototype.mapMode=Ri.TrackDel;let x0=class IE{constructor(e,t,i){this.from=e,this.to=t,this.value=i}static create(e,t,i){return new IE(e,t,i)}};function T0(n,e){return n.from-e.from||n.value.startSide-e.value.startSide}let z6=class RE{constructor(e,t,i,s){this.from=e,this.to=t,this.value=i,this.maxPoint=s}get length(){return this.to[this.to.length-1]}findIndex(e,t,i,s=0){let r=i?this.to:this.from;for(let o=s,a=r.length;;){if(o==a)return o;let l=o+a>>1,h=r[l]-e||(i?this.value[l].endSide:this.value[l].startSide)-t;if(l==o)return h>=0?o:a;h>=0?a=l:o=l+1}}between(e,t,i,s){for(let r=this.findIndex(t,-1e9,!0),o=this.findIndex(i,1e9,!1,r);r<o;r++)if(s(this.from[r]+e,this.to[r]+e,this.value[r])===!1)return!1}map(e,t){let i=[],s=[],r=[],o=-1,a=-1;for(let l=0;l<this.value.length;l++){let h=this.value[l],u=this.from[l]+e,c=this.to[l]+e,f,p;if(u==c){let b=t.mapPos(u,h.startSide,h.mapMode);if(b==null||(f=p=b,h.startSide!=h.endSide&&(p=t.mapPos(u,h.endSide),p<f)))continue}else if(f=t.mapPos(u,h.startSide),p=t.mapPos(c,h.endSide),f>p||f==p&&h.startSide>0&&h.endSide<=0)continue;(p-f||h.endSide-h.startSide)<0||(o<0&&(o=f),h.point&&(a=Math.max(a,p-f)),i.push(h),s.push(f-o),r.push(p-o))}return{mapped:i.length?new RE(s,r,i,a):null,pos:o}}},xi=class Zs{constructor(e,t,i,s){this.chunkPos=e,this.chunk=t,this.nextLayer=i,this.maxPoint=s}static create(e,t,i,s){return new Zs(e,t,i,s)}get length(){let e=this.chunk.length-1;return e<0?0:Math.max(this.chunkEnd(e),this.nextLayer.length)}get size(){if(this.isEmpty)return 0;let e=this.nextLayer.size;for(let t of this.chunk)e+=t.value.length;return e}chunkEnd(e){return this.chunkPos[e]+this.chunk[e].length}update(e){let{add:t=[],sort:i=!1,filterFrom:s=0,filterTo:r=this.length}=e,o=e.filter;if(t.length==0&&!o)return this;if(i&&(t=t.slice().sort(T0)),this.isEmpty)return t.length?Zs.of(t):this;let a=new $E(this,null,-1).goto(0),l=0,h=[],u=new w0;for(;a.value||l<t.length;)if(l<t.length&&(a.from-t[l].from||a.startSide-t[l].value.startSide)>=0){let c=t[l++];u.addInner(c.from,c.to,c.value)||h.push(c)}else a.rangeIndex==1&&a.chunkIndex<this.chunk.length&&(l==t.length||this.chunkEnd(a.chunkIndex)<t[l].from)&&(!o||s>this.chunkEnd(a.chunkIndex)||r<this.chunkPos[a.chunkIndex])&&u.addChunk(this.chunkPos[a.chunkIndex],this.chunk[a.chunkIndex])?a.nextChunk():((!o||s>a.to||r<a.from||o(a.from,a.to,a.value))&&(u.addInner(a.from,a.to,a.value)||h.push(x0.create(a.from,a.to,a.value))),a.next());return u.finishInner(this.nextLayer.isEmpty&&!h.length?Zs.empty:this.nextLayer.update({add:h,filter:o,filterFrom:s,filterTo:r}))}map(e){if(e.empty||this.isEmpty)return this;let t=[],i=[],s=-1;for(let o=0;o<this.chunk.length;o++){let a=this.chunkPos[o],l=this.chunk[o],h=e.touchesRange(a,a+l.length);if(h===!1)s=Math.max(s,l.maxPoint),t.push(l),i.push(e.mapPos(a));else if(h===!0){let{mapped:u,pos:c}=l.map(a,e);u&&(s=Math.max(s,u.maxPoint),t.push(u),i.push(c))}}let r=this.nextLayer.map(e);return t.length==0?r:new Zs(i,t,r||Zs.empty,s)}between(e,t,i){if(!this.isEmpty){for(let s=0;s<this.chunk.length;s++){let r=this.chunkPos[s],o=this.chunk[s];if(t>=r&&e<=r+o.length&&o.between(r,e-r,t-r,i)===!1)return}this.nextLayer.between(e,t,i)}}iter(e=0){return _0.from([this]).goto(e)}get isEmpty(){return this.nextLayer==this}static iter(e,t=0){return _0.from(e).goto(t)}static compare(e,t,i,s,r=-1){let o=e.filter(c=>c.maxPoint>0||!c.isEmpty&&c.maxPoint>=r),a=t.filter(c=>c.maxPoint>0||!c.isEmpty&&c.maxPoint>=r),l=rx(o,a,i),h=new Vl(o,l,r),u=new Vl(a,l,r);i.iterGaps((c,f,p)=>ox(h,c,u,f,p,s)),i.empty&&i.length==0&&ox(h,0,u,0,0,s)}static eq(e,t,i=0,s){s==null&&(s=999999999);let r=e.filter(u=>!u.isEmpty&&t.indexOf(u)<0),o=t.filter(u=>!u.isEmpty&&e.indexOf(u)<0);if(r.length!=o.length)return!1;if(!r.length)return!0;let a=rx(r,o),l=new Vl(r,a,0).goto(i),h=new Vl(o,a,0).goto(i);for(;;){if(l.to!=h.to||!k0(l.active,h.active)||l.point&&(!h.point||!l.point.eq(h.point)))return!1;if(l.to>s)return!0;l.next(),h.next()}}static spans(e,t,i,s,r=-1){let o=new Vl(e,null,r).goto(t),a=t,l=o.openStart;for(;;){let h=Math.min(o.to,i);if(o.point){let u=o.activeForPoint(o.to),c=o.pointFrom<t?u.length+1:o.point.startSide<0?u.length:Math.min(u.length,l);s.point(a,h,o.point,u,c,o.pointRank),l=Math.min(o.openEnd(h),u.length)}else h>a&&(s.span(a,h,o.active,l),l=o.openEnd(h));if(o.to>i)return l+(o.point&&o.to>i?1:0);a=o.to,o.next()}}static of(e,t=!1){let i=new w0;for(let s of e instanceof x0?[e]:t?j6(e):e)i.add(s.from,s.to,s.value);return i.finish()}static join(e){if(!e.length)return Zs.empty;let t=e[e.length-1];for(let i=e.length-2;i>=0;i--)for(let s=e[i];s!=Zs.empty;s=s.nextLayer)t=new Zs(s.chunkPos,s.chunk,t,Math.max(s.maxPoint,t.maxPoint));return t}};xi.empty=new xi([],[],null,-1);function j6(n){if(n.length>1)for(let e=n[0],t=1;t<n.length;t++){let i=n[t];if(T0(e,i)>0)return n.slice().sort(T0);e=i}return n}xi.empty.nextLayer=xi.empty;let w0=class LE{finishChunk(e){this.chunks.push(new z6(this.from,this.to,this.value,this.maxPoint)),this.chunkPos.push(this.chunkStart),this.chunkStart=-1,this.setMaxPoint=Math.max(this.setMaxPoint,this.maxPoint),this.maxPoint=-1,e&&(this.from=[],this.to=[],this.value=[])}constructor(){this.chunks=[],this.chunkPos=[],this.chunkStart=-1,this.last=null,this.lastFrom=-1e9,this.lastTo=-1e9,this.from=[],this.to=[],this.value=[],this.maxPoint=-1,this.setMaxPoint=-1,this.nextLayer=null}add(e,t,i){this.addInner(e,t,i)||(this.nextLayer||(this.nextLayer=new LE)).add(e,t,i)}addInner(e,t,i){let s=e-this.lastTo||i.startSide-this.last.endSide;if(s<=0&&(e-this.lastFrom||i.startSide-this.last.startSide)<0)throw new Error("Ranges must be added sorted by `from` position and `startSide`");return s<0?!1:(this.from.length==250&&this.finishChunk(!0),this.chunkStart<0&&(this.chunkStart=e),this.from.push(e-this.chunkStart),this.to.push(t-this.chunkStart),this.last=i,this.lastFrom=e,this.lastTo=t,this.value.push(i),i.point&&(this.maxPoint=Math.max(this.maxPoint,t-e)),!0)}addChunk(e,t){if((e-this.lastTo||t.value[0].startSide-this.last.endSide)<0)return!1;this.from.length&&this.finishChunk(!0),this.setMaxPoint=Math.max(this.setMaxPoint,t.maxPoint),this.chunks.push(t),this.chunkPos.push(e);let i=t.value.length-1;return this.last=t.value[i],this.lastFrom=t.from[i]+e,this.lastTo=t.to[i]+e,!0}finish(){return this.finishInner(xi.empty)}finishInner(e){if(this.from.length&&this.finishChunk(!1),this.chunks.length==0)return e;let t=xi.create(this.chunkPos,this.chunks,this.nextLayer?this.nextLayer.finishInner(e):e,this.setMaxPoint);return this.from=null,t}};function rx(n,e,t){let i=new Map;for(let r of n)for(let o=0;o<r.chunk.length;o++)r.chunk[o].maxPoint<=0&&i.set(r.chunk[o],r.chunkPos[o]);let s=new Set;for(let r of e)for(let o=0;o<r.chunk.length;o++){let a=i.get(r.chunk[o]);a!=null&&(t?t.mapPos(a):a)==r.chunkPos[o]&&!t?.touchesRange(a,a+r.chunk[o].length)&&s.add(r.chunk[o])}return s}let $E=class{constructor(e,t,i,s=0){this.layer=e,this.skip=t,this.minPoint=i,this.rank=s}get startSide(){return this.value?this.value.startSide:0}get endSide(){return this.value?this.value.endSide:0}goto(e,t=-1e9){return this.chunkIndex=this.rangeIndex=0,this.gotoInner(e,t,!1),this}gotoInner(e,t,i){for(;this.chunkIndex<this.layer.chunk.length;){let s=this.layer.chunk[this.chunkIndex];if(!(this.skip&&this.skip.has(s)||this.layer.chunkEnd(this.chunkIndex)<e||s.maxPoint<this.minPoint))break;this.chunkIndex++,i=!1}if(this.chunkIndex<this.layer.chunk.length){let s=this.layer.chunk[this.chunkIndex].findIndex(e-this.layer.chunkPos[this.chunkIndex],t,!0);(!i||this.rangeIndex<s)&&this.setRangeIndex(s)}this.next()}forward(e,t){(this.to-e||this.endSide-t)<0&&this.gotoInner(e,t,!0)}next(){for(;;)if(this.chunkIndex==this.layer.chunk.length){this.from=this.to=1e9,this.value=null;break}else{let e=this.layer.chunkPos[this.chunkIndex],t=this.layer.chunk[this.chunkIndex],i=e+t.from[this.rangeIndex];if(this.from=i,this.to=e+t.to[this.rangeIndex],this.value=t.value[this.rangeIndex],this.setRangeIndex(this.rangeIndex+1),this.minPoint<0||this.value.point&&this.to-this.from>=this.minPoint)break}}setRangeIndex(e){if(e==this.layer.chunk[this.chunkIndex].value.length){if(this.chunkIndex++,this.skip)for(;this.chunkIndex<this.layer.chunk.length&&this.skip.has(this.layer.chunk[this.chunkIndex]);)this.chunkIndex++;this.rangeIndex=0}else this.rangeIndex=e}nextChunk(){this.chunkIndex++,this.rangeIndex=0,this.next()}compare(e){return this.from-e.from||this.startSide-e.startSide||this.rank-e.rank||this.to-e.to||this.endSide-e.endSide}},_0=class QE{constructor(e){this.heap=e}static from(e,t=null,i=-1){let s=[];for(let r=0;r<e.length;r++)for(let o=e[r];!o.isEmpty;o=o.nextLayer)o.maxPoint>=i&&s.push(new $E(o,t,i,r));return s.length==1?s[0]:new QE(s)}get startSide(){return this.value?this.value.startSide:0}goto(e,t=-1e9){for(let i of this.heap)i.goto(e,t);for(let i=this.heap.length>>1;i>=0;i--)Mm(this.heap,i);return this.next(),this}forward(e,t){for(let i of this.heap)i.forward(e,t);for(let i=this.heap.length>>1;i>=0;i--)Mm(this.heap,i);(this.to-e||this.value.endSide-t)<0&&this.next()}next(){if(this.heap.length==0)this.from=this.to=1e9,this.value=null,this.rank=-1;else{let e=this.heap[0];this.from=e.from,this.to=e.to,this.value=e.value,this.rank=e.rank,e.value&&e.next(),Mm(this.heap,0)}}};function Mm(n,e){for(let t=n[e];;){let i=(e<<1)+1;if(i>=n.length)break;let s=n[i];if(i+1<n.length&&s.compare(n[i+1])>=0&&(s=n[i+1],i++),t.compare(s)<0)break;n[i]=t,n[e]=s,e=i}}let Vl=class{constructor(e,t,i){this.minPoint=i,this.active=[],this.activeTo=[],this.activeRank=[],this.minActive=-1,this.point=null,this.pointFrom=0,this.pointRank=0,this.to=-1e9,this.endSide=0,this.openStart=-1,this.cursor=_0.from(e,t,i)}goto(e,t=-1e9){return this.cursor.goto(e,t),this.active.length=this.activeTo.length=this.activeRank.length=0,this.minActive=-1,this.to=e,this.endSide=t,this.openStart=-1,this.next(),this}forward(e,t){for(;this.minActive>-1&&(this.activeTo[this.minActive]-e||this.active[this.minActive].endSide-t)<0;)this.removeActive(this.minActive);this.cursor.forward(e,t)}removeActive(e){bc(this.active,e),bc(this.activeTo,e),bc(this.activeRank,e),this.minActive=ax(this.active,this.activeTo)}addActive(e){let t=0,{value:i,to:s,rank:r}=this.cursor;for(;t<this.activeRank.length&&(r-this.activeRank[t]||s-this.activeTo[t])>0;)t++;vc(this.active,t,i),vc(this.activeTo,t,s),vc(this.activeRank,t,r),e&&vc(e,t,this.cursor.from),this.minActive=ax(this.active,this.activeTo)}next(){let e=this.to,t=this.point;this.point=null;let i=this.openStart<0?[]:null;for(;;){let s=this.minActive;if(s>-1&&(this.activeTo[s]-this.cursor.from||this.active[s].endSide-this.cursor.startSide)<0){if(this.activeTo[s]>e){this.to=this.activeTo[s],this.endSide=this.active[s].endSide;break}this.removeActive(s),i&&bc(i,s)}else if(this.cursor.value)if(this.cursor.from>e){this.to=this.cursor.from,this.endSide=this.cursor.startSide;break}else{let r=this.cursor.value;if(!r.point)this.addActive(i),this.cursor.next();else if(t&&this.cursor.to==this.to&&this.cursor.from<this.cursor.to)this.cursor.next();else{this.point=r,this.pointFrom=this.cursor.from,this.pointRank=this.cursor.rank,this.to=this.cursor.to,this.endSide=r.endSide,this.cursor.next(),this.forward(this.to,this.endSide);break}}else{this.to=this.endSide=1e9;break}}if(i){this.openStart=0;for(let s=i.length-1;s>=0&&i[s]<e;s--)this.openStart++}}activeForPoint(e){if(!this.active.length)return this.active;let t=[];for(let i=this.active.length-1;i>=0&&!(this.activeRank[i]<this.pointRank);i--)(this.activeTo[i]>e||this.activeTo[i]==e&&this.active[i].endSide>=this.point.endSide)&&t.push(this.active[i]);return t.reverse()}openEnd(e){let t=0;for(let i=this.activeTo.length-1;i>=0&&this.activeTo[i]>e;i--)t++;return t}};function ox(n,e,t,i,s,r){n.goto(e),t.goto(i);let o=i+s,a=i,l=i-e;for(;;){let h=n.to+l-t.to,u=h||n.endSide-t.endSide,c=u<0?n.to+l:t.to,f=Math.min(c,o);if(n.point||t.point?n.point&&t.point&&(n.point==t.point||n.point.eq(t.point))&&k0(n.activeForPoint(n.to),t.activeForPoint(t.to))||r.comparePoint(a,f,n.point,t.point):f>a&&!k0(n.active,t.active)&&r.compareRange(a,f,n.active,t.active),c>o)break;(h||n.openEnd!=t.openEnd)&&r.boundChange&&r.boundChange(c),a=c,u<=0&&n.next(),u>=0&&t.next()}}function k0(n,e){if(n.length!=e.length)return!1;for(let t=0;t<n.length;t++)if(n[t]!=e[t]&&!n[t].eq(e[t]))return!1;return!0}function bc(n,e){for(let t=e,i=n.length-1;t<i;t++)n[t]=n[t+1];n.pop()}function vc(n,e,t){for(let i=n.length-1;i>=e;i--)n[i+1]=n[i];n[e]=t}function ax(n,e){let t=-1,i=1e9;for(let s=0;s<e.length;s++)(e[s]-i||n[s].endSide-n[t].endSide)<0&&(t=s,i=e[s]);return t}function Xh(n,e,t=n.length){let i=0;for(let s=0;s<t&&s<n.length;)n.charCodeAt(s)==9?(i+=e-i%e,s++):(i++,s=bs(n,s));return i}function X6(n,e,t,i){for(let s=0,r=0;;){if(r>=e)return s;if(s==n.length)break;r+=n.charCodeAt(s)==9?t-r%t:1,s=bs(n,s)}return n.length}const C0="ͼ",lx=typeof Symbol>"u"?"__"+C0:Symbol.for(C0),E0=typeof Symbol>"u"?"__styleSet"+Math.floor(Math.random()*1e8):Symbol("styleSet"),hx=typeof globalThis<"u"?globalThis:typeof window<"u"?window:{};class Ti{constructor(e,t){this.rules=[];let{finish:i}=t||{};function s(o){return/^@/.test(o)?[o]:o.split(/,\s*/)}function r(o,a,l,h){let u=[],c=/^@(\w+)\b/.exec(o[0]),f=c&&c[1]=="keyframes";if(c&&a==null)return l.push(o[0]+";");for(let p in a){let b=a[p];if(/&/.test(p))r(p.split(/,\s*/).map(y=>o.map(_=>y.replace(/&/,_))).reduce((y,_)=>y.concat(_)),b,l);else if(b&&typeof b=="object"){if(!c)throw new RangeError("The value of a property ("+p+") should be a primitive value.");r(s(p),b,u,f)}else b!=null&&u.push(p.replace(/_.*/,"").replace(/[A-Z]/g,y=>"-"+y.toLowerCase())+": "+b+";")}(u.length||f)&&l.push((i&&!c&&!h?o.map(i):o).join(", ")+" {"+u.join(" ")+"}")}for(let o in e)r(s(o),e[o],this.rules)}getRules(){return this.rules.join(`
`)}static newName(){let e=hx[lx]||1;return hx[lx]=e+1,C0+e.toString(36)}static mount(e,t,i){let s=e[E0],r=i&&i.nonce;s?r&&s.setNonce(r):s=new H6(e,r),s.mount(Array.isArray(t)?t:[t],e)}}let ux=new Map;class H6{constructor(e,t){let i=e.ownerDocument||e,s=i.defaultView;if(!e.head&&e.adoptedStyleSheets&&s.CSSStyleSheet){let r=ux.get(i);if(r)return e[E0]=r;this.sheet=new s.CSSStyleSheet,ux.set(i,this)}else this.styleTag=i.createElement("style"),t&&this.styleTag.setAttribute("nonce",t);this.modules=[],e[E0]=this}mount(e,t){let i=this.sheet,s=0,r=0;for(let o=0;o<e.length;o++){let a=e[o],l=this.modules.indexOf(a);if(l<r&&l>-1&&(this.modules.splice(l,1),r--,l=-1),l==-1){if(this.modules.splice(r++,0,a),i)for(let h=0;h<a.rules.length;h++)i.insertRule(a.rules[h],s++)}else{for(;r<l;)s+=this.modules[r++].rules.length;s+=a.rules.length,r++}}if(i)t.adoptedStyleSheets.indexOf(this.sheet)<0&&(t.adoptedStyleSheets=[this.sheet,...t.adoptedStyleSheets]);else{let o="";for(let l=0;l<this.modules.length;l++)o+=this.modules[l].getRules()+`
`;this.styleTag.textContent=o;let a=t.head||t;this.styleTag.parentNode!=a&&a.insertBefore(this.styleTag,a.firstChild)}}setNonce(e){this.styleTag&&this.styleTag.getAttribute("nonce")!=e&&this.styleTag.setAttribute("nonce",e)}}var rr={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},Hh={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},W6=typeof navigator<"u"&&/Mac/.test(navigator.platform),Z6=typeof navigator<"u"&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent);for(var oi=0;oi<10;oi++)rr[48+oi]=rr[96+oi]=String(oi);for(var oi=1;oi<=24;oi++)rr[oi+111]="F"+oi;for(var oi=65;oi<=90;oi++)rr[oi]=String.fromCharCode(oi+32),Hh[oi]=String.fromCharCode(oi);for(var Im in rr)Hh.hasOwnProperty(Im)||(Hh[Im]=rr[Im]);function BE(n){var e=W6&&n.metaKey&&n.shiftKey&&!n.ctrlKey&&!n.altKey||Z6&&n.shiftKey&&n.key&&n.key.length==1||n.key=="Unidentified",t=!e&&n.key||(n.shiftKey?Hh:rr)[n.keyCode]||n.key||"Unidentified";return t=="Esc"&&(t="Escape"),t=="Del"&&(t="Delete"),t=="Left"&&(t="ArrowLeft"),t=="Up"&&(t="ArrowUp"),t=="Right"&&(t="ArrowRight"),t=="Down"&&(t="ArrowDown"),t}function xt(){var n=arguments[0];typeof n=="string"&&(n=document.createElement(n));var e=1,t=arguments[1];if(t&&typeof t=="object"&&t.nodeType==null&&!Array.isArray(t)){for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)){var s=t[i];typeof s=="string"?n.setAttribute(i,s):s!=null&&(n[i]=s)}e++}for(;e<arguments.length;e++)NE(n,arguments[e]);return n}function NE(n,e){if(typeof e=="string")n.appendChild(document.createTextNode(e));else if(e!=null)if(e.nodeType!=null)n.appendChild(e);else if(Array.isArray(e))for(var t=0;t<e.length;t++)NE(n,e[t]);else throw new RangeError("Unsupported child node: "+e)}let Pi=typeof navigator<"u"?navigator:{userAgent:"",vendor:"",platform:""},A0=typeof document<"u"?document:{documentElement:{style:{}}};const P0=/Edge\/(\d+)/.exec(Pi.userAgent),FE=/MSIE \d/.test(Pi.userAgent),D0=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(Pi.userAgent),op=!!(FE||D0||P0),cx=!op&&/gecko\/(\d+)/i.test(Pi.userAgent),Rm=!op&&/Chrome\/(\d+)/.exec(Pi.userAgent),Y6="webkitFontSmoothing"in A0.documentElement.style,M0=!op&&/Apple Computer/.test(Pi.vendor),dx=M0&&(/Mobile\/\w+/.test(Pi.userAgent)||Pi.maxTouchPoints>2);var be={mac:dx||/Mac/.test(Pi.platform),windows:/Win/.test(Pi.platform),linux:/Linux|X11/.test(Pi.platform),ie:op,ie_version:FE?A0.documentMode||6:D0?+D0[1]:P0?+P0[1]:0,gecko:cx,gecko_version:cx?+(/Firefox\/(\d+)/.exec(Pi.userAgent)||[0,0])[1]:0,chrome:!!Rm,chrome_version:Rm?+Rm[1]:0,ios:dx,android:/Android\b/.test(Pi.userAgent),webkit_version:Y6?+(/\bAppleWebKit\/(\d+)/.exec(Pi.userAgent)||[0,0])[1]:0,safari:M0,safari_version:M0?+(/\bVersion\/(\d+(\.\d+)?)/.exec(Pi.userAgent)||[0,0])[1]:0,tabSize:A0.documentElement.style.tabSize!=null?"tab-size":"-moz-tab-size"};function Wh(n){let e;return n.nodeType==11?e=n.getSelection?n:n.ownerDocument:e=n,e.getSelection()}function I0(n,e){return e?n==e||n.contains(e.nodeType!=1?e.parentNode:e):!1}function nd(n,e){if(!e.anchorNode)return!1;try{return I0(n,e.anchorNode)}catch{return!1}}function Zh(n){return n.nodeType==3?Ro(n,0,n.nodeValue.length).getClientRects():n.nodeType==1?n.getClientRects():[]}function kh(n,e,t,i){return t?fx(n,e,t,i,-1)||fx(n,e,t,i,1):!1}function Io(n){for(var e=0;;e++)if(n=n.previousSibling,!n)return e}function Yd(n){return n.nodeType==1&&/^(DIV|P|LI|UL|OL|BLOCKQUOTE|DD|DT|H\d|SECTION|PRE)$/.test(n.nodeName)}function fx(n,e,t,i,s){for(;;){if(n==t&&e==i)return!0;if(e==(s<0?0:Ms(n))){if(n.nodeName=="DIV")return!1;let r=n.parentNode;if(!r||r.nodeType!=1)return!1;e=Io(n)+(s<0?0:1),n=r}else if(n.nodeType==1){if(n=n.childNodes[e+(s<0?-1:0)],n.nodeType==1&&n.contentEditable=="false")return!1;e=s<0?Ms(n):0}else return!1}}function Ms(n){return n.nodeType==3?n.nodeValue.length:n.childNodes.length}function ap(n,e){let t=e?n.left:n.right;return{left:t,right:t,top:n.top,bottom:n.bottom}}function G6(n){let e=n.visualViewport;return e?{left:0,right:e.width,top:0,bottom:e.height}:{left:0,right:n.innerWidth,top:0,bottom:n.innerHeight}}function VE(n,e){let t=e.width/n.offsetWidth,i=e.height/n.offsetHeight;return(t>.995&&t<1.005||!isFinite(t)||Math.abs(e.width-n.offsetWidth)<1)&&(t=1),(i>.995&&i<1.005||!isFinite(i)||Math.abs(e.height-n.offsetHeight)<1)&&(i=1),{scaleX:t,scaleY:i}}function K6(n,e,t,i,s,r,o,a){let l=n.ownerDocument,h=l.defaultView||window;for(let u=n,c=!1;u&&!c;)if(u.nodeType==1){let f,p=u==l.body,b=1,y=1;if(p)f=G6(h);else{if(/^(fixed|sticky)$/.test(getComputedStyle(u).position)&&(c=!0),u.scrollHeight<=u.clientHeight&&u.scrollWidth<=u.clientWidth){u=u.assignedSlot||u.parentNode;continue}let w=u.getBoundingClientRect();({scaleX:b,scaleY:y}=VE(u,w)),f={left:w.left,right:w.left+u.clientWidth*b,top:w.top,bottom:w.top+u.clientHeight*y}}let _=0,T=0;if(s=="nearest")e.top<f.top?(T=e.top-(f.top+o),t>0&&e.bottom>f.bottom+T&&(T=e.bottom-f.bottom+o)):e.bottom>f.bottom&&(T=e.bottom-f.bottom+o,t<0&&e.top-T<f.top&&(T=e.top-(f.top+o)));else{let w=e.bottom-e.top,v=f.bottom-f.top;T=(s=="center"&&w<=v?e.top+w/2-v/2:s=="start"||s=="center"&&t<0?e.top-o:e.bottom-v+o)-f.top}if(i=="nearest"?e.left<f.left?(_=e.left-(f.left+r),t>0&&e.right>f.right+_&&(_=e.right-f.right+r)):e.right>f.right&&(_=e.right-f.right+r,t<0&&e.left<f.left+_&&(_=e.left-(f.left+r))):_=(i=="center"?e.left+(e.right-e.left)/2-(f.right-f.left)/2:i=="start"==a?e.left-r:e.right-(f.right-f.left)+r)-f.left,_||T)if(p)h.scrollBy(_,T);else{let w=0,v=0;if(T){let S=u.scrollTop;u.scrollTop+=T/y,v=(u.scrollTop-S)*y}if(_){let S=u.scrollLeft;u.scrollLeft+=_/b,w=(u.scrollLeft-S)*b}e={left:e.left-w,top:e.top-v,right:e.right-w,bottom:e.bottom-v},w&&Math.abs(w-_)<1&&(i="nearest"),v&&Math.abs(v-T)<1&&(s="nearest")}if(p)break;(e.top<f.top||e.bottom>f.bottom||e.left<f.left||e.right>f.right)&&(e={left:Math.max(e.left,f.left),right:Math.min(e.right,f.right),top:Math.max(e.top,f.top),bottom:Math.min(e.bottom,f.bottom)}),u=u.assignedSlot||u.parentNode}else if(u.nodeType==11)u=u.host;else break}function J6(n){let e=n.ownerDocument,t,i;for(let s=n.parentNode;s&&!(s==e.body||t&&i);)if(s.nodeType==1)!i&&s.scrollHeight>s.clientHeight&&(i=s),!t&&s.scrollWidth>s.clientWidth&&(t=s),s=s.assignedSlot||s.parentNode;else if(s.nodeType==11)s=s.host;else break;return{x:t,y:i}}let e7=class{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}eq(e){return this.anchorNode==e.anchorNode&&this.anchorOffset==e.anchorOffset&&this.focusNode==e.focusNode&&this.focusOffset==e.focusOffset}setRange(e){let{anchorNode:t,focusNode:i}=e;this.set(t,Math.min(e.anchorOffset,t?Ms(t):0),i,Math.min(e.focusOffset,i?Ms(i):0))}set(e,t,i,s){this.anchorNode=e,this.anchorOffset=t,this.focusNode=i,this.focusOffset=s}},lo=null;be.safari&&be.safari_version>=26&&(lo=!1);function UE(n){if(n.setActive)return n.setActive();if(lo)return n.focus(lo);let e=[];for(let t=n;t&&(e.push(t,t.scrollTop,t.scrollLeft),t!=t.ownerDocument);t=t.parentNode);if(n.focus(lo==null?{get preventScroll(){return lo={preventScroll:!0},!0}}:void 0),!lo){lo=!1;for(let t=0;t<e.length;){let i=e[t++],s=e[t++],r=e[t++];i.scrollTop!=s&&(i.scrollTop=s),i.scrollLeft!=r&&(i.scrollLeft=r)}}}let px;function Ro(n,e,t=e){let i=px||(px=document.createRange());return i.setEnd(n,t),i.setStart(n,e),i}function Ca(n,e,t,i){let s={key:e,code:e,keyCode:t,which:t,cancelable:!0};i&&({altKey:s.altKey,ctrlKey:s.ctrlKey,shiftKey:s.shiftKey,metaKey:s.metaKey}=i);let r=new KeyboardEvent("keydown",s);r.synthetic=!0,n.dispatchEvent(r);let o=new KeyboardEvent("keyup",s);return o.synthetic=!0,n.dispatchEvent(o),r.defaultPrevented||o.defaultPrevented}function t7(n){for(;n;){if(n&&(n.nodeType==9||n.nodeType==11&&n.host))return n;n=n.assignedSlot||n.parentNode}return null}function qE(n){for(;n.attributes.length;)n.removeAttributeNode(n.attributes[0])}function i7(n,e){let t=e.focusNode,i=e.focusOffset;if(!t||e.anchorNode!=t||e.anchorOffset!=i)return!1;for(i=Math.min(i,Ms(t));;)if(i){if(t.nodeType!=1)return!1;let s=t.childNodes[i-1];s.contentEditable=="false"?i--:(t=s,i=Ms(t))}else{if(t==n)return!0;i=Io(t),t=t.parentNode}}function zE(n){return n.scrollTop>Math.max(1,n.scrollHeight-n.clientHeight-4)}function jE(n,e){for(let t=n,i=e;;){if(t.nodeType==3&&i>0)return{node:t,offset:i};if(t.nodeType==1&&i>0){if(t.contentEditable=="false")return null;t=t.childNodes[i-1],i=Ms(t)}else if(t.parentNode&&!Yd(t))i=Io(t),t=t.parentNode;else return null}}function XE(n,e){for(let t=n,i=e;;){if(t.nodeType==3&&i<t.nodeValue.length)return{node:t,offset:i};if(t.nodeType==1&&i<t.childNodes.length){if(t.contentEditable=="false")return null;t=t.childNodes[i],i=0}else if(t.parentNode&&!Yd(t))i=Io(t)+1,t=t.parentNode;else return null}}let rn=class R0{constructor(e,t,i=!0){this.node=e,this.offset=t,this.precise=i}static before(e,t){return new R0(e.parentNode,Io(e),t)}static after(e,t){return new R0(e.parentNode,Io(e)+1,t)}};const db=[];let bt=class L0{constructor(){this.parent=null,this.dom=null,this.flags=2}get overrideDOMText(){return null}get posAtStart(){return this.parent?this.parent.posBefore(this):0}get posAtEnd(){return this.posAtStart+this.length}posBefore(e){let t=this.posAtStart;for(let i of this.children){if(i==e)return t;t+=i.length+i.breakAfter}throw new RangeError("Invalid child in posBefore")}posAfter(e){return this.posBefore(e)+e.length}sync(e,t){if(this.flags&2){let i=this.dom,s=null,r;for(let o of this.children){if(o.flags&7){if(!o.dom&&(r=s?s.nextSibling:i.firstChild)){let a=L0.get(r);(!a||!a.parent&&a.canReuseDOM(o))&&o.reuseDOM(r)}o.sync(e,t),o.flags&=-8}if(r=s?s.nextSibling:i.firstChild,t&&!t.written&&t.node==i&&r!=o.dom&&(t.written=!0),o.dom.parentNode==i)for(;r&&r!=o.dom;)r=mx(r);else i.insertBefore(o.dom,r);s=o.dom}for(r=s?s.nextSibling:i.firstChild,r&&t&&t.node==i&&(t.written=!0);r;)r=mx(r)}else if(this.flags&1)for(let i of this.children)i.flags&7&&(i.sync(e,t),i.flags&=-8)}reuseDOM(e){}localPosFromDOM(e,t){let i;if(e==this.dom)i=this.dom.childNodes[t];else{let s=Ms(e)==0?0:t==0?-1:1;for(;;){let r=e.parentNode;if(r==this.dom)break;s==0&&r.firstChild!=r.lastChild&&(e==r.firstChild?s=-1:s=1),e=r}s<0?i=e:i=e.nextSibling}if(i==this.dom.firstChild)return 0;for(;i&&!L0.get(i);)i=i.nextSibling;if(!i)return this.length;for(let s=0,r=0;;s++){let o=this.children[s];if(o.dom==i)return r;r+=o.length+o.breakAfter}}domBoundsAround(e,t,i=0){let s=-1,r=-1,o=-1,a=-1;for(let l=0,h=i,u=i;l<this.children.length;l++){let c=this.children[l],f=h+c.length;if(h<e&&f>t)return c.domBoundsAround(e,t,h);if(f>=e&&s==-1&&(s=l,r=h),h>t&&c.dom.parentNode==this.dom){o=l,a=u;break}u=f,h=f+c.breakAfter}return{from:r,to:a<0?i+this.length:a,startDOM:(s?this.children[s-1].dom.nextSibling:null)||this.dom.firstChild,endDOM:o<this.children.length&&o>=0?this.children[o].dom:null}}markDirty(e=!1){this.flags|=2,this.markParentsDirty(e)}markParentsDirty(e){for(let t=this.parent;t;t=t.parent){if(e&&(t.flags|=2),t.flags&1)return;t.flags|=1,e=!1}}setParent(e){this.parent!=e&&(this.parent=e,this.flags&7&&this.markParentsDirty(!0))}setDOM(e){this.dom!=e&&(this.dom&&(this.dom.cmView=null),this.dom=e,e.cmView=this)}get rootView(){for(let e=this;;){let t=e.parent;if(!t)return e;e=t}}replaceChildren(e,t,i=db){this.markDirty();for(let s=e;s<t;s++){let r=this.children[s];r.parent==this&&i.indexOf(r)<0&&r.destroy()}i.length<250?this.children.splice(e,t-e,...i):this.children=[].concat(this.children.slice(0,e),i,this.children.slice(t));for(let s=0;s<i.length;s++)i[s].setParent(this)}ignoreMutation(e){return!1}ignoreEvent(e){return!1}childCursor(e=this.length){return new HE(this.children,e,this.children.length)}childPos(e,t=1){return this.childCursor().findPos(e,t)}toString(){let e=this.constructor.name.replace("View","");return e+(this.children.length?"("+this.children.join()+")":this.length?"["+(e=="Text"?this.text:this.length)+"]":"")+(this.breakAfter?"#":"")}static get(e){return e.cmView}get isEditable(){return!0}get isWidget(){return!1}get isHidden(){return!1}merge(e,t,i,s,r,o){return!1}become(e){return!1}canReuseDOM(e){return e.constructor==this.constructor&&!((this.flags|e.flags)&8)}getSide(){return 0}destroy(){for(let e of this.children)e.parent==this&&e.destroy();this.parent=null}};bt.prototype.breakAfter=0;function mx(n){let e=n.nextSibling;return n.parentNode.removeChild(n),e}let HE=class{constructor(e,t,i){this.children=e,this.pos=t,this.i=i,this.off=0}findPos(e,t=1){for(;;){if(e>this.pos||e==this.pos&&(t>0||this.i==0||this.children[this.i-1].breakAfter))return this.off=e-this.pos,this;let i=this.children[--this.i];this.pos-=i.length+i.breakAfter}}};function WE(n,e,t,i,s,r,o,a,l){let{children:h}=n,u=h.length?h[e]:null,c=r.length?r[r.length-1]:null,f=c?c.breakAfter:o;if(!(e==i&&u&&!o&&!f&&r.length<2&&u.merge(t,s,r.length?c:null,t==0,a,l))){if(i<h.length){let p=h[i];p&&(s<p.length||p.breakAfter&&c?.breakAfter)?(e==i&&(p=p.split(s),s=0),!f&&c&&p.merge(0,s,c,!0,0,l)?r[r.length-1]=p:((s||p.children.length&&!p.children[0].length)&&p.merge(0,s,null,!1,0,l),r.push(p))):p?.breakAfter&&(c?c.breakAfter=1:o=1),i++}for(u&&(u.breakAfter=o,t>0&&(!o&&r.length&&u.merge(t,u.length,r[0],!1,a,0)?u.breakAfter=r.shift().breakAfter:(t<u.length||u.children.length&&u.children[u.children.length-1].length==0)&&u.merge(t,u.length,null,!1,a,0),e++));e<i&&r.length;)if(h[i-1].become(r[r.length-1]))i--,r.pop(),l=r.length?0:a;else if(h[e].become(r[0]))e++,r.shift(),a=r.length?0:l;else break;!r.length&&e&&i<h.length&&!h[e-1].breakAfter&&h[i].merge(0,0,h[e-1],!1,a,l)&&e--,(e<i||r.length)&&n.replaceChildren(e,i,r)}}function ZE(n,e,t,i,s,r){let o=n.childCursor(),{i:a,off:l}=o.findPos(t,1),{i:h,off:u}=o.findPos(e,-1),c=e-t;for(let f of i)c+=f.length;n.length+=c,WE(n,h,u,a,l,i,0,s,r)}const n7=256;let qr=class $0 extends bt{constructor(e){super(),this.text=e}get length(){return this.text.length}createDOM(e){this.setDOM(e||document.createTextNode(this.text))}sync(e,t){this.dom||this.createDOM(),this.dom.nodeValue!=this.text&&(t&&t.node==this.dom&&(t.written=!0),this.dom.nodeValue=this.text)}reuseDOM(e){e.nodeType==3&&this.createDOM(e)}merge(e,t,i){return this.flags&8||i&&(!(i instanceof $0)||this.length-(t-e)+i.length>n7||i.flags&8)?!1:(this.text=this.text.slice(0,e)+(i?i.text:"")+this.text.slice(t),this.markDirty(),!0)}split(e){let t=new $0(this.text.slice(e));return this.text=this.text.slice(0,e),this.markDirty(),t.flags|=this.flags&8,t}localPosFromDOM(e,t){return e==this.dom?t:t?this.text.length:0}domAtPos(e){return new rn(this.dom,e)}domBoundsAround(e,t,i){return{from:i,to:i+this.length,startDOM:this.dom,endDOM:this.dom.nextSibling}}coordsAt(e,t){return s7(this.dom,e,t)}},za=class Q0 extends bt{constructor(e,t=[],i=0){super(),this.mark=e,this.children=t,this.length=i;for(let s of t)s.setParent(this)}setAttrs(e){if(qE(e),this.mark.class&&(e.className=this.mark.class),this.mark.attrs)for(let t in this.mark.attrs)e.setAttribute(t,this.mark.attrs[t]);return e}canReuseDOM(e){return super.canReuseDOM(e)&&!((this.flags|e.flags)&8)}reuseDOM(e){e.nodeName==this.mark.tagName.toUpperCase()&&(this.setDOM(e),this.flags|=6)}sync(e,t){this.dom?this.flags&4&&this.setAttrs(this.dom):this.setDOM(this.setAttrs(document.createElement(this.mark.tagName))),super.sync(e,t)}merge(e,t,i,s,r,o){return i&&(!(i instanceof Q0&&i.mark.eq(this.mark))||e&&r<=0||t<this.length&&o<=0)?!1:(ZE(this,e,t,i?i.children.slice():[],r-1,o-1),this.markDirty(),!0)}split(e){let t=[],i=0,s=-1,r=0;for(let a of this.children){let l=i+a.length;l>e&&t.push(i<e?a.split(e-i):a),s<0&&i>=e&&(s=r),i=l,r++}let o=this.length-e;return this.length=e,s>-1&&(this.children.length=s,this.markDirty()),new Q0(this.mark,t,o)}domAtPos(e){return GE(this,e)}coordsAt(e,t){return JE(this,e,t)}};function s7(n,e,t){let i=n.nodeValue.length;e>i&&(e=i);let s=e,r=e,o=0;e==0&&t<0||e==i&&t>=0?be.chrome||be.gecko||(e?(s--,o=1):r<i&&(r++,o=-1)):t<0?s--:r<i&&r++;let a=Ro(n,s,r).getClientRects();if(!a.length)return null;let l=a[(o?o<0:t>=0)?0:a.length-1];return be.safari&&!o&&l.width==0&&(l=Array.prototype.find.call(a,h=>h.width)||l),o?ap(l,o<0):l||null}let YE=class ih extends bt{static create(e,t,i){return new ih(e,t,i)}constructor(e,t,i){super(),this.widget=e,this.length=t,this.side=i,this.prevWidget=null}split(e){let t=ih.create(this.widget,this.length-e,this.side);return this.length-=e,t}sync(e){(!this.dom||!this.widget.updateDOM(this.dom,e))&&(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(e)),this.widget.editable||(this.dom.contentEditable="false"))}getSide(){return this.side}merge(e,t,i,s,r,o){return i&&(!(i instanceof ih)||!this.widget.compare(i.widget)||e>0&&r<=0||t<this.length&&o<=0)?!1:(this.length=e+(i?i.length:0)+(this.length-t),!0)}become(e){return e instanceof ih&&e.side==this.side&&this.widget.constructor==e.widget.constructor?(this.widget.compare(e.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=e.widget,this.length=e.length,!0):!1}ignoreMutation(){return!0}ignoreEvent(e){return this.widget.ignoreEvent(e)}get overrideDOMText(){if(this.length==0)return Ke.empty;let e=this;for(;e.parent;)e=e.parent;let{view:t}=e,i=t&&t.state.doc,s=this.posAtStart;return i?i.slice(s,s+this.length):Ke.empty}domAtPos(e){return(this.length?e==0:this.side>0)?rn.before(this.dom):rn.after(this.dom,e==this.length)}domBoundsAround(){return null}coordsAt(e,t){let i=this.widget.coordsAt(this.dom,e,t);if(i)return i;let s=this.dom.getClientRects(),r=null;if(!s.length)return null;let o=this.side?this.side<0:e>0;for(let a=o?s.length-1:0;r=s[a],!(e>0?a==0:a==s.length-1||r.top<r.bottom);a+=o?-1:1);return ap(r,!o)}get isEditable(){return!1}get isWidget(){return!0}get isHidden(){return this.widget.isHidden}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}},B0=class N0 extends bt{constructor(e){super(),this.side=e}get length(){return 0}merge(){return!1}become(e){return e instanceof N0&&e.side==this.side}split(){return new N0(this.side)}sync(){if(!this.dom){let e=document.createElement("img");e.className="cm-widgetBuffer",e.setAttribute("aria-hidden","true"),this.setDOM(e)}}getSide(){return this.side}domAtPos(e){return this.side>0?rn.before(this.dom):rn.after(this.dom)}localPosFromDOM(){return 0}domBoundsAround(){return null}coordsAt(e){return this.dom.getBoundingClientRect()}get overrideDOMText(){return Ke.empty}get isHidden(){return!0}};qr.prototype.children=YE.prototype.children=B0.prototype.children=db;function GE(n,e){let t=n.dom,{children:i}=n,s=0;for(let r=0;s<i.length;s++){let o=i[s],a=r+o.length;if(!(a==r&&o.getSide()<=0)){if(e>r&&e<a&&o.dom.parentNode==t)return o.domAtPos(e-r);if(e<=r)break;r=a}}for(let r=s;r>0;r--){let o=i[r-1];if(o.dom.parentNode==t)return o.domAtPos(o.length)}for(let r=s;r<i.length;r++){let o=i[r];if(o.dom.parentNode==t)return o.domAtPos(0)}return new rn(t,0)}function KE(n,e,t){let i,{children:s}=n;t>0&&e instanceof za&&s.length&&(i=s[s.length-1])instanceof za&&i.mark.eq(e.mark)?KE(i,e.children[0],t-1):(s.push(e),e.setParent(n)),n.length+=e.length}function JE(n,e,t){let i=null,s=-1,r=null,o=-1;function a(h,u){for(let c=0,f=0;c<h.children.length&&f<=u;c++){let p=h.children[c],b=f+p.length;b>=u&&(p.children.length?a(p,u-f):(!r||r.isHidden&&(t>0||o7(r,p)))&&(b>u||f==b&&p.getSide()>0)?(r=p,o=u-f):(f<u||f==b&&p.getSide()<0&&!p.isHidden)&&(i=p,s=u-f)),f=b}}a(n,e);let l=(t<0?i:r)||i||r;return l?l.coordsAt(Math.max(0,l==i?s:o),t):r7(n)}function r7(n){let e=n.dom.lastChild;if(!e)return n.dom.getBoundingClientRect();let t=Zh(e);return t[t.length-1]||null}function o7(n,e){let t=n.coordsAt(0,1),i=e.coordsAt(0,1);return t&&i&&i.top<t.bottom}function F0(n,e){for(let t in n)t=="class"&&e.class?e.class+=" "+n.class:t=="style"&&e.style?e.style+=";"+n.style:e[t]=n[t];return e}const gx=Object.create(null);function Gd(n,e,t){if(n==e)return!0;n||(n=gx),e||(e=gx);let i=Object.keys(n),s=Object.keys(e);if(i.length-(t&&i.indexOf(t)>-1?1:0)!=s.length-(t&&s.indexOf(t)>-1?1:0))return!1;for(let r of i)if(r!=t&&(s.indexOf(r)==-1||n[r]!==e[r]))return!1;return!0}function V0(n,e,t){let i=!1;if(e)for(let s in e)t&&s in t||(i=!0,s=="style"?n.style.cssText="":n.removeAttribute(s));if(t)for(let s in t)e&&e[s]==t[s]||(i=!0,s=="style"?n.style.cssText=t[s]:n.setAttribute(s,t[s]));return i}function a7(n){let e=Object.create(null);for(let t=0;t<n.attributes.length;t++){let i=n.attributes[t];e[i.name]=i.value}return e}let lp=class{eq(e){return!1}updateDOM(e,t){return!1}compare(e){return this==e||this.constructor==e.constructor&&this.eq(e)}get estimatedHeight(){return-1}get lineBreaks(){return 0}ignoreEvent(e){return!0}coordsAt(e,t,i){return null}get isHidden(){return!1}get editable(){return!1}destroy(e){}};var _s=(function(n){return n[n.Text=0]="Text",n[n.WidgetBefore=1]="WidgetBefore",n[n.WidgetAfter=2]="WidgetAfter",n[n.WidgetRange=3]="WidgetRange",n})(_s||(_s={}));let Ft=class extends Mo{constructor(e,t,i,s){super(),this.startSide=e,this.endSide=t,this.widget=i,this.spec=s}get heightRelevant(){return!1}static mark(e){return new fb(e)}static widget(e){let t=Math.max(-1e4,Math.min(1e4,e.side||0)),i=!!e.block;return t+=i&&!e.inlineOrder?t>0?3e8:-4e8:t>0?1e8:-1e8,new ja(e,t,t,i,e.widget||null,!1)}static replace(e){let t=!!e.block,i,s;if(e.isBlockGap)i=-5e8,s=4e8;else{let{start:r,end:o}=nA(e,t);i=(r?t?-3e8:-1:5e8)-1,s=(o?t?2e8:1:-6e8)+1}return new ja(e,i,s,t,e.widget||null,!0)}static line(e){return new pb(e)}static set(e,t=!1){return xi.of(e,t)}hasHeight(){return this.widget?this.widget.estimatedHeight>-1:!1}};Ft.none=xi.empty;let fb=class eA extends Ft{constructor(e){let{start:t,end:i}=nA(e);super(t?-1:5e8,i?1:-6e8,null,e),this.tagName=e.tagName||"span",this.class=e.class||"",this.attrs=e.attributes||null}eq(e){var t,i;return this==e||e instanceof eA&&this.tagName==e.tagName&&(this.class||((t=this.attrs)===null||t===void 0?void 0:t.class))==(e.class||((i=e.attrs)===null||i===void 0?void 0:i.class))&&Gd(this.attrs,e.attrs,"class")}range(e,t=e){if(e>=t)throw new RangeError("Mark decorations may not be empty");return super.range(e,t)}};fb.prototype.point=!1;let pb=class tA extends Ft{constructor(e){super(-2e8,-2e8,null,e)}eq(e){return e instanceof tA&&this.spec.class==e.spec.class&&Gd(this.spec.attributes,e.spec.attributes)}range(e,t=e){if(t!=e)throw new RangeError("Line decoration ranges must be zero-length");return super.range(e,t)}};pb.prototype.mapMode=Ri.TrackBefore;pb.prototype.point=!0;let ja=class iA extends Ft{constructor(e,t,i,s,r,o){super(t,i,r,e),this.block=s,this.isReplace=o,this.mapMode=s?t<=0?Ri.TrackBefore:Ri.TrackAfter:Ri.TrackDel}get type(){return this.startSide!=this.endSide?_s.WidgetRange:this.startSide<=0?_s.WidgetBefore:_s.WidgetAfter}get heightRelevant(){return this.block||!!this.widget&&(this.widget.estimatedHeight>=5||this.widget.lineBreaks>0)}eq(e){return e instanceof iA&&l7(this.widget,e.widget)&&this.block==e.block&&this.startSide==e.startSide&&this.endSide==e.endSide}range(e,t=e){if(this.isReplace&&(e>t||e==t&&this.startSide>0&&this.endSide<=0))throw new RangeError("Invalid range for replacement decoration");if(!this.isReplace&&t!=e)throw new RangeError("Widget decorations can only have zero-length ranges");return super.range(e,t)}};ja.prototype.point=!0;function nA(n,e=!1){let{inclusiveStart:t,inclusiveEnd:i}=n;return t==null&&(t=n.inclusive),i==null&&(i=n.inclusive),{start:t??e,end:i??e}}function l7(n,e){return n==e||!!(n&&e&&n.compare(e))}function sd(n,e,t,i=0){let s=t.length-1;s>=0&&t[s]+i>=n?t[s]=Math.max(t[s],e):t.push(n,e)}let Ai=class nh extends bt{constructor(){super(...arguments),this.children=[],this.length=0,this.prevAttrs=void 0,this.attrs=null,this.breakAfter=0}merge(e,t,i,s,r,o){if(i){if(!(i instanceof nh))return!1;this.dom||i.transferDOM(this)}return s&&this.setDeco(i?i.attrs:null),ZE(this,e,t,i?i.children.slice():[],r,o),!0}split(e){let t=new nh;if(t.breakAfter=this.breakAfter,this.length==0)return t;let{i,off:s}=this.childPos(e);s&&(t.append(this.children[i].split(s),0),this.children[i].merge(s,this.children[i].length,null,!1,0,0),i++);for(let r=i;r<this.children.length;r++)t.append(this.children[r],0);for(;i>0&&this.children[i-1].length==0;)this.children[--i].destroy();return this.children.length=i,this.markDirty(),this.length=e,t}transferDOM(e){this.dom&&(this.markDirty(),e.setDOM(this.dom),e.prevAttrs=this.prevAttrs===void 0?this.attrs:this.prevAttrs,this.prevAttrs=void 0,this.dom=null)}setDeco(e){Gd(this.attrs,e)||(this.dom&&(this.prevAttrs=this.attrs,this.markDirty()),this.attrs=e)}append(e,t){KE(this,e,t)}addLineDeco(e){let t=e.spec.attributes,i=e.spec.class;t&&(this.attrs=F0(t,this.attrs||{})),i&&(this.attrs=F0({class:i},this.attrs||{}))}domAtPos(e){return GE(this,e)}reuseDOM(e){e.nodeName=="DIV"&&(this.setDOM(e),this.flags|=6)}sync(e,t){var i;this.dom?this.flags&4&&(qE(this.dom),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0):(this.setDOM(document.createElement("div")),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0),this.prevAttrs!==void 0&&(V0(this.dom,this.prevAttrs,this.attrs),this.dom.classList.add("cm-line"),this.prevAttrs=void 0),super.sync(e,t);let s=this.dom.lastChild;for(;s&&bt.get(s)instanceof za;)s=s.lastChild;if(!s||!this.length||s.nodeName!="BR"&&((i=bt.get(s))===null||i===void 0?void 0:i.isEditable)==!1&&(!be.ios||!this.children.some(r=>r instanceof qr))){let r=document.createElement("BR");r.cmIgnore=!0,this.dom.appendChild(r)}}measureTextSize(){if(this.children.length==0||this.length>20)return null;let e=0,t;for(let i of this.children){if(!(i instanceof qr)||/[^ -~]/.test(i.text))return null;let s=Zh(i.dom);if(s.length!=1)return null;e+=s[0].width,t=s[0].height}return e?{lineHeight:this.dom.getBoundingClientRect().height,charWidth:e/this.length,textHeight:t}:null}coordsAt(e,t){let i=JE(this,e,t);if(!this.children.length&&i&&this.parent){let{heightOracle:s}=this.parent.view.viewState,r=i.bottom-i.top;if(Math.abs(r-s.lineHeight)<2&&s.textHeight<r){let o=(r-s.textHeight)/2;return{top:i.top+o,bottom:i.bottom-o,left:i.left,right:i.left}}}return i}become(e){return e instanceof nh&&this.children.length==0&&e.children.length==0&&Gd(this.attrs,e.attrs)&&this.breakAfter==e.breakAfter}covers(){return!0}static find(e,t){for(let i=0,s=0;i<e.children.length;i++){let r=e.children[i],o=s+r.length;if(o>=t){if(r instanceof nh)return r;if(o>t)break}s=o+r.breakAfter}return null}},Ch=class rd extends bt{constructor(e,t,i){super(),this.widget=e,this.length=t,this.deco=i,this.breakAfter=0,this.prevWidget=null}merge(e,t,i,s,r,o){return i&&(!(i instanceof rd)||!this.widget.compare(i.widget)||e>0&&r<=0||t<this.length&&o<=0)?!1:(this.length=e+(i?i.length:0)+(this.length-t),!0)}domAtPos(e){return e==0?rn.before(this.dom):rn.after(this.dom,e==this.length)}split(e){let t=this.length-e;this.length=e;let i=new rd(this.widget,t,this.deco);return i.breakAfter=this.breakAfter,i}get children(){return db}sync(e){(!this.dom||!this.widget.updateDOM(this.dom,e))&&(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(e)),this.widget.editable||(this.dom.contentEditable="false"))}get overrideDOMText(){return this.parent?this.parent.view.state.doc.slice(this.posAtStart,this.posAtEnd):Ke.empty}domBoundsAround(){return null}become(e){return e instanceof rd&&e.widget.constructor==this.widget.constructor?(e.widget.compare(this.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=e.widget,this.length=e.length,this.deco=e.deco,this.breakAfter=e.breakAfter,!0):!1}ignoreMutation(){return!0}ignoreEvent(e){return this.widget.ignoreEvent(e)}get isEditable(){return!1}get isWidget(){return!0}coordsAt(e,t){let i=this.widget.coordsAt(this.dom,e,t);return i||(this.widget instanceof U0?null:ap(this.dom.getBoundingClientRect(),this.length?e==0:t<=0))}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}covers(e){let{startSide:t,endSide:i}=this.deco;return t==i?!1:e<0?t<0:i>0}},U0=class extends lp{constructor(e){super(),this.height=e}toDOM(){let e=document.createElement("div");return e.className="cm-gap",this.updateDOM(e),e}eq(e){return e.height==this.height}updateDOM(e){return e.style.height=this.height+"px",!0}get editable(){return!0}get estimatedHeight(){return this.height}ignoreEvent(){return!1}},Lm=class sA{constructor(e,t,i,s){this.doc=e,this.pos=t,this.end=i,this.disallowBlockEffectsFor=s,this.content=[],this.curLine=null,this.breakAtStart=0,this.pendingBuffer=0,this.bufferMarks=[],this.atCursorPos=!0,this.openStart=-1,this.openEnd=-1,this.text="",this.textOff=0,this.cursor=e.iter(),this.skip=t}posCovered(){if(this.content.length==0)return!this.breakAtStart&&this.doc.lineAt(this.pos).from!=this.pos;let e=this.content[this.content.length-1];return!(e.breakAfter||e instanceof Ch&&e.deco.endSide<0)}getLine(){return this.curLine||(this.content.push(this.curLine=new Ai),this.atCursorPos=!0),this.curLine}flushBuffer(e=this.bufferMarks){this.pendingBuffer&&(this.curLine.append(Sc(new B0(-1),e),e.length),this.pendingBuffer=0)}addBlockWidget(e){this.flushBuffer(),this.curLine=null,this.content.push(e)}finish(e){this.pendingBuffer&&e<=this.bufferMarks.length?this.flushBuffer():this.pendingBuffer=0,!this.posCovered()&&!(e&&this.content.length&&this.content[this.content.length-1]instanceof Ch)&&this.getLine()}buildText(e,t,i){for(;e>0;){if(this.textOff==this.text.length){let{value:o,lineBreak:a,done:l}=this.cursor.next(this.skip);if(this.skip=0,l)throw new Error("Ran out of text content when drawing inline views");if(a){this.posCovered()||this.getLine(),this.content.length?this.content[this.content.length-1].breakAfter=1:this.breakAtStart=1,this.flushBuffer(),this.curLine=null,this.atCursorPos=!0,e--;continue}else this.text=o,this.textOff=0}let s=Math.min(this.text.length-this.textOff,e),r=Math.min(s,512);this.flushBuffer(t.slice(t.length-i)),this.getLine().append(Sc(new qr(this.text.slice(this.textOff,this.textOff+r)),t),i),this.atCursorPos=!0,this.textOff+=r,e-=r,i=s<=r?0:t.length}}span(e,t,i,s){this.buildText(t-e,i,s),this.pos=t,this.openStart<0&&(this.openStart=s)}point(e,t,i,s,r,o){if(this.disallowBlockEffectsFor[o]&&i instanceof ja){if(i.block)throw new RangeError("Block decorations may not be specified via plugins");if(t>this.doc.lineAt(this.pos).to)throw new RangeError("Decorations that replace line breaks may not be specified via plugins")}let a=t-e;if(i instanceof ja)if(i.block)i.startSide>0&&!this.posCovered()&&this.getLine(),this.addBlockWidget(new Ch(i.widget||Xa.block,a,i));else{let l=YE.create(i.widget||Xa.inline,a,a?0:i.startSide),h=this.atCursorPos&&!l.isEditable&&r<=s.length&&(e<t||i.startSide>0),u=!l.isEditable&&(e<t||r>s.length||i.startSide<=0),c=this.getLine();this.pendingBuffer==2&&!h&&!l.isEditable&&(this.pendingBuffer=0),this.flushBuffer(s),h&&(c.append(Sc(new B0(1),s),r),r=s.length+Math.max(0,r-s.length)),c.append(Sc(l,s),r),this.atCursorPos=u,this.pendingBuffer=u?e<t||r>s.length?1:2:0,this.pendingBuffer&&(this.bufferMarks=s.slice())}else this.doc.lineAt(this.pos).from==this.pos&&this.getLine().addLineDeco(i);a&&(this.textOff+a<=this.text.length?this.textOff+=a:(this.skip+=a-(this.text.length-this.textOff),this.text="",this.textOff=0),this.pos=t),this.openStart<0&&(this.openStart=r)}static build(e,t,i,s,r){let o=new sA(e,t,i,r);return o.openEnd=xi.spans(s,t,i,o),o.openStart<0&&(o.openStart=o.openEnd),o.finish(o.openEnd),o}};function Sc(n,e){for(let t of e)n=new za(t,[n],n.length);return n}let Xa=class extends lp{constructor(e){super(),this.tag=e}eq(e){return e.tag==this.tag}toDOM(){return document.createElement(this.tag)}updateDOM(e){return e.nodeName.toLowerCase()==this.tag}get isHidden(){return!0}};Xa.inline=new Xa("span");Xa.block=new Xa("div");var li=(function(n){return n[n.LTR=0]="LTR",n[n.RTL=1]="RTL",n})(li||(li={}));const Lo=li.LTR,mb=li.RTL;function rA(n){let e=[];for(let t=0;t<n.length;t++)e.push(1<<+n[t]);return e}const h7=rA("88888888888888888888888888888888888666888888787833333333337888888000000000000000000000000008888880000000000000000000000000088888888888888888888888888888888888887866668888088888663380888308888800000000000000000000000800000000000000000000000000000008"),u7=rA("4444448826627288999999999992222222222222222222222222222222222222222222222229999999999999999999994444444444644222822222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222999999949999999229989999223333333333"),q0=Object.create(null),is=[];for(let n of["()","[]","{}"]){let e=n.charCodeAt(0),t=n.charCodeAt(1);q0[e]=t,q0[t]=-e}function oA(n){return n<=247?h7[n]:1424<=n&&n<=1524?2:1536<=n&&n<=1785?u7[n-1536]:1774<=n&&n<=2220?4:8192<=n&&n<=8204?256:64336<=n&&n<=65023?4:1}const c7=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac\ufb50-\ufdff]/;let Ir=class{get dir(){return this.level%2?mb:Lo}constructor(e,t,i){this.from=e,this.to=t,this.level=i}side(e,t){return this.dir==t==e?this.to:this.from}forward(e,t){return e==(this.dir==t)}static find(e,t,i,s){let r=-1;for(let o=0;o<e.length;o++){let a=e[o];if(a.from<=t&&a.to>=t){if(a.level==i)return o;(r<0||(s!=0?s<0?a.from<t:a.to>t:e[r].level>a.level))&&(r=o)}}if(r<0)throw new RangeError("Index out of range");return r}};function aA(n,e){if(n.length!=e.length)return!1;for(let t=0;t<n.length;t++){let i=n[t],s=e[t];if(i.from!=s.from||i.to!=s.to||i.direction!=s.direction||!aA(i.inner,s.inner))return!1}return!0}const ut=[];function d7(n,e,t,i,s){for(let r=0;r<=i.length;r++){let o=r?i[r-1].to:e,a=r<i.length?i[r].from:t,l=r?256:s;for(let h=o,u=l,c=l;h<a;h++){let f=oA(n.charCodeAt(h));f==512?f=u:f==8&&c==4&&(f=16),ut[h]=f==4?2:f,f&7&&(c=f),u=f}for(let h=o,u=l,c=l;h<a;h++){let f=ut[h];if(f==128)h<a-1&&u==ut[h+1]&&u&24?f=ut[h]=u:ut[h]=256;else if(f==64){let p=h+1;for(;p<a&&ut[p]==64;)p++;let b=h&&u==8||p<t&&ut[p]==8?c==1?1:8:256;for(let y=h;y<p;y++)ut[y]=b;h=p-1}else f==8&&c==1&&(ut[h]=1);u=f,f&7&&(c=f)}}}function f7(n,e,t,i,s){let r=s==1?2:1;for(let o=0,a=0,l=0;o<=i.length;o++){let h=o?i[o-1].to:e,u=o<i.length?i[o].from:t;for(let c=h,f,p,b;c<u;c++)if(p=q0[f=n.charCodeAt(c)])if(p<0){for(let y=a-3;y>=0;y-=3)if(is[y+1]==-p){let _=is[y+2],T=_&2?s:_&4?_&1?r:s:0;T&&(ut[c]=ut[is[y]]=T),a=y;break}}else{if(is.length==189)break;is[a++]=c,is[a++]=f,is[a++]=l}else if((b=ut[c])==2||b==1){let y=b==s;l=y?0:1;for(let _=a-3;_>=0;_-=3){let T=is[_+2];if(T&2)break;if(y)is[_+2]|=2;else{if(T&4)break;is[_+2]|=4}}}}}function p7(n,e,t,i){for(let s=0,r=i;s<=t.length;s++){let o=s?t[s-1].to:n,a=s<t.length?t[s].from:e;for(let l=o;l<a;){let h=ut[l];if(h==256){let u=l+1;for(;;)if(u==a){if(s==t.length)break;u=t[s++].to,a=s<t.length?t[s].from:e}else if(ut[u]==256)u++;else break;let c=r==1,f=(u<e?ut[u]:i)==1,p=c==f?c?1:2:i;for(let b=u,y=s,_=y?t[y-1].to:n;b>l;)b==_&&(b=t[--y].from,_=y?t[y-1].to:n),ut[--b]=p;l=u}else r=h,l++}}}function z0(n,e,t,i,s,r,o){let a=i%2?2:1;if(i%2==s%2)for(let l=e,h=0;l<t;){let u=!0,c=!1;if(h==r.length||l<r[h].from){let y=ut[l];y!=a&&(u=!1,c=y==16)}let f=!u&&a==1?[]:null,p=u?i:i+1,b=l;e:for(;;)if(h<r.length&&b==r[h].from){if(c)break e;let y=r[h];if(!u)for(let _=y.to,T=h+1;;){if(_==t)break e;if(T<r.length&&r[T].from==_)_=r[T++].to;else{if(ut[_]==a)break e;break}}if(h++,f)f.push(y);else{y.from>l&&o.push(new Ir(l,y.from,p));let _=y.direction==Lo!=!(p%2);j0(n,_?i+1:i,s,y.inner,y.from,y.to,o),l=y.to}b=y.to}else{if(b==t||(u?ut[b]!=a:ut[b]==a))break;b++}f?z0(n,l,b,i+1,s,f,o):l<b&&o.push(new Ir(l,b,p)),l=b}else for(let l=t,h=r.length;l>e;){let u=!0,c=!1;if(!h||l>r[h-1].to){let y=ut[l-1];y!=a&&(u=!1,c=y==16)}let f=!u&&a==1?[]:null,p=u?i:i+1,b=l;e:for(;;)if(h&&b==r[h-1].to){if(c)break e;let y=r[--h];if(!u)for(let _=y.from,T=h;;){if(_==e)break e;if(T&&r[T-1].to==_)_=r[--T].from;else{if(ut[_-1]==a)break e;break}}if(f)f.push(y);else{y.to<l&&o.push(new Ir(y.to,l,p));let _=y.direction==Lo!=!(p%2);j0(n,_?i+1:i,s,y.inner,y.from,y.to,o),l=y.from}b=y.from}else{if(b==e||(u?ut[b-1]!=a:ut[b-1]==a))break;b--}f?z0(n,b,l,i+1,s,f,o):b<l&&o.push(new Ir(b,l,p)),l=b}}function j0(n,e,t,i,s,r,o){let a=e%2?2:1;d7(n,s,r,i,a),f7(n,s,r,i,a),p7(s,r,i,a),z0(n,s,r,e,t,i,o)}function m7(n,e,t){if(!n)return[new Ir(0,0,e==mb?1:0)];if(e==Lo&&!t.length&&!c7.test(n))return lA(n.length);if(t.length)for(;n.length>ut.length;)ut[ut.length]=256;let i=[],s=e==Lo?0:1;return j0(n,s,s,t,0,n.length,i),i}function lA(n){return[new Ir(0,n,0)]}let hA="";function g7(n,e,t,i,s){var r;let o=i.head-n.from,a=Ir.find(e,o,(r=i.bidiLevel)!==null&&r!==void 0?r:-1,i.assoc),l=e[a],h=l.side(s,t);if(o==h){let f=a+=s?1:-1;if(f<0||f>=e.length)return null;l=e[a=f],o=l.side(!s,t),h=l.side(s,t)}let u=bs(n.text,o,l.forward(s,t));(u<l.from||u>l.to)&&(u=h),hA=n.text.slice(Math.min(o,u),Math.max(o,u));let c=a==(s?e.length-1:0)?null:e[a+(s?1:-1)];return c&&u==h&&c.level+(s?0:1)<l.level?ke.cursor(c.side(!s,t)+n.from,c.forward(s,t)?1:-1,c.level):ke.cursor(u+n.from,l.forward(s,t)?-1:1,l.level)}function O7(n,e,t){for(let i=e;i<t;i++){let s=oA(n.charCodeAt(i));if(s==1)return Lo;if(s==2||s==4)return mb}return Lo}const uA=Qe.define(),cA=Qe.define(),dA=Qe.define(),fA=Qe.define(),X0=Qe.define(),pA=Qe.define(),mA=Qe.define(),gb=Qe.define(),Ob=Qe.define(),gA=Qe.define({combine:n=>n.some(e=>e)}),y7=Qe.define({combine:n=>n.some(e=>e)}),OA=Qe.define();let $m=class H0{constructor(e,t="nearest",i="nearest",s=5,r=5,o=!1){this.range=e,this.y=t,this.x=i,this.yMargin=s,this.xMargin=r,this.isSnapshot=o}map(e){return e.empty?this:new H0(this.range.map(e),this.y,this.x,this.yMargin,this.xMargin,this.isSnapshot)}clip(e){return this.range.to<=e.doc.length?this:new H0(ke.cursor(e.doc.length),this.y,this.x,this.yMargin,this.xMargin,this.isSnapshot)}};const xc=jt.define({map:(n,e)=>n.map(e)}),yA=jt.define();function vs(n,e,t){let i=n.facet(fA);i.length?i[0](e):window.onerror&&window.onerror(String(e),t,void 0,void 0,e)||(t?console.error(t+":",e):console.error(e))}const Js=Qe.define({combine:n=>n.length?n[0]:!0});let b7=0;const ua=Qe.define({combine(n){return n.filter((e,t)=>{for(let i=0;i<t;i++)if(n[i].plugin==e.plugin)return!1;return!0})}});let Kd=class W0{constructor(e,t,i,s,r){this.id=e,this.create=t,this.domEventHandlers=i,this.domEventObservers=s,this.baseExtensions=r(this),this.extension=this.baseExtensions.concat(ua.of({plugin:this,arg:void 0}))}of(e){return this.baseExtensions.concat(ua.of({plugin:this,arg:e}))}static define(e,t){const{eventHandlers:i,eventObservers:s,provide:r,decorations:o}=t||{};return new W0(b7++,e,i,s,a=>{let l=[];return o&&l.push(Yh.of(h=>{let u=h.plugin(a);return u?o(u):Ft.none})),r&&l.push(r(a)),l})}static fromClass(e,t){return W0.define((i,s)=>new e(i,s),t)}},Qm=class{constructor(e){this.spec=e,this.mustUpdate=null,this.value=null}get plugin(){return this.spec&&this.spec.plugin}update(e){if(this.value){if(this.mustUpdate){let t=this.mustUpdate;if(this.mustUpdate=null,this.value.update)try{this.value.update(t)}catch(i){if(vs(t.state,i,"CodeMirror plugin crashed"),this.value.destroy)try{this.value.destroy()}catch{}this.deactivate()}}}else if(this.spec)try{this.value=this.spec.plugin.create(e,this.spec.arg)}catch(t){vs(e.state,t,"CodeMirror plugin crashed"),this.deactivate()}return this}destroy(e){var t;if(!((t=this.value)===null||t===void 0)&&t.destroy)try{this.value.destroy()}catch(i){vs(e.state,i,"CodeMirror plugin crashed")}}deactivate(){this.spec=this.value=null}};const bA=Qe.define(),yb=Qe.define(),Yh=Qe.define(),vA=Qe.define(),Cu=Qe.define(),SA=Qe.define();function Ox(n,e){let t=n.state.facet(SA);if(!t.length)return t;let i=t.map(r=>r instanceof Function?r(n):r),s=[];return xi.spans(i,e.from,e.to,{point(){},span(r,o,a,l){let h=r-e.from,u=o-e.from,c=s;for(let f=a.length-1;f>=0;f--,l--){let p=a[f].spec.bidiIsolate,b;if(p==null&&(p=O7(e.text,h,u)),l>0&&c.length&&(b=c[c.length-1]).to==h&&b.direction==p)b.to=u,c=b.inner;else{let y={from:h,to:u,direction:p,inner:[]};c.push(y),c=y.inner}}}}),s}const xA=Qe.define();function TA(n){let e=0,t=0,i=0,s=0;for(let r of n.state.facet(xA)){let o=r(n);o&&(o.left!=null&&(e=Math.max(e,o.left)),o.right!=null&&(t=Math.max(t,o.right)),o.top!=null&&(i=Math.max(i,o.top)),o.bottom!=null&&(s=Math.max(s,o.bottom)))}return{left:e,right:t,top:i,bottom:s}}const sh=Qe.define();let Qr=class od{constructor(e,t,i,s){this.fromA=e,this.toA=t,this.fromB=i,this.toB=s}join(e){return new od(Math.min(this.fromA,e.fromA),Math.max(this.toA,e.toA),Math.min(this.fromB,e.fromB),Math.max(this.toB,e.toB))}addToSet(e){let t=e.length,i=this;for(;t>0;t--){let s=e[t-1];if(!(s.fromA>i.toA)){if(s.toA<i.fromA)break;i=i.join(s),e.splice(t-1,1)}}return e.splice(t,0,i),e}static extendWithRanges(e,t){if(t.length==0)return e;let i=[];for(let s=0,r=0,o=0,a=0;;s++){let l=s==e.length?null:e[s],h=o-a,u=l?l.fromB:1e9;for(;r<t.length&&t[r]<u;){let c=t[r],f=t[r+1],p=Math.max(a,c),b=Math.min(u,f);if(p<=b&&new od(p+h,b+h,p,b).addToSet(i),f>u)break;r+=2}if(!l)return i;new od(l.fromA,l.toA,l.fromB,l.toB).addToSet(i),o=l.toA,a=l.toB}}},yx=class wA{constructor(e,t,i){this.view=e,this.state=t,this.transactions=i,this.flags=0,this.startState=e.state,this.changes=Ds.empty(this.startState.doc.length);for(let r of i)this.changes=this.changes.compose(r.changes);let s=[];this.changes.iterChangedRanges((r,o,a,l)=>s.push(new Qr(r,o,a,l))),this.changedRanges=s}static create(e,t,i){return new wA(e,t,i)}get viewportChanged(){return(this.flags&4)>0}get viewportMoved(){return(this.flags&8)>0}get heightChanged(){return(this.flags&2)>0}get geometryChanged(){return this.docChanged||(this.flags&18)>0}get focusChanged(){return(this.flags&1)>0}get docChanged(){return!this.changes.empty}get selectionSet(){return this.transactions.some(e=>e.selection)}get empty(){return this.flags==0&&this.transactions.length==0}},bx=class extends bt{get length(){return this.view.state.doc.length}constructor(e){super(),this.view=e,this.decorations=[],this.dynamicDecorationMap=[!1],this.domChanged=null,this.hasComposition=null,this.markedForComposition=new Set,this.editContextFormatting=Ft.none,this.lastCompositionAfterCursor=!1,this.minWidth=0,this.minWidthFrom=0,this.minWidthTo=0,this.impreciseAnchor=null,this.impreciseHead=null,this.forceSelection=!1,this.lastUpdate=Date.now(),this.setDOM(e.contentDOM),this.children=[new Ai],this.children[0].setParent(this),this.updateDeco(),this.updateInner([new Qr(0,0,0,e.state.doc.length)],0,null)}update(e){var t;let i=e.changedRanges;this.minWidth>0&&i.length&&(i.every(({fromA:h,toA:u})=>u<this.minWidthFrom||h>this.minWidthTo)?(this.minWidthFrom=e.changes.mapPos(this.minWidthFrom,1),this.minWidthTo=e.changes.mapPos(this.minWidthTo,1)):this.minWidth=this.minWidthFrom=this.minWidthTo=0),this.updateEditContextFormatting(e);let s=-1;this.view.inputState.composing>=0&&!this.view.observer.editContext&&(!((t=this.domChanged)===null||t===void 0)&&t.newSel?s=this.domChanged.newSel.head:!k7(e.changes,this.hasComposition)&&!e.selectionSet&&(s=e.state.selection.main.head));let r=s>-1?S7(this.view,e.changes,s):null;if(this.domChanged=null,this.hasComposition){this.markedForComposition.clear();let{from:h,to:u}=this.hasComposition;i=new Qr(h,u,e.changes.mapPos(h,-1),e.changes.mapPos(u,1)).addToSet(i.slice())}this.hasComposition=r?{from:r.range.fromB,to:r.range.toB}:null,(be.ie||be.chrome)&&!r&&e&&e.state.doc.lines!=e.startState.doc.lines&&(this.forceSelection=!0);let o=this.decorations,a=this.updateDeco(),l=w7(o,a,e.changes);return i=Qr.extendWithRanges(i,l),!(this.flags&7)&&i.length==0?!1:(this.updateInner(i,e.startState.doc.length,r),e.transactions.length&&(this.lastUpdate=Date.now()),!0)}updateInner(e,t,i){this.view.viewState.mustMeasureContent=!0,this.updateChildren(e,t,i);let{observer:s}=this.view;s.ignore(()=>{this.dom.style.height=this.view.viewState.contentHeight/this.view.scaleY+"px",this.dom.style.flexBasis=this.minWidth?this.minWidth+"px":"";let o=be.chrome||be.ios?{node:s.selectionRange.focusNode,written:!1}:void 0;this.sync(this.view,o),this.flags&=-8,o&&(o.written||s.selectionRange.focusNode!=o.node)&&(this.forceSelection=!0),this.dom.style.height=""}),this.markedForComposition.forEach(o=>o.flags&=-9);let r=[];if(this.view.viewport.from||this.view.viewport.to<this.view.state.doc.length)for(let o of this.children)o instanceof Ch&&o.widget instanceof U0&&r.push(o.dom);s.updateGaps(r)}updateChildren(e,t,i){let s=i?i.range.addToSet(e.slice()):e,r=this.childCursor(t);for(let o=s.length-1;;o--){let a=o>=0?s[o]:null;if(!a)break;let{fromA:l,toA:h,fromB:u,toB:c}=a,f,p,b,y;if(i&&i.range.fromB<c&&i.range.toB>u){let S=Lm.build(this.view.state.doc,u,i.range.fromB,this.decorations,this.dynamicDecorationMap),k=Lm.build(this.view.state.doc,i.range.toB,c,this.decorations,this.dynamicDecorationMap);p=S.breakAtStart,b=S.openStart,y=k.openEnd;let A=this.compositionView(i);k.breakAtStart?A.breakAfter=1:k.content.length&&A.merge(A.length,A.length,k.content[0],!1,k.openStart,0)&&(A.breakAfter=k.content[0].breakAfter,k.content.shift()),S.content.length&&A.merge(0,0,S.content[S.content.length-1],!0,0,S.openEnd)&&S.content.pop(),f=S.content.concat(A).concat(k.content)}else({content:f,breakAtStart:p,openStart:b,openEnd:y}=Lm.build(this.view.state.doc,u,c,this.decorations,this.dynamicDecorationMap));let{i:_,off:T}=r.findPos(h,1),{i:w,off:v}=r.findPos(l,-1);WE(this,w,v,_,T,f,p,b,y)}i&&this.fixCompositionDOM(i)}updateEditContextFormatting(e){this.editContextFormatting=this.editContextFormatting.map(e.changes);for(let t of e.transactions)for(let i of t.effects)i.is(yA)&&(this.editContextFormatting=i.value)}compositionView(e){let t=new qr(e.text.nodeValue);t.flags|=8;for(let{deco:s}of e.marks)t=new za(s,[t],t.length);let i=new Ai;return i.append(t,0),i}fixCompositionDOM(e){let t=(r,o)=>{o.flags|=8|(o.children.some(l=>l.flags&7)?1:0),this.markedForComposition.add(o);let a=bt.get(r);a&&a!=o&&(a.dom=null),o.setDOM(r)},i=this.childPos(e.range.fromB,1),s=this.children[i.i];t(e.line,s);for(let r=e.marks.length-1;r>=-1;r--)i=s.childPos(i.off,1),s=s.children[i.i],t(r>=0?e.marks[r].node:e.text,s)}updateSelection(e=!1,t=!1){(e||!this.view.observer.selectionRange.focusNode)&&this.view.observer.readSelectionRange();let i=this.view.root.activeElement,s=i==this.dom,r=!s&&!(this.view.state.facet(Js)||this.dom.tabIndex>-1)&&nd(this.dom,this.view.observer.selectionRange)&&!(i&&this.dom.contains(i));if(!(s||t||r))return;let o=this.forceSelection;this.forceSelection=!1;let a=this.view.state.selection.main,l=this.moveToLine(this.domAtPos(a.anchor)),h=a.empty?l:this.moveToLine(this.domAtPos(a.head));if(be.gecko&&a.empty&&!this.hasComposition&&v7(l)){let c=document.createTextNode("");this.view.observer.ignore(()=>l.node.insertBefore(c,l.node.childNodes[l.offset]||null)),l=h=new rn(c,0),o=!0}let u=this.view.observer.selectionRange;(o||!u.focusNode||(!kh(l.node,l.offset,u.anchorNode,u.anchorOffset)||!kh(h.node,h.offset,u.focusNode,u.focusOffset))&&!this.suppressWidgetCursorChange(u,a))&&(this.view.observer.ignore(()=>{be.android&&be.chrome&&this.dom.contains(u.focusNode)&&_7(u.focusNode,this.dom)&&(this.dom.blur(),this.dom.focus({preventScroll:!0}));let c=Wh(this.view.root);if(c)if(a.empty){if(be.gecko){let f=x7(l.node,l.offset);if(f&&f!=3){let p=(f==1?jE:XE)(l.node,l.offset);p&&(l=new rn(p.node,p.offset))}}c.collapse(l.node,l.offset),a.bidiLevel!=null&&c.caretBidiLevel!==void 0&&(c.caretBidiLevel=a.bidiLevel)}else if(c.extend){c.collapse(l.node,l.offset);try{c.extend(h.node,h.offset)}catch{}}else{let f=document.createRange();a.anchor>a.head&&([l,h]=[h,l]),f.setEnd(h.node,h.offset),f.setStart(l.node,l.offset),c.removeAllRanges(),c.addRange(f)}r&&this.view.root.activeElement==this.dom&&(this.dom.blur(),i&&i.focus())}),this.view.observer.setSelectionRange(l,h)),this.impreciseAnchor=l.precise?null:new rn(u.anchorNode,u.anchorOffset),this.impreciseHead=h.precise?null:new rn(u.focusNode,u.focusOffset)}suppressWidgetCursorChange(e,t){return this.hasComposition&&t.empty&&kh(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset)&&this.posFromDOM(e.focusNode,e.focusOffset)==t.head}enforceCursorAssoc(){if(this.hasComposition)return;let{view:e}=this,t=e.state.selection.main,i=Wh(e.root),{anchorNode:s,anchorOffset:r}=e.observer.selectionRange;if(!i||!t.empty||!t.assoc||!i.modify)return;let o=Ai.find(this,t.head);if(!o)return;let a=o.posAtStart;if(t.head==a||t.head==a+o.length)return;let l=this.coordsAt(t.head,-1),h=this.coordsAt(t.head,1);if(!l||!h||l.bottom>h.top)return;let u=this.domAtPos(t.head+t.assoc);i.collapse(u.node,u.offset),i.modify("move",t.assoc<0?"forward":"backward","lineboundary"),e.observer.readSelectionRange();let c=e.observer.selectionRange;e.docView.posFromDOM(c.anchorNode,c.anchorOffset)!=t.from&&i.collapse(s,r)}moveToLine(e){let t=this.dom,i;if(e.node!=t)return e;for(let s=e.offset;!i&&s<t.childNodes.length;s++){let r=bt.get(t.childNodes[s]);r instanceof Ai&&(i=r.domAtPos(0))}for(let s=e.offset-1;!i&&s>=0;s--){let r=bt.get(t.childNodes[s]);r instanceof Ai&&(i=r.domAtPos(r.length))}return i?new rn(i.node,i.offset,!0):e}nearest(e){for(let t=e;t;){let i=bt.get(t);if(i&&i.rootView==this)return i;t=t.parentNode}return null}posFromDOM(e,t){let i=this.nearest(e);if(!i)throw new RangeError("Trying to find position for a DOM position outside of the document");return i.localPosFromDOM(e,t)+i.posAtStart}domAtPos(e){let{i:t,off:i}=this.childCursor().findPos(e,-1);for(;t<this.children.length-1;){let s=this.children[t];if(i<s.length||s instanceof Ai)break;t++,i=0}return this.children[t].domAtPos(i)}coordsAt(e,t){let i=null,s=0;for(let r=this.length,o=this.children.length-1;o>=0;o--){let a=this.children[o],l=r-a.breakAfter,h=l-a.length;if(l<e)break;if(h<=e&&(h<e||a.covers(-1))&&(l>e||a.covers(1))&&(!i||a instanceof Ai&&!(i instanceof Ai&&t>=0)))i=a,s=h;else if(i&&h==e&&l==e&&a instanceof Ch&&Math.abs(t)<2){if(a.deco.startSide<0)break;o&&(i=null)}r=h}return i?i.coordsAt(e-s,t):null}coordsForChar(e){let{i:t,off:i}=this.childPos(e,1),s=this.children[t];if(!(s instanceof Ai))return null;for(;s.children.length;){let{i:a,off:l}=s.childPos(i,1);for(;;a++){if(a==s.children.length)return null;if((s=s.children[a]).length)break}i=l}if(!(s instanceof qr))return null;let r=bs(s.text,i);if(r==i)return null;let o=Ro(s.dom,i,r).getClientRects();for(let a=0;a<o.length;a++){let l=o[a];if(a==o.length-1||l.top<l.bottom&&l.left<l.right)return l}return null}measureVisibleLineHeights(e){let t=[],{from:i,to:s}=e,r=this.view.contentDOM.clientWidth,o=r>Math.max(this.view.scrollDOM.clientWidth,this.minWidth)+1,a=-1,l=this.view.textDirection==li.LTR;for(let h=0,u=0;u<this.children.length;u++){let c=this.children[u],f=h+c.length;if(f>s)break;if(h>=i){let p=c.dom.getBoundingClientRect();if(t.push(p.height),o){let b=c.dom.lastChild,y=b?Zh(b):[];if(y.length){let _=y[y.length-1],T=l?_.right-p.left:p.right-_.left;T>a&&(a=T,this.minWidth=r,this.minWidthFrom=h,this.minWidthTo=f)}}}h=f+c.breakAfter}return t}textDirectionAt(e){let{i:t}=this.childPos(e,1);return getComputedStyle(this.children[t].dom).direction=="rtl"?li.RTL:li.LTR}measureTextSize(){for(let r of this.children)if(r instanceof Ai){let o=r.measureTextSize();if(o)return o}let e=document.createElement("div"),t,i,s;return e.className="cm-line",e.style.width="99999px",e.style.position="absolute",e.textContent="abc def ghi jkl mno pqr stu",this.view.observer.ignore(()=>{this.dom.appendChild(e);let r=Zh(e.firstChild)[0];t=e.getBoundingClientRect().height,i=r?r.width/27:7,s=r?r.height:t,e.remove()}),{lineHeight:t,charWidth:i,textHeight:s}}childCursor(e=this.length){let t=this.children.length;return t&&(e-=this.children[--t].length),new HE(this.children,e,t)}computeBlockGapDeco(){let e=[],t=this.view.viewState;for(let i=0,s=0;;s++){let r=s==t.viewports.length?null:t.viewports[s],o=r?r.from-1:this.length;if(o>i){let a=(t.lineBlockAt(o).bottom-t.lineBlockAt(i).top)/this.view.scaleY;e.push(Ft.replace({widget:new U0(a),block:!0,inclusive:!0,isBlockGap:!0}).range(i,o))}if(!r)break;i=r.to+1}return Ft.set(e)}updateDeco(){let e=1,t=this.view.state.facet(Yh).map(r=>(this.dynamicDecorationMap[e++]=typeof r=="function")?r(this.view):r),i=!1,s=this.view.state.facet(vA).map((r,o)=>{let a=typeof r=="function";return a&&(i=!0),a?r(this.view):r});for(s.length&&(this.dynamicDecorationMap[e++]=i,t.push(xi.join(s))),this.decorations=[this.editContextFormatting,...t,this.computeBlockGapDeco(),this.view.viewState.lineGapDeco];e<this.decorations.length;)this.dynamicDecorationMap[e++]=!1;return this.decorations}scrollIntoView(e){if(e.isSnapshot){let h=this.view.viewState.lineBlockAt(e.range.head);this.view.scrollDOM.scrollTop=h.top-e.yMargin,this.view.scrollDOM.scrollLeft=e.xMargin;return}for(let h of this.view.state.facet(OA))try{if(h(this.view,e.range,e))return!0}catch(u){vs(this.view.state,u,"scroll handler")}let{range:t}=e,i=this.coordsAt(t.head,t.empty?t.assoc:t.head>t.anchor?-1:1),s;if(!i)return;!t.empty&&(s=this.coordsAt(t.anchor,t.anchor>t.head?-1:1))&&(i={left:Math.min(i.left,s.left),top:Math.min(i.top,s.top),right:Math.max(i.right,s.right),bottom:Math.max(i.bottom,s.bottom)});let r=TA(this.view),o={left:i.left-r.left,top:i.top-r.top,right:i.right+r.right,bottom:i.bottom+r.bottom},{offsetWidth:a,offsetHeight:l}=this.view.scrollDOM;K6(this.view.scrollDOM,o,t.head<t.anchor?-1:1,e.x,e.y,Math.max(Math.min(e.xMargin,a),-a),Math.max(Math.min(e.yMargin,l),-l),this.view.textDirection==li.LTR)}};function v7(n){return n.node.nodeType==1&&n.node.firstChild&&(n.offset==0||n.node.childNodes[n.offset-1].contentEditable=="false")&&(n.offset==n.node.childNodes.length||n.node.childNodes[n.offset].contentEditable=="false")}function _A(n,e){let t=n.observer.selectionRange;if(!t.focusNode)return null;let i=jE(t.focusNode,t.focusOffset),s=XE(t.focusNode,t.focusOffset),r=i||s;if(s&&i&&s.node!=i.node){let a=bt.get(s.node);if(!a||a instanceof qr&&a.text!=s.node.nodeValue)r=s;else if(n.docView.lastCompositionAfterCursor){let l=bt.get(i.node);!l||l instanceof qr&&l.text!=i.node.nodeValue||(r=s)}}if(n.docView.lastCompositionAfterCursor=r!=i,!r)return null;let o=e-r.offset;return{from:o,to:o+r.node.nodeValue.length,node:r.node}}function S7(n,e,t){let i=_A(n,t);if(!i)return null;let{node:s,from:r,to:o}=i,a=s.nodeValue;if(/[\n\r]/.test(a)||n.state.doc.sliceString(i.from,i.to)!=a)return null;let l=e.invertedDesc,h=new Qr(l.mapPos(r),l.mapPos(o),r,o),u=[];for(let c=s.parentNode;;c=c.parentNode){let f=bt.get(c);if(f instanceof za)u.push({node:c,deco:f.mark});else{if(f instanceof Ai||c.nodeName=="DIV"&&c.parentNode==n.contentDOM)return{range:h,text:s,marks:u,line:c};if(c!=n.contentDOM)u.push({node:c,deco:new fb({inclusive:!0,attributes:a7(c),tagName:c.tagName.toLowerCase()})});else return null}}}function x7(n,e){return n.nodeType!=1?0:(e&&n.childNodes[e-1].contentEditable=="false"?1:0)|(e<n.childNodes.length&&n.childNodes[e].contentEditable=="false"?2:0)}let T7=class{constructor(){this.changes=[]}compareRange(e,t){sd(e,t,this.changes)}comparePoint(e,t){sd(e,t,this.changes)}boundChange(e){sd(e,e,this.changes)}};function w7(n,e,t){let i=new T7;return xi.compare(n,e,t,i),i.changes}function _7(n,e){for(let t=n;t&&t!=e;t=t.assignedSlot||t.parentNode)if(t.nodeType==1&&t.contentEditable=="false")return!0;return!1}function k7(n,e){let t=!1;return e&&n.iterChangedRanges((i,s)=>{i<e.to&&s>e.from&&(t=!0)}),t}function C7(n,e,t=1){let i=n.charCategorizer(e),s=n.doc.lineAt(e),r=e-s.from;if(s.length==0)return ke.cursor(e);r==0?t=1:r==s.length&&(t=-1);let o=r,a=r;t<0?o=bs(s.text,r,!1):a=bs(s.text,r);let l=i(s.text.slice(o,a));for(;o>0;){let h=bs(s.text,o,!1);if(i(s.text.slice(h,o))!=l)break;o=h}for(;a<s.length;){let h=bs(s.text,a);if(i(s.text.slice(a,h))!=l)break;a=h}return ke.range(o+s.from,a+s.from)}function E7(n,e){return e.left>n?e.left-n:Math.max(0,n-e.right)}function A7(n,e){return e.top>n?e.top-n:Math.max(0,n-e.bottom)}function Bm(n,e){return n.top<e.bottom-1&&n.bottom>e.top+1}function vx(n,e){return e<n.top?{top:e,left:n.left,right:n.right,bottom:n.bottom}:n}function Sx(n,e){return e>n.bottom?{top:n.top,left:n.left,right:n.right,bottom:e}:n}function Z0(n,e,t){let i,s,r,o,a=!1,l,h,u,c;for(let b=n.firstChild;b;b=b.nextSibling){let y=Zh(b);for(let _=0;_<y.length;_++){let T=y[_];s&&Bm(s,T)&&(T=vx(Sx(T,s.bottom),s.top));let w=E7(e,T),v=A7(t,T);if(w==0&&v==0)return b.nodeType==3?xx(b,e,t):Z0(b,e,t);(!i||o>v||o==v&&r>w)&&(i=b,s=T,r=w,o=v,a=w?e<T.left?_>0:_<y.length-1:!0),w==0?t>T.bottom&&(!u||u.bottom<T.bottom)?(l=b,u=T):t<T.top&&(!c||c.top>T.top)&&(h=b,c=T):u&&Bm(u,T)?u=Sx(u,T.bottom):c&&Bm(c,T)&&(c=vx(c,T.top))}}if(u&&u.bottom>=t?(i=l,s=u):c&&c.top<=t&&(i=h,s=c),!i)return{node:n,offset:0};let f=Math.max(s.left,Math.min(s.right,e));if(i.nodeType==3)return xx(i,f,t);if(a&&i.contentEditable!="false")return Z0(i,f,t);let p=Array.prototype.indexOf.call(n.childNodes,i)+(e>=(s.left+s.right)/2?1:0);return{node:n,offset:p}}function xx(n,e,t){let i=n.nodeValue.length,s=-1,r=1e9,o=0;for(let a=0;a<i;a++){let l=Ro(n,a,a+1).getClientRects();for(let h=0;h<l.length;h++){let u=l[h];if(u.top==u.bottom)continue;o||(o=e-u.left);let c=(u.top>t?u.top-t:t-u.bottom)-1;if(u.left-1<=e&&u.right+1>=e&&c<r){let f=e>=(u.left+u.right)/2,p=f;if((be.chrome||be.gecko)&&Ro(n,a).getBoundingClientRect().left==u.right&&(p=!f),c<=0)return{node:n,offset:a+(p?1:0)};s=a+(p?1:0),r=c}}}return{node:n,offset:s>-1?s:o>0?n.nodeValue.length:0}}function kA(n,e,t,i=-1){var s,r;let o=n.contentDOM.getBoundingClientRect(),a=o.top+n.viewState.paddingTop,l,{docHeight:h}=n.viewState,{x:u,y:c}=e,f=c-a;if(f<0)return 0;if(f>h)return n.state.doc.length;for(let S=n.viewState.heightOracle.textHeight/2,k=!1;l=n.elementAtHeight(f),l.type!=_s.Text;)for(;f=i>0?l.bottom+S:l.top-S,!(f>=0&&f<=h);){if(k)return t?null:0;k=!0,i=-i}c=a+f;let p=l.from;if(p<n.viewport.from)return n.viewport.from==0?0:t?null:Tx(n,o,l,u,c);if(p>n.viewport.to)return n.viewport.to==n.state.doc.length?n.state.doc.length:t?null:Tx(n,o,l,u,c);let b=n.dom.ownerDocument,y=n.root.elementFromPoint?n.root:b,_=y.elementFromPoint(u,c);_&&!n.contentDOM.contains(_)&&(_=null),_||(u=Math.max(o.left+1,Math.min(o.right-1,u)),_=y.elementFromPoint(u,c),_&&!n.contentDOM.contains(_)&&(_=null));let T,w=-1;if(_&&((s=n.docView.nearest(_))===null||s===void 0?void 0:s.isEditable)!=!1){if(b.caretPositionFromPoint){let S=b.caretPositionFromPoint(u,c);S&&({offsetNode:T,offset:w}=S)}else if(b.caretRangeFromPoint){let S=b.caretRangeFromPoint(u,c);S&&({startContainer:T,startOffset:w}=S)}T&&(!n.contentDOM.contains(T)||be.safari&&P7(T,w,u)||be.chrome&&D7(T,w,u))&&(T=void 0),T&&(w=Math.min(Ms(T),w))}if(!T||!n.docView.dom.contains(T)){let S=Ai.find(n.docView,p);if(!S)return f>l.top+l.height/2?l.to:l.from;({node:T,offset:w}=Z0(S.dom,u,c))}let v=n.docView.nearest(T);if(!v)return null;if(v.isWidget&&((r=v.dom)===null||r===void 0?void 0:r.nodeType)==1){let S=v.dom.getBoundingClientRect();return e.y<S.top||e.y<=S.bottom&&e.x<=(S.left+S.right)/2?v.posAtStart:v.posAtEnd}else return v.localPosFromDOM(T,w)+v.posAtStart}function Tx(n,e,t,i,s){let r=Math.round((i-e.left)*n.defaultCharacterWidth);if(n.lineWrapping&&t.height>n.defaultLineHeight*1.5){let a=n.viewState.heightOracle.textHeight,l=Math.floor((s-t.top-(n.defaultLineHeight-a)*.5)/a);r+=l*n.viewState.heightOracle.lineLength}let o=n.state.sliceDoc(t.from,t.to);return t.from+X6(o,r,n.state.tabSize)}function CA(n,e,t){let i,s=n;if(n.nodeType!=3||e!=(i=n.nodeValue.length))return!1;for(;;){let r=s.nextSibling;if(r){if(r.nodeName=="BR")break;return!1}else{let o=s.parentNode;if(!o||o.nodeName=="DIV")break;s=o}}return Ro(n,i-1,i).getBoundingClientRect().right>t}function P7(n,e,t){return CA(n,e,t)}function D7(n,e,t){if(e!=0)return CA(n,e,t);for(let s=n;;){let r=s.parentNode;if(!r||r.nodeType!=1||r.firstChild!=s)return!1;if(r.classList.contains("cm-line"))break;s=r}let i=n.nodeType==1?n.getBoundingClientRect():Ro(n,0,Math.max(n.nodeValue.length,1)).getBoundingClientRect();return t-i.left>5}function M7(n,e,t){let i=n.lineBlockAt(e);if(Array.isArray(i.type)){let s;for(let r of i.type){if(r.from>e)break;if(!(r.to<e)){if(r.from<e&&r.to>e)return r;(!s||r.type==_s.Text&&(s.type!=r.type||(t<0?r.from<e:r.to>e)))&&(s=r)}}return s||i}return i}function I7(n,e,t,i){let s=M7(n,e.head,e.assoc||-1),r=!i||s.type!=_s.Text||!(n.lineWrapping||s.widgetLineBreaks)?null:n.coordsAtPos(e.assoc<0&&e.head>s.from?e.head-1:e.head);if(r){let o=n.dom.getBoundingClientRect(),a=n.textDirectionAt(s.from),l=n.posAtCoords({x:t==(a==li.LTR)?o.right-1:o.left+1,y:(r.top+r.bottom)/2});if(l!=null)return ke.cursor(l,t?-1:1)}return ke.cursor(t?s.to:s.from,t?-1:1)}function wx(n,e,t,i){let s=n.state.doc.lineAt(e.head),r=n.bidiSpans(s),o=n.textDirectionAt(s.from);for(let a=e,l=null;;){let h=g7(s,r,o,a,t),u=hA;if(!h){if(s.number==(t?n.state.doc.lines:1))return a;u=`
`,s=n.state.doc.line(s.number+(t?1:-1)),r=n.bidiSpans(s),h=n.visualLineSide(s,!t)}if(l){if(!l(u))return a}else{if(!i)return h;l=i(u)}a=h}}function R7(n,e,t){let i=n.state.charCategorizer(e),s=i(t);return r=>{let o=i(r);return s==er.Space&&(s=o),s==o}}function L7(n,e,t,i){let s=e.head,r=t?1:-1;if(s==(t?n.state.doc.length:0))return ke.cursor(s,e.assoc);let o=e.goalColumn,a,l=n.contentDOM.getBoundingClientRect(),h=n.coordsAtPos(s,e.assoc||-1),u=n.documentTop;if(h)o==null&&(o=h.left-l.left),a=r<0?h.top:h.bottom;else{let p=n.viewState.lineBlockAt(s);o==null&&(o=Math.min(l.right-l.left,n.defaultCharacterWidth*(s-p.from))),a=(r<0?p.top:p.bottom)+u}let c=l.left+o,f=i??n.viewState.heightOracle.textHeight>>1;for(let p=0;;p+=10){let b=a+(f+p)*r,y=kA(n,{x:c,y:b},!1,r);if(b<l.top||b>l.bottom||(r<0?y<s:y>s)){let _=n.docView.coordsForChar(y),T=!_||b<_.top?-1:1;return ke.cursor(y,T,void 0,o)}}}function Eh(n,e,t){for(;;){let i=0;for(let s of n)s.between(e-1,e+1,(r,o,a)=>{if(e>r&&e<o){let l=i||t||(e-r<o-e?-1:1);e=l<0?r:o,i=l}});if(!i)return e}}function EA(n,e){let t=null;for(let i=0;i<e.ranges.length;i++){let s=e.ranges[i],r=null;if(s.empty){let o=Eh(n,s.from,0);o!=s.from&&(r=ke.cursor(o,-1))}else{let o=Eh(n,s.from,-1),a=Eh(n,s.to,1);(o!=s.from||a!=s.to)&&(r=ke.range(s.from==s.anchor?o:a,s.from==s.head?o:a))}r&&(t||(t=e.ranges.slice()),t[i]=r)}return t?ke.create(t,e.mainIndex):e}function Nm(n,e,t){let i=Eh(n.state.facet(Cu).map(s=>s(n)),t.from,e.head>t.from?-1:1);return i==t.from?t:ke.cursor(i,i<t.from?1:-1)}const rh="￿";let $7=class{constructor(e,t){this.points=e,this.text="",this.lineSeparator=t.facet(Zt.lineSeparator)}append(e){this.text+=e}lineBreak(){this.text+=rh}readRange(e,t){if(!e)return this;let i=e.parentNode;for(let s=e;;){this.findPointBefore(i,s);let r=this.text.length;this.readNode(s);let o=s.nextSibling;if(o==t)break;let a=bt.get(s),l=bt.get(o);(a&&l?a.breakAfter:(a?a.breakAfter:Yd(s))||Yd(o)&&(s.nodeName!="BR"||s.cmIgnore)&&this.text.length>r)&&!B7(o,t)&&this.lineBreak(),s=o}return this.findPointBefore(i,t),this}readTextNode(e){let t=e.nodeValue;for(let i of this.points)i.node==e&&(i.pos=this.text.length+Math.min(i.offset,t.length));for(let i=0,s=this.lineSeparator?null:/\r\n?|\n/g;;){let r=-1,o=1,a;if(this.lineSeparator?(r=t.indexOf(this.lineSeparator,i),o=this.lineSeparator.length):(a=s.exec(t))&&(r=a.index,o=a[0].length),this.append(t.slice(i,r<0?t.length:r)),r<0)break;if(this.lineBreak(),o>1)for(let l of this.points)l.node==e&&l.pos>this.text.length&&(l.pos-=o-1);i=r+o}}readNode(e){if(e.cmIgnore)return;let t=bt.get(e),i=t&&t.overrideDOMText;if(i!=null){this.findPointInside(e,i.length);for(let s=i.iter();!s.next().done;)s.lineBreak?this.lineBreak():this.append(s.value)}else e.nodeType==3?this.readTextNode(e):e.nodeName=="BR"?e.nextSibling&&this.lineBreak():e.nodeType==1&&this.readRange(e.firstChild,null)}findPointBefore(e,t){for(let i of this.points)i.node==e&&e.childNodes[i.offset]==t&&(i.pos=this.text.length)}findPointInside(e,t){for(let i of this.points)(e.nodeType==3?i.node==e:e.contains(i.node))&&(i.pos=this.text.length+(Q7(e,i.node,i.offset)?t:0))}};function Q7(n,e,t){for(;;){if(!e||t<Ms(e))return!1;if(e==n)return!0;t=Io(e)+1,e=e.parentNode}}function B7(n,e){let t;for(;!(n==e||!n);n=n.nextSibling){let i=bt.get(n);if(!(i?.isWidget||n.cmIgnore))return!1;i&&(t||(t=[])).push(i)}if(t)for(let i of t){let s=i.overrideDOMText;if(s?.length)return!1}return!0}let _x=class{constructor(e,t){this.node=e,this.offset=t,this.pos=-1}};class N7{constructor(e,t,i,s){this.typeOver=s,this.bounds=null,this.text="",this.domChanged=t>-1;let{impreciseHead:r,impreciseAnchor:o}=e.docView;if(e.state.readOnly&&t>-1)this.newSel=null;else if(t>-1&&(this.bounds=e.docView.domBoundsAround(t,i,0))){let a=r||o?[]:V7(e),l=new $7(a,e.state);l.readRange(this.bounds.startDOM,this.bounds.endDOM),this.text=l.text,this.newSel=U7(a,this.bounds.from)}else{let a=e.observer.selectionRange,l=r&&r.node==a.focusNode&&r.offset==a.focusOffset||!I0(e.contentDOM,a.focusNode)?e.state.selection.main.head:e.docView.posFromDOM(a.focusNode,a.focusOffset),h=o&&o.node==a.anchorNode&&o.offset==a.anchorOffset||!I0(e.contentDOM,a.anchorNode)?e.state.selection.main.anchor:e.docView.posFromDOM(a.anchorNode,a.anchorOffset),u=e.viewport;if((be.ios||be.chrome)&&e.state.selection.main.empty&&l!=h&&(u.from>0||u.to<e.state.doc.length)){let c=Math.min(l,h),f=Math.max(l,h),p=u.from-c,b=u.to-f;(p==0||p==1||c==0)&&(b==0||b==-1||f==e.state.doc.length)&&(l=0,h=e.state.doc.length)}this.newSel=ke.single(h,l)}}}function AA(n,e){let t,{newSel:i}=e,s=n.state.selection.main,r=n.inputState.lastKeyTime>Date.now()-100?n.inputState.lastKeyCode:-1;if(e.bounds){let{from:o,to:a}=e.bounds,l=s.from,h=null;(r===8||be.android&&e.text.length<a-o)&&(l=s.to,h="end");let u=PA(n.state.doc.sliceString(o,a,rh),e.text,l-o,h);u&&(be.chrome&&r==13&&u.toB==u.from+2&&e.text.slice(u.from,u.toB)==rh+rh&&u.toB--,t={from:o+u.from,to:o+u.toA,insert:Ke.of(e.text.slice(u.from,u.toB).split(rh))})}else i&&(!n.hasFocus&&n.state.facet(Js)||i.main.eq(s))&&(i=null);if(!t&&!i)return!1;if(!t&&e.typeOver&&!s.empty&&i&&i.main.empty?t={from:s.from,to:s.to,insert:n.state.doc.slice(s.from,s.to)}:(be.mac||be.android)&&t&&t.from==t.to&&t.from==s.head-1&&/^\. ?$/.test(t.insert.toString())&&n.contentDOM.getAttribute("autocorrect")=="off"?(i&&t.insert.length==2&&(i=ke.single(i.main.anchor-1,i.main.head-1)),t={from:t.from,to:t.to,insert:Ke.of([t.insert.toString().replace("."," ")])}):t&&t.from>=s.from&&t.to<=s.to&&(t.from!=s.from||t.to!=s.to)&&s.to-s.from-(t.to-t.from)<=4?t={from:s.from,to:s.to,insert:n.state.doc.slice(s.from,t.from).append(t.insert).append(n.state.doc.slice(t.to,s.to))}:be.chrome&&t&&t.from==t.to&&t.from==s.head&&t.insert.toString()==`
 `&&n.lineWrapping&&(i&&(i=ke.single(i.main.anchor-1,i.main.head-1)),t={from:s.from,to:s.to,insert:Ke.of([" "])}),t)return bb(n,t,i,r);if(i&&!i.main.eq(s)){let o=!1,a="select";return n.inputState.lastSelectionTime>Date.now()-50&&(n.inputState.lastSelectionOrigin=="select"&&(o=!0),a=n.inputState.lastSelectionOrigin,a=="select.pointer"&&(i=EA(n.state.facet(Cu).map(l=>l(n)),i))),n.dispatch({selection:i,scrollIntoView:o,userEvent:a}),!0}else return!1}function bb(n,e,t,i=-1){if(be.ios&&n.inputState.flushIOSKey(e))return!0;let s=n.state.selection.main;if(be.android&&(e.to==s.to&&(e.from==s.from||e.from==s.from-1&&n.state.sliceDoc(e.from,s.from)==" ")&&e.insert.length==1&&e.insert.lines==2&&Ca(n.contentDOM,"Enter",13)||(e.from==s.from-1&&e.to==s.to&&e.insert.length==0||i==8&&e.insert.length<e.to-e.from&&e.to>s.head)&&Ca(n.contentDOM,"Backspace",8)||e.from==s.from&&e.to==s.to+1&&e.insert.length==0&&Ca(n.contentDOM,"Delete",46)))return!0;let r=e.insert.toString();n.inputState.composing>=0&&n.inputState.composing++;let o,a=()=>o||(o=F7(n,e,t));return n.state.facet(pA).some(l=>l(n,e.from,e.to,r,a))||n.dispatch(a()),!0}function F7(n,e,t){let i,s=n.state,r=s.selection.main,o=-1;if(e.from==e.to&&e.from<r.from||e.from>r.to){let l=e.from<r.from?-1:1,h=l<0?r.from:r.to,u=Eh(s.facet(Cu).map(c=>c(n)),h,l);e.from==u&&(o=u)}if(o>-1)i={changes:e,selection:ke.cursor(e.from+e.insert.length,-1)};else if(e.from>=r.from&&e.to<=r.to&&e.to-e.from>=(r.to-r.from)/3&&(!t||t.main.empty&&t.main.from==e.from+e.insert.length)&&n.inputState.composing<0){let l=r.from<e.from?s.sliceDoc(r.from,e.from):"",h=r.to>e.to?s.sliceDoc(e.to,r.to):"";i=s.replaceSelection(n.state.toText(l+e.insert.sliceString(0,void 0,n.state.lineBreak)+h))}else{let l=s.changes(e),h=t&&t.main.to<=l.newLength?t.main:void 0;if(s.selection.ranges.length>1&&n.inputState.composing>=0&&e.to<=r.to&&e.to>=r.to-10){let u=n.state.sliceDoc(e.from,e.to),c,f=t&&_A(n,t.main.head);if(f){let y=e.insert.length-(e.to-e.from);c={from:f.from,to:f.to-y}}else c=n.state.doc.lineAt(r.head);let p=r.to-e.to,b=r.to-r.from;i=s.changeByRange(y=>{if(y.from==r.from&&y.to==r.to)return{changes:l,range:h||y.map(l)};let _=y.to-p,T=_-u.length;if(y.to-y.from!=b||n.state.sliceDoc(T,_)!=u||y.to>=c.from&&y.from<=c.to)return{range:y};let w=s.changes({from:T,to:_,insert:e.insert}),v=y.to-r.to;return{changes:w,range:h?ke.range(Math.max(0,h.anchor+v),Math.max(0,h.head+v)):y.map(w)}})}else i={changes:l,selection:h&&s.selection.replaceRange(h)}}let a="input.type";return(n.composing||n.inputState.compositionPendingChange&&n.inputState.compositionEndedAt>Date.now()-50)&&(n.inputState.compositionPendingChange=!1,a+=".compose",n.inputState.compositionFirstChange&&(a+=".start",n.inputState.compositionFirstChange=!1)),s.update(i,{userEvent:a,scrollIntoView:!0})}function PA(n,e,t,i){let s=Math.min(n.length,e.length),r=0;for(;r<s&&n.charCodeAt(r)==e.charCodeAt(r);)r++;if(r==s&&n.length==e.length)return null;let o=n.length,a=e.length;for(;o>0&&a>0&&n.charCodeAt(o-1)==e.charCodeAt(a-1);)o--,a--;if(i=="end"){let l=Math.max(0,r-Math.min(o,a));t-=o+l-r}if(o<r&&n.length<e.length){let l=t<=r&&t>=o?r-t:0;r-=l,a=r+(a-o),o=r}else if(a<r){let l=t<=r&&t>=a?r-t:0;r-=l,o=r+(o-a),a=r}return{from:r,toA:o,toB:a}}function V7(n){let e=[];if(n.root.activeElement!=n.contentDOM)return e;let{anchorNode:t,anchorOffset:i,focusNode:s,focusOffset:r}=n.observer.selectionRange;return t&&(e.push(new _x(t,i)),(s!=t||r!=i)&&e.push(new _x(s,r))),e}function U7(n,e){if(n.length==0)return null;let t=n[0].pos,i=n.length==2?n[1].pos:t;return t>-1&&i>-1?ke.single(t+e,i+e):null}let q7=class{setSelectionOrigin(e){this.lastSelectionOrigin=e,this.lastSelectionTime=Date.now()}constructor(e){this.view=e,this.lastKeyCode=0,this.lastKeyTime=0,this.lastTouchTime=0,this.lastFocusTime=0,this.lastScrollTop=0,this.lastScrollLeft=0,this.pendingIOSKey=void 0,this.tabFocusMode=-1,this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastContextMenu=0,this.scrollHandlers=[],this.handlers=Object.create(null),this.composing=-1,this.compositionFirstChange=null,this.compositionEndedAt=0,this.compositionPendingKey=!1,this.compositionPendingChange=!1,this.mouseSelection=null,this.draggedContent=null,this.handleEvent=this.handleEvent.bind(this),this.notifiedFocused=e.hasFocus,be.safari&&e.contentDOM.addEventListener("input",()=>null),be.gecko&&r9(e.contentDOM.ownerDocument)}handleEvent(e){!G7(this.view,e)||this.ignoreDuringComposition(e)||e.type=="keydown"&&this.keydown(e)||(this.view.updateState!=0?Promise.resolve().then(()=>this.runHandlers(e.type,e)):this.runHandlers(e.type,e))}runHandlers(e,t){let i=this.handlers[e];if(i){for(let s of i.observers)s(this.view,t);for(let s of i.handlers){if(t.defaultPrevented)break;if(s(this.view,t)){t.preventDefault();break}}}}ensureHandlers(e){let t=z7(e),i=this.handlers,s=this.view.contentDOM;for(let r in t)if(r!="scroll"){let o=!t[r].handlers.length,a=i[r];a&&o!=!a.handlers.length&&(s.removeEventListener(r,this.handleEvent),a=null),a||s.addEventListener(r,this.handleEvent,{passive:o})}for(let r in i)r!="scroll"&&!t[r]&&s.removeEventListener(r,this.handleEvent);this.handlers=t}keydown(e){if(this.lastKeyCode=e.keyCode,this.lastKeyTime=Date.now(),e.keyCode==9&&this.tabFocusMode>-1&&(!this.tabFocusMode||Date.now()<=this.tabFocusMode))return!0;if(this.tabFocusMode>0&&e.keyCode!=27&&MA.indexOf(e.keyCode)<0&&(this.tabFocusMode=-1),be.android&&be.chrome&&!e.synthetic&&(e.keyCode==13||e.keyCode==8))return this.view.observer.delayAndroidKey(e.key,e.keyCode),!0;let t;return be.ios&&!e.synthetic&&!e.altKey&&!e.metaKey&&((t=DA.find(i=>i.keyCode==e.keyCode))&&!e.ctrlKey||j7.indexOf(e.key)>-1&&e.ctrlKey&&!e.shiftKey)?(this.pendingIOSKey=t||e,setTimeout(()=>this.flushIOSKey(),250),!0):(e.keyCode!=229&&this.view.observer.forceFlush(),!1)}flushIOSKey(e){let t=this.pendingIOSKey;return!t||t.key=="Enter"&&e&&e.from<e.to&&/^\S+$/.test(e.insert.toString())?!1:(this.pendingIOSKey=void 0,Ca(this.view.contentDOM,t.key,t.keyCode,t instanceof KeyboardEvent?t:void 0))}ignoreDuringComposition(e){return!/^key/.test(e.type)||e.synthetic?!1:this.composing>0?!0:be.safari&&!be.ios&&this.compositionPendingKey&&Date.now()-this.compositionEndedAt<100?(this.compositionPendingKey=!1,!0):!1}startMouseSelection(e){this.mouseSelection&&this.mouseSelection.destroy(),this.mouseSelection=e}update(e){this.view.observer.update(e),this.mouseSelection&&this.mouseSelection.update(e),this.draggedContent&&e.docChanged&&(this.draggedContent=this.draggedContent.map(e.changes)),e.transactions.length&&(this.lastKeyCode=this.lastSelectionTime=0)}destroy(){this.mouseSelection&&this.mouseSelection.destroy()}};function kx(n,e){return(t,i)=>{try{return e.call(n,i,t)}catch(s){vs(t.state,s)}}}function z7(n){let e=Object.create(null);function t(i){return e[i]||(e[i]={observers:[],handlers:[]})}for(let i of n){let s=i.spec,r=s&&s.plugin.domEventHandlers,o=s&&s.plugin.domEventObservers;if(r)for(let a in r){let l=r[a];l&&t(a).handlers.push(kx(i.value,l))}if(o)for(let a in o){let l=o[a];l&&t(a).observers.push(kx(i.value,l))}}for(let i in Zn)t(i).handlers.push(Zn[i]);for(let i in Dn)t(i).observers.push(Dn[i]);return e}const DA=[{key:"Backspace",keyCode:8,inputType:"deleteContentBackward"},{key:"Enter",keyCode:13,inputType:"insertParagraph"},{key:"Enter",keyCode:13,inputType:"insertLineBreak"},{key:"Delete",keyCode:46,inputType:"deleteContentForward"}],j7="dthko",MA=[16,17,18,20,91,92,224,225],Tc=6;function wc(n){return Math.max(0,n)*.7+8}function X7(n,e){return Math.max(Math.abs(n.clientX-e.clientX),Math.abs(n.clientY-e.clientY))}let H7=class{constructor(e,t,i,s){this.view=e,this.startEvent=t,this.style=i,this.mustSelect=s,this.scrollSpeed={x:0,y:0},this.scrolling=-1,this.lastEvent=t,this.scrollParents=J6(e.contentDOM),this.atoms=e.state.facet(Cu).map(o=>o(e));let r=e.contentDOM.ownerDocument;r.addEventListener("mousemove",this.move=this.move.bind(this)),r.addEventListener("mouseup",this.up=this.up.bind(this)),this.extend=t.shiftKey,this.multiple=e.state.facet(Zt.allowMultipleSelections)&&W7(e,t),this.dragging=Y7(e,t)&&LA(t)==1?null:!1}start(e){this.dragging===!1&&this.select(e)}move(e){if(e.buttons==0)return this.destroy();if(this.dragging||this.dragging==null&&X7(this.startEvent,e)<10)return;this.select(this.lastEvent=e);let t=0,i=0,s=0,r=0,o=this.view.win.innerWidth,a=this.view.win.innerHeight;this.scrollParents.x&&({left:s,right:o}=this.scrollParents.x.getBoundingClientRect()),this.scrollParents.y&&({top:r,bottom:a}=this.scrollParents.y.getBoundingClientRect());let l=TA(this.view);e.clientX-l.left<=s+Tc?t=-wc(s-e.clientX):e.clientX+l.right>=o-Tc&&(t=wc(e.clientX-o)),e.clientY-l.top<=r+Tc?i=-wc(r-e.clientY):e.clientY+l.bottom>=a-Tc&&(i=wc(e.clientY-a)),this.setScrollSpeed(t,i)}up(e){this.dragging==null&&this.select(this.lastEvent),this.dragging||e.preventDefault(),this.destroy()}destroy(){this.setScrollSpeed(0,0);let e=this.view.contentDOM.ownerDocument;e.removeEventListener("mousemove",this.move),e.removeEventListener("mouseup",this.up),this.view.inputState.mouseSelection=this.view.inputState.draggedContent=null}setScrollSpeed(e,t){this.scrollSpeed={x:e,y:t},e||t?this.scrolling<0&&(this.scrolling=setInterval(()=>this.scroll(),50)):this.scrolling>-1&&(clearInterval(this.scrolling),this.scrolling=-1)}scroll(){let{x:e,y:t}=this.scrollSpeed;e&&this.scrollParents.x&&(this.scrollParents.x.scrollLeft+=e,e=0),t&&this.scrollParents.y&&(this.scrollParents.y.scrollTop+=t,t=0),(e||t)&&this.view.win.scrollBy(e,t),this.dragging===!1&&this.select(this.lastEvent)}select(e){let{view:t}=this,i=EA(this.atoms,this.style.get(e,this.extend,this.multiple));(this.mustSelect||!i.eq(t.state.selection,this.dragging===!1))&&this.view.dispatch({selection:i,userEvent:"select.pointer"}),this.mustSelect=!1}update(e){e.transactions.some(t=>t.isUserEvent("input.type"))?this.destroy():this.style.update(e)&&setTimeout(()=>this.select(this.lastEvent),20)}};function W7(n,e){let t=n.state.facet(uA);return t.length?t[0](e):be.mac?e.metaKey:e.ctrlKey}function Z7(n,e){let t=n.state.facet(cA);return t.length?t[0](e):be.mac?!e.altKey:!e.ctrlKey}function Y7(n,e){let{main:t}=n.state.selection;if(t.empty)return!1;let i=Wh(n.root);if(!i||i.rangeCount==0)return!0;let s=i.getRangeAt(0).getClientRects();for(let r=0;r<s.length;r++){let o=s[r];if(o.left<=e.clientX&&o.right>=e.clientX&&o.top<=e.clientY&&o.bottom>=e.clientY)return!0}return!1}function G7(n,e){if(!e.bubbles)return!0;if(e.defaultPrevented)return!1;for(let t=e.target,i;t!=n.contentDOM;t=t.parentNode)if(!t||t.nodeType==11||(i=bt.get(t))&&i.ignoreEvent(e))return!1;return!0}const Zn=Object.create(null),Dn=Object.create(null),IA=be.ie&&be.ie_version<15||be.ios&&be.webkit_version<604;function K7(n){let e=n.dom.parentNode;if(!e)return;let t=e.appendChild(document.createElement("textarea"));t.style.cssText="position: fixed; left: -10000px; top: 10px",t.focus(),setTimeout(()=>{n.focus(),t.remove(),RA(n,t.value)},50)}function hp(n,e,t){for(let i of n.facet(e))t=i(t,n);return t}function RA(n,e){e=hp(n.state,gb,e);let{state:t}=n,i,s=1,r=t.toText(e),o=r.lines==t.selection.ranges.length;if(Y0!=null&&t.selection.ranges.every(l=>l.empty)&&Y0==r.toString()){let l=-1;i=t.changeByRange(h=>{let u=t.doc.lineAt(h.from);if(u.from==l)return{range:h};l=u.from;let c=t.toText((o?r.line(s++).text:e)+t.lineBreak);return{changes:{from:u.from,insert:c},range:ke.cursor(h.from+c.length)}})}else o?i=t.changeByRange(l=>{let h=r.line(s++);return{changes:{from:l.from,to:l.to,insert:h.text},range:ke.cursor(l.from+h.length)}}):i=t.replaceSelection(r);n.dispatch(i,{userEvent:"input.paste",scrollIntoView:!0})}Dn.scroll=n=>{n.inputState.lastScrollTop=n.scrollDOM.scrollTop,n.inputState.lastScrollLeft=n.scrollDOM.scrollLeft};Zn.keydown=(n,e)=>(n.inputState.setSelectionOrigin("select"),e.keyCode==27&&n.inputState.tabFocusMode!=0&&(n.inputState.tabFocusMode=Date.now()+2e3),!1);Dn.touchstart=(n,e)=>{n.inputState.lastTouchTime=Date.now(),n.inputState.setSelectionOrigin("select.pointer")};Dn.touchmove=n=>{n.inputState.setSelectionOrigin("select.pointer")};Zn.mousedown=(n,e)=>{if(n.observer.flush(),n.inputState.lastTouchTime>Date.now()-2e3)return!1;let t=null;for(let i of n.state.facet(dA))if(t=i(n,e),t)break;if(!t&&e.button==0&&(t=t9(n,e)),t){let i=!n.hasFocus;n.inputState.startMouseSelection(new H7(n,e,t,i)),i&&n.observer.ignore(()=>{UE(n.contentDOM);let r=n.root.activeElement;r&&!r.contains(n.contentDOM)&&r.blur()});let s=n.inputState.mouseSelection;if(s)return s.start(e),s.dragging===!1}else n.inputState.setSelectionOrigin("select.pointer");return!1};function Cx(n,e,t,i){if(i==1)return ke.cursor(e,t);if(i==2)return C7(n.state,e,t);{let s=Ai.find(n.docView,e),r=n.state.doc.lineAt(s?s.posAtEnd:e),o=s?s.posAtStart:r.from,a=s?s.posAtEnd:r.to;return a<n.state.doc.length&&a==r.to&&a++,ke.range(o,a)}}let Ex=(n,e,t)=>e>=t.top&&e<=t.bottom&&n>=t.left&&n<=t.right;function J7(n,e,t,i){let s=Ai.find(n.docView,e);if(!s)return 1;let r=e-s.posAtStart;if(r==0)return 1;if(r==s.length)return-1;let o=s.coordsAt(r,-1);if(o&&Ex(t,i,o))return-1;let a=s.coordsAt(r,1);return a&&Ex(t,i,a)?1:o&&o.bottom>=i?-1:1}function Ax(n,e){let t=n.posAtCoords({x:e.clientX,y:e.clientY},!1);return{pos:t,bias:J7(n,t,e.clientX,e.clientY)}}const e9=be.ie&&be.ie_version<=11;let Px=null,Dx=0,Mx=0;function LA(n){if(!e9)return n.detail;let e=Px,t=Mx;return Px=n,Mx=Date.now(),Dx=!e||t>Date.now()-400&&Math.abs(e.clientX-n.clientX)<2&&Math.abs(e.clientY-n.clientY)<2?(Dx+1)%3:1}function t9(n,e){let t=Ax(n,e),i=LA(e),s=n.state.selection;return{update(r){r.docChanged&&(t.pos=r.changes.mapPos(t.pos),s=s.map(r.changes))},get(r,o,a){let l=Ax(n,r),h,u=Cx(n,l.pos,l.bias,i);if(t.pos!=l.pos&&!o){let c=Cx(n,t.pos,t.bias,i),f=Math.min(c.from,u.from),p=Math.max(c.to,u.to);u=f<u.from?ke.range(f,p):ke.range(p,f)}return o?s.replaceRange(s.main.extend(u.from,u.to)):a&&i==1&&s.ranges.length>1&&(h=i9(s,l.pos))?h:a?s.addRange(u):ke.create([u])}}}function i9(n,e){for(let t=0;t<n.ranges.length;t++){let{from:i,to:s}=n.ranges[t];if(i<=e&&s>=e)return ke.create(n.ranges.slice(0,t).concat(n.ranges.slice(t+1)),n.mainIndex==t?0:n.mainIndex-(n.mainIndex>t?1:0))}return null}Zn.dragstart=(n,e)=>{let{selection:{main:t}}=n.state;if(e.target.draggable){let s=n.docView.nearest(e.target);if(s&&s.isWidget){let r=s.posAtStart,o=r+s.length;(r>=t.to||o<=t.from)&&(t=ke.range(r,o))}}let{inputState:i}=n;return i.mouseSelection&&(i.mouseSelection.dragging=!0),i.draggedContent=t,e.dataTransfer&&(e.dataTransfer.setData("Text",hp(n.state,Ob,n.state.sliceDoc(t.from,t.to))),e.dataTransfer.effectAllowed="copyMove"),!1};Zn.dragend=n=>(n.inputState.draggedContent=null,!1);function Ix(n,e,t,i){if(t=hp(n.state,gb,t),!t)return;let s=n.posAtCoords({x:e.clientX,y:e.clientY},!1),{draggedContent:r}=n.inputState,o=i&&r&&Z7(n,e)?{from:r.from,to:r.to}:null,a={from:s,insert:t},l=n.state.changes(o?[o,a]:a);n.focus(),n.dispatch({changes:l,selection:{anchor:l.mapPos(s,-1),head:l.mapPos(s,1)},userEvent:o?"move.drop":"input.drop"}),n.inputState.draggedContent=null}Zn.drop=(n,e)=>{if(!e.dataTransfer)return!1;if(n.state.readOnly)return!0;let t=e.dataTransfer.files;if(t&&t.length){let i=Array(t.length),s=0,r=()=>{++s==t.length&&Ix(n,e,i.filter(o=>o!=null).join(n.state.lineBreak),!1)};for(let o=0;o<t.length;o++){let a=new FileReader;a.onerror=r,a.onload=()=>{/[\x00-\x08\x0e-\x1f]{2}/.test(a.result)||(i[o]=a.result),r()},a.readAsText(t[o])}return!0}else{let i=e.dataTransfer.getData("Text");if(i)return Ix(n,e,i,!0),!0}return!1};Zn.paste=(n,e)=>{if(n.state.readOnly)return!0;n.observer.flush();let t=IA?null:e.clipboardData;return t?(RA(n,t.getData("text/plain")||t.getData("text/uri-list")),!0):(K7(n),!1)};function n9(n,e){let t=n.dom.parentNode;if(!t)return;let i=t.appendChild(document.createElement("textarea"));i.style.cssText="position: fixed; left: -10000px; top: 10px",i.value=e,i.focus(),i.selectionEnd=e.length,i.selectionStart=0,setTimeout(()=>{i.remove(),n.focus()},50)}function s9(n){let e=[],t=[],i=!1;for(let s of n.selection.ranges)s.empty||(e.push(n.sliceDoc(s.from,s.to)),t.push(s));if(!e.length){let s=-1;for(let{from:r}of n.selection.ranges){let o=n.doc.lineAt(r);o.number>s&&(e.push(o.text),t.push({from:o.from,to:Math.min(n.doc.length,o.to+1)})),s=o.number}i=!0}return{text:hp(n,Ob,e.join(n.lineBreak)),ranges:t,linewise:i}}let Y0=null;Zn.copy=Zn.cut=(n,e)=>{let{text:t,ranges:i,linewise:s}=s9(n.state);if(!t&&!s)return!1;Y0=s?t:null,e.type=="cut"&&!n.state.readOnly&&n.dispatch({changes:i,scrollIntoView:!0,userEvent:"delete.cut"});let r=IA?null:e.clipboardData;return r?(r.clearData(),r.setData("text/plain",t),!0):(n9(n,t),!1)};const $A=Fo.define();function QA(n,e){let t=[];for(let i of n.facet(mA)){let s=i(n,e);s&&t.push(s)}return t.length?n.update({effects:t,annotations:$A.of(!0)}):null}function BA(n){setTimeout(()=>{let e=n.hasFocus;if(e!=n.inputState.notifiedFocused){let t=QA(n.state,e);t?n.dispatch(t):n.update([])}},10)}Dn.focus=n=>{n.inputState.lastFocusTime=Date.now(),!n.scrollDOM.scrollTop&&(n.inputState.lastScrollTop||n.inputState.lastScrollLeft)&&(n.scrollDOM.scrollTop=n.inputState.lastScrollTop,n.scrollDOM.scrollLeft=n.inputState.lastScrollLeft),BA(n)};Dn.blur=n=>{n.observer.clearSelectionRange(),BA(n)};Dn.compositionstart=Dn.compositionupdate=n=>{n.observer.editContext||(n.inputState.compositionFirstChange==null&&(n.inputState.compositionFirstChange=!0),n.inputState.composing<0&&(n.inputState.composing=0))};Dn.compositionend=n=>{n.observer.editContext||(n.inputState.composing=-1,n.inputState.compositionEndedAt=Date.now(),n.inputState.compositionPendingKey=!0,n.inputState.compositionPendingChange=n.observer.pendingRecords().length>0,n.inputState.compositionFirstChange=null,be.chrome&&be.android?n.observer.flushSoon():n.inputState.compositionPendingChange?Promise.resolve().then(()=>n.observer.flush()):setTimeout(()=>{n.inputState.composing<0&&n.docView.hasComposition&&n.update([])},50))};Dn.contextmenu=n=>{n.inputState.lastContextMenu=Date.now()};Zn.beforeinput=(n,e)=>{var t,i;if(e.inputType=="insertReplacementText"&&n.observer.editContext){let r=(t=e.dataTransfer)===null||t===void 0?void 0:t.getData("text/plain"),o=e.getTargetRanges();if(r&&o.length){let a=o[0],l=n.posAtDOM(a.startContainer,a.startOffset),h=n.posAtDOM(a.endContainer,a.endOffset);return bb(n,{from:l,to:h,insert:n.state.toText(r)},null),!0}}let s;if(be.chrome&&be.android&&(s=DA.find(r=>r.inputType==e.inputType))&&(n.observer.delayAndroidKey(s.key,s.keyCode),s.key=="Backspace"||s.key=="Delete")){let r=((i=window.visualViewport)===null||i===void 0?void 0:i.height)||0;setTimeout(()=>{var o;(((o=window.visualViewport)===null||o===void 0?void 0:o.height)||0)>r+10&&n.hasFocus&&(n.contentDOM.blur(),n.focus())},100)}return be.ios&&e.inputType=="deleteContentForward"&&n.observer.flushSoon(),be.safari&&e.inputType=="insertText"&&n.inputState.composing>=0&&setTimeout(()=>Dn.compositionend(n,e),20),!1};const Rx=new Set;function r9(n){Rx.has(n)||(Rx.add(n),n.addEventListener("copy",()=>{}),n.addEventListener("cut",()=>{}))}const Lx=["pre-wrap","normal","pre-line","break-spaces"];let Ha=!1;function $x(){Ha=!1}let o9=class{constructor(e){this.lineWrapping=e,this.doc=Ke.empty,this.heightSamples={},this.lineHeight=14,this.charWidth=7,this.textHeight=14,this.lineLength=30}heightForGap(e,t){let i=this.doc.lineAt(t).number-this.doc.lineAt(e).number+1;return this.lineWrapping&&(i+=Math.max(0,Math.ceil((t-e-i*this.lineLength*.5)/this.lineLength))),this.lineHeight*i}heightForLine(e){return this.lineWrapping?(1+Math.max(0,Math.ceil((e-this.lineLength)/Math.max(1,this.lineLength-5))))*this.lineHeight:this.lineHeight}setDoc(e){return this.doc=e,this}mustRefreshForWrapping(e){return Lx.indexOf(e)>-1!=this.lineWrapping}mustRefreshForHeights(e){let t=!1;for(let i=0;i<e.length;i++){let s=e[i];s<0?i++:this.heightSamples[Math.floor(s*10)]||(t=!0,this.heightSamples[Math.floor(s*10)]=!0)}return t}refresh(e,t,i,s,r,o){let a=Lx.indexOf(e)>-1,l=Math.round(t)!=Math.round(this.lineHeight)||this.lineWrapping!=a;if(this.lineWrapping=a,this.lineHeight=t,this.charWidth=i,this.textHeight=s,this.lineLength=r,l){this.heightSamples={};for(let h=0;h<o.length;h++){let u=o[h];u<0?h++:this.heightSamples[Math.floor(u*10)]=!0}}return l}},a9=class{constructor(e,t){this.from=e,this.heights=t,this.index=0}get more(){return this.index<this.heights.length}},Ar=class NA{constructor(e,t,i,s,r){this.from=e,this.length=t,this.top=i,this.height=s,this._content=r}get type(){return typeof this._content=="number"?_s.Text:Array.isArray(this._content)?this._content:this._content.type}get to(){return this.from+this.length}get bottom(){return this.top+this.height}get widget(){return this._content instanceof ja?this._content.widget:null}get widgetLineBreaks(){return typeof this._content=="number"?this._content:0}join(e){let t=(Array.isArray(this._content)?this._content:[this]).concat(Array.isArray(e._content)?e._content:[e]);return new NA(this.from,this.length+e.length,this.top,this.height+e.height,t)}};var Ot=(function(n){return n[n.ByPos=0]="ByPos",n[n.ByHeight=1]="ByHeight",n[n.ByPosNoHeight=2]="ByPosNoHeight",n})(Ot||(Ot={}));const ad=.001;let Xn=class ld{constructor(e,t,i=2){this.length=e,this.height=t,this.flags=i}get outdated(){return(this.flags&2)>0}set outdated(e){this.flags=(e?2:0)|this.flags&-3}setHeight(e){this.height!=e&&(Math.abs(this.height-e)>ad&&(Ha=!0),this.height=e)}replace(e,t,i){return ld.of(i)}decomposeLeft(e,t){t.push(this)}decomposeRight(e,t){t.push(this)}applyChanges(e,t,i,s){let r=this,o=i.doc;for(let a=s.length-1;a>=0;a--){let{fromA:l,toA:h,fromB:u,toB:c}=s[a],f=r.lineAt(l,Ot.ByPosNoHeight,i.setDoc(t),0,0),p=f.to>=h?f:r.lineAt(h,Ot.ByPosNoHeight,i,0,0);for(c+=p.to-h,h=p.to;a>0&&f.from<=s[a-1].toA;)l=s[a-1].fromA,u=s[a-1].fromB,a--,l<f.from&&(f=r.lineAt(l,Ot.ByPosNoHeight,i,0,0));u+=f.from-l,l=f.from;let b=u9.build(i.setDoc(o),e,u,c);r=Jd(r,r.replace(l,h,b))}return r.updateHeight(i,0)}static empty(){return new cs(0,0)}static of(e){if(e.length==1)return e[0];let t=0,i=e.length,s=0,r=0;for(;;)if(t==i)if(s>r*2){let a=e[t-1];a.break?e.splice(--t,1,a.left,null,a.right):e.splice(--t,1,a.left,a.right),i+=1+a.break,s-=a.size}else if(r>s*2){let a=e[i];a.break?e.splice(i,1,a.left,null,a.right):e.splice(i,1,a.left,a.right),i+=2+a.break,r-=a.size}else break;else if(s<r){let a=e[t++];a&&(s+=a.size)}else{let a=e[--i];a&&(r+=a.size)}let o=0;return e[t-1]==null?(o=1,t--):e[t]==null&&(o=1,i++),new l9(ld.of(e.slice(0,t)),o,ld.of(e.slice(i)))}};function Jd(n,e){return n==e?n:(n.constructor!=e.constructor&&(Ha=!0),e)}Xn.prototype.size=1;let FA=class extends Xn{constructor(e,t,i){super(e,t),this.deco=i}blockAt(e,t,i,s){return new Ar(s,this.length,i,this.height,this.deco||0)}lineAt(e,t,i,s,r){return this.blockAt(0,i,s,r)}forEachLine(e,t,i,s,r,o){e<=r+this.length&&t>=r&&o(this.blockAt(0,i,s,r))}updateHeight(e,t=0,i=!1,s){return s&&s.from<=t&&s.more&&this.setHeight(s.heights[s.index++]),this.outdated=!1,this}toString(){return`block(${this.length})`}},cs=class G0 extends FA{constructor(e,t){super(e,t,null),this.collapsed=0,this.widgetHeight=0,this.breaks=0}blockAt(e,t,i,s){return new Ar(s,this.length,i,this.height,this.breaks)}replace(e,t,i){let s=i[0];return i.length==1&&(s instanceof G0||s instanceof Ea&&s.flags&4)&&Math.abs(this.length-s.length)<10?(s instanceof Ea?s=new G0(s.length,this.height):s.height=this.height,this.outdated||(s.outdated=!1),s):Xn.of(i)}updateHeight(e,t=0,i=!1,s){return s&&s.from<=t&&s.more?this.setHeight(s.heights[s.index++]):(i||this.outdated)&&this.setHeight(Math.max(this.widgetHeight,e.heightForLine(this.length-this.collapsed))+this.breaks*e.lineHeight),this.outdated=!1,this}toString(){return`line(${this.length}${this.collapsed?-this.collapsed:""}${this.widgetHeight?":"+this.widgetHeight:""})`}},Ea=class Vn extends Xn{constructor(e){super(e,0)}heightMetrics(e,t){let i=e.doc.lineAt(t).number,s=e.doc.lineAt(t+this.length).number,r=s-i+1,o,a=0;if(e.lineWrapping){let l=Math.min(this.height,e.lineHeight*r);o=l/r,this.length>r+1&&(a=(this.height-l)/(this.length-r-1))}else o=this.height/r;return{firstLine:i,lastLine:s,perLine:o,perChar:a}}blockAt(e,t,i,s){let{firstLine:r,lastLine:o,perLine:a,perChar:l}=this.heightMetrics(t,s);if(t.lineWrapping){let h=s+(e<t.lineHeight?0:Math.round(Math.max(0,Math.min(1,(e-i)/this.height))*this.length)),u=t.doc.lineAt(h),c=a+u.length*l,f=Math.max(i,e-c/2);return new Ar(u.from,u.length,f,c,0)}else{let h=Math.max(0,Math.min(o-r,Math.floor((e-i)/a))),{from:u,length:c}=t.doc.line(r+h);return new Ar(u,c,i+a*h,a,0)}}lineAt(e,t,i,s,r){if(t==Ot.ByHeight)return this.blockAt(e,i,s,r);if(t==Ot.ByPosNoHeight){let{from:p,to:b}=i.doc.lineAt(e);return new Ar(p,b-p,0,0,0)}let{firstLine:o,perLine:a,perChar:l}=this.heightMetrics(i,r),h=i.doc.lineAt(e),u=a+h.length*l,c=h.number-o,f=s+a*c+l*(h.from-r-c);return new Ar(h.from,h.length,Math.max(s,Math.min(f,s+this.height-u)),u,0)}forEachLine(e,t,i,s,r,o){e=Math.max(e,r),t=Math.min(t,r+this.length);let{firstLine:a,perLine:l,perChar:h}=this.heightMetrics(i,r);for(let u=e,c=s;u<=t;){let f=i.doc.lineAt(u);if(u==e){let b=f.number-a;c+=l*b+h*(e-r-b)}let p=l+h*f.length;o(new Ar(f.from,f.length,c,p,0)),c+=p,u=f.to+1}}replace(e,t,i){let s=this.length-t;if(s>0){let r=i[i.length-1];r instanceof Vn?i[i.length-1]=new Vn(r.length+s):i.push(null,new Vn(s-1))}if(e>0){let r=i[0];r instanceof Vn?i[0]=new Vn(e+r.length):i.unshift(new Vn(e-1),null)}return Xn.of(i)}decomposeLeft(e,t){t.push(new Vn(e-1),null)}decomposeRight(e,t){t.push(null,new Vn(this.length-e-1))}updateHeight(e,t=0,i=!1,s){let r=t+this.length;if(s&&s.from<=t+this.length&&s.more){let o=[],a=Math.max(t,s.from),l=-1;for(s.from>t&&o.push(new Vn(s.from-t-1).updateHeight(e,t));a<=r&&s.more;){let u=e.doc.lineAt(a).length;o.length&&o.push(null);let c=s.heights[s.index++];l==-1?l=c:Math.abs(c-l)>=ad&&(l=-2);let f=new cs(u,c);f.outdated=!1,o.push(f),a+=u+1}a<=r&&o.push(null,new Vn(r-a).updateHeight(e,a));let h=Xn.of(o);return(l<0||Math.abs(h.height-this.height)>=ad||Math.abs(l-this.heightMetrics(e,t).perLine)>=ad)&&(Ha=!0),Jd(this,h)}else(i||this.outdated)&&(this.setHeight(e.heightForGap(t,t+this.length)),this.outdated=!1);return this}toString(){return`gap(${this.length})`}},l9=class extends Xn{constructor(e,t,i){super(e.length+t+i.length,e.height+i.height,t|(e.outdated||i.outdated?2:0)),this.left=e,this.right=i,this.size=e.size+i.size}get break(){return this.flags&1}blockAt(e,t,i,s){let r=i+this.left.height;return e<r?this.left.blockAt(e,t,i,s):this.right.blockAt(e,t,r,s+this.left.length+this.break)}lineAt(e,t,i,s,r){let o=s+this.left.height,a=r+this.left.length+this.break,l=t==Ot.ByHeight?e<o:e<a,h=l?this.left.lineAt(e,t,i,s,r):this.right.lineAt(e,t,i,o,a);if(this.break||(l?h.to<a:h.from>a))return h;let u=t==Ot.ByPosNoHeight?Ot.ByPosNoHeight:Ot.ByPos;return l?h.join(this.right.lineAt(a,u,i,o,a)):this.left.lineAt(a,u,i,s,r).join(h)}forEachLine(e,t,i,s,r,o){let a=s+this.left.height,l=r+this.left.length+this.break;if(this.break)e<l&&this.left.forEachLine(e,t,i,s,r,o),t>=l&&this.right.forEachLine(e,t,i,a,l,o);else{let h=this.lineAt(l,Ot.ByPos,i,s,r);e<h.from&&this.left.forEachLine(e,h.from-1,i,s,r,o),h.to>=e&&h.from<=t&&o(h),t>h.to&&this.right.forEachLine(h.to+1,t,i,a,l,o)}}replace(e,t,i){let s=this.left.length+this.break;if(t<s)return this.balanced(this.left.replace(e,t,i),this.right);if(e>this.left.length)return this.balanced(this.left,this.right.replace(e-s,t-s,i));let r=[];e>0&&this.decomposeLeft(e,r);let o=r.length;for(let a of i)r.push(a);if(e>0&&Qx(r,o-1),t<this.length){let a=r.length;this.decomposeRight(t,r),Qx(r,a)}return Xn.of(r)}decomposeLeft(e,t){let i=this.left.length;if(e<=i)return this.left.decomposeLeft(e,t);t.push(this.left),this.break&&(i++,e>=i&&t.push(null)),e>i&&this.right.decomposeLeft(e-i,t)}decomposeRight(e,t){let i=this.left.length,s=i+this.break;if(e>=s)return this.right.decomposeRight(e-s,t);e<i&&this.left.decomposeRight(e,t),this.break&&e<s&&t.push(null),t.push(this.right)}balanced(e,t){return e.size>2*t.size||t.size>2*e.size?Xn.of(this.break?[e,null,t]:[e,t]):(this.left=Jd(this.left,e),this.right=Jd(this.right,t),this.setHeight(e.height+t.height),this.outdated=e.outdated||t.outdated,this.size=e.size+t.size,this.length=e.length+this.break+t.length,this)}updateHeight(e,t=0,i=!1,s){let{left:r,right:o}=this,a=t+r.length+this.break,l=null;return s&&s.from<=t+r.length&&s.more?l=r=r.updateHeight(e,t,i,s):r.updateHeight(e,t,i),s&&s.from<=a+o.length&&s.more?l=o=o.updateHeight(e,a,i,s):o.updateHeight(e,a,i),l?this.balanced(r,o):(this.height=this.left.height+this.right.height,this.outdated=!1,this)}toString(){return this.left+(this.break?" ":"-")+this.right}};function Qx(n,e){let t,i;n[e]==null&&(t=n[e-1])instanceof Ea&&(i=n[e+1])instanceof Ea&&n.splice(e-1,3,new Ea(t.length+1+i.length))}const h9=5;let u9=class VA{constructor(e,t){this.pos=e,this.oracle=t,this.nodes=[],this.lineStart=-1,this.lineEnd=-1,this.covering=null,this.writtenTo=e}get isCovered(){return this.covering&&this.nodes[this.nodes.length-1]==this.covering}span(e,t){if(this.lineStart>-1){let i=Math.min(t,this.lineEnd),s=this.nodes[this.nodes.length-1];s instanceof cs?s.length+=i-this.pos:(i>this.pos||!this.isCovered)&&this.nodes.push(new cs(i-this.pos,-1)),this.writtenTo=i,t>i&&(this.nodes.push(null),this.writtenTo++,this.lineStart=-1)}this.pos=t}point(e,t,i){if(e<t||i.heightRelevant){let s=i.widget?i.widget.estimatedHeight:0,r=i.widget?i.widget.lineBreaks:0;s<0&&(s=this.oracle.lineHeight);let o=t-e;i.block?this.addBlock(new FA(o,s,i)):(o||r||s>=h9)&&this.addLineDeco(s,r,o)}else t>e&&this.span(e,t);this.lineEnd>-1&&this.lineEnd<this.pos&&(this.lineEnd=this.oracle.doc.lineAt(this.pos).to)}enterLine(){if(this.lineStart>-1)return;let{from:e,to:t}=this.oracle.doc.lineAt(this.pos);this.lineStart=e,this.lineEnd=t,this.writtenTo<e&&((this.writtenTo<e-1||this.nodes[this.nodes.length-1]==null)&&this.nodes.push(this.blankContent(this.writtenTo,e-1)),this.nodes.push(null)),this.pos>e&&this.nodes.push(new cs(this.pos-e,-1)),this.writtenTo=this.pos}blankContent(e,t){let i=new Ea(t-e);return this.oracle.doc.lineAt(e).to==t&&(i.flags|=4),i}ensureLine(){this.enterLine();let e=this.nodes.length?this.nodes[this.nodes.length-1]:null;if(e instanceof cs)return e;let t=new cs(0,-1);return this.nodes.push(t),t}addBlock(e){this.enterLine();let t=e.deco;t&&t.startSide>0&&!this.isCovered&&this.ensureLine(),this.nodes.push(e),this.writtenTo=this.pos=this.pos+e.length,t&&t.endSide>0&&(this.covering=e)}addLineDeco(e,t,i){let s=this.ensureLine();s.length+=i,s.collapsed+=i,s.widgetHeight=Math.max(s.widgetHeight,e),s.breaks+=t,this.writtenTo=this.pos=this.pos+i}finish(e){let t=this.nodes.length==0?null:this.nodes[this.nodes.length-1];this.lineStart>-1&&!(t instanceof cs)&&!this.isCovered?this.nodes.push(new cs(0,-1)):(this.writtenTo<this.pos||t==null)&&this.nodes.push(this.blankContent(this.writtenTo,this.pos));let i=e;for(let s of this.nodes)s instanceof cs&&s.updateHeight(this.oracle,i),i+=s?s.length:1;return this.nodes}static build(e,t,i,s){let r=new VA(i,e);return xi.spans(t,i,s,r,0),r.finish(i)}};function c9(n,e,t){let i=new d9;return xi.compare(n,e,t,i,0),i.changes}let d9=class{constructor(){this.changes=[]}compareRange(){}comparePoint(e,t,i,s){(e<t||i&&i.heightRelevant||s&&s.heightRelevant)&&sd(e,t,this.changes,5)}};function f9(n,e){let t=n.getBoundingClientRect(),i=n.ownerDocument,s=i.defaultView||window,r=Math.max(0,t.left),o=Math.min(s.innerWidth,t.right),a=Math.max(0,t.top),l=Math.min(s.innerHeight,t.bottom);for(let h=n.parentNode;h&&h!=i.body;)if(h.nodeType==1){let u=h,c=window.getComputedStyle(u);if((u.scrollHeight>u.clientHeight||u.scrollWidth>u.clientWidth)&&c.overflow!="visible"){let f=u.getBoundingClientRect();r=Math.max(r,f.left),o=Math.min(o,f.right),a=Math.max(a,f.top),l=Math.min(h==n.parentNode?s.innerHeight:l,f.bottom)}h=c.position=="absolute"||c.position=="fixed"?u.offsetParent:u.parentNode}else if(h.nodeType==11)h=h.host;else break;return{left:r-t.left,right:Math.max(r,o)-t.left,top:a-(t.top+e),bottom:Math.max(a,l)-(t.top+e)}}function p9(n){let e=n.getBoundingClientRect(),t=n.ownerDocument.defaultView||window;return e.left<t.innerWidth&&e.right>0&&e.top<t.innerHeight&&e.bottom>0}function m9(n,e){let t=n.getBoundingClientRect();return{left:0,right:t.right-t.left,top:e,bottom:t.bottom-(t.top+e)}}let Fm=class{constructor(e,t,i,s){this.from=e,this.to=t,this.size=i,this.displaySize=s}static same(e,t){if(e.length!=t.length)return!1;for(let i=0;i<e.length;i++){let s=e[i],r=t[i];if(s.from!=r.from||s.to!=r.to||s.size!=r.size)return!1}return!0}draw(e,t){return Ft.replace({widget:new g9(this.displaySize*(t?e.scaleY:e.scaleX),t)}).range(this.from,this.to)}},g9=class extends lp{constructor(e,t){super(),this.size=e,this.vertical=t}eq(e){return e.size==this.size&&e.vertical==this.vertical}toDOM(){let e=document.createElement("div");return this.vertical?e.style.height=this.size+"px":(e.style.width=this.size+"px",e.style.height="2px",e.style.display="inline-block"),e}get estimatedHeight(){return this.vertical?this.size:-1}},Bx=class{constructor(e){this.state=e,this.pixelViewport={left:0,right:window.innerWidth,top:0,bottom:0},this.inView=!0,this.paddingTop=0,this.paddingBottom=0,this.contentDOMWidth=0,this.contentDOMHeight=0,this.editorHeight=0,this.editorWidth=0,this.scrollTop=0,this.scrolledToBottom=!1,this.scaleX=1,this.scaleY=1,this.scrollAnchorPos=0,this.scrollAnchorHeight=-1,this.scaler=Nx,this.scrollTarget=null,this.printing=!1,this.mustMeasureContent=!0,this.defaultTextDirection=li.LTR,this.visibleRanges=[],this.mustEnforceCursorAssoc=!1;let t=e.facet(yb).some(i=>typeof i!="function"&&i.class=="cm-lineWrapping");this.heightOracle=new o9(t),this.stateDeco=e.facet(Yh).filter(i=>typeof i!="function"),this.heightMap=Xn.empty().applyChanges(this.stateDeco,Ke.empty,this.heightOracle.setDoc(e.doc),[new Qr(0,0,0,e.doc.length)]);for(let i=0;i<2&&(this.viewport=this.getViewport(0,null),!!this.updateForViewport());i++);this.updateViewportLines(),this.lineGaps=this.ensureLineGaps([]),this.lineGapDeco=Ft.set(this.lineGaps.map(i=>i.draw(this,!1))),this.computeVisibleRanges()}updateForViewport(){let e=[this.viewport],{main:t}=this.state.selection;for(let i=0;i<=1;i++){let s=i?t.head:t.anchor;if(!e.some(({from:r,to:o})=>s>=r&&s<=o)){let{from:r,to:o}=this.lineBlockAt(s);e.push(new _c(r,o))}}return this.viewports=e.sort((i,s)=>i.from-s.from),this.updateScaler()}updateScaler(){let e=this.scaler;return this.scaler=this.heightMap.height<=7e6?Nx:new b9(this.heightOracle,this.heightMap,this.viewports),e.eq(this.scaler)?0:2}updateViewportLines(){this.viewportLines=[],this.heightMap.forEachLine(this.viewport.from,this.viewport.to,this.heightOracle.setDoc(this.state.doc),0,0,e=>{this.viewportLines.push(oh(e,this.scaler))})}update(e,t=null){this.state=e.state;let i=this.stateDeco;this.stateDeco=this.state.facet(Yh).filter(u=>typeof u!="function");let s=e.changedRanges,r=Qr.extendWithRanges(s,c9(i,this.stateDeco,e?e.changes:Ds.empty(this.state.doc.length))),o=this.heightMap.height,a=this.scrolledToBottom?null:this.scrollAnchorAt(this.scrollTop);$x(),this.heightMap=this.heightMap.applyChanges(this.stateDeco,e.startState.doc,this.heightOracle.setDoc(this.state.doc),r),(this.heightMap.height!=o||Ha)&&(e.flags|=2),a?(this.scrollAnchorPos=e.changes.mapPos(a.from,-1),this.scrollAnchorHeight=a.top):(this.scrollAnchorPos=-1,this.scrollAnchorHeight=o);let l=r.length?this.mapViewport(this.viewport,e.changes):this.viewport;(t&&(t.range.head<l.from||t.range.head>l.to)||!this.viewportIsAppropriate(l))&&(l=this.getViewport(0,t));let h=l.from!=this.viewport.from||l.to!=this.viewport.to;this.viewport=l,e.flags|=this.updateForViewport(),(h||!e.changes.empty||e.flags&2)&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(this.mapLineGaps(this.lineGaps,e.changes))),e.flags|=this.computeVisibleRanges(e.changes),t&&(this.scrollTarget=t),!this.mustEnforceCursorAssoc&&e.selectionSet&&e.view.lineWrapping&&e.state.selection.main.empty&&e.state.selection.main.assoc&&!e.state.facet(y7)&&(this.mustEnforceCursorAssoc=!0)}measure(e){let t=e.contentDOM,i=window.getComputedStyle(t),s=this.heightOracle,r=i.whiteSpace;this.defaultTextDirection=i.direction=="rtl"?li.RTL:li.LTR;let o=this.heightOracle.mustRefreshForWrapping(r),a=t.getBoundingClientRect(),l=o||this.mustMeasureContent||this.contentDOMHeight!=a.height;this.contentDOMHeight=a.height,this.mustMeasureContent=!1;let h=0,u=0;if(a.width&&a.height){let{scaleX:S,scaleY:k}=VE(t,a);(S>.005&&Math.abs(this.scaleX-S)>.005||k>.005&&Math.abs(this.scaleY-k)>.005)&&(this.scaleX=S,this.scaleY=k,h|=16,o=l=!0)}let c=(parseInt(i.paddingTop)||0)*this.scaleY,f=(parseInt(i.paddingBottom)||0)*this.scaleY;(this.paddingTop!=c||this.paddingBottom!=f)&&(this.paddingTop=c,this.paddingBottom=f,h|=18),this.editorWidth!=e.scrollDOM.clientWidth&&(s.lineWrapping&&(l=!0),this.editorWidth=e.scrollDOM.clientWidth,h|=16);let p=e.scrollDOM.scrollTop*this.scaleY;this.scrollTop!=p&&(this.scrollAnchorHeight=-1,this.scrollTop=p),this.scrolledToBottom=zE(e.scrollDOM);let b=(this.printing?m9:f9)(t,this.paddingTop),y=b.top-this.pixelViewport.top,_=b.bottom-this.pixelViewport.bottom;this.pixelViewport=b;let T=this.pixelViewport.bottom>this.pixelViewport.top&&this.pixelViewport.right>this.pixelViewport.left;if(T!=this.inView&&(this.inView=T,T&&(l=!0)),!this.inView&&!this.scrollTarget&&!p9(e.dom))return 0;let w=a.width;if((this.contentDOMWidth!=w||this.editorHeight!=e.scrollDOM.clientHeight)&&(this.contentDOMWidth=a.width,this.editorHeight=e.scrollDOM.clientHeight,h|=16),l){let S=e.docView.measureVisibleLineHeights(this.viewport);if(s.mustRefreshForHeights(S)&&(o=!0),o||s.lineWrapping&&Math.abs(w-this.contentDOMWidth)>s.charWidth){let{lineHeight:k,charWidth:A,textHeight:M}=e.docView.measureTextSize();o=k>0&&s.refresh(r,k,A,M,Math.max(5,w/A),S),o&&(e.docView.minWidth=0,h|=16)}y>0&&_>0?u=Math.max(y,_):y<0&&_<0&&(u=Math.min(y,_)),$x();for(let k of this.viewports){let A=k.from==this.viewport.from?S:e.docView.measureVisibleLineHeights(k);this.heightMap=(o?Xn.empty().applyChanges(this.stateDeco,Ke.empty,this.heightOracle,[new Qr(0,0,0,e.state.doc.length)]):this.heightMap).updateHeight(s,0,o,new a9(k.from,A))}Ha&&(h|=2)}let v=!this.viewportIsAppropriate(this.viewport,u)||this.scrollTarget&&(this.scrollTarget.range.head<this.viewport.from||this.scrollTarget.range.head>this.viewport.to);return v&&(h&2&&(h|=this.updateScaler()),this.viewport=this.getViewport(u,this.scrollTarget),h|=this.updateForViewport()),(h&2||v)&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(o?[]:this.lineGaps,e)),h|=this.computeVisibleRanges(),this.mustEnforceCursorAssoc&&(this.mustEnforceCursorAssoc=!1,e.docView.enforceCursorAssoc()),h}get visibleTop(){return this.scaler.fromDOM(this.pixelViewport.top)}get visibleBottom(){return this.scaler.fromDOM(this.pixelViewport.bottom)}getViewport(e,t){let i=.5-Math.max(-.5,Math.min(.5,e/1e3/2)),s=this.heightMap,r=this.heightOracle,{visibleTop:o,visibleBottom:a}=this,l=new _c(s.lineAt(o-i*1e3,Ot.ByHeight,r,0,0).from,s.lineAt(a+(1-i)*1e3,Ot.ByHeight,r,0,0).to);if(t){let{head:h}=t.range;if(h<l.from||h>l.to){let u=Math.min(this.editorHeight,this.pixelViewport.bottom-this.pixelViewport.top),c=s.lineAt(h,Ot.ByPos,r,0,0),f;t.y=="center"?f=(c.top+c.bottom)/2-u/2:t.y=="start"||t.y=="nearest"&&h<l.from?f=c.top:f=c.bottom-u,l=new _c(s.lineAt(f-1e3/2,Ot.ByHeight,r,0,0).from,s.lineAt(f+u+1e3/2,Ot.ByHeight,r,0,0).to)}}return l}mapViewport(e,t){let i=t.mapPos(e.from,-1),s=t.mapPos(e.to,1);return new _c(this.heightMap.lineAt(i,Ot.ByPos,this.heightOracle,0,0).from,this.heightMap.lineAt(s,Ot.ByPos,this.heightOracle,0,0).to)}viewportIsAppropriate({from:e,to:t},i=0){if(!this.inView)return!0;let{top:s}=this.heightMap.lineAt(e,Ot.ByPos,this.heightOracle,0,0),{bottom:r}=this.heightMap.lineAt(t,Ot.ByPos,this.heightOracle,0,0),{visibleTop:o,visibleBottom:a}=this;return(e==0||s<=o-Math.max(10,Math.min(-i,250)))&&(t==this.state.doc.length||r>=a+Math.max(10,Math.min(i,250)))&&s>o-2*1e3&&r<a+2*1e3}mapLineGaps(e,t){if(!e.length||t.empty)return e;let i=[];for(let s of e)t.touchesRange(s.from,s.to)||i.push(new Fm(t.mapPos(s.from),t.mapPos(s.to),s.size,s.displaySize));return i}ensureLineGaps(e,t){let i=this.heightOracle.lineWrapping,s=i?1e4:2e3,r=s>>1,o=s<<1;if(this.defaultTextDirection!=li.LTR&&!i)return[];let a=[],l=(u,c,f,p)=>{if(c-u<r)return;let b=this.state.selection.main,y=[b.from];b.empty||y.push(b.to);for(let T of y)if(T>u&&T<c){l(u,T-10,f,p),l(T+10,c,f,p);return}let _=y9(e,T=>T.from>=f.from&&T.to<=f.to&&Math.abs(T.from-u)<r&&Math.abs(T.to-c)<r&&!y.some(w=>T.from<w&&T.to>w));if(!_){if(c<f.to&&t&&i&&t.visibleRanges.some(v=>v.from<=c&&v.to>=c)){let v=t.moveToLineBoundary(ke.cursor(c),!1,!0).head;v>u&&(c=v)}let T=this.gapSize(f,u,c,p),w=i||T<2e6?T:2e6;_=new Fm(u,c,T,w)}a.push(_)},h=u=>{if(u.length<o||u.type!=_s.Text)return;let c=O9(u.from,u.to,this.stateDeco);if(c.total<o)return;let f=this.scrollTarget?this.scrollTarget.range.head:null,p,b;if(i){let y=s/this.heightOracle.lineLength*this.heightOracle.lineHeight,_,T;if(f!=null){let w=Cc(c,f),v=((this.visibleBottom-this.visibleTop)/2+y)/u.height;_=w-v,T=w+v}else _=(this.visibleTop-u.top-y)/u.height,T=(this.visibleBottom-u.top+y)/u.height;p=kc(c,_),b=kc(c,T)}else{let y=c.total*this.heightOracle.charWidth,_=s*this.heightOracle.charWidth,T=0;if(y>2e6)for(let A of e)A.from>=u.from&&A.from<u.to&&A.size!=A.displaySize&&A.from*this.heightOracle.charWidth+T<this.pixelViewport.left&&(T=A.size-A.displaySize);let w=this.pixelViewport.left+T,v=this.pixelViewport.right+T,S,k;if(f!=null){let A=Cc(c,f),M=((v-w)/2+_)/y;S=A-M,k=A+M}else S=(w-_)/y,k=(v+_)/y;p=kc(c,S),b=kc(c,k)}p>u.from&&l(u.from,p,u,c),b<u.to&&l(b,u.to,u,c)};for(let u of this.viewportLines)Array.isArray(u.type)?u.type.forEach(h):h(u);return a}gapSize(e,t,i,s){let r=Cc(s,i)-Cc(s,t);return this.heightOracle.lineWrapping?e.height*r:s.total*this.heightOracle.charWidth*r}updateLineGaps(e){Fm.same(e,this.lineGaps)||(this.lineGaps=e,this.lineGapDeco=Ft.set(e.map(t=>t.draw(this,this.heightOracle.lineWrapping))))}computeVisibleRanges(e){let t=this.stateDeco;this.lineGaps.length&&(t=t.concat(this.lineGapDeco));let i=[];xi.spans(t,this.viewport.from,this.viewport.to,{span(r,o){i.push({from:r,to:o})},point(){}},20);let s=0;if(i.length!=this.visibleRanges.length)s=12;else for(let r=0;r<i.length&&!(s&8);r++){let o=this.visibleRanges[r],a=i[r];(o.from!=a.from||o.to!=a.to)&&(s|=4,e&&e.mapPos(o.from,-1)==a.from&&e.mapPos(o.to,1)==a.to||(s|=8))}return this.visibleRanges=i,s}lineBlockAt(e){return e>=this.viewport.from&&e<=this.viewport.to&&this.viewportLines.find(t=>t.from<=e&&t.to>=e)||oh(this.heightMap.lineAt(e,Ot.ByPos,this.heightOracle,0,0),this.scaler)}lineBlockAtHeight(e){return e>=this.viewportLines[0].top&&e<=this.viewportLines[this.viewportLines.length-1].bottom&&this.viewportLines.find(t=>t.top<=e&&t.bottom>=e)||oh(this.heightMap.lineAt(this.scaler.fromDOM(e),Ot.ByHeight,this.heightOracle,0,0),this.scaler)}scrollAnchorAt(e){let t=this.lineBlockAtHeight(e+8);return t.from>=this.viewport.from||this.viewportLines[0].top-e>200?t:this.viewportLines[0]}elementAtHeight(e){return oh(this.heightMap.blockAt(this.scaler.fromDOM(e),this.heightOracle,0,0),this.scaler)}get docHeight(){return this.scaler.toDOM(this.heightMap.height)}get contentHeight(){return this.docHeight+this.paddingTop+this.paddingBottom}},_c=class{constructor(e,t){this.from=e,this.to=t}};function O9(n,e,t){let i=[],s=n,r=0;return xi.spans(t,n,e,{span(){},point(o,a){o>s&&(i.push({from:s,to:o}),r+=o-s),s=a}},20),s<e&&(i.push({from:s,to:e}),r+=e-s),{total:r,ranges:i}}function kc({total:n,ranges:e},t){if(t<=0)return e[0].from;if(t>=1)return e[e.length-1].to;let i=Math.floor(n*t);for(let s=0;;s++){let{from:r,to:o}=e[s],a=o-r;if(i<=a)return r+i;i-=a}}function Cc(n,e){let t=0;for(let{from:i,to:s}of n.ranges){if(e<=s){t+=e-i;break}t+=s-i}return t/n.total}function y9(n,e){for(let t of n)if(e(t))return t}const Nx={toDOM(n){return n},fromDOM(n){return n},scale:1,eq(n){return n==this}};let b9=class UA{constructor(e,t,i){let s=0,r=0,o=0;this.viewports=i.map(({from:a,to:l})=>{let h=t.lineAt(a,Ot.ByPos,e,0,0).top,u=t.lineAt(l,Ot.ByPos,e,0,0).bottom;return s+=u-h,{from:a,to:l,top:h,bottom:u,domTop:0,domBottom:0}}),this.scale=(7e6-s)/(t.height-s);for(let a of this.viewports)a.domTop=o+(a.top-r)*this.scale,o=a.domBottom=a.domTop+(a.bottom-a.top),r=a.bottom}toDOM(e){for(let t=0,i=0,s=0;;t++){let r=t<this.viewports.length?this.viewports[t]:null;if(!r||e<r.top)return s+(e-i)*this.scale;if(e<=r.bottom)return r.domTop+(e-r.top);i=r.bottom,s=r.domBottom}}fromDOM(e){for(let t=0,i=0,s=0;;t++){let r=t<this.viewports.length?this.viewports[t]:null;if(!r||e<r.domTop)return i+(e-s)/this.scale;if(e<=r.domBottom)return r.top+(e-r.domTop);i=r.bottom,s=r.domBottom}}eq(e){return e instanceof UA?this.scale==e.scale&&this.viewports.length==e.viewports.length&&this.viewports.every((t,i)=>t.from==e.viewports[i].from&&t.to==e.viewports[i].to):!1}};function oh(n,e){if(e.scale==1)return n;let t=e.toDOM(n.top),i=e.toDOM(n.bottom);return new Ar(n.from,n.length,t,i-t,Array.isArray(n._content)?n._content.map(s=>oh(s,e)):n._content)}const Ec=Qe.define({combine:n=>n.join(" ")}),K0=Qe.define({combine:n=>n.indexOf(!0)>-1}),J0=Ti.newName(),qA=Ti.newName(),zA=Ti.newName(),jA={"&light":"."+qA,"&dark":"."+zA};function eO(n,e,t){return new Ti(e,{finish(i){return/&/.test(i)?i.replace(/&\w*/,s=>{if(s=="&")return n;if(!t||!t[s])throw new RangeError(`Unsupported selector: ${s}`);return t[s]}):n+" "+i}})}const v9=eO("."+J0,{"&":{position:"relative !important",boxSizing:"border-box","&.cm-focused":{outline:"1px dotted #212121"},display:"flex !important",flexDirection:"column"},".cm-scroller":{display:"flex !important",alignItems:"flex-start !important",fontFamily:"monospace",lineHeight:1.4,height:"100%",overflowX:"auto",position:"relative",zIndex:0,overflowAnchor:"none"},".cm-content":{margin:0,flexGrow:2,flexShrink:0,display:"block",whiteSpace:"pre",wordWrap:"normal",boxSizing:"border-box",minHeight:"100%",padding:"4px 0",outline:"none","&[contenteditable=true]":{WebkitUserModify:"read-write-plaintext-only"}},".cm-lineWrapping":{whiteSpace_fallback:"pre-wrap",whiteSpace:"break-spaces",wordBreak:"break-word",overflowWrap:"anywhere",flexShrink:1},"&light .cm-content":{caretColor:"black"},"&dark .cm-content":{caretColor:"white"},".cm-line":{display:"block",padding:"0 2px 0 6px"},".cm-layer":{position:"absolute",left:0,top:0,contain:"size style","& > *":{position:"absolute"}},"&light .cm-selectionBackground":{background:"#d9d9d9"},"&dark .cm-selectionBackground":{background:"#222"},"&light.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#d7d4f0"},"&dark.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#233"},".cm-cursorLayer":{pointerEvents:"none"},"&.cm-focused > .cm-scroller > .cm-cursorLayer":{animation:"steps(1) cm-blink 1.2s infinite"},"@keyframes cm-blink":{"0%":{},"50%":{opacity:0},"100%":{}},"@keyframes cm-blink2":{"0%":{},"50%":{opacity:0},"100%":{}},".cm-cursor, .cm-dropCursor":{borderLeft:"1.2px solid black",marginLeft:"-0.6px",pointerEvents:"none"},".cm-cursor":{display:"none"},"&dark .cm-cursor":{borderLeftColor:"#ddd"},".cm-dropCursor":{position:"absolute"},"&.cm-focused > .cm-scroller > .cm-cursorLayer .cm-cursor":{display:"block"},".cm-iso":{unicodeBidi:"isolate"},".cm-announced":{position:"fixed",top:"-10000px"},"@media print":{".cm-announced":{display:"none"}},"&light .cm-activeLine":{backgroundColor:"#cceeff44"},"&dark .cm-activeLine":{backgroundColor:"#99eeff33"},"&light .cm-specialChar":{color:"red"},"&dark .cm-specialChar":{color:"#f78"},".cm-gutters":{flexShrink:0,display:"flex",height:"100%",boxSizing:"border-box",zIndex:200},".cm-gutters-before":{insetInlineStart:0},".cm-gutters-after":{insetInlineEnd:0},"&light .cm-gutters":{backgroundColor:"#f5f5f5",color:"#6c6c6c",border:"0px solid #ddd","&.cm-gutters-before":{borderRightWidth:"1px"},"&.cm-gutters-after":{borderLeftWidth:"1px"}},"&dark .cm-gutters":{backgroundColor:"#333338",color:"#ccc"},".cm-gutter":{display:"flex !important",flexDirection:"column",flexShrink:0,boxSizing:"border-box",minHeight:"100%",overflow:"hidden"},".cm-gutterElement":{boxSizing:"border-box"},".cm-lineNumbers .cm-gutterElement":{padding:"0 3px 0 5px",minWidth:"20px",textAlign:"right",whiteSpace:"nowrap"},"&light .cm-activeLineGutter":{backgroundColor:"#e2f2ff"},"&dark .cm-activeLineGutter":{backgroundColor:"#222227"},".cm-panels":{boxSizing:"border-box",position:"sticky",left:0,right:0,zIndex:300},"&light .cm-panels":{backgroundColor:"#f5f5f5",color:"black"},"&light .cm-panels-top":{borderBottom:"1px solid #ddd"},"&light .cm-panels-bottom":{borderTop:"1px solid #ddd"},"&dark .cm-panels":{backgroundColor:"#333338",color:"white"},".cm-dialog":{padding:"2px 19px 4px 6px",position:"relative","& label":{fontSize:"80%"}},".cm-dialog-close":{position:"absolute",top:"3px",right:"4px",backgroundColor:"inherit",border:"none",font:"inherit",fontSize:"14px",padding:"0"},".cm-tab":{display:"inline-block",overflow:"hidden",verticalAlign:"bottom"},".cm-widgetBuffer":{verticalAlign:"text-top",height:"1em",width:0,display:"inline"},".cm-placeholder":{color:"#888",display:"inline-block",verticalAlign:"top",userSelect:"none"},".cm-highlightSpace":{backgroundImage:"radial-gradient(circle at 50% 55%, #aaa 20%, transparent 5%)",backgroundPosition:"center"},".cm-highlightTab":{backgroundImage:`url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="200" height="20"><path stroke="%23888" stroke-width="1" fill="none" d="M1 10H196L190 5M190 15L196 10M197 4L197 16"/></svg>')`,backgroundSize:"auto 100%",backgroundPosition:"right 90%",backgroundRepeat:"no-repeat"},".cm-trailingSpace":{backgroundColor:"#ff332255"},".cm-button":{verticalAlign:"middle",color:"inherit",fontSize:"70%",padding:".2em 1em",borderRadius:"1px"},"&light .cm-button":{backgroundImage:"linear-gradient(#eff1f5, #d9d9df)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#b4b4b4, #d0d3d6)"}},"&dark .cm-button":{backgroundImage:"linear-gradient(#393939, #111)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#111, #333)"}},".cm-textfield":{verticalAlign:"middle",color:"inherit",fontSize:"70%",border:"1px solid silver",padding:".2em .5em"},"&light .cm-textfield":{backgroundColor:"white"},"&dark .cm-textfield":{border:"1px solid #555",backgroundColor:"inherit"}},jA),S9={childList:!0,characterData:!0,subtree:!0,attributes:!0,characterDataOldValue:!0},Vm=be.ie&&be.ie_version<=11;let x9=class{constructor(e){this.view=e,this.active=!1,this.editContext=null,this.selectionRange=new e7,this.selectionChanged=!1,this.delayedFlush=-1,this.resizeTimeout=-1,this.queue=[],this.delayedAndroidKey=null,this.flushingAndroidKey=-1,this.lastChange=0,this.scrollTargets=[],this.intersection=null,this.resizeScroll=null,this.intersecting=!1,this.gapIntersection=null,this.gaps=[],this.printQuery=null,this.parentCheck=-1,this.dom=e.contentDOM,this.observer=new MutationObserver(t=>{for(let i of t)this.queue.push(i);(be.ie&&be.ie_version<=11||be.ios&&e.composing)&&t.some(i=>i.type=="childList"&&i.removedNodes.length||i.type=="characterData"&&i.oldValue.length>i.target.nodeValue.length)?this.flushSoon():this.flush()}),window.EditContext&&be.android&&e.constructor.EDIT_CONTEXT!==!1&&!(be.chrome&&be.chrome_version<126)&&(this.editContext=new w9(e),e.state.facet(Js)&&(e.contentDOM.editContext=this.editContext.editContext)),Vm&&(this.onCharData=t=>{this.queue.push({target:t.target,type:"characterData",oldValue:t.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this),this.onResize=this.onResize.bind(this),this.onPrint=this.onPrint.bind(this),this.onScroll=this.onScroll.bind(this),window.matchMedia&&(this.printQuery=window.matchMedia("print")),typeof ResizeObserver=="function"&&(this.resizeScroll=new ResizeObserver(()=>{var t;((t=this.view.docView)===null||t===void 0?void 0:t.lastUpdate)<Date.now()-75&&this.onResize()}),this.resizeScroll.observe(e.scrollDOM)),this.addWindowListeners(this.win=e.win),this.start(),typeof IntersectionObserver=="function"&&(this.intersection=new IntersectionObserver(t=>{this.parentCheck<0&&(this.parentCheck=setTimeout(this.listenForScroll.bind(this),1e3)),t.length>0&&t[t.length-1].intersectionRatio>0!=this.intersecting&&(this.intersecting=!this.intersecting,this.intersecting!=this.view.inView&&this.onScrollChanged(document.createEvent("Event")))},{threshold:[0,.001]}),this.intersection.observe(this.dom),this.gapIntersection=new IntersectionObserver(t=>{t.length>0&&t[t.length-1].intersectionRatio>0&&this.onScrollChanged(document.createEvent("Event"))},{})),this.listenForScroll(),this.readSelectionRange()}onScrollChanged(e){this.view.inputState.runHandlers("scroll",e),this.intersecting&&this.view.measure()}onScroll(e){this.intersecting&&this.flush(!1),this.editContext&&this.view.requestMeasure(this.editContext.measureReq),this.onScrollChanged(e)}onResize(){this.resizeTimeout<0&&(this.resizeTimeout=setTimeout(()=>{this.resizeTimeout=-1,this.view.requestMeasure()},50))}onPrint(e){(e.type=="change"||!e.type)&&!e.matches||(this.view.viewState.printing=!0,this.view.measure(),setTimeout(()=>{this.view.viewState.printing=!1,this.view.requestMeasure()},500))}updateGaps(e){if(this.gapIntersection&&(e.length!=this.gaps.length||this.gaps.some((t,i)=>t!=e[i]))){this.gapIntersection.disconnect();for(let t of e)this.gapIntersection.observe(t);this.gaps=e}}onSelectionChange(e){let t=this.selectionChanged;if(!this.readSelectionRange()||this.delayedAndroidKey)return;let{view:i}=this,s=this.selectionRange;if(i.state.facet(Js)?i.root.activeElement!=this.dom:!nd(this.dom,s))return;let r=s.anchorNode&&i.docView.nearest(s.anchorNode);if(r&&r.ignoreEvent(e)){t||(this.selectionChanged=!1);return}(be.ie&&be.ie_version<=11||be.android&&be.chrome)&&!i.state.selection.main.empty&&s.focusNode&&kh(s.focusNode,s.focusOffset,s.anchorNode,s.anchorOffset)?this.flushSoon():this.flush(!1)}readSelectionRange(){let{view:e}=this,t=Wh(e.root);if(!t)return!1;let i=be.safari&&e.root.nodeType==11&&e.root.activeElement==this.dom&&T9(this.view,t)||t;if(!i||this.selectionRange.eq(i))return!1;let s=nd(this.dom,i);return s&&!this.selectionChanged&&e.inputState.lastFocusTime>Date.now()-200&&e.inputState.lastTouchTime<Date.now()-300&&i7(this.dom,i)?(this.view.inputState.lastFocusTime=0,e.docView.updateSelection(),!1):(this.selectionRange.setRange(i),s&&(this.selectionChanged=!0),!0)}setSelectionRange(e,t){this.selectionRange.set(e.node,e.offset,t.node,t.offset),this.selectionChanged=!1}clearSelectionRange(){this.selectionRange.set(null,0,null,0)}listenForScroll(){this.parentCheck=-1;let e=0,t=null;for(let i=this.dom;i;)if(i.nodeType==1)!t&&e<this.scrollTargets.length&&this.scrollTargets[e]==i?e++:t||(t=this.scrollTargets.slice(0,e)),t&&t.push(i),i=i.assignedSlot||i.parentNode;else if(i.nodeType==11)i=i.host;else break;if(e<this.scrollTargets.length&&!t&&(t=this.scrollTargets.slice(0,e)),t){for(let i of this.scrollTargets)i.removeEventListener("scroll",this.onScroll);for(let i of this.scrollTargets=t)i.addEventListener("scroll",this.onScroll)}}ignore(e){if(!this.active)return e();try{return this.stop(),e()}finally{this.start(),this.clear()}}start(){this.active||(this.observer.observe(this.dom,S9),Vm&&this.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.active=!0)}stop(){this.active&&(this.active=!1,this.observer.disconnect(),Vm&&this.dom.removeEventListener("DOMCharacterDataModified",this.onCharData))}clear(){this.processRecords(),this.queue.length=0,this.selectionChanged=!1}delayAndroidKey(e,t){var i;if(!this.delayedAndroidKey){let s=()=>{let r=this.delayedAndroidKey;r&&(this.clearDelayedAndroidKey(),this.view.inputState.lastKeyCode=r.keyCode,this.view.inputState.lastKeyTime=Date.now(),!this.flush()&&r.force&&Ca(this.dom,r.key,r.keyCode))};this.flushingAndroidKey=this.view.win.requestAnimationFrame(s)}(!this.delayedAndroidKey||e=="Enter")&&(this.delayedAndroidKey={key:e,keyCode:t,force:this.lastChange<Date.now()-50||!!(!((i=this.delayedAndroidKey)===null||i===void 0)&&i.force)})}clearDelayedAndroidKey(){this.win.cancelAnimationFrame(this.flushingAndroidKey),this.delayedAndroidKey=null,this.flushingAndroidKey=-1}flushSoon(){this.delayedFlush<0&&(this.delayedFlush=this.view.win.requestAnimationFrame(()=>{this.delayedFlush=-1,this.flush()}))}forceFlush(){this.delayedFlush>=0&&(this.view.win.cancelAnimationFrame(this.delayedFlush),this.delayedFlush=-1),this.flush()}pendingRecords(){for(let e of this.observer.takeRecords())this.queue.push(e);return this.queue}processRecords(){let e=this.pendingRecords();e.length&&(this.queue=[]);let t=-1,i=-1,s=!1;for(let r of e){let o=this.readMutation(r);o&&(o.typeOver&&(s=!0),t==-1?{from:t,to:i}=o:(t=Math.min(o.from,t),i=Math.max(o.to,i)))}return{from:t,to:i,typeOver:s}}readChange(){let{from:e,to:t,typeOver:i}=this.processRecords(),s=this.selectionChanged&&nd(this.dom,this.selectionRange);if(e<0&&!s)return null;e>-1&&(this.lastChange=Date.now()),this.view.inputState.lastFocusTime=0,this.selectionChanged=!1;let r=new N7(this.view,e,t,i);return this.view.docView.domChanged={newSel:r.newSel?r.newSel.main:null},r}flush(e=!0){if(this.delayedFlush>=0||this.delayedAndroidKey)return!1;e&&this.readSelectionRange();let t=this.readChange();if(!t)return this.view.requestMeasure(),!1;let i=this.view.state,s=AA(this.view,t);return this.view.state==i&&(t.domChanged||t.newSel&&!t.newSel.main.eq(this.view.state.selection.main))&&this.view.update([]),s}readMutation(e){let t=this.view.docView.nearest(e.target);if(!t||t.ignoreMutation(e))return null;if(t.markDirty(e.type=="attributes"),e.type=="attributes"&&(t.flags|=4),e.type=="childList"){let i=Fx(t,e.previousSibling||e.target.previousSibling,-1),s=Fx(t,e.nextSibling||e.target.nextSibling,1);return{from:i?t.posAfter(i):t.posAtStart,to:s?t.posBefore(s):t.posAtEnd,typeOver:!1}}else return e.type=="characterData"?{from:t.posAtStart,to:t.posAtEnd,typeOver:e.target.nodeValue==e.oldValue}:null}setWindow(e){e!=this.win&&(this.removeWindowListeners(this.win),this.win=e,this.addWindowListeners(this.win))}addWindowListeners(e){e.addEventListener("resize",this.onResize),this.printQuery?this.printQuery.addEventListener?this.printQuery.addEventListener("change",this.onPrint):this.printQuery.addListener(this.onPrint):e.addEventListener("beforeprint",this.onPrint),e.addEventListener("scroll",this.onScroll),e.document.addEventListener("selectionchange",this.onSelectionChange)}removeWindowListeners(e){e.removeEventListener("scroll",this.onScroll),e.removeEventListener("resize",this.onResize),this.printQuery?this.printQuery.removeEventListener?this.printQuery.removeEventListener("change",this.onPrint):this.printQuery.removeListener(this.onPrint):e.removeEventListener("beforeprint",this.onPrint),e.document.removeEventListener("selectionchange",this.onSelectionChange)}update(e){this.editContext&&(this.editContext.update(e),e.startState.facet(Js)!=e.state.facet(Js)&&(e.view.contentDOM.editContext=e.state.facet(Js)?this.editContext.editContext:null))}destroy(){var e,t,i;this.stop(),(e=this.intersection)===null||e===void 0||e.disconnect(),(t=this.gapIntersection)===null||t===void 0||t.disconnect(),(i=this.resizeScroll)===null||i===void 0||i.disconnect();for(let s of this.scrollTargets)s.removeEventListener("scroll",this.onScroll);this.removeWindowListeners(this.win),clearTimeout(this.parentCheck),clearTimeout(this.resizeTimeout),this.win.cancelAnimationFrame(this.delayedFlush),this.win.cancelAnimationFrame(this.flushingAndroidKey),this.editContext&&(this.view.contentDOM.editContext=null,this.editContext.destroy())}};function Fx(n,e,t){for(;e;){let i=bt.get(e);if(i&&i.parent==n)return i;let s=e.parentNode;e=s!=n.dom?s:t>0?e.nextSibling:e.previousSibling}return null}function Vx(n,e){let t=e.startContainer,i=e.startOffset,s=e.endContainer,r=e.endOffset,o=n.docView.domAtPos(n.state.selection.main.anchor);return kh(o.node,o.offset,s,r)&&([t,i,s,r]=[s,r,t,i]),{anchorNode:t,anchorOffset:i,focusNode:s,focusOffset:r}}function T9(n,e){if(e.getComposedRanges){let s=e.getComposedRanges(n.root)[0];if(s)return Vx(n,s)}let t=null;function i(s){s.preventDefault(),s.stopImmediatePropagation(),t=s.getTargetRanges()[0]}return n.contentDOM.addEventListener("beforeinput",i,!0),n.dom.ownerDocument.execCommand("indent"),n.contentDOM.removeEventListener("beforeinput",i,!0),t?Vx(n,t):null}class w9{constructor(e){this.from=0,this.to=0,this.pendingContextChange=null,this.handlers=Object.create(null),this.composing=null,this.resetRange(e.state);let t=this.editContext=new window.EditContext({text:e.state.doc.sliceString(this.from,this.to),selectionStart:this.toContextPos(Math.max(this.from,Math.min(this.to,e.state.selection.main.anchor))),selectionEnd:this.toContextPos(e.state.selection.main.head)});this.handlers.textupdate=i=>{let s=e.state.selection.main,{anchor:r,head:o}=s,a=this.toEditorPos(i.updateRangeStart),l=this.toEditorPos(i.updateRangeEnd);e.inputState.composing>=0&&!this.composing&&(this.composing={contextBase:i.updateRangeStart,editorBase:a,drifted:!1});let h=l-a>i.text.length;a==this.from&&r<this.from?a=r:l==this.to&&r>this.to&&(l=r);let u=PA(e.state.sliceDoc(a,l),i.text,(h?s.from:s.to)-a,h?"end":null);if(!u){let f=ke.single(this.toEditorPos(i.selectionStart),this.toEditorPos(i.selectionEnd));f.main.eq(s)||e.dispatch({selection:f,userEvent:"select"});return}let c={from:u.from+a,to:u.toA+a,insert:Ke.of(i.text.slice(u.from,u.toB).split(`
`))};if((be.mac||be.android)&&c.from==o-1&&/^\. ?$/.test(i.text)&&e.contentDOM.getAttribute("autocorrect")=="off"&&(c={from:a,to:l,insert:Ke.of([i.text.replace("."," ")])}),this.pendingContextChange=c,!e.state.readOnly){let f=this.to-this.from+(c.to-c.from+c.insert.length);bb(e,c,ke.single(this.toEditorPos(i.selectionStart,f),this.toEditorPos(i.selectionEnd,f)))}this.pendingContextChange&&(this.revertPending(e.state),this.setSelection(e.state)),c.from<c.to&&!c.insert.length&&e.inputState.composing>=0&&!/[\\p{Alphabetic}\\p{Number}_]/.test(t.text.slice(Math.max(0,i.updateRangeStart-1),Math.min(t.text.length,i.updateRangeStart+1)))&&this.handlers.compositionend(i)},this.handlers.characterboundsupdate=i=>{let s=[],r=null;for(let o=this.toEditorPos(i.rangeStart),a=this.toEditorPos(i.rangeEnd);o<a;o++){let l=e.coordsForChar(o);r=l&&new DOMRect(l.left,l.top,l.right-l.left,l.bottom-l.top)||r||new DOMRect,s.push(r)}t.updateCharacterBounds(i.rangeStart,s)},this.handlers.textformatupdate=i=>{let s=[];for(let r of i.getTextFormats()){let o=r.underlineStyle,a=r.underlineThickness;if(!/none/i.test(o)&&!/none/i.test(a)){let l=this.toEditorPos(r.rangeStart),h=this.toEditorPos(r.rangeEnd);if(l<h){let u=`text-decoration: underline ${/^[a-z]/.test(o)?o+" ":o=="Dashed"?"dashed ":o=="Squiggle"?"wavy ":""}${/thin/i.test(a)?1:2}px`;s.push(Ft.mark({attributes:{style:u}}).range(l,h))}}}e.dispatch({effects:yA.of(Ft.set(s))})},this.handlers.compositionstart=()=>{e.inputState.composing<0&&(e.inputState.composing=0,e.inputState.compositionFirstChange=!0)},this.handlers.compositionend=()=>{if(e.inputState.composing=-1,e.inputState.compositionFirstChange=null,this.composing){let{drifted:i}=this.composing;this.composing=null,i&&this.reset(e.state)}};for(let i in this.handlers)t.addEventListener(i,this.handlers[i]);this.measureReq={read:i=>{this.editContext.updateControlBounds(i.contentDOM.getBoundingClientRect());let s=Wh(i.root);s&&s.rangeCount&&this.editContext.updateSelectionBounds(s.getRangeAt(0).getBoundingClientRect())}}}applyEdits(e){let t=0,i=!1,s=this.pendingContextChange;return e.changes.iterChanges((r,o,a,l,h)=>{if(i)return;let u=h.length-(o-r);if(s&&o>=s.to)if(s.from==r&&s.to==o&&s.insert.eq(h)){s=this.pendingContextChange=null,t+=u,this.to+=u;return}else s=null,this.revertPending(e.state);if(r+=t,o+=t,o<=this.from)this.from+=u,this.to+=u;else if(r<this.to){if(r<this.from||o>this.to||this.to-this.from+h.length>3e4){i=!0;return}this.editContext.updateText(this.toContextPos(r),this.toContextPos(o),h.toString()),this.to+=u}t+=u}),s&&!i&&this.revertPending(e.state),!i}update(e){let t=this.pendingContextChange,i=e.startState.selection.main;this.composing&&(this.composing.drifted||!e.changes.touchesRange(i.from,i.to)&&e.transactions.some(s=>!s.isUserEvent("input.type")&&s.changes.touchesRange(this.from,this.to)))?(this.composing.drifted=!0,this.composing.editorBase=e.changes.mapPos(this.composing.editorBase)):!this.applyEdits(e)||!this.rangeIsValid(e.state)?(this.pendingContextChange=null,this.reset(e.state)):(e.docChanged||e.selectionSet||t)&&this.setSelection(e.state),(e.geometryChanged||e.docChanged||e.selectionSet)&&e.view.requestMeasure(this.measureReq)}resetRange(e){let{head:t}=e.selection.main;this.from=Math.max(0,t-1e4),this.to=Math.min(e.doc.length,t+1e4)}reset(e){this.resetRange(e),this.editContext.updateText(0,this.editContext.text.length,e.doc.sliceString(this.from,this.to)),this.setSelection(e)}revertPending(e){let t=this.pendingContextChange;this.pendingContextChange=null,this.editContext.updateText(this.toContextPos(t.from),this.toContextPos(t.from+t.insert.length),e.doc.sliceString(t.from,t.to))}setSelection(e){let{main:t}=e.selection,i=this.toContextPos(Math.max(this.from,Math.min(this.to,t.anchor))),s=this.toContextPos(t.head);(this.editContext.selectionStart!=i||this.editContext.selectionEnd!=s)&&this.editContext.updateSelection(i,s)}rangeIsValid(e){let{head:t}=e.selection.main;return!(this.from>0&&t-this.from<500||this.to<e.doc.length&&this.to-t<500||this.to-this.from>1e4*3)}toEditorPos(e,t=this.to-this.from){e=Math.min(e,t);let i=this.composing;return i&&i.drifted?i.editorBase+(e-i.contextBase):e+this.from}toContextPos(e){let t=this.composing;return t&&t.drifted?t.contextBase+(e-t.editorBase):e-this.from}destroy(){for(let e in this.handlers)this.editContext.removeEventListener(e,this.handlers[e])}}let Ve=class tO{get state(){return this.viewState.state}get viewport(){return this.viewState.viewport}get visibleRanges(){return this.viewState.visibleRanges}get inView(){return this.viewState.inView}get composing(){return!!this.inputState&&this.inputState.composing>0}get compositionStarted(){return!!this.inputState&&this.inputState.composing>=0}get root(){return this._root}get win(){return this.dom.ownerDocument.defaultView||window}constructor(e={}){var t;this.plugins=[],this.pluginMap=new Map,this.editorAttrs={},this.contentAttrs={},this.bidiCache=[],this.destroyed=!1,this.updateState=2,this.measureScheduled=-1,this.measureRequests=[],this.contentDOM=document.createElement("div"),this.scrollDOM=document.createElement("div"),this.scrollDOM.tabIndex=-1,this.scrollDOM.className="cm-scroller",this.scrollDOM.appendChild(this.contentDOM),this.announceDOM=document.createElement("div"),this.announceDOM.className="cm-announced",this.announceDOM.setAttribute("aria-live","polite"),this.dom=document.createElement("div"),this.dom.appendChild(this.announceDOM),this.dom.appendChild(this.scrollDOM),e.parent&&e.parent.appendChild(this.dom);let{dispatch:i}=e;this.dispatchTransactions=e.dispatchTransactions||i&&(s=>s.forEach(r=>i(r,this)))||(s=>this.update(s)),this.dispatch=this.dispatch.bind(this),this._root=e.root||t7(e.parent)||document,this.viewState=new Bx(e.state||Zt.create(e)),e.scrollTo&&e.scrollTo.is(xc)&&(this.viewState.scrollTarget=e.scrollTo.value.clip(this.viewState.state)),this.plugins=this.state.facet(ua).map(s=>new Qm(s));for(let s of this.plugins)s.update(this);this.observer=new x9(this),this.inputState=new q7(this),this.inputState.ensureHandlers(this.plugins),this.docView=new bx(this),this.mountStyles(),this.updateAttrs(),this.updateState=0,this.requestMeasure(),!((t=document.fonts)===null||t===void 0)&&t.ready&&document.fonts.ready.then(()=>this.requestMeasure())}dispatch(...e){let t=e.length==1&&e[0]instanceof En?e:e.length==1&&Array.isArray(e[0])?e[0]:[this.state.update(...e)];this.dispatchTransactions(t,this)}update(e){if(this.updateState!=0)throw new Error("Calls to EditorView.update are not allowed while an update is in progress");let t=!1,i=!1,s,r=this.state;for(let f of e){if(f.startState!=r)throw new RangeError("Trying to update state with a transaction that doesn't start from the previous state.");r=f.state}if(this.destroyed){this.viewState.state=r;return}let o=this.hasFocus,a=0,l=null;e.some(f=>f.annotation($A))?(this.inputState.notifiedFocused=o,a=1):o!=this.inputState.notifiedFocused&&(this.inputState.notifiedFocused=o,l=QA(r,o),l||(a=1));let h=this.observer.delayedAndroidKey,u=null;if(h?(this.observer.clearDelayedAndroidKey(),u=this.observer.readChange(),(u&&!this.state.doc.eq(r.doc)||!this.state.selection.eq(r.selection))&&(u=null)):this.observer.clear(),r.facet(Zt.phrases)!=this.state.facet(Zt.phrases))return this.setState(r);s=yx.create(this,r,e),s.flags|=a;let c=this.viewState.scrollTarget;try{this.updateState=2;for(let f of e){if(c&&(c=c.map(f.changes)),f.scrollIntoView){let{main:p}=f.state.selection;c=new $m(p.empty?p:ke.cursor(p.head,p.head>p.anchor?-1:1))}for(let p of f.effects)p.is(xc)&&(c=p.value.clip(this.state))}this.viewState.update(s,c),this.bidiCache=qx.update(this.bidiCache,s.changes),s.empty||(this.updatePlugins(s),this.inputState.update(s)),t=this.docView.update(s),this.state.facet(sh)!=this.styleModules&&this.mountStyles(),i=this.updateAttrs(),this.showAnnouncements(e),this.docView.updateSelection(t,e.some(f=>f.isUserEvent("select.pointer")))}finally{this.updateState=0}if(s.startState.facet(Ec)!=s.state.facet(Ec)&&(this.viewState.mustMeasureContent=!0),(t||i||c||this.viewState.mustEnforceCursorAssoc||this.viewState.mustMeasureContent)&&this.requestMeasure(),t&&this.docViewUpdate(),!s.empty)for(let f of this.state.facet(X0))try{f(s)}catch(p){vs(this.state,p,"update listener")}(l||u)&&Promise.resolve().then(()=>{l&&this.state==l.startState&&this.dispatch(l),u&&!AA(this,u)&&h.force&&Ca(this.contentDOM,h.key,h.keyCode)})}setState(e){if(this.updateState!=0)throw new Error("Calls to EditorView.setState are not allowed while an update is in progress");if(this.destroyed){this.viewState.state=e;return}this.updateState=2;let t=this.hasFocus;try{for(let i of this.plugins)i.destroy(this);this.viewState=new Bx(e),this.plugins=e.facet(ua).map(i=>new Qm(i)),this.pluginMap.clear();for(let i of this.plugins)i.update(this);this.docView.destroy(),this.docView=new bx(this),this.inputState.ensureHandlers(this.plugins),this.mountStyles(),this.updateAttrs(),this.bidiCache=[]}finally{this.updateState=0}t&&this.focus(),this.requestMeasure()}updatePlugins(e){let t=e.startState.facet(ua),i=e.state.facet(ua);if(t!=i){let s=[];for(let r of i){let o=t.indexOf(r);if(o<0)s.push(new Qm(r));else{let a=this.plugins[o];a.mustUpdate=e,s.push(a)}}for(let r of this.plugins)r.mustUpdate!=e&&r.destroy(this);this.plugins=s,this.pluginMap.clear()}else for(let s of this.plugins)s.mustUpdate=e;for(let s=0;s<this.plugins.length;s++)this.plugins[s].update(this);t!=i&&this.inputState.ensureHandlers(this.plugins)}docViewUpdate(){for(let e of this.plugins){let t=e.value;if(t&&t.docViewUpdate)try{t.docViewUpdate(this)}catch(i){vs(this.state,i,"doc view update listener")}}}measure(e=!0){if(this.destroyed)return;if(this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.observer.delayedAndroidKey){this.measureScheduled=-1,this.requestMeasure();return}this.measureScheduled=0,e&&this.observer.forceFlush();let t=null,i=this.scrollDOM,s=i.scrollTop*this.scaleY,{scrollAnchorPos:r,scrollAnchorHeight:o}=this.viewState;Math.abs(s-this.viewState.scrollTop)>1&&(o=-1),this.viewState.scrollAnchorHeight=-1;try{for(let a=0;;a++){if(o<0)if(zE(i))r=-1,o=this.viewState.heightMap.height;else{let p=this.viewState.scrollAnchorAt(s);r=p.from,o=p.top}this.updateState=1;let l=this.viewState.measure(this);if(!l&&!this.measureRequests.length&&this.viewState.scrollTarget==null)break;if(a>5){console.warn(this.measureRequests.length?"Measure loop restarted more than 5 times":"Viewport failed to stabilize");break}let h=[];l&4||([this.measureRequests,h]=[h,this.measureRequests]);let u=h.map(p=>{try{return p.read(this)}catch(b){return vs(this.state,b),Ux}}),c=yx.create(this,this.state,[]),f=!1;c.flags|=l,t?t.flags|=l:t=c,this.updateState=2,c.empty||(this.updatePlugins(c),this.inputState.update(c),this.updateAttrs(),f=this.docView.update(c),f&&this.docViewUpdate());for(let p=0;p<h.length;p++)if(u[p]!=Ux)try{let b=h[p];b.write&&b.write(u[p],this)}catch(b){vs(this.state,b)}if(f&&this.docView.updateSelection(!0),!c.viewportChanged&&this.measureRequests.length==0){if(this.viewState.editorHeight)if(this.viewState.scrollTarget){this.docView.scrollIntoView(this.viewState.scrollTarget),this.viewState.scrollTarget=null,o=-1;continue}else{let b=(r<0?this.viewState.heightMap.height:this.viewState.lineBlockAt(r).top)-o;if(b>1||b<-1){s=s+b,i.scrollTop=s/this.scaleY,o=-1;continue}}break}}}finally{this.updateState=0,this.measureScheduled=-1}if(t&&!t.empty)for(let a of this.state.facet(X0))a(t)}get themeClasses(){return J0+" "+(this.state.facet(K0)?zA:qA)+" "+this.state.facet(Ec)}updateAttrs(){let e=zx(this,bA,{class:"cm-editor"+(this.hasFocus?" cm-focused ":" ")+this.themeClasses}),t={spellcheck:"false",autocorrect:"off",autocapitalize:"off",writingsuggestions:"false",translate:"no",contenteditable:this.state.facet(Js)?"true":"false",class:"cm-content",style:`${be.tabSize}: ${this.state.tabSize}`,role:"textbox","aria-multiline":"true"};this.state.readOnly&&(t["aria-readonly"]="true"),zx(this,yb,t);let i=this.observer.ignore(()=>{let s=V0(this.contentDOM,this.contentAttrs,t),r=V0(this.dom,this.editorAttrs,e);return s||r});return this.editorAttrs=e,this.contentAttrs=t,i}showAnnouncements(e){let t=!0;for(let i of e)for(let s of i.effects)if(s.is(tO.announce)){t&&(this.announceDOM.textContent=""),t=!1;let r=this.announceDOM.appendChild(document.createElement("div"));r.textContent=s.value}}mountStyles(){this.styleModules=this.state.facet(sh);let e=this.state.facet(tO.cspNonce);Ti.mount(this.root,this.styleModules.concat(v9).reverse(),e?{nonce:e}:void 0)}readMeasured(){if(this.updateState==2)throw new Error("Reading the editor layout isn't allowed during an update");this.updateState==0&&this.measureScheduled>-1&&this.measure(!1)}requestMeasure(e){if(this.measureScheduled<0&&(this.measureScheduled=this.win.requestAnimationFrame(()=>this.measure())),e){if(this.measureRequests.indexOf(e)>-1)return;if(e.key!=null){for(let t=0;t<this.measureRequests.length;t++)if(this.measureRequests[t].key===e.key){this.measureRequests[t]=e;return}}this.measureRequests.push(e)}}plugin(e){let t=this.pluginMap.get(e);return(t===void 0||t&&t.plugin!=e)&&this.pluginMap.set(e,t=this.plugins.find(i=>i.plugin==e)||null),t&&t.update(this).value}get documentTop(){return this.contentDOM.getBoundingClientRect().top+this.viewState.paddingTop}get documentPadding(){return{top:this.viewState.paddingTop,bottom:this.viewState.paddingBottom}}get scaleX(){return this.viewState.scaleX}get scaleY(){return this.viewState.scaleY}elementAtHeight(e){return this.readMeasured(),this.viewState.elementAtHeight(e)}lineBlockAtHeight(e){return this.readMeasured(),this.viewState.lineBlockAtHeight(e)}get viewportLineBlocks(){return this.viewState.viewportLines}lineBlockAt(e){return this.viewState.lineBlockAt(e)}get contentHeight(){return this.viewState.contentHeight}moveByChar(e,t,i){return Nm(this,e,wx(this,e,t,i))}moveByGroup(e,t){return Nm(this,e,wx(this,e,t,i=>R7(this,e.head,i)))}visualLineSide(e,t){let i=this.bidiSpans(e),s=this.textDirectionAt(e.from),r=i[t?i.length-1:0];return ke.cursor(r.side(t,s)+e.from,r.forward(!t,s)?1:-1)}moveToLineBoundary(e,t,i=!0){return I7(this,e,t,i)}moveVertically(e,t,i){return Nm(this,e,L7(this,e,t,i))}domAtPos(e){return this.docView.domAtPos(e)}posAtDOM(e,t=0){return this.docView.posFromDOM(e,t)}posAtCoords(e,t=!0){return this.readMeasured(),kA(this,e,t)}coordsAtPos(e,t=1){this.readMeasured();let i=this.docView.coordsAt(e,t);if(!i||i.left==i.right)return i;let s=this.state.doc.lineAt(e),r=this.bidiSpans(s),o=r[Ir.find(r,e-s.from,-1,t)];return ap(i,o.dir==li.LTR==t>0)}coordsForChar(e){return this.readMeasured(),this.docView.coordsForChar(e)}get defaultCharacterWidth(){return this.viewState.heightOracle.charWidth}get defaultLineHeight(){return this.viewState.heightOracle.lineHeight}get textDirection(){return this.viewState.defaultTextDirection}textDirectionAt(e){return!this.state.facet(gA)||e<this.viewport.from||e>this.viewport.to?this.textDirection:(this.readMeasured(),this.docView.textDirectionAt(e))}get lineWrapping(){return this.viewState.heightOracle.lineWrapping}bidiSpans(e){if(e.length>_9)return lA(e.length);let t=this.textDirectionAt(e.from),i;for(let r of this.bidiCache)if(r.from==e.from&&r.dir==t&&(r.fresh||aA(r.isolates,i=Ox(this,e))))return r.order;i||(i=Ox(this,e));let s=m7(e.text,t,i);return this.bidiCache.push(new qx(e.from,e.to,t,i,!0,s)),s}get hasFocus(){var e;return(this.dom.ownerDocument.hasFocus()||be.safari&&((e=this.inputState)===null||e===void 0?void 0:e.lastContextMenu)>Date.now()-3e4)&&this.root.activeElement==this.contentDOM}focus(){this.observer.ignore(()=>{UE(this.contentDOM),this.docView.updateSelection()})}setRoot(e){this._root!=e&&(this._root=e,this.observer.setWindow((e.nodeType==9?e:e.ownerDocument).defaultView||window),this.mountStyles())}destroy(){this.root.activeElement==this.contentDOM&&this.contentDOM.blur();for(let e of this.plugins)e.destroy(this);this.plugins=[],this.inputState.destroy(),this.docView.destroy(),this.dom.remove(),this.observer.destroy(),this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.destroyed=!0}static scrollIntoView(e,t={}){return xc.of(new $m(typeof e=="number"?ke.cursor(e):e,t.y,t.x,t.yMargin,t.xMargin))}scrollSnapshot(){let{scrollTop:e,scrollLeft:t}=this.scrollDOM,i=this.viewState.scrollAnchorAt(e);return xc.of(new $m(ke.cursor(i.from),"start","start",i.top-e,t,!0))}setTabFocusMode(e){e==null?this.inputState.tabFocusMode=this.inputState.tabFocusMode<0?0:-1:typeof e=="boolean"?this.inputState.tabFocusMode=e?0:-1:this.inputState.tabFocusMode!=0&&(this.inputState.tabFocusMode=Date.now()+e)}static domEventHandlers(e){return Kd.define(()=>({}),{eventHandlers:e})}static domEventObservers(e){return Kd.define(()=>({}),{eventObservers:e})}static theme(e,t){let i=Ti.newName(),s=[Ec.of(i),sh.of(eO(`.${i}`,e))];return t&&t.dark&&s.push(K0.of(!0)),s}static baseTheme(e){return ku.lowest(sh.of(eO("."+J0,e,jA)))}static findFromDOM(e){var t;let i=e.querySelector(".cm-content"),s=i&&bt.get(i)||bt.get(e);return((t=s?.rootView)===null||t===void 0?void 0:t.view)||null}};Ve.styleModule=sh;Ve.inputHandler=pA;Ve.clipboardInputFilter=gb;Ve.clipboardOutputFilter=Ob;Ve.scrollHandler=OA;Ve.focusChangeEffect=mA;Ve.perLineTextDirection=gA;Ve.exceptionSink=fA;Ve.updateListener=X0;Ve.editable=Js;Ve.mouseSelectionStyle=dA;Ve.dragMovesSelection=cA;Ve.clickAddsSelectionRange=uA;Ve.decorations=Yh;Ve.outerDecorations=vA;Ve.atomicRanges=Cu;Ve.bidiIsolatedRanges=SA;Ve.scrollMargins=xA;Ve.darkTheme=K0;Ve.cspNonce=Qe.define({combine:n=>n.length?n[0]:""});Ve.contentAttributes=yb;Ve.editorAttributes=bA;Ve.lineWrapping=Ve.contentAttributes.of({class:"cm-lineWrapping"});Ve.announce=jt.define();const _9=4096,Ux={};let qx=class XA{constructor(e,t,i,s,r,o){this.from=e,this.to=t,this.dir=i,this.isolates=s,this.fresh=r,this.order=o}static update(e,t){if(t.empty&&!e.some(r=>r.fresh))return e;let i=[],s=e.length?e[e.length-1].dir:li.LTR;for(let r=Math.max(0,e.length-10);r<e.length;r++){let o=e[r];o.dir==s&&!t.touchesRange(o.from,o.to)&&i.push(new XA(t.mapPos(o.from,1),t.mapPos(o.to,-1),o.dir,o.isolates,!1,o.order))}return i}};function zx(n,e,t){for(let i=n.state.facet(e),s=i.length-1;s>=0;s--){let r=i[s],o=typeof r=="function"?r(n):r;o&&F0(o,t)}return t}const k9=be.mac?"mac":be.windows?"win":be.linux?"linux":"key";function C9(n,e){const t=n.split(/-(?!$)/);let i=t[t.length-1];i=="Space"&&(i=" ");let s,r,o,a;for(let l=0;l<t.length-1;++l){const h=t[l];if(/^(cmd|meta|m)$/i.test(h))a=!0;else if(/^a(lt)?$/i.test(h))s=!0;else if(/^(c|ctrl|control)$/i.test(h))r=!0;else if(/^s(hift)?$/i.test(h))o=!0;else if(/^mod$/i.test(h))e=="mac"?a=!0:r=!0;else throw new Error("Unrecognized modifier name: "+h)}return s&&(i="Alt-"+i),r&&(i="Ctrl-"+i),a&&(i="Meta-"+i),o&&(i="Shift-"+i),i}function Ac(n,e,t){return e.altKey&&(n="Alt-"+n),e.ctrlKey&&(n="Ctrl-"+n),e.metaKey&&(n="Meta-"+n),t!==!1&&e.shiftKey&&(n="Shift-"+n),n}const E9=ku.default(Ve.domEventHandlers({keydown(n,e){return M9(A9(e.state),n,e,"editor")}})),vb=Qe.define({enables:E9}),jx=new WeakMap;function A9(n){let e=n.facet(vb),t=jx.get(e);return t||jx.set(e,t=D9(e.reduce((i,s)=>i.concat(s),[]))),t}let Pr=null;const P9=4e3;function D9(n,e=k9){let t=Object.create(null),i=Object.create(null),s=(o,a)=>{let l=i[o];if(l==null)i[o]=a;else if(l!=a)throw new Error("Key binding "+o+" is used both as a regular binding and as a multi-stroke prefix")},r=(o,a,l,h,u)=>{var c,f;let p=t[o]||(t[o]=Object.create(null)),b=a.split(/ (?!$)/).map(T=>C9(T,e));for(let T=1;T<b.length;T++){let w=b.slice(0,T).join(" ");s(w,!0),p[w]||(p[w]={preventDefault:!0,stopPropagation:!1,run:[v=>{let S=Pr={view:v,prefix:w,scope:o};return setTimeout(()=>{Pr==S&&(Pr=null)},P9),!0}]})}let y=b.join(" ");s(y,!1);let _=p[y]||(p[y]={preventDefault:!1,stopPropagation:!1,run:((f=(c=p._any)===null||c===void 0?void 0:c.run)===null||f===void 0?void 0:f.slice())||[]});l&&_.run.push(l),h&&(_.preventDefault=!0),u&&(_.stopPropagation=!0)};for(let o of n){let a=o.scope?o.scope.split(" "):["editor"];if(o.any)for(let h of a){let u=t[h]||(t[h]=Object.create(null));u._any||(u._any={preventDefault:!1,stopPropagation:!1,run:[]});let{any:c}=o;for(let f in u)u[f].run.push(p=>c(p,iO))}let l=o[e]||o.key;if(l)for(let h of a)r(h,l,o.run,o.preventDefault,o.stopPropagation),o.shift&&r(h,"Shift-"+l,o.shift,o.preventDefault,o.stopPropagation)}return t}let iO=null;function M9(n,e,t,i){iO=e;let s=BE(e),r=D6(s,0),o=M6(r)==s.length&&s!=" ",a="",l=!1,h=!1,u=!1;Pr&&Pr.view==t&&Pr.scope==i&&(a=Pr.prefix+" ",MA.indexOf(e.keyCode)<0&&(h=!0,Pr=null));let c=new Set,f=_=>{if(_){for(let T of _.run)if(!c.has(T)&&(c.add(T),T(t)))return _.stopPropagation&&(u=!0),!0;_.preventDefault&&(_.stopPropagation&&(u=!0),h=!0)}return!1},p=n[i],b,y;return p&&(f(p[a+Ac(s,e,!o)])?l=!0:o&&(e.altKey||e.metaKey||e.ctrlKey)&&!(be.windows&&e.ctrlKey&&e.altKey)&&!(be.mac&&e.altKey&&!(e.ctrlKey||e.metaKey))&&(b=rr[e.keyCode])&&b!=s?(f(p[a+Ac(b,e,!0)])||e.shiftKey&&(y=Hh[e.keyCode])!=s&&y!=b&&f(p[a+Ac(y,e,!1)]))&&(l=!0):o&&e.shiftKey&&f(p[a+Ac(s,e,!0)])&&(l=!0),!l&&f(p._any)&&(l=!0)),h&&(l=!0),l&&u&&e.stopPropagation(),iO=null,l}let Wa=class extends Mo{compare(e){return this==e||this.constructor==e.constructor&&this.eq(e)}eq(e){return!1}destroy(e){}};Wa.prototype.elementClass="";Wa.prototype.toDOM=void 0;Wa.prototype.mapMode=Ri.TrackBefore;Wa.prototype.startSide=Wa.prototype.endSide=-1;Wa.prototype.point=!0;class nt{constructor(){}lineAt(e){if(e<0||e>this.length)throw new RangeError(`Invalid position ${e} in document of length ${this.length}`);return this.lineInner(e,!1,1,0)}line(e){if(e<1||e>this.lines)throw new RangeError(`Invalid line number ${e} in ${this.lines}-line document`);return this.lineInner(e,!0,1,0)}replace(e,t,i){let s=[];return this.decompose(0,e,s,2),i.length&&i.decompose(0,i.length,s,3),this.decompose(t,this.length,s,1),ps.from(s,this.length-(t-e)+i.length)}append(e){return this.replace(this.length,this.length,e)}slice(e,t=this.length){let i=[];return this.decompose(e,t,i,0),ps.from(i,t-e)}eq(e){if(e==this)return!0;if(e.length!=this.length||e.lines!=this.lines)return!1;let t=this.scanIdentical(e,1),i=this.length-this.scanIdentical(e,-1),s=new Ah(this),r=new Ah(e);for(let o=t,a=t;;){if(s.next(o),r.next(o),o=0,s.lineBreak!=r.lineBreak||s.done!=r.done||s.value!=r.value)return!1;if(a+=s.value.length,s.done||a>=i)return!0}}iter(e=1){return new Ah(this,e)}iterRange(e,t=this.length){return new HA(this,e,t)}iterLines(e,t){let i;if(e==null)i=this.iter();else{t==null&&(t=this.lines+1);let s=this.line(e).from;i=this.iterRange(s,Math.max(s,t==this.lines+1?this.length:t<=1?0:this.line(t-1).to))}return new WA(i)}toString(){return this.sliceString(0)}toJSON(){let e=[];return this.flatten(e),e}static of(e){if(e.length==0)throw new RangeError("A document must have at least one line");return e.length==1&&!e[0]?nt.empty:e.length<=32?new Qt(e):ps.from(Qt.split(e,[]))}}class Qt extends nt{constructor(e,t=I9(e)){super(),this.text=e,this.length=t}get lines(){return this.text.length}get children(){return null}lineInner(e,t,i,s){for(let r=0;;r++){let o=this.text[r],a=s+o.length;if((t?i:a)>=e)return new R9(s,a,i,o);s=a+1,i++}}decompose(e,t,i,s){let r=e<=0&&t>=this.length?this:new Qt(Xx(this.text,e,t),Math.min(t,this.length)-Math.max(0,e));if(s&1){let o=i.pop(),a=hd(r.text,o.text.slice(),0,r.length);if(a.length<=32)i.push(new Qt(a,o.length+r.length));else{let l=a.length>>1;i.push(new Qt(a.slice(0,l)),new Qt(a.slice(l)))}}else i.push(r)}replace(e,t,i){if(!(i instanceof Qt))return super.replace(e,t,i);let s=hd(this.text,hd(i.text,Xx(this.text,0,e)),t),r=this.length+i.length-(t-e);return s.length<=32?new Qt(s,r):ps.from(Qt.split(s,[]),r)}sliceString(e,t=this.length,i=`
`){let s="";for(let r=0,o=0;r<=t&&o<this.text.length;o++){let a=this.text[o],l=r+a.length;r>e&&o&&(s+=i),e<l&&t>r&&(s+=a.slice(Math.max(0,e-r),t-r)),r=l+1}return s}flatten(e){for(let t of this.text)e.push(t)}scanIdentical(){return 0}static split(e,t){let i=[],s=-1;for(let r of e)i.push(r),s+=r.length+1,i.length==32&&(t.push(new Qt(i,s)),i=[],s=-1);return s>-1&&t.push(new Qt(i,s)),t}}class ps extends nt{constructor(e,t){super(),this.children=e,this.length=t,this.lines=0;for(let i of e)this.lines+=i.lines}lineInner(e,t,i,s){for(let r=0;;r++){let o=this.children[r],a=s+o.length,l=i+o.lines-1;if((t?l:a)>=e)return o.lineInner(e,t,i,s);s=a+1,i=l+1}}decompose(e,t,i,s){for(let r=0,o=0;o<=t&&r<this.children.length;r++){let a=this.children[r],l=o+a.length;if(e<=l&&t>=o){let h=s&((o<=e?1:0)|(l>=t?2:0));o>=e&&l<=t&&!h?i.push(a):a.decompose(e-o,t-o,i,h)}o=l+1}}replace(e,t,i){if(i.lines<this.lines)for(let s=0,r=0;s<this.children.length;s++){let o=this.children[s],a=r+o.length;if(e>=r&&t<=a){let l=o.replace(e-r,t-r,i),h=this.lines-o.lines+l.lines;if(l.lines<h>>4&&l.lines>h>>6){let u=this.children.slice();return u[s]=l,new ps(u,this.length-(t-e)+i.length)}return super.replace(r,a,l)}r=a+1}return super.replace(e,t,i)}sliceString(e,t=this.length,i=`
`){let s="";for(let r=0,o=0;r<this.children.length&&o<=t;r++){let a=this.children[r],l=o+a.length;o>e&&r&&(s+=i),e<l&&t>o&&(s+=a.sliceString(e-o,t-o,i)),o=l+1}return s}flatten(e){for(let t of this.children)t.flatten(e)}scanIdentical(e,t){if(!(e instanceof ps))return 0;let i=0,[s,r,o,a]=t>0?[0,0,this.children.length,e.children.length]:[this.children.length-1,e.children.length-1,-1,-1];for(;;s+=t,r+=t){if(s==o||r==a)return i;let l=this.children[s],h=e.children[r];if(l!=h)return i+l.scanIdentical(h,t);i+=l.length+1}}static from(e,t=e.reduce((i,s)=>i+s.length+1,-1)){let i=0;for(let p of e)i+=p.lines;if(i<32){let p=[];for(let b of e)b.flatten(p);return new Qt(p,t)}let s=Math.max(32,i>>5),r=s<<1,o=s>>1,a=[],l=0,h=-1,u=[];function c(p){let b;if(p.lines>r&&p instanceof ps)for(let y of p.children)c(y);else p.lines>o&&(l>o||!l)?(f(),a.push(p)):p instanceof Qt&&l&&(b=u[u.length-1])instanceof Qt&&p.lines+b.lines<=32?(l+=p.lines,h+=p.length+1,u[u.length-1]=new Qt(b.text.concat(p.text),b.length+1+p.length)):(l+p.lines>s&&f(),l+=p.lines,h+=p.length+1,u.push(p))}function f(){l!=0&&(a.push(u.length==1?u[0]:ps.from(u,h)),h=-1,l=u.length=0)}for(let p of e)c(p);return f(),a.length==1?a[0]:new ps(a,t)}}nt.empty=new Qt([""],0);function I9(n){let e=-1;for(let t of n)e+=t.length+1;return e}function hd(n,e,t=0,i=1e9){for(let s=0,r=0,o=!0;r<n.length&&s<=i;r++){let a=n[r],l=s+a.length;l>=t&&(l>i&&(a=a.slice(0,i-s)),s<t&&(a=a.slice(t-s)),o?(e[e.length-1]+=a,o=!1):e.push(a)),s=l+1}return e}function Xx(n,e,t){return hd(n,[""],e,t)}class Ah{constructor(e,t=1){this.dir=t,this.done=!1,this.lineBreak=!1,this.value="",this.nodes=[e],this.offsets=[t>0?1:(e instanceof Qt?e.text.length:e.children.length)<<1]}nextInner(e,t){for(this.done=this.lineBreak=!1;;){let i=this.nodes.length-1,s=this.nodes[i],r=this.offsets[i],o=r>>1,a=s instanceof Qt?s.text.length:s.children.length;if(o==(t>0?a:0)){if(i==0)return this.done=!0,this.value="",this;t>0&&this.offsets[i-1]++,this.nodes.pop(),this.offsets.pop()}else if((r&1)==(t>0?0:1)){if(this.offsets[i]+=t,e==0)return this.lineBreak=!0,this.value=`
`,this;e--}else if(s instanceof Qt){let l=s.text[o+(t<0?-1:0)];if(this.offsets[i]+=t,l.length>Math.max(0,e))return this.value=e==0?l:t>0?l.slice(e):l.slice(0,l.length-e),this;e-=l.length}else{let l=s.children[o+(t<0?-1:0)];e>l.length?(e-=l.length,this.offsets[i]+=t):(t<0&&this.offsets[i]--,this.nodes.push(l),this.offsets.push(t>0?1:(l instanceof Qt?l.text.length:l.children.length)<<1))}}}next(e=0){return e<0&&(this.nextInner(-e,-this.dir),e=this.value.length),this.nextInner(e,this.dir)}}class HA{constructor(e,t,i){this.value="",this.done=!1,this.cursor=new Ah(e,t>i?-1:1),this.pos=t>i?e.length:0,this.from=Math.min(t,i),this.to=Math.max(t,i)}nextInner(e,t){if(t<0?this.pos<=this.from:this.pos>=this.to)return this.value="",this.done=!0,this;e+=Math.max(0,t<0?this.pos-this.to:this.from-this.pos);let i=t<0?this.pos-this.from:this.to-this.pos;e>i&&(e=i),i-=e;let{value:s}=this.cursor.next(e);return this.pos+=(s.length+e)*t,this.value=s.length<=i?s:t<0?s.slice(s.length-i):s.slice(0,i),this.done=!this.value,this}next(e=0){return e<0?e=Math.max(e,this.from-this.pos):e>0&&(e=Math.min(e,this.to-this.pos)),this.nextInner(e,this.cursor.dir)}get lineBreak(){return this.cursor.lineBreak&&this.value!=""}}class WA{constructor(e){this.inner=e,this.afterBreak=!0,this.value="",this.done=!1}next(e=0){let{done:t,lineBreak:i,value:s}=this.inner.next(e);return t?(this.done=!0,this.value=""):i?this.afterBreak?this.value="":(this.afterBreak=!0,this.next()):(this.value=s,this.afterBreak=!1),this}get lineBreak(){return!1}}typeof Symbol<"u"&&(nt.prototype[Symbol.iterator]=function(){return this.iter()},Ah.prototype[Symbol.iterator]=HA.prototype[Symbol.iterator]=WA.prototype[Symbol.iterator]=function(){return this});let R9=class{constructor(e,t,i,s){this.from=e,this.to=t,this.number=i,this.text=s}get length(){return this.to-this.from}},Aa="lc,34,7n,7,7b,19,,,,2,,2,,,20,b,1c,l,g,,2t,7,2,6,2,2,,4,z,,u,r,2j,b,1m,9,9,,o,4,,9,,3,,5,17,3,3b,f,,w,1j,,,,4,8,4,,3,7,a,2,t,,1m,,,,2,4,8,,9,,a,2,q,,2,2,1l,,4,2,4,2,2,3,3,,u,2,3,,b,2,1l,,4,5,,2,4,,k,2,m,6,,,1m,,,2,,4,8,,7,3,a,2,u,,1n,,,,c,,9,,14,,3,,1l,3,5,3,,4,7,2,b,2,t,,1m,,2,,2,,3,,5,2,7,2,b,2,s,2,1l,2,,,2,4,8,,9,,a,2,t,,20,,4,,2,3,,,8,,29,,2,7,c,8,2q,,2,9,b,6,22,2,r,,,,,,1j,e,,5,,2,5,b,,10,9,,2u,4,,6,,2,2,2,p,2,4,3,g,4,d,,2,2,6,,f,,jj,3,qa,3,t,3,t,2,u,2,1s,2,,7,8,,2,b,9,,19,3,3b,2,y,,3a,3,4,2,9,,6,3,63,2,2,,1m,,,7,,,,,2,8,6,a,2,,1c,h,1r,4,1c,7,,,5,,14,9,c,2,w,4,2,2,,3,1k,,,2,3,,,3,1m,8,2,2,48,3,,d,,7,4,,6,,3,2,5i,1m,,5,ek,,5f,x,2da,3,3x,,2o,w,fe,6,2x,2,n9w,4,,a,w,2,28,2,7k,,3,,4,,p,2,5,,47,2,q,i,d,,12,8,p,b,1a,3,1c,,2,4,2,2,13,,1v,6,2,2,2,2,c,,8,,1b,,1f,,,3,2,2,5,2,,,16,2,8,,6m,,2,,4,,fn4,,kh,g,g,g,a6,2,gt,,6a,,45,5,1ae,3,,2,5,4,14,3,4,,4l,2,fx,4,ar,2,49,b,4w,,1i,f,1k,3,1d,4,2,2,1x,3,10,5,,8,1q,,c,2,1g,9,a,4,2,,2n,3,2,,,2,6,,4g,,3,8,l,2,1l,2,,,,,m,,e,7,3,5,5f,8,2,3,,,n,,29,,2,6,,,2,,,2,,2,6j,,2,4,6,2,,2,r,2,2d,8,2,,,2,2y,,,,2,6,,,2t,3,2,4,,5,77,9,,2,6t,,a,2,,,4,,40,4,2,2,4,,w,a,14,6,2,4,8,,9,6,2,3,1a,d,,2,ba,7,,6,,,2a,m,2,7,,2,,2,3e,6,3,,,2,,7,,,20,2,3,,,,9n,2,f0b,5,1n,7,t4,,1r,4,29,,f5k,2,43q,,,3,4,5,8,8,2,7,u,4,44,3,1iz,1j,4,1e,8,,e,,m,5,,f,11s,7,,h,2,7,,2,,5,79,7,c5,4,15s,7,31,7,240,5,gx7k,2o,3k,6o".split(",").map(n=>n?parseInt(n,36):1);for(let n=1;n<Aa.length;n++)Aa[n]+=Aa[n-1];function L9(n){for(let e=1;e<Aa.length;e+=2)if(Aa[e]>n)return Aa[e-1]<=n;return!1}function Hx(n){return n>=127462&&n<=127487}const Wx=8205;function an(n,e,t=!0,i=!0){return(t?ZA:$9)(n,e,i)}function ZA(n,e,t){if(e==n.length)return e;e&&YA(n.charCodeAt(e))&&GA(n.charCodeAt(e-1))&&e--;let i=gi(n,e);for(e+=Sn(i);e<n.length;){let s=gi(n,e);if(i==Wx||s==Wx||t&&L9(s))e+=Sn(s),i=s;else if(Hx(s)){let r=0,o=e-2;for(;o>=0&&Hx(gi(n,o));)r++,o-=2;if(r%2==0)break;e+=2}else break}return e}function $9(n,e,t){for(;e>0;){let i=ZA(n,e-2,t);if(i<e)return i;e--}return 0}function YA(n){return n>=56320&&n<57344}function GA(n){return n>=55296&&n<56320}function gi(n,e){let t=n.charCodeAt(e);if(!GA(t)||e+1==n.length)return t;let i=n.charCodeAt(e+1);return YA(i)?(t-55296<<10)+(i-56320)+65536:t}function Sb(n){return n<=65535?String.fromCharCode(n):(n-=65536,String.fromCharCode((n>>10)+55296,(n&1023)+56320))}function Sn(n){return n<65536?1:2}const nO=/\r\n?|\n/;var Li=(function(n){return n[n.Simple=0]="Simple",n[n.TrackDel=1]="TrackDel",n[n.TrackBefore=2]="TrackBefore",n[n.TrackAfter=3]="TrackAfter",n})(Li||(Li={}));class ks{constructor(e){this.sections=e}get length(){let e=0;for(let t=0;t<this.sections.length;t+=2)e+=this.sections[t];return e}get newLength(){let e=0;for(let t=0;t<this.sections.length;t+=2){let i=this.sections[t+1];e+=i<0?this.sections[t]:i}return e}get empty(){return this.sections.length==0||this.sections.length==2&&this.sections[1]<0}iterGaps(e){for(let t=0,i=0,s=0;t<this.sections.length;){let r=this.sections[t++],o=this.sections[t++];o<0?(e(i,s,r),s+=r):s+=o,i+=r}}iterChangedRanges(e,t=!1){sO(this,e,t)}get invertedDesc(){let e=[];for(let t=0;t<this.sections.length;){let i=this.sections[t++],s=this.sections[t++];s<0?e.push(i,s):e.push(s,i)}return new ks(e)}composeDesc(e){return this.empty?e:e.empty?this:KA(this,e)}mapDesc(e,t=!1){return e.empty?this:rO(this,e,t)}mapPos(e,t=-1,i=Li.Simple){let s=0,r=0;for(let o=0;o<this.sections.length;){let a=this.sections[o++],l=this.sections[o++],h=s+a;if(l<0){if(h>e)return r+(e-s);r+=a}else{if(i!=Li.Simple&&h>=e&&(i==Li.TrackDel&&s<e&&h>e||i==Li.TrackBefore&&s<e||i==Li.TrackAfter&&h>e))return null;if(h>e||h==e&&t<0&&!a)return e==s||t<0?r:r+l;r+=l}s=h}if(e>s)throw new RangeError(`Position ${e} is out of range for changeset of length ${s}`);return r}touchesRange(e,t=e){for(let i=0,s=0;i<this.sections.length&&s<=t;){let r=this.sections[i++],o=this.sections[i++],a=s+r;if(o>=0&&s<=t&&a>=e)return s<e&&a>t?"cover":!0;s=a}return!1}toString(){let e="";for(let t=0;t<this.sections.length;){let i=this.sections[t++],s=this.sections[t++];e+=(e?" ":"")+i+(s>=0?":"+s:"")}return e}toJSON(){return this.sections}static fromJSON(e){if(!Array.isArray(e)||e.length%2||e.some(t=>typeof t!="number"))throw new RangeError("Invalid JSON representation of ChangeDesc");return new ks(e)}static create(e){return new ks(e)}}class Ht extends ks{constructor(e,t){super(e),this.inserted=t}apply(e){if(this.length!=e.length)throw new RangeError("Applying change set to a document with the wrong length");return sO(this,(t,i,s,r,o)=>e=e.replace(s,s+(i-t),o),!1),e}mapDesc(e,t=!1){return rO(this,e,t,!0)}invert(e){let t=this.sections.slice(),i=[];for(let s=0,r=0;s<t.length;s+=2){let o=t[s],a=t[s+1];if(a>=0){t[s]=a,t[s+1]=o;let l=s>>1;for(;i.length<l;)i.push(nt.empty);i.push(o?e.slice(r,r+o):nt.empty)}r+=o}return new Ht(t,i)}compose(e){return this.empty?e:e.empty?this:KA(this,e,!0)}map(e,t=!1){return e.empty?this:rO(this,e,t,!0)}iterChanges(e,t=!1){sO(this,e,t)}get desc(){return ks.create(this.sections)}filter(e){let t=[],i=[],s=[],r=new Gh(this);e:for(let o=0,a=0;;){let l=o==e.length?1e9:e[o++];for(;a<l||a==l&&r.len==0;){if(r.done)break e;let u=Math.min(r.len,l-a);Di(s,u,-1);let c=r.ins==-1?-1:r.off==0?r.ins:0;Di(t,u,c),c>0&&Oo(i,t,r.text),r.forward(u),a+=u}let h=e[o++];for(;a<h;){if(r.done)break e;let u=Math.min(r.len,h-a);Di(t,u,-1),Di(s,u,r.ins==-1?-1:r.off==0?r.ins:0),r.forward(u),a+=u}}return{changes:new Ht(t,i),filtered:ks.create(s)}}toJSON(){let e=[];for(let t=0;t<this.sections.length;t+=2){let i=this.sections[t],s=this.sections[t+1];s<0?e.push(i):s==0?e.push([i]):e.push([i].concat(this.inserted[t>>1].toJSON()))}return e}static of(e,t,i){let s=[],r=[],o=0,a=null;function l(u=!1){if(!u&&!s.length)return;o<t&&Di(s,t-o,-1);let c=new Ht(s,r);a=a?a.compose(c.map(a)):c,s=[],r=[],o=0}function h(u){if(Array.isArray(u))for(let c of u)h(c);else if(u instanceof Ht){if(u.length!=t)throw new RangeError(`Mismatched change set length (got ${u.length}, expected ${t})`);l(),a=a?a.compose(u.map(a)):u}else{let{from:c,to:f=c,insert:p}=u;if(c>f||c<0||f>t)throw new RangeError(`Invalid change range ${c} to ${f} (in doc of length ${t})`);let b=p?typeof p=="string"?nt.of(p.split(i||nO)):p:nt.empty,y=b.length;if(c==f&&y==0)return;c<o&&l(),c>o&&Di(s,c-o,-1),Di(s,f-c,y),Oo(r,s,b),o=f}}return h(e),l(!a),a}static empty(e){return new Ht(e?[e,-1]:[],[])}static fromJSON(e){if(!Array.isArray(e))throw new RangeError("Invalid JSON representation of ChangeSet");let t=[],i=[];for(let s=0;s<e.length;s++){let r=e[s];if(typeof r=="number")t.push(r,-1);else{if(!Array.isArray(r)||typeof r[0]!="number"||r.some((o,a)=>a&&typeof o!="string"))throw new RangeError("Invalid JSON representation of ChangeSet");if(r.length==1)t.push(r[0],0);else{for(;i.length<s;)i.push(nt.empty);i[s]=nt.of(r.slice(1)),t.push(r[0],i[s].length)}}}return new Ht(t,i)}static createSet(e,t){return new Ht(e,t)}}function Di(n,e,t,i=!1){if(e==0&&t<=0)return;let s=n.length-2;s>=0&&t<=0&&t==n[s+1]?n[s]+=e:e==0&&n[s]==0?n[s+1]+=t:i?(n[s]+=e,n[s+1]+=t):n.push(e,t)}function Oo(n,e,t){if(t.length==0)return;let i=e.length-2>>1;if(i<n.length)n[n.length-1]=n[n.length-1].append(t);else{for(;n.length<i;)n.push(nt.empty);n.push(t)}}function sO(n,e,t){let i=n.inserted;for(let s=0,r=0,o=0;o<n.sections.length;){let a=n.sections[o++],l=n.sections[o++];if(l<0)s+=a,r+=a;else{let h=s,u=r,c=nt.empty;for(;h+=a,u+=l,l&&i&&(c=c.append(i[o-2>>1])),!(t||o==n.sections.length||n.sections[o+1]<0);)a=n.sections[o++],l=n.sections[o++];e(s,h,r,u,c),s=h,r=u}}}function rO(n,e,t,i=!1){let s=[],r=i?[]:null,o=new Gh(n),a=new Gh(e);for(let l=0,h=0;;)if(o.ins==-1)l+=o.len,o.next();else if(a.ins==-1&&h<l){let u=Math.min(a.len,l-h);a.forward(u),Di(s,u,-1),h+=u}else if(a.ins>=0&&(o.done||h<l||h==l&&(a.len<o.len||a.len==o.len&&!t))){for(Di(s,a.ins,-1);l>h&&!o.done&&l+o.len<h+a.len;)l+=o.len,o.next();h+=a.len,a.next()}else if(o.ins>=0){let u=0,c=l+o.len;for(;;)if(a.ins>=0&&h>l&&h+a.len<c)u+=a.ins,h+=a.len,a.next();else if(a.ins==-1&&h<c){let f=Math.min(a.len,c-h);u+=f,a.forward(f),h+=f}else break;Di(s,u,o.ins),r&&Oo(r,s,o.text),l=c,o.next()}else{if(o.done&&a.done)return r?Ht.createSet(s,r):ks.create(s);throw new Error("Mismatched change set lengths")}}function KA(n,e,t=!1){let i=[],s=t?[]:null,r=new Gh(n),o=new Gh(e);for(let a=!1;;){if(r.done&&o.done)return s?Ht.createSet(i,s):ks.create(i);if(r.ins==0)Di(i,r.len,0,a),r.next();else if(o.len==0&&!o.done)Di(i,0,o.ins,a),s&&Oo(s,i,o.text),o.next();else{if(r.done||o.done)throw new Error("Mismatched change set lengths");{let l=Math.min(r.len2,o.len),h=i.length;if(r.ins==-1){let u=o.ins==-1?-1:o.off?0:o.ins;Di(i,l,u,a),s&&u&&Oo(s,i,o.text)}else o.ins==-1?(Di(i,r.off?0:r.len,l,a),s&&Oo(s,i,r.textBit(l))):(Di(i,r.off?0:r.len,o.off?0:o.ins,a),s&&!o.off&&Oo(s,i,o.text));a=(r.ins>l||o.ins>=0&&o.len>l)&&(a||i.length>h),r.forward2(l),o.forward(l)}}}}class Gh{constructor(e){this.set=e,this.i=0,this.next()}next(){let{sections:e}=this.set;this.i<e.length?(this.len=e[this.i++],this.ins=e[this.i++]):(this.len=0,this.ins=-2),this.off=0}get done(){return this.ins==-2}get len2(){return this.ins<0?this.len:this.ins}get text(){let{inserted:e}=this.set,t=this.i-2>>1;return t>=e.length?nt.empty:e[t]}textBit(e){let{inserted:t}=this.set,i=this.i-2>>1;return i>=t.length&&!e?nt.empty:t[i].slice(this.off,e==null?void 0:this.off+e)}forward(e){e==this.len?this.next():(this.len-=e,this.off+=e)}forward2(e){this.ins==-1?this.forward(e):e==this.ins?this.next():(this.ins-=e,this.off+=e)}}class yo{constructor(e,t,i){this.from=e,this.to=t,this.flags=i}get anchor(){return this.flags&16?this.to:this.from}get head(){return this.flags&16?this.from:this.to}get empty(){return this.from==this.to}get assoc(){return this.flags&4?-1:this.flags&8?1:0}get bidiLevel(){let e=this.flags&3;return e==3?null:e}get goalColumn(){let e=this.flags>>5;return e==33554431?void 0:e}map(e,t=-1){let i,s;return this.empty?i=s=e.mapPos(this.from,t):(i=e.mapPos(this.from,1),s=e.mapPos(this.to,-1)),i==this.from&&s==this.to?this:new yo(i,s,this.flags)}extend(e,t=e){if(e<=this.anchor&&t>=this.anchor)return le.range(e,t);let i=Math.abs(e-this.anchor)>Math.abs(t-this.anchor)?e:t;return le.range(this.anchor,i)}eq(e){return this.anchor==e.anchor&&this.head==e.head}toJSON(){return{anchor:this.anchor,head:this.head}}static fromJSON(e){if(!e||typeof e.anchor!="number"||typeof e.head!="number")throw new RangeError("Invalid JSON representation for SelectionRange");return le.range(e.anchor,e.head)}static create(e,t,i){return new yo(e,t,i)}}class le{constructor(e,t){this.ranges=e,this.mainIndex=t}map(e,t=-1){return e.empty?this:le.create(this.ranges.map(i=>i.map(e,t)),this.mainIndex)}eq(e){if(this.ranges.length!=e.ranges.length||this.mainIndex!=e.mainIndex)return!1;for(let t=0;t<this.ranges.length;t++)if(!this.ranges[t].eq(e.ranges[t]))return!1;return!0}get main(){return this.ranges[this.mainIndex]}asSingle(){return this.ranges.length==1?this:new le([this.main],0)}addRange(e,t=!0){return le.create([e].concat(this.ranges),t?0:this.mainIndex+1)}replaceRange(e,t=this.mainIndex){let i=this.ranges.slice();return i[t]=e,le.create(i,this.mainIndex)}toJSON(){return{ranges:this.ranges.map(e=>e.toJSON()),main:this.mainIndex}}static fromJSON(e){if(!e||!Array.isArray(e.ranges)||typeof e.main!="number"||e.main>=e.ranges.length)throw new RangeError("Invalid JSON representation for EditorSelection");return new le(e.ranges.map(t=>yo.fromJSON(t)),e.main)}static single(e,t=e){return new le([le.range(e,t)],0)}static create(e,t=0){if(e.length==0)throw new RangeError("A selection needs at least one range");for(let i=0,s=0;s<e.length;s++){let r=e[s];if(r.empty?r.from<=i:r.from<i)return le.normalized(e.slice(),t);i=r.to}return new le(e,t)}static cursor(e,t=0,i,s){return yo.create(e,e,(t==0?0:t<0?4:8)|(i==null?3:Math.min(2,i))|(s??33554431)<<5)}static range(e,t,i){let s=(i??33554431)<<5;return t<e?yo.create(t,e,16|s|8):yo.create(e,t,s|(t>e?4:0))}static normalized(e,t=0){let i=e[t];e.sort((s,r)=>s.from-r.from),t=e.indexOf(i);for(let s=1;s<e.length;s++){let r=e[s],o=e[s-1];if(r.empty?r.from<=o.to:r.from<o.to){let a=o.from,l=Math.max(r.to,o.to);s<=t&&t--,e.splice(--s,2,r.anchor>r.head?le.range(l,a):le.range(a,l))}}return new le(e,t)}}function JA(n,e){for(let t of n.ranges)if(t.to>e)throw new RangeError("Selection points outside of document")}let xb=0;class Ce{constructor(e,t,i,s,r){this.combine=e,this.compareInput=t,this.compare=i,this.isStatic=s,this.extensions=r,this.id=xb++,this.default=e([])}static define(e={}){return new Ce(e.combine||(t=>t),e.compareInput||((t,i)=>t===i),e.compare||(e.combine?(t,i)=>t===i:Tb),!!e.static,e.enables)}of(e){return new ud([],this,0,e)}compute(e,t){if(this.isStatic)throw new Error("Can't compute a static facet");return new ud(e,this,1,t)}computeN(e,t){if(this.isStatic)throw new Error("Can't compute a static facet");return new ud(e,this,2,t)}from(e,t){return t||(t=i=>i),this.compute([e],i=>t(i.field(e)))}}function Tb(n,e){return n==e||n.length==e.length&&n.every((t,i)=>t===e[i])}class ud{constructor(e,t,i,s){this.dependencies=e,this.facet=t,this.type=i,this.value=s,this.id=xb++}dynamicSlot(e){var t;let i=this.value,s=this.facet.compareInput,r=this.id,o=e[r]>>1,a=this.type==2,l=!1,h=!1,u=[];for(let c of this.dependencies)c=="doc"?l=!0:c=="selection"?h=!0:(((t=e[c.id])!==null&&t!==void 0?t:1)&1)==0&&u.push(e[c.id]);return{create(c){return c.values[o]=i(c),1},update(c,f){if(l&&f.docChanged||h&&(f.docChanged||f.selection)||oO(c,u)){let p=i(c);if(a?!Zx(p,c.values[o],s):!s(p,c.values[o]))return c.values[o]=p,1}return 0},reconfigure:(c,f)=>{let p=i(c),b=f.config.address[r];if(b!=null){let y=tf(f,b);if(this.dependencies.every(_=>_ instanceof Ce?f.facet(_)===c.facet(_):_ instanceof ci?f.field(_,!1)==c.field(_,!1):!0)||(a?Zx(p,y,s):s(p,y)))return c.values[o]=y,0}return c.values[o]=p,1}}}}function Zx(n,e,t){if(n.length!=e.length)return!1;for(let i=0;i<n.length;i++)if(!t(n[i],e[i]))return!1;return!0}function oO(n,e){let t=!1;for(let i of e)Ph(n,i)&1&&(t=!0);return t}function Q9(n,e,t){let i=t.map(l=>n[l.id]),s=t.map(l=>l.type),r=i.filter(l=>!(l&1)),o=n[e.id]>>1;function a(l){let h=[];for(let u=0;u<i.length;u++){let c=tf(l,i[u]);if(s[u]==2)for(let f of c)h.push(f);else h.push(c)}return e.combine(h)}return{create(l){for(let h of i)Ph(l,h);return l.values[o]=a(l),1},update(l,h){if(!oO(l,r))return 0;let u=a(l);return e.compare(u,l.values[o])?0:(l.values[o]=u,1)},reconfigure(l,h){let u=oO(l,i),c=h.config.facets[e.id],f=h.facet(e);if(c&&!u&&Tb(t,c))return l.values[o]=f,0;let p=a(l);return e.compare(p,f)?(l.values[o]=f,0):(l.values[o]=p,1)}}}const Yx=Ce.define({static:!0});class ci{constructor(e,t,i,s,r){this.id=e,this.createF=t,this.updateF=i,this.compareF=s,this.spec=r,this.provides=void 0}static define(e){let t=new ci(xb++,e.create,e.update,e.compare||((i,s)=>i===s),e);return e.provide&&(t.provides=e.provide(t)),t}create(e){let t=e.facet(Yx).find(i=>i.field==this);return(t?.create||this.createF)(e)}slot(e){let t=e[this.id]>>1;return{create:i=>(i.values[t]=this.create(i),1),update:(i,s)=>{let r=i.values[t],o=this.updateF(r,s);return this.compareF(r,o)?0:(i.values[t]=o,1)},reconfigure:(i,s)=>s.config.address[this.id]!=null?(i.values[t]=s.field(this),0):(i.values[t]=this.create(i),1)}}init(e){return[this,Yx.of({field:this,create:e})]}get extension(){return this}}const ta={lowest:4,low:3,default:2,high:1,highest:0};function Ul(n){return e=>new eP(e,n)}const Eu={highest:Ul(ta.highest),high:Ul(ta.high),default:Ul(ta.default),low:Ul(ta.low),lowest:Ul(ta.lowest)};class eP{constructor(e,t){this.inner=e,this.prec=t}}class up{of(e){return new aO(this,e)}reconfigure(e){return up.reconfigure.of({compartment:this,extension:e})}get(e){return e.config.compartments.get(this)}}class aO{constructor(e,t){this.compartment=e,this.inner=t}}class ef{constructor(e,t,i,s,r,o){for(this.base=e,this.compartments=t,this.dynamicSlots=i,this.address=s,this.staticValues=r,this.facets=o,this.statusTemplate=[];this.statusTemplate.length<i.length;)this.statusTemplate.push(0)}staticFacet(e){let t=this.address[e.id];return t==null?e.default:this.staticValues[t>>1]}static resolve(e,t,i){let s=[],r=Object.create(null),o=new Map;for(let f of B9(e,t,o))f instanceof ci?s.push(f):(r[f.facet.id]||(r[f.facet.id]=[])).push(f);let a=Object.create(null),l=[],h=[];for(let f of s)a[f.id]=h.length<<1,h.push(p=>f.slot(p));let u=i?.config.facets;for(let f in r){let p=r[f],b=p[0].facet,y=u&&u[f]||[];if(p.every(_=>_.type==0))if(a[b.id]=l.length<<1|1,Tb(y,p))l.push(i.facet(b));else{let _=b.combine(p.map(T=>T.value));l.push(i&&b.compare(_,i.facet(b))?i.facet(b):_)}else{for(let _ of p)_.type==0?(a[_.id]=l.length<<1|1,l.push(_.value)):(a[_.id]=h.length<<1,h.push(T=>_.dynamicSlot(T)));a[b.id]=h.length<<1,h.push(_=>Q9(_,b,p))}}let c=h.map(f=>f(a));return new ef(e,o,c,a,l,r)}}function B9(n,e,t){let i=[[],[],[],[],[]],s=new Map;function r(o,a){let l=s.get(o);if(l!=null){if(l<=a)return;let h=i[l].indexOf(o);h>-1&&i[l].splice(h,1),o instanceof aO&&t.delete(o.compartment)}if(s.set(o,a),Array.isArray(o))for(let h of o)r(h,a);else if(o instanceof aO){if(t.has(o.compartment))throw new RangeError("Duplicate use of compartment in extensions");let h=e.get(o.compartment)||o.inner;t.set(o.compartment,h),r(h,a)}else if(o instanceof eP)r(o.inner,o.prec);else if(o instanceof ci)i[a].push(o),o.provides&&r(o.provides,a);else if(o instanceof ud)i[a].push(o),o.facet.extensions&&r(o.facet.extensions,a);else{let h=o.extension;if(!h)throw new Error(`Unrecognized extension value in extension set (${o}). This sometimes happens because multiple instances of @codemirror/state are loaded, breaking instanceof checks.`);r(h,a)}}return r(n,ta.default),i.reduce((o,a)=>o.concat(a))}function Ph(n,e){if(e&1)return 2;let t=e>>1,i=n.status[t];if(i==4)throw new Error("Cyclic dependency between fields and/or facets");if(i&2)return i;n.status[t]=4;let s=n.computeSlot(n,n.config.dynamicSlots[t]);return n.status[t]=2|s}function tf(n,e){return e&1?n.config.staticValues[e>>1]:n.values[e>>1]}const tP=Ce.define(),iP=Ce.define({combine:n=>n.some(e=>e),static:!0}),nP=Ce.define({combine:n=>n.length?n[0]:void 0,static:!0}),sP=Ce.define(),rP=Ce.define(),oP=Ce.define(),aP=Ce.define({combine:n=>n.length?n[0]:!1});class Vo{constructor(e,t){this.type=e,this.value=t}static define(){return new N9}}class N9{of(e){return new Vo(this,e)}}class F9{constructor(e){this.map=e}of(e){return new Ue(this,e)}}class Ue{constructor(e,t){this.type=e,this.value=t}map(e){let t=this.type.map(this.value,e);return t===void 0?void 0:t==this.value?this:new Ue(this.type,t)}is(e){return this.type==e}static define(e={}){return new F9(e.map||(t=>t))}static mapEffects(e,t){if(!e.length)return e;let i=[];for(let s of e){let r=s.map(t);r&&i.push(r)}return i}}Ue.reconfigure=Ue.define();Ue.appendConfig=Ue.define();class Wt{constructor(e,t,i,s,r,o){this.startState=e,this.changes=t,this.selection=i,this.effects=s,this.annotations=r,this.scrollIntoView=o,this._doc=null,this._state=null,i&&JA(i,t.newLength),r.some(a=>a.type==Wt.time)||(this.annotations=r.concat(Wt.time.of(Date.now())))}static create(e,t,i,s,r,o){return new Wt(e,t,i,s,r,o)}get newDoc(){return this._doc||(this._doc=this.changes.apply(this.startState.doc))}get newSelection(){return this.selection||this.startState.selection.map(this.changes)}get state(){return this._state||this.startState.applyTransaction(this),this._state}annotation(e){for(let t of this.annotations)if(t.type==e)return t.value}get docChanged(){return!this.changes.empty}get reconfigured(){return this.startState.config!=this.state.config}isUserEvent(e){let t=this.annotation(Wt.userEvent);return!!(t&&(t==e||t.length>e.length&&t.slice(0,e.length)==e&&t[e.length]=="."))}}Wt.time=Vo.define();Wt.userEvent=Vo.define();Wt.addToHistory=Vo.define();Wt.remote=Vo.define();function V9(n,e){let t=[];for(let i=0,s=0;;){let r,o;if(i<n.length&&(s==e.length||e[s]>=n[i]))r=n[i++],o=n[i++];else if(s<e.length)r=e[s++],o=e[s++];else return t;!t.length||t[t.length-1]<r?t.push(r,o):t[t.length-1]<o&&(t[t.length-1]=o)}}function lP(n,e,t){var i;let s,r,o;return t?(s=e.changes,r=Ht.empty(e.changes.length),o=n.changes.compose(e.changes)):(s=e.changes.map(n.changes),r=n.changes.mapDesc(e.changes,!0),o=n.changes.compose(s)),{changes:o,selection:e.selection?e.selection.map(r):(i=n.selection)===null||i===void 0?void 0:i.map(s),effects:Ue.mapEffects(n.effects,s).concat(Ue.mapEffects(e.effects,r)),annotations:n.annotations.length?n.annotations.concat(e.annotations):e.annotations,scrollIntoView:n.scrollIntoView||e.scrollIntoView}}function lO(n,e,t){let i=e.selection,s=Pa(e.annotations);return e.userEvent&&(s=s.concat(Wt.userEvent.of(e.userEvent))),{changes:e.changes instanceof Ht?e.changes:Ht.of(e.changes||[],t,n.facet(nP)),selection:i&&(i instanceof le?i:le.single(i.anchor,i.head)),effects:Pa(e.effects),annotations:s,scrollIntoView:!!e.scrollIntoView}}function hP(n,e,t){let i=lO(n,e.length?e[0]:{},n.doc.length);e.length&&e[0].filter===!1&&(t=!1);for(let r=1;r<e.length;r++){e[r].filter===!1&&(t=!1);let o=!!e[r].sequential;i=lP(i,lO(n,e[r],o?i.changes.newLength:n.doc.length),o)}let s=Wt.create(n,i.changes,i.selection,i.effects,i.annotations,i.scrollIntoView);return q9(t?U9(s):s)}function U9(n){let e=n.startState,t=!0;for(let s of e.facet(sP)){let r=s(n);if(r===!1){t=!1;break}Array.isArray(r)&&(t=t===!0?r:V9(t,r))}if(t!==!0){let s,r;if(t===!1)r=n.changes.invertedDesc,s=Ht.empty(e.doc.length);else{let o=n.changes.filter(t);s=o.changes,r=o.filtered.invertedDesc}n=Wt.create(e,s,n.selection&&n.selection.map(r),Ue.mapEffects(n.effects,r),n.annotations,n.scrollIntoView)}let i=e.facet(rP);for(let s=i.length-1;s>=0;s--){let r=i[s](n);r instanceof Wt?n=r:Array.isArray(r)&&r.length==1&&r[0]instanceof Wt?n=r[0]:n=hP(e,Pa(r),!1)}return n}function q9(n){let e=n.startState,t=e.facet(oP),i=n;for(let s=t.length-1;s>=0;s--){let r=t[s](n);r&&Object.keys(r).length&&(i=lP(n,lO(e,r,n.changes.newLength),!0))}return i==n?n:Wt.create(e,n.changes,n.selection,i.effects,i.annotations,i.scrollIntoView)}const z9=[];function Pa(n){return n==null?z9:Array.isArray(n)?n:[n]}var $i=(function(n){return n[n.Word=0]="Word",n[n.Space=1]="Space",n[n.Other=2]="Other",n})($i||($i={}));const j9=/[\u00df\u0587\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/;let hO;try{hO=new RegExp("[\\p{Alphabetic}\\p{Number}_]","u")}catch{}function X9(n){if(hO)return hO.test(n);for(let e=0;e<n.length;e++){let t=n[e];if(/\w/.test(t)||t>""&&(t.toUpperCase()!=t.toLowerCase()||j9.test(t)))return!0}return!1}function H9(n){return e=>{if(!/\S/.test(e))return $i.Space;if(X9(e))return $i.Word;for(let t=0;t<n.length;t++)if(e.indexOf(n[t])>-1)return $i.Word;return $i.Other}}class Ge{constructor(e,t,i,s,r,o){this.config=e,this.doc=t,this.selection=i,this.values=s,this.status=e.statusTemplate.slice(),this.computeSlot=r,o&&(o._state=this);for(let a=0;a<this.config.dynamicSlots.length;a++)Ph(this,a<<1);this.computeSlot=null}field(e,t=!0){let i=this.config.address[e.id];if(i==null){if(t)throw new RangeError("Field is not present in this state");return}return Ph(this,i),tf(this,i)}update(...e){return hP(this,e,!0)}applyTransaction(e){let t=this.config,{base:i,compartments:s}=t;for(let o of e.effects)o.is(up.reconfigure)?(t&&(s=new Map,t.compartments.forEach((a,l)=>s.set(l,a)),t=null),s.set(o.value.compartment,o.value.extension)):o.is(Ue.reconfigure)?(t=null,i=o.value):o.is(Ue.appendConfig)&&(t=null,i=Pa(i).concat(o.value));let r;t?r=e.startState.values.slice():(t=ef.resolve(i,s,this),r=new Ge(t,this.doc,this.selection,t.dynamicSlots.map(()=>null),(a,l)=>l.reconfigure(a,this),null).values),new Ge(t,e.newDoc,e.newSelection,r,(o,a)=>a.update(o,e),e)}replaceSelection(e){return typeof e=="string"&&(e=this.toText(e)),this.changeByRange(t=>({changes:{from:t.from,to:t.to,insert:e},range:le.cursor(t.from+e.length)}))}changeByRange(e){let t=this.selection,i=e(t.ranges[0]),s=this.changes(i.changes),r=[i.range],o=Pa(i.effects);for(let a=1;a<t.ranges.length;a++){let l=e(t.ranges[a]),h=this.changes(l.changes),u=h.map(s);for(let f=0;f<a;f++)r[f]=r[f].map(u);let c=s.mapDesc(h,!0);r.push(l.range.map(c)),s=s.compose(u),o=Ue.mapEffects(o,u).concat(Ue.mapEffects(Pa(l.effects),c))}return{changes:s,selection:le.create(r,t.mainIndex),effects:o}}changes(e=[]){return e instanceof Ht?e:Ht.of(e,this.doc.length,this.facet(Ge.lineSeparator))}toText(e){return nt.of(e.split(this.facet(Ge.lineSeparator)||nO))}sliceDoc(e=0,t=this.doc.length){return this.doc.sliceString(e,t,this.lineBreak)}facet(e){let t=this.config.address[e.id];return t==null?e.default:(Ph(this,t),tf(this,t))}toJSON(e){let t={doc:this.sliceDoc(),selection:this.selection.toJSON()};if(e)for(let i in e){let s=e[i];s instanceof ci&&(t[i]=s.spec.toJSON(this.field(e[i]),this))}return t}static fromJSON(e,t={},i){if(!e||typeof e.doc!="string")throw new RangeError("Invalid JSON representation for EditorState");let s=[];if(i)for(let r in i){let o=i[r],a=e[r];s.push(o.init(l=>o.spec.fromJSON(a,l)))}return Ge.create({doc:e.doc,selection:le.fromJSON(e.selection),extensions:t.extensions?s.concat([t.extensions]):s})}static create(e={}){let t=ef.resolve(e.extensions||[],new Map),i=e.doc instanceof nt?e.doc:nt.of((e.doc||"").split(t.staticFacet(Ge.lineSeparator)||nO)),s=e.selection?e.selection instanceof le?e.selection:le.single(e.selection.anchor,e.selection.head):le.single(0);return JA(s,i.length),t.staticFacet(iP)||(s=s.asSingle()),new Ge(t,i,s,t.dynamicSlots.map(()=>null),(r,o)=>o.create(r),null)}get tabSize(){return this.facet(Ge.tabSize)}get lineBreak(){return this.facet(Ge.lineSeparator)||`
`}get readOnly(){return this.facet(aP)}phrase(e,...t){for(let i of this.facet(Ge.phrases))if(Object.prototype.hasOwnProperty.call(i,e)){e=i[e];break}return t.length&&(e=e.replace(/\$(\$|\d*)/g,(i,s)=>{if(s=="$")return"$";let r=+(s||1);return r>t.length?i:t[r-1]})),e}languageDataAt(e,t,i=-1){let s=[];for(let r of this.facet(tP))for(let o of r(this,t,i))Object.prototype.hasOwnProperty.call(o,e)&&s.push(o[e]);return s}charCategorizer(e){return H9(this.languageDataAt("wordChars",e).join(""))}wordAt(e){let{text:t,from:i,length:s}=this.doc.lineAt(e),r=this.charCategorizer(e),o=e-i,a=e-i;for(;o>0;){let l=an(t,o,!1);if(r(t.slice(l,o))!=$i.Word)break;o=l}for(;a<s;){let l=an(t,a);if(r(t.slice(a,l))!=$i.Word)break;a=l}return o==a?null:le.range(o+i,a+i)}}Ge.allowMultipleSelections=iP;Ge.tabSize=Ce.define({combine:n=>n.length?n[0]:4});Ge.lineSeparator=nP;Ge.readOnly=aP;Ge.phrases=Ce.define({compare(n,e){let t=Object.keys(n),i=Object.keys(e);return t.length==i.length&&t.every(s=>n[s]==e[s])}});Ge.languageData=tP;Ge.changeFilter=sP;Ge.transactionFilter=rP;Ge.transactionExtender=oP;up.reconfigure=Ue.define();function ar(n,e,t={}){let i={};for(let s of n)for(let r of Object.keys(s)){let o=s[r],a=i[r];if(a===void 0)i[r]=o;else if(!(a===o||o===void 0))if(Object.hasOwnProperty.call(t,r))i[r]=t[r](a,o);else throw new Error("Config merge conflict for field "+r)}for(let s in e)i[s]===void 0&&(i[s]=e[s]);return i}class $o{eq(e){return this==e}range(e,t=e){return uO.create(e,t,this)}}$o.prototype.startSide=$o.prototype.endSide=0;$o.prototype.point=!1;$o.prototype.mapMode=Li.TrackDel;let uO=class uP{constructor(e,t,i){this.from=e,this.to=t,this.value=i}static create(e,t,i){return new uP(e,t,i)}};function cO(n,e){return n.from-e.from||n.value.startSide-e.value.startSide}class wb{constructor(e,t,i,s){this.from=e,this.to=t,this.value=i,this.maxPoint=s}get length(){return this.to[this.to.length-1]}findIndex(e,t,i,s=0){let r=i?this.to:this.from;for(let o=s,a=r.length;;){if(o==a)return o;let l=o+a>>1,h=r[l]-e||(i?this.value[l].endSide:this.value[l].startSide)-t;if(l==o)return h>=0?o:a;h>=0?a=l:o=l+1}}between(e,t,i,s){for(let r=this.findIndex(t,-1e9,!0),o=this.findIndex(i,1e9,!1,r);r<o;r++)if(s(this.from[r]+e,this.to[r]+e,this.value[r])===!1)return!1}map(e,t){let i=[],s=[],r=[],o=-1,a=-1;for(let l=0;l<this.value.length;l++){let h=this.value[l],u=this.from[l]+e,c=this.to[l]+e,f,p;if(u==c){let b=t.mapPos(u,h.startSide,h.mapMode);if(b==null||(f=p=b,h.startSide!=h.endSide&&(p=t.mapPos(u,h.endSide),p<f)))continue}else if(f=t.mapPos(u,h.startSide),p=t.mapPos(c,h.endSide),f>p||f==p&&h.startSide>0&&h.endSide<=0)continue;(p-f||h.endSide-h.startSide)<0||(o<0&&(o=f),h.point&&(a=Math.max(a,p-f)),i.push(h),s.push(f-o),r.push(p-o))}return{mapped:i.length?new wb(s,r,i,a):null,pos:o}}}class st{constructor(e,t,i,s){this.chunkPos=e,this.chunk=t,this.nextLayer=i,this.maxPoint=s}static create(e,t,i,s){return new st(e,t,i,s)}get length(){let e=this.chunk.length-1;return e<0?0:Math.max(this.chunkEnd(e),this.nextLayer.length)}get size(){if(this.isEmpty)return 0;let e=this.nextLayer.size;for(let t of this.chunk)e+=t.value.length;return e}chunkEnd(e){return this.chunkPos[e]+this.chunk[e].length}update(e){let{add:t=[],sort:i=!1,filterFrom:s=0,filterTo:r=this.length}=e,o=e.filter;if(t.length==0&&!o)return this;if(i&&(t=t.slice().sort(cO)),this.isEmpty)return t.length?st.of(t):this;let a=new cP(this,null,-1).goto(0),l=0,h=[],u=new zr;for(;a.value||l<t.length;)if(l<t.length&&(a.from-t[l].from||a.startSide-t[l].value.startSide)>=0){let c=t[l++];u.addInner(c.from,c.to,c.value)||h.push(c)}else a.rangeIndex==1&&a.chunkIndex<this.chunk.length&&(l==t.length||this.chunkEnd(a.chunkIndex)<t[l].from)&&(!o||s>this.chunkEnd(a.chunkIndex)||r<this.chunkPos[a.chunkIndex])&&u.addChunk(this.chunkPos[a.chunkIndex],this.chunk[a.chunkIndex])?a.nextChunk():((!o||s>a.to||r<a.from||o(a.from,a.to,a.value))&&(u.addInner(a.from,a.to,a.value)||h.push(uO.create(a.from,a.to,a.value))),a.next());return u.finishInner(this.nextLayer.isEmpty&&!h.length?st.empty:this.nextLayer.update({add:h,filter:o,filterFrom:s,filterTo:r}))}map(e){if(e.empty||this.isEmpty)return this;let t=[],i=[],s=-1;for(let o=0;o<this.chunk.length;o++){let a=this.chunkPos[o],l=this.chunk[o],h=e.touchesRange(a,a+l.length);if(h===!1)s=Math.max(s,l.maxPoint),t.push(l),i.push(e.mapPos(a));else if(h===!0){let{mapped:u,pos:c}=l.map(a,e);u&&(s=Math.max(s,u.maxPoint),t.push(u),i.push(c))}}let r=this.nextLayer.map(e);return t.length==0?r:new st(i,t,r||st.empty,s)}between(e,t,i){if(!this.isEmpty){for(let s=0;s<this.chunk.length;s++){let r=this.chunkPos[s],o=this.chunk[s];if(t>=r&&e<=r+o.length&&o.between(r,e-r,t-r,i)===!1)return}this.nextLayer.between(e,t,i)}}iter(e=0){return Kh.from([this]).goto(e)}get isEmpty(){return this.nextLayer==this}static iter(e,t=0){return Kh.from(e).goto(t)}static compare(e,t,i,s,r=-1){let o=e.filter(c=>c.maxPoint>0||!c.isEmpty&&c.maxPoint>=r),a=t.filter(c=>c.maxPoint>0||!c.isEmpty&&c.maxPoint>=r),l=Gx(o,a,i),h=new ql(o,l,r),u=new ql(a,l,r);i.iterGaps((c,f,p)=>Kx(h,c,u,f,p,s)),i.empty&&i.length==0&&Kx(h,0,u,0,0,s)}static eq(e,t,i=0,s){s==null&&(s=1e9);let r=e.filter(u=>!u.isEmpty&&t.indexOf(u)<0),o=t.filter(u=>!u.isEmpty&&e.indexOf(u)<0);if(r.length!=o.length)return!1;if(!r.length)return!0;let a=Gx(r,o),l=new ql(r,a,0).goto(i),h=new ql(o,a,0).goto(i);for(;;){if(l.to!=h.to||!dO(l.active,h.active)||l.point&&(!h.point||!l.point.eq(h.point)))return!1;if(l.to>s)return!0;l.next(),h.next()}}static spans(e,t,i,s,r=-1){let o=new ql(e,null,r).goto(t),a=t,l=o.openStart;for(;;){let h=Math.min(o.to,i);if(o.point?(s.point(a,h,o.point,o.activeForPoint(o.to),l,o.pointRank),l=o.openEnd(h)+(o.to>h?1:0)):h>a&&(s.span(a,h,o.active,l),l=o.openEnd(h)),o.to>i)break;a=o.to,o.next()}return l}static of(e,t=!1){let i=new zr;for(let s of e instanceof uO?[e]:t?W9(e):e)i.add(s.from,s.to,s.value);return i.finish()}}st.empty=new st([],[],null,-1);function W9(n){if(n.length>1)for(let e=n[0],t=1;t<n.length;t++){let i=n[t];if(cO(e,i)>0)return n.slice().sort(cO);e=i}return n}st.empty.nextLayer=st.empty;class zr{constructor(){this.chunks=[],this.chunkPos=[],this.chunkStart=-1,this.last=null,this.lastFrom=-1e9,this.lastTo=-1e9,this.from=[],this.to=[],this.value=[],this.maxPoint=-1,this.setMaxPoint=-1,this.nextLayer=null}finishChunk(e){this.chunks.push(new wb(this.from,this.to,this.value,this.maxPoint)),this.chunkPos.push(this.chunkStart),this.chunkStart=-1,this.setMaxPoint=Math.max(this.setMaxPoint,this.maxPoint),this.maxPoint=-1,e&&(this.from=[],this.to=[],this.value=[])}add(e,t,i){this.addInner(e,t,i)||(this.nextLayer||(this.nextLayer=new zr)).add(e,t,i)}addInner(e,t,i){let s=e-this.lastTo||i.startSide-this.last.endSide;if(s<=0&&(e-this.lastFrom||i.startSide-this.last.startSide)<0)throw new Error("Ranges must be added sorted by `from` position and `startSide`");return s<0?!1:(this.from.length==250&&this.finishChunk(!0),this.chunkStart<0&&(this.chunkStart=e),this.from.push(e-this.chunkStart),this.to.push(t-this.chunkStart),this.last=i,this.lastFrom=e,this.lastTo=t,this.value.push(i),i.point&&(this.maxPoint=Math.max(this.maxPoint,t-e)),!0)}addChunk(e,t){if((e-this.lastTo||t.value[0].startSide-this.last.endSide)<0)return!1;this.from.length&&this.finishChunk(!0),this.setMaxPoint=Math.max(this.setMaxPoint,t.maxPoint),this.chunks.push(t),this.chunkPos.push(e);let i=t.value.length-1;return this.last=t.value[i],this.lastFrom=t.from[i]+e,this.lastTo=t.to[i]+e,!0}finish(){return this.finishInner(st.empty)}finishInner(e){if(this.from.length&&this.finishChunk(!1),this.chunks.length==0)return e;let t=st.create(this.chunkPos,this.chunks,this.nextLayer?this.nextLayer.finishInner(e):e,this.setMaxPoint);return this.from=null,t}}function Gx(n,e,t){let i=new Map;for(let r of n)for(let o=0;o<r.chunk.length;o++)r.chunk[o].maxPoint<=0&&i.set(r.chunk[o],r.chunkPos[o]);let s=new Set;for(let r of e)for(let o=0;o<r.chunk.length;o++){let a=i.get(r.chunk[o]);a!=null&&(t?t.mapPos(a):a)==r.chunkPos[o]&&!t?.touchesRange(a,a+r.chunk[o].length)&&s.add(r.chunk[o])}return s}class cP{constructor(e,t,i,s=0){this.layer=e,this.skip=t,this.minPoint=i,this.rank=s}get startSide(){return this.value?this.value.startSide:0}get endSide(){return this.value?this.value.endSide:0}goto(e,t=-1e9){return this.chunkIndex=this.rangeIndex=0,this.gotoInner(e,t,!1),this}gotoInner(e,t,i){for(;this.chunkIndex<this.layer.chunk.length;){let s=this.layer.chunk[this.chunkIndex];if(!(this.skip&&this.skip.has(s)||this.layer.chunkEnd(this.chunkIndex)<e||s.maxPoint<this.minPoint))break;this.chunkIndex++,i=!1}if(this.chunkIndex<this.layer.chunk.length){let s=this.layer.chunk[this.chunkIndex].findIndex(e-this.layer.chunkPos[this.chunkIndex],t,!0);(!i||this.rangeIndex<s)&&this.setRangeIndex(s)}this.next()}forward(e,t){(this.to-e||this.endSide-t)<0&&this.gotoInner(e,t,!0)}next(){for(;;)if(this.chunkIndex==this.layer.chunk.length){this.from=this.to=1e9,this.value=null;break}else{let e=this.layer.chunkPos[this.chunkIndex],t=this.layer.chunk[this.chunkIndex],i=e+t.from[this.rangeIndex];if(this.from=i,this.to=e+t.to[this.rangeIndex],this.value=t.value[this.rangeIndex],this.setRangeIndex(this.rangeIndex+1),this.minPoint<0||this.value.point&&this.to-this.from>=this.minPoint)break}}setRangeIndex(e){if(e==this.layer.chunk[this.chunkIndex].value.length){if(this.chunkIndex++,this.skip)for(;this.chunkIndex<this.layer.chunk.length&&this.skip.has(this.layer.chunk[this.chunkIndex]);)this.chunkIndex++;this.rangeIndex=0}else this.rangeIndex=e}nextChunk(){this.chunkIndex++,this.rangeIndex=0,this.next()}compare(e){return this.from-e.from||this.startSide-e.startSide||this.rank-e.rank||this.to-e.to||this.endSide-e.endSide}}class Kh{constructor(e){this.heap=e}static from(e,t=null,i=-1){let s=[];for(let r=0;r<e.length;r++)for(let o=e[r];!o.isEmpty;o=o.nextLayer)o.maxPoint>=i&&s.push(new cP(o,t,i,r));return s.length==1?s[0]:new Kh(s)}get startSide(){return this.value?this.value.startSide:0}goto(e,t=-1e9){for(let i of this.heap)i.goto(e,t);for(let i=this.heap.length>>1;i>=0;i--)Um(this.heap,i);return this.next(),this}forward(e,t){for(let i of this.heap)i.forward(e,t);for(let i=this.heap.length>>1;i>=0;i--)Um(this.heap,i);(this.to-e||this.value.endSide-t)<0&&this.next()}next(){if(this.heap.length==0)this.from=this.to=1e9,this.value=null,this.rank=-1;else{let e=this.heap[0];this.from=e.from,this.to=e.to,this.value=e.value,this.rank=e.rank,e.value&&e.next(),Um(this.heap,0)}}}function Um(n,e){for(let t=n[e];;){let i=(e<<1)+1;if(i>=n.length)break;let s=n[i];if(i+1<n.length&&s.compare(n[i+1])>=0&&(s=n[i+1],i++),t.compare(s)<0)break;n[i]=t,n[e]=s,e=i}}class ql{constructor(e,t,i){this.minPoint=i,this.active=[],this.activeTo=[],this.activeRank=[],this.minActive=-1,this.point=null,this.pointFrom=0,this.pointRank=0,this.to=-1e9,this.endSide=0,this.openStart=-1,this.cursor=Kh.from(e,t,i)}goto(e,t=-1e9){return this.cursor.goto(e,t),this.active.length=this.activeTo.length=this.activeRank.length=0,this.minActive=-1,this.to=e,this.endSide=t,this.openStart=-1,this.next(),this}forward(e,t){for(;this.minActive>-1&&(this.activeTo[this.minActive]-e||this.active[this.minActive].endSide-t)<0;)this.removeActive(this.minActive);this.cursor.forward(e,t)}removeActive(e){Pc(this.active,e),Pc(this.activeTo,e),Pc(this.activeRank,e),this.minActive=Jx(this.active,this.activeTo)}addActive(e){let t=0,{value:i,to:s,rank:r}=this.cursor;for(;t<this.activeRank.length&&this.activeRank[t]<=r;)t++;Dc(this.active,t,i),Dc(this.activeTo,t,s),Dc(this.activeRank,t,r),e&&Dc(e,t,this.cursor.from),this.minActive=Jx(this.active,this.activeTo)}next(){let e=this.to,t=this.point;this.point=null;let i=this.openStart<0?[]:null,s=0;for(;;){let r=this.minActive;if(r>-1&&(this.activeTo[r]-this.cursor.from||this.active[r].endSide-this.cursor.startSide)<0){if(this.activeTo[r]>e){this.to=this.activeTo[r],this.endSide=this.active[r].endSide;break}this.removeActive(r),i&&Pc(i,r)}else if(this.cursor.value)if(this.cursor.from>e){this.to=this.cursor.from,this.endSide=this.cursor.startSide;break}else{let o=this.cursor.value;if(!o.point)this.addActive(i),this.cursor.next();else if(t&&this.cursor.to==this.to&&this.cursor.from<this.cursor.to)this.cursor.next();else{this.point=o,this.pointFrom=this.cursor.from,this.pointRank=this.cursor.rank,this.to=this.cursor.to,this.endSide=o.endSide,this.cursor.from<e&&(s=1),this.cursor.next(),this.forward(this.to,this.endSide);break}}else{this.to=this.endSide=1e9;break}}if(i){let r=0;for(;r<i.length&&i[r]<e;)r++;this.openStart=r+s}}activeForPoint(e){if(!this.active.length)return this.active;let t=[];for(let i=this.active.length-1;i>=0&&!(this.activeRank[i]<this.pointRank);i--)(this.activeTo[i]>e||this.activeTo[i]==e&&this.active[i].endSide>=this.point.endSide)&&t.push(this.active[i]);return t.reverse()}openEnd(e){let t=0;for(let i=this.activeTo.length-1;i>=0&&this.activeTo[i]>e;i--)t++;return t}}function Kx(n,e,t,i,s,r){n.goto(e),t.goto(i);let o=i+s,a=i,l=i-e;for(;;){let h=n.to+l-t.to||n.endSide-t.endSide,u=h<0?n.to+l:t.to,c=Math.min(u,o);if(n.point||t.point?n.point&&t.point&&(n.point==t.point||n.point.eq(t.point))&&dO(n.activeForPoint(n.to+l),t.activeForPoint(t.to))||r.comparePoint(a,c,n.point,t.point):c>a&&!dO(n.active,t.active)&&r.compareRange(a,c,n.active,t.active),u>o)break;a=u,h<=0&&n.next(),h>=0&&t.next()}}function dO(n,e){if(n.length!=e.length)return!1;for(let t=0;t<n.length;t++)if(n[t]!=e[t]&&!n[t].eq(e[t]))return!1;return!0}function Pc(n,e){for(let t=e,i=n.length-1;t<i;t++)n[t]=n[t+1];n.pop()}function Dc(n,e,t){for(let i=n.length-1;i>=e;i--)n[i+1]=n[i];n[e]=t}function Jx(n,e){let t=-1,i=1e9;for(let s=0;s<e.length;s++)(e[s]-i||n[s].endSide-n[t].endSide)<0&&(t=s,i=e[s]);return t}function Au(n,e,t=n.length){let i=0;for(let s=0;s<t;)n.charCodeAt(s)==9?(i+=e-i%e,s++):(i++,s=an(n,s));return i}function fO(n,e,t,i){for(let s=0,r=0;;){if(r>=e)return s;if(s==n.length)break;r+=n.charCodeAt(s)==9?t-r%t:1,s=an(n,s)}return i===!0?-1:n.length}function nf(n){let e;return n.nodeType==11?e=n.getSelection?n:n.ownerDocument:e=n,e.getSelection()}function Za(n,e){return e?n==e||n.contains(e.nodeType!=1?e.parentNode:e):!1}function Z9(){let n=document.activeElement;for(;n&&n.shadowRoot;)n=n.shadowRoot.activeElement;return n}function pO(n,e){if(!e.anchorNode)return!1;try{return Za(n,e.anchorNode)}catch{return!1}}function Jh(n){return n.nodeType==3?eu(n,0,n.nodeValue.length).getClientRects():n.nodeType==1?n.getClientRects():[]}function sf(n,e,t,i){return t?eT(n,e,t,i,-1)||eT(n,e,t,i,1):!1}function mO(n){for(var e=0;;e++)if(n=n.previousSibling,!n)return e}function eT(n,e,t,i,s){for(;;){if(n==t&&e==i)return!0;if(e==(s<0?0:rf(n))){if(n.nodeName=="DIV")return!1;let r=n.parentNode;if(!r||r.nodeType!=1)return!1;e=mO(n)+(s<0?0:1),n=r}else if(n.nodeType==1){if(n=n.childNodes[e+(s<0?-1:0)],n.nodeType==1&&n.contentEditable=="false")return!1;e=s<0?rf(n):0}else return!1}}function rf(n){return n.nodeType==3?n.nodeValue.length:n.childNodes.length}const dP={left:0,right:0,top:0,bottom:0};function cp(n,e){let t=e?n.left:n.right;return{left:t,right:t,top:n.top,bottom:n.bottom}}function Y9(n){return{left:0,right:n.innerWidth,top:0,bottom:n.innerHeight}}function G9(n,e,t,i,s,r,o,a){let l=n.ownerDocument,h=l.defaultView;for(let u=n;u;)if(u.nodeType==1){let c,f=u==l.body;if(f)c=Y9(h);else{if(u.scrollHeight<=u.clientHeight&&u.scrollWidth<=u.clientWidth){u=u.parentNode;continue}let y=u.getBoundingClientRect();c={left:y.left,right:y.left+u.clientWidth,top:y.top,bottom:y.top+u.clientHeight}}let p=0,b=0;if(s=="nearest")e.top<c.top?(b=-(c.top-e.top+o),t>0&&e.bottom>c.bottom+b&&(b=e.bottom-c.bottom+b+o)):e.bottom>c.bottom&&(b=e.bottom-c.bottom+o,t<0&&e.top-b<c.top&&(b=-(c.top+b-e.top+o)));else{let y=e.bottom-e.top,_=c.bottom-c.top;b=(s=="center"&&y<=_?e.top+y/2-_/2:s=="start"||s=="center"&&t<0?e.top-o:e.bottom-_+o)-c.top}if(i=="nearest"?e.left<c.left?(p=-(c.left-e.left+r),t>0&&e.right>c.right+p&&(p=e.right-c.right+p+r)):e.right>c.right&&(p=e.right-c.right+r,t<0&&e.left<c.left+p&&(p=-(c.left+p-e.left+r))):p=(i=="center"?e.left+(e.right-e.left)/2-(c.right-c.left)/2:i=="start"==a?e.left-r:e.right-(c.right-c.left)+r)-c.left,p||b)if(f)h.scrollBy(p,b);else{if(b){let y=u.scrollTop;u.scrollTop+=b,b=u.scrollTop-y}if(p){let y=u.scrollLeft;u.scrollLeft+=p,p=u.scrollLeft-y}e={left:e.left-p,top:e.top-b,right:e.right-p,bottom:e.bottom-b}}if(f)break;u=u.assignedSlot||u.parentNode,i=s="nearest"}else if(u.nodeType==11)u=u.host;else break}class K9{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}eq(e){return this.anchorNode==e.anchorNode&&this.anchorOffset==e.anchorOffset&&this.focusNode==e.focusNode&&this.focusOffset==e.focusOffset}setRange(e){this.set(e.anchorNode,e.anchorOffset,e.focusNode,e.focusOffset)}set(e,t,i,s){this.anchorNode=e,this.anchorOffset=t,this.focusNode=i,this.focusOffset=s}}let Jo=null;function fP(n){if(n.setActive)return n.setActive();if(Jo)return n.focus(Jo);let e=[];for(let t=n;t&&(e.push(t,t.scrollTop,t.scrollLeft),t!=t.ownerDocument);t=t.parentNode);if(n.focus(Jo==null?{get preventScroll(){return Jo={preventScroll:!0},!0}}:void 0),!Jo){Jo=!1;for(let t=0;t<e.length;){let i=e[t++],s=e[t++],r=e[t++];i.scrollTop!=s&&(i.scrollTop=s),i.scrollLeft!=r&&(i.scrollLeft=r)}}}let tT;function eu(n,e,t=e){let i=tT||(tT=document.createRange());return i.setEnd(n,t),i.setStart(n,e),i}function Dh(n,e,t){let i={key:e,code:e,keyCode:t,which:t,cancelable:!0},s=new KeyboardEvent("keydown",i);s.synthetic=!0,n.dispatchEvent(s);let r=new KeyboardEvent("keyup",i);return r.synthetic=!0,n.dispatchEvent(r),s.defaultPrevented||r.defaultPrevented}function J9(n){for(;n;){if(n&&(n.nodeType==9||n.nodeType==11&&n.host))return n;n=n.assignedSlot||n.parentNode}return null}function pP(n){for(;n.attributes.length;)n.removeAttributeNode(n.attributes[0])}class hi{constructor(e,t,i=!0){this.node=e,this.offset=t,this.precise=i}static before(e,t){return new hi(e.parentNode,mO(e),t)}static after(e,t){return new hi(e.parentNode,mO(e)+1,t)}}const _b=[];class Mt{constructor(){this.parent=null,this.dom=null,this.dirty=2}get editorView(){if(!this.parent)throw new Error("Accessing view in orphan content view");return this.parent.editorView}get overrideDOMText(){return null}get posAtStart(){return this.parent?this.parent.posBefore(this):0}get posAtEnd(){return this.posAtStart+this.length}posBefore(e){let t=this.posAtStart;for(let i of this.children){if(i==e)return t;t+=i.length+i.breakAfter}throw new RangeError("Invalid child in posBefore")}posAfter(e){return this.posBefore(e)+e.length}coordsAt(e,t){return null}sync(e){if(this.dirty&2){let t=this.dom,i=null,s;for(let r of this.children){if(r.dirty){if(!r.dom&&(s=i?i.nextSibling:t.firstChild)){let o=Mt.get(s);(!o||!o.parent&&o.constructor==r.constructor)&&r.reuseDOM(s)}r.sync(e),r.dirty=0}if(s=i?i.nextSibling:t.firstChild,e&&!e.written&&e.node==t&&s!=r.dom&&(e.written=!0),r.dom.parentNode==t)for(;s&&s!=r.dom;)s=iT(s);else t.insertBefore(r.dom,s);i=r.dom}for(s=i?i.nextSibling:t.firstChild,s&&e&&e.node==t&&(e.written=!0);s;)s=iT(s)}else if(this.dirty&1)for(let t of this.children)t.dirty&&(t.sync(e),t.dirty=0)}reuseDOM(e){}localPosFromDOM(e,t){let i;if(e==this.dom)i=this.dom.childNodes[t];else{let s=rf(e)==0?0:t==0?-1:1;for(;;){let r=e.parentNode;if(r==this.dom)break;s==0&&r.firstChild!=r.lastChild&&(e==r.firstChild?s=-1:s=1),e=r}s<0?i=e:i=e.nextSibling}if(i==this.dom.firstChild)return 0;for(;i&&!Mt.get(i);)i=i.nextSibling;if(!i)return this.length;for(let s=0,r=0;;s++){let o=this.children[s];if(o.dom==i)return r;r+=o.length+o.breakAfter}}domBoundsAround(e,t,i=0){let s=-1,r=-1,o=-1,a=-1;for(let l=0,h=i,u=i;l<this.children.length;l++){let c=this.children[l],f=h+c.length;if(h<e&&f>t)return c.domBoundsAround(e,t,h);if(f>=e&&s==-1&&(s=l,r=h),h>t&&c.dom.parentNode==this.dom){o=l,a=u;break}u=f,h=f+c.breakAfter}return{from:r,to:a<0?i+this.length:a,startDOM:(s?this.children[s-1].dom.nextSibling:null)||this.dom.firstChild,endDOM:o<this.children.length&&o>=0?this.children[o].dom:null}}markDirty(e=!1){this.dirty|=2,this.markParentsDirty(e)}markParentsDirty(e){for(let t=this.parent;t;t=t.parent){if(e&&(t.dirty|=2),t.dirty&1)return;t.dirty|=1,e=!1}}setParent(e){this.parent!=e&&(this.parent=e,this.dirty&&this.markParentsDirty(!0))}setDOM(e){this.dom&&(this.dom.cmView=null),this.dom=e,e.cmView=this}get rootView(){for(let e=this;;){let t=e.parent;if(!t)return e;e=t}}replaceChildren(e,t,i=_b){this.markDirty();for(let s=e;s<t;s++){let r=this.children[s];r.parent==this&&r.destroy()}this.children.splice(e,t-e,...i);for(let s=0;s<i.length;s++)i[s].setParent(this)}ignoreMutation(e){return!1}ignoreEvent(e){return!1}childCursor(e=this.length){return new mP(this.children,e,this.children.length)}childPos(e,t=1){return this.childCursor().findPos(e,t)}toString(){let e=this.constructor.name.replace("View","");return e+(this.children.length?"("+this.children.join()+")":this.length?"["+(e=="Text"?this.text:this.length)+"]":"")+(this.breakAfter?"#":"")}static get(e){return e.cmView}get isEditable(){return!0}merge(e,t,i,s,r,o){return!1}become(e){return!1}getSide(){return 0}destroy(){this.parent=null}}Mt.prototype.breakAfter=0;function iT(n){let e=n.nextSibling;return n.parentNode.removeChild(n),e}class mP{constructor(e,t,i){this.children=e,this.pos=t,this.i=i,this.off=0}findPos(e,t=1){for(;;){if(e>this.pos||e==this.pos&&(t>0||this.i==0||this.children[this.i-1].breakAfter))return this.off=e-this.pos,this;let i=this.children[--this.i];this.pos-=i.length+i.breakAfter}}}function gP(n,e,t,i,s,r,o,a,l){let{children:h}=n,u=h.length?h[e]:null,c=r.length?r[r.length-1]:null,f=c?c.breakAfter:o;if(!(e==i&&u&&!o&&!f&&r.length<2&&u.merge(t,s,r.length?c:null,t==0,a,l))){if(i<h.length){let p=h[i];p&&s<p.length?(e==i&&(p=p.split(s),s=0),!f&&c&&p.merge(0,s,c,!0,0,l)?r[r.length-1]=p:(s&&p.merge(0,s,null,!1,0,l),r.push(p))):p?.breakAfter&&(c?c.breakAfter=1:o=1),i++}for(u&&(u.breakAfter=o,t>0&&(!o&&r.length&&u.merge(t,u.length,r[0],!1,a,0)?u.breakAfter=r.shift().breakAfter:(t<u.length||u.children.length&&u.children[u.children.length-1].length==0)&&u.merge(t,u.length,null,!1,a,0),e++));e<i&&r.length;)if(h[i-1].become(r[r.length-1]))i--,r.pop(),l=r.length?0:a;else if(h[e].become(r[0]))e++,r.shift(),a=r.length?0:l;else break;!r.length&&e&&i<h.length&&!h[e-1].breakAfter&&h[i].merge(0,0,h[e-1],!1,a,l)&&e--,(e<i||r.length)&&n.replaceChildren(e,i,r)}}function OP(n,e,t,i,s,r){let o=n.childCursor(),{i:a,off:l}=o.findPos(t,1),{i:h,off:u}=o.findPos(e,-1),c=e-t;for(let f of i)c+=f.length;n.length+=c,gP(n,h,u,a,l,i,0,s,r)}let on=typeof navigator<"u"?navigator:{userAgent:"",vendor:"",platform:""},gO=typeof document<"u"?document:{documentElement:{style:{}}};const OO=/Edge\/(\d+)/.exec(on.userAgent),yP=/MSIE \d/.test(on.userAgent),yO=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(on.userAgent),dp=!!(yP||yO||OO),nT=!dp&&/gecko\/(\d+)/i.test(on.userAgent),qm=!dp&&/Chrome\/(\d+)/.exec(on.userAgent),eV="webkitFontSmoothing"in gO.documentElement.style,bP=!dp&&/Apple Computer/.test(on.vendor),sT=bP&&(/Mobile\/\w+/.test(on.userAgent)||on.maxTouchPoints>2);var _e={mac:sT||/Mac/.test(on.platform),windows:/Win/.test(on.platform),linux:/Linux|X11/.test(on.platform),ie:dp,ie_version:yP?gO.documentMode||6:yO?+yO[1]:OO?+OO[1]:0,gecko:nT,gecko_version:nT?+(/Firefox\/(\d+)/.exec(on.userAgent)||[0,0])[1]:0,chrome:!!qm,chrome_version:qm?+qm[1]:0,ios:sT,android:/Android\b/.test(on.userAgent),safari:bP,webkit_version:eV?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0,tabSize:gO.documentElement.style.tabSize!=null?"tab-size":"-moz-tab-size"};const tV=256;class jr extends Mt{constructor(e){super(),this.text=e}get length(){return this.text.length}createDOM(e){this.setDOM(e||document.createTextNode(this.text))}sync(e){this.dom||this.createDOM(),this.dom.nodeValue!=this.text&&(e&&e.node==this.dom&&(e.written=!0),this.dom.nodeValue=this.text)}reuseDOM(e){e.nodeType==3&&this.createDOM(e)}merge(e,t,i){return i&&(!(i instanceof jr)||this.length-(t-e)+i.length>tV)?!1:(this.text=this.text.slice(0,e)+(i?i.text:"")+this.text.slice(t),this.markDirty(),!0)}split(e){let t=new jr(this.text.slice(e));return this.text=this.text.slice(0,e),this.markDirty(),t}localPosFromDOM(e,t){return e==this.dom?t:t?this.text.length:0}domAtPos(e){return new hi(this.dom,e)}domBoundsAround(e,t,i){return{from:i,to:i+this.length,startDOM:this.dom,endDOM:this.dom.nextSibling}}coordsAt(e,t){return bO(this.dom,e,t)}}class Is extends Mt{constructor(e,t=[],i=0){super(),this.mark=e,this.children=t,this.length=i;for(let s of t)s.setParent(this)}setAttrs(e){if(pP(e),this.mark.class&&(e.className=this.mark.class),this.mark.attrs)for(let t in this.mark.attrs)e.setAttribute(t,this.mark.attrs[t]);return e}reuseDOM(e){e.nodeName==this.mark.tagName.toUpperCase()&&(this.setDOM(e),this.dirty|=6)}sync(e){this.dom?this.dirty&4&&this.setAttrs(this.dom):this.setDOM(this.setAttrs(document.createElement(this.mark.tagName))),super.sync(e)}merge(e,t,i,s,r,o){return i&&(!(i instanceof Is&&i.mark.eq(this.mark))||e&&r<=0||t<this.length&&o<=0)?!1:(OP(this,e,t,i?i.children:[],r-1,o-1),this.markDirty(),!0)}split(e){let t=[],i=0,s=-1,r=0;for(let a of this.children){let l=i+a.length;l>e&&t.push(i<e?a.split(e-i):a),s<0&&i>=e&&(s=r),i=l,r++}let o=this.length-e;return this.length=e,s>-1&&(this.children.length=s,this.markDirty()),new Is(this.mark,t,o)}domAtPos(e){return xP(this.dom,this.children,e)}coordsAt(e,t){return wP(this,e,t)}}function bO(n,e,t){let i=n.nodeValue.length;e>i&&(e=i);let s=e,r=e,o=0;e==0&&t<0||e==i&&t>=0?_e.chrome||_e.gecko||(e?(s--,o=1):r<i&&(r++,o=-1)):t<0?s--:r<i&&r++;let a=eu(n,s,r).getClientRects();if(!a.length)return dP;let l=a[(o?o<0:t>=0)?0:a.length-1];return _e.safari&&!o&&l.width==0&&(l=Array.prototype.find.call(a,h=>h.width)||l),o?cp(l,o<0):l||null}class Rr extends Mt{constructor(e,t,i){super(),this.widget=e,this.length=t,this.side=i,this.prevWidget=null}static create(e,t,i){return new(e.customView||Rr)(e,t,i)}split(e){let t=Rr.create(this.widget,this.length-e,this.side);return this.length-=e,t}sync(){(!this.dom||!this.widget.updateDOM(this.dom))&&(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(this.editorView)),this.dom.contentEditable="false")}getSide(){return this.side}merge(e,t,i,s,r,o){return i&&(!(i instanceof Rr)||!this.widget.compare(i.widget)||e>0&&r<=0||t<this.length&&o<=0)?!1:(this.length=e+(i?i.length:0)+(this.length-t),!0)}become(e){return e.length==this.length&&e instanceof Rr&&e.side==this.side&&this.widget.constructor==e.widget.constructor?(this.widget.eq(e.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=e.widget,!0):!1}ignoreMutation(){return!0}ignoreEvent(e){return this.widget.ignoreEvent(e)}get overrideDOMText(){if(this.length==0)return nt.empty;let e=this;for(;e.parent;)e=e.parent;let t=e.editorView,i=t&&t.state.doc,s=this.posAtStart;return i?i.slice(s,s+this.length):nt.empty}domAtPos(e){return e==0?hi.before(this.dom):hi.after(this.dom,e==this.length)}domBoundsAround(){return null}coordsAt(e,t){let i=this.dom.getClientRects(),s=null;if(!i.length)return dP;for(let r=e>0?i.length-1:0;s=i[r],!(e>0?r==0:r==i.length-1||s.top<s.bottom);r+=e>0?-1:1);return e==0&&t>0||e==this.length&&t<=0?s:cp(s,e==0)}get isEditable(){return!1}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}}class vP extends Rr{domAtPos(e){let{topView:t,text:i}=this.widget;return t?vO(e,0,t,i,(s,r)=>s.domAtPos(r),s=>new hi(i,Math.min(s,i.nodeValue.length))):new hi(i,Math.min(e,i.nodeValue.length))}sync(){this.setDOM(this.widget.toDOM())}localPosFromDOM(e,t){let{topView:i,text:s}=this.widget;return i?SP(e,t,i,s):Math.min(t,this.length)}ignoreMutation(){return!1}get overrideDOMText(){return null}coordsAt(e,t){let{topView:i,text:s}=this.widget;return i?vO(e,t,i,s,(r,o,a)=>r.coordsAt(o,a),(r,o)=>bO(s,r,o)):bO(s,e,t)}destroy(){var e;super.destroy(),(e=this.widget.topView)===null||e===void 0||e.destroy()}get isEditable(){return!0}}function vO(n,e,t,i,s,r){if(t instanceof Is){for(let o of t.children){let a=Za(o.dom,i),l=a?i.nodeValue.length:o.length;if(n<l||n==l&&o.getSide()<=0)return a?vO(n,e,o,i,s,r):s(o,n,e);n-=l}return s(t,t.length,-1)}else return t.dom==i?r(n,e):s(t,n,e)}function SP(n,e,t,i){if(t instanceof Is)for(let s of t.children){let r=0,o=Za(s.dom,i);if(Za(s.dom,n))return r+(o?SP(n,e,s,i):s.localPosFromDOM(n,e));r+=o?i.nodeValue.length:s.length}else if(t.dom==i)return Math.min(e,i.nodeValue.length);return t.localPosFromDOM(n,e)}class Ya extends Mt{constructor(e){super(),this.side=e}get length(){return 0}merge(){return!1}become(e){return e instanceof Ya&&e.side==this.side}split(){return new Ya(this.side)}sync(){if(!this.dom){let e=document.createElement("img");e.className="cm-widgetBuffer",e.setAttribute("aria-hidden","true"),this.setDOM(e)}}getSide(){return this.side}domAtPos(e){return hi.before(this.dom)}localPosFromDOM(){return 0}domBoundsAround(){return null}coordsAt(e){let t=this.dom.getBoundingClientRect(),i=iV(this,this.side>0?-1:1);return i&&i.top<t.bottom&&i.bottom>t.top?{left:t.left,right:t.right,top:i.top,bottom:i.bottom}:t}get overrideDOMText(){return nt.empty}}jr.prototype.children=Rr.prototype.children=Ya.prototype.children=_b;function iV(n,e){let t=n.parent,i=t?t.children.indexOf(n):-1;for(;t&&i>=0;)if(e<0?i>0:i<t.children.length){let s=t.children[i+e];if(s instanceof jr){let r=s.coordsAt(e<0?s.length:0,e);if(r)return r}i+=e}else if(t instanceof Is&&t.parent)i=t.parent.children.indexOf(t)+(e<0?0:1),t=t.parent;else{let s=t.dom.lastChild;if(s&&s.nodeName=="BR")return s.getClientRects()[0];break}}function xP(n,e,t){let i=0;for(let s=0;i<e.length;i++){let r=e[i],o=s+r.length;if(!(o==s&&r.getSide()<=0)){if(t>s&&t<o&&r.dom.parentNode==n)return r.domAtPos(t-s);if(t<=s)break;s=o}}for(;i>0;i--){let s=e[i-1].dom;if(s.parentNode==n)return hi.after(s)}return new hi(n,0)}function TP(n,e,t){let i,{children:s}=n;t>0&&e instanceof Is&&s.length&&(i=s[s.length-1])instanceof Is&&i.mark.eq(e.mark)?TP(i,e.children[0],t-1):(s.push(e),e.setParent(n)),n.length+=e.length}function wP(n,e,t){for(let r=0,o=0;o<n.children.length;o++){let a=n.children[o],l=r+a.length,h;if((t<=0||l==n.length||a.getSide()>0?l>=e:l>e)&&(e<l||o+1==n.children.length||(h=n.children[o+1]).length||h.getSide()>0)){let u=0;if(l==r){if(a.getSide()<=0)continue;u=t=-a.getSide()}let c=a.coordsAt(Math.max(0,e-r),t);return u&&c?cp(c,t<0):c}r=l}let i=n.dom.lastChild;if(!i)return n.dom.getBoundingClientRect();let s=Jh(i);return s[s.length-1]||null}function SO(n,e){for(let t in n)t=="class"&&e.class?e.class+=" "+n.class:t=="style"&&e.style?e.style+=";"+n.style:e[t]=n[t];return e}function kb(n,e){if(n==e)return!0;if(!n||!e)return!1;let t=Object.keys(n),i=Object.keys(e);if(t.length!=i.length)return!1;for(let s of t)if(i.indexOf(s)==-1||n[s]!==e[s])return!1;return!0}function xO(n,e,t){let i=null;if(e)for(let s in e)t&&s in t||n.removeAttribute(i=s);if(t)for(let s in t)e&&e[s]==t[s]||n.setAttribute(i=s,t[s]);return!!i}class Yr{eq(e){return!1}updateDOM(e){return!1}compare(e){return this==e||this.constructor==e.constructor&&this.eq(e)}get estimatedHeight(){return-1}ignoreEvent(e){return!0}get customView(){return null}destroy(e){}}var mt=(function(n){return n[n.Text=0]="Text",n[n.WidgetBefore=1]="WidgetBefore",n[n.WidgetAfter=2]="WidgetAfter",n[n.WidgetRange=3]="WidgetRange",n})(mt||(mt={}));class Ie extends $o{constructor(e,t,i,s){super(),this.startSide=e,this.endSide=t,this.widget=i,this.spec=s}get heightRelevant(){return!1}static mark(e){return new fp(e)}static widget(e){let t=e.side||0,i=!!e.block;return t+=i?t>0?3e8:-4e8:t>0?1e8:-1e8,new Qo(e,t,t,i,e.widget||null,!1)}static replace(e){let t=!!e.block,i,s;if(e.isBlockGap)i=-5e8,s=4e8;else{let{start:r,end:o}=_P(e,t);i=(r?t?-3e8:-1:5e8)-1,s=(o?t?2e8:1:-6e8)+1}return new Qo(e,i,s,t,e.widget||null,!0)}static line(e){return new Pu(e)}static set(e,t=!1){return st.of(e,t)}hasHeight(){return this.widget?this.widget.estimatedHeight>-1:!1}}Ie.none=st.empty;class fp extends Ie{constructor(e){let{start:t,end:i}=_P(e);super(t?-1:5e8,i?1:-6e8,null,e),this.tagName=e.tagName||"span",this.class=e.class||"",this.attrs=e.attributes||null}eq(e){return this==e||e instanceof fp&&this.tagName==e.tagName&&this.class==e.class&&kb(this.attrs,e.attrs)}range(e,t=e){if(e>=t)throw new RangeError("Mark decorations may not be empty");return super.range(e,t)}}fp.prototype.point=!1;class Pu extends Ie{constructor(e){super(-2e8,-2e8,null,e)}eq(e){return e instanceof Pu&&kb(this.spec.attributes,e.spec.attributes)}range(e,t=e){if(t!=e)throw new RangeError("Line decoration ranges must be zero-length");return super.range(e,t)}}Pu.prototype.mapMode=Li.TrackBefore;Pu.prototype.point=!0;class Qo extends Ie{constructor(e,t,i,s,r,o){super(t,i,r,e),this.block=s,this.isReplace=o,this.mapMode=s?t<=0?Li.TrackBefore:Li.TrackAfter:Li.TrackDel}get type(){return this.startSide<this.endSide?mt.WidgetRange:this.startSide<=0?mt.WidgetBefore:mt.WidgetAfter}get heightRelevant(){return this.block||!!this.widget&&this.widget.estimatedHeight>=5}eq(e){return e instanceof Qo&&nV(this.widget,e.widget)&&this.block==e.block&&this.startSide==e.startSide&&this.endSide==e.endSide}range(e,t=e){if(this.isReplace&&(e>t||e==t&&this.startSide>0&&this.endSide<=0))throw new RangeError("Invalid range for replacement decoration");if(!this.isReplace&&t!=e)throw new RangeError("Widget decorations can only have zero-length ranges");return super.range(e,t)}}Qo.prototype.point=!0;function _P(n,e=!1){let{inclusiveStart:t,inclusiveEnd:i}=n;return t==null&&(t=n.inclusive),i==null&&(i=n.inclusive),{start:t??e,end:i??e}}function nV(n,e){return n==e||!!(n&&e&&n.compare(e))}function TO(n,e,t,i=0){let s=t.length-1;s>=0&&t[s]+i>=n?t[s]=Math.max(t[s],e):t.push(n,e)}class Qi extends Mt{constructor(){super(...arguments),this.children=[],this.length=0,this.prevAttrs=void 0,this.attrs=null,this.breakAfter=0}merge(e,t,i,s,r,o){if(i){if(!(i instanceof Qi))return!1;this.dom||i.transferDOM(this)}return s&&this.setDeco(i?i.attrs:null),OP(this,e,t,i?i.children:[],r,o),!0}split(e){let t=new Qi;if(t.breakAfter=this.breakAfter,this.length==0)return t;let{i,off:s}=this.childPos(e);s&&(t.append(this.children[i].split(s),0),this.children[i].merge(s,this.children[i].length,null,!1,0,0),i++);for(let r=i;r<this.children.length;r++)t.append(this.children[r],0);for(;i>0&&this.children[i-1].length==0;)this.children[--i].destroy();return this.children.length=i,this.markDirty(),this.length=e,t}transferDOM(e){this.dom&&(this.markDirty(),e.setDOM(this.dom),e.prevAttrs=this.prevAttrs===void 0?this.attrs:this.prevAttrs,this.prevAttrs=void 0,this.dom=null)}setDeco(e){kb(this.attrs,e)||(this.dom&&(this.prevAttrs=this.attrs,this.markDirty()),this.attrs=e)}append(e,t){TP(this,e,t)}addLineDeco(e){let t=e.spec.attributes,i=e.spec.class;t&&(this.attrs=SO(t,this.attrs||{})),i&&(this.attrs=SO({class:i},this.attrs||{}))}domAtPos(e){return xP(this.dom,this.children,e)}reuseDOM(e){e.nodeName=="DIV"&&(this.setDOM(e),this.dirty|=6)}sync(e){var t;this.dom?this.dirty&4&&(pP(this.dom),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0):(this.setDOM(document.createElement("div")),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0),this.prevAttrs!==void 0&&(xO(this.dom,this.prevAttrs,this.attrs),this.dom.classList.add("cm-line"),this.prevAttrs=void 0),super.sync(e);let i=this.dom.lastChild;for(;i&&Mt.get(i)instanceof Is;)i=i.lastChild;if(!i||!this.length||i.nodeName!="BR"&&((t=Mt.get(i))===null||t===void 0?void 0:t.isEditable)==!1&&(!_e.ios||!this.children.some(s=>s instanceof jr))){let s=document.createElement("BR");s.cmIgnore=!0,this.dom.appendChild(s)}}measureTextSize(){if(this.children.length==0||this.length>20)return null;let e=0;for(let t of this.children){if(!(t instanceof jr))return null;let i=Jh(t.dom);if(i.length!=1)return null;e+=i[0].width}return{lineHeight:this.dom.getBoundingClientRect().height,charWidth:e/this.length}}coordsAt(e,t){return wP(this,e,t)}become(e){return!1}get type(){return mt.Text}static find(e,t){for(let i=0,s=0;i<e.children.length;i++){let r=e.children[i],o=s+r.length;if(o>=t){if(r instanceof Qi)return r;if(o>t)break}s=o+r.breakAfter}return null}}class Ao extends Mt{constructor(e,t,i){super(),this.widget=e,this.length=t,this.type=i,this.breakAfter=0,this.prevWidget=null}merge(e,t,i,s,r,o){return i&&(!(i instanceof Ao)||!this.widget.compare(i.widget)||e>0&&r<=0||t<this.length&&o<=0)?!1:(this.length=e+(i?i.length:0)+(this.length-t),!0)}domAtPos(e){return e==0?hi.before(this.dom):hi.after(this.dom,e==this.length)}split(e){let t=this.length-e;this.length=e;let i=new Ao(this.widget,t,this.type);return i.breakAfter=this.breakAfter,i}get children(){return _b}sync(){(!this.dom||!this.widget.updateDOM(this.dom))&&(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(this.editorView)),this.dom.contentEditable="false")}get overrideDOMText(){return this.parent?this.parent.view.state.doc.slice(this.posAtStart,this.posAtEnd):nt.empty}domBoundsAround(){return null}become(e){return e instanceof Ao&&e.type==this.type&&e.widget.constructor==this.widget.constructor?(e.widget.eq(this.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=e.widget,this.length=e.length,this.breakAfter=e.breakAfter,!0):!1}ignoreMutation(){return!0}ignoreEvent(e){return this.widget.ignoreEvent(e)}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}}class Cb{constructor(e,t,i,s){this.doc=e,this.pos=t,this.end=i,this.disallowBlockEffectsFor=s,this.content=[],this.curLine=null,this.breakAtStart=0,this.pendingBuffer=0,this.atCursorPos=!0,this.openStart=-1,this.openEnd=-1,this.text="",this.textOff=0,this.cursor=e.iter(),this.skip=t}posCovered(){if(this.content.length==0)return!this.breakAtStart&&this.doc.lineAt(this.pos).from!=this.pos;let e=this.content[this.content.length-1];return!e.breakAfter&&!(e instanceof Ao&&e.type==mt.WidgetBefore)}getLine(){return this.curLine||(this.content.push(this.curLine=new Qi),this.atCursorPos=!0),this.curLine}flushBuffer(e){this.pendingBuffer&&(this.curLine.append(Mc(new Ya(-1),e),e.length),this.pendingBuffer=0)}addBlockWidget(e){this.flushBuffer([]),this.curLine=null,this.content.push(e)}finish(e){e?this.pendingBuffer=0:this.flushBuffer([]),this.posCovered()||this.getLine()}buildText(e,t,i){for(;e>0;){if(this.textOff==this.text.length){let{value:r,lineBreak:o,done:a}=this.cursor.next(this.skip);if(this.skip=0,a)throw new Error("Ran out of text content when drawing inline views");if(o){this.posCovered()||this.getLine(),this.content.length?this.content[this.content.length-1].breakAfter=1:this.breakAtStart=1,this.flushBuffer([]),this.curLine=null,e--;continue}else this.text=r,this.textOff=0}let s=Math.min(this.text.length-this.textOff,e,512);this.flushBuffer(t.slice(0,i)),this.getLine().append(Mc(new jr(this.text.slice(this.textOff,this.textOff+s)),t),i),this.atCursorPos=!0,this.textOff+=s,e-=s,i=0}}span(e,t,i,s){this.buildText(t-e,i,s),this.pos=t,this.openStart<0&&(this.openStart=s)}point(e,t,i,s,r,o){if(this.disallowBlockEffectsFor[o]&&i instanceof Qo){if(i.block)throw new RangeError("Block decorations may not be specified via plugins");if(t>this.doc.lineAt(this.pos).to)throw new RangeError("Decorations that replace line breaks may not be specified via plugins")}let a=t-e;if(i instanceof Qo)if(i.block){let{type:l}=i;l==mt.WidgetAfter&&!this.posCovered()&&this.getLine(),this.addBlockWidget(new Ao(i.widget||new rT("div"),a,l))}else{let l=Rr.create(i.widget||new rT("span"),a,i.startSide),h=this.atCursorPos&&!l.isEditable&&r<=s.length&&(e<t||i.startSide>0),u=!l.isEditable&&(e<t||i.startSide<=0),c=this.getLine();this.pendingBuffer==2&&!h&&(this.pendingBuffer=0),this.flushBuffer(s),h&&(c.append(Mc(new Ya(1),s),r),r=s.length+Math.max(0,r-s.length)),c.append(Mc(l,s),r),this.atCursorPos=u,this.pendingBuffer=u?e<t?1:2:0}else this.doc.lineAt(this.pos).from==this.pos&&this.getLine().addLineDeco(i);a&&(this.textOff+a<=this.text.length?this.textOff+=a:(this.skip+=a-(this.text.length-this.textOff),this.text="",this.textOff=0),this.pos=t),this.openStart<0&&(this.openStart=r)}static build(e,t,i,s,r){let o=new Cb(e,t,i,r);return o.openEnd=st.spans(s,t,i,o),o.openStart<0&&(o.openStart=o.openEnd),o.finish(o.openEnd),o}}function Mc(n,e){for(let t of e)n=new Is(t,[n],n.length);return n}class rT extends Yr{constructor(e){super(),this.tag=e}eq(e){return e.tag==this.tag}toDOM(){return document.createElement(this.tag)}updateDOM(e){return e.nodeName.toLowerCase()==this.tag}}const kP=Ce.define(),CP=Ce.define(),EP=Ce.define(),AP=Ce.define(),wO=Ce.define(),PP=Ce.define(),DP=Ce.define({combine:n=>n.some(e=>e)});class of{constructor(e,t="nearest",i="nearest",s=5,r=5){this.range=e,this.y=t,this.x=i,this.yMargin=s,this.xMargin=r}map(e){return e.empty?this:new of(this.range.map(e),this.y,this.x,this.yMargin,this.xMargin)}}const oT=Ue.define({map:(n,e)=>n.map(e)});function un(n,e,t){let i=n.facet(AP);i.length?i[0](e):window.onerror?window.onerror(String(e),t,void 0,void 0,e):t?console.error(t+":",e):console.error(e)}const Du=Ce.define({combine:n=>n.length?n[0]:!0});let sV=0;const ah=Ce.define();class Xt{constructor(e,t,i,s){this.id=e,this.create=t,this.domEventHandlers=i,this.extension=s(this)}static define(e,t){const{eventHandlers:i,provide:s,decorations:r}=t||{};return new Xt(sV++,e,i,o=>{let a=[ah.of(o)];return r&&a.push(tu.of(l=>{let h=l.plugin(o);return h?r(h):Ie.none})),s&&a.push(s(o)),a})}static fromClass(e,t){return Xt.define(i=>new e(i),t)}}class zm{constructor(e){this.spec=e,this.mustUpdate=null,this.value=null}update(e){if(this.value){if(this.mustUpdate){let t=this.mustUpdate;if(this.mustUpdate=null,this.value.update)try{this.value.update(t)}catch(i){if(un(t.state,i,"CodeMirror plugin crashed"),this.value.destroy)try{this.value.destroy()}catch{}this.deactivate()}}}else if(this.spec)try{this.value=this.spec.create(e)}catch(t){un(e.state,t,"CodeMirror plugin crashed"),this.deactivate()}return this}destroy(e){var t;if(!((t=this.value)===null||t===void 0)&&t.destroy)try{this.value.destroy()}catch(i){un(e.state,i,"CodeMirror plugin crashed")}}deactivate(){this.spec=this.value=null}}const MP=Ce.define(),IP=Ce.define(),tu=Ce.define(),RP=Ce.define(),LP=Ce.define(),lh=Ce.define();class ir{constructor(e,t,i,s){this.fromA=e,this.toA=t,this.fromB=i,this.toB=s}join(e){return new ir(Math.min(this.fromA,e.fromA),Math.max(this.toA,e.toA),Math.min(this.fromB,e.fromB),Math.max(this.toB,e.toB))}addToSet(e){let t=e.length,i=this;for(;t>0;t--){let s=e[t-1];if(!(s.fromA>i.toA)){if(s.toA<i.fromA)break;i=i.join(s),e.splice(t-1,1)}}return e.splice(t,0,i),e}static extendWithRanges(e,t){if(t.length==0)return e;let i=[];for(let s=0,r=0,o=0,a=0;;s++){let l=s==e.length?null:e[s],h=o-a,u=l?l.fromB:1e9;for(;r<t.length&&t[r]<u;){let c=t[r],f=t[r+1],p=Math.max(a,c),b=Math.min(u,f);if(p<=b&&new ir(p+h,b+h,p,b).addToSet(i),f>u)break;r+=2}if(!l)return i;new ir(l.fromA,l.toA,l.fromB,l.toB).addToSet(i),o=l.toA,a=l.toB}}}class af{constructor(e,t,i){this.view=e,this.state=t,this.transactions=i,this.flags=0,this.startState=e.state,this.changes=Ht.empty(this.startState.doc.length);for(let o of i)this.changes=this.changes.compose(o.changes);let s=[];this.changes.iterChangedRanges((o,a,l,h)=>s.push(new ir(o,a,l,h))),this.changedRanges=s;let r=e.hasFocus;r!=e.inputState.notifiedFocused&&(e.inputState.notifiedFocused=r,this.flags|=1)}static create(e,t,i){return new af(e,t,i)}get viewportChanged(){return(this.flags&4)>0}get heightChanged(){return(this.flags&2)>0}get geometryChanged(){return this.docChanged||(this.flags&10)>0}get focusChanged(){return(this.flags&1)>0}get docChanged(){return!this.changes.empty}get selectionSet(){return this.transactions.some(e=>e.selection)}get empty(){return this.flags==0&&this.transactions.length==0}}var At=(function(n){return n[n.LTR=0]="LTR",n[n.RTL=1]="RTL",n})(At||(At={}));const _O=At.LTR,rV=At.RTL;function $P(n){let e=[];for(let t=0;t<n.length;t++)e.push(1<<+n[t]);return e}const oV=$P("88888888888888888888888888888888888666888888787833333333337888888000000000000000000000000008888880000000000000000000000000088888888888888888888888888888888888887866668888088888663380888308888800000000000000000000000800000000000000000000000000000008"),aV=$P("4444448826627288999999999992222222222222222222222222222222222222222222222229999999999999999999994444444444644222822222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222999999949999999229989999223333333333"),kO=Object.create(null),ns=[];for(let n of["()","[]","{}"]){let e=n.charCodeAt(0),t=n.charCodeAt(1);kO[e]=t,kO[t]=-e}function lV(n){return n<=247?oV[n]:1424<=n&&n<=1524?2:1536<=n&&n<=1785?aV[n-1536]:1774<=n&&n<=2220?4:8192<=n&&n<=8203||n==8204?256:1}const hV=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/;class Da{constructor(e,t,i){this.from=e,this.to=t,this.level=i}get dir(){return this.level%2?rV:_O}side(e,t){return this.dir==t==e?this.to:this.from}static find(e,t,i,s){let r=-1;for(let o=0;o<e.length;o++){let a=e[o];if(a.from<=t&&a.to>=t){if(a.level==i)return o;(r<0||(s!=0?s<0?a.from<t:a.to>t:e[r].level>a.level))&&(r=o)}}if(r<0)throw new RangeError("Index out of range");return r}}const kt=[];function uV(n,e){let t=n.length,i=e==_O?1:2,s=e==_O?2:1;if(!n||i==1&&!hV.test(n))return QP(t);for(let o=0,a=i,l=i;o<t;o++){let h=lV(n.charCodeAt(o));h==512?h=a:h==8&&l==4&&(h=16),kt[o]=h==4?2:h,h&7&&(l=h),a=h}for(let o=0,a=i,l=i;o<t;o++){let h=kt[o];if(h==128)o<t-1&&a==kt[o+1]&&a&24?h=kt[o]=a:kt[o]=256;else if(h==64){let u=o+1;for(;u<t&&kt[u]==64;)u++;let c=o&&a==8||u<t&&kt[u]==8?l==1?1:8:256;for(let f=o;f<u;f++)kt[f]=c;o=u-1}else h==8&&l==1&&(kt[o]=1);a=h,h&7&&(l=h)}for(let o=0,a=0,l=0,h,u,c;o<t;o++)if(u=kO[h=n.charCodeAt(o)])if(u<0){for(let f=a-3;f>=0;f-=3)if(ns[f+1]==-u){let p=ns[f+2],b=p&2?i:p&4?p&1?s:i:0;b&&(kt[o]=kt[ns[f]]=b),a=f;break}}else{if(ns.length==189)break;ns[a++]=o,ns[a++]=h,ns[a++]=l}else if((c=kt[o])==2||c==1){let f=c==i;l=f?0:1;for(let p=a-3;p>=0;p-=3){let b=ns[p+2];if(b&2)break;if(f)ns[p+2]|=2;else{if(b&4)break;ns[p+2]|=4}}}for(let o=0;o<t;o++)if(kt[o]==256){let a=o+1;for(;a<t&&kt[a]==256;)a++;let l=(o?kt[o-1]:i)==1,h=(a<t?kt[a]:i)==1,u=l==h?l?1:2:i;for(let c=o;c<a;c++)kt[c]=u;o=a-1}let r=[];if(i==1)for(let o=0;o<t;){let a=o,l=kt[o++]!=1;for(;o<t&&l==(kt[o]!=1);)o++;if(l)for(let h=o;h>a;){let u=h,c=kt[--h]!=2;for(;h>a&&c==(kt[h-1]!=2);)h--;r.push(new Da(h,u,c?2:1))}else r.push(new Da(a,o,0))}else for(let o=0;o<t;){let a=o,l=kt[o++]==2;for(;o<t&&l==(kt[o]==2);)o++;r.push(new Da(a,o,l?1:2))}return r}function QP(n){return[new Da(0,n,0)]}let BP="";function cV(n,e,t,i,s){var r;let o=i.head-n.from,a=-1;if(o==0){if(!s||!n.length)return null;e[0].level!=t&&(o=e[0].side(!1,t),a=0)}else if(o==n.length){if(s)return null;let f=e[e.length-1];f.level!=t&&(o=f.side(!0,t),a=e.length-1)}a<0&&(a=Da.find(e,o,(r=i.bidiLevel)!==null&&r!==void 0?r:-1,i.assoc));let l=e[a];o==l.side(s,t)&&(l=e[a+=s?1:-1],o=l.side(!s,t));let h=s==(l.dir==t),u=an(n.text,o,h);if(BP=n.text.slice(Math.min(o,u),Math.max(o,u)),u!=l.side(s,t))return le.cursor(u+n.from,h?-1:1,l.level);let c=a==(s?e.length-1:0)?null:e[a+(s?1:-1)];return!c&&l.level!=t?le.cursor(s?n.to:n.from,s?-1:1,t):c&&c.level<l.level?le.cursor(c.side(!s,t)+n.from,s?1:-1,c.level):le.cursor(u+n.from,s?-1:1,l.level)}const Lr="￿";class NP{constructor(e,t){this.points=e,this.text="",this.lineSeparator=t.facet(Ge.lineSeparator)}append(e){this.text+=e}lineBreak(){this.text+=Lr}readRange(e,t){if(!e)return this;let i=e.parentNode;for(let s=e;;){this.findPointBefore(i,s),this.readNode(s);let r=s.nextSibling;if(r==t)break;let o=Mt.get(s),a=Mt.get(r);(o&&a?o.breakAfter:(o?o.breakAfter:aT(s))||aT(r)&&(s.nodeName!="BR"||s.cmIgnore))&&this.lineBreak(),s=r}return this.findPointBefore(i,t),this}readTextNode(e){let t=e.nodeValue;for(let i of this.points)i.node==e&&(i.pos=this.text.length+Math.min(i.offset,t.length));for(let i=0,s=this.lineSeparator?null:/\r\n?|\n/g;;){let r=-1,o=1,a;if(this.lineSeparator?(r=t.indexOf(this.lineSeparator,i),o=this.lineSeparator.length):(a=s.exec(t))&&(r=a.index,o=a[0].length),this.append(t.slice(i,r<0?t.length:r)),r<0)break;if(this.lineBreak(),o>1)for(let l of this.points)l.node==e&&l.pos>this.text.length&&(l.pos-=o-1);i=r+o}}readNode(e){if(e.cmIgnore)return;let t=Mt.get(e),i=t&&t.overrideDOMText;if(i!=null){this.findPointInside(e,i.length);for(let s=i.iter();!s.next().done;)s.lineBreak?this.lineBreak():this.append(s.value)}else e.nodeType==3?this.readTextNode(e):e.nodeName=="BR"?e.nextSibling&&this.lineBreak():e.nodeType==1&&this.readRange(e.firstChild,null)}findPointBefore(e,t){for(let i of this.points)i.node==e&&e.childNodes[i.offset]==t&&(i.pos=this.text.length)}findPointInside(e,t){for(let i of this.points)(e.nodeType==3?i.node==e:e.contains(i.node))&&(i.pos=this.text.length+Math.min(t,i.offset))}}function aT(n){return n.nodeType==1&&/^(DIV|P|LI|UL|OL|BLOCKQUOTE|DD|DT|H\d|SECTION|PRE)$/.test(n.nodeName)}class lT{constructor(e,t){this.node=e,this.offset=t,this.pos=-1}}class hT extends Mt{constructor(e){super(),this.view=e,this.compositionDeco=Ie.none,this.decorations=[],this.dynamicDecorationMap=[],this.minWidth=0,this.minWidthFrom=0,this.minWidthTo=0,this.impreciseAnchor=null,this.impreciseHead=null,this.forceSelection=!1,this.lastUpdate=Date.now(),this.setDOM(e.contentDOM),this.children=[new Qi],this.children[0].setParent(this),this.updateDeco(),this.updateInner([new ir(0,0,0,e.state.doc.length)],0)}get root(){return this.view.root}get editorView(){return this.view}get length(){return this.view.state.doc.length}update(e){let t=e.changedRanges;this.minWidth>0&&t.length&&(t.every(({fromA:o,toA:a})=>a<this.minWidthFrom||o>this.minWidthTo)?(this.minWidthFrom=e.changes.mapPos(this.minWidthFrom,1),this.minWidthTo=e.changes.mapPos(this.minWidthTo,1)):this.minWidth=this.minWidthFrom=this.minWidthTo=0),this.view.inputState.composing<0?this.compositionDeco=Ie.none:(e.transactions.length||this.dirty)&&(this.compositionDeco=fV(this.view,e.changes)),(_e.ie||_e.chrome)&&!this.compositionDeco.size&&e&&e.state.doc.lines!=e.startState.doc.lines&&(this.forceSelection=!0);let i=this.decorations,s=this.updateDeco(),r=OV(i,s,e.changes);return t=ir.extendWithRanges(t,r),this.dirty==0&&t.length==0?!1:(this.updateInner(t,e.startState.doc.length),e.transactions.length&&(this.lastUpdate=Date.now()),!0)}updateInner(e,t){this.view.viewState.mustMeasureContent=!0,this.updateChildren(e,t);let{observer:i}=this.view;i.ignore(()=>{this.dom.style.height=this.view.viewState.contentHeight+"px",this.dom.style.flexBasis=this.minWidth?this.minWidth+"px":"";let r=_e.chrome||_e.ios?{node:i.selectionRange.focusNode,written:!1}:void 0;this.sync(r),this.dirty=0,r&&(r.written||i.selectionRange.focusNode!=r.node)&&(this.forceSelection=!0),this.dom.style.height=""});let s=[];if(this.view.viewport.from||this.view.viewport.to<this.view.state.doc.length)for(let r of this.children)r instanceof Ao&&r.widget instanceof uT&&s.push(r.dom);i.updateGaps(s)}updateChildren(e,t){let i=this.childCursor(t);for(let s=e.length-1;;s--){let r=s>=0?e[s]:null;if(!r)break;let{fromA:o,toA:a,fromB:l,toB:h}=r,{content:u,breakAtStart:c,openStart:f,openEnd:p}=Cb.build(this.view.state.doc,l,h,this.decorations,this.dynamicDecorationMap),{i:b,off:y}=i.findPos(a,1),{i:_,off:T}=i.findPos(o,-1);gP(this,_,T,b,y,u,c,f,p)}}updateSelection(e=!1,t=!1){if(e&&this.view.observer.readSelectionRange(),!(t||this.mayControlSelection())||_e.ios&&this.view.inputState.rapidCompositionStart)return;let i=this.forceSelection;this.forceSelection=!1;let s=this.view.state.selection.main,r=this.domAtPos(s.anchor),o=s.empty?r:this.domAtPos(s.head);if(_e.gecko&&s.empty&&dV(r)){let l=document.createTextNode("");this.view.observer.ignore(()=>r.node.insertBefore(l,r.node.childNodes[r.offset]||null)),r=o=new hi(l,0),i=!0}let a=this.view.observer.selectionRange;(i||!a.focusNode||!sf(r.node,r.offset,a.anchorNode,a.anchorOffset)||!sf(o.node,o.offset,a.focusNode,a.focusOffset))&&(this.view.observer.ignore(()=>{_e.android&&_e.chrome&&this.dom.contains(a.focusNode)&&yV(a.focusNode,this.dom)&&(this.dom.blur(),this.dom.focus({preventScroll:!0}));let l=nf(this.root);if(s.empty){if(_e.gecko){let h=mV(r.node,r.offset);if(h&&h!=3){let u=VP(r.node,r.offset,h==1?1:-1);u&&(r=new hi(u,h==1?0:u.nodeValue.length))}}l.collapse(r.node,r.offset),s.bidiLevel!=null&&a.cursorBidiLevel!=null&&(a.cursorBidiLevel=s.bidiLevel)}else if(l.extend)l.collapse(r.node,r.offset),l.extend(o.node,o.offset);else{let h=document.createRange();s.anchor>s.head&&([r,o]=[o,r]),h.setEnd(o.node,o.offset),h.setStart(r.node,r.offset),l.removeAllRanges(),l.addRange(h)}}),this.view.observer.setSelectionRange(r,o)),this.impreciseAnchor=r.precise?null:new hi(a.anchorNode,a.anchorOffset),this.impreciseHead=o.precise?null:new hi(a.focusNode,a.focusOffset)}enforceCursorAssoc(){if(this.compositionDeco.size)return;let e=this.view.state.selection.main,t=nf(this.root);if(!e.empty||!e.assoc||!t.modify)return;let i=Qi.find(this,e.head);if(!i)return;let s=i.posAtStart;if(e.head==s||e.head==s+i.length)return;let r=this.coordsAt(e.head,-1),o=this.coordsAt(e.head,1);if(!r||!o||r.bottom>o.top)return;let a=this.domAtPos(e.head+e.assoc);t.collapse(a.node,a.offset),t.modify("move",e.assoc<0?"forward":"backward","lineboundary")}mayControlSelection(){return this.view.state.facet(Du)?this.root.activeElement==this.dom:pO(this.dom,this.view.observer.selectionRange)}nearest(e){for(let t=e;t;){let i=Mt.get(t);if(i&&i.rootView==this)return i;t=t.parentNode}return null}posFromDOM(e,t){let i=this.nearest(e);if(!i)throw new RangeError("Trying to find position for a DOM position outside of the document");return i.localPosFromDOM(e,t)+i.posAtStart}domAtPos(e){let{i:t,off:i}=this.childCursor().findPos(e,-1);for(;t<this.children.length-1;){let s=this.children[t];if(i<s.length||s instanceof Qi)break;t++,i=0}return this.children[t].domAtPos(i)}coordsAt(e,t){for(let i=this.length,s=this.children.length-1;;s--){let r=this.children[s],o=i-r.breakAfter-r.length;if(e>o||e==o&&r.type!=mt.WidgetBefore&&r.type!=mt.WidgetAfter&&(!s||t==2||this.children[s-1].breakAfter||this.children[s-1].type==mt.WidgetBefore&&t>-2))return r.coordsAt(e-o,t);i=o}}measureVisibleLineHeights(e){let t=[],{from:i,to:s}=e,r=this.view.contentDOM.clientWidth,o=r>Math.max(this.view.scrollDOM.clientWidth,this.minWidth)+1,a=-1,l=this.view.textDirection==At.LTR;for(let h=0,u=0;u<this.children.length;u++){let c=this.children[u],f=h+c.length;if(f>s)break;if(h>=i){let p=c.dom.getBoundingClientRect();if(t.push(p.height),o){let b=c.dom.lastChild,y=b?Jh(b):[];if(y.length){let _=y[y.length-1],T=l?_.right-p.left:p.right-_.left;T>a&&(a=T,this.minWidth=r,this.minWidthFrom=h,this.minWidthTo=f)}}}h=f+c.breakAfter}return t}textDirectionAt(e){let{i:t}=this.childPos(e,1);return getComputedStyle(this.children[t].dom).direction=="rtl"?At.RTL:At.LTR}measureTextSize(){for(let s of this.children)if(s instanceof Qi){let r=s.measureTextSize();if(r)return r}let e=document.createElement("div"),t,i;return e.className="cm-line",e.textContent="abc def ghi jkl mno pqr stu",this.view.observer.ignore(()=>{this.dom.appendChild(e);let s=Jh(e.firstChild)[0];t=e.getBoundingClientRect().height,i=s?s.width/27:7,e.remove()}),{lineHeight:t,charWidth:i}}childCursor(e=this.length){let t=this.children.length;return t&&(e-=this.children[--t].length),new mP(this.children,e,t)}computeBlockGapDeco(){let e=[],t=this.view.viewState;for(let i=0,s=0;;s++){let r=s==t.viewports.length?null:t.viewports[s],o=r?r.from-1:this.length;if(o>i){let a=t.lineBlockAt(o).bottom-t.lineBlockAt(i).top;e.push(Ie.replace({widget:new uT(a),block:!0,inclusive:!0,isBlockGap:!0}).range(i,o))}if(!r)break;i=r.to+1}return Ie.set(e)}updateDeco(){let e=this.view.state.facet(tu).map((t,i)=>(this.dynamicDecorationMap[i]=typeof t=="function")?t(this.view):t);for(let t=e.length;t<e.length+3;t++)this.dynamicDecorationMap[t]=!1;return this.decorations=[...e,this.compositionDeco,this.computeBlockGapDeco(),this.view.viewState.lineGapDeco]}scrollIntoView(e){let{range:t}=e,i=this.coordsAt(t.head,t.empty?t.assoc:t.head>t.anchor?-1:1),s;if(!i)return;!t.empty&&(s=this.coordsAt(t.anchor,t.anchor>t.head?-1:1))&&(i={left:Math.min(i.left,s.left),top:Math.min(i.top,s.top),right:Math.max(i.right,s.right),bottom:Math.max(i.bottom,s.bottom)});let r=0,o=0,a=0,l=0;for(let u of this.view.state.facet(LP).map(c=>c(this.view)))if(u){let{left:c,right:f,top:p,bottom:b}=u;c!=null&&(r=Math.max(r,c)),f!=null&&(o=Math.max(o,f)),p!=null&&(a=Math.max(a,p)),b!=null&&(l=Math.max(l,b))}let h={left:i.left-r,top:i.top-a,right:i.right+o,bottom:i.bottom+l};G9(this.view.scrollDOM,h,t.head<t.anchor?-1:1,e.x,e.y,e.xMargin,e.yMargin,this.view.textDirection==At.LTR)}}function dV(n){return n.node.nodeType==1&&n.node.firstChild&&(n.offset==0||n.node.childNodes[n.offset-1].contentEditable=="false")&&(n.offset==n.node.childNodes.length||n.node.childNodes[n.offset].contentEditable=="false")}class uT extends Yr{constructor(e){super(),this.height=e}toDOM(){let e=document.createElement("div");return this.updateDOM(e),e}eq(e){return e.height==this.height}updateDOM(e){return e.style.height=this.height+"px",!0}get estimatedHeight(){return this.height}}function FP(n){let e=n.observer.selectionRange,t=e.focusNode&&VP(e.focusNode,e.focusOffset,0);if(!t)return null;let i=n.docView.nearest(t);if(!i)return null;if(i instanceof Qi){let s=t;for(;s.parentNode!=i.dom;)s=s.parentNode;let r=s.previousSibling;for(;r&&!Mt.get(r);)r=r.previousSibling;let o=r?Mt.get(r).posAtEnd:i.posAtStart;return{from:o,to:o,node:s,text:t}}else{for(;;){let{parent:r}=i;if(!r)return null;if(r instanceof Qi)break;i=r}let s=i.posAtStart;return{from:s,to:s+i.length,node:i.dom,text:t}}}function fV(n,e){let t=FP(n);if(!t)return Ie.none;let{from:i,to:s,node:r,text:o}=t,a=e.mapPos(i,1),l=Math.max(a,e.mapPos(s,-1)),{state:h}=n,u=r.nodeType==3?r.nodeValue:new NP([],h).readRange(r.firstChild,null).text;if(l-a<u.length)if(h.doc.sliceString(a,Math.min(h.doc.length,a+u.length),Lr)==u)l=a+u.length;else if(h.doc.sliceString(Math.max(0,l-u.length),l,Lr)==u)a=l-u.length;else return Ie.none;else if(h.doc.sliceString(a,l,Lr)!=u)return Ie.none;let c=Mt.get(r);return c instanceof vP?c=c.widget.topView:c&&(c.parent=null),Ie.set(Ie.replace({widget:new pV(r,o,c),inclusive:!0}).range(a,l))}class pV extends Yr{constructor(e,t,i){super(),this.top=e,this.text=t,this.topView=i}eq(e){return this.top==e.top&&this.text==e.text}toDOM(){return this.top}ignoreEvent(){return!1}get customView(){return vP}}function VP(n,e,t){for(;;){if(n.nodeType==3)return n;if(n.nodeType==1&&e>0&&t<=0)n=n.childNodes[e-1],e=rf(n);else if(n.nodeType==1&&e<n.childNodes.length&&t>=0)n=n.childNodes[e],e=0;else return null}}function mV(n,e){return n.nodeType!=1?0:(e&&n.childNodes[e-1].contentEditable=="false"?1:0)|(e<n.childNodes.length&&n.childNodes[e].contentEditable=="false"?2:0)}class gV{constructor(){this.changes=[]}compareRange(e,t){TO(e,t,this.changes)}comparePoint(e,t){TO(e,t,this.changes)}}function OV(n,e,t){let i=new gV;return st.compare(n,e,t,i),i.changes}function yV(n,e){for(let t=n;t&&t!=e;t=t.assignedSlot||t.parentNode)if(t.nodeType==1&&t.contentEditable=="false")return!0;return!1}function bV(n,e,t=1){let i=n.charCategorizer(e),s=n.doc.lineAt(e),r=e-s.from;if(s.length==0)return le.cursor(e);r==0?t=1:r==s.length&&(t=-1);let o=r,a=r;t<0?o=an(s.text,r,!1):a=an(s.text,r);let l=i(s.text.slice(o,a));for(;o>0;){let h=an(s.text,o,!1);if(i(s.text.slice(h,o))!=l)break;o=h}for(;a<s.length;){let h=an(s.text,a);if(i(s.text.slice(a,h))!=l)break;a=h}return le.range(o+s.from,a+s.from)}function vV(n,e){return e.left>n?e.left-n:Math.max(0,n-e.right)}function SV(n,e){return e.top>n?e.top-n:Math.max(0,n-e.bottom)}function jm(n,e){return n.top<e.bottom-1&&n.bottom>e.top+1}function cT(n,e){return e<n.top?{top:e,left:n.left,right:n.right,bottom:n.bottom}:n}function dT(n,e){return e>n.bottom?{top:n.top,left:n.left,right:n.right,bottom:e}:n}function CO(n,e,t){let i,s,r,o,a,l,h,u;for(let p=n.firstChild;p;p=p.nextSibling){let b=Jh(p);for(let y=0;y<b.length;y++){let _=b[y];s&&jm(s,_)&&(_=cT(dT(_,s.bottom),s.top));let T=vV(e,_),w=SV(t,_);if(T==0&&w==0)return p.nodeType==3?fT(p,e,t):CO(p,e,t);(!i||o>w||o==w&&r>T)&&(i=p,s=_,r=T,o=w),T==0?t>_.bottom&&(!h||h.bottom<_.bottom)?(a=p,h=_):t<_.top&&(!u||u.top>_.top)&&(l=p,u=_):h&&jm(h,_)?h=dT(h,_.bottom):u&&jm(u,_)&&(u=cT(u,_.top))}}if(h&&h.bottom>=t?(i=a,s=h):u&&u.top<=t&&(i=l,s=u),!i)return{node:n,offset:0};let c=Math.max(s.left,Math.min(s.right,e));if(i.nodeType==3)return fT(i,c,t);if(!r&&i.contentEditable=="true")return CO(i,c,t);let f=Array.prototype.indexOf.call(n.childNodes,i)+(e>=(s.left+s.right)/2?1:0);return{node:n,offset:f}}function fT(n,e,t){let i=n.nodeValue.length,s=-1,r=1e9,o=0;for(let a=0;a<i;a++){let l=eu(n,a,a+1).getClientRects();for(let h=0;h<l.length;h++){let u=l[h];if(u.top==u.bottom)continue;o||(o=e-u.left);let c=(u.top>t?u.top-t:t-u.bottom)-1;if(u.left-1<=e&&u.right+1>=e&&c<r){let f=e>=(u.left+u.right)/2,p=f;if((_e.chrome||_e.gecko)&&eu(n,a).getBoundingClientRect().left==u.right&&(p=!f),c<=0)return{node:n,offset:a+(p?1:0)};s=a+(p?1:0),r=c}}}return{node:n,offset:s>-1?s:o>0?n.nodeValue.length:0}}function UP(n,{x:e,y:t},i,s=-1){var r;let o=n.contentDOM.getBoundingClientRect(),a=o.top+n.viewState.paddingTop,l,{docHeight:h}=n.viewState,u=t-a;if(u<0)return 0;if(u>h)return n.state.doc.length;for(let T=n.defaultLineHeight/2,w=!1;l=n.elementAtHeight(u),l.type!=mt.Text;)for(;u=s>0?l.bottom+T:l.top-T,!(u>=0&&u<=h);){if(w)return i?null:0;w=!0,s=-s}t=a+u;let c=l.from;if(c<n.viewport.from)return n.viewport.from==0?0:i?null:pT(n,o,l,e,t);if(c>n.viewport.to)return n.viewport.to==n.state.doc.length?n.state.doc.length:i?null:pT(n,o,l,e,t);let f=n.dom.ownerDocument,p=n.root.elementFromPoint?n.root:f,b=p.elementFromPoint(e,t);b&&!n.contentDOM.contains(b)&&(b=null),b||(e=Math.max(o.left+1,Math.min(o.right-1,e)),b=p.elementFromPoint(e,t),b&&!n.contentDOM.contains(b)&&(b=null));let y,_=-1;if(b&&((r=n.docView.nearest(b))===null||r===void 0?void 0:r.isEditable)!=!1){if(f.caretPositionFromPoint){let T=f.caretPositionFromPoint(e,t);T&&({offsetNode:y,offset:_}=T)}else if(f.caretRangeFromPoint){let T=f.caretRangeFromPoint(e,t);T&&({startContainer:y,startOffset:_}=T,_e.safari&&xV(y,_,e)&&(y=void 0))}}if(!y||!n.docView.dom.contains(y)){let T=Qi.find(n.docView,c);if(!T)return u>l.top+l.height/2?l.to:l.from;({node:y,offset:_}=CO(T.dom,e,t))}return n.docView.posFromDOM(y,_)}function pT(n,e,t,i,s){let r=Math.round((i-e.left)*n.defaultCharacterWidth);if(n.lineWrapping&&t.height>n.defaultLineHeight*1.5){let a=Math.floor((s-t.top)/n.defaultLineHeight);r+=a*n.viewState.heightOracle.lineLength}let o=n.state.sliceDoc(t.from,t.to);return t.from+fO(o,r,n.state.tabSize)}function xV(n,e,t){let i;if(n.nodeType!=3||e!=(i=n.nodeValue.length))return!1;for(let s=n.nextSibling;s;s=s.nextSibling)if(s.nodeType!=1||s.nodeName!="BR")return!1;return eu(n,i-1,i).getBoundingClientRect().left>t}function TV(n,e,t,i){let s=n.state.doc.lineAt(e.head),r=!i||!n.lineWrapping?null:n.coordsAtPos(e.assoc<0&&e.head>s.from?e.head-1:e.head);if(r){let l=n.dom.getBoundingClientRect(),h=n.textDirectionAt(s.from),u=n.posAtCoords({x:t==(h==At.LTR)?l.right-1:l.left+1,y:(r.top+r.bottom)/2});if(u!=null)return le.cursor(u,t?-1:1)}let o=Qi.find(n.docView,e.head),a=o?t?o.posAtEnd:o.posAtStart:t?s.to:s.from;return le.cursor(a,t?-1:1)}function mT(n,e,t,i){let s=n.state.doc.lineAt(e.head),r=n.bidiSpans(s),o=n.textDirectionAt(s.from);for(let a=e,l=null;;){let h=cV(s,r,o,a,t),u=BP;if(!h){if(s.number==(t?n.state.doc.lines:1))return a;u=`
`,s=n.state.doc.line(s.number+(t?1:-1)),r=n.bidiSpans(s),h=le.cursor(t?s.from:s.to)}if(l){if(!l(u))return a}else{if(!i)return h;l=i(u)}a=h}}function wV(n,e,t){let i=n.state.charCategorizer(e),s=i(t);return r=>{let o=i(r);return s==$i.Space&&(s=o),s==o}}function _V(n,e,t,i){let s=e.head,r=t?1:-1;if(s==(t?n.state.doc.length:0))return le.cursor(s,e.assoc);let o=e.goalColumn,a,l=n.contentDOM.getBoundingClientRect(),h=n.coordsAtPos(s),u=n.documentTop;if(h)o==null&&(o=h.left-l.left),a=r<0?h.top:h.bottom;else{let p=n.viewState.lineBlockAt(s);o==null&&(o=Math.min(l.right-l.left,n.defaultCharacterWidth*(s-p.from))),a=(r<0?p.top:p.bottom)+u}let c=l.left+o,f=i??n.defaultLineHeight>>1;for(let p=0;;p+=10){let b=a+(f+p)*r,y=UP(n,{x:c,y:b},!1,r);if(b<l.top||b>l.bottom||(r<0?y<s:y>s))return le.cursor(y,e.assoc,void 0,o)}}function Xm(n,e,t){let i=n.state.facet(RP).map(s=>s(n));for(;;){let s=!1;for(let r of i)r.between(t.from-1,t.from+1,(o,a,l)=>{t.from>o&&t.from<a&&(t=e.from>t.from?le.cursor(o,1):le.cursor(a,-1),s=!0)});if(!s)return t}}class kV{constructor(e){this.lastKeyCode=0,this.lastKeyTime=0,this.chromeScrollHack=-1,this.pendingIOSKey=void 0,this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastEscPress=0,this.lastContextMenu=0,this.scrollHandlers=[],this.registeredEvents=[],this.customHandlers=[],this.composing=-1,this.compositionFirstChange=null,this.compositionEndedAt=0,this.rapidCompositionStart=!1,this.mouseSelection=null;for(let t in ii){let i=ii[t];e.contentDOM.addEventListener(t,s=>{!gT(e,s)||this.ignoreDuringComposition(s)||t=="keydown"&&this.keydown(e,s)||(this.mustFlushObserver(s)&&e.observer.forceFlush(),this.runCustomHandlers(t,e,s)?s.preventDefault():i(e,s))}),this.registeredEvents.push(t)}_e.chrome&&_e.chrome_version>=102&&e.scrollDOM.addEventListener("wheel",()=>{this.chromeScrollHack<0?e.contentDOM.style.pointerEvents="none":window.clearTimeout(this.chromeScrollHack),this.chromeScrollHack=setTimeout(()=>{this.chromeScrollHack=-1,e.contentDOM.style.pointerEvents=""},100)},{passive:!0}),this.notifiedFocused=e.hasFocus,_e.safari&&e.contentDOM.addEventListener("input",()=>null)}setSelectionOrigin(e){this.lastSelectionOrigin=e,this.lastSelectionTime=Date.now()}ensureHandlers(e,t){var i;let s;this.customHandlers=[];for(let r of t)if(s=(i=r.update(e).spec)===null||i===void 0?void 0:i.domEventHandlers){this.customHandlers.push({plugin:r.value,handlers:s});for(let o in s)this.registeredEvents.indexOf(o)<0&&o!="scroll"&&(this.registeredEvents.push(o),e.contentDOM.addEventListener(o,a=>{gT(e,a)&&this.runCustomHandlers(o,e,a)&&a.preventDefault()}))}}runCustomHandlers(e,t,i){for(let s of this.customHandlers){let r=s.handlers[e];if(r)try{if(r.call(s.plugin,i,t)||i.defaultPrevented)return!0}catch(o){un(t.state,o)}}return!1}runScrollHandlers(e,t){for(let i of this.customHandlers){let s=i.handlers.scroll;if(s)try{s.call(i.plugin,t,e)}catch(r){un(e.state,r)}}}keydown(e,t){if(this.lastKeyCode=t.keyCode,this.lastKeyTime=Date.now(),t.keyCode==9&&Date.now()<this.lastEscPress+2e3)return!0;if(_e.android&&_e.chrome&&!t.synthetic&&(t.keyCode==13||t.keyCode==8))return e.observer.delayAndroidKey(t.key,t.keyCode),!0;let i;return _e.ios&&(i=qP.find(s=>s.keyCode==t.keyCode))&&!(t.ctrlKey||t.altKey||t.metaKey)&&!t.synthetic?(this.pendingIOSKey=i,setTimeout(()=>this.flushIOSKey(e),250),!0):!1}flushIOSKey(e){let t=this.pendingIOSKey;return t?(this.pendingIOSKey=void 0,Dh(e.contentDOM,t.key,t.keyCode)):!1}ignoreDuringComposition(e){return/^key/.test(e.type)?this.composing>0?!0:_e.safari&&Date.now()-this.compositionEndedAt<100?(this.compositionEndedAt=0,!0):!1:!1}mustFlushObserver(e){return e.type=="keydown"&&e.keyCode!=229||e.type=="compositionend"&&!_e.ios}startMouseSelection(e){this.mouseSelection&&this.mouseSelection.destroy(),this.mouseSelection=e}update(e){this.mouseSelection&&this.mouseSelection.update(e),e.transactions.length&&(this.lastKeyCode=this.lastSelectionTime=0)}destroy(){this.mouseSelection&&this.mouseSelection.destroy()}}const qP=[{key:"Backspace",keyCode:8,inputType:"deleteContentBackward"},{key:"Enter",keyCode:13,inputType:"insertParagraph"},{key:"Delete",keyCode:46,inputType:"deleteContentForward"}],zP=[16,17,18,20,91,92,224,225];class CV{constructor(e,t,i,s){this.view=e,this.style=i,this.mustSelect=s,this.lastEvent=t;let r=e.contentDOM.ownerDocument;r.addEventListener("mousemove",this.move=this.move.bind(this)),r.addEventListener("mouseup",this.up=this.up.bind(this)),this.extend=t.shiftKey,this.multiple=e.state.facet(Ge.allowMultipleSelections)&&EV(e,t),this.dragMove=AV(e,t),this.dragging=PV(e,t)&&Eb(t)==1?null:!1,this.dragging===!1&&(t.preventDefault(),this.select(t))}move(e){if(e.buttons==0)return this.destroy();this.dragging===!1&&this.select(this.lastEvent=e)}up(e){this.dragging==null&&this.select(this.lastEvent),this.dragging||e.preventDefault(),this.destroy()}destroy(){let e=this.view.contentDOM.ownerDocument;e.removeEventListener("mousemove",this.move),e.removeEventListener("mouseup",this.up),this.view.inputState.mouseSelection=null}select(e){let t=this.style.get(e,this.extend,this.multiple);(this.mustSelect||!t.eq(this.view.state.selection)||t.main.assoc!=this.view.state.selection.main.assoc)&&this.view.dispatch({selection:t,userEvent:"select.pointer",scrollIntoView:!0}),this.mustSelect=!1}update(e){e.docChanged&&this.dragging&&(this.dragging=this.dragging.map(e.changes)),this.style.update(e)&&setTimeout(()=>this.select(this.lastEvent),20)}}function EV(n,e){let t=n.state.facet(kP);return t.length?t[0](e):_e.mac?e.metaKey:e.ctrlKey}function AV(n,e){let t=n.state.facet(CP);return t.length?t[0](e):_e.mac?!e.altKey:!e.ctrlKey}function PV(n,e){let{main:t}=n.state.selection;if(t.empty)return!1;let i=nf(n.root);if(i.rangeCount==0)return!0;let s=i.getRangeAt(0).getClientRects();for(let r=0;r<s.length;r++){let o=s[r];if(o.left<=e.clientX&&o.right>=e.clientX&&o.top<=e.clientY&&o.bottom>=e.clientY)return!0}return!1}function gT(n,e){if(!e.bubbles)return!0;if(e.defaultPrevented)return!1;for(let t=e.target,i;t!=n.contentDOM;t=t.parentNode)if(!t||t.nodeType==11||(i=Mt.get(t))&&i.ignoreEvent(e))return!1;return!0}const ii=Object.create(null),jP=_e.ie&&_e.ie_version<15||_e.ios&&_e.webkit_version<604;function DV(n){let e=n.dom.parentNode;if(!e)return;let t=e.appendChild(document.createElement("textarea"));t.style.cssText="position: fixed; left: -10000px; top: 10px",t.focus(),setTimeout(()=>{n.focus(),t.remove(),XP(n,t.value)},50)}function XP(n,e){let{state:t}=n,i,s=1,r=t.toText(e),o=r.lines==t.selection.ranges.length;if(EO!=null&&t.selection.ranges.every(l=>l.empty)&&EO==r.toString()){let l=-1;i=t.changeByRange(h=>{let u=t.doc.lineAt(h.from);if(u.from==l)return{range:h};l=u.from;let c=t.toText((o?r.line(s++).text:e)+t.lineBreak);return{changes:{from:u.from,insert:c},range:le.cursor(h.from+c.length)}})}else o?i=t.changeByRange(l=>{let h=r.line(s++);return{changes:{from:l.from,to:l.to,insert:h.text},range:le.cursor(l.from+h.length)}}):i=t.replaceSelection(r);n.dispatch(i,{userEvent:"input.paste",scrollIntoView:!0})}ii.keydown=(n,e)=>{n.inputState.setSelectionOrigin("select"),e.keyCode==27?n.inputState.lastEscPress=Date.now():zP.indexOf(e.keyCode)<0&&(n.inputState.lastEscPress=0)};let HP=0;ii.touchstart=(n,e)=>{HP=Date.now(),n.inputState.setSelectionOrigin("select.pointer")};ii.touchmove=n=>{n.inputState.setSelectionOrigin("select.pointer")};ii.mousedown=(n,e)=>{if(n.observer.flush(),HP>Date.now()-2e3&&Eb(e)==1)return;let t=null;for(let i of n.state.facet(EP))if(t=i(n,e),t)break;if(!t&&e.button==0&&(t=RV(n,e)),t){let i=n.root.activeElement!=n.contentDOM;i&&n.observer.ignore(()=>fP(n.contentDOM)),n.inputState.startMouseSelection(new CV(n,e,t,i))}};function OT(n,e,t,i){if(i==1)return le.cursor(e,t);if(i==2)return bV(n.state,e,t);{let s=Qi.find(n.docView,e),r=n.state.doc.lineAt(s?s.posAtEnd:e),o=s?s.posAtStart:r.from,a=s?s.posAtEnd:r.to;return a<n.state.doc.length&&a==r.to&&a++,le.range(o,a)}}let WP=(n,e)=>n>=e.top&&n<=e.bottom,yT=(n,e,t)=>WP(e,t)&&n>=t.left&&n<=t.right;function MV(n,e,t,i){let s=Qi.find(n.docView,e);if(!s)return 1;let r=e-s.posAtStart;if(r==0)return 1;if(r==s.length)return-1;let o=s.coordsAt(r,-1);if(o&&yT(t,i,o))return-1;let a=s.coordsAt(r,1);return a&&yT(t,i,a)?1:o&&WP(i,o)?-1:1}function bT(n,e){let t=n.posAtCoords({x:e.clientX,y:e.clientY},!1);return{pos:t,bias:MV(n,t,e.clientX,e.clientY)}}const IV=_e.ie&&_e.ie_version<=11;let vT=null,ST=0,xT=0;function Eb(n){if(!IV)return n.detail;let e=vT,t=xT;return vT=n,xT=Date.now(),ST=!e||t>Date.now()-400&&Math.abs(e.clientX-n.clientX)<2&&Math.abs(e.clientY-n.clientY)<2?(ST+1)%3:1}function RV(n,e){let t=bT(n,e),i=Eb(e),s=n.state.selection,r=t,o=e;return{update(a){a.docChanged&&(t&&(t.pos=a.changes.mapPos(t.pos)),s=s.map(a.changes),o=null)},get(a,l,h){let u;if(o&&a.clientX==o.clientX&&a.clientY==o.clientY?u=r:(u=r=bT(n,a),o=a),!u||!t)return s;let c=OT(n,u.pos,u.bias,i);if(t.pos!=u.pos&&!l){let f=OT(n,t.pos,t.bias,i),p=Math.min(f.from,c.from),b=Math.max(f.to,c.to);c=p<c.from?le.range(p,b):le.range(b,p)}return l?s.replaceRange(s.main.extend(c.from,c.to)):h?s.addRange(c):le.create([c])}}}ii.dragstart=(n,e)=>{let{selection:{main:t}}=n.state,{mouseSelection:i}=n.inputState;i&&(i.dragging=t),e.dataTransfer&&(e.dataTransfer.setData("Text",n.state.sliceDoc(t.from,t.to)),e.dataTransfer.effectAllowed="copyMove")};function TT(n,e,t,i){if(!t)return;let s=n.posAtCoords({x:e.clientX,y:e.clientY},!1);e.preventDefault();let{mouseSelection:r}=n.inputState,o=i&&r&&r.dragging&&r.dragMove?{from:r.dragging.from,to:r.dragging.to}:null,a={from:s,insert:t},l=n.state.changes(o?[o,a]:a);n.focus(),n.dispatch({changes:l,selection:{anchor:l.mapPos(s,-1),head:l.mapPos(s,1)},userEvent:o?"move.drop":"input.drop"})}ii.drop=(n,e)=>{if(!e.dataTransfer)return;if(n.state.readOnly)return e.preventDefault();let t=e.dataTransfer.files;if(t&&t.length){e.preventDefault();let i=Array(t.length),s=0,r=()=>{++s==t.length&&TT(n,e,i.filter(o=>o!=null).join(n.state.lineBreak),!1)};for(let o=0;o<t.length;o++){let a=new FileReader;a.onerror=r,a.onload=()=>{/[\x00-\x08\x0e-\x1f]{2}/.test(a.result)||(i[o]=a.result),r()},a.readAsText(t[o])}}else TT(n,e,e.dataTransfer.getData("Text"),!0)};ii.paste=(n,e)=>{if(n.state.readOnly)return e.preventDefault();n.observer.flush();let t=jP?null:e.clipboardData;t?(XP(n,t.getData("text/plain")),e.preventDefault()):DV(n)};function LV(n,e){let t=n.dom.parentNode;if(!t)return;let i=t.appendChild(document.createElement("textarea"));i.style.cssText="position: fixed; left: -10000px; top: 10px",i.value=e,i.focus(),i.selectionEnd=e.length,i.selectionStart=0,setTimeout(()=>{i.remove(),n.focus()},50)}function $V(n){let e=[],t=[],i=!1;for(let s of n.selection.ranges)s.empty||(e.push(n.sliceDoc(s.from,s.to)),t.push(s));if(!e.length){let s=-1;for(let{from:r}of n.selection.ranges){let o=n.doc.lineAt(r);o.number>s&&(e.push(o.text),t.push({from:o.from,to:Math.min(n.doc.length,o.to+1)})),s=o.number}i=!0}return{text:e.join(n.lineBreak),ranges:t,linewise:i}}let EO=null;ii.copy=ii.cut=(n,e)=>{let{text:t,ranges:i,linewise:s}=$V(n.state);if(!t&&!s)return;EO=s?t:null;let r=jP?null:e.clipboardData;r?(e.preventDefault(),r.clearData(),r.setData("text/plain",t)):LV(n,t),e.type=="cut"&&!n.state.readOnly&&n.dispatch({changes:i,scrollIntoView:!0,userEvent:"delete.cut"})};function ZP(n){setTimeout(()=>{n.hasFocus!=n.inputState.notifiedFocused&&n.update([])},10)}ii.focus=ZP;ii.blur=n=>{n.observer.clearSelectionRange(),ZP(n)};function YP(n,e){if(n.docView.compositionDeco.size){n.inputState.rapidCompositionStart=e;try{n.update([])}finally{n.inputState.rapidCompositionStart=!1}}}ii.compositionstart=ii.compositionupdate=n=>{n.inputState.compositionFirstChange==null&&(n.inputState.compositionFirstChange=!0),n.inputState.composing<0&&(n.inputState.composing=0,n.docView.compositionDeco.size&&(n.observer.flush(),YP(n,!0)))};ii.compositionend=n=>{n.inputState.composing=-1,n.inputState.compositionEndedAt=Date.now(),n.inputState.compositionFirstChange=null,setTimeout(()=>{n.inputState.composing<0&&YP(n,!1)},50)};ii.contextmenu=n=>{n.inputState.lastContextMenu=Date.now()};ii.beforeinput=(n,e)=>{var t;let i;if(_e.chrome&&_e.android&&(i=qP.find(s=>s.inputType==e.inputType))&&(n.observer.delayAndroidKey(i.key,i.keyCode),i.key=="Backspace"||i.key=="Delete")){let s=((t=window.visualViewport)===null||t===void 0?void 0:t.height)||0;setTimeout(()=>{var r;(((r=window.visualViewport)===null||r===void 0?void 0:r.height)||0)>s+10&&n.hasFocus&&(n.contentDOM.blur(),n.focus())},100)}};const wT=["pre-wrap","normal","pre-line","break-spaces"];class QV{constructor(){this.doc=nt.empty,this.lineWrapping=!1,this.heightSamples={},this.lineHeight=14,this.charWidth=7,this.lineLength=30,this.heightChanged=!1}heightForGap(e,t){let i=this.doc.lineAt(t).number-this.doc.lineAt(e).number+1;return this.lineWrapping&&(i+=Math.ceil((t-e-i*this.lineLength*.5)/this.lineLength)),this.lineHeight*i}heightForLine(e){return this.lineWrapping?(1+Math.max(0,Math.ceil((e-this.lineLength)/(this.lineLength-5))))*this.lineHeight:this.lineHeight}setDoc(e){return this.doc=e,this}mustRefreshForWrapping(e){return wT.indexOf(e)>-1!=this.lineWrapping}mustRefreshForHeights(e){let t=!1;for(let i=0;i<e.length;i++){let s=e[i];s<0?i++:this.heightSamples[Math.floor(s*10)]||(t=!0,this.heightSamples[Math.floor(s*10)]=!0)}return t}refresh(e,t,i,s,r){let o=wT.indexOf(e)>-1,a=Math.round(t)!=Math.round(this.lineHeight)||this.lineWrapping!=o;if(this.lineWrapping=o,this.lineHeight=t,this.charWidth=i,this.lineLength=s,a){this.heightSamples={};for(let l=0;l<r.length;l++){let h=r[l];h<0?l++:this.heightSamples[Math.floor(h*10)]=!0}}return a}}class BV{constructor(e,t){this.from=e,this.heights=t,this.index=0}get more(){return this.index<this.heights.length}}class $r{constructor(e,t,i,s,r){this.from=e,this.length=t,this.top=i,this.height=s,this.type=r}get to(){return this.from+this.length}get bottom(){return this.top+this.height}join(e){let t=(Array.isArray(this.type)?this.type:[this]).concat(Array.isArray(e.type)?e.type:[e]);return new $r(this.from,this.length+e.length,this.top,this.height+e.height,t)}}var yt=(function(n){return n[n.ByPos=0]="ByPos",n[n.ByHeight=1]="ByHeight",n[n.ByPosNoHeight=2]="ByPosNoHeight",n})(yt||(yt={}));const cd=.001;class Wi{constructor(e,t,i=2){this.length=e,this.height=t,this.flags=i}get outdated(){return(this.flags&2)>0}set outdated(e){this.flags=(e?2:0)|this.flags&-3}setHeight(e,t){this.height!=t&&(Math.abs(this.height-t)>cd&&(e.heightChanged=!0),this.height=t)}replace(e,t,i){return Wi.of(i)}decomposeLeft(e,t){t.push(this)}decomposeRight(e,t){t.push(this)}applyChanges(e,t,i,s){let r=this;for(let o=s.length-1;o>=0;o--){let{fromA:a,toA:l,fromB:h,toB:u}=s[o],c=r.lineAt(a,yt.ByPosNoHeight,t,0,0),f=c.to>=l?c:r.lineAt(l,yt.ByPosNoHeight,t,0,0);for(u+=f.to-l,l=f.to;o>0&&c.from<=s[o-1].toA;)a=s[o-1].fromA,h=s[o-1].fromB,o--,a<c.from&&(c=r.lineAt(a,yt.ByPosNoHeight,t,0,0));h+=c.from-a,a=c.from;let p=Ab.build(i,e,h,u);r=r.replace(a,l,p)}return r.updateHeight(i,0)}static empty(){return new sn(0,0)}static of(e){if(e.length==1)return e[0];let t=0,i=e.length,s=0,r=0;for(;;)if(t==i)if(s>r*2){let a=e[t-1];a.break?e.splice(--t,1,a.left,null,a.right):e.splice(--t,1,a.left,a.right),i+=1+a.break,s-=a.size}else if(r>s*2){let a=e[i];a.break?e.splice(i,1,a.left,null,a.right):e.splice(i,1,a.left,a.right),i+=2+a.break,r-=a.size}else break;else if(s<r){let a=e[t++];a&&(s+=a.size)}else{let a=e[--i];a&&(r+=a.size)}let o=0;return e[t-1]==null?(o=1,t--):e[t]==null&&(o=1,i++),new NV(Wi.of(e.slice(0,t)),o,Wi.of(e.slice(i)))}}Wi.prototype.size=1;class GP extends Wi{constructor(e,t,i){super(e,t),this.type=i}blockAt(e,t,i,s){return new $r(s,this.length,i,this.height,this.type)}lineAt(e,t,i,s,r){return this.blockAt(0,i,s,r)}forEachLine(e,t,i,s,r,o){e<=r+this.length&&t>=r&&o(this.blockAt(0,i,s,r))}updateHeight(e,t=0,i=!1,s){return s&&s.from<=t&&s.more&&this.setHeight(e,s.heights[s.index++]),this.outdated=!1,this}toString(){return`block(${this.length})`}}class sn extends GP{constructor(e,t){super(e,t,mt.Text),this.collapsed=0,this.widgetHeight=0}replace(e,t,i){let s=i[0];return i.length==1&&(s instanceof sn||s instanceof si&&s.flags&4)&&Math.abs(this.length-s.length)<10?(s instanceof si?s=new sn(s.length,this.height):s.height=this.height,this.outdated||(s.outdated=!1),s):Wi.of(i)}updateHeight(e,t=0,i=!1,s){return s&&s.from<=t&&s.more?this.setHeight(e,s.heights[s.index++]):(i||this.outdated)&&this.setHeight(e,Math.max(this.widgetHeight,e.heightForLine(this.length-this.collapsed))),this.outdated=!1,this}toString(){return`line(${this.length}${this.collapsed?-this.collapsed:""}${this.widgetHeight?":"+this.widgetHeight:""})`}}class si extends Wi{constructor(e){super(e,0)}lines(e,t){let i=e.lineAt(t).number,s=e.lineAt(t+this.length).number;return{firstLine:i,lastLine:s,lineHeight:this.height/(s-i+1)}}blockAt(e,t,i,s){let{firstLine:r,lastLine:o,lineHeight:a}=this.lines(t,s),l=Math.max(0,Math.min(o-r,Math.floor((e-i)/a))),{from:h,length:u}=t.line(r+l);return new $r(h,u,i+a*l,a,mt.Text)}lineAt(e,t,i,s,r){if(t==yt.ByHeight)return this.blockAt(e,i,s,r);if(t==yt.ByPosNoHeight){let{from:c,to:f}=i.lineAt(e);return new $r(c,f-c,0,0,mt.Text)}let{firstLine:o,lineHeight:a}=this.lines(i,r),{from:l,length:h,number:u}=i.lineAt(e);return new $r(l,h,s+a*(u-o),a,mt.Text)}forEachLine(e,t,i,s,r,o){let{firstLine:a,lineHeight:l}=this.lines(i,r);for(let h=Math.max(e,r),u=Math.min(r+this.length,t);h<=u;){let c=i.lineAt(h);h==e&&(s+=l*(c.number-a)),o(new $r(c.from,c.length,s,l,mt.Text)),s+=l,h=c.to+1}}replace(e,t,i){let s=this.length-t;if(s>0){let r=i[i.length-1];r instanceof si?i[i.length-1]=new si(r.length+s):i.push(null,new si(s-1))}if(e>0){let r=i[0];r instanceof si?i[0]=new si(e+r.length):i.unshift(new si(e-1),null)}return Wi.of(i)}decomposeLeft(e,t){t.push(new si(e-1),null)}decomposeRight(e,t){t.push(null,new si(this.length-e-1))}updateHeight(e,t=0,i=!1,s){let r=t+this.length;if(s&&s.from<=t+this.length&&s.more){let o=[],a=Math.max(t,s.from),l=-1,h=e.heightChanged;for(s.from>t&&o.push(new si(s.from-t-1).updateHeight(e,t));a<=r&&s.more;){let c=e.doc.lineAt(a).length;o.length&&o.push(null);let f=s.heights[s.index++];l==-1?l=f:Math.abs(f-l)>=cd&&(l=-2);let p=new sn(c,f);p.outdated=!1,o.push(p),a+=c+1}a<=r&&o.push(null,new si(r-a).updateHeight(e,a));let u=Wi.of(o);return e.heightChanged=h||l<0||Math.abs(u.height-this.height)>=cd||Math.abs(l-this.lines(e.doc,t).lineHeight)>=cd,u}else(i||this.outdated)&&(this.setHeight(e,e.heightForGap(t,t+this.length)),this.outdated=!1);return this}toString(){return`gap(${this.length})`}}class NV extends Wi{constructor(e,t,i){super(e.length+t+i.length,e.height+i.height,t|(e.outdated||i.outdated?2:0)),this.left=e,this.right=i,this.size=e.size+i.size}get break(){return this.flags&1}blockAt(e,t,i,s){let r=i+this.left.height;return e<r?this.left.blockAt(e,t,i,s):this.right.blockAt(e,t,r,s+this.left.length+this.break)}lineAt(e,t,i,s,r){let o=s+this.left.height,a=r+this.left.length+this.break,l=t==yt.ByHeight?e<o:e<a,h=l?this.left.lineAt(e,t,i,s,r):this.right.lineAt(e,t,i,o,a);if(this.break||(l?h.to<a:h.from>a))return h;let u=t==yt.ByPosNoHeight?yt.ByPosNoHeight:yt.ByPos;return l?h.join(this.right.lineAt(a,u,i,o,a)):this.left.lineAt(a,u,i,s,r).join(h)}forEachLine(e,t,i,s,r,o){let a=s+this.left.height,l=r+this.left.length+this.break;if(this.break)e<l&&this.left.forEachLine(e,t,i,s,r,o),t>=l&&this.right.forEachLine(e,t,i,a,l,o);else{let h=this.lineAt(l,yt.ByPos,i,s,r);e<h.from&&this.left.forEachLine(e,h.from-1,i,s,r,o),h.to>=e&&h.from<=t&&o(h),t>h.to&&this.right.forEachLine(h.to+1,t,i,a,l,o)}}replace(e,t,i){let s=this.left.length+this.break;if(t<s)return this.balanced(this.left.replace(e,t,i),this.right);if(e>this.left.length)return this.balanced(this.left,this.right.replace(e-s,t-s,i));let r=[];e>0&&this.decomposeLeft(e,r);let o=r.length;for(let a of i)r.push(a);if(e>0&&_T(r,o-1),t<this.length){let a=r.length;this.decomposeRight(t,r),_T(r,a)}return Wi.of(r)}decomposeLeft(e,t){let i=this.left.length;if(e<=i)return this.left.decomposeLeft(e,t);t.push(this.left),this.break&&(i++,e>=i&&t.push(null)),e>i&&this.right.decomposeLeft(e-i,t)}decomposeRight(e,t){let i=this.left.length,s=i+this.break;if(e>=s)return this.right.decomposeRight(e-s,t);e<i&&this.left.decomposeRight(e,t),this.break&&e<s&&t.push(null),t.push(this.right)}balanced(e,t){return e.size>2*t.size||t.size>2*e.size?Wi.of(this.break?[e,null,t]:[e,t]):(this.left=e,this.right=t,this.height=e.height+t.height,this.outdated=e.outdated||t.outdated,this.size=e.size+t.size,this.length=e.length+this.break+t.length,this)}updateHeight(e,t=0,i=!1,s){let{left:r,right:o}=this,a=t+r.length+this.break,l=null;return s&&s.from<=t+r.length&&s.more?l=r=r.updateHeight(e,t,i,s):r.updateHeight(e,t,i),s&&s.from<=a+o.length&&s.more?l=o=o.updateHeight(e,a,i,s):o.updateHeight(e,a,i),l?this.balanced(r,o):(this.height=this.left.height+this.right.height,this.outdated=!1,this)}toString(){return this.left+(this.break?" ":"-")+this.right}}function _T(n,e){let t,i;n[e]==null&&(t=n[e-1])instanceof si&&(i=n[e+1])instanceof si&&n.splice(e-1,3,new si(t.length+1+i.length))}const FV=5;class Ab{constructor(e,t){this.pos=e,this.oracle=t,this.nodes=[],this.lineStart=-1,this.lineEnd=-1,this.covering=null,this.writtenTo=e}get isCovered(){return this.covering&&this.nodes[this.nodes.length-1]==this.covering}span(e,t){if(this.lineStart>-1){let i=Math.min(t,this.lineEnd),s=this.nodes[this.nodes.length-1];s instanceof sn?s.length+=i-this.pos:(i>this.pos||!this.isCovered)&&this.nodes.push(new sn(i-this.pos,-1)),this.writtenTo=i,t>i&&(this.nodes.push(null),this.writtenTo++,this.lineStart=-1)}this.pos=t}point(e,t,i){if(e<t||i.heightRelevant){let s=i.widget?i.widget.estimatedHeight:0;s<0&&(s=this.oracle.lineHeight);let r=t-e;i.block?this.addBlock(new GP(r,s,i.type)):(r||s>=FV)&&this.addLineDeco(s,r)}else t>e&&this.span(e,t);this.lineEnd>-1&&this.lineEnd<this.pos&&(this.lineEnd=this.oracle.doc.lineAt(this.pos).to)}enterLine(){if(this.lineStart>-1)return;let{from:e,to:t}=this.oracle.doc.lineAt(this.pos);this.lineStart=e,this.lineEnd=t,this.writtenTo<e&&((this.writtenTo<e-1||this.nodes[this.nodes.length-1]==null)&&this.nodes.push(this.blankContent(this.writtenTo,e-1)),this.nodes.push(null)),this.pos>e&&this.nodes.push(new sn(this.pos-e,-1)),this.writtenTo=this.pos}blankContent(e,t){let i=new si(t-e);return this.oracle.doc.lineAt(e).to==t&&(i.flags|=4),i}ensureLine(){this.enterLine();let e=this.nodes.length?this.nodes[this.nodes.length-1]:null;if(e instanceof sn)return e;let t=new sn(0,-1);return this.nodes.push(t),t}addBlock(e){this.enterLine(),e.type==mt.WidgetAfter&&!this.isCovered&&this.ensureLine(),this.nodes.push(e),this.writtenTo=this.pos=this.pos+e.length,e.type!=mt.WidgetBefore&&(this.covering=e)}addLineDeco(e,t){let i=this.ensureLine();i.length+=t,i.collapsed+=t,i.widgetHeight=Math.max(i.widgetHeight,e),this.writtenTo=this.pos=this.pos+t}finish(e){let t=this.nodes.length==0?null:this.nodes[this.nodes.length-1];this.lineStart>-1&&!(t instanceof sn)&&!this.isCovered?this.nodes.push(new sn(0,-1)):(this.writtenTo<this.pos||t==null)&&this.nodes.push(this.blankContent(this.writtenTo,this.pos));let i=e;for(let s of this.nodes)s instanceof sn&&s.updateHeight(this.oracle,i),i+=s?s.length:1;return this.nodes}static build(e,t,i,s){let r=new Ab(i,e);return st.spans(t,i,s,r,0),r.finish(i)}}function VV(n,e,t){let i=new UV;return st.compare(n,e,t,i,0),i.changes}class UV{constructor(){this.changes=[]}compareRange(){}comparePoint(e,t,i,s){(e<t||i&&i.heightRelevant||s&&s.heightRelevant)&&TO(e,t,this.changes,5)}}function qV(n,e){let t=n.getBoundingClientRect(),i=Math.max(0,t.left),s=Math.min(innerWidth,t.right),r=Math.max(0,t.top),o=Math.min(innerHeight,t.bottom),a=n.ownerDocument.body;for(let l=n.parentNode;l&&l!=a;)if(l.nodeType==1){let h=l,u=window.getComputedStyle(h);if((h.scrollHeight>h.clientHeight||h.scrollWidth>h.clientWidth)&&u.overflow!="visible"){let c=h.getBoundingClientRect();i=Math.max(i,c.left),s=Math.min(s,c.right),r=Math.max(r,c.top),o=Math.min(o,c.bottom)}l=u.position=="absolute"||u.position=="fixed"?h.offsetParent:h.parentNode}else if(l.nodeType==11)l=l.host;else break;return{left:i-t.left,right:Math.max(i,s)-t.left,top:r-(t.top+e),bottom:Math.max(r,o)-(t.top+e)}}function zV(n,e){let t=n.getBoundingClientRect();return{left:0,right:t.right-t.left,top:e,bottom:t.bottom-(t.top+e)}}class Hm{constructor(e,t,i){this.from=e,this.to=t,this.size=i}static same(e,t){if(e.length!=t.length)return!1;for(let i=0;i<e.length;i++){let s=e[i],r=t[i];if(s.from!=r.from||s.to!=r.to||s.size!=r.size)return!1}return!0}draw(e){return Ie.replace({widget:new jV(this.size,e)}).range(this.from,this.to)}}class jV extends Yr{constructor(e,t){super(),this.size=e,this.vertical=t}eq(e){return e.size==this.size&&e.vertical==this.vertical}toDOM(){let e=document.createElement("div");return this.vertical?e.style.height=this.size+"px":(e.style.width=this.size+"px",e.style.height="2px",e.style.display="inline-block"),e}get estimatedHeight(){return this.vertical?this.size:-1}}class kT{constructor(e){this.state=e,this.pixelViewport={left:0,right:window.innerWidth,top:0,bottom:0},this.inView=!0,this.paddingTop=0,this.paddingBottom=0,this.contentDOMWidth=0,this.contentDOMHeight=0,this.editorHeight=0,this.editorWidth=0,this.heightOracle=new QV,this.scaler=AT,this.scrollTarget=null,this.printing=!1,this.mustMeasureContent=!0,this.defaultTextDirection=At.RTL,this.visibleRanges=[],this.mustEnforceCursorAssoc=!1,this.stateDeco=e.facet(tu).filter(t=>typeof t!="function"),this.heightMap=Wi.empty().applyChanges(this.stateDeco,nt.empty,this.heightOracle.setDoc(e.doc),[new ir(0,0,0,e.doc.length)]),this.viewport=this.getViewport(0,null),this.updateViewportLines(),this.updateForViewport(),this.lineGaps=this.ensureLineGaps([]),this.lineGapDeco=Ie.set(this.lineGaps.map(t=>t.draw(!1))),this.computeVisibleRanges()}updateForViewport(){let e=[this.viewport],{main:t}=this.state.selection;for(let i=0;i<=1;i++){let s=i?t.head:t.anchor;if(!e.some(({from:r,to:o})=>s>=r&&s<=o)){let{from:r,to:o}=this.lineBlockAt(s);e.push(new Ic(r,o))}}this.viewports=e.sort((i,s)=>i.from-s.from),this.scaler=this.heightMap.height<=7e6?AT:new WV(this.heightOracle.doc,this.heightMap,this.viewports)}updateViewportLines(){this.viewportLines=[],this.heightMap.forEachLine(this.viewport.from,this.viewport.to,this.state.doc,0,0,e=>{this.viewportLines.push(this.scaler.scale==1?e:hh(e,this.scaler))})}update(e,t=null){this.state=e.state;let i=this.stateDeco;this.stateDeco=this.state.facet(tu).filter(h=>typeof h!="function");let s=e.changedRanges,r=ir.extendWithRanges(s,VV(i,this.stateDeco,e?e.changes:Ht.empty(this.state.doc.length))),o=this.heightMap.height;this.heightMap=this.heightMap.applyChanges(this.stateDeco,e.startState.doc,this.heightOracle.setDoc(this.state.doc),r),this.heightMap.height!=o&&(e.flags|=2);let a=r.length?this.mapViewport(this.viewport,e.changes):this.viewport;(t&&(t.range.head<a.from||t.range.head>a.to)||!this.viewportIsAppropriate(a))&&(a=this.getViewport(0,t));let l=!e.changes.empty||e.flags&2||a.from!=this.viewport.from||a.to!=this.viewport.to;this.viewport=a,this.updateForViewport(),l&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(this.mapLineGaps(this.lineGaps,e.changes))),e.flags|=this.computeVisibleRanges(),t&&(this.scrollTarget=t),!this.mustEnforceCursorAssoc&&e.selectionSet&&e.view.lineWrapping&&e.state.selection.main.empty&&e.state.selection.main.assoc&&(this.mustEnforceCursorAssoc=!0)}measure(e){let t=e.contentDOM,i=window.getComputedStyle(t),s=this.heightOracle,r=i.whiteSpace;this.defaultTextDirection=i.direction=="rtl"?At.RTL:At.LTR;let o=this.heightOracle.mustRefreshForWrapping(r),a=o||this.mustMeasureContent||this.contentDOMHeight!=t.clientHeight;this.contentDOMHeight=t.clientHeight,this.mustMeasureContent=!1;let l=0,h=0,u=parseInt(i.paddingTop)||0,c=parseInt(i.paddingBottom)||0;(this.paddingTop!=u||this.paddingBottom!=c)&&(this.paddingTop=u,this.paddingBottom=c,l|=10),this.editorWidth!=e.scrollDOM.clientWidth&&(s.lineWrapping&&(a=!0),this.editorWidth=e.scrollDOM.clientWidth,l|=8);let f=(this.printing?zV:qV)(t,this.paddingTop),p=f.top-this.pixelViewport.top,b=f.bottom-this.pixelViewport.bottom;this.pixelViewport=f;let y=this.pixelViewport.bottom>this.pixelViewport.top&&this.pixelViewport.right>this.pixelViewport.left;if(y!=this.inView&&(this.inView=y,y&&(a=!0)),!this.inView)return 0;let _=t.clientWidth;if((this.contentDOMWidth!=_||this.editorHeight!=e.scrollDOM.clientHeight)&&(this.contentDOMWidth=_,this.editorHeight=e.scrollDOM.clientHeight,l|=8),a){let w=e.docView.measureVisibleLineHeights(this.viewport);if(s.mustRefreshForHeights(w)&&(o=!0),o||s.lineWrapping&&Math.abs(_-this.contentDOMWidth)>s.charWidth){let{lineHeight:v,charWidth:S}=e.docView.measureTextSize();o=s.refresh(r,v,S,_/S,w),o&&(e.docView.minWidth=0,l|=8)}p>0&&b>0?h=Math.max(p,b):p<0&&b<0&&(h=Math.min(p,b)),s.heightChanged=!1;for(let v of this.viewports){let S=v.from==this.viewport.from?w:e.docView.measureVisibleLineHeights(v);this.heightMap=this.heightMap.updateHeight(s,0,o,new BV(v.from,S))}s.heightChanged&&(l|=2)}let T=!this.viewportIsAppropriate(this.viewport,h)||this.scrollTarget&&(this.scrollTarget.range.head<this.viewport.from||this.scrollTarget.range.head>this.viewport.to);return T&&(this.viewport=this.getViewport(h,this.scrollTarget)),this.updateForViewport(),(l&2||T)&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(o?[]:this.lineGaps)),l|=this.computeVisibleRanges(),this.mustEnforceCursorAssoc&&(this.mustEnforceCursorAssoc=!1,e.docView.enforceCursorAssoc()),l}get visibleTop(){return this.scaler.fromDOM(this.pixelViewport.top)}get visibleBottom(){return this.scaler.fromDOM(this.pixelViewport.bottom)}getViewport(e,t){let i=.5-Math.max(-.5,Math.min(.5,e/1e3/2)),s=this.heightMap,r=this.state.doc,{visibleTop:o,visibleBottom:a}=this,l=new Ic(s.lineAt(o-i*1e3,yt.ByHeight,r,0,0).from,s.lineAt(a+(1-i)*1e3,yt.ByHeight,r,0,0).to);if(t){let{head:h}=t.range;if(h<l.from||h>l.to){let u=Math.min(this.editorHeight,this.pixelViewport.bottom-this.pixelViewport.top),c=s.lineAt(h,yt.ByPos,r,0,0),f;t.y=="center"?f=(c.top+c.bottom)/2-u/2:t.y=="start"||t.y=="nearest"&&h<l.from?f=c.top:f=c.bottom-u,l=new Ic(s.lineAt(f-1e3/2,yt.ByHeight,r,0,0).from,s.lineAt(f+u+1e3/2,yt.ByHeight,r,0,0).to)}}return l}mapViewport(e,t){let i=t.mapPos(e.from,-1),s=t.mapPos(e.to,1);return new Ic(this.heightMap.lineAt(i,yt.ByPos,this.state.doc,0,0).from,this.heightMap.lineAt(s,yt.ByPos,this.state.doc,0,0).to)}viewportIsAppropriate({from:e,to:t},i=0){if(!this.inView)return!0;let{top:s}=this.heightMap.lineAt(e,yt.ByPos,this.state.doc,0,0),{bottom:r}=this.heightMap.lineAt(t,yt.ByPos,this.state.doc,0,0),{visibleTop:o,visibleBottom:a}=this;return(e==0||s<=o-Math.max(10,Math.min(-i,250)))&&(t==this.state.doc.length||r>=a+Math.max(10,Math.min(i,250)))&&s>o-2*1e3&&r<a+2*1e3}mapLineGaps(e,t){if(!e.length||t.empty)return e;let i=[];for(let s of e)t.touchesRange(s.from,s.to)||i.push(new Hm(t.mapPos(s.from),t.mapPos(s.to),s.size));return i}ensureLineGaps(e){let t=[];if(this.defaultTextDirection!=At.LTR)return t;for(let i of this.viewportLines){if(i.length<4e3)continue;let s=XV(i.from,i.to,this.stateDeco);if(s.total<4e3)continue;let r,o;if(this.heightOracle.lineWrapping){let h=2e3/this.heightOracle.lineLength*this.heightOracle.lineHeight;r=Rc(s,(this.visibleTop-i.top-h)/i.height),o=Rc(s,(this.visibleBottom-i.top+h)/i.height)}else{let h=s.total*this.heightOracle.charWidth,u=2e3*this.heightOracle.charWidth;r=Rc(s,(this.pixelViewport.left-u)/h),o=Rc(s,(this.pixelViewport.right+u)/h)}let a=[];r>i.from&&a.push({from:i.from,to:r}),o<i.to&&a.push({from:o,to:i.to});let l=this.state.selection.main;l.from>=i.from&&l.from<=i.to&&ET(a,l.from-10,l.from+10),!l.empty&&l.to>=i.from&&l.to<=i.to&&ET(a,l.to-10,l.to+10);for(let{from:h,to:u}of a)u-h>1e3&&t.push(HV(e,c=>c.from>=i.from&&c.to<=i.to&&Math.abs(c.from-h)<1e3&&Math.abs(c.to-u)<1e3)||new Hm(h,u,this.gapSize(i,h,u,s)))}return t}gapSize(e,t,i,s){let r=CT(s,i)-CT(s,t);return this.heightOracle.lineWrapping?e.height*r:s.total*this.heightOracle.charWidth*r}updateLineGaps(e){Hm.same(e,this.lineGaps)||(this.lineGaps=e,this.lineGapDeco=Ie.set(e.map(t=>t.draw(this.heightOracle.lineWrapping))))}computeVisibleRanges(){let e=this.stateDeco;this.lineGaps.length&&(e=e.concat(this.lineGapDeco));let t=[];st.spans(e,this.viewport.from,this.viewport.to,{span(s,r){t.push({from:s,to:r})},point(){}},20);let i=t.length!=this.visibleRanges.length||this.visibleRanges.some((s,r)=>s.from!=t[r].from||s.to!=t[r].to);return this.visibleRanges=t,i?4:0}lineBlockAt(e){return e>=this.viewport.from&&e<=this.viewport.to&&this.viewportLines.find(t=>t.from<=e&&t.to>=e)||hh(this.heightMap.lineAt(e,yt.ByPos,this.state.doc,0,0),this.scaler)}lineBlockAtHeight(e){return hh(this.heightMap.lineAt(this.scaler.fromDOM(e),yt.ByHeight,this.state.doc,0,0),this.scaler)}elementAtHeight(e){return hh(this.heightMap.blockAt(this.scaler.fromDOM(e),this.state.doc,0,0),this.scaler)}get docHeight(){return this.scaler.toDOM(this.heightMap.height)}get contentHeight(){return this.docHeight+this.paddingTop+this.paddingBottom}}class Ic{constructor(e,t){this.from=e,this.to=t}}function XV(n,e,t){let i=[],s=n,r=0;return st.spans(t,n,e,{span(){},point(o,a){o>s&&(i.push({from:s,to:o}),r+=o-s),s=a}},20),s<e&&(i.push({from:s,to:e}),r+=e-s),{total:r,ranges:i}}function Rc({total:n,ranges:e},t){if(t<=0)return e[0].from;if(t>=1)return e[e.length-1].to;let i=Math.floor(n*t);for(let s=0;;s++){let{from:r,to:o}=e[s],a=o-r;if(i<=a)return r+i;i-=a}}function CT(n,e){let t=0;for(let{from:i,to:s}of n.ranges){if(e<=s){t+=e-i;break}t+=s-i}return t/n.total}function ET(n,e,t){for(let i=0;i<n.length;i++){let s=n[i];if(s.from<t&&s.to>e){let r=[];s.from<e&&r.push({from:s.from,to:e}),s.to>t&&r.push({from:t,to:s.to}),n.splice(i,1,...r),i+=r.length-1}}}function HV(n,e){for(let t of n)if(e(t))return t}const AT={toDOM(n){return n},fromDOM(n){return n},scale:1};class WV{constructor(e,t,i){let s=0,r=0,o=0;this.viewports=i.map(({from:a,to:l})=>{let h=t.lineAt(a,yt.ByPos,e,0,0).top,u=t.lineAt(l,yt.ByPos,e,0,0).bottom;return s+=u-h,{from:a,to:l,top:h,bottom:u,domTop:0,domBottom:0}}),this.scale=(7e6-s)/(t.height-s);for(let a of this.viewports)a.domTop=o+(a.top-r)*this.scale,o=a.domBottom=a.domTop+(a.bottom-a.top),r=a.bottom}toDOM(e){for(let t=0,i=0,s=0;;t++){let r=t<this.viewports.length?this.viewports[t]:null;if(!r||e<r.top)return s+(e-i)*this.scale;if(e<=r.bottom)return r.domTop+(e-r.top);i=r.bottom,s=r.domBottom}}fromDOM(e){for(let t=0,i=0,s=0;;t++){let r=t<this.viewports.length?this.viewports[t]:null;if(!r||e<r.domTop)return i+(e-s)/this.scale;if(e<=r.domBottom)return r.top+(e-r.domTop);i=r.bottom,s=r.domBottom}}}function hh(n,e){if(e.scale==1)return n;let t=e.toDOM(n.top),i=e.toDOM(n.bottom);return new $r(n.from,n.length,t,i-t,Array.isArray(n.type)?n.type.map(s=>hh(s,e)):n.type)}const Lc=Ce.define({combine:n=>n.join(" ")}),AO=Ce.define({combine:n=>n.indexOf(!0)>-1}),PO=Ti.newName(),KP=Ti.newName(),JP=Ti.newName(),eD={"&light":"."+KP,"&dark":"."+JP};function DO(n,e,t){return new Ti(e,{finish(i){return/&/.test(i)?i.replace(/&\w*/,s=>{if(s=="&")return n;if(!t||!t[s])throw new RangeError(`Unsupported selector: ${s}`);return t[s]}):n+" "+i}})}const ZV=DO("."+PO,{"&.cm-editor":{position:"relative !important",boxSizing:"border-box","&.cm-focused":{outline:"1px dotted #212121"},display:"flex !important",flexDirection:"column"},".cm-scroller":{display:"flex !important",alignItems:"flex-start !important",fontFamily:"monospace",lineHeight:1.4,height:"100%",overflowX:"auto",position:"relative",zIndex:0},".cm-content":{margin:0,flexGrow:2,minHeight:"100%",display:"block",whiteSpace:"pre",wordWrap:"normal",boxSizing:"border-box",padding:"4px 0",outline:"none","&[contenteditable=true]":{WebkitUserModify:"read-write-plaintext-only"}},".cm-lineWrapping":{whiteSpace_fallback:"pre-wrap",whiteSpace:"break-spaces",wordBreak:"break-word",overflowWrap:"anywhere"},"&light .cm-content":{caretColor:"black"},"&dark .cm-content":{caretColor:"white"},".cm-line":{display:"block",padding:"0 2px 0 4px"},".cm-selectionLayer":{zIndex:-1,contain:"size style"},".cm-selectionBackground":{position:"absolute"},"&light .cm-selectionBackground":{background:"#d9d9d9"},"&dark .cm-selectionBackground":{background:"#222"},"&light.cm-focused .cm-selectionBackground":{background:"#d7d4f0"},"&dark.cm-focused .cm-selectionBackground":{background:"#233"},".cm-cursorLayer":{zIndex:100,contain:"size style",pointerEvents:"none"},"&.cm-focused .cm-cursorLayer":{animation:"steps(1) cm-blink 1.2s infinite"},"@keyframes cm-blink":{"0%":{},"50%":{visibility:"hidden"},"100%":{}},"@keyframes cm-blink2":{"0%":{},"50%":{visibility:"hidden"},"100%":{}},".cm-cursor, .cm-dropCursor":{position:"absolute",borderLeft:"1.2px solid black",marginLeft:"-0.6px",pointerEvents:"none"},".cm-cursor":{display:"none"},"&dark .cm-cursor":{borderLeftColor:"#444"},"&.cm-focused .cm-cursor":{display:"block"},"&light .cm-activeLine":{backgroundColor:"#f3f9ff"},"&dark .cm-activeLine":{backgroundColor:"#223039"},"&light .cm-specialChar":{color:"red"},"&dark .cm-specialChar":{color:"#f78"},".cm-gutters":{display:"flex",height:"100%",boxSizing:"border-box",left:0,zIndex:200},"&light .cm-gutters":{backgroundColor:"#f5f5f5",color:"#6c6c6c",borderRight:"1px solid #ddd"},"&dark .cm-gutters":{backgroundColor:"#333338",color:"#ccc"},".cm-gutter":{display:"flex !important",flexDirection:"column",flexShrink:0,boxSizing:"border-box",minHeight:"100%",overflow:"hidden"},".cm-gutterElement":{boxSizing:"border-box"},".cm-lineNumbers .cm-gutterElement":{padding:"0 3px 0 5px",minWidth:"20px",textAlign:"right",whiteSpace:"nowrap"},"&light .cm-activeLineGutter":{backgroundColor:"#e2f2ff"},"&dark .cm-activeLineGutter":{backgroundColor:"#222227"},".cm-panels":{boxSizing:"border-box",position:"sticky",left:0,right:0},"&light .cm-panels":{backgroundColor:"#f5f5f5",color:"black"},"&light .cm-panels-top":{borderBottom:"1px solid #ddd"},"&light .cm-panels-bottom":{borderTop:"1px solid #ddd"},"&dark .cm-panels":{backgroundColor:"#333338",color:"white"},".cm-tab":{display:"inline-block",overflow:"hidden",verticalAlign:"bottom"},".cm-widgetBuffer":{verticalAlign:"text-top",height:"1em",display:"inline"},".cm-placeholder":{color:"#888",display:"inline-block",verticalAlign:"top"},".cm-button":{verticalAlign:"middle",color:"inherit",fontSize:"70%",padding:".2em 1em",borderRadius:"1px"},"&light .cm-button":{backgroundImage:"linear-gradient(#eff1f5, #d9d9df)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#b4b4b4, #d0d3d6)"}},"&dark .cm-button":{backgroundImage:"linear-gradient(#393939, #111)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#111, #333)"}},".cm-textfield":{verticalAlign:"middle",color:"inherit",fontSize:"70%",border:"1px solid silver",padding:".2em .5em"},"&light .cm-textfield":{backgroundColor:"white"},"&dark .cm-textfield":{border:"1px solid #555",backgroundColor:"inherit"}},eD),YV={childList:!0,characterData:!0,subtree:!0,attributes:!0,characterDataOldValue:!0},Wm=_e.ie&&_e.ie_version<=11;class GV{constructor(e,t,i){this.view=e,this.onChange=t,this.onScrollChanged=i,this.active=!1,this.selectionRange=new K9,this.selectionChanged=!1,this.delayedFlush=-1,this.resizeTimeout=-1,this.queue=[],this.delayedAndroidKey=null,this.scrollTargets=[],this.intersection=null,this.resize=null,this.intersecting=!1,this.gapIntersection=null,this.gaps=[],this.parentCheck=-1,this.dom=e.contentDOM,this.observer=new MutationObserver(s=>{for(let r of s)this.queue.push(r);(_e.ie&&_e.ie_version<=11||_e.ios&&e.composing)&&s.some(r=>r.type=="childList"&&r.removedNodes.length||r.type=="characterData"&&r.oldValue.length>r.target.nodeValue.length)?this.flushSoon():this.flush()}),Wm&&(this.onCharData=s=>{this.queue.push({target:s.target,type:"characterData",oldValue:s.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this),window.addEventListener("resize",this.onResize=this.onResize.bind(this)),typeof ResizeObserver=="function"&&(this.resize=new ResizeObserver(()=>{this.view.docView.lastUpdate<Date.now()-75&&this.onResize()}),this.resize.observe(e.scrollDOM)),window.addEventListener("beforeprint",this.onPrint=this.onPrint.bind(this)),this.start(),window.addEventListener("scroll",this.onScroll=this.onScroll.bind(this)),typeof IntersectionObserver=="function"&&(this.intersection=new IntersectionObserver(s=>{this.parentCheck<0&&(this.parentCheck=setTimeout(this.listenForScroll.bind(this),1e3)),s.length>0&&s[s.length-1].intersectionRatio>0!=this.intersecting&&(this.intersecting=!this.intersecting,this.intersecting!=this.view.inView&&this.onScrollChanged(document.createEvent("Event")))},{}),this.intersection.observe(this.dom),this.gapIntersection=new IntersectionObserver(s=>{s.length>0&&s[s.length-1].intersectionRatio>0&&this.onScrollChanged(document.createEvent("Event"))},{})),this.listenForScroll(),this.readSelectionRange(),this.dom.ownerDocument.addEventListener("selectionchange",this.onSelectionChange)}onScroll(e){this.intersecting&&this.flush(!1),this.onScrollChanged(e)}onResize(){this.resizeTimeout<0&&(this.resizeTimeout=setTimeout(()=>{this.resizeTimeout=-1,this.view.requestMeasure()},50))}onPrint(){this.view.viewState.printing=!0,this.view.measure(),setTimeout(()=>{this.view.viewState.printing=!1,this.view.requestMeasure()},500)}updateGaps(e){if(this.gapIntersection&&(e.length!=this.gaps.length||this.gaps.some((t,i)=>t!=e[i]))){this.gapIntersection.disconnect();for(let t of e)this.gapIntersection.observe(t);this.gaps=e}}onSelectionChange(e){if(!this.readSelectionRange()||this.delayedAndroidKey)return;let{view:t}=this,i=this.selectionRange;if(t.state.facet(Du)?t.root.activeElement!=this.dom:!pO(t.dom,i))return;let s=i.anchorNode&&t.docView.nearest(i.anchorNode);s&&s.ignoreEvent(e)||((_e.ie&&_e.ie_version<=11||_e.android&&_e.chrome)&&!t.state.selection.main.empty&&i.focusNode&&sf(i.focusNode,i.focusOffset,i.anchorNode,i.anchorOffset)?this.flushSoon():this.flush(!1))}readSelectionRange(){let{root:e}=this.view,t=nf(e),i=_e.safari&&e.nodeType==11&&Z9()==this.view.contentDOM&&KV(this.view)||t;return this.selectionRange.eq(i)?!1:(this.selectionRange.setRange(i),this.selectionChanged=!0)}setSelectionRange(e,t){this.selectionRange.set(e.node,e.offset,t.node,t.offset),this.selectionChanged=!1}clearSelectionRange(){this.selectionRange.set(null,0,null,0)}listenForScroll(){this.parentCheck=-1;let e=0,t=null;for(let i=this.dom;i;)if(i.nodeType==1)!t&&e<this.scrollTargets.length&&this.scrollTargets[e]==i?e++:t||(t=this.scrollTargets.slice(0,e)),t&&t.push(i),i=i.assignedSlot||i.parentNode;else if(i.nodeType==11)i=i.host;else break;if(e<this.scrollTargets.length&&!t&&(t=this.scrollTargets.slice(0,e)),t){for(let i of this.scrollTargets)i.removeEventListener("scroll",this.onScroll);for(let i of this.scrollTargets=t)i.addEventListener("scroll",this.onScroll)}}ignore(e){if(!this.active)return e();try{return this.stop(),e()}finally{this.start(),this.clear()}}start(){this.active||(this.observer.observe(this.dom,YV),Wm&&this.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.active=!0)}stop(){this.active&&(this.active=!1,this.observer.disconnect(),Wm&&this.dom.removeEventListener("DOMCharacterDataModified",this.onCharData))}clear(){this.processRecords(),this.queue.length=0,this.selectionChanged=!1}delayAndroidKey(e,t){this.delayedAndroidKey||requestAnimationFrame(()=>{let i=this.delayedAndroidKey;this.delayedAndroidKey=null,this.delayedFlush=-1,this.flush()||Dh(this.view.contentDOM,i.key,i.keyCode)}),(!this.delayedAndroidKey||e=="Enter")&&(this.delayedAndroidKey={key:e,keyCode:t})}flushSoon(){this.delayedFlush<0&&(this.delayedFlush=window.setTimeout(()=>{this.delayedFlush=-1,this.flush()},20))}forceFlush(){this.delayedFlush>=0&&(window.clearTimeout(this.delayedFlush),this.delayedFlush=-1,this.flush())}processRecords(){let e=this.queue;for(let r of this.observer.takeRecords())e.push(r);e.length&&(this.queue=[]);let t=-1,i=-1,s=!1;for(let r of e){let o=this.readMutation(r);o&&(o.typeOver&&(s=!0),t==-1?{from:t,to:i}=o:(t=Math.min(o.from,t),i=Math.max(o.to,i)))}return{from:t,to:i,typeOver:s}}flush(e=!0){if(this.delayedFlush>=0||this.delayedAndroidKey)return;e&&this.readSelectionRange();let{from:t,to:i,typeOver:s}=this.processRecords(),r=this.selectionChanged&&pO(this.dom,this.selectionRange);if(t<0&&!r)return;this.selectionChanged=!1;let o=this.view.state,a=this.onChange(t,i,s);return this.view.state==o&&this.view.update([]),a}readMutation(e){let t=this.view.docView.nearest(e.target);if(!t||t.ignoreMutation(e))return null;if(t.markDirty(e.type=="attributes"),e.type=="attributes"&&(t.dirty|=4),e.type=="childList"){let i=PT(t,e.previousSibling||e.target.previousSibling,-1),s=PT(t,e.nextSibling||e.target.nextSibling,1);return{from:i?t.posAfter(i):t.posAtStart,to:s?t.posBefore(s):t.posAtEnd,typeOver:!1}}else return e.type=="characterData"?{from:t.posAtStart,to:t.posAtEnd,typeOver:e.target.nodeValue==e.oldValue}:null}destroy(){var e,t,i;this.stop(),(e=this.intersection)===null||e===void 0||e.disconnect(),(t=this.gapIntersection)===null||t===void 0||t.disconnect(),(i=this.resize)===null||i===void 0||i.disconnect();for(let s of this.scrollTargets)s.removeEventListener("scroll",this.onScroll);window.removeEventListener("scroll",this.onScroll),window.removeEventListener("resize",this.onResize),window.removeEventListener("beforeprint",this.onPrint),this.dom.ownerDocument.removeEventListener("selectionchange",this.onSelectionChange),clearTimeout(this.parentCheck),clearTimeout(this.resizeTimeout)}}function PT(n,e,t){for(;e;){let i=Mt.get(e);if(i&&i.parent==n)return i;let s=e.parentNode;e=s!=n.dom?s:t>0?e.nextSibling:e.previousSibling}return null}function KV(n){let e=null;function t(l){l.preventDefault(),l.stopImmediatePropagation(),e=l.getTargetRanges()[0]}if(n.contentDOM.addEventListener("beforeinput",t,!0),document.execCommand("indent"),n.contentDOM.removeEventListener("beforeinput",t,!0),!e)return null;let i=e.startContainer,s=e.startOffset,r=e.endContainer,o=e.endOffset,a=n.docView.domAtPos(n.state.selection.main.anchor);return sf(a.node,a.offset,r,o)&&([i,s,r,o]=[r,o,i,s]),{anchorNode:i,anchorOffset:s,focusNode:r,focusOffset:o}}function JV(n,e,t,i){let s,r,o=n.state.selection.main;if(e>-1){let a=n.docView.domBoundsAround(e,t,0);if(!a||n.state.readOnly)return!1;let{from:l,to:h}=a,u=n.docView.impreciseHead||n.docView.impreciseAnchor?[]:tU(n),c=new NP(u,n.state);c.readRange(a.startDOM,a.endDOM);let f=o.from,p=null;(n.inputState.lastKeyCode===8&&n.inputState.lastKeyTime>Date.now()-100||_e.android&&c.text.length<h-l)&&(f=o.to,p="end");let b=eU(n.state.doc.sliceString(l,h,Lr),c.text,f-l,p);b&&(_e.chrome&&n.inputState.lastKeyCode==13&&b.toB==b.from+2&&c.text.slice(b.from,b.toB)==Lr+Lr&&b.toB--,s={from:l+b.from,to:l+b.toA,insert:nt.of(c.text.slice(b.from,b.toB).split(Lr))}),r=iU(u,l)}else if(n.hasFocus||!n.state.facet(Du)){let a=n.observer.selectionRange,{impreciseHead:l,impreciseAnchor:h}=n.docView,u=l&&l.node==a.focusNode&&l.offset==a.focusOffset||!Za(n.contentDOM,a.focusNode)?n.state.selection.main.head:n.docView.posFromDOM(a.focusNode,a.focusOffset),c=h&&h.node==a.anchorNode&&h.offset==a.anchorOffset||!Za(n.contentDOM,a.anchorNode)?n.state.selection.main.anchor:n.docView.posFromDOM(a.anchorNode,a.anchorOffset);(u!=o.head||c!=o.anchor)&&(r=le.single(c,u))}if(!s&&!r)return!1;if(!s&&i&&!o.empty&&r&&r.main.empty?s={from:o.from,to:o.to,insert:n.state.doc.slice(o.from,o.to)}:s&&s.from>=o.from&&s.to<=o.to&&(s.from!=o.from||s.to!=o.to)&&o.to-o.from-(s.to-s.from)<=4?s={from:o.from,to:o.to,insert:n.state.doc.slice(o.from,s.from).append(s.insert).append(n.state.doc.slice(s.to,o.to))}:(_e.mac||_e.android)&&s&&s.from==s.to&&s.from==o.head-1&&s.insert.toString()=="."&&(s={from:o.from,to:o.to,insert:nt.of([" "])}),s){let a=n.state;if(_e.ios&&n.inputState.flushIOSKey(n)||_e.android&&(s.from==o.from&&s.to==o.to&&s.insert.length==1&&s.insert.lines==2&&Dh(n.contentDOM,"Enter",13)||s.from==o.from-1&&s.to==o.to&&s.insert.length==0&&Dh(n.contentDOM,"Backspace",8)||s.from==o.from&&s.to==o.to+1&&s.insert.length==0&&Dh(n.contentDOM,"Delete",46)))return!0;let l=s.insert.toString();if(n.state.facet(PP).some(c=>c(n,s.from,s.to,l)))return!0;n.inputState.composing>=0&&n.inputState.composing++;let h;if(s.from>=o.from&&s.to<=o.to&&s.to-s.from>=(o.to-o.from)/3&&(!r||r.main.empty&&r.main.from==s.from+s.insert.length)&&n.inputState.composing<0){let c=o.from<s.from?a.sliceDoc(o.from,s.from):"",f=o.to>s.to?a.sliceDoc(s.to,o.to):"";h=a.replaceSelection(n.state.toText(c+s.insert.sliceString(0,void 0,n.state.lineBreak)+f))}else{let c=a.changes(s),f=r&&!a.selection.main.eq(r.main)&&r.main.to<=c.newLength?r.main:void 0;if(a.selection.ranges.length>1&&n.inputState.composing>=0&&s.to<=o.to&&s.to>=o.to-10){let p=n.state.sliceDoc(s.from,s.to),b=FP(n)||n.state.doc.lineAt(o.head),y=o.to-s.to,_=o.to-o.from;h=a.changeByRange(T=>{if(T.from==o.from&&T.to==o.to)return{changes:c,range:f||T.map(c)};let w=T.to-y,v=w-p.length;if(T.to-T.from!=_||n.state.sliceDoc(v,w)!=p||b&&T.to>=b.from&&T.from<=b.to)return{range:T};let S=a.changes({from:v,to:w,insert:s.insert}),k=T.to-o.to;return{changes:S,range:f?le.range(Math.max(0,f.anchor+k),Math.max(0,f.head+k)):T.map(S)}})}else h={changes:c,selection:f&&a.selection.replaceRange(f)}}let u="input.type";return n.composing&&(u+=".compose",n.inputState.compositionFirstChange&&(u+=".start",n.inputState.compositionFirstChange=!1)),n.dispatch(h,{scrollIntoView:!0,userEvent:u}),!0}else if(r&&!r.main.eq(o)){let a=!1,l="select";return n.inputState.lastSelectionTime>Date.now()-50&&(n.inputState.lastSelectionOrigin=="select"&&(a=!0),l=n.inputState.lastSelectionOrigin),n.dispatch({selection:r,scrollIntoView:a,userEvent:l}),!0}else return!1}function eU(n,e,t,i){let s=Math.min(n.length,e.length),r=0;for(;r<s&&n.charCodeAt(r)==e.charCodeAt(r);)r++;if(r==s&&n.length==e.length)return null;let o=n.length,a=e.length;for(;o>0&&a>0&&n.charCodeAt(o-1)==e.charCodeAt(a-1);)o--,a--;if(i=="end"){let l=Math.max(0,r-Math.min(o,a));t-=o+l-r}if(o<r&&n.length<e.length){let l=t<=r&&t>=o?r-t:0;r-=l,a=r+(a-o),o=r}else if(a<r){let l=t<=r&&t>=a?r-t:0;r-=l,o=r+(o-a),a=r}return{from:r,toA:o,toB:a}}function tU(n){let e=[];if(n.root.activeElement!=n.contentDOM)return e;let{anchorNode:t,anchorOffset:i,focusNode:s,focusOffset:r}=n.observer.selectionRange;return t&&(e.push(new lT(t,i)),(s!=t||r!=i)&&e.push(new lT(s,r))),e}function iU(n,e){if(n.length==0)return null;let t=n[0].pos,i=n.length==2?n[1].pos:t;return t>-1&&i>-1?le.single(t+e,i+e):null}class $e{constructor(e={}){this.plugins=[],this.pluginMap=new Map,this.editorAttrs={},this.contentAttrs={},this.bidiCache=[],this.destroyed=!1,this.updateState=2,this.measureScheduled=-1,this.measureRequests=[],this.contentDOM=document.createElement("div"),this.scrollDOM=document.createElement("div"),this.scrollDOM.tabIndex=-1,this.scrollDOM.className="cm-scroller",this.scrollDOM.appendChild(this.contentDOM),this.announceDOM=document.createElement("div"),this.announceDOM.style.cssText="position: absolute; top: -10000px",this.announceDOM.setAttribute("aria-live","polite"),this.dom=document.createElement("div"),this.dom.appendChild(this.announceDOM),this.dom.appendChild(this.scrollDOM),this._dispatch=e.dispatch||(t=>this.update([t])),this.dispatch=this.dispatch.bind(this),this.root=e.root||J9(e.parent)||document,this.viewState=new kT(e.state||Ge.create()),this.plugins=this.state.facet(ah).map(t=>new zm(t));for(let t of this.plugins)t.update(this);this.observer=new GV(this,(t,i,s)=>JV(this,t,i,s),t=>{this.inputState.runScrollHandlers(this,t),this.observer.intersecting&&this.measure()}),this.inputState=new kV(this),this.inputState.ensureHandlers(this,this.plugins),this.docView=new hT(this),this.mountStyles(),this.updateAttrs(),this.updateState=0,this.requestMeasure(),e.parent&&e.parent.appendChild(this.dom)}get state(){return this.viewState.state}get viewport(){return this.viewState.viewport}get visibleRanges(){return this.viewState.visibleRanges}get inView(){return this.viewState.inView}get composing(){return this.inputState.composing>0}get compositionStarted(){return this.inputState.composing>=0}dispatch(...e){this._dispatch(e.length==1&&e[0]instanceof Wt?e[0]:this.state.update(...e))}update(e){if(this.updateState!=0)throw new Error("Calls to EditorView.update are not allowed while an update is in progress");let t=!1,i=!1,s,r=this.state;for(let a of e){if(a.startState!=r)throw new RangeError("Trying to update state with a transaction that doesn't start from the previous state.");r=a.state}if(this.destroyed){this.viewState.state=r;return}if(this.observer.clear(),r.facet(Ge.phrases)!=this.state.facet(Ge.phrases))return this.setState(r);s=af.create(this,r,e);let o=this.viewState.scrollTarget;try{this.updateState=2;for(let a of e){if(o&&(o=o.map(a.changes)),a.scrollIntoView){let{main:l}=a.state.selection;o=new of(l.empty?l:le.cursor(l.head,l.head>l.anchor?-1:1))}for(let l of a.effects)l.is(oT)&&(o=l.value)}this.viewState.update(s,o),this.bidiCache=lf.update(this.bidiCache,s.changes),s.empty||(this.updatePlugins(s),this.inputState.update(s)),t=this.docView.update(s),this.state.facet(lh)!=this.styleModules&&this.mountStyles(),i=this.updateAttrs(),this.showAnnouncements(e),this.docView.updateSelection(t,e.some(a=>a.isUserEvent("select.pointer")))}finally{this.updateState=0}if(s.startState.facet(Lc)!=s.state.facet(Lc)&&(this.viewState.mustMeasureContent=!0),(t||i||o||this.viewState.mustEnforceCursorAssoc||this.viewState.mustMeasureContent)&&this.requestMeasure(),!s.empty)for(let a of this.state.facet(wO))a(s)}setState(e){if(this.updateState!=0)throw new Error("Calls to EditorView.setState are not allowed while an update is in progress");if(this.destroyed){this.viewState.state=e;return}this.updateState=2;let t=this.hasFocus;try{for(let i of this.plugins)i.destroy(this);this.viewState=new kT(e),this.plugins=e.facet(ah).map(i=>new zm(i)),this.pluginMap.clear();for(let i of this.plugins)i.update(this);this.docView=new hT(this),this.inputState.ensureHandlers(this,this.plugins),this.mountStyles(),this.updateAttrs(),this.bidiCache=[]}finally{this.updateState=0}t&&this.focus(),this.requestMeasure()}updatePlugins(e){let t=e.startState.facet(ah),i=e.state.facet(ah);if(t!=i){let s=[];for(let r of i){let o=t.indexOf(r);if(o<0)s.push(new zm(r));else{let a=this.plugins[o];a.mustUpdate=e,s.push(a)}}for(let r of this.plugins)r.mustUpdate!=e&&r.destroy(this);this.plugins=s,this.pluginMap.clear(),this.inputState.ensureHandlers(this,this.plugins)}else for(let s of this.plugins)s.mustUpdate=e;for(let s=0;s<this.plugins.length;s++)this.plugins[s].update(this)}measure(e=!0){if(this.destroyed)return;this.measureScheduled>-1&&cancelAnimationFrame(this.measureScheduled),this.measureScheduled=0,e&&this.observer.flush();let t=null;try{for(let i=0;;i++){this.updateState=1;let s=this.viewport,r=this.viewState.measure(this);if(!r&&!this.measureRequests.length&&this.viewState.scrollTarget==null)break;if(i>5){console.warn(this.measureRequests.length?"Measure loop restarted more than 5 times":"Viewport failed to stabilize");break}let o=[];r&4||([this.measureRequests,o]=[o,this.measureRequests]);let a=o.map(c=>{try{return c.read(this)}catch(f){return un(this.state,f),DT}}),l=af.create(this,this.state,[]),h=!1,u=!1;l.flags|=r,t?t.flags|=r:t=l,this.updateState=2,l.empty||(this.updatePlugins(l),this.inputState.update(l),this.updateAttrs(),h=this.docView.update(l));for(let c=0;c<o.length;c++)if(a[c]!=DT)try{let f=o[c];f.write&&f.write(a[c],this)}catch(f){un(this.state,f)}if(this.viewState.scrollTarget&&(this.docView.scrollIntoView(this.viewState.scrollTarget),this.viewState.scrollTarget=null,u=!0),h&&this.docView.updateSelection(!0),this.viewport.from==s.from&&this.viewport.to==s.to&&!u&&this.measureRequests.length==0)break}}finally{this.updateState=0,this.measureScheduled=-1}if(t&&!t.empty)for(let i of this.state.facet(wO))i(t)}get themeClasses(){return PO+" "+(this.state.facet(AO)?JP:KP)+" "+this.state.facet(Lc)}updateAttrs(){let e=MT(this,MP,{class:"cm-editor"+(this.hasFocus?" cm-focused ":" ")+this.themeClasses}),t={spellcheck:"false",autocorrect:"off",autocapitalize:"off",translate:"no",contenteditable:this.state.facet(Du)?"true":"false",class:"cm-content",style:`${_e.tabSize}: ${this.state.tabSize}`,role:"textbox","aria-multiline":"true"};this.state.readOnly&&(t["aria-readonly"]="true"),MT(this,IP,t);let i=this.observer.ignore(()=>{let s=xO(this.contentDOM,this.contentAttrs,t),r=xO(this.dom,this.editorAttrs,e);return s||r});return this.editorAttrs=e,this.contentAttrs=t,i}showAnnouncements(e){let t=!0;for(let i of e)for(let s of i.effects)if(s.is($e.announce)){t&&(this.announceDOM.textContent=""),t=!1;let r=this.announceDOM.appendChild(document.createElement("div"));r.textContent=s.value}}mountStyles(){this.styleModules=this.state.facet(lh),Ti.mount(this.root,this.styleModules.concat(ZV).reverse())}readMeasured(){if(this.updateState==2)throw new Error("Reading the editor layout isn't allowed during an update");this.updateState==0&&this.measureScheduled>-1&&this.measure(!1)}requestMeasure(e){if(this.measureScheduled<0&&(this.measureScheduled=requestAnimationFrame(()=>this.measure())),e){if(e.key!=null){for(let t=0;t<this.measureRequests.length;t++)if(this.measureRequests[t].key===e.key){this.measureRequests[t]=e;return}}this.measureRequests.push(e)}}plugin(e){let t=this.pluginMap.get(e);return(t===void 0||t&&t.spec!=e)&&this.pluginMap.set(e,t=this.plugins.find(i=>i.spec==e)||null),t&&t.update(this).value}get documentTop(){return this.contentDOM.getBoundingClientRect().top+this.viewState.paddingTop}get documentPadding(){return{top:this.viewState.paddingTop,bottom:this.viewState.paddingBottom}}elementAtHeight(e){return this.readMeasured(),this.viewState.elementAtHeight(e)}lineBlockAtHeight(e){return this.readMeasured(),this.viewState.lineBlockAtHeight(e)}get viewportLineBlocks(){return this.viewState.viewportLines}lineBlockAt(e){return this.viewState.lineBlockAt(e)}get contentHeight(){return this.viewState.contentHeight}moveByChar(e,t,i){return Xm(this,e,mT(this,e,t,i))}moveByGroup(e,t){return Xm(this,e,mT(this,e,t,i=>wV(this,e.head,i)))}moveToLineBoundary(e,t,i=!0){return TV(this,e,t,i)}moveVertically(e,t,i){return Xm(this,e,_V(this,e,t,i))}domAtPos(e){return this.docView.domAtPos(e)}posAtDOM(e,t=0){return this.docView.posFromDOM(e,t)}posAtCoords(e,t=!0){return this.readMeasured(),UP(this,e,t)}coordsAtPos(e,t=1){this.readMeasured();let i=this.docView.coordsAt(e,t);if(!i||i.left==i.right)return i;let s=this.state.doc.lineAt(e),r=this.bidiSpans(s),o=r[Da.find(r,e-s.from,-1,t)];return cp(i,o.dir==At.LTR==t>0)}get defaultCharacterWidth(){return this.viewState.heightOracle.charWidth}get defaultLineHeight(){return this.viewState.heightOracle.lineHeight}get textDirection(){return this.viewState.defaultTextDirection}textDirectionAt(e){return!this.state.facet(DP)||e<this.viewport.from||e>this.viewport.to?this.textDirection:(this.readMeasured(),this.docView.textDirectionAt(e))}get lineWrapping(){return this.viewState.heightOracle.lineWrapping}bidiSpans(e){if(e.length>nU)return QP(e.length);let t=this.textDirectionAt(e.from);for(let s of this.bidiCache)if(s.from==e.from&&s.dir==t)return s.order;let i=uV(e.text,t);return this.bidiCache.push(new lf(e.from,e.to,t,i)),i}get hasFocus(){var e;return(document.hasFocus()||_e.safari&&((e=this.inputState)===null||e===void 0?void 0:e.lastContextMenu)>Date.now()-3e4)&&this.root.activeElement==this.contentDOM}focus(){this.observer.ignore(()=>{fP(this.contentDOM),this.docView.updateSelection()})}destroy(){for(let e of this.plugins)e.destroy(this);this.plugins=[],this.inputState.destroy(),this.dom.remove(),this.observer.destroy(),this.measureScheduled>-1&&cancelAnimationFrame(this.measureScheduled),this.destroyed=!0}static scrollIntoView(e,t={}){return oT.of(new of(typeof e=="number"?le.cursor(e):e,t.y,t.x,t.yMargin,t.xMargin))}static domEventHandlers(e){return Xt.define(()=>({}),{eventHandlers:e})}static theme(e,t){let i=Ti.newName(),s=[Lc.of(i),lh.of(DO(`.${i}`,e))];return t&&t.dark&&s.push(AO.of(!0)),s}static baseTheme(e){return Eu.lowest(lh.of(DO("."+PO,e,eD)))}}$e.styleModule=lh;$e.inputHandler=PP;$e.perLineTextDirection=DP;$e.exceptionSink=AP;$e.updateListener=wO;$e.editable=Du;$e.mouseSelectionStyle=EP;$e.dragMovesSelection=CP;$e.clickAddsSelectionRange=kP;$e.decorations=tu;$e.atomicRanges=RP;$e.scrollMargins=LP;$e.darkTheme=AO;$e.contentAttributes=IP;$e.editorAttributes=MP;$e.lineWrapping=$e.contentAttributes.of({class:"cm-lineWrapping"});$e.announce=Ue.define();const nU=4096,DT={};class lf{constructor(e,t,i,s){this.from=e,this.to=t,this.dir=i,this.order=s}static update(e,t){if(t.empty)return e;let i=[],s=e.length?e[e.length-1].dir:At.LTR;for(let r=Math.max(0,e.length-10);r<e.length;r++){let o=e[r];o.dir==s&&!t.touchesRange(o.from,o.to)&&i.push(new lf(t.mapPos(o.from,1),t.mapPos(o.to,-1),o.dir,o.order))}return i}}function MT(n,e,t){for(let i=n.state.facet(e),s=i.length-1;s>=0;s--){let r=i[s],o=typeof r=="function"?r(n):r;o&&SO(o,t)}return t}const sU=_e.mac?"mac":_e.windows?"win":_e.linux?"linux":"key";function rU(n,e){const t=n.split(/-(?!$)/);let i=t[t.length-1];i=="Space"&&(i=" ");let s,r,o,a;for(let l=0;l<t.length-1;++l){const h=t[l];if(/^(cmd|meta|m)$/i.test(h))a=!0;else if(/^a(lt)?$/i.test(h))s=!0;else if(/^(c|ctrl|control)$/i.test(h))r=!0;else if(/^s(hift)?$/i.test(h))o=!0;else if(/^mod$/i.test(h))e=="mac"?a=!0:r=!0;else throw new Error("Unrecognized modifier name: "+h)}return s&&(i="Alt-"+i),r&&(i="Ctrl-"+i),a&&(i="Meta-"+i),o&&(i="Shift-"+i),i}function Zm(n,e,t){return e.altKey&&(n="Alt-"+n),e.ctrlKey&&(n="Ctrl-"+n),e.metaKey&&(n="Meta-"+n),t!==!1&&e.shiftKey&&(n="Shift-"+n),n}const oU=$e.domEventHandlers({keydown(n,e){return iD(tD(e.state),n,e,"editor")}}),Pb=Ce.define({enables:oU}),IT=new WeakMap;function tD(n){let e=n.facet(Pb),t=IT.get(e);return t||IT.set(e,t=hU(e.reduce((i,s)=>i.concat(s),[]))),t}function aU(n,e,t){return iD(tD(n.state),e,n,t)}let Dr=null;const lU=4e3;function hU(n,e=sU){let t=Object.create(null),i=Object.create(null),s=(o,a)=>{let l=i[o];if(l==null)i[o]=a;else if(l!=a)throw new Error("Key binding "+o+" is used both as a regular binding and as a multi-stroke prefix")},r=(o,a,l,h)=>{let u=t[o]||(t[o]=Object.create(null)),c=a.split(/ (?!$)/).map(b=>rU(b,e));for(let b=1;b<c.length;b++){let y=c.slice(0,b).join(" ");s(y,!0),u[y]||(u[y]={preventDefault:!0,commands:[_=>{let T=Dr={view:_,prefix:y,scope:o};return setTimeout(()=>{Dr==T&&(Dr=null)},lU),!0}]})}let f=c.join(" ");s(f,!1);let p=u[f]||(u[f]={preventDefault:!1,commands:[]});p.commands.push(l),h&&(p.preventDefault=!0)};for(let o of n){let a=o[e]||o.key;if(a)for(let l of o.scope?o.scope.split(" "):["editor"])r(l,a,o.run,o.preventDefault),o.shift&&r(l,"Shift-"+a,o.shift,o.preventDefault)}return t}function iD(n,e,t,i){let s=BE(e),r=s.length==1&&s!=" ",o="",a=!1;Dr&&Dr.view==t&&Dr.scope==i&&(o=Dr.prefix+" ",(a=zP.indexOf(e.keyCode)<0)&&(Dr=null));let l=c=>{if(c){for(let f of c.commands)if(f(t))return!0;c.preventDefault&&(a=!0)}return!1},h=n[i],u;if(h){if(l(h[o+Zm(s,e,!r)]))return!0;if(r&&(e.shiftKey||e.altKey||e.metaKey)&&(u=rr[e.keyCode])&&u!=s){if(l(h[o+Zm(u,e,!0)]))return!0}else if(r&&e.shiftKey&&l(h[o+Zm(s,e,!0)]))return!0}return a}const nD=!_e.ios,uh=Ce.define({combine(n){return ar(n,{cursorBlinkRate:1200,drawRangeCursor:!0},{cursorBlinkRate:(e,t)=>Math.min(e,t),drawRangeCursor:(e,t)=>e||t})}});function uU(n={}){return[uh.of(n),cU,dU]}class sD{constructor(e,t,i,s,r){this.left=e,this.top=t,this.width=i,this.height=s,this.className=r}draw(){let e=document.createElement("div");return e.className=this.className,this.adjust(e),e}adjust(e){e.style.left=this.left+"px",e.style.top=this.top+"px",this.width>=0&&(e.style.width=this.width+"px"),e.style.height=this.height+"px"}eq(e){return this.left==e.left&&this.top==e.top&&this.width==e.width&&this.height==e.height&&this.className==e.className}}const cU=Xt.fromClass(class{constructor(n){this.view=n,this.rangePieces=[],this.cursors=[],this.measureReq={read:this.readPos.bind(this),write:this.drawSel.bind(this)},this.selectionLayer=n.scrollDOM.appendChild(document.createElement("div")),this.selectionLayer.className="cm-selectionLayer",this.selectionLayer.setAttribute("aria-hidden","true"),this.cursorLayer=n.scrollDOM.appendChild(document.createElement("div")),this.cursorLayer.className="cm-cursorLayer",this.cursorLayer.setAttribute("aria-hidden","true"),n.requestMeasure(this.measureReq),this.setBlinkRate()}setBlinkRate(){this.cursorLayer.style.animationDuration=this.view.state.facet(uh).cursorBlinkRate+"ms"}update(n){let e=n.startState.facet(uh)!=n.state.facet(uh);(e||n.selectionSet||n.geometryChanged||n.viewportChanged)&&this.view.requestMeasure(this.measureReq),n.transactions.some(t=>t.scrollIntoView)&&(this.cursorLayer.style.animationName=this.cursorLayer.style.animationName=="cm-blink"?"cm-blink2":"cm-blink"),e&&this.setBlinkRate()}readPos(){let{state:n}=this.view,e=n.facet(uh),t=n.selection.ranges.map(s=>s.empty?[]:fU(this.view,s)).reduce((s,r)=>s.concat(r)),i=[];for(let s of n.selection.ranges){let r=s==n.selection.main;if(s.empty?!r||nD:e.drawRangeCursor){let o=pU(this.view,s,r);o&&i.push(o)}}return{rangePieces:t,cursors:i}}drawSel({rangePieces:n,cursors:e}){if(n.length!=this.rangePieces.length||n.some((t,i)=>!t.eq(this.rangePieces[i]))){this.selectionLayer.textContent="";for(let t of n)this.selectionLayer.appendChild(t.draw());this.rangePieces=n}if(e.length!=this.cursors.length||e.some((t,i)=>!t.eq(this.cursors[i]))){let t=this.cursorLayer.children;if(t.length!==e.length){this.cursorLayer.textContent="";for(const i of e)this.cursorLayer.appendChild(i.draw())}else e.forEach((i,s)=>i.adjust(t[s]));this.cursors=e}}destroy(){this.selectionLayer.remove(),this.cursorLayer.remove()}}),rD={".cm-line":{"& ::selection":{backgroundColor:"transparent !important"},"&::selection":{backgroundColor:"transparent !important"}}};nD&&(rD[".cm-line"].caretColor="transparent !important");const dU=Eu.highest($e.theme(rD));function oD(n){let e=n.scrollDOM.getBoundingClientRect();return{left:(n.textDirection==At.LTR?e.left:e.right-n.scrollDOM.clientWidth)-n.scrollDOM.scrollLeft,top:e.top-n.scrollDOM.scrollTop}}function RT(n,e,t){let i=le.cursor(e);return{from:Math.max(t.from,n.moveToLineBoundary(i,!1,!0).from),to:Math.min(t.to,n.moveToLineBoundary(i,!0,!0).from),type:mt.Text}}function LT(n,e){let t=n.lineBlockAt(e);if(Array.isArray(t.type)){for(let i of t.type)if(i.to>e||i.to==e&&(i.to==t.to||i.type==mt.Text))return i}return t}function fU(n,e){if(e.to<=n.viewport.from||e.from>=n.viewport.to)return[];let t=Math.max(e.from,n.viewport.from),i=Math.min(e.to,n.viewport.to),s=n.textDirection==At.LTR,r=n.contentDOM,o=r.getBoundingClientRect(),a=oD(n),l=window.getComputedStyle(r.firstChild),h=o.left+parseInt(l.paddingLeft)+Math.min(0,parseInt(l.textIndent)),u=o.right-parseInt(l.paddingRight),c=LT(n,t),f=LT(n,i),p=c.type==mt.Text?c:null,b=f.type==mt.Text?f:null;if(n.lineWrapping&&(p&&(p=RT(n,t,p)),b&&(b=RT(n,i,b))),p&&b&&p.from==b.from)return _(T(e.from,e.to,p));{let v=p?T(e.from,null,p):w(c,!1),S=b?T(null,e.to,b):w(f,!0),k=[];return(p||c).to<(b||f).from-1?k.push(y(h,v.bottom,u,S.top)):v.bottom<S.top&&n.elementAtHeight((v.bottom+S.top)/2).type==mt.Text&&(v.bottom=S.top=(v.bottom+S.top)/2),_(v).concat(k).concat(_(S))}function y(v,S,k,A){return new sD(v-a.left,S-a.top-.01,k-v,A-S+.01,"cm-selectionBackground")}function _({top:v,bottom:S,horizontal:k}){let A=[];for(let M=0;M<k.length;M+=2)A.push(y(k[M],v,k[M+1],S));return A}function T(v,S,k){let A=1e9,M=-1e9,B=[];function P(z,X,Z,K,oe){let G=n.coordsAtPos(z,z==k.to?-2:2),ee=n.coordsAtPos(Z,Z==k.from?2:-2);A=Math.min(G.top,ee.top,A),M=Math.max(G.bottom,ee.bottom,M),oe==At.LTR?B.push(s&&X?h:G.left,s&&K?u:ee.right):B.push(!s&&K?h:ee.left,!s&&X?u:G.right)}let R=v??k.from,q=S??k.to;for(let z of n.visibleRanges)if(z.to>R&&z.from<q)for(let X=Math.max(z.from,R),Z=Math.min(z.to,q);;){let K=n.state.doc.lineAt(X);for(let oe of n.bidiSpans(K)){let G=oe.from+K.from,ee=oe.to+K.from;if(G>=Z)break;ee>X&&P(Math.max(G,X),v==null&&G<=R,Math.min(ee,Z),S==null&&ee>=q,oe.dir)}if(X=K.to+1,X>=Z)break}return B.length==0&&P(R,v==null,q,S==null,n.textDirection),{top:A,bottom:M,horizontal:B}}function w(v,S){let k=o.top+(S?v.top:v.bottom);return{top:k,bottom:k,horizontal:[]}}}function pU(n,e,t){let i=n.coordsAtPos(e.head,e.assoc||1);if(!i)return null;let s=oD(n);return new sD(i.left-s.left,i.top-s.top,-1,i.bottom-i.top,t?"cm-cursor cm-cursor-primary":"cm-cursor cm-cursor-secondary")}const aD=Ue.define({map(n,e){return n==null?null:e.mapPos(n)}}),ch=ci.define({create(){return null},update(n,e){return n!=null&&(n=e.changes.mapPos(n)),e.effects.reduce((t,i)=>i.is(aD)?i.value:t,n)}}),mU=Xt.fromClass(class{constructor(n){this.view=n,this.cursor=null,this.measureReq={read:this.readPos.bind(this),write:this.drawCursor.bind(this)}}update(n){var e;let t=n.state.field(ch);t==null?this.cursor!=null&&((e=this.cursor)===null||e===void 0||e.remove(),this.cursor=null):(this.cursor||(this.cursor=this.view.scrollDOM.appendChild(document.createElement("div")),this.cursor.className="cm-dropCursor"),(n.startState.field(ch)!=t||n.docChanged||n.geometryChanged)&&this.view.requestMeasure(this.measureReq))}readPos(){let n=this.view.state.field(ch),e=n!=null&&this.view.coordsAtPos(n);if(!e)return null;let t=this.view.scrollDOM.getBoundingClientRect();return{left:e.left-t.left+this.view.scrollDOM.scrollLeft,top:e.top-t.top+this.view.scrollDOM.scrollTop,height:e.bottom-e.top}}drawCursor(n){this.cursor&&(n?(this.cursor.style.left=n.left+"px",this.cursor.style.top=n.top+"px",this.cursor.style.height=n.height+"px"):this.cursor.style.left="-100000px")}destroy(){this.cursor&&this.cursor.remove()}setDropPos(n){this.view.state.field(ch)!=n&&this.view.dispatch({effects:aD.of(n)})}},{eventHandlers:{dragover(n){this.setDropPos(this.view.posAtCoords({x:n.clientX,y:n.clientY}))},dragleave(n){(n.target==this.view.contentDOM||!this.view.contentDOM.contains(n.relatedTarget))&&this.setDropPos(null)},dragend(){this.setDropPos(null)},drop(){this.setDropPos(null)}}});function gU(){return[ch,mU]}function $T(n,e,t,i,s){e.lastIndex=0;for(let r=n.iterRange(t,i),o=t,a;!r.next().done;o+=r.value.length)if(!r.lineBreak)for(;a=e.exec(r.value);)s(o+a.index,o+a.index+a[0].length,a)}function OU(n,e){let t=n.visibleRanges;if(t.length==1&&t[0].from==n.viewport.from&&t[0].to==n.viewport.to)return t;let i=[];for(let{from:s,to:r}of t)s=Math.max(n.state.doc.lineAt(s).from,s-e),r=Math.min(n.state.doc.lineAt(r).to,r+e),i.length&&i[i.length-1].to>=s?i[i.length-1].to=r:i.push({from:s,to:r});return i}class yU{constructor(e){let{regexp:t,decoration:i,boundary:s,maxLength:r=1e3}=e;if(!t.global)throw new RangeError("The regular expression given to MatchDecorator should have its 'g' flag set");this.regexp=t,this.getDeco=typeof i=="function"?i:()=>i,this.boundary=s,this.maxLength=r}createDeco(e){let t=new zr;for(let{from:i,to:s}of OU(e,this.maxLength))$T(e.state.doc,this.regexp,i,s,(r,o,a)=>t.add(r,o,this.getDeco(a,e,r)));return t.finish()}updateDeco(e,t){let i=1e9,s=-1;return e.docChanged&&e.changes.iterChanges((r,o,a,l)=>{l>e.view.viewport.from&&a<e.view.viewport.to&&(i=Math.min(a,i),s=Math.max(l,s))}),e.viewportChanged||s-i>1e3?this.createDeco(e.view):s>-1?this.updateRange(e.view,t.map(e.changes),i,s):t}updateRange(e,t,i,s){for(let r of e.visibleRanges){let o=Math.max(r.from,i),a=Math.min(r.to,s);if(a>o){let l=e.state.doc.lineAt(o),h=l.to<a?e.state.doc.lineAt(a):l,u=Math.max(r.from,l.from),c=Math.min(r.to,h.to);if(this.boundary){for(;o>l.from;o--)if(this.boundary.test(l.text[o-1-l.from])){u=o;break}for(;a<h.to;a++)if(this.boundary.test(h.text[a-h.from])){c=a;break}}let f=[],p;if(l==h)for(this.regexp.lastIndex=u-l.from;(p=this.regexp.exec(l.text))&&p.index<c-l.from;){let b=p.index+l.from;f.push(this.getDeco(p,e,b).range(b,b+p[0].length))}else $T(e.state.doc,this.regexp,u,c,(b,y,_)=>f.push(this.getDeco(_,e,b).range(b,y)));t=t.update({filterFrom:u,filterTo:c,filter:(b,y)=>b<u||y>c,add:f})}}return t}}const MO=/x/.unicode!=null?"gu":"g",bU=new RegExp(`[\0-\b
--­؜​‎‏\u2028\u2029‭‮\uFEFF￹-￼]`,MO),vU={0:"null",7:"bell",8:"backspace",10:"newline",11:"vertical tab",13:"carriage return",27:"escape",8203:"zero width space",8204:"zero width non-joiner",8205:"zero width joiner",8206:"left-to-right mark",8207:"right-to-left mark",8232:"line separator",8237:"left-to-right override",8238:"right-to-left override",8233:"paragraph separator",65279:"zero width no-break space",65532:"object replacement"};let Ym=null;function SU(){var n;if(Ym==null&&typeof document<"u"&&document.body){let e=document.body.style;Ym=((n=e.tabSize)!==null&&n!==void 0?n:e.MozTabSize)!=null}return Ym||!1}const dd=Ce.define({combine(n){let e=ar(n,{render:null,specialChars:bU,addSpecialChars:null});return(e.replaceTabs=!SU())&&(e.specialChars=new RegExp("	|"+e.specialChars.source,MO)),e.addSpecialChars&&(e.specialChars=new RegExp(e.specialChars.source+"|"+e.addSpecialChars.source,MO)),e}});function xU(n={}){return[dd.of(n),TU()]}let QT=null;function TU(){return QT||(QT=Xt.fromClass(class{constructor(n){this.view=n,this.decorations=Ie.none,this.decorationCache=Object.create(null),this.decorator=this.makeDecorator(n.state.facet(dd)),this.decorations=this.decorator.createDeco(n)}makeDecorator(n){return new yU({regexp:n.specialChars,decoration:(e,t,i)=>{let{doc:s}=t.state,r=gi(e[0],0);if(r==9){let o=s.lineAt(i),a=t.state.tabSize,l=Au(o.text,a,i-o.from);return Ie.replace({widget:new CU((a-l%a)*this.view.defaultCharacterWidth)})}return this.decorationCache[r]||(this.decorationCache[r]=Ie.replace({widget:new kU(n,r)}))},boundary:n.replaceTabs?void 0:/[^]/})}update(n){let e=n.state.facet(dd);n.startState.facet(dd)!=e?(this.decorator=this.makeDecorator(e),this.decorations=this.decorator.createDeco(n.view)):this.decorations=this.decorator.updateDeco(n,this.decorations)}},{decorations:n=>n.decorations}))}const wU="•";function _U(n){return n>=32?wU:n==10?"␤":String.fromCharCode(9216+n)}class kU extends Yr{constructor(e,t){super(),this.options=e,this.code=t}eq(e){return e.code==this.code}toDOM(e){let t=_U(this.code),i=e.state.phrase("Control character")+" "+(vU[this.code]||"0x"+this.code.toString(16)),s=this.options.render&&this.options.render(this.code,i,t);if(s)return s;let r=document.createElement("span");return r.textContent=t,r.title=i,r.setAttribute("aria-label",i),r.className="cm-specialChar",r}ignoreEvent(){return!1}}class CU extends Yr{constructor(e){super(),this.width=e}eq(e){return e.width==this.width}toDOM(){let e=document.createElement("span");return e.textContent="	",e.className="cm-tab",e.style.width=this.width+"px",e}ignoreEvent(){return!1}}function EU(){return PU}const AU=Ie.line({class:"cm-activeLine"}),PU=Xt.fromClass(class{constructor(n){this.decorations=this.getDeco(n)}update(n){(n.docChanged||n.selectionSet)&&(this.decorations=this.getDeco(n.view))}getDeco(n){let e=-1,t=[];for(let i of n.state.selection.ranges){if(!i.empty)return Ie.none;let s=n.lineBlockAt(i.head);s.from>e&&(t.push(AU.range(s.from)),e=s.from)}return Ie.set(t)}},{decorations:n=>n.decorations}),IO=2e3;function DU(n,e,t){let i=Math.min(e.line,t.line),s=Math.max(e.line,t.line),r=[];if(e.off>IO||t.off>IO||e.col<0||t.col<0){let o=Math.min(e.off,t.off),a=Math.max(e.off,t.off);for(let l=i;l<=s;l++){let h=n.doc.line(l);h.length<=a&&r.push(le.range(h.from+o,h.to+a))}}else{let o=Math.min(e.col,t.col),a=Math.max(e.col,t.col);for(let l=i;l<=s;l++){let h=n.doc.line(l),u=fO(h.text,o,n.tabSize,!0);if(u>-1){let c=fO(h.text,a,n.tabSize);r.push(le.range(h.from+u,h.from+c))}}}return r}function MU(n,e){let t=n.coordsAtPos(n.viewport.from);return t?Math.round(Math.abs((t.left-e)/n.defaultCharacterWidth)):-1}function BT(n,e){let t=n.posAtCoords({x:e.clientX,y:e.clientY},!1),i=n.state.doc.lineAt(t),s=t-i.from,r=s>IO?-1:s==i.length?MU(n,e.clientX):Au(i.text,n.state.tabSize,t-i.from);return{line:i.number,col:r,off:s}}function IU(n,e){let t=BT(n,e),i=n.state.selection;return t?{update(s){if(s.docChanged){let r=s.changes.mapPos(s.startState.doc.line(t.line).from),o=s.state.doc.lineAt(r);t={line:o.number,col:t.col,off:Math.min(t.off,o.length)},i=i.map(s.changes)}},get(s,r,o){let a=BT(n,s);if(!a)return i;let l=DU(n.state,t,a);return l.length?o?le.create(l.concat(i.ranges)):le.create(l):i}}:null}function RU(n){let e=(t=>t.altKey&&t.button==0);return $e.mouseSelectionStyle.of((t,i)=>e(i)?IU(t,i):null)}const LU={Alt:[18,n=>n.altKey],Control:[17,n=>n.ctrlKey],Shift:[16,n=>n.shiftKey],Meta:[91,n=>n.metaKey]},$U={style:"cursor: crosshair"};function QU(n={}){let[e,t]=LU[n.key||"Alt"],i=Xt.fromClass(class{constructor(s){this.view=s,this.isDown=!1}set(s){this.isDown!=s&&(this.isDown=s,this.view.update([]))}},{eventHandlers:{keydown(s){this.set(s.keyCode==e||t(s))},keyup(s){(s.keyCode==e||!t(s))&&this.set(!1)}}});return[i,$e.contentAttributes.of(s=>{var r;return!((r=s.plugin(i))===null||r===void 0)&&r.isDown?$U:null})]}const Gm="-10000px";class lD{constructor(e,t,i){this.facet=t,this.createTooltipView=i,this.input=e.state.facet(t),this.tooltips=this.input.filter(s=>s),this.tooltipViews=this.tooltips.map(i)}update(e){let t=e.state.facet(this.facet),i=t.filter(r=>r);if(t===this.input){for(let r of this.tooltipViews)r.update&&r.update(e);return!1}let s=[];for(let r=0;r<i.length;r++){let o=i[r],a=-1;if(o){for(let l=0;l<this.tooltips.length;l++){let h=this.tooltips[l];h&&h.create==o.create&&(a=l)}if(a<0)s[r]=this.createTooltipView(o);else{let l=s[r]=this.tooltipViews[a];l.update&&l.update(e)}}}for(let r of this.tooltipViews)s.indexOf(r)<0&&r.dom.remove();return this.input=t,this.tooltips=i,this.tooltipViews=s,!0}}function BU(){return{top:0,left:0,bottom:innerHeight,right:innerWidth}}const Km=Ce.define({combine:n=>{var e,t,i;return{position:_e.ios?"absolute":((e=n.find(s=>s.position))===null||e===void 0?void 0:e.position)||"fixed",parent:((t=n.find(s=>s.parent))===null||t===void 0?void 0:t.parent)||null,tooltipSpace:((i=n.find(s=>s.tooltipSpace))===null||i===void 0?void 0:i.tooltipSpace)||BU}}}),hD=Xt.fromClass(class{constructor(n){var e;this.view=n,this.inView=!0,this.lastTransaction=0,this.measureTimeout=-1;let t=n.state.facet(Km);this.position=t.position,this.parent=t.parent,this.classes=n.themeClasses,this.createContainer(),this.measureReq={read:this.readMeasure.bind(this),write:this.writeMeasure.bind(this),key:this},this.manager=new lD(n,Db,i=>this.createTooltip(i)),this.intersectionObserver=typeof IntersectionObserver=="function"?new IntersectionObserver(i=>{Date.now()>this.lastTransaction-50&&i.length>0&&i[i.length-1].intersectionRatio<1&&this.measureSoon()},{threshold:[1]}):null,this.observeIntersection(),(e=n.dom.ownerDocument.defaultView)===null||e===void 0||e.addEventListener("resize",this.measureSoon=this.measureSoon.bind(this)),this.maybeMeasure()}createContainer(){this.parent?(this.container=document.createElement("div"),this.container.style.position="relative",this.container.className=this.view.themeClasses,this.parent.appendChild(this.container)):this.container=this.view.dom}observeIntersection(){if(this.intersectionObserver){this.intersectionObserver.disconnect();for(let n of this.manager.tooltipViews)this.intersectionObserver.observe(n.dom)}}measureSoon(){this.measureTimeout<0&&(this.measureTimeout=setTimeout(()=>{this.measureTimeout=-1,this.maybeMeasure()},50))}update(n){n.transactions.length&&(this.lastTransaction=Date.now());let e=this.manager.update(n);e&&this.observeIntersection();let t=e||n.geometryChanged,i=n.state.facet(Km);if(i.position!=this.position){this.position=i.position;for(let s of this.manager.tooltipViews)s.dom.style.position=this.position;t=!0}if(i.parent!=this.parent){this.parent&&this.container.remove(),this.parent=i.parent,this.createContainer();for(let s of this.manager.tooltipViews)this.container.appendChild(s.dom);t=!0}else this.parent&&this.view.themeClasses!=this.classes&&(this.classes=this.container.className=this.view.themeClasses);t&&this.maybeMeasure()}createTooltip(n){let e=n.create(this.view);if(e.dom.classList.add("cm-tooltip"),n.arrow&&!e.dom.querySelector(".cm-tooltip > .cm-tooltip-arrow")){let t=document.createElement("div");t.className="cm-tooltip-arrow",e.dom.appendChild(t)}return e.dom.style.position=this.position,e.dom.style.top=Gm,this.container.appendChild(e.dom),e.mount&&e.mount(this.view),e}destroy(){var n,e;(n=this.view.dom.ownerDocument.defaultView)===null||n===void 0||n.removeEventListener("resize",this.measureSoon);for(let{dom:t}of this.manager.tooltipViews)t.remove();(e=this.intersectionObserver)===null||e===void 0||e.disconnect(),clearTimeout(this.measureTimeout)}readMeasure(){let n=this.view.dom.getBoundingClientRect();return{editor:n,parent:this.parent?this.container.getBoundingClientRect():n,pos:this.manager.tooltips.map((e,t)=>{let i=this.manager.tooltipViews[t];return i.getCoords?i.getCoords(e.pos):this.view.coordsAtPos(e.pos)}),size:this.manager.tooltipViews.map(({dom:e})=>e.getBoundingClientRect()),space:this.view.state.facet(Km).tooltipSpace(this.view)}}writeMeasure(n){let{editor:e,space:t}=n,i=[];for(let s=0;s<this.manager.tooltips.length;s++){let r=this.manager.tooltips[s],o=this.manager.tooltipViews[s],{dom:a}=o,l=n.pos[s],h=n.size[s];if(!l||l.bottom<=Math.max(e.top,t.top)||l.top>=Math.min(e.bottom,t.bottom)||l.right<Math.max(e.left,t.left)-.1||l.left>Math.min(e.right,t.right)+.1){a.style.top=Gm;continue}let u=r.arrow?o.dom.querySelector(".cm-tooltip-arrow"):null,c=u?7:0,f=h.right-h.left,p=h.bottom-h.top,b=o.offset||FU,y=this.view.textDirection==At.LTR,_=h.width>t.right-t.left?y?t.left:t.right-h.width:y?Math.min(l.left-(u?14:0)+b.x,t.right-f):Math.max(t.left,l.left-f+(u?14:0)-b.x),T=!!r.above;!r.strictSide&&(T?l.top-(h.bottom-h.top)-b.y<t.top:l.bottom+(h.bottom-h.top)+b.y>t.bottom)&&T==t.bottom-l.bottom>l.top-t.top&&(T=!T);let w=T?l.top-p-c-b.y:l.bottom+c+b.y,v=_+f;if(o.overlap!==!0)for(let S of i)S.left<v&&S.right>_&&S.top<w+p&&S.bottom>w&&(w=T?S.top-p-2-c:S.bottom+c+2);this.position=="absolute"?(a.style.top=w-n.parent.top+"px",a.style.left=_-n.parent.left+"px"):(a.style.top=w+"px",a.style.left=_+"px"),u&&(u.style.left=`${l.left+(y?b.x:-b.x)-(_+14-7)}px`),o.overlap!==!0&&i.push({left:_,top:w,right:v,bottom:w+p}),a.classList.toggle("cm-tooltip-above",T),a.classList.toggle("cm-tooltip-below",!T),o.positioned&&o.positioned()}}maybeMeasure(){if(this.manager.tooltips.length&&(this.view.inView&&this.view.requestMeasure(this.measureReq),this.inView!=this.view.inView&&(this.inView=this.view.inView,!this.inView)))for(let n of this.manager.tooltipViews)n.dom.style.top=Gm}},{eventHandlers:{scroll(){this.maybeMeasure()}}}),NU=$e.baseTheme({".cm-tooltip":{zIndex:100},"&light .cm-tooltip":{border:"1px solid #bbb",backgroundColor:"#f5f5f5"},"&light .cm-tooltip-section:not(:first-child)":{borderTop:"1px solid #bbb"},"&dark .cm-tooltip":{backgroundColor:"#333338",color:"white"},".cm-tooltip-arrow":{height:"7px",width:"14px",position:"absolute",zIndex:-1,overflow:"hidden","&:before, &:after":{content:"''",position:"absolute",width:0,height:0,borderLeft:"7px solid transparent",borderRight:"7px solid transparent"},".cm-tooltip-above &":{bottom:"-7px","&:before":{borderTop:"7px solid #bbb"},"&:after":{borderTop:"7px solid #f5f5f5",bottom:"1px"}},".cm-tooltip-below &":{top:"-7px","&:before":{borderBottom:"7px solid #bbb"},"&:after":{borderBottom:"7px solid #f5f5f5",top:"1px"}}},"&dark .cm-tooltip .cm-tooltip-arrow":{"&:before":{borderTopColor:"#333338",borderBottomColor:"#333338"},"&:after":{borderTopColor:"transparent",borderBottomColor:"transparent"}}}),FU={x:0,y:0},Db=Ce.define({enables:[hD,NU]}),hf=Ce.define();class Mb{constructor(e){this.view=e,this.mounted=!1,this.dom=document.createElement("div"),this.dom.classList.add("cm-tooltip-hover"),this.manager=new lD(e,hf,t=>this.createHostedView(t))}static create(e){return new Mb(e)}createHostedView(e){let t=e.create(this.view);return t.dom.classList.add("cm-tooltip-section"),this.dom.appendChild(t.dom),this.mounted&&t.mount&&t.mount(this.view),t}mount(e){for(let t of this.manager.tooltipViews)t.mount&&t.mount(e);this.mounted=!0}positioned(){for(let e of this.manager.tooltipViews)e.positioned&&e.positioned()}update(e){this.manager.update(e)}}const VU=Db.compute([hf],n=>{let e=n.facet(hf).filter(t=>t);return e.length===0?null:{pos:Math.min(...e.map(t=>t.pos)),end:Math.max(...e.filter(t=>t.end!=null).map(t=>t.end)),create:Mb.create,above:e[0].above,arrow:e.some(t=>t.arrow)}});class UU{constructor(e,t,i,s,r){this.view=e,this.source=t,this.field=i,this.setHover=s,this.hoverTime=r,this.hoverTimeout=-1,this.restartTimeout=-1,this.pending=null,this.lastMove={x:0,y:0,target:e.dom,time:0},this.checkHover=this.checkHover.bind(this),e.dom.addEventListener("mouseleave",this.mouseleave=this.mouseleave.bind(this)),e.dom.addEventListener("mousemove",this.mousemove=this.mousemove.bind(this))}update(){this.pending&&(this.pending=null,clearTimeout(this.restartTimeout),this.restartTimeout=setTimeout(()=>this.startHover(),20))}get active(){return this.view.state.field(this.field)}checkHover(){if(this.hoverTimeout=-1,this.active)return;let e=Date.now()-this.lastMove.time;e<this.hoverTime?this.hoverTimeout=setTimeout(this.checkHover,this.hoverTime-e):this.startHover()}startHover(){clearTimeout(this.restartTimeout);let{lastMove:e}=this,t=this.view.contentDOM.contains(e.target)?this.view.posAtCoords(e):null;if(t==null)return;let i=this.view.coordsAtPos(t);if(i==null||e.y<i.top||e.y>i.bottom||e.x<i.left-this.view.defaultCharacterWidth||e.x>i.right+this.view.defaultCharacterWidth)return;let s=this.view.bidiSpans(this.view.state.doc.lineAt(t)).find(a=>a.from<=t&&a.to>=t),r=s&&s.dir==At.RTL?-1:1,o=this.source(this.view,t,e.x<i.left?-r:r);if(o?.then){let a=this.pending={pos:t};o.then(l=>{this.pending==a&&(this.pending=null,l&&this.view.dispatch({effects:this.setHover.of(l)}))},l=>un(this.view.state,l,"hover tooltip"))}else o&&this.view.dispatch({effects:this.setHover.of(o)})}mousemove(e){var t;this.lastMove={x:e.clientX,y:e.clientY,target:e.target,time:Date.now()},this.hoverTimeout<0&&(this.hoverTimeout=setTimeout(this.checkHover,this.hoverTime));let i=this.active;if(i&&!qU(this.lastMove.target)||this.pending){let{pos:s}=i||this.pending,r=(t=i?.end)!==null&&t!==void 0?t:s;(s==r?this.view.posAtCoords(this.lastMove)!=s:!zU(this.view,s,r,e.clientX,e.clientY,6))&&(this.view.dispatch({effects:this.setHover.of(null)}),this.pending=null)}}mouseleave(){clearTimeout(this.hoverTimeout),this.hoverTimeout=-1,this.active&&this.view.dispatch({effects:this.setHover.of(null)})}destroy(){clearTimeout(this.hoverTimeout),this.view.dom.removeEventListener("mouseleave",this.mouseleave),this.view.dom.removeEventListener("mousemove",this.mousemove)}}function qU(n){for(let e=n;e;e=e.parentNode)if(e.nodeType==1&&e.classList.contains("cm-tooltip"))return!0;return!1}function zU(n,e,t,i,s,r){let o=document.createRange(),a=n.domAtPos(e),l=n.domAtPos(t);o.setEnd(l.node,l.offset),o.setStart(a.node,a.offset);let h=o.getClientRects();o.detach();for(let u=0;u<h.length;u++){let c=h[u];if(Math.max(c.top-s,s-c.bottom,c.left-i,i-c.right)<=r)return!0}return!1}function jU(n,e={}){let t=Ue.define(),i=ci.define({create(){return null},update(s,r){if(s&&(e.hideOnChange&&(r.docChanged||r.selection)||e.hideOn&&e.hideOn(r,s)))return null;if(s&&r.docChanged){let o=r.changes.mapPos(s.pos,-1,Li.TrackDel);if(o==null)return null;let a=Object.assign(Object.create(null),s);a.pos=o,s.end!=null&&(a.end=r.changes.mapPos(s.end)),s=a}for(let o of r.effects)o.is(t)&&(s=o.value),o.is(HU)&&(s=null);return s},provide:s=>hf.from(s)});return[i,Xt.define(s=>new UU(s,n,i,t,e.hoverTime||300)),VU]}function XU(n,e){let t=n.plugin(hD);if(!t)return null;let i=t.manager.tooltips.indexOf(e);return i<0?null:t.manager.tooltipViews[i]}const HU=Ue.define(),NT=Ce.define({combine(n){let e,t;for(let i of n)e=e||i.topContainer,t=t||i.bottomContainer;return{topContainer:e,bottomContainer:t}}});function iu(n,e){let t=n.plugin(uD),i=t?t.specs.indexOf(e):-1;return i>-1?t.panels[i]:null}const uD=Xt.fromClass(class{constructor(n){this.input=n.state.facet(nu),this.specs=this.input.filter(t=>t),this.panels=this.specs.map(t=>t(n));let e=n.state.facet(NT);this.top=new $c(n,!0,e.topContainer),this.bottom=new $c(n,!1,e.bottomContainer),this.top.sync(this.panels.filter(t=>t.top)),this.bottom.sync(this.panels.filter(t=>!t.top));for(let t of this.panels)t.dom.classList.add("cm-panel"),t.mount&&t.mount()}update(n){let e=n.state.facet(NT);this.top.container!=e.topContainer&&(this.top.sync([]),this.top=new $c(n.view,!0,e.topContainer)),this.bottom.container!=e.bottomContainer&&(this.bottom.sync([]),this.bottom=new $c(n.view,!1,e.bottomContainer)),this.top.syncClasses(),this.bottom.syncClasses();let t=n.state.facet(nu);if(t!=this.input){let i=t.filter(l=>l),s=[],r=[],o=[],a=[];for(let l of i){let h=this.specs.indexOf(l),u;h<0?(u=l(n.view),a.push(u)):(u=this.panels[h],u.update&&u.update(n)),s.push(u),(u.top?r:o).push(u)}this.specs=i,this.panels=s,this.top.sync(r),this.bottom.sync(o);for(let l of a)l.dom.classList.add("cm-panel"),l.mount&&l.mount()}else for(let i of this.panels)i.update&&i.update(n)}destroy(){this.top.sync([]),this.bottom.sync([])}},{provide:n=>$e.scrollMargins.of(e=>{let t=e.plugin(n);return t&&{top:t.top.scrollMargin(),bottom:t.bottom.scrollMargin()}})});class $c{constructor(e,t,i){this.view=e,this.top=t,this.container=i,this.dom=void 0,this.classes="",this.panels=[],this.syncClasses()}sync(e){for(let t of this.panels)t.destroy&&e.indexOf(t)<0&&t.destroy();this.panels=e,this.syncDOM()}syncDOM(){if(this.panels.length==0){this.dom&&(this.dom.remove(),this.dom=void 0);return}if(!this.dom){this.dom=document.createElement("div"),this.dom.className=this.top?"cm-panels cm-panels-top":"cm-panels cm-panels-bottom",this.dom.style[this.top?"top":"bottom"]="0";let t=this.container||this.view.dom;t.insertBefore(this.dom,this.top?t.firstChild:null)}let e=this.dom.firstChild;for(let t of this.panels)if(t.dom.parentNode==this.dom){for(;e!=t.dom;)e=FT(e);e=e.nextSibling}else this.dom.insertBefore(t.dom,e);for(;e;)e=FT(e)}scrollMargin(){return!this.dom||this.container?0:Math.max(0,this.top?this.dom.getBoundingClientRect().bottom-Math.max(0,this.view.scrollDOM.getBoundingClientRect().top):Math.min(innerHeight,this.view.scrollDOM.getBoundingClientRect().bottom)-this.dom.getBoundingClientRect().top)}syncClasses(){if(!(!this.container||this.classes==this.view.themeClasses)){for(let e of this.classes.split(" "))e&&this.container.classList.remove(e);for(let e of(this.classes=this.view.themeClasses).split(" "))e&&this.container.classList.add(e)}}}function FT(n){let e=n.nextSibling;return n.remove(),e}const nu=Ce.define({enables:uD});class or extends $o{compare(e){return this==e||this.constructor==e.constructor&&this.eq(e)}eq(e){return!1}destroy(e){}}or.prototype.elementClass="";or.prototype.toDOM=void 0;or.prototype.mapMode=Li.TrackBefore;or.prototype.startSide=or.prototype.endSide=-1;or.prototype.point=!0;const fd=Ce.define(),WU={class:"",renderEmptyElements:!1,elementStyle:"",markers:()=>st.empty,lineMarker:()=>null,lineMarkerChange:null,initialSpacer:null,updateSpacer:null,domEventHandlers:{}},Mh=Ce.define();function ZU(n){return[cD(),Mh.of(Object.assign(Object.assign({},WU),n))]}const VT=Ce.define({combine:n=>n.some(e=>e)});function cD(n){return[YU]}const YU=Xt.fromClass(class{constructor(n){this.view=n,this.prevViewport=n.viewport,this.dom=document.createElement("div"),this.dom.className="cm-gutters",this.dom.setAttribute("aria-hidden","true"),this.dom.style.minHeight=this.view.contentHeight+"px",this.gutters=n.state.facet(Mh).map(e=>new qT(n,e));for(let e of this.gutters)this.dom.appendChild(e.dom);this.fixed=!n.state.facet(VT),this.fixed&&(this.dom.style.position="sticky"),this.syncGutters(!1),n.scrollDOM.insertBefore(this.dom,n.contentDOM)}update(n){if(this.updateGutters(n)){let e=this.prevViewport,t=n.view.viewport,i=Math.min(e.to,t.to)-Math.max(e.from,t.from);this.syncGutters(i<(t.to-t.from)*.8)}n.geometryChanged&&(this.dom.style.minHeight=this.view.contentHeight+"px"),this.view.state.facet(VT)!=!this.fixed&&(this.fixed=!this.fixed,this.dom.style.position=this.fixed?"sticky":""),this.prevViewport=n.view.viewport}syncGutters(n){let e=this.dom.nextSibling;n&&this.dom.remove();let t=st.iter(this.view.state.facet(fd),this.view.viewport.from),i=[],s=this.gutters.map(r=>new GU(r,this.view.viewport,-this.view.documentPadding.top));for(let r of this.view.viewportLineBlocks){let o;if(Array.isArray(r.type)){for(let a of r.type)if(a.type==mt.Text){o=a;break}}else o=r.type==mt.Text?r:void 0;if(o){i.length&&(i=[]),dD(t,i,r.from);for(let a of s)a.line(this.view,o,i)}}for(let r of s)r.finish();n&&this.view.scrollDOM.insertBefore(this.dom,e)}updateGutters(n){let e=n.startState.facet(Mh),t=n.state.facet(Mh),i=n.docChanged||n.heightChanged||n.viewportChanged||!st.eq(n.startState.facet(fd),n.state.facet(fd),n.view.viewport.from,n.view.viewport.to);if(e==t)for(let s of this.gutters)s.update(n)&&(i=!0);else{i=!0;let s=[];for(let r of t){let o=e.indexOf(r);o<0?s.push(new qT(this.view,r)):(this.gutters[o].update(n),s.push(this.gutters[o]))}for(let r of this.gutters)r.dom.remove(),s.indexOf(r)<0&&r.destroy();for(let r of s)this.dom.appendChild(r.dom);this.gutters=s}return i}destroy(){for(let n of this.gutters)n.destroy();this.dom.remove()}},{provide:n=>$e.scrollMargins.of(e=>{let t=e.plugin(n);return!t||t.gutters.length==0||!t.fixed?null:e.textDirection==At.LTR?{left:t.dom.offsetWidth}:{right:t.dom.offsetWidth}})});function UT(n){return Array.isArray(n)?n:[n]}function dD(n,e,t){for(;n.value&&n.from<=t;)n.from==t&&e.push(n.value),n.next()}class GU{constructor(e,t,i){this.gutter=e,this.height=i,this.localMarkers=[],this.i=0,this.cursor=st.iter(e.markers,t.from)}line(e,t,i){this.localMarkers.length&&(this.localMarkers=[]),dD(this.cursor,this.localMarkers,t.from);let s=i.length?this.localMarkers.concat(i):this.localMarkers,r=this.gutter.config.lineMarker(e,t,s);r&&s.unshift(r);let o=this.gutter;if(s.length==0&&!o.config.renderEmptyElements)return;let a=t.top-this.height;if(this.i==o.elements.length){let l=new fD(e,t.height,a,s);o.elements.push(l),o.dom.appendChild(l.dom)}else o.elements[this.i].update(e,t.height,a,s);this.height=t.bottom,this.i++}finish(){let e=this.gutter;for(;e.elements.length>this.i;){let t=e.elements.pop();e.dom.removeChild(t.dom),t.destroy()}}}class qT{constructor(e,t){this.view=e,this.config=t,this.elements=[],this.spacer=null,this.dom=document.createElement("div"),this.dom.className="cm-gutter"+(this.config.class?" "+this.config.class:"");for(let i in t.domEventHandlers)this.dom.addEventListener(i,s=>{let r=e.lineBlockAtHeight(s.clientY-e.documentTop);t.domEventHandlers[i](e,r,s)&&s.preventDefault()});this.markers=UT(t.markers(e)),t.initialSpacer&&(this.spacer=new fD(e,0,0,[t.initialSpacer(e)]),this.dom.appendChild(this.spacer.dom),this.spacer.dom.style.cssText+="visibility: hidden; pointer-events: none")}update(e){let t=this.markers;if(this.markers=UT(this.config.markers(e.view)),this.spacer&&this.config.updateSpacer){let s=this.config.updateSpacer(this.spacer.markers[0],e);s!=this.spacer.markers[0]&&this.spacer.update(e.view,0,0,[s])}let i=e.view.viewport;return!st.eq(this.markers,t,i.from,i.to)||(this.config.lineMarkerChange?this.config.lineMarkerChange(e):!1)}destroy(){for(let e of this.elements)e.destroy()}}class fD{constructor(e,t,i,s){this.height=-1,this.above=0,this.markers=[],this.dom=document.createElement("div"),this.dom.className="cm-gutterElement",this.update(e,t,i,s)}update(e,t,i,s){this.height!=t&&(this.dom.style.height=(this.height=t)+"px"),this.above!=i&&(this.dom.style.marginTop=(this.above=i)?i+"px":""),KU(this.markers,s)||this.setMarkers(e,s)}setMarkers(e,t){let i="cm-gutterElement",s=this.dom.firstChild;for(let r=0,o=0;;){let a=o,l=r<t.length?t[r++]:null,h=!1;if(l){let u=l.elementClass;u&&(i+=" "+u);for(let c=o;c<this.markers.length;c++)if(this.markers[c].compare(l)){a=c,h=!0;break}}else a=this.markers.length;for(;o<a;){let u=this.markers[o++];if(u.toDOM){u.destroy(s);let c=s.nextSibling;s.remove(),s=c}}if(!l)break;l.toDOM&&(h?s=s.nextSibling:this.dom.insertBefore(l.toDOM(e),s)),h&&o++}this.dom.className=i,this.markers=t}destroy(){this.setMarkers(null,[])}}function KU(n,e){if(n.length!=e.length)return!1;for(let t=0;t<n.length;t++)if(!n[t].compare(e[t]))return!1;return!0}const JU=Ce.define(),ca=Ce.define({combine(n){return ar(n,{formatNumber:String,domEventHandlers:{}},{domEventHandlers(e,t){let i=Object.assign({},e);for(let s in t){let r=i[s],o=t[s];i[s]=r?(a,l,h)=>r(a,l,h)||o(a,l,h):o}return i}})}});class Jm extends or{constructor(e){super(),this.number=e}eq(e){return this.number==e.number}toDOM(){return document.createTextNode(this.number)}}function eg(n,e){return n.state.facet(ca).formatNumber(e,n.state)}const eq=Mh.compute([ca],n=>({class:"cm-lineNumbers",renderEmptyElements:!1,markers(e){return e.state.facet(JU)},lineMarker(e,t,i){return i.some(s=>s.toDOM)?null:new Jm(eg(e,e.state.doc.lineAt(t.from).number))},lineMarkerChange:e=>e.startState.facet(ca)!=e.state.facet(ca),initialSpacer(e){return new Jm(eg(e,zT(e.state.doc.lines)))},updateSpacer(e,t){let i=eg(t.view,zT(t.view.state.doc.lines));return i==e.number?e:new Jm(i)},domEventHandlers:n.facet(ca).domEventHandlers}));function tq(n={}){return[ca.of(n),cD(),eq]}function zT(n){let e=9;for(;e<n;)e=e*10+9;return e}const iq=new class extends or{constructor(){super(...arguments),this.elementClass="cm-activeLineGutter"}},nq=fd.compute(["selection"],n=>{let e=[],t=-1;for(let i of n.selection.ranges)if(i.empty){let s=n.doc.lineAt(i.head).from;s>t&&(t=s,e.push(iq.range(s)))}return st.of(e)});function sq(){return nq}const rq=1024;let oq=0,tg=class{constructor(e,t){this.from=e,this.to=t}},Ze=class{constructor(e={}){this.id=oq++,this.perNode=!!e.perNode,this.deserialize=e.deserialize||(()=>{throw new Error("This node type doesn't define a deserialize function")})}add(e){if(this.perNode)throw new RangeError("Can't add per-node props to node types");return typeof e!="function"&&(e=Rs.match(e)),t=>{let i=e(t);return i===void 0?null:[this,i]}}};Ze.closedBy=new Ze({deserialize:n=>n.split(" ")});Ze.openedBy=new Ze({deserialize:n=>n.split(" ")});Ze.group=new Ze({deserialize:n=>n.split(" ")});Ze.contextHash=new Ze({perNode:!0});Ze.lookAhead=new Ze({perNode:!0});Ze.mounted=new Ze({perNode:!0});const aq=Object.create(null);let Rs=class pD{constructor(e,t,i,s=0){this.name=e,this.props=t,this.id=i,this.flags=s}static define(e){let t=e.props&&e.props.length?Object.create(null):aq,i=(e.top?1:0)|(e.skipped?2:0)|(e.error?4:0)|(e.name==null?8:0),s=new pD(e.name||"",t,e.id,i);if(e.props){for(let r of e.props)if(Array.isArray(r)||(r=r(s)),r){if(r[0].perNode)throw new RangeError("Can't store a per-node prop on a node type");t[r[0].id]=r[1]}}return s}prop(e){return this.props[e.id]}get isTop(){return(this.flags&1)>0}get isSkipped(){return(this.flags&2)>0}get isError(){return(this.flags&4)>0}get isAnonymous(){return(this.flags&8)>0}is(e){if(typeof e=="string"){if(this.name==e)return!0;let t=this.prop(Ze.group);return t?t.indexOf(e)>-1:!1}return this.id==e}static match(e){let t=Object.create(null);for(let i in e)for(let s of i.split(" "))t[s]=e[i];return i=>{for(let s=i.prop(Ze.group),r=-1;r<(s?s.length:0);r++){let o=t[r<0?i.name:s[r]];if(o)return o}}}};Rs.none=new Rs("",Object.create(null),0,8);const Qc=new WeakMap,jT=new WeakMap;var Oi;(function(n){n[n.ExcludeBuffers=1]="ExcludeBuffers",n[n.IncludeAnonymous=2]="IncludeAnonymous",n[n.IgnoreMounts=4]="IgnoreMounts",n[n.IgnoreOverlays=8]="IgnoreOverlays"})(Oi||(Oi={}));let ln=class RO{constructor(e,t,i,s,r){if(this.type=e,this.children=t,this.positions=i,this.length=s,this.props=null,r&&r.length){this.props=Object.create(null);for(let[o,a]of r)this.props[typeof o=="number"?o:o.id]=a}}toString(){let e=this.prop(Ze.mounted);if(e&&!e.overlay)return e.tree.toString();let t="";for(let i of this.children){let s=i.toString();s&&(t&&(t+=","),t+=s)}return this.type.name?(/\W/.test(this.type.name)&&!this.type.isError?JSON.stringify(this.type.name):this.type.name)+(t.length?"("+t+")":""):t}cursor(e=0){return new df(this.topNode,e)}cursorAt(e,t=0,i=0){let s=Qc.get(this)||this.topNode,r=new df(s);return r.moveTo(e,t),Qc.set(this,r._tree),r}get topNode(){return new su(this,0,0,null)}resolve(e,t=0){let i=Ga(Qc.get(this)||this.topNode,e,t,!1);return Qc.set(this,i),i}resolveInner(e,t=0){let i=Ga(jT.get(this)||this.topNode,e,t,!0);return jT.set(this,i),i}iterate(e){let{enter:t,leave:i,from:s=0,to:r=this.length}=e;for(let o=this.cursor((e.mode||0)|Oi.IncludeAnonymous);;){let a=!1;if(o.from<=r&&o.to>=s&&(o.type.isAnonymous||t(o)!==!1)){if(o.firstChild())continue;a=!0}for(;a&&i&&!o.type.isAnonymous&&i(o),!o.nextSibling();){if(!o.parent())return;a=!0}}}prop(e){return e.perNode?this.props?this.props[e.id]:void 0:this.type.prop(e)}get propValues(){let e=[];if(this.props)for(let t in this.props)e.push([+t,this.props[t]]);return e}balance(e={}){return this.children.length<=8?this:Rb(Rs.none,this.children,this.positions,0,this.children.length,0,this.length,(t,i,s)=>new RO(this.type,t,i,s,this.propValues),e.makeTree||((t,i,s)=>new RO(Rs.none,t,i,s)))}static build(e){return uq(e)}};ln.empty=new ln(Rs.none,[],[],0);let lq=class mD{constructor(e,t){this.buffer=e,this.index=t}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}get pos(){return this.index}next(){this.index-=4}fork(){return new mD(this.buffer,this.index)}},Mu=class gD{constructor(e,t,i){this.buffer=e,this.length=t,this.set=i}get type(){return Rs.none}toString(){let e=[];for(let t=0;t<this.buffer.length;)e.push(this.childString(t)),t=this.buffer[t+3];return e.join(",")}childString(e){let t=this.buffer[e],i=this.buffer[e+3],s=this.set.types[t],r=s.name;if(/\W/.test(r)&&!s.isError&&(r=JSON.stringify(r)),e+=4,i==e)return r;let o=[];for(;e<i;)o.push(this.childString(e)),e=this.buffer[e+3];return r+"("+o.join(",")+")"}findChild(e,t,i,s,r){let{buffer:o}=this,a=-1;for(let l=e;l!=t&&!(OD(r,s,o[l+1],o[l+2])&&(a=l,i>0));l=o[l+3]);return a}slice(e,t,i,s){let r=this.buffer,o=new Uint16Array(t-e);for(let a=e,l=0;a<t;)o[l++]=r[a++],o[l++]=r[a++]-i,o[l++]=r[a++]-i,o[l++]=r[a++]-e;return new gD(o,s-i,this.set)}};function OD(n,e,t,i){switch(n){case-2:return t<e;case-1:return i>=e&&t<e;case 0:return t<e&&i>e;case 1:return t<=e&&i>e;case 2:return i>e;case 4:return!0}}function yD(n,e){let t=n.childBefore(e);for(;t;){let i=t.lastChild;if(!i||i.to!=t.to)break;i.type.isError&&i.from==i.to?(n=t,t=i.prevSibling):t=i}return n}function Ga(n,e,t,i){for(var s;n.from==n.to||(t<1?n.from>=e:n.from>e)||(t>-1?n.to<=e:n.to<e);){let o=!i&&n instanceof su&&n.index<0?null:n.parent;if(!o)return n;n=o}let r=i?0:Oi.IgnoreOverlays;if(i)for(let o=n,a=o.parent;a;o=a,a=o.parent)o instanceof su&&o.index<0&&((s=a.enter(e,t,r))===null||s===void 0?void 0:s.from)!=o.from&&(n=a);for(;;){let o=n.enter(e,t,r);if(!o)return n;n=o}}let su=class pd{constructor(e,t,i,s){this._tree=e,this.from=t,this.index=i,this._parent=s}get type(){return this._tree.type}get name(){return this._tree.type.name}get to(){return this.from+this._tree.length}nextChild(e,t,i,s,r=0){for(let o=this;;){for(let{children:a,positions:l}=o._tree,h=t>0?a.length:-1;e!=h;e+=t){let u=a[e],c=l[e]+o.from;if(OD(s,i,c,c+u.length)){if(u instanceof Mu){if(r&Oi.ExcludeBuffers)continue;let f=u.findChild(0,u.buffer.length,t,i-c,s);if(f>-1)return new LO(new hq(o,u,e,c),null,f)}else if(r&Oi.IncludeAnonymous||!u.type.isAnonymous||Ib(u)){let f;if(!(r&Oi.IgnoreMounts)&&u.props&&(f=u.prop(Ze.mounted))&&!f.overlay)return new pd(f.tree,c,e,o);let p=new pd(u,c,e,o);return r&Oi.IncludeAnonymous||!p.type.isAnonymous?p:p.nextChild(t<0?u.children.length-1:0,t,i,s)}}}if(r&Oi.IncludeAnonymous||!o.type.isAnonymous||(o.index>=0?e=o.index+t:e=t<0?-1:o._parent._tree.children.length,o=o._parent,!o))return null}}get firstChild(){return this.nextChild(0,1,0,4)}get lastChild(){return this.nextChild(this._tree.children.length-1,-1,0,4)}childAfter(e){return this.nextChild(0,1,e,2)}childBefore(e){return this.nextChild(this._tree.children.length-1,-1,e,-2)}enter(e,t,i=0){let s;if(!(i&Oi.IgnoreOverlays)&&(s=this._tree.prop(Ze.mounted))&&s.overlay){let r=e-this.from;for(let{from:o,to:a}of s.overlay)if((t>0?o<=r:o<r)&&(t<0?a>=r:a>r))return new pd(s.tree,s.overlay[0].from+this.from,-1,this)}return this.nextChild(0,1,e,t,i)}nextSignificantParent(){let e=this;for(;e.type.isAnonymous&&e._parent;)e=e._parent;return e}get parent(){return this._parent?this._parent.nextSignificantParent():null}get nextSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index+1,1,0,4):null}get prevSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index-1,-1,0,4):null}cursor(e=0){return new df(this,e)}get tree(){return this._tree}toTree(){return this._tree}resolve(e,t=0){return Ga(this,e,t,!1)}resolveInner(e,t=0){return Ga(this,e,t,!0)}enterUnfinishedNodesBefore(e){return yD(this,e)}getChild(e,t=null,i=null){let s=uf(this,e,t,i);return s.length?s[0]:null}getChildren(e,t=null,i=null){return uf(this,e,t,i)}toString(){return this._tree.toString()}get node(){return this}matchContext(e){return cf(this,e)}};function uf(n,e,t,i){let s=n.cursor(),r=[];if(!s.firstChild())return r;if(t!=null){for(;!s.type.is(t);)if(!s.nextSibling())return r}for(;;){if(i!=null&&s.type.is(i))return r;if(s.type.is(e)&&r.push(s.node),!s.nextSibling())return i==null?r:[]}}function cf(n,e,t=e.length-1){for(let i=n.parent;t>=0;i=i.parent){if(!i)return!1;if(!i.type.isAnonymous){if(e[t]&&e[t]!=i.name)return!1;t--}}return!0}let hq=class{constructor(e,t,i,s){this.parent=e,this.buffer=t,this.index=i,this.start=s}},LO=class dh{constructor(e,t,i){this.context=e,this._parent=t,this.index=i,this.type=e.buffer.set.types[e.buffer.buffer[i]]}get name(){return this.type.name}get from(){return this.context.start+this.context.buffer.buffer[this.index+1]}get to(){return this.context.start+this.context.buffer.buffer[this.index+2]}child(e,t,i){let{buffer:s}=this.context,r=s.findChild(this.index+4,s.buffer[this.index+3],e,t-this.context.start,i);return r<0?null:new dh(this.context,this,r)}get firstChild(){return this.child(1,0,4)}get lastChild(){return this.child(-1,0,4)}childAfter(e){return this.child(1,e,2)}childBefore(e){return this.child(-1,e,-2)}enter(e,t,i=0){if(i&Oi.ExcludeBuffers)return null;let{buffer:s}=this.context,r=s.findChild(this.index+4,s.buffer[this.index+3],t>0?1:-1,e-this.context.start,t);return r<0?null:new dh(this.context,this,r)}get parent(){return this._parent||this.context.parent.nextSignificantParent()}externalSibling(e){return this._parent?null:this.context.parent.nextChild(this.context.index+e,e,0,4)}get nextSibling(){let{buffer:e}=this.context,t=e.buffer[this.index+3];return t<(this._parent?e.buffer[this._parent.index+3]:e.buffer.length)?new dh(this.context,this._parent,t):this.externalSibling(1)}get prevSibling(){let{buffer:e}=this.context,t=this._parent?this._parent.index+4:0;return this.index==t?this.externalSibling(-1):new dh(this.context,this._parent,e.findChild(t,this.index,-1,0,4))}cursor(e=0){return new df(this,e)}get tree(){return null}toTree(){let e=[],t=[],{buffer:i}=this.context,s=this.index+4,r=i.buffer[this.index+3];if(r>s){let o=i.buffer[this.index+1],a=i.buffer[this.index+2];e.push(i.slice(s,r,o,a)),t.push(0)}return new ln(this.type,e,t,this.to-this.from)}resolve(e,t=0){return Ga(this,e,t,!1)}resolveInner(e,t=0){return Ga(this,e,t,!0)}enterUnfinishedNodesBefore(e){return yD(this,e)}toString(){return this.context.buffer.childString(this.index)}getChild(e,t=null,i=null){let s=uf(this,e,t,i);return s.length?s[0]:null}getChildren(e,t=null,i=null){return uf(this,e,t,i)}get node(){return this}matchContext(e){return cf(this,e)}},df=class{constructor(e,t=0){if(this.mode=t,this.buffer=null,this.stack=[],this.index=0,this.bufferNode=null,e instanceof su)this.yieldNode(e);else{this._tree=e.context.parent,this.buffer=e.context;for(let i=e._parent;i;i=i._parent)this.stack.unshift(i.index);this.bufferNode=e,this.yieldBuf(e.index)}}get name(){return this.type.name}yieldNode(e){return e?(this._tree=e,this.type=e.type,this.from=e.from,this.to=e.to,!0):!1}yieldBuf(e,t){this.index=e;let{start:i,buffer:s}=this.buffer;return this.type=t||s.set.types[s.buffer[e]],this.from=i+s.buffer[e+1],this.to=i+s.buffer[e+2],!0}yield(e){return e?e instanceof su?(this.buffer=null,this.yieldNode(e)):(this.buffer=e.context,this.yieldBuf(e.index,e.type)):!1}toString(){return this.buffer?this.buffer.buffer.childString(this.index):this._tree.toString()}enterChild(e,t,i){if(!this.buffer)return this.yield(this._tree.nextChild(e<0?this._tree._tree.children.length-1:0,e,t,i,this.mode));let{buffer:s}=this.buffer,r=s.findChild(this.index+4,s.buffer[this.index+3],e,t-this.buffer.start,i);return r<0?!1:(this.stack.push(this.index),this.yieldBuf(r))}firstChild(){return this.enterChild(1,0,4)}lastChild(){return this.enterChild(-1,0,4)}childAfter(e){return this.enterChild(1,e,2)}childBefore(e){return this.enterChild(-1,e,-2)}enter(e,t,i=this.mode){return this.buffer?i&Oi.ExcludeBuffers?!1:this.enterChild(1,e,t):this.yield(this._tree.enter(e,t,i))}parent(){if(!this.buffer)return this.yieldNode(this.mode&Oi.IncludeAnonymous?this._tree._parent:this._tree.parent);if(this.stack.length)return this.yieldBuf(this.stack.pop());let e=this.mode&Oi.IncludeAnonymous?this.buffer.parent:this.buffer.parent.nextSignificantParent();return this.buffer=null,this.yieldNode(e)}sibling(e){if(!this.buffer)return this._tree._parent?this.yield(this._tree.index<0?null:this._tree._parent.nextChild(this._tree.index+e,e,0,4,this.mode)):!1;let{buffer:t}=this.buffer,i=this.stack.length-1;if(e<0){let s=i<0?0:this.stack[i]+4;if(this.index!=s)return this.yieldBuf(t.findChild(s,this.index,-1,0,4))}else{let s=t.buffer[this.index+3];if(s<(i<0?t.buffer.length:t.buffer[this.stack[i]+3]))return this.yieldBuf(s)}return i<0?this.yield(this.buffer.parent.nextChild(this.buffer.index+e,e,0,4,this.mode)):!1}nextSibling(){return this.sibling(1)}prevSibling(){return this.sibling(-1)}atLastNode(e){let t,i,{buffer:s}=this;if(s){if(e>0){if(this.index<s.buffer.buffer.length)return!1}else for(let r=0;r<this.index;r++)if(s.buffer.buffer[r+3]<this.index)return!1;({index:t,parent:i}=s)}else({index:t,_parent:i}=this._tree);for(;i;{index:t,_parent:i}=i)if(t>-1)for(let r=t+e,o=e<0?-1:i._tree.children.length;r!=o;r+=e){let a=i._tree.children[r];if(this.mode&Oi.IncludeAnonymous||a instanceof Mu||!a.type.isAnonymous||Ib(a))return!1}return!0}move(e,t){if(t&&this.enterChild(e,0,4))return!0;for(;;){if(this.sibling(e))return!0;if(this.atLastNode(e)||!this.parent())return!1}}next(e=!0){return this.move(1,e)}prev(e=!0){return this.move(-1,e)}moveTo(e,t=0){for(;(this.from==this.to||(t<1?this.from>=e:this.from>e)||(t>-1?this.to<=e:this.to<e))&&this.parent(););for(;this.enterChild(1,e,t););return this}get node(){if(!this.buffer)return this._tree;let e=this.bufferNode,t=null,i=0;if(e&&e.context==this.buffer)e:for(let s=this.index,r=this.stack.length;r>=0;){for(let o=e;o;o=o._parent)if(o.index==s){if(s==this.index)return o;t=o,i=r+1;break e}s=this.stack[--r]}for(let s=i;s<this.stack.length;s++)t=new LO(this.buffer,t,this.stack[s]);return this.bufferNode=new LO(this.buffer,t,this.index)}get tree(){return this.buffer?null:this._tree._tree}iterate(e,t){for(let i=0;;){let s=!1;if(this.type.isAnonymous||e(this)!==!1){if(this.firstChild()){i++;continue}this.type.isAnonymous||(s=!0)}for(;s&&t&&t(this),s=this.type.isAnonymous,!this.nextSibling();){if(!i)return;this.parent(),i--,s=!0}}}matchContext(e){if(!this.buffer)return cf(this.node,e);let{buffer:t}=this.buffer,{types:i}=t.set;for(let s=e.length-1,r=this.stack.length-1;s>=0;r--){if(r<0)return cf(this.node,e,s);let o=i[t.buffer[this.stack[r]]];if(!o.isAnonymous){if(e[s]&&e[s]!=o.name)return!1;s--}}return!0}};function Ib(n){return n.children.some(e=>e instanceof Mu||!e.type.isAnonymous||Ib(e))}function uq(n){var e;let{buffer:t,nodeSet:i,maxBufferLength:s=rq,reused:r=[],minRepeatType:o=i.types.length}=n,a=Array.isArray(t)?new lq(t,t.length):t,l=i.types,h=0,u=0;function c(S,k,A,M,B){let{id:P,start:R,end:q,size:z}=a,X=u;for(;z<0;)if(a.next(),z==-1){let ee=r[P];A.push(ee),M.push(R-S);return}else if(z==-3){h=P;return}else if(z==-4){u=P;return}else throw new RangeError(`Unrecognized record size: ${z}`);let Z=l[P],K,oe,G=R-S;if(q-R<=s&&(oe=y(a.pos-k,B))){let ee=new Uint16Array(oe.size-oe.skip),te=a.pos-oe.size,re=ee.length;for(;a.pos>te;)re=_(oe.start,ee,re);K=new Mu(ee,q-oe.start,i),G=oe.start-S}else{let ee=a.pos-z;a.next();let te=[],re=[],ne=P>=o?P:-1,ve=0,xe=q;for(;a.pos>ee;)ne>=0&&a.id==ne&&a.size>=0?(a.end<=xe-s&&(p(te,re,R,ve,a.end,xe,ne,X),ve=te.length,xe=a.end),a.next()):c(R,ee,te,re,ne);if(ne>=0&&ve>0&&ve<te.length&&p(te,re,R,ve,R,xe,ne,X),te.reverse(),re.reverse(),ne>-1&&ve>0){let Pe=f(Z);K=Rb(Z,te,re,0,te.length,0,q-R,Pe,Pe)}else K=b(Z,te,re,q-R,X-q)}A.push(K),M.push(G)}function f(S){return(k,A,M)=>{let B=0,P=k.length-1,R,q;if(P>=0&&(R=k[P])instanceof ln){if(!P&&R.type==S&&R.length==M)return R;(q=R.prop(Ze.lookAhead))&&(B=A[P]+R.length+q)}return b(S,k,A,M,B)}}function p(S,k,A,M,B,P,R,q){let z=[],X=[];for(;S.length>M;)z.push(S.pop()),X.push(k.pop()+A-B);S.push(b(i.types[R],z,X,P-B,q-P)),k.push(B-A)}function b(S,k,A,M,B=0,P){if(h){let R=[Ze.contextHash,h];P=P?[R].concat(P):[R]}if(B>25){let R=[Ze.lookAhead,B];P=P?[R].concat(P):[R]}return new ln(S,k,A,M,P)}function y(S,k){let A=a.fork(),M=0,B=0,P=0,R=A.end-s,q={size:0,start:0,skip:0};e:for(let z=A.pos-S;A.pos>z;){let X=A.size;if(A.id==k&&X>=0){q.size=M,q.start=B,q.skip=P,P+=4,M+=4,A.next();continue}let Z=A.pos-X;if(X<0||Z<z||A.start<R)break;let K=A.id>=o?4:0,oe=A.start;for(A.next();A.pos>Z;){if(A.size<0)if(A.size==-3)K+=4;else break e;else A.id>=o&&(K+=4);A.next()}B=oe,M+=X,P+=K}return(k<0||M==S)&&(q.size=M,q.start=B,q.skip=P),q.size>4?q:void 0}function _(S,k,A){let{id:M,start:B,end:P,size:R}=a;if(a.next(),R>=0&&M<o){let q=A;if(R>4){let z=a.pos-(R-4);for(;a.pos>z;)A=_(S,k,A)}k[--A]=q,k[--A]=P-S,k[--A]=B-S,k[--A]=M}else R==-3?h=M:R==-4&&(u=M);return A}let T=[],w=[];for(;a.pos>0;)c(n.start||0,n.bufferStart||0,T,w,-1);let v=(e=n.length)!==null&&e!==void 0?e:T.length?w[0]+T[0].length:0;return new ln(l[n.topID],T.reverse(),w.reverse(),v)}const XT=new WeakMap;function md(n,e){if(!n.isAnonymous||e instanceof Mu||e.type!=n)return 1;let t=XT.get(e);if(t==null){t=1;for(let i of e.children){if(i.type!=n||!(i instanceof ln)){t=1;break}t+=md(n,i)}XT.set(e,t)}return t}function Rb(n,e,t,i,s,r,o,a,l){let h=0;for(let b=i;b<s;b++)h+=md(n,e[b]);let u=Math.ceil(h*1.5/8),c=[],f=[];function p(b,y,_,T,w){for(let v=_;v<T;){let S=v,k=y[v],A=md(n,b[v]);for(v++;v<T;v++){let M=md(n,b[v]);if(A+M>=u)break;A+=M}if(v==S+1){if(A>u){let M=b[S];p(M.children,M.positions,0,M.children.length,y[S]+w);continue}c.push(b[S])}else{let M=y[v-1]+b[v-1].length-k;c.push(Rb(n,b,y,S,v,k,M,null,l))}f.push(k+w-r)}}return p(e,t,i,s,0),(a||l)(c,f,o)}let gd=class $O{constructor(e,t,i,s,r=!1,o=!1){this.from=e,this.to=t,this.tree=i,this.offset=s,this.open=(r?1:0)|(o?2:0)}get openStart(){return(this.open&1)>0}get openEnd(){return(this.open&2)>0}static addTree(e,t=[],i=!1){let s=[new $O(0,e.length,e,0,!1,i)];for(let r of t)r.to>e.length&&s.push(r);return s}static applyChanges(e,t,i=128){if(!t.length)return e;let s=[],r=1,o=e.length?e[0]:null;for(let a=0,l=0,h=0;;a++){let u=a<t.length?t[a]:null,c=u?u.fromA:1e9;if(c-l>=i)for(;o&&o.from<c;){let f=o;if(l>=f.from||c<=f.to||h){let p=Math.max(f.from,l)-h,b=Math.min(f.to,c)-h;f=p>=b?null:new $O(p,b,f.tree,f.offset+h,a>0,!!u)}if(f&&s.push(f),o.to>c)break;o=r<e.length?e[r++]:null}if(!u)break;l=u.toA,h=u.toA-u.toB}return s}},cq=class{startParse(e,t,i){return typeof e=="string"&&(e=new dq(e)),i=i?i.length?i.map(s=>new tg(s.from,s.to)):[new tg(0,0)]:[new tg(0,e.length)],this.createParse(e,t||[],i)}parse(e,t,i){let s=this.startParse(e,t,i);for(;;){let r=s.advance();if(r)return r}}},dq=class{constructor(e){this.string=e}get length(){return this.string.length}chunk(e){return this.string.slice(e)}get lineChunks(){return!1}read(e,t){return this.string.slice(e,t)}};new Ze({perNode:!0});let fq=0,Tr=class bD{constructor(e,t,i){this.set=e,this.base=t,this.modified=i,this.id=fq++}static define(e){if(e?.base)throw new Error("Can not derive from a modified tag");let t=new bD([],null,[]);if(t.set.push(t),e)for(let i of e.set)t.set.push(i);return t}static defineModifier(){let e=new HT;return t=>t.modified.indexOf(e)>-1?t:HT.get(t.base||t,t.modified.concat(e).sort((i,s)=>i.id-s.id))}},pq=0,HT=class vD{constructor(){this.instances=[],this.id=pq++}static get(e,t){if(!t.length)return e;let i=t[0].instances.find(a=>a.base==e&&mq(t,a.modified));if(i)return i;let s=[],r=new Tr(s,e,t);for(let a of t)a.instances.push(r);let o=SD(t);for(let a of e.set)for(let l of o)s.push(vD.get(a,l));return r}};function mq(n,e){return n.length==e.length&&n.every((t,i)=>t==e[i])}function SD(n){let e=[n];for(let t=0;t<n.length;t++)for(let i of SD(n.slice(0,t).concat(n.slice(t+1))))e.push(i);return e}function gq(n){let e=Object.create(null);for(let t in n){let i=n[t];Array.isArray(i)||(i=[i]);for(let s of t.split(" "))if(s){let r=[],o=2,a=s;for(let c=0;;){if(a=="..."&&c>0&&c+3==s.length){o=1;break}let f=/^"(?:[^"\\]|\\.)*?"|[^\/!]+/.exec(a);if(!f)throw new RangeError("Invalid path: "+s);if(r.push(f[0]=="*"?"":f[0][0]=='"'?JSON.parse(f[0]):f[0]),c+=f[0].length,c==s.length)break;let p=s[c++];if(c==s.length&&p=="!"){o=0;break}if(p!="/")throw new RangeError("Invalid path: "+s);a=s.slice(c)}let l=r.length-1,h=r[l];if(!h)throw new RangeError("Invalid path: "+s);let u=new Oq(i,o,l>0?r.slice(0,l):null);e[h]=u.sort(e[h])}}return xD.add(e)}const xD=new Ze;let Oq=class{constructor(e,t,i,s){this.tags=e,this.mode=t,this.context=i,this.next=s}sort(e){return!e||e.depth<this.depth?(this.next=e,this):(e.next=this.sort(e.next),e)}get depth(){return this.context?this.context.length:0}};function TD(n,e){let t=Object.create(null);for(let r of n)if(!Array.isArray(r.tag))t[r.tag.id]=r.class;else for(let o of r.tag)t[o.id]=r.class;let{scope:i,all:s=null}=e||{};return{style:r=>{let o=s;for(let a of r)for(let l of a.set){let h=t[l.id];if(h){o=o?o+" "+h:h;break}}return o},scope:i}}function yq(n,e){let t=null;for(let i of n){let s=i.style(e);s&&(t=t?t+" "+s:s)}return t}function bq(n,e,t,i=0,s=n.length){let r=new vq(i,Array.isArray(e)?e:[e],t);r.highlightRange(n.cursor(),i,s,"",r.highlighters),r.flush(s)}let vq=class{constructor(e,t,i){this.at=e,this.highlighters=t,this.span=i,this.class=""}startSpan(e,t){t!=this.class&&(this.flush(e),e>this.at&&(this.at=e),this.class=t)}flush(e){e>this.at&&this.class&&this.span(this.at,e,this.class)}highlightRange(e,t,i,s,r){let{type:o,from:a,to:l}=e;if(a>=i||l<=t)return;o.isTop&&(r=this.highlighters.filter(p=>!p.scope||p.scope(o)));let h=s,u=o.prop(xD),c=!1;for(;u;){if(!u.context||e.matchContext(u.context)){let p=yq(r,u.tags);p&&(h&&(h+=" "),h+=p,u.mode==1?s+=(s?" ":"")+p:u.mode==0&&(c=!0));break}u=u.next}if(this.startSpan(e.from,h),c)return;let f=e.tree&&e.tree.prop(Ze.mounted);if(f&&f.overlay){let p=e.node.enter(f.overlay[0].from+a,1),b=this.highlighters.filter(_=>!_.scope||_.scope(f.tree.type)),y=e.firstChild();for(let _=0,T=a;;_++){let w=_<f.overlay.length?f.overlay[_]:null,v=w?w.from+a:l,S=Math.max(t,T),k=Math.min(i,v);if(S<k&&y)for(;e.from<k&&(this.highlightRange(e,S,k,s,r),this.startSpan(Math.min(i,e.to),h),!(e.to>=v||!e.nextSibling())););if(!w||v>i)break;T=w.to+a,T>t&&(this.highlightRange(p.cursor(),Math.max(t,w.from+a),Math.min(i,T),s,b),this.startSpan(T,h))}y&&e.parent()}else if(e.firstChild()){do if(!(e.to<=t)){if(e.from>=i)break;this.highlightRange(e,t,i,s,r),this.startSpan(Math.min(i,e.to),h)}while(e.nextSibling());e.parent()}}};const fe=Tr.define,Bc=fe(),wr=fe(),WT=fe(wr),ZT=fe(wr),_r=fe(),Nc=fe(_r),ig=fe(_r),hs=fe(),so=fe(hs),ss=fe(),rs=fe(),QO=fe(),zl=fe(QO),Fc=fe(),ge={comment:Bc,lineComment:fe(Bc),blockComment:fe(Bc),docComment:fe(Bc),name:wr,variableName:fe(wr),typeName:WT,tagName:fe(WT),propertyName:ZT,attributeName:fe(ZT),className:fe(wr),labelName:fe(wr),namespace:fe(wr),macroName:fe(wr),literal:_r,string:Nc,docString:fe(Nc),character:fe(Nc),attributeValue:fe(Nc),number:ig,integer:fe(ig),float:fe(ig),bool:fe(_r),regexp:fe(_r),escape:fe(_r),color:fe(_r),url:fe(_r),keyword:ss,self:fe(ss),null:fe(ss),atom:fe(ss),unit:fe(ss),modifier:fe(ss),operatorKeyword:fe(ss),controlKeyword:fe(ss),definitionKeyword:fe(ss),moduleKeyword:fe(ss),operator:rs,derefOperator:fe(rs),arithmeticOperator:fe(rs),logicOperator:fe(rs),bitwiseOperator:fe(rs),compareOperator:fe(rs),updateOperator:fe(rs),definitionOperator:fe(rs),typeOperator:fe(rs),controlOperator:fe(rs),punctuation:QO,separator:fe(QO),bracket:zl,angleBracket:fe(zl),squareBracket:fe(zl),paren:fe(zl),brace:fe(zl),content:hs,heading:so,heading1:fe(so),heading2:fe(so),heading3:fe(so),heading4:fe(so),heading5:fe(so),heading6:fe(so),contentSeparator:fe(hs),list:fe(hs),quote:fe(hs),emphasis:fe(hs),strong:fe(hs),link:fe(hs),monospace:fe(hs),strikethrough:fe(hs),inserted:fe(),deleted:fe(),changed:fe(),invalid:fe(),meta:Fc,documentMeta:fe(Fc),annotation:fe(Fc),processingInstruction:fe(Fc),definition:Tr.defineModifier(),constant:Tr.defineModifier(),function:Tr.defineModifier(),standard:Tr.defineModifier(),local:Tr.defineModifier(),special:Tr.defineModifier()};TD([{tag:ge.link,class:"tok-link"},{tag:ge.heading,class:"tok-heading"},{tag:ge.emphasis,class:"tok-emphasis"},{tag:ge.strong,class:"tok-strong"},{tag:ge.keyword,class:"tok-keyword"},{tag:ge.atom,class:"tok-atom"},{tag:ge.bool,class:"tok-bool"},{tag:ge.url,class:"tok-url"},{tag:ge.labelName,class:"tok-labelName"},{tag:ge.inserted,class:"tok-inserted"},{tag:ge.deleted,class:"tok-deleted"},{tag:ge.literal,class:"tok-literal"},{tag:ge.string,class:"tok-string"},{tag:ge.number,class:"tok-number"},{tag:[ge.regexp,ge.escape,ge.special(ge.string)],class:"tok-string2"},{tag:ge.variableName,class:"tok-variableName"},{tag:ge.local(ge.variableName),class:"tok-variableName tok-local"},{tag:ge.definition(ge.variableName),class:"tok-variableName tok-definition"},{tag:ge.special(ge.variableName),class:"tok-variableName2"},{tag:ge.definition(ge.propertyName),class:"tok-propertyName tok-definition"},{tag:ge.typeName,class:"tok-typeName"},{tag:ge.namespace,class:"tok-namespace"},{tag:ge.className,class:"tok-className"},{tag:ge.macroName,class:"tok-macroName"},{tag:ge.propertyName,class:"tok-propertyName"},{tag:ge.operator,class:"tok-operator"},{tag:ge.comment,class:"tok-comment"},{tag:ge.meta,class:"tok-meta"},{tag:ge.invalid,class:"tok-invalid"},{tag:ge.punctuation,class:"tok-punctuation"}]);var ng;const ff=new Ze;let Ss=class{constructor(e,t,i=[]){this.data=e,Ge.prototype.hasOwnProperty("tree")||Object.defineProperty(Ge.prototype,"tree",{get(){return wi(this)}}),this.parser=t,this.extension=[Xr.of(this),Ge.languageData.of((s,r,o)=>s.facet(YT(s,r,o)))].concat(i)}isActiveAt(e,t,i=-1){return YT(e,t,i)==this.data}findRegions(e){let t=e.facet(Xr);if(t?.data==this.data)return[{from:0,to:e.doc.length}];if(!t||!t.allowsNesting)return[];let i=[],s=(r,o)=>{if(r.prop(ff)==this.data){i.push({from:o,to:o+r.length});return}let a=r.prop(Ze.mounted);if(a){if(a.tree.prop(ff)==this.data){if(a.overlay)for(let l of a.overlay)i.push({from:l.from+o,to:l.to+o});else i.push({from:o,to:o+r.length});return}else if(a.overlay){let l=i.length;if(s(a.tree,a.overlay[0].from+o),i.length>l)return}}for(let l=0;l<r.children.length;l++){let h=r.children[l];h instanceof ln&&s(h,r.positions[l]+o)}};return s(wi(e),0),i}get allowsNesting(){return!0}};Ss.setState=Ue.define();function YT(n,e,t){let i=n.facet(Xr);if(!i)return null;let s=i.data;if(i.allowsNesting)for(let r=wi(n).topNode;r;r=r.enter(e,t,Oi.ExcludeBuffers))s=r.type.prop(ff)||s;return s}function wi(n){let e=n.field(Ss.state,!1);return e?e.tree:ln.empty}let Sq=class{constructor(e,t=e.length){this.doc=e,this.length=t,this.cursorPos=0,this.string="",this.cursor=e.iter()}syncTo(e){return this.string=this.cursor.next(e-this.cursorPos).value,this.cursorPos=e+this.string.length,this.cursorPos-this.string.length}chunk(e){return this.syncTo(e),this.string}get lineChunks(){return!0}read(e,t){let i=this.cursorPos-this.string.length;return e<i||t>=this.cursorPos?this.doc.sliceString(e,t):this.string.slice(e-i,t-i)}},jl=null,xq=class BO{constructor(e,t,i=[],s,r,o,a,l){this.parser=e,this.state=t,this.fragments=i,this.tree=s,this.treeLen=r,this.viewport=o,this.skipped=a,this.scheduleOn=l,this.parse=null,this.tempSkipped=[]}static create(e,t,i){return new BO(e,t,[],ln.empty,0,i,[],null)}startParse(){return this.parser.startParse(new Sq(this.state.doc),this.fragments)}work(e,t){return t!=null&&t>=this.state.doc.length&&(t=void 0),this.tree!=ln.empty&&this.isDone(t??this.state.doc.length)?(this.takeTree(),!0):this.withContext(()=>{var i;if(typeof e=="number"){let s=Date.now()+e;e=()=>Date.now()>s}for(this.parse||(this.parse=this.startParse()),t!=null&&(this.parse.stoppedAt==null||this.parse.stoppedAt>t)&&t<this.state.doc.length&&this.parse.stopAt(t);;){let s=this.parse.advance();if(s)if(this.fragments=this.withoutTempSkipped(gd.addTree(s,this.fragments,this.parse.stoppedAt!=null)),this.treeLen=(i=this.parse.stoppedAt)!==null&&i!==void 0?i:this.state.doc.length,this.tree=s,this.parse=null,this.treeLen<(t??this.state.doc.length))this.parse=this.startParse();else return!0;if(e())return!1}})}takeTree(){let e,t;this.parse&&(e=this.parse.parsedPos)>=this.treeLen&&((this.parse.stoppedAt==null||this.parse.stoppedAt>e)&&this.parse.stopAt(e),this.withContext(()=>{for(;!(t=this.parse.advance()););}),this.treeLen=e,this.tree=t,this.fragments=this.withoutTempSkipped(gd.addTree(this.tree,this.fragments,!0)),this.parse=null)}withContext(e){let t=jl;jl=this;try{return e()}finally{jl=t}}withoutTempSkipped(e){for(let t;t=this.tempSkipped.pop();)e=GT(e,t.from,t.to);return e}changes(e,t){let{fragments:i,tree:s,treeLen:r,viewport:o,skipped:a}=this;if(this.takeTree(),!e.empty){let l=[];if(e.iterChangedRanges((h,u,c,f)=>l.push({fromA:h,toA:u,fromB:c,toB:f})),i=gd.applyChanges(i,l),s=ln.empty,r=0,o={from:e.mapPos(o.from,-1),to:e.mapPos(o.to,1)},this.skipped.length){a=[];for(let h of this.skipped){let u=e.mapPos(h.from,1),c=e.mapPos(h.to,-1);u<c&&a.push({from:u,to:c})}}}return new BO(this.parser,t,i,s,r,o,a,this.scheduleOn)}updateViewport(e){if(this.viewport.from==e.from&&this.viewport.to==e.to)return!1;this.viewport=e;let t=this.skipped.length;for(let i=0;i<this.skipped.length;i++){let{from:s,to:r}=this.skipped[i];s<e.to&&r>e.from&&(this.fragments=GT(this.fragments,s,r),this.skipped.splice(i--,1))}return this.skipped.length>=t?!1:(this.reset(),!0)}reset(){this.parse&&(this.takeTree(),this.parse=null)}skipUntilInView(e,t){this.skipped.push({from:e,to:t})}static getSkippingParser(e){return new class extends cq{createParse(t,i,s){let r=s[0].from,o=s[s.length-1].to;return{parsedPos:r,advance(){let l=jl;if(l){for(let h of s)l.tempSkipped.push(h);e&&(l.scheduleOn=l.scheduleOn?Promise.all([l.scheduleOn,e]):e)}return this.parsedPos=o,new ln(Rs.none,[],[],o-r)},stoppedAt:null,stopAt(){}}}}}isDone(e){e=Math.min(e,this.state.doc.length);let t=this.fragments;return this.treeLen>=e&&t.length&&t[0].from==0&&t[0].to>=e}static get(){return jl}};function GT(n,e,t){return gd.applyChanges(n,[{fromA:e,toA:t,fromB:e,toB:t}])}let NO=class FO{constructor(e){this.context=e,this.tree=e.tree}apply(e){if(!e.docChanged&&this.tree==this.context.tree)return this;let t=this.context.changes(e.changes,e.state),i=this.context.treeLen==e.startState.doc.length?void 0:Math.max(e.changes.mapPos(this.context.treeLen),t.viewport.to);return t.work(20,i)||t.takeTree(),new FO(t)}static init(e){let t=Math.min(3e3,e.doc.length),i=xq.create(e.facet(Xr).parser,e,{from:0,to:t});return i.work(20,t)||i.takeTree(),new FO(i)}};Ss.state=ci.define({create:NO.init,update(n,e){for(let t of e.effects)if(t.is(Ss.setState))return t.value;return e.startState.facet(Xr)!=e.state.facet(Xr)?NO.init(e.state):n.apply(e)}});let wD=n=>{let e=setTimeout(()=>n(),500);return()=>clearTimeout(e)};typeof requestIdleCallback<"u"&&(wD=n=>{let e=-1,t=setTimeout(()=>{e=requestIdleCallback(n,{timeout:400})},100);return()=>e<0?clearTimeout(t):cancelIdleCallback(e)});const sg=typeof navigator<"u"&&(!((ng=navigator.scheduling)===null||ng===void 0)&&ng.isInputPending)?()=>navigator.scheduling.isInputPending():null,Tq=Xt.fromClass(class{constructor(e){this.view=e,this.working=null,this.workScheduled=0,this.chunkEnd=-1,this.chunkBudget=-1,this.work=this.work.bind(this),this.scheduleWork()}update(e){let t=this.view.state.field(Ss.state).context;(t.updateViewport(e.view.viewport)||this.view.viewport.to>t.treeLen)&&this.scheduleWork(),e.docChanged&&(this.view.hasFocus&&(this.chunkBudget+=50),this.scheduleWork()),this.checkAsyncSchedule(t)}scheduleWork(){if(this.working)return;let{state:e}=this.view,t=e.field(Ss.state);(t.tree!=t.context.tree||!t.context.isDone(e.doc.length))&&(this.working=wD(this.work))}work(e){this.working=null;let t=Date.now();if(this.chunkEnd<t&&(this.chunkEnd<0||this.view.hasFocus)&&(this.chunkEnd=t+3e4,this.chunkBudget=3e3),this.chunkBudget<=0)return;let{state:i,viewport:{to:s}}=this.view,r=i.field(Ss.state);if(r.tree==r.context.tree&&r.context.isDone(s+1e5))return;let o=Date.now()+Math.min(this.chunkBudget,100,e&&!sg?Math.max(25,e.timeRemaining()-5):1e9),a=r.context.treeLen<s&&i.doc.length>s+1e3,l=r.context.work(()=>sg&&sg()||Date.now()>o,s+(a?0:1e5));this.chunkBudget-=Date.now()-t,(l||this.chunkBudget<=0)&&(r.context.takeTree(),this.view.dispatch({effects:Ss.setState.of(new NO(r.context))})),this.chunkBudget>0&&!(l&&!a)&&this.scheduleWork(),this.checkAsyncSchedule(r.context)}checkAsyncSchedule(e){e.scheduleOn&&(this.workScheduled++,e.scheduleOn.then(()=>this.scheduleWork()).catch(t=>un(this.view.state,t)).then(()=>this.workScheduled--),e.scheduleOn=null)}destroy(){this.working&&this.working()}isWorking(){return!!(this.working||this.workScheduled>0)}},{eventHandlers:{focus(){this.scheduleWork()}}}),Xr=Ce.define({combine(n){return n.length?n[0]:null},enables:[Ss.state,Tq]}),wq=Ce.define(),Lb=Ce.define({combine:n=>{if(!n.length)return"  ";if(!/^(?: +|\t+)$/.test(n[0]))throw new Error("Invalid indent unit: "+JSON.stringify(n[0]));return n[0]}});function pf(n){let e=n.facet(Lb);return e.charCodeAt(0)==9?n.tabSize*e.length:e.length}function ru(n,e){let t="",i=n.tabSize;if(n.facet(Lb).charCodeAt(0)==9)for(;e>=i;)t+="	",e-=i;for(let s=0;s<e;s++)t+=" ";return t}function $b(n,e){n instanceof Ge&&(n=new pp(n));for(let i of n.state.facet(wq)){let s=i(n,e);if(s!=null)return s}let t=wi(n.state);return t?kq(n,t,e):null}class pp{constructor(e,t={}){this.state=e,this.options=t,this.unit=pf(e)}lineAt(e,t=1){let i=this.state.doc.lineAt(e),{simulateBreak:s,simulateDoubleBreak:r}=this.options;return s!=null&&s>=i.from&&s<=i.to?r&&s==e?{text:"",from:e}:(t<0?s<e:s<=e)?{text:i.text.slice(s-i.from),from:s}:{text:i.text.slice(0,s-i.from),from:i.from}:i}textAfterPos(e,t=1){if(this.options.simulateDoubleBreak&&e==this.options.simulateBreak)return"";let{text:i,from:s}=this.lineAt(e,t);return i.slice(e-s,Math.min(i.length,e+100-s))}column(e,t=1){let{text:i,from:s}=this.lineAt(e,t),r=this.countColumn(i,e-s),o=this.options.overrideIndentation?this.options.overrideIndentation(s):-1;return o>-1&&(r+=o-this.countColumn(i,i.search(/\S|$/))),r}countColumn(e,t=e.length){return Au(e,this.state.tabSize,t)}lineIndent(e,t=1){let{text:i,from:s}=this.lineAt(e,t),r=this.options.overrideIndentation;if(r){let o=r(s);if(o>-1)return o}return this.countColumn(i,i.search(/\S|$/))}get simulatedBreak(){return this.options.simulateBreak||null}}const _q=new Ze;function kq(n,e,t){return _D(e.resolveInner(t).enterUnfinishedNodesBefore(t),t,n)}function Cq(n){return n.pos==n.options.simulateBreak&&n.options.simulateDoubleBreak}function Eq(n){let e=n.type.prop(_q);if(e)return e;let t=n.firstChild,i;if(t&&(i=t.type.prop(Ze.closedBy))){let s=n.lastChild,r=s&&i.indexOf(s.name)>-1;return o=>Mq(o,!0,1,void 0,r&&!Cq(o)?s.from:void 0)}return n.parent==null?Aq:null}function _D(n,e,t){for(;n;n=n.parent){let i=Eq(n);if(i)return i(Qb.create(t,e,n))}return null}function Aq(){return 0}class Qb extends pp{constructor(e,t,i){super(e.state,e.options),this.base=e,this.pos=t,this.node=i}static create(e,t,i){return new Qb(e,t,i)}get textAfter(){return this.textAfterPos(this.pos)}get baseIndent(){let e=this.state.doc.lineAt(this.node.from);for(;;){let t=this.node.resolve(e.from);for(;t.parent&&t.parent.from==t.from;)t=t.parent;if(Pq(t,this.node))break;e=this.state.doc.lineAt(t.from)}return this.lineIndent(e.from)}continue(){let e=this.node.parent;return e?_D(e,this.pos,this.base):0}}function Pq(n,e){for(let t=e;t;t=t.parent)if(n==t)return!0;return!1}function Dq(n){let e=n.node,t=e.childAfter(e.from),i=e.lastChild;if(!t)return null;let s=n.options.simulateBreak,r=n.state.doc.lineAt(t.from),o=s==null||s<=r.from?r.to:Math.min(r.to,s);for(let a=t.to;;){let l=e.childAfter(a);if(!l||l==i)return null;if(!l.type.isSkipped)return l.from<o?t:null;a=l.to}}function Mq(n,e,t,i,s){let r=n.textAfter,o=r.match(/^\s*/)[0].length,a=i&&r.slice(o,o+i.length)==i||s==n.pos+o,l=Dq(n);return l?a?n.column(l.from):n.column(l.to):n.baseIndent+(a?0:n.unit*t)}const Iq=200;function Rq(){return Ge.transactionFilter.of(n=>{if(!n.docChanged||!n.isUserEvent("input.type")&&!n.isUserEvent("input.complete"))return n;let e=n.startState.languageDataAt("indentOnInput",n.startState.selection.main.head);if(!e.length)return n;let t=n.newDoc,{head:i}=n.newSelection.main,s=t.lineAt(i);if(i>s.from+Iq)return n;let r=t.sliceString(s.from,i);if(!e.some(h=>h.test(r)))return n;let{state:o}=n,a=-1,l=[];for(let{head:h}of o.selection.ranges){let u=o.doc.lineAt(h);if(u.from==a)continue;a=u.from;let c=$b(o,u.from);if(c==null)continue;let f=/^\s*/.exec(u.text)[0],p=ru(o,c);f!=p&&l.push({from:u.from,to:u.from+f.length,insert:p})}return l.length?[n,{changes:l,sequential:!0}]:n})}const Lq=Ce.define(),$q=new Ze;function Qq(n,e,t){let i=wi(n);if(i.length<t)return null;let s=i.resolveInner(t),r=null;for(let o=s;o;o=o.parent){if(o.to<=t||o.from>t)continue;if(r&&o.from<e)break;let a=o.type.prop($q);if(a&&(o.to<i.length-50||i.length==n.doc.length||!Bq(o))){let l=a(o,n);l&&l.from<=t&&l.from>=e&&l.to>t&&(r=l)}}return r}function Bq(n){let e=n.lastChild;return e&&e.to==n.to&&e.type.isError}function mf(n,e,t){for(let i of n.facet(Lq)){let s=i(n,e,t);if(s)return s}return Qq(n,e,t)}function kD(n,e){let t=e.mapPos(n.from,1),i=e.mapPos(n.to,-1);return t>=i?void 0:{from:t,to:i}}const mp=Ue.define({map:kD}),Iu=Ue.define({map:kD});function CD(n){let e=[];for(let{head:t}of n.state.selection.ranges)e.some(i=>i.from<=t&&i.to>=t)||e.push(n.lineBlockAt(t));return e}const Bo=ci.define({create(){return Ie.none},update(n,e){n=n.map(e.changes);for(let t of e.effects)t.is(mp)&&!Nq(n,t.value.from,t.value.to)?n=n.update({add:[Hq.range(t.value.from,t.value.to)]}):t.is(Iu)&&(n=n.update({filter:(i,s)=>t.value.from!=i||t.value.to!=s,filterFrom:t.value.from,filterTo:t.value.to}));if(e.selection){let t=!1,{head:i}=e.selection.main;n.between(i,i,(s,r)=>{s<i&&r>i&&(t=!0)}),t&&(n=n.update({filterFrom:i,filterTo:i,filter:(s,r)=>r<=i||s>=i}))}return n},provide:n=>$e.decorations.from(n)});function gf(n,e,t){var i;let s=null;return(i=n.field(Bo,!1))===null||i===void 0||i.between(e,t,(r,o)=>{(!s||s.from>r)&&(s={from:r,to:o})}),s}function Nq(n,e,t){let i=!1;return n.between(e,e,(s,r)=>{s==e&&r==t&&(i=!0)}),i}function ED(n,e){return n.field(Bo,!1)?e:e.concat(Ue.appendConfig.of(PD()))}const Fq=n=>{for(let e of CD(n)){let t=mf(n.state,e.from,e.to);if(t)return n.dispatch({effects:ED(n.state,[mp.of(t),AD(n,t)])}),!0}return!1},Vq=n=>{if(!n.state.field(Bo,!1))return!1;let e=[];for(let t of CD(n)){let i=gf(n.state,t.from,t.to);i&&e.push(Iu.of(i),AD(n,i,!1))}return e.length&&n.dispatch({effects:e}),e.length>0};function AD(n,e,t=!0){let i=n.state.doc.lineAt(e.from).number,s=n.state.doc.lineAt(e.to).number;return $e.announce.of(`${n.state.phrase(t?"Folded lines":"Unfolded lines")} ${i} ${n.state.phrase("to")} ${s}.`)}const Uq=n=>{let{state:e}=n,t=[];for(let i=0;i<e.doc.length;){let s=n.lineBlockAt(i),r=mf(e,s.from,s.to);r&&t.push(mp.of(r)),i=(r?n.lineBlockAt(r.to):s).to+1}return t.length&&n.dispatch({effects:ED(n.state,t)}),!!t.length},qq=n=>{let e=n.state.field(Bo,!1);if(!e||!e.size)return!1;let t=[];return e.between(0,n.state.doc.length,(i,s)=>{t.push(Iu.of({from:i,to:s}))}),n.dispatch({effects:t}),!0},zq=[{key:"Ctrl-Shift-[",mac:"Cmd-Alt-[",run:Fq},{key:"Ctrl-Shift-]",mac:"Cmd-Alt-]",run:Vq},{key:"Ctrl-Alt-[",run:Uq},{key:"Ctrl-Alt-]",run:qq}],jq={placeholderDOM:null,placeholderText:"…"},Xq=Ce.define({combine(n){return ar(n,jq)}});function PD(n){return[Bo,Yq]}const Hq=Ie.replace({widget:new class extends Yr{toDOM(n){let{state:e}=n,t=e.facet(Xq),i=r=>{let o=n.lineBlockAt(n.posAtDOM(r.target)),a=gf(n.state,o.from,o.to);a&&n.dispatch({effects:Iu.of(a)}),r.preventDefault()};if(t.placeholderDOM)return t.placeholderDOM(n,i);let s=document.createElement("span");return s.textContent=t.placeholderText,s.setAttribute("aria-label",e.phrase("folded code")),s.title=e.phrase("unfold"),s.className="cm-foldPlaceholder",s.onclick=i,s}}}),Wq={openText:"⌄",closedText:"›",markerDOM:null,domEventHandlers:{}};class rg extends or{constructor(e,t){super(),this.config=e,this.open=t}eq(e){return this.config==e.config&&this.open==e.open}toDOM(e){if(this.config.markerDOM)return this.config.markerDOM(this.open);let t=document.createElement("span");return t.textContent=this.open?this.config.openText:this.config.closedText,t.title=e.state.phrase(this.open?"Fold line":"Unfold line"),t}}function Zq(n={}){let e=Object.assign(Object.assign({},Wq),n),t=new rg(e,!0),i=new rg(e,!1),s=Xt.fromClass(class{constructor(o){this.from=o.viewport.from,this.markers=this.buildMarkers(o)}update(o){(o.docChanged||o.viewportChanged||o.startState.facet(Xr)!=o.state.facet(Xr)||o.startState.field(Bo,!1)!=o.state.field(Bo,!1)||wi(o.startState)!=wi(o.state))&&(this.markers=this.buildMarkers(o.view))}buildMarkers(o){let a=new zr;for(let l of o.viewportLineBlocks){let h=gf(o.state,l.from,l.to)?i:mf(o.state,l.from,l.to)?t:null;h&&a.add(l.from,l.from,h)}return a.finish()}}),{domEventHandlers:r}=e;return[s,ZU({class:"cm-foldGutter",markers(o){var a;return((a=o.plugin(s))===null||a===void 0?void 0:a.markers)||st.empty},initialSpacer(){return new rg(e,!1)},domEventHandlers:Object.assign(Object.assign({},r),{click:(o,a,l)=>{if(r.click&&r.click(o,a,l))return!0;let h=gf(o.state,a.from,a.to);if(h)return o.dispatch({effects:Iu.of(h)}),!0;let u=mf(o.state,a.from,a.to);return u?(o.dispatch({effects:mp.of(u)}),!0):!1}})}),PD()]}const Yq=$e.baseTheme({".cm-foldPlaceholder":{backgroundColor:"#eee",border:"1px solid #ddd",color:"#888",borderRadius:".2em",margin:"0 1px",padding:"0 1px",cursor:"pointer"},".cm-foldGutter span":{padding:"0 1px",cursor:"pointer"}});let DD=class MD{constructor(e,t){let i;function s(a){let l=Ti.newName();return(i||(i=Object.create(null)))["."+l]=a,l}const r=typeof t.all=="string"?t.all:t.all?s(t.all):void 0,o=t.scope;this.scope=o instanceof Ss?a=>a.prop(ff)==o.data:o?a=>a==o:void 0,this.style=TD(e.map(a=>({tag:a.tag,class:a.class||s(Object.assign({},a,{tag:null}))})),{all:r}).style,this.module=i?new Ti(i):null,this.themeType=t.themeType}static define(e,t){return new MD(e,t||{})}};const VO=Ce.define(),ID=Ce.define({combine(n){return n.length?[n[0]]:null}});function og(n){let e=n.facet(VO);return e.length?e:n.facet(ID)}function Gq(n,e){let t=[Jq],i;return n instanceof DD&&(n.module&&t.push($e.styleModule.of(n.module)),i=n.themeType),e?.fallback?t.push(ID.of(n)):i?t.push(VO.computeN([$e.darkTheme],s=>s.facet($e.darkTheme)==(i=="dark")?[n]:[])):t.push(VO.of(n)),t}let Kq=class{constructor(e){this.markCache=Object.create(null),this.tree=wi(e.state),this.decorations=this.buildDeco(e,og(e.state))}update(e){let t=wi(e.state),i=og(e.state),s=i!=og(e.startState);t.length<e.view.viewport.to&&!s&&t.type==this.tree.type?this.decorations=this.decorations.map(e.changes):(t!=this.tree||e.viewportChanged||s)&&(this.tree=t,this.decorations=this.buildDeco(e.view,i))}buildDeco(e,t){if(!t||!this.tree.length)return Ie.none;let i=new zr;for(let{from:s,to:r}of e.visibleRanges)bq(this.tree,t,(o,a,l)=>{i.add(o,a,this.markCache[l]||(this.markCache[l]=Ie.mark({class:l})))},s,r);return i.finish()}};const Jq=Eu.high(Xt.fromClass(Kq,{decorations:n=>n.decorations})),ez=DD.define([{tag:ge.meta,color:"#7a757a"},{tag:ge.link,textDecoration:"underline"},{tag:ge.heading,textDecoration:"underline",fontWeight:"bold"},{tag:ge.emphasis,fontStyle:"italic"},{tag:ge.strong,fontWeight:"bold"},{tag:ge.strikethrough,textDecoration:"line-through"},{tag:ge.keyword,color:"#708"},{tag:[ge.atom,ge.bool,ge.url,ge.contentSeparator,ge.labelName],color:"#219"},{tag:[ge.literal,ge.inserted],color:"#164"},{tag:[ge.string,ge.deleted],color:"#a11"},{tag:[ge.regexp,ge.escape,ge.special(ge.string)],color:"#e40"},{tag:ge.definition(ge.variableName),color:"#00f"},{tag:ge.local(ge.variableName),color:"#30a"},{tag:[ge.typeName,ge.namespace],color:"#085"},{tag:ge.className,color:"#167"},{tag:[ge.special(ge.variableName),ge.macroName],color:"#256"},{tag:ge.definition(ge.propertyName),color:"#00c"},{tag:ge.comment,color:"#940"},{tag:ge.invalid,color:"#f00"}]),tz=$e.baseTheme({"&.cm-focused .cm-matchingBracket":{backgroundColor:"#328c8252"},"&.cm-focused .cm-nonmatchingBracket":{backgroundColor:"#bb555544"}}),RD=1e4,LD="()[]{}",$D=Ce.define({combine(n){return ar(n,{afterCursor:!0,brackets:LD,maxScanDistance:RD,renderMatch:sz})}}),iz=Ie.mark({class:"cm-matchingBracket"}),nz=Ie.mark({class:"cm-nonmatchingBracket"});function sz(n){let e=[],t=n.matched?iz:nz;return e.push(t.range(n.start.from,n.start.to)),n.end&&e.push(t.range(n.end.from,n.end.to)),e}const rz=ci.define({create(){return Ie.none},update(n,e){if(!e.docChanged&&!e.selection)return n;let t=[],i=e.state.facet($D);for(let s of e.state.selection.ranges){if(!s.empty)continue;let r=xs(e.state,s.head,-1,i)||s.head>0&&xs(e.state,s.head-1,1,i)||i.afterCursor&&(xs(e.state,s.head,1,i)||s.head<e.state.doc.length&&xs(e.state,s.head+1,-1,i));r&&(t=t.concat(i.renderMatch(r,e.state)))}return Ie.set(t,!0)},provide:n=>$e.decorations.from(n)}),oz=[rz,tz];function az(n={}){return[$D.of(n),oz]}function UO(n,e,t){let i=n.prop(e<0?Ze.openedBy:Ze.closedBy);if(i)return i;if(n.name.length==1){let s=t.indexOf(n.name);if(s>-1&&s%2==(e<0?1:0))return[t[s+e]]}return null}function xs(n,e,t,i={}){let s=i.maxScanDistance||RD,r=i.brackets||LD,o=wi(n),a=o.resolveInner(e,t);for(let l=a;l;l=l.parent){let h=UO(l.type,t,r);if(h&&l.from<l.to)return lz(n,e,t,l,h,r)}return hz(n,e,t,o,a.type,s,r)}function lz(n,e,t,i,s,r){let o=i.parent,a={from:i.from,to:i.to},l=0,h=o?.cursor();if(h&&(t<0?h.childBefore(i.from):h.childAfter(i.to)))do if(t<0?h.to<=i.from:h.from>=i.to){if(l==0&&s.indexOf(h.type.name)>-1&&h.from<h.to)return{start:a,end:{from:h.from,to:h.to},matched:!0};if(UO(h.type,t,r))l++;else if(UO(h.type,-t,r)&&(l--,l==0))return{start:a,end:h.from==h.to?void 0:{from:h.from,to:h.to},matched:!1}}while(t<0?h.prevSibling():h.nextSibling());return{start:a,matched:!1}}function hz(n,e,t,i,s,r,o){let a=t<0?n.sliceDoc(e-1,e):n.sliceDoc(e,e+1),l=o.indexOf(a);if(l<0||l%2==0!=t>0)return null;let h={from:t<0?e-1:e,to:t>0?e+1:e},u=n.doc.iterRange(e,t>0?n.doc.length:0),c=0;for(let f=0;!u.next().done&&f<=r;){let p=u.value;t<0&&(f+=p.length);let b=e+f*t;for(let y=t>0?0:p.length-1,_=t>0?p.length:-1;y!=_;y+=t){let T=o.indexOf(p[y]);if(!(T<0||i.resolve(b+y,1).type!=s))if(T%2==0==t>0)c++;else{if(c==1)return{start:h,end:{from:b+y,to:b+y+1},matched:T>>1==l>>1};c--}}t>0&&(f+=p.length)}return u.done?{start:h,matched:!1}:null}const uz=Object.create(null),KT=[Rs.none],JT=[],cz=Object.create(null);for(let[n,e]of[["variable","variableName"],["variable-2","variableName.special"],["string-2","string.special"],["def","variableName.definition"],["tag","typeName"],["attribute","propertyName"],["type","typeName"],["builtin","variableName.standard"],["qualifier","modifier"],["error","invalid"],["header","heading"],["property","propertyName"]])cz[n]=dz(uz,e);function ag(n,e){JT.indexOf(n)>-1||(JT.push(n),console.warn(e))}function dz(n,e){let t=null;for(let r of e.split(".")){let o=n[r]||ge[r];o?typeof o=="function"?t?t=o(t):ag(r,`Modifier ${r} used at start of tag`):t?ag(r,`Tag ${r} used as modifier`):t=o:ag(r,`Unknown highlighting tag ${r}`)}if(!t)return 0;let i=e.replace(/ /g,"_"),s=Rs.define({id:KT.length,name:i,props:[gq({[i]:t})]});return KT.push(s),s.id}const fz=n=>{let e=Nb(n.state);return e.line?pz(n):e.block?gz(n):!1};function Bb(n,e){return({state:t,dispatch:i})=>{if(t.readOnly)return!1;let s=n(e,t);return s?(i(t.update(s)),!0):!1}}const pz=Bb(bz,0),mz=Bb(QD,0),gz=Bb((n,e)=>QD(n,e,yz(e)),0);function Nb(n,e=n.selection.main.head){let t=n.languageDataAt("commentTokens",e);return t.length?t[0]:{}}const Xl=50;function Oz(n,{open:e,close:t},i,s){let r=n.sliceDoc(i-Xl,i),o=n.sliceDoc(s,s+Xl),a=/\s*$/.exec(r)[0].length,l=/^\s*/.exec(o)[0].length,h=r.length-a;if(r.slice(h-e.length,h)==e&&o.slice(l,l+t.length)==t)return{open:{pos:i-a,margin:a&&1},close:{pos:s+l,margin:l&&1}};let u,c;s-i<=2*Xl?u=c=n.sliceDoc(i,s):(u=n.sliceDoc(i,i+Xl),c=n.sliceDoc(s-Xl,s));let f=/^\s*/.exec(u)[0].length,p=/\s*$/.exec(c)[0].length,b=c.length-p-t.length;return u.slice(f,f+e.length)==e&&c.slice(b,b+t.length)==t?{open:{pos:i+f+e.length,margin:/\s/.test(u.charAt(f+e.length))?1:0},close:{pos:s-p-t.length,margin:/\s/.test(c.charAt(b-1))?1:0}}:null}function yz(n){let e=[];for(let t of n.selection.ranges){let i=n.doc.lineAt(t.from),s=t.to<=i.to?i:n.doc.lineAt(t.to),r=e.length-1;r>=0&&e[r].to>i.from?e[r].to=s.to:e.push({from:i.from,to:s.to})}return e}function QD(n,e,t=e.selection.ranges){let i=t.map(r=>Nb(e,r.from).block);if(!i.every(r=>r))return null;let s=t.map((r,o)=>Oz(e,i[o],r.from,r.to));if(n!=2&&!s.every(r=>r))return{changes:e.changes(t.map((r,o)=>s[o]?[]:[{from:r.from,insert:i[o].open+" "},{from:r.to,insert:" "+i[o].close}]))};if(n!=1&&s.some(r=>r)){let r=[];for(let o=0,a;o<s.length;o++)if(a=s[o]){let l=i[o],{open:h,close:u}=a;r.push({from:h.pos-l.open.length,to:h.pos+h.margin},{from:u.pos-u.margin,to:u.pos+l.close.length})}return{changes:r}}return null}function bz(n,e,t=e.selection.ranges){let i=[],s=-1;for(let{from:r,to:o}of t){let a=i.length,l=1e9;for(let h=r;h<=o;){let u=e.doc.lineAt(h);if(u.from>s&&(r==o||o>u.from)){s=u.from;let c=Nb(e,h).line;if(!c)continue;let f=/^\s*/.exec(u.text)[0].length,p=f==u.length,b=u.text.slice(f,f+c.length)==c?f:-1;f<u.text.length&&f<l&&(l=f),i.push({line:u,comment:b,token:c,indent:f,empty:p,single:!1})}h=u.to+1}if(l<1e9)for(let h=a;h<i.length;h++)i[h].indent<i[h].line.text.length&&(i[h].indent=l);i.length==a+1&&(i[a].single=!0)}if(n!=2&&i.some(r=>r.comment<0&&(!r.empty||r.single))){let r=[];for(let{line:a,token:l,indent:h,empty:u,single:c}of i)(c||!u)&&r.push({from:a.from+h,insert:l+" "});let o=e.changes(r);return{changes:o,selection:e.selection.map(o,1)}}else if(n!=1&&i.some(r=>r.comment>=0)){let r=[];for(let{line:o,comment:a,token:l}of i)if(a>=0){let h=o.from+a,u=h+l.length;o.text[u-o.from]==" "&&u++,r.push({from:h,to:u})}return{changes:r}}return null}const qO=Vo.define(),vz=Vo.define(),Sz=Ce.define(),BD=Ce.define({combine(n){return ar(n,{minDepth:100,newGroupDelay:500},{minDepth:Math.max,newGroupDelay:Math.min})}});function xz(n){let e=0;return n.iterChangedRanges((t,i)=>e=i),e}const ND=ci.define({create(){return Ts.empty},update(n,e){let t=e.state.facet(BD),i=e.annotation(qO);if(i){let l=e.docChanged?le.single(xz(e.changes)):void 0,h=Xi.fromTransaction(e,l),u=i.side,c=u==0?n.undone:n.done;return h?c=Of(c,c.length,t.minDepth,h):c=qD(c,e.startState.selection),new Ts(u==0?i.rest:c,u==0?c:i.rest)}let s=e.annotation(vz);if((s=="full"||s=="before")&&(n=n.isolate()),e.annotation(Wt.addToHistory)===!1)return e.changes.empty?n:n.addMapping(e.changes.desc);let r=Xi.fromTransaction(e),o=e.annotation(Wt.time),a=e.annotation(Wt.userEvent);return r?n=n.addChanges(r,o,a,t.newGroupDelay,t.minDepth):e.selection&&(n=n.addSelection(e.startState.selection,o,a,t.newGroupDelay)),(s=="full"||s=="after")&&(n=n.isolate()),n},toJSON(n){return{done:n.done.map(e=>e.toJSON()),undone:n.undone.map(e=>e.toJSON())}},fromJSON(n){return new Ts(n.done.map(Xi.fromJSON),n.undone.map(Xi.fromJSON))}});function Tz(n={}){return[ND,BD.of(n),$e.domEventHandlers({beforeinput(e,t){let i=e.inputType=="historyUndo"?FD:e.inputType=="historyRedo"?VD:null;return i?(e.preventDefault(),i(t)):!1}})]}function gp(n,e){return function({state:t,dispatch:i}){if(!e&&t.readOnly)return!1;let s=t.field(ND,!1);if(!s)return!1;let r=s.pop(n,t,e);return r?(i(r),!0):!1}}const FD=gp(0,!1),VD=gp(1,!1),wz=gp(0,!0),_z=gp(1,!0);class Xi{constructor(e,t,i,s,r){this.changes=e,this.effects=t,this.mapped=i,this.startSelection=s,this.selectionsAfter=r}setSelAfter(e){return new Xi(this.changes,this.effects,this.mapped,this.startSelection,e)}toJSON(){var e,t,i;return{changes:(e=this.changes)===null||e===void 0?void 0:e.toJSON(),mapped:(t=this.mapped)===null||t===void 0?void 0:t.toJSON(),startSelection:(i=this.startSelection)===null||i===void 0?void 0:i.toJSON(),selectionsAfter:this.selectionsAfter.map(s=>s.toJSON())}}static fromJSON(e){return new Xi(e.changes&&Ht.fromJSON(e.changes),[],e.mapped&&ks.fromJSON(e.mapped),e.startSelection&&le.fromJSON(e.startSelection),e.selectionsAfter.map(le.fromJSON))}static fromTransaction(e,t){let i=wn;for(let s of e.startState.facet(Sz)){let r=s(e);r.length&&(i=i.concat(r))}return!i.length&&e.changes.empty?null:new Xi(e.changes.invert(e.startState.doc),i,void 0,t||e.startState.selection,wn)}static selection(e){return new Xi(void 0,wn,void 0,void 0,e)}}function Of(n,e,t,i){let s=e+1>t+20?e-t-1:0,r=n.slice(s,e);return r.push(i),r}function kz(n,e){let t=[],i=!1;return n.iterChangedRanges((s,r)=>t.push(s,r)),e.iterChangedRanges((s,r,o,a)=>{for(let l=0;l<t.length;){let h=t[l++],u=t[l++];a>=h&&o<=u&&(i=!0)}}),i}function Cz(n,e){return n.ranges.length==e.ranges.length&&n.ranges.filter((t,i)=>t.empty!=e.ranges[i].empty).length===0}function UD(n,e){return n.length?e.length?n.concat(e):n:e}const wn=[],Ez=200;function qD(n,e){if(n.length){let t=n[n.length-1],i=t.selectionsAfter.slice(Math.max(0,t.selectionsAfter.length-Ez));return i.length&&i[i.length-1].eq(e)?n:(i.push(e),Of(n,n.length-1,1e9,t.setSelAfter(i)))}else return[Xi.selection([e])]}function Az(n){let e=n[n.length-1],t=n.slice();return t[n.length-1]=e.setSelAfter(e.selectionsAfter.slice(0,e.selectionsAfter.length-1)),t}function lg(n,e){if(!n.length)return n;let t=n.length,i=wn;for(;t;){let s=Pz(n[t-1],e,i);if(s.changes&&!s.changes.empty||s.effects.length){let r=n.slice(0,t);return r[t-1]=s,r}else e=s.mapped,t--,i=s.selectionsAfter}return i.length?[Xi.selection(i)]:wn}function Pz(n,e,t){let i=UD(n.selectionsAfter.length?n.selectionsAfter.map(a=>a.map(e)):wn,t);if(!n.changes)return Xi.selection(i);let s=n.changes.map(e),r=e.mapDesc(n.changes,!0),o=n.mapped?n.mapped.composeDesc(r):r;return new Xi(s,Ue.mapEffects(n.effects,e),o,n.startSelection.map(r),i)}const Dz=/^(input\.type|delete)($|\.)/;class Ts{constructor(e,t,i=0,s=void 0){this.done=e,this.undone=t,this.prevTime=i,this.prevUserEvent=s}isolate(){return this.prevTime?new Ts(this.done,this.undone):this}addChanges(e,t,i,s,r){let o=this.done,a=o[o.length-1];return a&&a.changes&&!a.changes.empty&&e.changes&&(!i||Dz.test(i))&&(!a.selectionsAfter.length&&t-this.prevTime<s&&kz(a.changes,e.changes)||i=="input.type.compose")?o=Of(o,o.length-1,r,new Xi(e.changes.compose(a.changes),UD(e.effects,a.effects),a.mapped,a.startSelection,wn)):o=Of(o,o.length,r,e),new Ts(o,wn,t,i)}addSelection(e,t,i,s){let r=this.done.length?this.done[this.done.length-1].selectionsAfter:wn;return r.length>0&&t-this.prevTime<s&&i==this.prevUserEvent&&i&&/^select($|\.)/.test(i)&&Cz(r[r.length-1],e)?this:new Ts(qD(this.done,e),this.undone,t,i)}addMapping(e){return new Ts(lg(this.done,e),lg(this.undone,e),this.prevTime,this.prevUserEvent)}pop(e,t,i){let s=e==0?this.done:this.undone;if(s.length==0)return null;let r=s[s.length-1];if(i&&r.selectionsAfter.length)return t.update({selection:r.selectionsAfter[r.selectionsAfter.length-1],annotations:qO.of({side:e,rest:Az(s)}),userEvent:e==0?"select.undo":"select.redo",scrollIntoView:!0});if(r.changes){let o=s.length==1?wn:s.slice(0,s.length-1);return r.mapped&&(o=lg(o,r.mapped)),t.update({changes:r.changes,selection:r.startSelection,effects:r.effects,annotations:qO.of({side:e,rest:o}),filter:!1,userEvent:e==0?"undo":"redo",scrollIntoView:!0})}else return null}}Ts.empty=new Ts(wn,wn);const Mz=[{key:"Mod-z",run:FD,preventDefault:!0},{key:"Mod-y",mac:"Mod-Shift-z",run:VD,preventDefault:!0},{key:"Mod-u",run:wz,preventDefault:!0},{key:"Alt-u",mac:"Mod-Shift-u",run:_z,preventDefault:!0}];function gl(n,e){return le.create(n.ranges.map(e),n.mainIndex)}function Ls(n,e){return n.update({selection:e,scrollIntoView:!0,userEvent:"select"})}function lr({state:n,dispatch:e},t){let i=gl(n.selection,t);return i.eq(n.selection)?!1:(e(Ls(n,i)),!0)}function Op(n,e){return le.cursor(e?n.to:n.from)}function zD(n,e){return lr(n,t=>t.empty?n.moveByChar(t,e):Op(t,e))}function In(n){return n.textDirectionAt(n.state.selection.main.head)==At.LTR}const jD=n=>zD(n,!In(n)),XD=n=>zD(n,In(n));function HD(n,e){return lr(n,t=>t.empty?n.moveByGroup(t,e):Op(t,e))}const Iz=n=>HD(n,!In(n)),Rz=n=>HD(n,In(n));function Lz(n,e,t){if(e.type.prop(t))return!0;let i=e.to-e.from;return i&&(i>2||/[^\s,.;:]/.test(n.sliceDoc(e.from,e.to)))||e.firstChild}function yp(n,e,t){let i=wi(n).resolveInner(e.head),s=t?Ze.closedBy:Ze.openedBy;for(let l=e.head;;){let h=t?i.childAfter(l):i.childBefore(l);if(!h)break;Lz(n,h,s)?i=h:l=t?h.to:h.from}let r=i.type.prop(s),o,a;return r&&(o=t?xs(n,i.from,1):xs(n,i.to,-1))&&o.matched?a=t?o.end.to:o.end.from:a=t?i.to:i.from,le.cursor(a,t?-1:1)}const $z=n=>lr(n,e=>yp(n.state,e,!In(n))),Qz=n=>lr(n,e=>yp(n.state,e,In(n)));function WD(n,e){return lr(n,t=>{if(!t.empty)return Op(t,e);let i=n.moveVertically(t,e);return i.head!=t.head?i:n.moveToLineBoundary(t,e)})}const ZD=n=>WD(n,!1),YD=n=>WD(n,!0);function GD(n,e){let{state:t}=n,i=gl(t.selection,a=>a.empty?n.moveVertically(a,e,Math.min(n.dom.clientHeight,innerHeight)):Op(a,e));if(i.eq(t.selection))return!1;let s=n.coordsAtPos(t.selection.main.head),r=n.scrollDOM.getBoundingClientRect(),o;return s&&s.top>r.top&&s.bottom<r.bottom&&s.top-r.top<=n.scrollDOM.scrollHeight-n.scrollDOM.scrollTop-n.scrollDOM.clientHeight&&(o=$e.scrollIntoView(i.main.head,{y:"start",yMargin:s.top-r.top})),n.dispatch(Ls(t,i),{effects:o}),!0}const ew=n=>GD(n,!1),zO=n=>GD(n,!0);function bp(n,e,t){let i=n.lineBlockAt(e.head),s=n.moveToLineBoundary(e,t);if(s.head==e.head&&s.head!=(t?i.to:i.from)&&(s=n.moveToLineBoundary(e,t,!1)),!t&&s.head==i.from&&i.length){let r=/^\s*/.exec(n.state.sliceDoc(i.from,Math.min(i.from+100,i.to)))[0].length;r&&e.head!=i.from+r&&(s=le.cursor(i.from+r))}return s}const tw=n=>lr(n,e=>bp(n,e,!0)),iw=n=>lr(n,e=>bp(n,e,!1)),Bz=n=>lr(n,e=>le.cursor(n.lineBlockAt(e.head).from,1)),Nz=n=>lr(n,e=>le.cursor(n.lineBlockAt(e.head).to,-1));function Fz(n,e,t){let i=!1,s=gl(n.selection,r=>{let o=xs(n,r.head,-1)||xs(n,r.head,1)||r.head>0&&xs(n,r.head-1,1)||r.head<n.doc.length&&xs(n,r.head+1,-1);if(!o||!o.end)return r;i=!0;let a=o.start.from==r.head?o.end.to:o.end.from;return le.cursor(a)});return i?(e(Ls(n,s)),!0):!1}const Vz=({state:n,dispatch:e})=>Fz(n,e);function $s(n,e){let t=gl(n.state.selection,i=>{let s=e(i);return le.range(i.anchor,s.head,s.goalColumn)});return t.eq(n.state.selection)?!1:(n.dispatch(Ls(n.state,t)),!0)}function KD(n,e){return $s(n,t=>n.moveByChar(t,e))}const JD=n=>KD(n,!In(n)),eM=n=>KD(n,In(n));function tM(n,e){return $s(n,t=>n.moveByGroup(t,e))}const Uz=n=>tM(n,!In(n)),qz=n=>tM(n,In(n)),zz=n=>$s(n,e=>yp(n.state,e,!In(n))),jz=n=>$s(n,e=>yp(n.state,e,In(n)));function iM(n,e){return $s(n,t=>n.moveVertically(t,e))}const nM=n=>iM(n,!1),sM=n=>iM(n,!0);function rM(n,e){return $s(n,t=>n.moveVertically(t,e,Math.min(n.dom.clientHeight,innerHeight)))}const nw=n=>rM(n,!1),sw=n=>rM(n,!0),rw=n=>$s(n,e=>bp(n,e,!0)),ow=n=>$s(n,e=>bp(n,e,!1)),Xz=n=>$s(n,e=>le.cursor(n.lineBlockAt(e.head).from)),Hz=n=>$s(n,e=>le.cursor(n.lineBlockAt(e.head).to)),aw=({state:n,dispatch:e})=>(e(Ls(n,{anchor:0})),!0),lw=({state:n,dispatch:e})=>(e(Ls(n,{anchor:n.doc.length})),!0),hw=({state:n,dispatch:e})=>(e(Ls(n,{anchor:n.selection.main.anchor,head:0})),!0),uw=({state:n,dispatch:e})=>(e(Ls(n,{anchor:n.selection.main.anchor,head:n.doc.length})),!0),Wz=({state:n,dispatch:e})=>(e(n.update({selection:{anchor:0,head:n.doc.length},userEvent:"select"})),!0),Zz=({state:n,dispatch:e})=>{let t=xp(n).map(({from:i,to:s})=>le.range(i,Math.min(s+1,n.doc.length)));return e(n.update({selection:le.create(t),userEvent:"select"})),!0},Yz=({state:n,dispatch:e})=>{let t=gl(n.selection,i=>{var s;let r=wi(n).resolveInner(i.head,1);for(;!(r.from<i.from&&r.to>=i.to||r.to>i.to&&r.from<=i.from||!(!((s=r.parent)===null||s===void 0)&&s.parent));)r=r.parent;return le.range(r.to,r.from)});return e(Ls(n,t)),!0},Gz=({state:n,dispatch:e})=>{let t=n.selection,i=null;return t.ranges.length>1?i=le.create([t.main]):t.main.empty||(i=le.create([le.cursor(t.main.head)])),i?(e(Ls(n,i)),!0):!1};function vp({state:n,dispatch:e},t){if(n.readOnly)return!1;let i="delete.selection",s=n.changeByRange(r=>{let{from:o,to:a}=r;if(o==a){let l=t(o);l<o?i="delete.backward":l>o&&(i="delete.forward"),o=Math.min(o,l),a=Math.max(a,l)}return o==a?{range:r}:{changes:{from:o,to:a},range:le.cursor(o)}});return s.changes.empty?!1:(e(n.update(s,{scrollIntoView:!0,userEvent:i})),!0)}function Sp(n,e,t){if(n instanceof $e)for(let i of n.state.facet($e.atomicRanges).map(s=>s(n)))i.between(e,e,(s,r)=>{s<e&&r>e&&(e=t?r:s)});return e}const oM=(n,e)=>vp(n,t=>{let{state:i}=n,s=i.doc.lineAt(t),r,o;if(!e&&t>s.from&&t<s.from+200&&!/[^ \t]/.test(r=s.text.slice(0,t-s.from))){if(r[r.length-1]=="	")return t-1;let a=Au(r,i.tabSize),l=a%pf(i)||pf(i);for(let h=0;h<l&&r[r.length-1-h]==" ";h++)t--;o=t}else o=an(s.text,t-s.from,e,e)+s.from,o==t&&s.number!=(e?i.doc.lines:1)&&(o+=e?1:-1);return Sp(n,o,e)}),jO=n=>oM(n,!1),aM=n=>oM(n,!0),lM=(n,e)=>vp(n,t=>{let i=t,{state:s}=n,r=s.doc.lineAt(i),o=s.charCategorizer(i);for(let a=null;;){if(i==(e?r.to:r.from)){i==t&&r.number!=(e?s.doc.lines:1)&&(i+=e?1:-1);break}let l=an(r.text,i-r.from,e)+r.from,h=r.text.slice(Math.min(i,l)-r.from,Math.max(i,l)-r.from),u=o(h);if(a!=null&&u!=a)break;(h!=" "||i!=t)&&(a=u),i=l}return Sp(n,i,e)}),hM=n=>lM(n,!1),Kz=n=>lM(n,!0),uM=n=>vp(n,e=>{let t=n.lineBlockAt(e).to;return Sp(n,e<t?t:Math.min(n.state.doc.length,e+1),!0)}),Jz=n=>vp(n,e=>{let t=n.lineBlockAt(e).from;return Sp(n,e>t?t:Math.max(0,e-1),!1)}),ej=({state:n,dispatch:e})=>{if(n.readOnly)return!1;let t=n.changeByRange(i=>({changes:{from:i.from,to:i.to,insert:nt.of(["",""])},range:le.cursor(i.from)}));return e(n.update(t,{scrollIntoView:!0,userEvent:"input"})),!0},tj=({state:n,dispatch:e})=>{if(n.readOnly)return!1;let t=n.changeByRange(i=>{if(!i.empty||i.from==0||i.from==n.doc.length)return{range:i};let s=i.from,r=n.doc.lineAt(s),o=s==r.from?s-1:an(r.text,s-r.from,!1)+r.from,a=s==r.to?s+1:an(r.text,s-r.from,!0)+r.from;return{changes:{from:o,to:a,insert:n.doc.slice(s,a).append(n.doc.slice(o,s))},range:le.cursor(a)}});return t.changes.empty?!1:(e(n.update(t,{scrollIntoView:!0,userEvent:"move.character"})),!0)};function xp(n){let e=[],t=-1;for(let i of n.selection.ranges){let s=n.doc.lineAt(i.from),r=n.doc.lineAt(i.to);if(!i.empty&&i.to==r.from&&(r=n.doc.lineAt(i.to-1)),t>=s.number){let o=e[e.length-1];o.to=r.to,o.ranges.push(i)}else e.push({from:s.from,to:r.to,ranges:[i]});t=r.number+1}return e}function cM(n,e,t){if(n.readOnly)return!1;let i=[],s=[];for(let r of xp(n)){if(t?r.to==n.doc.length:r.from==0)continue;let o=n.doc.lineAt(t?r.to+1:r.from-1),a=o.length+1;if(t){i.push({from:r.to,to:o.to},{from:r.from,insert:o.text+n.lineBreak});for(let l of r.ranges)s.push(le.range(Math.min(n.doc.length,l.anchor+a),Math.min(n.doc.length,l.head+a)))}else{i.push({from:o.from,to:r.from},{from:r.to,insert:n.lineBreak+o.text});for(let l of r.ranges)s.push(le.range(l.anchor-a,l.head-a))}}return i.length?(e(n.update({changes:i,scrollIntoView:!0,selection:le.create(s,n.selection.mainIndex),userEvent:"move.line"})),!0):!1}const ij=({state:n,dispatch:e})=>cM(n,e,!1),nj=({state:n,dispatch:e})=>cM(n,e,!0);function dM(n,e,t){if(n.readOnly)return!1;let i=[];for(let s of xp(n))t?i.push({from:s.from,insert:n.doc.slice(s.from,s.to)+n.lineBreak}):i.push({from:s.to,insert:n.lineBreak+n.doc.slice(s.from,s.to)});return e(n.update({changes:i,scrollIntoView:!0,userEvent:"input.copyline"})),!0}const sj=({state:n,dispatch:e})=>dM(n,e,!1),rj=({state:n,dispatch:e})=>dM(n,e,!0),oj=n=>{if(n.state.readOnly)return!1;let{state:e}=n,t=e.changes(xp(e).map(({from:s,to:r})=>(s>0?s--:r<e.doc.length&&r++,{from:s,to:r}))),i=gl(e.selection,s=>n.moveVertically(s,!0)).map(t);return n.dispatch({changes:t,selection:i,scrollIntoView:!0,userEvent:"delete.line"}),!0};function aj(n,e){if(/\(\)|\[\]|\{\}/.test(n.sliceDoc(e-1,e+1)))return{from:e,to:e};let t=wi(n).resolveInner(e),i=t.childBefore(e),s=t.childAfter(e),r;return i&&s&&i.to<=e&&s.from>=e&&(r=i.type.prop(Ze.closedBy))&&r.indexOf(s.name)>-1&&n.doc.lineAt(i.to).from==n.doc.lineAt(s.from).from?{from:i.to,to:s.from}:null}const lj=fM(!1),hj=fM(!0);function fM(n){return({state:e,dispatch:t})=>{if(e.readOnly)return!1;let i=e.changeByRange(s=>{let{from:r,to:o}=s,a=e.doc.lineAt(r),l=!n&&r==o&&aj(e,r);n&&(r=o=(o<=a.to?a:e.doc.lineAt(o)).to);let h=new pp(e,{simulateBreak:r,simulateDoubleBreak:!!l}),u=$b(h,r);for(u==null&&(u=/^\s*/.exec(e.doc.lineAt(r).text)[0].length);o<a.to&&/\s/.test(a.text[o-a.from]);)o++;l?{from:r,to:o}=l:r>a.from&&r<a.from+100&&!/\S/.test(a.text.slice(0,r))&&(r=a.from);let c=["",ru(e,u)];return l&&c.push(ru(e,h.lineIndent(a.from,-1))),{changes:{from:r,to:o,insert:nt.of(c)},range:le.cursor(r+1+c[1].length)}});return t(e.update(i,{scrollIntoView:!0,userEvent:"input"})),!0}}function Fb(n,e){let t=-1;return n.changeByRange(i=>{let s=[];for(let o=i.from;o<=i.to;){let a=n.doc.lineAt(o);a.number>t&&(i.empty||i.to>a.from)&&(e(a,s,i),t=a.number),o=a.to+1}let r=n.changes(s);return{changes:s,range:le.range(r.mapPos(i.anchor,1),r.mapPos(i.head,1))}})}const uj=({state:n,dispatch:e})=>{if(n.readOnly)return!1;let t=Object.create(null),i=new pp(n,{overrideIndentation:r=>{let o=t[r];return o??-1}}),s=Fb(n,(r,o,a)=>{let l=$b(i,r.from);if(l==null)return;/\S/.test(r.text)||(l=0);let h=/^\s*/.exec(r.text)[0],u=ru(n,l);(h!=u||a.from<r.from+h.length)&&(t[r.from]=l,o.push({from:r.from,to:r.from+h.length,insert:u}))});return s.changes.empty||e(n.update(s,{userEvent:"indent"})),!0},cj=({state:n,dispatch:e})=>n.readOnly?!1:(e(n.update(Fb(n,(t,i)=>{i.push({from:t.from,insert:n.facet(Lb)})}),{userEvent:"input.indent"})),!0),dj=({state:n,dispatch:e})=>n.readOnly?!1:(e(n.update(Fb(n,(t,i)=>{let s=/^\s*/.exec(t.text)[0];if(!s)return;let r=Au(s,n.tabSize),o=0,a=ru(n,Math.max(0,r-pf(n)));for(;o<s.length&&o<a.length&&s.charCodeAt(o)==a.charCodeAt(o);)o++;i.push({from:t.from+o,to:t.from+s.length,insert:a.slice(o)})}),{userEvent:"delete.dedent"})),!0),fj=[{key:"Ctrl-b",run:jD,shift:JD,preventDefault:!0},{key:"Ctrl-f",run:XD,shift:eM},{key:"Ctrl-p",run:ZD,shift:nM},{key:"Ctrl-n",run:YD,shift:sM},{key:"Ctrl-a",run:Bz,shift:Xz},{key:"Ctrl-e",run:Nz,shift:Hz},{key:"Ctrl-d",run:aM},{key:"Ctrl-h",run:jO},{key:"Ctrl-k",run:uM},{key:"Ctrl-Alt-h",run:hM},{key:"Ctrl-o",run:ej},{key:"Ctrl-t",run:tj},{key:"Ctrl-v",run:zO}],pj=[{key:"ArrowLeft",run:jD,shift:JD,preventDefault:!0},{key:"Mod-ArrowLeft",mac:"Alt-ArrowLeft",run:Iz,shift:Uz},{mac:"Cmd-ArrowLeft",run:iw,shift:ow},{key:"ArrowRight",run:XD,shift:eM,preventDefault:!0},{key:"Mod-ArrowRight",mac:"Alt-ArrowRight",run:Rz,shift:qz},{mac:"Cmd-ArrowRight",run:tw,shift:rw},{key:"ArrowUp",run:ZD,shift:nM,preventDefault:!0},{mac:"Cmd-ArrowUp",run:aw,shift:hw},{mac:"Ctrl-ArrowUp",run:ew,shift:nw},{key:"ArrowDown",run:YD,shift:sM,preventDefault:!0},{mac:"Cmd-ArrowDown",run:lw,shift:uw},{mac:"Ctrl-ArrowDown",run:zO,shift:sw},{key:"PageUp",run:ew,shift:nw},{key:"PageDown",run:zO,shift:sw},{key:"Home",run:iw,shift:ow,preventDefault:!0},{key:"Mod-Home",run:aw,shift:hw},{key:"End",run:tw,shift:rw,preventDefault:!0},{key:"Mod-End",run:lw,shift:uw},{key:"Enter",run:lj},{key:"Mod-a",run:Wz},{key:"Backspace",run:jO,shift:jO},{key:"Delete",run:aM},{key:"Mod-Backspace",mac:"Alt-Backspace",run:hM},{key:"Mod-Delete",mac:"Alt-Delete",run:Kz},{mac:"Mod-Backspace",run:Jz},{mac:"Mod-Delete",run:uM}].concat(fj.map(n=>({mac:n.key,run:n.run,shift:n.shift}))),mj=[{key:"Alt-ArrowLeft",mac:"Ctrl-ArrowLeft",run:$z,shift:zz},{key:"Alt-ArrowRight",mac:"Ctrl-ArrowRight",run:Qz,shift:jz},{key:"Alt-ArrowUp",run:ij},{key:"Shift-Alt-ArrowUp",run:sj},{key:"Alt-ArrowDown",run:nj},{key:"Shift-Alt-ArrowDown",run:rj},{key:"Escape",run:Gz},{key:"Mod-Enter",run:hj},{key:"Alt-l",mac:"Ctrl-l",run:Zz},{key:"Mod-i",run:Yz,preventDefault:!0},{key:"Mod-[",run:dj},{key:"Mod-]",run:cj},{key:"Mod-Alt-\\",run:uj},{key:"Shift-Mod-k",run:oj},{key:"Shift-Mod-\\",run:Vz},{key:"Mod-/",run:fz},{key:"Alt-A",run:mz}].concat(pj),cw=typeof String.prototype.normalize=="function"?n=>n.normalize("NFKD"):n=>n;class Ka{constructor(e,t,i=0,s=e.length,r){this.value={from:0,to:0},this.done=!1,this.matches=[],this.buffer="",this.bufferPos=0,this.iter=e.iterRange(i,s),this.bufferStart=i,this.normalize=r?o=>r(cw(o)):cw,this.query=this.normalize(t)}peek(){if(this.bufferPos==this.buffer.length){if(this.bufferStart+=this.buffer.length,this.iter.next(),this.iter.done)return-1;this.bufferPos=0,this.buffer=this.iter.value}return gi(this.buffer,this.bufferPos)}next(){for(;this.matches.length;)this.matches.pop();return this.nextOverlapping()}nextOverlapping(){for(;;){let e=this.peek();if(e<0)return this.done=!0,this;let t=Sb(e),i=this.bufferStart+this.bufferPos;this.bufferPos+=Sn(e);let s=this.normalize(t);for(let r=0,o=i;;r++){let a=s.charCodeAt(r),l=this.match(a,o);if(l)return this.value=l,this;if(r==s.length-1)break;o==i&&r<t.length&&t.charCodeAt(r)==a&&o++}}}match(e,t){let i=null;for(let s=0;s<this.matches.length;s+=2){let r=this.matches[s],o=!1;this.query.charCodeAt(r)==e&&(r==this.query.length-1?i={from:this.matches[s+1],to:t+1}:(this.matches[s]++,o=!0)),o||(this.matches.splice(s,2),s-=2)}return this.query.charCodeAt(0)==e&&(this.query.length==1?i={from:t,to:t+1}:this.matches.push(1,t)),i}}typeof Symbol<"u"&&(Ka.prototype[Symbol.iterator]=function(){return this});const pM={from:-1,to:-1,match:/.*/.exec("")},Vb="gm"+(/x/.unicode==null?"":"u");class mM{constructor(e,t,i,s=0,r=e.length){if(this.to=r,this.curLine="",this.done=!1,this.value=pM,/\\[sWDnr]|\n|\r|\[\^/.test(t))return new gM(e,t,i,s,r);this.re=new RegExp(t,Vb+(i?.ignoreCase?"i":"")),this.iter=e.iter();let o=e.lineAt(s);this.curLineStart=o.from,this.matchPos=s,this.getLine(this.curLineStart)}getLine(e){this.iter.next(e),this.iter.lineBreak?this.curLine="":(this.curLine=this.iter.value,this.curLineStart+this.curLine.length>this.to&&(this.curLine=this.curLine.slice(0,this.to-this.curLineStart)),this.iter.next())}nextLine(){this.curLineStart=this.curLineStart+this.curLine.length+1,this.curLineStart>this.to?this.curLine="":this.getLine(0)}next(){for(let e=this.matchPos-this.curLineStart;;){this.re.lastIndex=e;let t=this.matchPos<=this.to&&this.re.exec(this.curLine);if(t){let i=this.curLineStart+t.index,s=i+t[0].length;if(this.matchPos=s+(i==s?1:0),i==this.curLine.length&&this.nextLine(),i<s||i>this.value.to)return this.value={from:i,to:s,match:t},this;e=this.matchPos-this.curLineStart}else if(this.curLineStart+this.curLine.length<this.to)this.nextLine(),e=0;else return this.done=!0,this}}}const hg=new WeakMap;class Ma{constructor(e,t){this.from=e,this.text=t}get to(){return this.from+this.text.length}static get(e,t,i){let s=hg.get(e);if(!s||s.from>=i||s.to<=t){let a=new Ma(t,e.sliceString(t,i));return hg.set(e,a),a}if(s.from==t&&s.to==i)return s;let{text:r,from:o}=s;return o>t&&(r=e.sliceString(t,o)+r,o=t),s.to<i&&(r+=e.sliceString(s.to,i)),hg.set(e,new Ma(o,r)),new Ma(t,r.slice(t-o,i-o))}}class gM{constructor(e,t,i,s,r){this.text=e,this.to=r,this.done=!1,this.value=pM,this.matchPos=s,this.re=new RegExp(t,Vb+(i?.ignoreCase?"i":"")),this.flat=Ma.get(e,s,this.chunkEnd(s+5e3))}chunkEnd(e){return e>=this.to?this.to:this.text.lineAt(e).to}next(){for(;;){let e=this.re.lastIndex=this.matchPos-this.flat.from,t=this.re.exec(this.flat.text);if(t&&!t[0]&&t.index==e&&(this.re.lastIndex=e+1,t=this.re.exec(this.flat.text)),t&&this.flat.to<this.to&&t.index+t[0].length>this.flat.text.length-10&&(t=null),t){let i=this.flat.from+t.index,s=i+t[0].length;return this.value={from:i,to:s,match:t},this.matchPos=s+(i==s?1:0),this}else{if(this.flat.to==this.to)return this.done=!0,this;this.flat=Ma.get(this.text,this.flat.from,this.chunkEnd(this.flat.from+this.flat.text.length*2))}}}}typeof Symbol<"u"&&(mM.prototype[Symbol.iterator]=gM.prototype[Symbol.iterator]=function(){return this});function gj(n){try{return new RegExp(n,Vb),!0}catch{return!1}}function XO(n){let e=xt("input",{class:"cm-textfield",name:"line"}),t=xt("form",{class:"cm-gotoLine",onkeydown:s=>{s.keyCode==27?(s.preventDefault(),n.dispatch({effects:yf.of(!1)}),n.focus()):s.keyCode==13&&(s.preventDefault(),i())},onsubmit:s=>{s.preventDefault(),i()}},xt("label",n.state.phrase("Go to line"),": ",e)," ",xt("button",{class:"cm-button",type:"submit"},n.state.phrase("go")));function i(){let s=/^([+-])?(\d+)?(:\d+)?(%)?$/.exec(e.value);if(!s)return;let{state:r}=n,o=r.doc.lineAt(r.selection.main.head),[,a,l,h,u]=s,c=h?+h.slice(1):0,f=l?+l:o.number;if(l&&u){let b=f/100;a&&(b=b*(a=="-"?-1:1)+o.number/r.doc.lines),f=Math.round(r.doc.lines*b)}else l&&a&&(f=f*(a=="-"?-1:1)+o.number);let p=r.doc.line(Math.max(1,Math.min(r.doc.lines,f)));n.dispatch({effects:yf.of(!1),selection:le.cursor(p.from+Math.max(0,Math.min(c,p.length))),scrollIntoView:!0}),n.focus()}return{dom:t}}const yf=Ue.define(),dw=ci.define({create(){return!0},update(n,e){for(let t of e.effects)t.is(yf)&&(n=t.value);return n},provide:n=>nu.from(n,e=>e?XO:null)}),Oj=n=>{let e=iu(n,XO);if(!e){let t=[yf.of(!0)];n.state.field(dw,!1)==null&&t.push(Ue.appendConfig.of([dw,yj])),n.dispatch({effects:t}),e=iu(n,XO)}return e&&e.dom.querySelector("input").focus(),!0},yj=$e.baseTheme({".cm-panel.cm-gotoLine":{padding:"2px 6px 4px","& label":{fontSize:"80%"}}}),bj={highlightWordAroundCursor:!1,minSelectionLength:1,maxMatches:100,wholeWords:!1},vj=Ce.define({combine(n){return ar(n,bj,{highlightWordAroundCursor:(e,t)=>e||t,minSelectionLength:Math.min,maxMatches:Math.min})}});function Sj(n){return[kj,_j]}const xj=Ie.mark({class:"cm-selectionMatch"}),Tj=Ie.mark({class:"cm-selectionMatch cm-selectionMatch-main"});function fw(n,e,t,i){return(t==0||n(e.sliceDoc(t-1,t))!=$i.Word)&&(i==e.doc.length||n(e.sliceDoc(i,i+1))!=$i.Word)}function wj(n,e,t,i){return n(e.sliceDoc(t,t+1))==$i.Word&&n(e.sliceDoc(i-1,i))==$i.Word}const _j=Xt.fromClass(class{constructor(n){this.decorations=this.getDeco(n)}update(n){(n.selectionSet||n.docChanged||n.viewportChanged)&&(this.decorations=this.getDeco(n.view))}getDeco(n){let e=n.state.facet(vj),{state:t}=n,i=t.selection;if(i.ranges.length>1)return Ie.none;let s=i.main,r,o=null;if(s.empty){if(!e.highlightWordAroundCursor)return Ie.none;let l=t.wordAt(s.head);if(!l)return Ie.none;o=t.charCategorizer(s.head),r=t.sliceDoc(l.from,l.to)}else{let l=s.to-s.from;if(l<e.minSelectionLength||l>200)return Ie.none;if(e.wholeWords){if(r=t.sliceDoc(s.from,s.to),o=t.charCategorizer(s.head),!(fw(o,t,s.from,s.to)&&wj(o,t,s.from,s.to)))return Ie.none}else if(r=t.sliceDoc(s.from,s.to).trim(),!r)return Ie.none}let a=[];for(let l of n.visibleRanges){let h=new Ka(t.doc,r,l.from,l.to);for(;!h.next().done;){let{from:u,to:c}=h.value;if((!o||fw(o,t,u,c))&&(s.empty&&u<=s.from&&c>=s.to?a.push(Tj.range(u,c)):(u>=s.to||c<=s.from)&&a.push(xj.range(u,c)),a.length>e.maxMatches))return Ie.none}}return Ie.set(a)}},{decorations:n=>n.decorations}),kj=$e.baseTheme({".cm-selectionMatch":{backgroundColor:"#99ff7780"},".cm-searchMatch .cm-selectionMatch":{backgroundColor:"transparent"}}),Cj=({state:n,dispatch:e})=>{let{selection:t}=n,i=le.create(t.ranges.map(s=>n.wordAt(s.head)||le.cursor(s.head)),t.mainIndex);return i.eq(t)?!1:(e(n.update({selection:i})),!0)};function Ej(n,e){let{main:t,ranges:i}=n.selection,s=n.wordAt(t.head),r=s&&s.from==t.from&&s.to==t.to;for(let o=!1,a=new Ka(n.doc,e,i[i.length-1].to);;)if(a.next(),a.done){if(o)return null;a=new Ka(n.doc,e,0,Math.max(0,i[i.length-1].from-1)),o=!0}else{if(o&&i.some(l=>l.from==a.value.from))continue;if(r){let l=n.wordAt(a.value.from);if(!l||l.from!=a.value.from||l.to!=a.value.to)continue}return a.value}}const Aj=({state:n,dispatch:e})=>{let{ranges:t}=n.selection;if(t.some(r=>r.from===r.to))return Cj({state:n,dispatch:e});let i=n.sliceDoc(t[0].from,t[0].to);if(n.selection.ranges.some(r=>n.sliceDoc(r.from,r.to)!=i))return!1;let s=Ej(n,i);return s?(e(n.update({selection:n.selection.addRange(le.range(s.from,s.to),!1),effects:$e.scrollIntoView(s.to)})),!0):!1},Ub=Ce.define({combine(n){var e;return{top:n.reduce((t,i)=>t??i.top,void 0)||!1,caseSensitive:n.reduce((t,i)=>t??i.caseSensitive,void 0)||!1,createPanel:((e=n.find(t=>t.createPanel))===null||e===void 0?void 0:e.createPanel)||(t=>new Nj(t))}}});class OM{constructor(e){this.search=e.search,this.caseSensitive=!!e.caseSensitive,this.regexp=!!e.regexp,this.replace=e.replace||"",this.valid=!!this.search&&(!this.regexp||gj(this.search)),this.unquoted=e.literal?this.search:this.search.replace(/\\([nrt\\])/g,(t,i)=>i=="n"?`
`:i=="r"?"\r":i=="t"?"	":"\\")}eq(e){return this.search==e.search&&this.replace==e.replace&&this.caseSensitive==e.caseSensitive&&this.regexp==e.regexp}create(){return this.regexp?new Dj(this):new Pj(this)}getCursor(e,t=0,i=e.length){return this.regexp?na(this,e,t,i):ia(this,e,t,i)}}class yM{constructor(e){this.spec=e}}function ia(n,e,t,i){return new Ka(e,n.unquoted,t,i,n.caseSensitive?void 0:s=>s.toLowerCase())}class Pj extends yM{constructor(e){super(e)}nextMatch(e,t,i){let s=ia(this.spec,e,i,e.length).nextOverlapping();return s.done&&(s=ia(this.spec,e,0,t).nextOverlapping()),s.done?null:s.value}prevMatchInRange(e,t,i){for(let s=i;;){let r=Math.max(t,s-1e4-this.spec.unquoted.length),o=ia(this.spec,e,r,s),a=null;for(;!o.nextOverlapping().done;)a=o.value;if(a)return a;if(r==t)return null;s-=1e4}}prevMatch(e,t,i){return this.prevMatchInRange(e,0,t)||this.prevMatchInRange(e,i,e.length)}getReplacement(e){return this.spec.replace}matchAll(e,t){let i=ia(this.spec,e,0,e.length),s=[];for(;!i.next().done;){if(s.length>=t)return null;s.push(i.value)}return s}highlight(e,t,i,s){let r=ia(this.spec,e,Math.max(0,t-this.spec.unquoted.length),Math.min(i+this.spec.unquoted.length,e.length));for(;!r.next().done;)s(r.value.from,r.value.to)}}function na(n,e,t,i){return new mM(e,n.search,n.caseSensitive?void 0:{ignoreCase:!0},t,i)}class Dj extends yM{nextMatch(e,t,i){let s=na(this.spec,e,i,e.length).next();return s.done&&(s=na(this.spec,e,0,t).next()),s.done?null:s.value}prevMatchInRange(e,t,i){for(let s=1;;s++){let r=Math.max(t,i-s*1e4),o=na(this.spec,e,r,i),a=null;for(;!o.next().done;)a=o.value;if(a&&(r==t||a.from>r+10))return a;if(r==t)return null}}prevMatch(e,t,i){return this.prevMatchInRange(e,0,t)||this.prevMatchInRange(e,i,e.length)}getReplacement(e){return this.spec.replace.replace(/\$([$&\d+])/g,(t,i)=>i=="$"?"$":i=="&"?e.match[0]:i!="0"&&+i<e.match.length?e.match[i]:t)}matchAll(e,t){let i=na(this.spec,e,0,e.length),s=[];for(;!i.next().done;){if(s.length>=t)return null;s.push(i.value)}return s}highlight(e,t,i,s){let r=na(this.spec,e,Math.max(0,t-250),Math.min(i+250,e.length));for(;!r.next().done;)s(r.value.from,r.value.to)}}const ou=Ue.define(),qb=Ue.define(),Br=ci.define({create(n){return new ug(HO(n).create(),null)},update(n,e){for(let t of e.effects)t.is(ou)?n=new ug(t.value.create(),n.panel):t.is(qb)&&(n=new ug(n.query,t.value?zb:null));return n},provide:n=>nu.from(n,e=>e.panel)});class ug{constructor(e,t){this.query=e,this.panel=t}}const Mj=Ie.mark({class:"cm-searchMatch"}),Ij=Ie.mark({class:"cm-searchMatch cm-searchMatch-selected"}),Rj=Xt.fromClass(class{constructor(n){this.view=n,this.decorations=this.highlight(n.state.field(Br))}update(n){let e=n.state.field(Br);(e!=n.startState.field(Br)||n.docChanged||n.selectionSet||n.viewportChanged)&&(this.decorations=this.highlight(e))}highlight({query:n,panel:e}){if(!e||!n.spec.valid)return Ie.none;let{view:t}=this,i=new zr;for(let s=0,r=t.visibleRanges,o=r.length;s<o;s++){let{from:a,to:l}=r[s];for(;s<o-1&&l>r[s+1].from-500;)l=r[++s].to;n.highlight(t.state.doc,a,l,(h,u)=>{let c=t.state.selection.ranges.some(f=>f.from==h&&f.to==u);i.add(h,u,c?Ij:Mj)})}return i.finish()}},{decorations:n=>n.decorations});function Ru(n){return e=>{let t=e.state.field(Br,!1);return t&&t.query.spec.valid?n(e,t):bM(e)}}const bf=Ru((n,{query:e})=>{let{from:t,to:i}=n.state.selection.main,s=e.nextMatch(n.state.doc,t,i);return!s||s.from==t&&s.to==i?!1:(n.dispatch({selection:{anchor:s.from,head:s.to},scrollIntoView:!0,effects:jb(n,s),userEvent:"select.search"}),!0)}),vf=Ru((n,{query:e})=>{let{state:t}=n,{from:i,to:s}=t.selection.main,r=e.prevMatch(t.doc,i,s);return r?(n.dispatch({selection:{anchor:r.from,head:r.to},scrollIntoView:!0,effects:jb(n,r),userEvent:"select.search"}),!0):!1}),Lj=Ru((n,{query:e})=>{let t=e.matchAll(n.state.doc,1e3);return!t||!t.length?!1:(n.dispatch({selection:le.create(t.map(i=>le.range(i.from,i.to))),userEvent:"select.search.matches"}),!0)}),$j=({state:n,dispatch:e})=>{let t=n.selection;if(t.ranges.length>1||t.main.empty)return!1;let{from:i,to:s}=t.main,r=[],o=0;for(let a=new Ka(n.doc,n.sliceDoc(i,s));!a.next().done;){if(r.length>1e3)return!1;a.value.from==i&&(o=r.length),r.push(le.range(a.value.from,a.value.to))}return e(n.update({selection:le.create(r,o),userEvent:"select.search.matches"})),!0},pw=Ru((n,{query:e})=>{let{state:t}=n,{from:i,to:s}=t.selection.main;if(t.readOnly)return!1;let r=e.nextMatch(t.doc,i,i);if(!r)return!1;let o=[],a,l;if(r.from==i&&r.to==s&&(l=t.toText(e.getReplacement(r)),o.push({from:r.from,to:r.to,insert:l}),r=e.nextMatch(t.doc,r.from,r.to)),r){let h=o.length==0||o[0].from>=r.to?0:r.to-r.from-l.length;a={anchor:r.from-h,head:r.to-h}}return n.dispatch({changes:o,selection:a,scrollIntoView:!!a,effects:r?jb(n,r):void 0,userEvent:"input.replace"}),!0}),Qj=Ru((n,{query:e})=>{if(n.state.readOnly)return!1;let t=e.matchAll(n.state.doc,1e9).map(i=>{let{from:s,to:r}=i;return{from:s,to:r,insert:e.getReplacement(i)}});return t.length?(n.dispatch({changes:t,userEvent:"input.replace.all"}),!0):!1});function zb(n){return n.state.facet(Ub).createPanel(n)}function HO(n,e){var t;let i=n.selection.main,s=i.empty||i.to>i.from+100?"":n.sliceDoc(i.from,i.to),r=(t=e?.caseSensitive)!==null&&t!==void 0?t:n.facet(Ub).caseSensitive;return e&&!s?e:new OM({search:s.replace(/\n/g,"\\n"),caseSensitive:r})}const bM=n=>{let e=n.state.field(Br,!1);if(e&&e.panel){let t=iu(n,zb);if(!t)return!1;let i=t.dom.querySelector("[name=search]");if(i!=n.root.activeElement){let s=HO(n.state,e.query.spec);s.valid&&n.dispatch({effects:ou.of(s)}),i.focus(),i.select()}}else n.dispatch({effects:[qb.of(!0),e?ou.of(HO(n.state,e.query.spec)):Ue.appendConfig.of(Vj)]});return!0},vM=n=>{let e=n.state.field(Br,!1);if(!e||!e.panel)return!1;let t=iu(n,zb);return t&&t.dom.contains(n.root.activeElement)&&n.focus(),n.dispatch({effects:qb.of(!1)}),!0},Bj=[{key:"Mod-f",run:bM,scope:"editor search-panel"},{key:"F3",run:bf,shift:vf,scope:"editor search-panel",preventDefault:!0},{key:"Mod-g",run:bf,shift:vf,scope:"editor search-panel",preventDefault:!0},{key:"Escape",run:vM,scope:"editor search-panel"},{key:"Mod-Shift-l",run:$j},{key:"Alt-g",run:Oj},{key:"Mod-d",run:Aj,preventDefault:!0}];class Nj{constructor(e){this.view=e;let t=this.query=e.state.field(Br).query.spec;this.commit=this.commit.bind(this),this.searchField=xt("input",{value:t.search,placeholder:yn(e,"Find"),"aria-label":yn(e,"Find"),class:"cm-textfield",name:"search",onchange:this.commit,onkeyup:this.commit}),this.replaceField=xt("input",{value:t.replace,placeholder:yn(e,"Replace"),"aria-label":yn(e,"Replace"),class:"cm-textfield",name:"replace",onchange:this.commit,onkeyup:this.commit}),this.caseField=xt("input",{type:"checkbox",name:"case",checked:t.caseSensitive,onchange:this.commit}),this.reField=xt("input",{type:"checkbox",name:"re",checked:t.regexp,onchange:this.commit});function i(s,r,o){return xt("button",{class:"cm-button",name:s,onclick:r,type:"button"},o)}this.dom=xt("div",{onkeydown:s=>this.keydown(s),class:"cm-search"},[this.searchField,i("next",()=>bf(e),[yn(e,"next")]),i("prev",()=>vf(e),[yn(e,"previous")]),i("select",()=>Lj(e),[yn(e,"all")]),xt("label",null,[this.caseField,yn(e,"match case")]),xt("label",null,[this.reField,yn(e,"regexp")]),...e.state.readOnly?[]:[xt("br"),this.replaceField,i("replace",()=>pw(e),[yn(e,"replace")]),i("replaceAll",()=>Qj(e),[yn(e,"replace all")]),xt("button",{name:"close",onclick:()=>vM(e),"aria-label":yn(e,"close"),type:"button"},["×"])]])}commit(){let e=new OM({search:this.searchField.value,caseSensitive:this.caseField.checked,regexp:this.reField.checked,replace:this.replaceField.value});e.eq(this.query)||(this.query=e,this.view.dispatch({effects:ou.of(e)}))}keydown(e){aU(this.view,e,"search-panel")?e.preventDefault():e.keyCode==13&&e.target==this.searchField?(e.preventDefault(),(e.shiftKey?vf:bf)(this.view)):e.keyCode==13&&e.target==this.replaceField&&(e.preventDefault(),pw(this.view))}update(e){for(let t of e.transactions)for(let i of t.effects)i.is(ou)&&!i.value.eq(this.query)&&this.setQuery(i.value)}setQuery(e){this.query=e,this.searchField.value=e.search,this.replaceField.value=e.replace,this.caseField.checked=e.caseSensitive,this.reField.checked=e.regexp}mount(){this.searchField.select()}get pos(){return 80}get top(){return this.view.state.facet(Ub).top}}function yn(n,e){return n.state.phrase(e)}const Vc=30,Uc=/[\s\.,:;?!]/;function jb(n,{from:e,to:t}){let i=n.state.doc.lineAt(e).from,s=n.state.doc.lineAt(t).to,r=Math.max(i,e-Vc),o=Math.min(s,t+Vc),a=n.state.sliceDoc(r,o);if(r!=i){for(let l=0;l<Vc;l++)if(!Uc.test(a[l+1])&&Uc.test(a[l])){a=a.slice(l);break}}if(o!=s){for(let l=a.length-1;l>a.length-Vc;l--)if(!Uc.test(a[l-1])&&Uc.test(a[l])){a=a.slice(0,l);break}}return $e.announce.of(`${n.state.phrase("current match")}. ${a} ${n.state.phrase("on line")} ${n.state.doc.lineAt(e).number}`)}const Fj=$e.baseTheme({".cm-panel.cm-search":{padding:"2px 6px 4px",position:"relative","& [name=close]":{position:"absolute",top:"0",right:"4px",backgroundColor:"inherit",border:"none",font:"inherit",padding:0,margin:0},"& input, & button, & label":{margin:".2em .6em .2em 0"},"& input[type=checkbox]":{marginRight:".2em"},"& label":{fontSize:"80%",whiteSpace:"pre"}},"&light .cm-searchMatch":{backgroundColor:"#ffff0054"},"&dark .cm-searchMatch":{backgroundColor:"#00ffff8a"},"&light .cm-searchMatch-selected":{backgroundColor:"#ff6a0054"},"&dark .cm-searchMatch-selected":{backgroundColor:"#ff00ff8a"}}),Vj=[Br,Eu.lowest(Rj),Fj];let SM=class{constructor(e,t,i){this.state=e,this.pos=t,this.explicit=i,this.abortListeners=[]}tokenBefore(e){let t=wi(this.state).resolveInner(this.pos,-1);for(;t&&e.indexOf(t.name)<0;)t=t.parent;return t?{from:t.from,to:this.pos,text:this.state.sliceDoc(t.from,this.pos),type:t.type}:null}matchBefore(e){let t=this.state.doc.lineAt(this.pos),i=Math.max(t.from,this.pos-250),s=t.text.slice(i-t.from,this.pos-t.from),r=s.search(xM(e,!1));return r<0?null:{from:i+r,to:this.pos,text:s.slice(r)}}get aborted(){return this.abortListeners==null}addEventListener(e,t){e=="abort"&&this.abortListeners&&this.abortListeners.push(t)}};function mw(n){let e=Object.keys(n).join(""),t=/\w/.test(e);return t&&(e=e.replace(/\w/g,"")),`[${t?"\\w":""}${e.replace(/[^\w\s]/g,"\\$&")}]`}function Uj(n){let e=Object.create(null),t=Object.create(null);for(let{label:s}of n){e[s[0]]=!0;for(let r=1;r<s.length;r++)t[s[r]]=!0}let i=mw(e)+mw(t)+"*$";return[new RegExp("^"+i),new RegExp(i)]}function qj(n){let e=n.map(s=>typeof s=="string"?{label:s}:s),[t,i]=e.every(s=>/^\w+$/.test(s.label))?[/\w*$/,/\w+$/]:Uj(e);return s=>{let r=s.matchBefore(i);return r||s.explicit?{from:r?r.from:s.pos,options:e,validFor:t}:null}}class gw{constructor(e,t,i){this.completion=e,this.source=t,this.match=i}}function Nr(n){return n.selection.main.head}function xM(n,e){var t;let{source:i}=n,s=e&&i[0]!="^",r=i[i.length-1]!="$";return!s&&!r?n:new RegExp(`${s?"^":""}(?:${i})${r?"$":""}`,(t=n.flags)!==null&&t!==void 0?t:n.ignoreCase?"i":"")}function zj(n,e,t,i){return Object.assign(Object.assign({},n.changeByRange(s=>{if(s==n.selection.main)return{changes:{from:t,to:i,insert:e},range:le.cursor(t+e.length)};let r=i-t;return!s.empty||r&&n.sliceDoc(s.from-r,s.from)!=n.sliceDoc(t,i)?{range:s}:{changes:{from:s.from-r,to:s.from,insert:e},range:le.cursor(s.from-r+e.length)}})),{userEvent:"input.complete"})}function TM(n,e){const t=e.completion.apply||e.completion.label;let i=e.source;typeof t=="string"?n.dispatch(zj(n.state,t,i.from,i.to)):t(n,e.completion,i.from,i.to)}const Ow=new WeakMap;function jj(n){if(!Array.isArray(n))return n;let e=Ow.get(n);return e||Ow.set(n,e=qj(n)),e}class Xj{constructor(e){this.pattern=e,this.chars=[],this.folded=[],this.any=[],this.precise=[],this.byWord=[];for(let t=0;t<e.length;){let i=gi(e,t),s=Sn(i);this.chars.push(i);let r=e.slice(t,t+s),o=r.toUpperCase();this.folded.push(gi(o==r?r.toLowerCase():o,0)),t+=s}this.astral=e.length!=this.chars.length}match(e){if(this.pattern.length==0)return[0];if(e.length<this.pattern.length)return null;let{chars:t,folded:i,any:s,precise:r,byWord:o}=this;if(t.length==1){let w=gi(e,0);return w==t[0]?[0,0,Sn(w)]:w==i[0]?[-200,0,Sn(w)]:null}let a=e.indexOf(this.pattern);if(a==0)return[0,0,this.pattern.length];let l=t.length,h=0;if(a<0){for(let w=0,v=Math.min(e.length,200);w<v&&h<l;){let S=gi(e,w);(S==t[h]||S==i[h])&&(s[h++]=w),w+=Sn(S)}if(h<l)return null}let u=0,c=0,f=!1,p=0,b=-1,y=-1,_=/[a-z]/.test(e),T=!0;for(let w=0,v=Math.min(e.length,200),S=0;w<v&&c<l;){let k=gi(e,w);a<0&&(u<l&&k==t[u]&&(r[u++]=w),p<l&&(k==t[p]||k==i[p]?(p==0&&(b=w),y=w+1,p++):p=0));let A,M=k<255?k>=48&&k<=57||k>=97&&k<=122?2:k>=65&&k<=90?1:0:(A=Sb(k))!=A.toLowerCase()?1:A!=A.toUpperCase()?2:0;(!w||M==1&&_||S==0&&M!=0)&&(t[c]==k||i[c]==k&&(f=!0)?o[c++]=w:o.length&&(T=!1)),S=M,w+=Sn(k)}return c==l&&o[0]==0&&T?this.result(-100+(f?-200:0),o,e):p==l&&b==0?[-200-e.length,0,y]:a>-1?[-700-e.length,a,a+this.pattern.length]:p==l?[-900-e.length,b,y]:c==l?this.result(-100+(f?-200:0)+-700+(T?0:-1100),o,e):t.length==2?null:this.result((s[0]?-700:0)+-200+-1100,s,e)}result(e,t,i){let s=[e-i.length],r=1;for(let o of t){let a=o+(this.astral?Sn(gi(i,o)):1);r>1&&s[r-1]==o?s[r-1]=a:(s[r++]=o,s[r++]=a)}return s}}const Hr=Ce.define({combine(n){return ar(n,{activateOnTyping:!0,override:null,closeOnBlur:!0,maxRenderedOptions:100,defaultKeymap:!0,optionClass:()=>"",aboveCursor:!1,icons:!0,addToOptions:[]},{defaultKeymap:(e,t)=>e&&t,closeOnBlur:(e,t)=>e&&t,icons:(e,t)=>e&&t,optionClass:(e,t)=>i=>Hj(e(i),t(i)),addToOptions:(e,t)=>e.concat(t)})}});function Hj(n,e){return n?e?n+" "+e:n:e}function Wj(n){let e=n.addToOptions.slice();return n.icons&&e.push({render(t){let i=document.createElement("div");return i.classList.add("cm-completionIcon"),t.type&&i.classList.add(...t.type.split(/\s+/g).map(s=>"cm-completionIcon-"+s)),i.setAttribute("aria-hidden","true"),i},position:20}),e.push({render(t,i,s){let r=document.createElement("span");r.className="cm-completionLabel";let{label:o}=t,a=0;for(let l=1;l<s.length;){let h=s[l++],u=s[l++];h>a&&r.appendChild(document.createTextNode(o.slice(a,h)));let c=r.appendChild(document.createElement("span"));c.appendChild(document.createTextNode(o.slice(h,u))),c.className="cm-completionMatchedText",a=u}return a<o.length&&r.appendChild(document.createTextNode(o.slice(a))),r},position:50},{render(t){if(!t.detail)return null;let i=document.createElement("span");return i.className="cm-completionDetail",i.textContent=t.detail,i},position:80}),e.sort((t,i)=>t.position-i.position).map(t=>t.render)}function yw(n,e,t){if(n<=t)return{from:0,to:n};if(e<=n>>1){let s=Math.floor(e/t);return{from:s*t,to:(s+1)*t}}let i=Math.floor((n-e)/t);return{from:n-(i+1)*t,to:n-i*t}}class Zj{constructor(e,t){this.view=e,this.stateField=t,this.info=null,this.placeInfo={read:()=>this.measureInfo(),write:a=>this.positionInfo(a),key:this};let i=e.state.field(t),{options:s,selected:r}=i.open,o=e.state.facet(Hr);this.optionContent=Wj(o),this.optionClass=o.optionClass,this.range=yw(s.length,r,o.maxRenderedOptions),this.dom=document.createElement("div"),this.dom.className="cm-tooltip-autocomplete",this.dom.addEventListener("mousedown",a=>{for(let l=a.target,h;l&&l!=this.dom;l=l.parentNode)if(l.nodeName=="LI"&&(h=/-(\d+)$/.exec(l.id))&&+h[1]<s.length){TM(e,s[+h[1]]),a.preventDefault();return}}),this.list=this.dom.appendChild(this.createListBox(s,i.id,this.range)),this.list.addEventListener("scroll",()=>{this.info&&this.view.requestMeasure(this.placeInfo)})}mount(){this.updateSel()}update(e){e.state.field(this.stateField)!=e.startState.field(this.stateField)&&this.updateSel()}positioned(){this.info&&this.view.requestMeasure(this.placeInfo)}updateSel(){let e=this.view.state.field(this.stateField),t=e.open;if((t.selected<this.range.from||t.selected>=this.range.to)&&(this.range=yw(t.options.length,t.selected,this.view.state.facet(Hr).maxRenderedOptions),this.list.remove(),this.list=this.dom.appendChild(this.createListBox(t.options,e.id,this.range)),this.list.addEventListener("scroll",()=>{this.info&&this.view.requestMeasure(this.placeInfo)})),this.updateSelectedOption(t.selected)){this.info&&(this.info.remove(),this.info=null);let{completion:i}=t.options[t.selected],{info:s}=i;if(!s)return;let r=typeof s=="string"?document.createTextNode(s):s(i);if(!r)return;"then"in r?r.then(o=>{o&&this.view.state.field(this.stateField,!1)==e&&this.addInfoPane(o)}).catch(o=>un(this.view.state,o,"completion info")):this.addInfoPane(r)}}addInfoPane(e){let t=this.info=document.createElement("div");t.className="cm-tooltip cm-completionInfo",t.appendChild(e),this.dom.appendChild(t),this.view.requestMeasure(this.placeInfo)}updateSelectedOption(e){let t=null;for(let i=this.list.firstChild,s=this.range.from;i;i=i.nextSibling,s++)s==e?i.hasAttribute("aria-selected")||(i.setAttribute("aria-selected","true"),t=i):i.hasAttribute("aria-selected")&&i.removeAttribute("aria-selected");return t&&Gj(this.list,t),t}measureInfo(){let e=this.dom.querySelector("[aria-selected]");if(!e||!this.info)return null;let t=this.dom.getBoundingClientRect(),i=this.info.getBoundingClientRect(),s=e.getBoundingClientRect();if(s.top>Math.min(innerHeight,t.bottom)-10||s.bottom<Math.max(0,t.top)+10)return null;let r=Math.max(0,Math.min(s.top,innerHeight-i.height))-t.top,o=this.view.textDirection==At.RTL,a=t.left,l=innerWidth-t.right;return o&&a<Math.min(i.width,l)?o=!1:!o&&l<Math.min(i.width,a)&&(o=!0),{top:r,left:o}}positionInfo(e){this.info&&(this.info.style.top=(e?e.top:-1e6)+"px",e&&(this.info.classList.toggle("cm-completionInfo-left",e.left),this.info.classList.toggle("cm-completionInfo-right",!e.left)))}createListBox(e,t,i){const s=document.createElement("ul");s.id=t,s.setAttribute("role","listbox"),s.setAttribute("aria-expanded","true"),s.setAttribute("aria-label",this.view.state.phrase("Completions"));for(let r=i.from;r<i.to;r++){let{completion:o,match:a}=e[r];const l=s.appendChild(document.createElement("li"));l.id=t+"-"+r,l.setAttribute("role","option");let h=this.optionClass(o);h&&(l.className=h);for(let u of this.optionContent){let c=u(o,this.view.state,a);c&&l.appendChild(c)}}return i.from&&s.classList.add("cm-completionListIncompleteTop"),i.to<e.length&&s.classList.add("cm-completionListIncompleteBottom"),s}}function Yj(n){return e=>new Zj(e,n)}function Gj(n,e){let t=n.getBoundingClientRect(),i=e.getBoundingClientRect();i.top<t.top?n.scrollTop-=t.top-i.top:i.bottom>t.bottom&&(n.scrollTop+=i.bottom-t.bottom)}function bw(n){return(n.boost||0)*100+(n.apply?10:0)+(n.info?5:0)+(n.type?1:0)}function Kj(n,e){let t=[],i=0;for(let o of n)if(o.hasResult())if(o.result.filter===!1){let a=o.result.getMatch;for(let l of o.result.options){let h=[1e9-i++];if(a)for(let u of a(l))h.push(u);t.push(new gw(l,o,h))}}else{let a=new Xj(e.sliceDoc(o.from,o.to)),l;for(let h of o.result.options)(l=a.match(h.label))&&(h.boost!=null&&(l[0]+=h.boost),t.push(new gw(h,o,l)))}let s=[],r=null;for(let o of t.sort(iX))!r||r.label!=o.completion.label||r.detail!=o.completion.detail||r.type!=null&&o.completion.type!=null&&r.type!=o.completion.type||r.apply!=o.completion.apply?s.push(o):bw(o.completion)>bw(r)&&(s[s.length-1]=o),r=o.completion;return s}class Ih{constructor(e,t,i,s,r){this.options=e,this.attrs=t,this.tooltip=i,this.timestamp=s,this.selected=r}setSelected(e,t){return e==this.selected||e>=this.options.length?this:new Ih(this.options,vw(t,e),this.tooltip,this.timestamp,e)}static build(e,t,i,s,r){let o=Kj(e,t);if(!o.length)return null;let a=0;if(s&&s.selected){let l=s.options[s.selected].completion;for(let h=0;h<o.length;h++)if(o[h].completion==l){a=h;break}}return new Ih(o,vw(i,a),{pos:e.reduce((l,h)=>h.hasResult()?Math.min(l,h.from):l,1e8),create:Yj(xn),above:r.aboveCursor},s?s.timestamp:Date.now(),a)}map(e){return new Ih(this.options,this.attrs,Object.assign(Object.assign({},this.tooltip),{pos:e.mapPos(this.tooltip.pos)}),this.timestamp,this.selected)}}class Sf{constructor(e,t,i){this.active=e,this.id=t,this.open=i}static start(){return new Sf(tX,"cm-ac-"+Math.floor(Math.random()*2e6).toString(36),null)}update(e){let{state:t}=e,i=t.facet(Hr),r=(i.override||t.languageDataAt("autocomplete",Nr(t)).map(jj)).map(a=>(this.active.find(h=>h.source==a)||new zi(a,this.active.some(h=>h.state!=0)?1:0)).update(e,i));r.length==this.active.length&&r.every((a,l)=>a==this.active[l])&&(r=this.active);let o=e.selection||r.some(a=>a.hasResult()&&e.changes.touchesRange(a.from,a.to))||!Jj(r,this.active)?Ih.build(r,t,this.id,this.open,i):this.open&&e.docChanged?this.open.map(e.changes):this.open;!o&&r.every(a=>a.state!=1)&&r.some(a=>a.hasResult())&&(r=r.map(a=>a.hasResult()?new zi(a.source,0):a));for(let a of e.effects)a.is(_M)&&(o=o&&o.setSelected(a.value,this.id));return r==this.active&&o==this.open?this:new Sf(r,this.id,o)}get tooltip(){return this.open?this.open.tooltip:null}get attrs(){return this.open?this.open.attrs:eX}}function Jj(n,e){if(n==e)return!0;for(let t=0,i=0;;){for(;t<n.length&&!n[t].hasResult;)t++;for(;i<e.length&&!e[i].hasResult;)i++;let s=t==n.length,r=i==e.length;if(s||r)return s==r;if(n[t++].result!=e[i++].result)return!1}}const eX={"aria-autocomplete":"list"};function vw(n,e){return{"aria-autocomplete":"list","aria-haspopup":"listbox","aria-activedescendant":n+"-"+e,"aria-controls":n}}const tX=[];function iX(n,e){let t=e.match[0]-n.match[0];return t||n.completion.label.localeCompare(e.completion.label)}function WO(n){return n.isUserEvent("input.type")?"input":n.isUserEvent("delete.backward")?"delete":null}class zi{constructor(e,t,i=-1){this.source=e,this.state=t,this.explicitPos=i}hasResult(){return!1}update(e,t){let i=WO(e),s=this;i?s=s.handleUserEvent(e,i,t):e.docChanged?s=s.handleChange(e):e.selection&&s.state!=0&&(s=new zi(s.source,0));for(let r of e.effects)if(r.is(Xb))s=new zi(s.source,1,r.value?Nr(e.state):-1);else if(r.is(xf))s=new zi(s.source,0);else if(r.is(wM))for(let o of r.value)o.source==s.source&&(s=o);return s}handleUserEvent(e,t,i){return t=="delete"||!i.activateOnTyping?this.map(e.changes):new zi(this.source,1)}handleChange(e){return e.changes.touchesRange(Nr(e.startState))?new zi(this.source,0):this.map(e.changes)}map(e){return e.empty||this.explicitPos<0?this:new zi(this.source,this.state,e.mapPos(this.explicitPos))}}class Rh extends zi{constructor(e,t,i,s,r){super(e,2,t),this.result=i,this.from=s,this.to=r}hasResult(){return!0}handleUserEvent(e,t,i){var s;let r=e.changes.mapPos(this.from),o=e.changes.mapPos(this.to,1),a=Nr(e.state);if((this.explicitPos<0?a<=r:a<this.from)||a>o||t=="delete"&&Nr(e.startState)==this.from)return new zi(this.source,t=="input"&&i.activateOnTyping?1:0);let l=this.explicitPos<0?-1:e.changes.mapPos(this.explicitPos),h;return nX(this.result.validFor,e.state,r,o)?new Rh(this.source,l,this.result,r,o):this.result.update&&(h=this.result.update(this.result,r,o,new SM(e.state,a,l>=0)))?new Rh(this.source,l,h,h.from,(s=h.to)!==null&&s!==void 0?s:Nr(e.state)):new zi(this.source,1,l)}handleChange(e){return e.changes.touchesRange(this.from,this.to)?new zi(this.source,0):this.map(e.changes)}map(e){return e.empty?this:new Rh(this.source,this.explicitPos<0?-1:e.mapPos(this.explicitPos),this.result,e.mapPos(this.from),e.mapPos(this.to,1))}}function nX(n,e,t,i){if(!n)return!1;let s=e.sliceDoc(t,i);return typeof n=="function"?n(s,t,i,e):xM(n,!0).test(s)}const Xb=Ue.define(),xf=Ue.define(),wM=Ue.define({map(n,e){return n.map(t=>t.map(e))}}),_M=Ue.define(),xn=ci.define({create(){return Sf.start()},update(n,e){return n.update(e)},provide:n=>[Db.from(n,e=>e.tooltip),$e.contentAttributes.from(n,e=>e.attrs)]}),kM=75;function qc(n,e="option"){return t=>{let i=t.state.field(xn,!1);if(!i||!i.open||Date.now()-i.open.timestamp<kM)return!1;let s=1,r;e=="page"&&(r=XU(t,i.open.tooltip))&&(s=Math.max(2,Math.floor(r.dom.offsetHeight/r.dom.querySelector("li").offsetHeight)-1));let o=i.open.selected+s*(n?1:-1),{length:a}=i.open.options;return o<0?o=e=="page"?0:a-1:o>=a&&(o=e=="page"?a-1:0),t.dispatch({effects:_M.of(o)}),!0}}const sX=n=>{let e=n.state.field(xn,!1);return n.state.readOnly||!e||!e.open||Date.now()-e.open.timestamp<kM?!1:(TM(n,e.open.options[e.open.selected]),!0)},rX=n=>n.state.field(xn,!1)?(n.dispatch({effects:Xb.of(!0)}),!0):!1,oX=n=>{let e=n.state.field(xn,!1);return!e||!e.active.some(t=>t.state!=0)?!1:(n.dispatch({effects:xf.of(null)}),!0)};class aX{constructor(e,t){this.active=e,this.context=t,this.time=Date.now(),this.updates=[],this.done=void 0}}const Sw=50,lX=50,hX=1e3,uX=Xt.fromClass(class{constructor(n){this.view=n,this.debounceUpdate=-1,this.running=[],this.debounceAccept=-1,this.composing=0;for(let e of n.state.field(xn).active)e.state==1&&this.startQuery(e)}update(n){let e=n.state.field(xn);if(!n.selectionSet&&!n.docChanged&&n.startState.field(xn)==e)return;let t=n.transactions.some(i=>(i.selection||i.docChanged)&&!WO(i));for(let i=0;i<this.running.length;i++){let s=this.running[i];if(t||s.updates.length+n.transactions.length>lX&&Date.now()-s.time>hX){for(let r of s.context.abortListeners)try{r()}catch(o){un(this.view.state,o)}s.context.abortListeners=null,this.running.splice(i--,1)}else s.updates.push(...n.transactions)}if(this.debounceUpdate>-1&&clearTimeout(this.debounceUpdate),this.debounceUpdate=e.active.some(i=>i.state==1&&!this.running.some(s=>s.active.source==i.source))?setTimeout(()=>this.startUpdate(),Sw):-1,this.composing!=0)for(let i of n.transactions)WO(i)=="input"?this.composing=2:this.composing==2&&i.selection&&(this.composing=3)}startUpdate(){this.debounceUpdate=-1;let{state:n}=this.view,e=n.field(xn);for(let t of e.active)t.state==1&&!this.running.some(i=>i.active.source==t.source)&&this.startQuery(t)}startQuery(n){let{state:e}=this.view,t=Nr(e),i=new SM(e,t,n.explicitPos==t),s=new aX(n,i);this.running.push(s),Promise.resolve(n.source(i)).then(r=>{s.context.aborted||(s.done=r||null,this.scheduleAccept())},r=>{this.view.dispatch({effects:xf.of(null)}),un(this.view.state,r)})}scheduleAccept(){this.running.every(n=>n.done!==void 0)?this.accept():this.debounceAccept<0&&(this.debounceAccept=setTimeout(()=>this.accept(),Sw))}accept(){var n;this.debounceAccept>-1&&clearTimeout(this.debounceAccept),this.debounceAccept=-1;let e=[],t=this.view.state.facet(Hr);for(let i=0;i<this.running.length;i++){let s=this.running[i];if(s.done===void 0)continue;if(this.running.splice(i--,1),s.done){let o=new Rh(s.active.source,s.active.explicitPos,s.done,s.done.from,(n=s.done.to)!==null&&n!==void 0?n:Nr(s.updates.length?s.updates[0].startState:this.view.state));for(let a of s.updates)o=o.update(a,t);if(o.hasResult()){e.push(o);continue}}let r=this.view.state.field(xn).active.find(o=>o.source==s.active.source);if(r&&r.state==1)if(s.done==null){let o=new zi(s.active.source,0);for(let a of s.updates)o=o.update(a,t);o.state!=1&&e.push(o)}else this.startQuery(r)}e.length&&this.view.dispatch({effects:wM.of(e)})}},{eventHandlers:{blur(){let n=this.view.state.field(xn,!1);n&&n.tooltip&&this.view.state.facet(Hr).closeOnBlur&&this.view.dispatch({effects:xf.of(null)})},compositionstart(){this.composing=1},compositionend(){this.composing==3&&setTimeout(()=>this.view.dispatch({effects:Xb.of(!1)}),20),this.composing=0}}}),cX=$e.baseTheme({".cm-tooltip.cm-tooltip-autocomplete":{"& > ul":{fontFamily:"monospace",whiteSpace:"nowrap",overflow:"hidden auto",maxWidth_fallback:"700px",maxWidth:"min(700px, 95vw)",minWidth:"250px",maxHeight:"10em",listStyle:"none",margin:0,padding:0,"& > li":{overflowX:"hidden",textOverflow:"ellipsis",cursor:"pointer",padding:"1px 3px",lineHeight:1.2}}},"&light .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#17c",color:"white"},"&dark .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#347",color:"white"},".cm-completionListIncompleteTop:before, .cm-completionListIncompleteBottom:after":{content:'"···"',opacity:.5,display:"block",textAlign:"center"},".cm-tooltip.cm-completionInfo":{position:"absolute",padding:"3px 9px",width:"max-content",maxWidth:"300px"},".cm-completionInfo.cm-completionInfo-left":{right:"100%"},".cm-completionInfo.cm-completionInfo-right":{left:"100%"},"&light .cm-snippetField":{backgroundColor:"#00000022"},"&dark .cm-snippetField":{backgroundColor:"#ffffff22"},".cm-snippetFieldPosition":{verticalAlign:"text-top",width:0,height:"1.15em",margin:"0 -0.7px -.7em",borderLeft:"1.4px dotted #888"},".cm-completionMatchedText":{textDecoration:"underline"},".cm-completionDetail":{marginLeft:"0.5em",fontStyle:"italic"},".cm-completionIcon":{fontSize:"90%",width:".8em",display:"inline-block",textAlign:"center",paddingRight:".6em",opacity:"0.6"},".cm-completionIcon-function, .cm-completionIcon-method":{"&:after":{content:"'ƒ'"}},".cm-completionIcon-class":{"&:after":{content:"'○'"}},".cm-completionIcon-interface":{"&:after":{content:"'◌'"}},".cm-completionIcon-variable":{"&:after":{content:"'𝑥'"}},".cm-completionIcon-constant":{"&:after":{content:"'𝐶'"}},".cm-completionIcon-type":{"&:after":{content:"'𝑡'"}},".cm-completionIcon-enum":{"&:after":{content:"'∪'"}},".cm-completionIcon-property":{"&:after":{content:"'□'"}},".cm-completionIcon-keyword":{"&:after":{content:"'🔑︎'"}},".cm-completionIcon-namespace":{"&:after":{content:"'▢'"}},".cm-completionIcon-text":{"&:after":{content:"'abc'",fontSize:"50%",verticalAlign:"middle"}}}),Tf={brackets:["(","[","{","'",'"'],before:")]}:;>"},bo=Ue.define({map(n,e){let t=e.mapPos(n,-1,Li.TrackAfter);return t??void 0}}),Hb=Ue.define({map(n,e){return e.mapPos(n)}}),Wb=new class extends $o{};Wb.startSide=1;Wb.endSide=-1;const CM=ci.define({create(){return st.empty},update(n,e){if(e.selection){let t=e.state.doc.lineAt(e.selection.main.head).from,i=e.startState.doc.lineAt(e.startState.selection.main.head).from;t!=e.changes.mapPos(i,-1)&&(n=st.empty)}n=n.map(e.changes);for(let t of e.effects)t.is(bo)?n=n.update({add:[Wb.range(t.value,t.value+1)]}):t.is(Hb)&&(n=n.update({filter:i=>i!=t.value}));return n}});function dX(){return[pX,CM]}const cg="()[]{}<>";function EM(n){for(let e=0;e<cg.length;e+=2)if(cg.charCodeAt(e)==n)return cg.charAt(e+1);return Sb(n<128?n:n+1)}function AM(n,e){return n.languageDataAt("closeBrackets",e)[0]||Tf}const fX=typeof navigator=="object"&&/Android\b/.test(navigator.userAgent),pX=$e.inputHandler.of((n,e,t,i)=>{if((fX?n.composing:n.compositionStarted)||n.state.readOnly)return!1;let s=n.state.selection.main;if(i.length>2||i.length==2&&Sn(gi(i,0))==1||e!=s.from||t!=s.to)return!1;let r=OX(n.state,i);return r?(n.dispatch(r),!0):!1}),mX=({state:n,dispatch:e})=>{if(n.readOnly)return!1;let i=AM(n,n.selection.main.head).brackets||Tf.brackets,s=null,r=n.changeByRange(o=>{if(o.empty){let a=yX(n.doc,o.head);for(let l of i)if(l==a&&Tp(n.doc,o.head)==EM(gi(l,0)))return{changes:{from:o.head-l.length,to:o.head+l.length},range:le.cursor(o.head-l.length),userEvent:"delete.backward"}}return{range:s=o}});return s||e(n.update(r,{scrollIntoView:!0})),!s},gX=[{key:"Backspace",run:mX}];function OX(n,e){let t=AM(n,n.selection.main.head),i=t.brackets||Tf.brackets;for(let s of i){let r=EM(gi(s,0));if(e==s)return r==s?SX(n,s,i.indexOf(s+s+s)>-1):bX(n,s,r,t.before||Tf.before);if(e==r&&PM(n,n.selection.main.from))return vX(n,s,r)}return null}function PM(n,e){let t=!1;return n.field(CM).between(0,n.doc.length,i=>{i==e&&(t=!0)}),t}function Tp(n,e){let t=n.sliceString(e,e+2);return t.slice(0,Sn(gi(t,0)))}function yX(n,e){let t=n.sliceString(e-2,e);return Sn(gi(t,0))==t.length?t:t.slice(1)}function bX(n,e,t,i){let s=null,r=n.changeByRange(o=>{if(!o.empty)return{changes:[{insert:e,from:o.from},{insert:t,from:o.to}],effects:bo.of(o.to+e.length),range:le.range(o.anchor+e.length,o.head+e.length)};let a=Tp(n.doc,o.head);return!a||/\s/.test(a)||i.indexOf(a)>-1?{changes:{insert:e+t,from:o.head},effects:bo.of(o.head+e.length),range:le.cursor(o.head+e.length)}:{range:s=o}});return s?null:n.update(r,{scrollIntoView:!0,userEvent:"input.type"})}function vX(n,e,t){let i=null,s=n.selection.ranges.map(r=>r.empty&&Tp(n.doc,r.head)==t?le.cursor(r.head+t.length):i=r);return i?null:n.update({selection:le.create(s,n.selection.mainIndex),scrollIntoView:!0,effects:n.selection.ranges.map(({from:r})=>Hb.of(r))})}function SX(n,e,t){let i=null,s=n.changeByRange(r=>{if(!r.empty)return{changes:[{insert:e,from:r.from},{insert:e,from:r.to}],effects:bo.of(r.to+e.length),range:le.range(r.anchor+e.length,r.head+e.length)};let o=r.head,a=Tp(n.doc,o);if(a==e){if(xw(n,o))return{changes:{insert:e+e,from:o},effects:bo.of(o+e.length),range:le.cursor(o+e.length)};if(PM(n,o)){let l=t&&n.sliceDoc(o,o+e.length*3)==e+e+e;return{range:le.cursor(o+e.length*(l?3:1)),effects:Hb.of(o)}}}else{if(t&&n.sliceDoc(o-2*e.length,o)==e+e&&xw(n,o-2*e.length))return{changes:{insert:e+e+e+e,from:o},effects:bo.of(o+e.length),range:le.cursor(o+e.length)};if(n.charCategorizer(o)(a)!=$i.Word){let l=n.sliceDoc(o-1,o);if(l!=e&&n.charCategorizer(o)(l)!=$i.Word&&!xX(n,o,e))return{changes:{insert:e+e,from:o},effects:bo.of(o+e.length),range:le.cursor(o+e.length)}}}return{range:i=r}});return i?null:n.update(s,{scrollIntoView:!0,userEvent:"input.type"})}function xw(n,e){let t=wi(n).resolveInner(e+1);return t.parent&&t.from==e}function xX(n,e,t){let i=wi(n).resolveInner(e,-1);for(let s=0;s<5;s++){if(n.sliceDoc(i.from,i.from+t.length)==t)return!0;let r=i.to==e&&i.parent;if(!r)break;i=r}return!1}function TX(n={}){return[xn,Hr.of(n),uX,wX,cX]}const DM=[{key:"Ctrl-Space",run:rX},{key:"Escape",run:oX},{key:"ArrowDown",run:qc(!0)},{key:"ArrowUp",run:qc(!1)},{key:"PageDown",run:qc(!0,"page")},{key:"PageUp",run:qc(!1,"page")},{key:"Enter",run:sX}],wX=Eu.highest(Pb.computeN([Hr],n=>n.facet(Hr).defaultKeymap?[DM]:[]));class _X{constructor(e,t,i){this.from=e,this.to=t,this.diagnostic=i}}class po{constructor(e,t,i){this.diagnostics=e,this.panel=t,this.selected=i}static init(e,t,i){let s=e,r=i.facet(da).markerFilter;r&&(s=r(s));let o=Ie.set(s.map(a=>a.from==a.to||a.from==a.to-1&&i.doc.lineAt(a.from).to==a.from?Ie.widget({widget:new LX(a),diagnostic:a}).range(a.from):Ie.mark({attributes:{class:"cm-lintRange cm-lintRange-"+a.severity},diagnostic:a}).range(a.from,a.to)),!0);return new po(o,t,Ja(o))}}function Ja(n,e=null,t=0){let i=null;return n.between(t,1e9,(s,r,{spec:o})=>{if(!(e&&o.diagnostic!=e))return i=new _X(s,r,o.diagnostic),!1}),i}function kX(n,e){return!!(n.effects.some(t=>t.is(Zb))||n.changes.touchesRange(e.pos))}function MM(n,e){return n.field(hn,!1)?e:e.concat(Ue.appendConfig.of([hn,$e.decorations.compute([hn],t=>{let{selected:i,panel:s}=t.field(hn);return!i||!s||i.from==i.to?Ie.none:Ie.set([EX.range(i.from,i.to)])}),jU(AX,{hideOn:kX}),QX]))}function CX(n,e){return{effects:MM(n,[Zb.of(e)])}}const Zb=Ue.define(),Yb=Ue.define(),IM=Ue.define(),hn=ci.define({create(){return new po(Ie.none,null,null)},update(n,e){if(e.docChanged){let t=n.diagnostics.map(e.changes),i=null;if(n.selected){let s=e.changes.mapPos(n.selected.from,1);i=Ja(t,n.selected.diagnostic,s)||Ja(t,null,s)}n=new po(t,n.panel,i)}for(let t of e.effects)t.is(Zb)?n=po.init(t.value,n.panel,e.state):t.is(Yb)?n=new po(n.diagnostics,t.value?wp.open:null,n.selected):t.is(IM)&&(n=new po(n.diagnostics,n.panel,t.value));return n},provide:n=>[nu.from(n,e=>e.panel),$e.decorations.from(n,e=>e.diagnostics)]}),EX=Ie.mark({class:"cm-lintRange cm-lintRange-active"});function AX(n,e,t){let{diagnostics:i}=n.state.field(hn),s=[],r=2e8,o=0;i.between(e-(t<0?1:0),e+(t>0?1:0),(l,h,{spec:u})=>{e>=l&&e<=h&&(l==h||(e>l||t>0)&&(e<h||t<0))&&(s.push(u.diagnostic),r=Math.min(l,r),o=Math.max(h,o))});let a=n.state.facet(da).tooltipFilter;return a&&(s=a(s)),s.length?{pos:r,end:o,above:n.state.doc.lineAt(r).to<o,create(){return{dom:PX(n,s)}}}:null}function PX(n,e){return xt("ul",{class:"cm-tooltip-lint"},e.map(t=>LM(n,t,!1)))}const DX=n=>{let e=n.state.field(hn,!1);(!e||!e.panel)&&n.dispatch({effects:MM(n.state,[Yb.of(!0)])});let t=iu(n,wp.open);return t&&t.dom.querySelector(".cm-panel-lint ul").focus(),!0},Tw=n=>{let e=n.state.field(hn,!1);return!e||!e.panel?!1:(n.dispatch({effects:Yb.of(!1)}),!0)},MX=n=>{let e=n.state.field(hn,!1);if(!e)return!1;let t=n.state.selection.main,i=e.diagnostics.iter(t.to+1);return!i.value&&(i=e.diagnostics.iter(0),!i.value||i.from==t.from&&i.to==t.to)?!1:(n.dispatch({selection:{anchor:i.from,head:i.to},scrollIntoView:!0}),!0)},IX=[{key:"Mod-Shift-m",run:DX},{key:"F8",run:MX}],RX=Xt.fromClass(class{constructor(n){this.view=n,this.timeout=-1,this.set=!0;let{delay:e}=n.state.facet(da);this.lintTime=Date.now()+e,this.run=this.run.bind(this),this.timeout=setTimeout(this.run,e)}run(){let n=Date.now();if(n<this.lintTime-10)setTimeout(this.run,this.lintTime-n);else{this.set=!1;let{state:e}=this.view,{sources:t}=e.facet(da);Promise.all(t.map(i=>Promise.resolve(i(this.view)))).then(i=>{let s=i.reduce((r,o)=>r.concat(o));this.view.state.doc==e.doc&&this.view.dispatch(CX(this.view.state,s))},i=>{un(this.view.state,i)})}}update(n){let e=n.state.facet(da);(n.docChanged||e!=n.startState.facet(da))&&(this.lintTime=Date.now()+e.delay,this.set||(this.set=!0,this.timeout=setTimeout(this.run,e.delay)))}force(){this.set&&(this.lintTime=Date.now(),this.run())}destroy(){clearTimeout(this.timeout)}}),da=Ce.define({combine(n){return Object.assign({sources:n.map(e=>e.source)},ar(n.map(e=>e.config),{delay:750,markerFilter:null,tooltipFilter:null}))},enables:RX});function RM(n){let e=[];if(n)e:for(let{name:t}of n){for(let i=0;i<t.length;i++){let s=t[i];if(/[a-zA-Z]/.test(s)&&!e.some(r=>r.toLowerCase()==s.toLowerCase())){e.push(s);continue e}}e.push("")}return e}function LM(n,e,t){var i;let s=t?RM(e.actions):[];return xt("li",{class:"cm-diagnostic cm-diagnostic-"+e.severity},xt("span",{class:"cm-diagnosticText"},e.renderMessage?e.renderMessage():e.message),(i=e.actions)===null||i===void 0?void 0:i.map((r,o)=>{let a=c=>{c.preventDefault();let f=Ja(n.state.field(hn).diagnostics,e);f&&r.apply(n,f.from,f.to)},{name:l}=r,h=s[o]?l.indexOf(s[o]):-1,u=h<0?l:[l.slice(0,h),xt("u",l.slice(h,h+1)),l.slice(h+1)];return xt("button",{type:"button",class:"cm-diagnosticAction",onclick:a,onmousedown:a,"aria-label":` Action: ${l}${h<0?"":` (access key "${s[o]})"`}.`},u)}),e.source&&xt("div",{class:"cm-diagnosticSource"},e.source))}class LX extends Yr{constructor(e){super(),this.diagnostic=e}eq(e){return e.diagnostic==this.diagnostic}toDOM(){return xt("span",{class:"cm-lintPoint cm-lintPoint-"+this.diagnostic.severity})}}class ww{constructor(e,t){this.diagnostic=t,this.id="item_"+Math.floor(Math.random()*4294967295).toString(16),this.dom=LM(e,t,!0),this.dom.id=this.id,this.dom.setAttribute("role","option")}}class wp{constructor(e){this.view=e,this.items=[];let t=s=>{if(s.keyCode==27)Tw(this.view),this.view.focus();else if(s.keyCode==38||s.keyCode==33)this.moveSelection((this.selectedIndex-1+this.items.length)%this.items.length);else if(s.keyCode==40||s.keyCode==34)this.moveSelection((this.selectedIndex+1)%this.items.length);else if(s.keyCode==36)this.moveSelection(0);else if(s.keyCode==35)this.moveSelection(this.items.length-1);else if(s.keyCode==13)this.view.focus();else if(s.keyCode>=65&&s.keyCode<=90&&this.selectedIndex>=0){let{diagnostic:r}=this.items[this.selectedIndex],o=RM(r.actions);for(let a=0;a<o.length;a++)if(o[a].toUpperCase().charCodeAt(0)==s.keyCode){let l=Ja(this.view.state.field(hn).diagnostics,r);l&&r.actions[a].apply(e,l.from,l.to)}}else return;s.preventDefault()},i=s=>{for(let r=0;r<this.items.length;r++)this.items[r].dom.contains(s.target)&&this.moveSelection(r)};this.list=xt("ul",{tabIndex:0,role:"listbox","aria-label":this.view.state.phrase("Diagnostics"),onkeydown:t,onclick:i}),this.dom=xt("div",{class:"cm-panel-lint"},this.list,xt("button",{type:"button",name:"close","aria-label":this.view.state.phrase("close"),onclick:()=>Tw(this.view)},"×")),this.update()}get selectedIndex(){let e=this.view.state.field(hn).selected;if(!e)return-1;for(let t=0;t<this.items.length;t++)if(this.items[t].diagnostic==e.diagnostic)return t;return-1}update(){let{diagnostics:e,selected:t}=this.view.state.field(hn),i=0,s=!1,r=null;for(e.between(0,this.view.state.doc.length,(o,a,{spec:l})=>{let h=-1,u;for(let c=i;c<this.items.length;c++)if(this.items[c].diagnostic==l.diagnostic){h=c;break}h<0?(u=new ww(this.view,l.diagnostic),this.items.splice(i,0,u),s=!0):(u=this.items[h],h>i&&(this.items.splice(i,h-i),s=!0)),t&&u.diagnostic==t.diagnostic?u.dom.hasAttribute("aria-selected")||(u.dom.setAttribute("aria-selected","true"),r=u):u.dom.hasAttribute("aria-selected")&&u.dom.removeAttribute("aria-selected"),i++});i<this.items.length&&!(this.items.length==1&&this.items[0].diagnostic.from<0);)s=!0,this.items.pop();this.items.length==0&&(this.items.push(new ww(this.view,{from:-1,to:-1,severity:"info",message:this.view.state.phrase("No diagnostics")})),s=!0),r?(this.list.setAttribute("aria-activedescendant",r.id),this.view.requestMeasure({key:this,read:()=>({sel:r.dom.getBoundingClientRect(),panel:this.list.getBoundingClientRect()}),write:({sel:o,panel:a})=>{o.top<a.top?this.list.scrollTop-=a.top-o.top:o.bottom>a.bottom&&(this.list.scrollTop+=o.bottom-a.bottom)}})):this.selectedIndex<0&&this.list.removeAttribute("aria-activedescendant"),s&&this.sync()}sync(){let e=this.list.firstChild;function t(){let i=e;e=i.nextSibling,i.remove()}for(let i of this.items)if(i.dom.parentNode==this.list){for(;e!=i.dom;)t();e=i.dom.nextSibling}else this.list.insertBefore(i.dom,e);for(;e;)t()}moveSelection(e){if(this.selectedIndex<0)return;let t=this.view.state.field(hn),i=Ja(t.diagnostics,this.items[e].diagnostic);i&&this.view.dispatch({selection:{anchor:i.from,head:i.to},scrollIntoView:!0,effects:IM.of(i)})}static open(e){return new wp(e)}}function $X(n,e='viewBox="0 0 40 40"'){return`url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" ${e}>${encodeURIComponent(n)}</svg>')`}function dg(n){return $X(`<path d="m0 2.5 l2 -1.5 l1 0 l2 1.5 l1 0" stroke="${n}" fill="none" stroke-width=".7"/>`,'width="6" height="3"')}const QX=$e.baseTheme({".cm-diagnostic":{padding:"3px 6px 3px 8px",marginLeft:"-1px",display:"block",whiteSpace:"pre-wrap"},".cm-diagnostic-error":{borderLeft:"5px solid #d11"},".cm-diagnostic-warning":{borderLeft:"5px solid orange"},".cm-diagnostic-info":{borderLeft:"5px solid #999"},".cm-diagnosticAction":{font:"inherit",border:"none",padding:"2px 4px",backgroundColor:"#444",color:"white",borderRadius:"3px",marginLeft:"8px"},".cm-diagnosticSource":{fontSize:"70%",opacity:.7},".cm-lintRange":{backgroundPosition:"left bottom",backgroundRepeat:"repeat-x",paddingBottom:"0.7px"},".cm-lintRange-error":{backgroundImage:dg("#d11")},".cm-lintRange-warning":{backgroundImage:dg("orange")},".cm-lintRange-info":{backgroundImage:dg("#999")},".cm-lintRange-active":{backgroundColor:"#ffdd9980"},".cm-tooltip-lint":{padding:0,margin:0},".cm-lintPoint":{position:"relative","&:after":{content:'""',position:"absolute",bottom:0,left:"-2px",borderLeft:"3px solid transparent",borderRight:"3px solid transparent",borderBottom:"4px solid #d11"}},".cm-lintPoint-warning":{"&:after":{borderBottomColor:"orange"}},".cm-lintPoint-info":{"&:after":{borderBottomColor:"#999"}},".cm-panel.cm-panel-lint":{position:"relative","& ul":{maxHeight:"100px",overflowY:"auto","& [aria-selected]":{backgroundColor:"#ddd","& u":{textDecoration:"underline"}},"&:focus [aria-selected]":{background_fallback:"#bdf",backgroundColor:"Highlight",color_fallback:"white",color:"HighlightText"},"& u":{textDecoration:"none"},padding:0,margin:0},"& [name=close]":{position:"absolute",top:"0",right:"2px",background:"inherit",border:"none",font:"inherit",padding:0,margin:0}}}),BX=[tq(),sq(),xU(),Tz(),Zq(),uU(),gU(),Ge.allowMultipleSelections.of(!0),Rq(),Gq(ez,{fallback:!0}),az(),dX(),TX(),RU(),QU(),EU(),Sj(),Pb.of([...gX,...mj,...Bj,...Mz,...zq,...DM,...IX])],$M=1024;let NX=0;class _n{constructor(e,t){this.from=e,this.to=t}}class qe{constructor(e={}){this.id=NX++,this.perNode=!!e.perNode,this.deserialize=e.deserialize||(()=>{throw new Error("This node type doesn't define a deserialize function")})}add(e){if(this.perNode)throw new RangeError("Can't add per-node props to node types");return typeof e!="function"&&(e=Yt.match(e)),t=>{let i=e(t);return i===void 0?null:[this,i]}}}qe.closedBy=new qe({deserialize:n=>n.split(" ")});qe.openedBy=new qe({deserialize:n=>n.split(" ")});qe.group=new qe({deserialize:n=>n.split(" ")});qe.isolate=new qe({deserialize:n=>{if(n&&n!="rtl"&&n!="ltr"&&n!="auto")throw new RangeError("Invalid value for isolate: "+n);return n||"auto"}});qe.contextHash=new qe({perNode:!0});qe.lookAhead=new qe({perNode:!0});qe.mounted=new qe({perNode:!0});class au{constructor(e,t,i){this.tree=e,this.overlay=t,this.parser=i}static get(e){return e&&e.props&&e.props[qe.mounted.id]}}const FX=Object.create(null);class Yt{constructor(e,t,i,s=0){this.name=e,this.props=t,this.id=i,this.flags=s}static define(e){let t=e.props&&e.props.length?Object.create(null):FX,i=(e.top?1:0)|(e.skipped?2:0)|(e.error?4:0)|(e.name==null?8:0),s=new Yt(e.name||"",t,e.id,i);if(e.props){for(let r of e.props)if(Array.isArray(r)||(r=r(s)),r){if(r[0].perNode)throw new RangeError("Can't store a per-node prop on a node type");t[r[0].id]=r[1]}}return s}prop(e){return this.props[e.id]}get isTop(){return(this.flags&1)>0}get isSkipped(){return(this.flags&2)>0}get isError(){return(this.flags&4)>0}get isAnonymous(){return(this.flags&8)>0}is(e){if(typeof e=="string"){if(this.name==e)return!0;let t=this.prop(qe.group);return t?t.indexOf(e)>-1:!1}return this.id==e}static match(e){let t=Object.create(null);for(let i in e)for(let s of i.split(" "))t[s]=e[i];return i=>{for(let s=i.prop(qe.group),r=-1;r<(s?s.length:0);r++){let o=t[r<0?i.name:s[r]];if(o)return o}}}}Yt.none=new Yt("",Object.create(null),0,8);class Lu{constructor(e){this.types=e;for(let t=0;t<e.length;t++)if(e[t].id!=t)throw new RangeError("Node type ids should correspond to array positions when creating a node set")}extend(...e){let t=[];for(let i of this.types){let s=null;for(let r of e){let o=r(i);o&&(s||(s=Object.assign({},i.props)),s[o[0].id]=o[1])}t.push(s?new Yt(i.name,s,i.id,i.flags):i)}return new Lu(t)}}const zc=new WeakMap,_w=new WeakMap;var ft;(function(n){n[n.ExcludeBuffers=1]="ExcludeBuffers",n[n.IncludeAnonymous=2]="IncludeAnonymous",n[n.IgnoreMounts=4]="IgnoreMounts",n[n.IgnoreOverlays=8]="IgnoreOverlays"})(ft||(ft={}));class tt{constructor(e,t,i,s,r){if(this.type=e,this.children=t,this.positions=i,this.length=s,this.props=null,r&&r.length){this.props=Object.create(null);for(let[o,a]of r)this.props[typeof o=="number"?o:o.id]=a}}toString(){let e=au.get(this);if(e&&!e.overlay)return e.tree.toString();let t="";for(let i of this.children){let s=i.toString();s&&(t&&(t+=","),t+=s)}return this.type.name?(/\W/.test(this.type.name)&&!this.type.isError?JSON.stringify(this.type.name):this.type.name)+(t.length?"("+t+")":""):t}cursor(e=0){return new wf(this.topNode,e)}cursorAt(e,t=0,i=0){let s=zc.get(this)||this.topNode,r=new wf(s);return r.moveTo(e,t),zc.set(this,r._tree),r}get topNode(){return new Si(this,0,0,null)}resolve(e,t=0){let i=lu(zc.get(this)||this.topNode,e,t,!1);return zc.set(this,i),i}resolveInner(e,t=0){let i=lu(_w.get(this)||this.topNode,e,t,!0);return _w.set(this,i),i}resolveStack(e,t=0){return qX(this,e,t)}iterate(e){let{enter:t,leave:i,from:s=0,to:r=this.length}=e,o=e.mode||0,a=(o&ft.IncludeAnonymous)>0;for(let l=this.cursor(o|ft.IncludeAnonymous);;){let h=!1;if(l.from<=r&&l.to>=s&&(!a&&l.type.isAnonymous||t(l)!==!1)){if(l.firstChild())continue;h=!0}for(;h&&i&&(a||!l.type.isAnonymous)&&i(l),!l.nextSibling();){if(!l.parent())return;h=!0}}}prop(e){return e.perNode?this.props?this.props[e.id]:void 0:this.type.prop(e)}get propValues(){let e=[];if(this.props)for(let t in this.props)e.push([+t,this.props[t]]);return e}balance(e={}){return this.children.length<=8?this:Jb(Yt.none,this.children,this.positions,0,this.children.length,0,this.length,(t,i,s)=>new tt(this.type,t,i,s,this.propValues),e.makeTree||((t,i,s)=>new tt(Yt.none,t,i,s)))}static build(e){return zX(e)}}tt.empty=new tt(Yt.none,[],[],0);class Gb{constructor(e,t){this.buffer=e,this.index=t}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}get pos(){return this.index}next(){this.index-=4}fork(){return new Gb(this.buffer,this.index)}}class Wr{constructor(e,t,i){this.buffer=e,this.length=t,this.set=i}get type(){return Yt.none}toString(){let e=[];for(let t=0;t<this.buffer.length;)e.push(this.childString(t)),t=this.buffer[t+3];return e.join(",")}childString(e){let t=this.buffer[e],i=this.buffer[e+3],s=this.set.types[t],r=s.name;if(/\W/.test(r)&&!s.isError&&(r=JSON.stringify(r)),e+=4,i==e)return r;let o=[];for(;e<i;)o.push(this.childString(e)),e=this.buffer[e+3];return r+"("+o.join(",")+")"}findChild(e,t,i,s,r){let{buffer:o}=this,a=-1;for(let l=e;l!=t&&!(QM(r,s,o[l+1],o[l+2])&&(a=l,i>0));l=o[l+3]);return a}slice(e,t,i){let s=this.buffer,r=new Uint16Array(t-e),o=0;for(let a=e,l=0;a<t;){r[l++]=s[a++],r[l++]=s[a++]-i;let h=r[l++]=s[a++]-i;r[l++]=s[a++]-e,o=Math.max(o,h)}return new Wr(r,o,this.set)}}function QM(n,e,t,i){switch(n){case-2:return t<e;case-1:return i>=e&&t<e;case 0:return t<e&&i>e;case 1:return t<=e&&i>e;case 2:return i>e;case 4:return!0}}function lu(n,e,t,i){for(var s;n.from==n.to||(t<1?n.from>=e:n.from>e)||(t>-1?n.to<=e:n.to<e);){let o=!i&&n instanceof Si&&n.index<0?null:n.parent;if(!o)return n;n=o}let r=i?0:ft.IgnoreOverlays;if(i)for(let o=n,a=o.parent;a;o=a,a=o.parent)o instanceof Si&&o.index<0&&((s=a.enter(e,t,r))===null||s===void 0?void 0:s.from)!=o.from&&(n=a);for(;;){let o=n.enter(e,t,r);if(!o)return n;n=o}}class BM{cursor(e=0){return new wf(this,e)}getChild(e,t=null,i=null){let s=kw(this,e,t,i);return s.length?s[0]:null}getChildren(e,t=null,i=null){return kw(this,e,t,i)}resolve(e,t=0){return lu(this,e,t,!1)}resolveInner(e,t=0){return lu(this,e,t,!0)}matchContext(e){return ZO(this.parent,e)}enterUnfinishedNodesBefore(e){let t=this.childBefore(e),i=this;for(;t;){let s=t.lastChild;if(!s||s.to!=t.to)break;s.type.isError&&s.from==s.to?(i=t,t=s.prevSibling):t=s}return i}get node(){return this}get next(){return this.parent}}class Si extends BM{constructor(e,t,i,s){super(),this._tree=e,this.from=t,this.index=i,this._parent=s}get type(){return this._tree.type}get name(){return this._tree.type.name}get to(){return this.from+this._tree.length}nextChild(e,t,i,s,r=0){for(let o=this;;){for(let{children:a,positions:l}=o._tree,h=t>0?a.length:-1;e!=h;e+=t){let u=a[e],c=l[e]+o.from;if(QM(s,i,c,c+u.length)){if(u instanceof Wr){if(r&ft.ExcludeBuffers)continue;let f=u.findChild(0,u.buffer.length,t,i-c,s);if(f>-1)return new ws(new VX(o,u,e,c),null,f)}else if(r&ft.IncludeAnonymous||!u.type.isAnonymous||Kb(u)){let f;if(!(r&ft.IgnoreMounts)&&(f=au.get(u))&&!f.overlay)return new Si(f.tree,c,e,o);let p=new Si(u,c,e,o);return r&ft.IncludeAnonymous||!p.type.isAnonymous?p:p.nextChild(t<0?u.children.length-1:0,t,i,s)}}}if(r&ft.IncludeAnonymous||!o.type.isAnonymous||(o.index>=0?e=o.index+t:e=t<0?-1:o._parent._tree.children.length,o=o._parent,!o))return null}}get firstChild(){return this.nextChild(0,1,0,4)}get lastChild(){return this.nextChild(this._tree.children.length-1,-1,0,4)}childAfter(e){return this.nextChild(0,1,e,2)}childBefore(e){return this.nextChild(this._tree.children.length-1,-1,e,-2)}enter(e,t,i=0){let s;if(!(i&ft.IgnoreOverlays)&&(s=au.get(this._tree))&&s.overlay){let r=e-this.from;for(let{from:o,to:a}of s.overlay)if((t>0?o<=r:o<r)&&(t<0?a>=r:a>r))return new Si(s.tree,s.overlay[0].from+this.from,-1,this)}return this.nextChild(0,1,e,t,i)}nextSignificantParent(){let e=this;for(;e.type.isAnonymous&&e._parent;)e=e._parent;return e}get parent(){return this._parent?this._parent.nextSignificantParent():null}get nextSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index+1,1,0,4):null}get prevSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index-1,-1,0,4):null}get tree(){return this._tree}toTree(){return this._tree}toString(){return this._tree.toString()}}function kw(n,e,t,i){let s=n.cursor(),r=[];if(!s.firstChild())return r;if(t!=null){for(let o=!1;!o;)if(o=s.type.is(t),!s.nextSibling())return r}for(;;){if(i!=null&&s.type.is(i))return r;if(s.type.is(e)&&r.push(s.node),!s.nextSibling())return i==null?r:[]}}function ZO(n,e,t=e.length-1){for(let i=n;t>=0;i=i.parent){if(!i)return!1;if(!i.type.isAnonymous){if(e[t]&&e[t]!=i.name)return!1;t--}}return!0}class VX{constructor(e,t,i,s){this.parent=e,this.buffer=t,this.index=i,this.start=s}}class ws extends BM{get name(){return this.type.name}get from(){return this.context.start+this.context.buffer.buffer[this.index+1]}get to(){return this.context.start+this.context.buffer.buffer[this.index+2]}constructor(e,t,i){super(),this.context=e,this._parent=t,this.index=i,this.type=e.buffer.set.types[e.buffer.buffer[i]]}child(e,t,i){let{buffer:s}=this.context,r=s.findChild(this.index+4,s.buffer[this.index+3],e,t-this.context.start,i);return r<0?null:new ws(this.context,this,r)}get firstChild(){return this.child(1,0,4)}get lastChild(){return this.child(-1,0,4)}childAfter(e){return this.child(1,e,2)}childBefore(e){return this.child(-1,e,-2)}enter(e,t,i=0){if(i&ft.ExcludeBuffers)return null;let{buffer:s}=this.context,r=s.findChild(this.index+4,s.buffer[this.index+3],t>0?1:-1,e-this.context.start,t);return r<0?null:new ws(this.context,this,r)}get parent(){return this._parent||this.context.parent.nextSignificantParent()}externalSibling(e){return this._parent?null:this.context.parent.nextChild(this.context.index+e,e,0,4)}get nextSibling(){let{buffer:e}=this.context,t=e.buffer[this.index+3];return t<(this._parent?e.buffer[this._parent.index+3]:e.buffer.length)?new ws(this.context,this._parent,t):this.externalSibling(1)}get prevSibling(){let{buffer:e}=this.context,t=this._parent?this._parent.index+4:0;return this.index==t?this.externalSibling(-1):new ws(this.context,this._parent,e.findChild(t,this.index,-1,0,4))}get tree(){return null}toTree(){let e=[],t=[],{buffer:i}=this.context,s=this.index+4,r=i.buffer[this.index+3];if(r>s){let o=i.buffer[this.index+1];e.push(i.slice(s,r,o)),t.push(0)}return new tt(this.type,e,t,this.to-this.from)}toString(){return this.context.buffer.childString(this.index)}}function NM(n){if(!n.length)return null;let e=0,t=n[0];for(let r=1;r<n.length;r++){let o=n[r];(o.from>t.from||o.to<t.to)&&(t=o,e=r)}let i=t instanceof Si&&t.index<0?null:t.parent,s=n.slice();return i?s[e]=i:s.splice(e,1),new UX(s,t)}class UX{constructor(e,t){this.heads=e,this.node=t}get next(){return NM(this.heads)}}function qX(n,e,t){let i=n.resolveInner(e,t),s=null;for(let r=i instanceof Si?i:i.context.parent;r;r=r.parent)if(r.index<0){let o=r.parent;(s||(s=[i])).push(o.resolve(e,t)),r=o}else{let o=au.get(r.tree);if(o&&o.overlay&&o.overlay[0].from<=e&&o.overlay[o.overlay.length-1].to>=e){let a=new Si(o.tree,o.overlay[0].from+r.from,-1,r);(s||(s=[i])).push(lu(a,e,t,!1))}}return s?NM(s):i}class wf{get name(){return this.type.name}constructor(e,t=0){if(this.mode=t,this.buffer=null,this.stack=[],this.index=0,this.bufferNode=null,e instanceof Si)this.yieldNode(e);else{this._tree=e.context.parent,this.buffer=e.context;for(let i=e._parent;i;i=i._parent)this.stack.unshift(i.index);this.bufferNode=e,this.yieldBuf(e.index)}}yieldNode(e){return e?(this._tree=e,this.type=e.type,this.from=e.from,this.to=e.to,!0):!1}yieldBuf(e,t){this.index=e;let{start:i,buffer:s}=this.buffer;return this.type=t||s.set.types[s.buffer[e]],this.from=i+s.buffer[e+1],this.to=i+s.buffer[e+2],!0}yield(e){return e?e instanceof Si?(this.buffer=null,this.yieldNode(e)):(this.buffer=e.context,this.yieldBuf(e.index,e.type)):!1}toString(){return this.buffer?this.buffer.buffer.childString(this.index):this._tree.toString()}enterChild(e,t,i){if(!this.buffer)return this.yield(this._tree.nextChild(e<0?this._tree._tree.children.length-1:0,e,t,i,this.mode));let{buffer:s}=this.buffer,r=s.findChild(this.index+4,s.buffer[this.index+3],e,t-this.buffer.start,i);return r<0?!1:(this.stack.push(this.index),this.yieldBuf(r))}firstChild(){return this.enterChild(1,0,4)}lastChild(){return this.enterChild(-1,0,4)}childAfter(e){return this.enterChild(1,e,2)}childBefore(e){return this.enterChild(-1,e,-2)}enter(e,t,i=this.mode){return this.buffer?i&ft.ExcludeBuffers?!1:this.enterChild(1,e,t):this.yield(this._tree.enter(e,t,i))}parent(){if(!this.buffer)return this.yieldNode(this.mode&ft.IncludeAnonymous?this._tree._parent:this._tree.parent);if(this.stack.length)return this.yieldBuf(this.stack.pop());let e=this.mode&ft.IncludeAnonymous?this.buffer.parent:this.buffer.parent.nextSignificantParent();return this.buffer=null,this.yieldNode(e)}sibling(e){if(!this.buffer)return this._tree._parent?this.yield(this._tree.index<0?null:this._tree._parent.nextChild(this._tree.index+e,e,0,4,this.mode)):!1;let{buffer:t}=this.buffer,i=this.stack.length-1;if(e<0){let s=i<0?0:this.stack[i]+4;if(this.index!=s)return this.yieldBuf(t.findChild(s,this.index,-1,0,4))}else{let s=t.buffer[this.index+3];if(s<(i<0?t.buffer.length:t.buffer[this.stack[i]+3]))return this.yieldBuf(s)}return i<0?this.yield(this.buffer.parent.nextChild(this.buffer.index+e,e,0,4,this.mode)):!1}nextSibling(){return this.sibling(1)}prevSibling(){return this.sibling(-1)}atLastNode(e){let t,i,{buffer:s}=this;if(s){if(e>0){if(this.index<s.buffer.buffer.length)return!1}else for(let r=0;r<this.index;r++)if(s.buffer.buffer[r+3]<this.index)return!1;({index:t,parent:i}=s)}else({index:t,_parent:i}=this._tree);for(;i;{index:t,_parent:i}=i)if(t>-1)for(let r=t+e,o=e<0?-1:i._tree.children.length;r!=o;r+=e){let a=i._tree.children[r];if(this.mode&ft.IncludeAnonymous||a instanceof Wr||!a.type.isAnonymous||Kb(a))return!1}return!0}move(e,t){if(t&&this.enterChild(e,0,4))return!0;for(;;){if(this.sibling(e))return!0;if(this.atLastNode(e)||!this.parent())return!1}}next(e=!0){return this.move(1,e)}prev(e=!0){return this.move(-1,e)}moveTo(e,t=0){for(;(this.from==this.to||(t<1?this.from>=e:this.from>e)||(t>-1?this.to<=e:this.to<e))&&this.parent(););for(;this.enterChild(1,e,t););return this}get node(){if(!this.buffer)return this._tree;let e=this.bufferNode,t=null,i=0;if(e&&e.context==this.buffer)e:for(let s=this.index,r=this.stack.length;r>=0;){for(let o=e;o;o=o._parent)if(o.index==s){if(s==this.index)return o;t=o,i=r+1;break e}s=this.stack[--r]}for(let s=i;s<this.stack.length;s++)t=new ws(this.buffer,t,this.stack[s]);return this.bufferNode=new ws(this.buffer,t,this.index)}get tree(){return this.buffer?null:this._tree._tree}iterate(e,t){for(let i=0;;){let s=!1;if(this.type.isAnonymous||e(this)!==!1){if(this.firstChild()){i++;continue}this.type.isAnonymous||(s=!0)}for(;;){if(s&&t&&t(this),s=this.type.isAnonymous,!i)return;if(this.nextSibling())break;this.parent(),i--,s=!0}}}matchContext(e){if(!this.buffer)return ZO(this.node.parent,e);let{buffer:t}=this.buffer,{types:i}=t.set;for(let s=e.length-1,r=this.stack.length-1;s>=0;r--){if(r<0)return ZO(this._tree,e,s);let o=i[t.buffer[this.stack[r]]];if(!o.isAnonymous){if(e[s]&&e[s]!=o.name)return!1;s--}}return!0}}function Kb(n){return n.children.some(e=>e instanceof Wr||!e.type.isAnonymous||Kb(e))}function zX(n){var e;let{buffer:t,nodeSet:i,maxBufferLength:s=$M,reused:r=[],minRepeatType:o=i.types.length}=n,a=Array.isArray(t)?new Gb(t,t.length):t,l=i.types,h=0,u=0;function c(k,A,M,B,P,R){let{id:q,start:z,end:X,size:Z}=a,K=u,oe=h;for(;Z<0;)if(a.next(),Z==-1){let ne=r[q];M.push(ne),B.push(z-k);return}else if(Z==-3){h=q;return}else if(Z==-4){u=q;return}else throw new RangeError(`Unrecognized record size: ${Z}`);let G=l[q],ee,te,re=z-k;if(X-z<=s&&(te=_(a.pos-A,P))){let ne=new Uint16Array(te.size-te.skip),ve=a.pos-te.size,xe=ne.length;for(;a.pos>ve;)xe=T(te.start,ne,xe);ee=new Wr(ne,X-te.start,i),re=te.start-k}else{let ne=a.pos-Z;a.next();let ve=[],xe=[],Pe=q>=o?q:-1,Se=0,ct=X;for(;a.pos>ne;)Pe>=0&&a.id==Pe&&a.size>=0?(a.end<=ct-s&&(b(ve,xe,z,Se,a.end,ct,Pe,K,oe),Se=ve.length,ct=a.end),a.next()):R>2500?f(z,ne,ve,xe):c(z,ne,ve,xe,Pe,R+1);if(Pe>=0&&Se>0&&Se<ve.length&&b(ve,xe,z,Se,z,ct,Pe,K,oe),ve.reverse(),xe.reverse(),Pe>-1&&Se>0){let vt=p(G,oe);ee=Jb(G,ve,xe,0,ve.length,0,X-z,vt,vt)}else ee=y(G,ve,xe,X-z,K-X,oe)}M.push(ee),B.push(re)}function f(k,A,M,B){let P=[],R=0,q=-1;for(;a.pos>A;){let{id:z,start:X,end:Z,size:K}=a;if(K>4)a.next();else{if(q>-1&&X<q)break;q<0&&(q=Z-s),P.push(z,X,Z),R++,a.next()}}if(R){let z=new Uint16Array(R*4),X=P[P.length-2];for(let Z=P.length-3,K=0;Z>=0;Z-=3)z[K++]=P[Z],z[K++]=P[Z+1]-X,z[K++]=P[Z+2]-X,z[K++]=K;M.push(new Wr(z,P[2]-X,i)),B.push(X-k)}}function p(k,A){return(M,B,P)=>{let R=0,q=M.length-1,z,X;if(q>=0&&(z=M[q])instanceof tt){if(!q&&z.type==k&&z.length==P)return z;(X=z.prop(qe.lookAhead))&&(R=B[q]+z.length+X)}return y(k,M,B,P,R,A)}}function b(k,A,M,B,P,R,q,z,X){let Z=[],K=[];for(;k.length>B;)Z.push(k.pop()),K.push(A.pop()+M-P);k.push(y(i.types[q],Z,K,R-P,z-R,X)),A.push(P-M)}function y(k,A,M,B,P,R,q){if(R){let z=[qe.contextHash,R];q=q?[z].concat(q):[z]}if(P>25){let z=[qe.lookAhead,P];q=q?[z].concat(q):[z]}return new tt(k,A,M,B,q)}function _(k,A){let M=a.fork(),B=0,P=0,R=0,q=M.end-s,z={size:0,start:0,skip:0};e:for(let X=M.pos-k;M.pos>X;){let Z=M.size;if(M.id==A&&Z>=0){z.size=B,z.start=P,z.skip=R,R+=4,B+=4,M.next();continue}let K=M.pos-Z;if(Z<0||K<X||M.start<q)break;let oe=M.id>=o?4:0,G=M.start;for(M.next();M.pos>K;){if(M.size<0)if(M.size==-3)oe+=4;else break e;else M.id>=o&&(oe+=4);M.next()}P=G,B+=Z,R+=oe}return(A<0||B==k)&&(z.size=B,z.start=P,z.skip=R),z.size>4?z:void 0}function T(k,A,M){let{id:B,start:P,end:R,size:q}=a;if(a.next(),q>=0&&B<o){let z=M;if(q>4){let X=a.pos-(q-4);for(;a.pos>X;)M=T(k,A,M)}A[--M]=z,A[--M]=R-k,A[--M]=P-k,A[--M]=B}else q==-3?h=B:q==-4&&(u=B);return M}let w=[],v=[];for(;a.pos>0;)c(n.start||0,n.bufferStart||0,w,v,-1,0);let S=(e=n.length)!==null&&e!==void 0?e:w.length?v[0]+w[0].length:0;return new tt(l[n.topID],w.reverse(),v.reverse(),S)}const Cw=new WeakMap;function Od(n,e){if(!n.isAnonymous||e instanceof Wr||e.type!=n)return 1;let t=Cw.get(e);if(t==null){t=1;for(let i of e.children){if(i.type!=n||!(i instanceof tt)){t=1;break}t+=Od(n,i)}Cw.set(e,t)}return t}function Jb(n,e,t,i,s,r,o,a,l){let h=0;for(let b=i;b<s;b++)h+=Od(n,e[b]);let u=Math.ceil(h*1.5/8),c=[],f=[];function p(b,y,_,T,w){for(let v=_;v<T;){let S=v,k=y[v],A=Od(n,b[v]);for(v++;v<T;v++){let M=Od(n,b[v]);if(A+M>=u)break;A+=M}if(v==S+1){if(A>u){let M=b[S];p(M.children,M.positions,0,M.children.length,y[S]+w);continue}c.push(b[S])}else{let M=y[v-1]+b[v-1].length-k;c.push(Jb(n,b,y,S,v,k,M,null,l))}f.push(k+w-r)}}return p(e,t,i,s,0),(a||l)(c,f,o)}class FM{constructor(){this.map=new WeakMap}setBuffer(e,t,i){let s=this.map.get(e);s||this.map.set(e,s=new Map),s.set(t,i)}getBuffer(e,t){let i=this.map.get(e);return i&&i.get(t)}set(e,t){e instanceof ws?this.setBuffer(e.context.buffer,e.index,t):e instanceof Si&&this.map.set(e.tree,t)}get(e){return e instanceof ws?this.getBuffer(e.context.buffer,e.index):e instanceof Si?this.map.get(e.tree):void 0}cursorSet(e,t){e.buffer?this.setBuffer(e.buffer.buffer,e.index,t):this.map.set(e.tree,t)}cursorGet(e){return e.buffer?this.getBuffer(e.buffer.buffer,e.index):this.map.get(e.tree)}}class nr{constructor(e,t,i,s,r=!1,o=!1){this.from=e,this.to=t,this.tree=i,this.offset=s,this.open=(r?1:0)|(o?2:0)}get openStart(){return(this.open&1)>0}get openEnd(){return(this.open&2)>0}static addTree(e,t=[],i=!1){let s=[new nr(0,e.length,e,0,!1,i)];for(let r of t)r.to>e.length&&s.push(r);return s}static applyChanges(e,t,i=128){if(!t.length)return e;let s=[],r=1,o=e.length?e[0]:null;for(let a=0,l=0,h=0;;a++){let u=a<t.length?t[a]:null,c=u?u.fromA:1e9;if(c-l>=i)for(;o&&o.from<c;){let f=o;if(l>=f.from||c<=f.to||h){let p=Math.max(f.from,l)-h,b=Math.min(f.to,c)-h;f=p>=b?null:new nr(p,b,f.tree,f.offset+h,a>0,!!u)}if(f&&s.push(f),o.to>c)break;o=r<e.length?e[r++]:null}if(!u)break;l=u.toA,h=u.toA-u.toB}return s}}class ev{startParse(e,t,i){return typeof e=="string"&&(e=new jX(e)),i=i?i.length?i.map(s=>new _n(s.from,s.to)):[new _n(0,0)]:[new _n(0,e.length)],this.createParse(e,t||[],i)}parse(e,t,i){let s=this.startParse(e,t,i);for(;;){let r=s.advance();if(r)return r}}}class jX{constructor(e){this.string=e}get length(){return this.string.length}chunk(e){return this.string.slice(e)}get lineChunks(){return!1}read(e,t){return this.string.slice(e,t)}}function VM(n){return(e,t,i,s)=>new HX(e,n,t,i,s)}class Ew{constructor(e,t,i,s,r){this.parser=e,this.parse=t,this.overlay=i,this.target=s,this.from=r}}function Aw(n){if(!n.length||n.some(e=>e.from>=e.to))throw new RangeError("Invalid inner parse ranges given: "+JSON.stringify(n))}class XX{constructor(e,t,i,s,r,o,a){this.parser=e,this.predicate=t,this.mounts=i,this.index=s,this.start=r,this.target=o,this.prev=a,this.depth=0,this.ranges=[]}}const YO=new qe({perNode:!0});class HX{constructor(e,t,i,s,r){this.nest=t,this.input=i,this.fragments=s,this.ranges=r,this.inner=[],this.innerDone=0,this.baseTree=null,this.stoppedAt=null,this.baseParse=e}advance(){if(this.baseParse){let i=this.baseParse.advance();if(!i)return null;if(this.baseParse=null,this.baseTree=i,this.startInner(),this.stoppedAt!=null)for(let s of this.inner)s.parse.stopAt(this.stoppedAt)}if(this.innerDone==this.inner.length){let i=this.baseTree;return this.stoppedAt!=null&&(i=new tt(i.type,i.children,i.positions,i.length,i.propValues.concat([[YO,this.stoppedAt]]))),i}let e=this.inner[this.innerDone],t=e.parse.advance();if(t){this.innerDone++;let i=Object.assign(Object.create(null),e.target.props);i[qe.mounted.id]=new au(t,e.overlay,e.parser),e.target.props=i}return null}get parsedPos(){if(this.baseParse)return 0;let e=this.input.length;for(let t=this.innerDone;t<this.inner.length;t++)this.inner[t].from<e&&(e=Math.min(e,this.inner[t].parse.parsedPos));return e}stopAt(e){if(this.stoppedAt=e,this.baseParse)this.baseParse.stopAt(e);else for(let t=this.innerDone;t<this.inner.length;t++)this.inner[t].parse.stopAt(e)}startInner(){let e=new YX(this.fragments),t=null,i=null,s=new wf(new Si(this.baseTree,this.ranges[0].from,0,null),ft.IncludeAnonymous|ft.IgnoreMounts);e:for(let r,o;;){let a=!0,l;if(this.stoppedAt!=null&&s.from>=this.stoppedAt)a=!1;else if(e.hasNode(s)){if(t){let h=t.mounts.find(u=>u.frag.from<=s.from&&u.frag.to>=s.to&&u.mount.overlay);if(h)for(let u of h.mount.overlay){let c=u.from+h.pos,f=u.to+h.pos;c>=s.from&&f<=s.to&&!t.ranges.some(p=>p.from<f&&p.to>c)&&t.ranges.push({from:c,to:f})}}a=!1}else if(i&&(o=WX(i.ranges,s.from,s.to)))a=o!=2;else if(!s.type.isAnonymous&&(r=this.nest(s,this.input))&&(s.from<s.to||!r.overlay)){s.tree||ZX(s);let h=e.findMounts(s.from,r.parser);if(typeof r.overlay=="function")t=new XX(r.parser,r.overlay,h,this.inner.length,s.from,s.tree,t);else{let u=Mw(this.ranges,r.overlay||(s.from<s.to?[new _n(s.from,s.to)]:[]));u.length&&Aw(u),(u.length||!r.overlay)&&this.inner.push(new Ew(r.parser,u.length?r.parser.startParse(this.input,Iw(h,u),u):r.parser.startParse(""),r.overlay?r.overlay.map(c=>new _n(c.from-s.from,c.to-s.from)):null,s.tree,u.length?u[0].from:s.from)),r.overlay?u.length&&(i={ranges:u,depth:0,prev:i}):a=!1}}else if(t&&(l=t.predicate(s))&&(l===!0&&(l=new _n(s.from,s.to)),l.from<l.to)){let h=t.ranges.length-1;h>=0&&t.ranges[h].to==l.from?t.ranges[h]={from:t.ranges[h].from,to:l.to}:t.ranges.push(l)}if(a&&s.firstChild())t&&t.depth++,i&&i.depth++;else for(;!s.nextSibling();){if(!s.parent())break e;if(t&&!--t.depth){let h=Mw(this.ranges,t.ranges);h.length&&(Aw(h),this.inner.splice(t.index,0,new Ew(t.parser,t.parser.startParse(this.input,Iw(t.mounts,h),h),t.ranges.map(u=>new _n(u.from-t.start,u.to-t.start)),t.target,h[0].from))),t=t.prev}i&&!--i.depth&&(i=i.prev)}}}}function WX(n,e,t){for(let i of n){if(i.from>=t)break;if(i.to>e)return i.from<=e&&i.to>=t?2:1}return 0}function Pw(n,e,t,i,s,r){if(e<t){let o=n.buffer[e+1];i.push(n.slice(e,t,o)),s.push(o-r)}}function ZX(n){let{node:e}=n,t=[],i=e.context.buffer;do t.push(n.index),n.parent();while(!n.tree);let s=n.tree,r=s.children.indexOf(i),o=s.children[r],a=o.buffer,l=[r];function h(u,c,f,p,b,y){let _=t[y],T=[],w=[];Pw(o,u,_,T,w,p);let v=a[_+1],S=a[_+2];l.push(T.length);let k=y?h(_+4,a[_+3],o.set.types[a[_]],v,S-v,y-1):e.toTree();return T.push(k),w.push(v-p),Pw(o,a[_+3],c,T,w,p),new tt(f,T,w,b)}s.children[r]=h(0,a.length,Yt.none,0,o.length,t.length-1);for(let u of l){let c=n.tree.children[u],f=n.tree.positions[u];n.yield(new Si(c,f+n.from,u,n._tree))}}class Dw{constructor(e,t){this.offset=t,this.done=!1,this.cursor=e.cursor(ft.IncludeAnonymous|ft.IgnoreMounts)}moveTo(e){let{cursor:t}=this,i=e-this.offset;for(;!this.done&&t.from<i;)t.to>=e&&t.enter(i,1,ft.IgnoreOverlays|ft.ExcludeBuffers)||t.next(!1)||(this.done=!0)}hasNode(e){if(this.moveTo(e.from),!this.done&&this.cursor.from+this.offset==e.from&&this.cursor.tree)for(let t=this.cursor.tree;;){if(t==e.tree)return!0;if(t.children.length&&t.positions[0]==0&&t.children[0]instanceof tt)t=t.children[0];else break}return!1}}let YX=class{constructor(e){var t;if(this.fragments=e,this.curTo=0,this.fragI=0,e.length){let i=this.curFrag=e[0];this.curTo=(t=i.tree.prop(YO))!==null&&t!==void 0?t:i.to,this.inner=new Dw(i.tree,-i.offset)}else this.curFrag=this.inner=null}hasNode(e){for(;this.curFrag&&e.from>=this.curTo;)this.nextFrag();return this.curFrag&&this.curFrag.from<=e.from&&this.curTo>=e.to&&this.inner.hasNode(e)}nextFrag(){var e;if(this.fragI++,this.fragI==this.fragments.length)this.curFrag=this.inner=null;else{let t=this.curFrag=this.fragments[this.fragI];this.curTo=(e=t.tree.prop(YO))!==null&&e!==void 0?e:t.to,this.inner=new Dw(t.tree,-t.offset)}}findMounts(e,t){var i;let s=[];if(this.inner){this.inner.cursor.moveTo(e,1);for(let r=this.inner.cursor.node;r;r=r.parent){let o=(i=r.tree)===null||i===void 0?void 0:i.prop(qe.mounted);if(o&&o.parser==t)for(let a=this.fragI;a<this.fragments.length;a++){let l=this.fragments[a];if(l.from>=r.to)break;l.tree==this.curFrag.tree&&s.push({frag:l,pos:r.from-l.offset,mount:o})}}}return s}};function Mw(n,e){let t=null,i=e;for(let s=1,r=0;s<n.length;s++){let o=n[s-1].to,a=n[s].from;for(;r<i.length;r++){let l=i[r];if(l.from>=a)break;l.to<=o||(t||(i=t=e.slice()),l.from<o?(t[r]=new _n(l.from,o),l.to>a&&t.splice(r+1,0,new _n(a,l.to))):l.to>a?t[r--]=new _n(a,l.to):t.splice(r--,1))}}return i}function GX(n,e,t,i){let s=0,r=0,o=!1,a=!1,l=-1e9,h=[];for(;;){let u=s==n.length?1e9:o?n[s].to:n[s].from,c=r==e.length?1e9:a?e[r].to:e[r].from;if(o!=a){let f=Math.max(l,t),p=Math.min(u,c,i);f<p&&h.push(new _n(f,p))}if(l=Math.min(u,c),l==1e9)break;u==l&&(o?(o=!1,s++):o=!0),c==l&&(a?(a=!1,r++):a=!0)}return h}function Iw(n,e){let t=[];for(let{pos:i,mount:s,frag:r}of n){let o=i+(s.overlay?s.overlay[0].from:0),a=o+s.tree.length,l=Math.max(r.from,o),h=Math.min(r.to,a);if(s.overlay){let u=s.overlay.map(f=>new _n(f.from+i,f.to+i)),c=GX(e,u,l,h);for(let f=0,p=l;;f++){let b=f==c.length,y=b?h:c[f].from;if(y>p&&t.push(new nr(p,y,s.tree,-o,r.from>=p||r.openStart,r.to<=y||r.openEnd)),b)break;p=c[f].to}}else t.push(new nr(l,h,s.tree,-o,r.from>=o||r.openStart,r.to<=a||r.openEnd))}return t}let KX=0;class Un{constructor(e,t,i){this.set=e,this.base=t,this.modified=i,this.id=KX++}static define(e){if(e?.base)throw new Error("Can not derive from a modified tag");let t=new Un([],null,[]);if(t.set.push(t),e)for(let i of e.set)t.set.push(i);return t}static defineModifier(){let e=new _f;return t=>t.modified.indexOf(e)>-1?t:_f.get(t.base||t,t.modified.concat(e).sort((i,s)=>i.id-s.id))}}let JX=0;class _f{constructor(){this.instances=[],this.id=JX++}static get(e,t){if(!t.length)return e;let i=t[0].instances.find(a=>a.base==e&&eH(t,a.modified));if(i)return i;let s=[],r=new Un(s,e,t);for(let a of t)a.instances.push(r);let o=tH(t);for(let a of e.set)if(!a.modified.length)for(let l of o)s.push(_f.get(a,l));return r}}function eH(n,e){return n.length==e.length&&n.every((t,i)=>t==e[i])}function tH(n){let e=[[]];for(let t=0;t<n.length;t++)for(let i=0,s=e.length;i<s;i++)e.push(e[i].concat(n[t]));return e.sort((t,i)=>i.length-t.length)}function Ol(n){let e=Object.create(null);for(let t in n){let i=n[t];Array.isArray(i)||(i=[i]);for(let s of t.split(" "))if(s){let r=[],o=2,a=s;for(let c=0;;){if(a=="..."&&c>0&&c+3==s.length){o=1;break}let f=/^"(?:[^"\\]|\\.)*?"|[^\/!]+/.exec(a);if(!f)throw new RangeError("Invalid path: "+s);if(r.push(f[0]=="*"?"":f[0][0]=='"'?JSON.parse(f[0]):f[0]),c+=f[0].length,c==s.length)break;let p=s[c++];if(c==s.length&&p=="!"){o=0;break}if(p!="/")throw new RangeError("Invalid path: "+s);a=s.slice(c)}let l=r.length-1,h=r[l];if(!h)throw new RangeError("Invalid path: "+s);let u=new kf(i,o,l>0?r.slice(0,l):null);e[h]=u.sort(e[h])}}return UM.add(e)}const UM=new qe;class kf{constructor(e,t,i,s){this.tags=e,this.mode=t,this.context=i,this.next=s}get opaque(){return this.mode==0}get inherit(){return this.mode==1}sort(e){return!e||e.depth<this.depth?(this.next=e,this):(e.next=this.sort(e.next),e)}get depth(){return this.context?this.context.length:0}}kf.empty=new kf([],2,null);function qM(n,e){let t=Object.create(null);for(let r of n)if(!Array.isArray(r.tag))t[r.tag.id]=r.class;else for(let o of r.tag)t[o.id]=r.class;let{scope:i,all:s=null}=e||{};return{style:r=>{let o=s;for(let a of r)for(let l of a.set){let h=t[l.id];if(h){o=o?o+" "+h:h;break}}return o},scope:i}}function iH(n,e){let t=null;for(let i of n){let s=i.style(e);s&&(t=t?t+" "+s:s)}return t}function nH(n,e,t,i=0,s=n.length){let r=new sH(i,Array.isArray(e)?e:[e],t);r.highlightRange(n.cursor(),i,s,"",r.highlighters),r.flush(s)}class sH{constructor(e,t,i){this.at=e,this.highlighters=t,this.span=i,this.class=""}startSpan(e,t){t!=this.class&&(this.flush(e),e>this.at&&(this.at=e),this.class=t)}flush(e){e>this.at&&this.class&&this.span(this.at,e,this.class)}highlightRange(e,t,i,s,r){let{type:o,from:a,to:l}=e;if(a>=i||l<=t)return;o.isTop&&(r=this.highlighters.filter(p=>!p.scope||p.scope(o)));let h=s,u=rH(e)||kf.empty,c=iH(r,u.tags);if(c&&(h&&(h+=" "),h+=c,u.mode==1&&(s+=(s?" ":"")+c)),this.startSpan(Math.max(t,a),h),u.opaque)return;let f=e.tree&&e.tree.prop(qe.mounted);if(f&&f.overlay){let p=e.node.enter(f.overlay[0].from+a,1),b=this.highlighters.filter(_=>!_.scope||_.scope(f.tree.type)),y=e.firstChild();for(let _=0,T=a;;_++){let w=_<f.overlay.length?f.overlay[_]:null,v=w?w.from+a:l,S=Math.max(t,T),k=Math.min(i,v);if(S<k&&y)for(;e.from<k&&(this.highlightRange(e,S,k,s,r),this.startSpan(Math.min(k,e.to),h),!(e.to>=v||!e.nextSibling())););if(!w||v>i)break;T=w.to+a,T>t&&(this.highlightRange(p.cursor(),Math.max(t,w.from+a),Math.min(i,T),"",b),this.startSpan(Math.min(i,T),h))}y&&e.parent()}else if(e.firstChild()){f&&(s="");do if(!(e.to<=t)){if(e.from>=i)break;this.highlightRange(e,t,i,s,r),this.startSpan(Math.min(i,e.to),h)}while(e.nextSibling());e.parent()}}}function rH(n){let e=n.type.prop(UM);for(;e&&e.context&&!n.matchContext(e.context);)e=e.next;return e||null}const pe=Un.define,jc=pe(),kr=pe(),Rw=pe(kr),Lw=pe(kr),Cr=pe(),Xc=pe(Cr),fg=pe(Cr),us=pe(),ro=pe(us),os=pe(),as=pe(),GO=pe(),Hl=pe(GO),Hc=pe(),j={comment:jc,lineComment:pe(jc),blockComment:pe(jc),docComment:pe(jc),name:kr,variableName:pe(kr),typeName:Rw,tagName:pe(Rw),propertyName:Lw,attributeName:pe(Lw),className:pe(kr),labelName:pe(kr),namespace:pe(kr),macroName:pe(kr),literal:Cr,string:Xc,docString:pe(Xc),character:pe(Xc),attributeValue:pe(Xc),number:fg,integer:pe(fg),float:pe(fg),bool:pe(Cr),regexp:pe(Cr),escape:pe(Cr),color:pe(Cr),url:pe(Cr),keyword:os,self:pe(os),null:pe(os),atom:pe(os),unit:pe(os),modifier:pe(os),operatorKeyword:pe(os),controlKeyword:pe(os),definitionKeyword:pe(os),moduleKeyword:pe(os),operator:as,derefOperator:pe(as),arithmeticOperator:pe(as),logicOperator:pe(as),bitwiseOperator:pe(as),compareOperator:pe(as),updateOperator:pe(as),definitionOperator:pe(as),typeOperator:pe(as),controlOperator:pe(as),punctuation:GO,separator:pe(GO),bracket:Hl,angleBracket:pe(Hl),squareBracket:pe(Hl),paren:pe(Hl),brace:pe(Hl),content:us,heading:ro,heading1:pe(ro),heading2:pe(ro),heading3:pe(ro),heading4:pe(ro),heading5:pe(ro),heading6:pe(ro),contentSeparator:pe(us),list:pe(us),quote:pe(us),emphasis:pe(us),strong:pe(us),link:pe(us),monospace:pe(us),strikethrough:pe(us),inserted:pe(),deleted:pe(),changed:pe(),invalid:pe(),meta:Hc,documentMeta:pe(Hc),annotation:pe(Hc),processingInstruction:pe(Hc),definition:Un.defineModifier(),constant:Un.defineModifier(),function:Un.defineModifier(),standard:Un.defineModifier(),local:Un.defineModifier(),special:Un.defineModifier()};qM([{tag:j.link,class:"tok-link"},{tag:j.heading,class:"tok-heading"},{tag:j.emphasis,class:"tok-emphasis"},{tag:j.strong,class:"tok-strong"},{tag:j.keyword,class:"tok-keyword"},{tag:j.atom,class:"tok-atom"},{tag:j.bool,class:"tok-bool"},{tag:j.url,class:"tok-url"},{tag:j.labelName,class:"tok-labelName"},{tag:j.inserted,class:"tok-inserted"},{tag:j.deleted,class:"tok-deleted"},{tag:j.literal,class:"tok-literal"},{tag:j.string,class:"tok-string"},{tag:j.number,class:"tok-number"},{tag:[j.regexp,j.escape,j.special(j.string)],class:"tok-string2"},{tag:j.variableName,class:"tok-variableName"},{tag:j.local(j.variableName),class:"tok-variableName tok-local"},{tag:j.definition(j.variableName),class:"tok-variableName tok-definition"},{tag:j.special(j.variableName),class:"tok-variableName2"},{tag:j.definition(j.propertyName),class:"tok-propertyName tok-definition"},{tag:j.typeName,class:"tok-typeName"},{tag:j.namespace,class:"tok-namespace"},{tag:j.className,class:"tok-className"},{tag:j.macroName,class:"tok-macroName"},{tag:j.propertyName,class:"tok-propertyName"},{tag:j.operator,class:"tok-operator"},{tag:j.comment,class:"tok-comment"},{tag:j.meta,class:"tok-meta"},{tag:j.invalid,class:"tok-invalid"},{tag:j.punctuation,class:"tok-punctuation"}]);var pg;const vo=new qe;function tv(n){return Qe.define({combine:n?e=>e.concat(n):void 0})}const iv=new qe;class kn{constructor(e,t,i=[],s=""){this.data=e,this.name=s,Zt.prototype.hasOwnProperty("tree")||Object.defineProperty(Zt.prototype,"tree",{get(){return ui(this)}}),this.parser=t,this.extension=[il.of(this),Zt.languageData.of((r,o,a)=>{let l=$w(r,o,a),h=l.type.prop(vo);if(!h)return[];let u=r.facet(h),c=l.type.prop(iv);if(c){let f=l.resolve(o-l.from,a);for(let p of c)if(p.test(f,r)){let b=r.facet(p.facet);return p.type=="replace"?b:b.concat(u)}}return u})].concat(i)}isActiveAt(e,t,i=-1){return $w(e,t,i).type.prop(vo)==this.data}findRegions(e){let t=e.facet(il);if(t?.data==this.data)return[{from:0,to:e.doc.length}];if(!t||!t.allowsNesting)return[];let i=[],s=(r,o)=>{if(r.prop(vo)==this.data){i.push({from:o,to:o+r.length});return}let a=r.prop(qe.mounted);if(a){if(a.tree.prop(vo)==this.data){if(a.overlay)for(let l of a.overlay)i.push({from:l.from+o,to:l.to+o});else i.push({from:o,to:o+r.length});return}else if(a.overlay){let l=i.length;if(s(a.tree,a.overlay[0].from+o),i.length>l)return}}for(let l=0;l<r.children.length;l++){let h=r.children[l];h instanceof tt&&s(h,r.positions[l]+o)}};return s(ui(e),0),i}get allowsNesting(){return!0}}kn.setState=jt.define();function $w(n,e,t){let i=n.facet(il),s=ui(n).topNode;if(!i||i.allowsNesting)for(let r=s;r;r=r.enter(e,t,ft.ExcludeBuffers))r.type.isTop&&(s=r);return s}class el extends kn{constructor(e,t,i){super(e,t,[],i),this.parser=t}static define(e){let t=tv(e.languageData);return new el(t,e.parser.configure({props:[vo.add(i=>i.isTop?t:void 0)]}),e.name)}configure(e,t){return new el(this.data,this.parser.configure(e),t||this.name)}get allowsNesting(){return this.parser.hasWrappers()}}function ui(n){let e=n.field(kn.state,!1);return e?e.tree:tt.empty}class oH{constructor(e){this.doc=e,this.cursorPos=0,this.string="",this.cursor=e.iter()}get length(){return this.doc.length}syncTo(e){return this.string=this.cursor.next(e-this.cursorPos).value,this.cursorPos=e+this.string.length,this.cursorPos-this.string.length}chunk(e){return this.syncTo(e),this.string}get lineChunks(){return!0}read(e,t){let i=this.cursorPos-this.string.length;return e<i||t>=this.cursorPos?this.doc.sliceString(e,t):this.string.slice(e-i,t-i)}}let Wl=null;class hu{constructor(e,t,i=[],s,r,o,a,l){this.parser=e,this.state=t,this.fragments=i,this.tree=s,this.treeLen=r,this.viewport=o,this.skipped=a,this.scheduleOn=l,this.parse=null,this.tempSkipped=[]}static create(e,t,i){return new hu(e,t,[],tt.empty,0,i,[],null)}startParse(){return this.parser.startParse(new oH(this.state.doc),this.fragments)}work(e,t){return t!=null&&t>=this.state.doc.length&&(t=void 0),this.tree!=tt.empty&&this.isDone(t??this.state.doc.length)?(this.takeTree(),!0):this.withContext(()=>{var i;if(typeof e=="number"){let s=Date.now()+e;e=()=>Date.now()>s}for(this.parse||(this.parse=this.startParse()),t!=null&&(this.parse.stoppedAt==null||this.parse.stoppedAt>t)&&t<this.state.doc.length&&this.parse.stopAt(t);;){let s=this.parse.advance();if(s)if(this.fragments=this.withoutTempSkipped(nr.addTree(s,this.fragments,this.parse.stoppedAt!=null)),this.treeLen=(i=this.parse.stoppedAt)!==null&&i!==void 0?i:this.state.doc.length,this.tree=s,this.parse=null,this.treeLen<(t??this.state.doc.length))this.parse=this.startParse();else return!0;if(e())return!1}})}takeTree(){let e,t;this.parse&&(e=this.parse.parsedPos)>=this.treeLen&&((this.parse.stoppedAt==null||this.parse.stoppedAt>e)&&this.parse.stopAt(e),this.withContext(()=>{for(;!(t=this.parse.advance()););}),this.treeLen=e,this.tree=t,this.fragments=this.withoutTempSkipped(nr.addTree(this.tree,this.fragments,!0)),this.parse=null)}withContext(e){let t=Wl;Wl=this;try{return e()}finally{Wl=t}}withoutTempSkipped(e){for(let t;t=this.tempSkipped.pop();)e=Qw(e,t.from,t.to);return e}changes(e,t){let{fragments:i,tree:s,treeLen:r,viewport:o,skipped:a}=this;if(this.takeTree(),!e.empty){let l=[];if(e.iterChangedRanges((h,u,c,f)=>l.push({fromA:h,toA:u,fromB:c,toB:f})),i=nr.applyChanges(i,l),s=tt.empty,r=0,o={from:e.mapPos(o.from,-1),to:e.mapPos(o.to,1)},this.skipped.length){a=[];for(let h of this.skipped){let u=e.mapPos(h.from,1),c=e.mapPos(h.to,-1);u<c&&a.push({from:u,to:c})}}}return new hu(this.parser,t,i,s,r,o,a,this.scheduleOn)}updateViewport(e){if(this.viewport.from==e.from&&this.viewport.to==e.to)return!1;this.viewport=e;let t=this.skipped.length;for(let i=0;i<this.skipped.length;i++){let{from:s,to:r}=this.skipped[i];s<e.to&&r>e.from&&(this.fragments=Qw(this.fragments,s,r),this.skipped.splice(i--,1))}return this.skipped.length>=t?!1:(this.reset(),!0)}reset(){this.parse&&(this.takeTree(),this.parse=null)}skipUntilInView(e,t){this.skipped.push({from:e,to:t})}static getSkippingParser(e){return new class extends ev{createParse(t,i,s){let r=s[0].from,o=s[s.length-1].to;return{parsedPos:r,advance(){let l=Wl;if(l){for(let h of s)l.tempSkipped.push(h);e&&(l.scheduleOn=l.scheduleOn?Promise.all([l.scheduleOn,e]):e)}return this.parsedPos=o,new tt(Yt.none,[],[],o-r)},stoppedAt:null,stopAt(){}}}}}isDone(e){e=Math.min(e,this.state.doc.length);let t=this.fragments;return this.treeLen>=e&&t.length&&t[0].from==0&&t[0].to>=e}static get(){return Wl}}function Qw(n,e,t){return nr.applyChanges(n,[{fromA:e,toA:t,fromB:e,toB:t}])}class tl{constructor(e){this.context=e,this.tree=e.tree}apply(e){if(!e.docChanged&&this.tree==this.context.tree)return this;let t=this.context.changes(e.changes,e.state),i=this.context.treeLen==e.startState.doc.length?void 0:Math.max(e.changes.mapPos(this.context.treeLen),t.viewport.to);return t.work(20,i)||t.takeTree(),new tl(t)}static init(e){let t=Math.min(3e3,e.doc.length),i=hu.create(e.facet(il).parser,e,{from:0,to:t});return i.work(20,t)||i.takeTree(),new tl(i)}}kn.state=ml.define({create:tl.init,update(n,e){for(let t of e.effects)if(t.is(kn.setState))return t.value;return e.startState.facet(il)!=e.state.facet(il)?tl.init(e.state):n.apply(e)}});let zM=n=>{let e=setTimeout(()=>n(),500);return()=>clearTimeout(e)};typeof requestIdleCallback<"u"&&(zM=n=>{let e=-1,t=setTimeout(()=>{e=requestIdleCallback(n,{timeout:400})},100);return()=>e<0?clearTimeout(t):cancelIdleCallback(e)});const mg=typeof navigator<"u"&&(!((pg=navigator.scheduling)===null||pg===void 0)&&pg.isInputPending)?()=>navigator.scheduling.isInputPending():null,aH=Kd.fromClass(class{constructor(e){this.view=e,this.working=null,this.workScheduled=0,this.chunkEnd=-1,this.chunkBudget=-1,this.work=this.work.bind(this),this.scheduleWork()}update(e){let t=this.view.state.field(kn.state).context;(t.updateViewport(e.view.viewport)||this.view.viewport.to>t.treeLen)&&this.scheduleWork(),(e.docChanged||e.selectionSet)&&(this.view.hasFocus&&(this.chunkBudget+=50),this.scheduleWork()),this.checkAsyncSchedule(t)}scheduleWork(){if(this.working)return;let{state:e}=this.view,t=e.field(kn.state);(t.tree!=t.context.tree||!t.context.isDone(e.doc.length))&&(this.working=zM(this.work))}work(e){this.working=null;let t=Date.now();if(this.chunkEnd<t&&(this.chunkEnd<0||this.view.hasFocus)&&(this.chunkEnd=t+3e4,this.chunkBudget=3e3),this.chunkBudget<=0)return;let{state:i,viewport:{to:s}}=this.view,r=i.field(kn.state);if(r.tree==r.context.tree&&r.context.isDone(s+1e5))return;let o=Date.now()+Math.min(this.chunkBudget,100,e&&!mg?Math.max(25,e.timeRemaining()-5):1e9),a=r.context.treeLen<s&&i.doc.length>s+1e3,l=r.context.work(()=>mg&&mg()||Date.now()>o,s+(a?0:1e5));this.chunkBudget-=Date.now()-t,(l||this.chunkBudget<=0)&&(r.context.takeTree(),this.view.dispatch({effects:kn.setState.of(new tl(r.context))})),this.chunkBudget>0&&!(l&&!a)&&this.scheduleWork(),this.checkAsyncSchedule(r.context)}checkAsyncSchedule(e){e.scheduleOn&&(this.workScheduled++,e.scheduleOn.then(()=>this.scheduleWork()).catch(t=>vs(this.view.state,t)).then(()=>this.workScheduled--),e.scheduleOn=null)}destroy(){this.working&&this.working()}isWorking(){return!!(this.working||this.workScheduled>0)}},{eventHandlers:{focus(){this.scheduleWork()}}}),il=Qe.define({combine(n){return n.length?n[0]:null},enables:n=>[kn.state,aH,Ve.contentAttributes.compute([n],e=>{let t=e.facet(n);return t&&t.name?{"data-language":t.name}:{}})]});class uu{constructor(e,t=[]){this.language=e,this.support=t,this.extension=[e,t]}}class Cf{constructor(e,t,i,s,r,o=void 0){this.name=e,this.alias=t,this.extensions=i,this.filename=s,this.loadFunc=r,this.support=o,this.loading=null}load(){return this.loading||(this.loading=this.loadFunc().then(e=>this.support=e,e=>{throw this.loading=null,e}))}static of(e){let{load:t,support:i}=e;if(!t){if(!i)throw new RangeError("Must pass either 'load' or 'support' to LanguageDescription.of");t=()=>Promise.resolve(i)}return new Cf(e.name,(e.alias||[]).concat(e.name).map(s=>s.toLowerCase()),e.extensions||[],e.filename,t,i)}static matchFilename(e,t){for(let s of e)if(s.filename&&s.filename.test(t))return s;let i=/\.([^.]+)$/.exec(t);if(i){for(let s of e)if(s.extensions.indexOf(i[1])>-1)return s}return null}static matchLanguageName(e,t,i=!0){t=t.toLowerCase();for(let s of e)if(s.alias.some(r=>r==t))return s;if(i)for(let s of e)for(let r of s.alias){let o=t.indexOf(r);if(o>-1&&(r.length>2||!/\w/.test(t[o-1])&&!/\w/.test(t[o+r.length])))return s}return null}}const jM=Qe.define({combine:n=>{if(!n.length)return"  ";let e=n[0];if(!e||/\S/.test(e)||Array.from(e).some(t=>t!=e[0]))throw new Error("Invalid indent unit: "+JSON.stringify(n[0]));return e}}),_p=new qe;function lH(n){let e=n.node,t=e.childAfter(e.from),i=e.lastChild;if(!t)return null;let s=n.options.simulateBreak,r=n.state.doc.lineAt(t.from),o=s==null||s<=r.from?r.to:Math.min(r.to,s);for(let a=t.to;;){let l=e.childAfter(a);if(!l||l==i)return null;if(!l.type.isSkipped){if(l.from>=o)return null;let h=/^ */.exec(r.text.slice(t.to-r.from))[0].length;return{from:t.from,to:t.to+h}}a=l.to}}function hH({closing:n,align:e=!0,units:t=1}){return i=>uH(i,e,t,n)}function uH(n,e,t,i,s){let r=n.textAfter,o=r.match(/^\s*/)[0].length,a=i&&r.slice(o,o+i.length)==i||s==n.pos+o,l=e?lH(n):null;return l?a?n.column(l.from):n.column(l.to):n.baseIndent+(a?0:n.unit*t)}const cH=n=>n.baseIndent;function yd({except:n,units:e=1}={}){return t=>{let i=n&&n.test(t.textAfter);return t.baseIndent+(i?0:e*t.unit)}}const dH=Qe.define(),$u=new qe;function XM(n){let e=n.firstChild,t=n.lastChild;return e&&e.to<t.from?{from:e.to,to:t.type.isError?n.to:t.from}:null}class kp{constructor(e,t){this.specs=e;let i;function s(a){let l=Ti.newName();return(i||(i=Object.create(null)))["."+l]=a,l}const r=typeof t.all=="string"?t.all:t.all?s(t.all):void 0,o=t.scope;this.scope=o instanceof kn?a=>a.prop(vo)==o.data:o?a=>a==o:void 0,this.style=qM(e.map(a=>({tag:a.tag,class:a.class||s(Object.assign({},a,{tag:null}))})),{all:r}).style,this.module=i?new Ti(i):null,this.themeType=t.themeType}static define(e,t){return new kp(e,t||{})}}const KO=Qe.define(),fH=Qe.define({combine(n){return n.length?[n[0]]:null}});function gg(n){let e=n.facet(KO);return e.length?e:n.facet(fH)}function pH(n,e){let t=[gH],i;return n instanceof kp&&(n.module&&t.push(Ve.styleModule.of(n.module)),i=n.themeType),i?t.push(KO.computeN([Ve.darkTheme],s=>s.facet(Ve.darkTheme)==(i=="dark")?[n]:[])):t.push(KO.of(n)),t}class mH{constructor(e){this.markCache=Object.create(null),this.tree=ui(e.state),this.decorations=this.buildDeco(e,gg(e.state)),this.decoratedTo=e.viewport.to}update(e){let t=ui(e.state),i=gg(e.state),s=i!=gg(e.startState),{viewport:r}=e.view,o=e.changes.mapPos(this.decoratedTo,1);t.length<r.to&&!s&&t.type==this.tree.type&&o>=r.to?(this.decorations=this.decorations.map(e.changes),this.decoratedTo=o):(t!=this.tree||e.viewportChanged||s)&&(this.tree=t,this.decorations=this.buildDeco(e.view,i),this.decoratedTo=r.to)}buildDeco(e,t){if(!t||!this.tree.length)return Ft.none;let i=new w0;for(let{from:s,to:r}of e.visibleRanges)nH(this.tree,t,(o,a,l)=>{i.add(o,a,this.markCache[l]||(this.markCache[l]=Ft.mark({class:l})))},s,r);return i.finish()}}const gH=ku.high(Kd.fromClass(mH,{decorations:n=>n.decorations})),OH=new qe,yH=Object.create(null),Bw=[Yt.none],Nw=[],Fw=Object.create(null),bH=Object.create(null);for(let[n,e]of[["variable","variableName"],["variable-2","variableName.special"],["string-2","string.special"],["def","variableName.definition"],["tag","tagName"],["attribute","attributeName"],["type","typeName"],["builtin","variableName.standard"],["qualifier","modifier"],["error","invalid"],["header","heading"],["property","propertyName"]])bH[n]=vH(yH,e);function Og(n,e){Nw.indexOf(n)>-1||(Nw.push(n),console.warn(e))}function vH(n,e){let t=[];for(let a of e.split(" ")){let l=[];for(let h of a.split(".")){let u=n[h]||j[h];u?typeof u=="function"?l.length?l=l.map(u):Og(h,`Modifier ${h} used at start of tag`):l.length?Og(h,`Tag ${h} used as modifier`):l=Array.isArray(u)?u:[u]:Og(h,`Unknown highlighting tag ${h}`)}for(let h of l)t.push(h)}if(!t.length)return 0;let i=e.replace(/ /g,"_"),s=i+" "+t.map(a=>a.id),r=Fw[s];if(r)return r.id;let o=Fw[s]=Yt.define({id:Bw.length,name:i,props:[Ol({[i]:t})]});return Bw.push(o),o.id}li.RTL,li.LTR;class SH{constructor(e,t,i,s){this.state=e,this.pos=t,this.explicit=i,this.view=s,this.abortListeners=[],this.abortOnDocChange=!1}tokenBefore(e){let t=ui(this.state).resolveInner(this.pos,-1);for(;t&&e.indexOf(t.name)<0;)t=t.parent;return t?{from:t.from,to:this.pos,text:this.state.sliceDoc(t.from,this.pos),type:t.type}:null}matchBefore(e){let t=this.state.doc.lineAt(this.pos),i=Math.max(t.from,this.pos-250),s=t.text.slice(i-t.from,this.pos-t.from),r=s.search(_H(e));return r<0?null:{from:i+r,to:this.pos,text:s.slice(r)}}get aborted(){return this.abortListeners==null}addEventListener(e,t,i){e=="abort"&&this.abortListeners&&(this.abortListeners.push(t),i&&i.onDocChange&&(this.abortOnDocChange=!0))}}function Vw(n){let e=Object.keys(n).join(""),t=/\w/.test(e);return t&&(e=e.replace(/\w/g,"")),`[${t?"\\w":""}${e.replace(/[^\w\s]/g,"\\$&")}]`}function xH(n){let e=Object.create(null),t=Object.create(null);for(let{label:s}of n){e[s[0]]=!0;for(let r=1;r<s.length;r++)t[s[r]]=!0}let i=Vw(e)+Vw(t)+"*$";return[new RegExp("^"+i),new RegExp(i)]}function TH(n){let e=n.map(s=>typeof s=="string"?{label:s}:s),[t,i]=e.every(s=>/^\w+$/.test(s.label))?[/\w*$/,/\w+$/]:xH(e);return s=>{let r=s.matchBefore(i);return r||s.explicit?{from:r?r.from:s.pos,options:e,validFor:t}:null}}function wH(n,e){return t=>{for(let i=ui(t.state).resolveInner(t.pos,-1);i;i=i.parent){if(n.indexOf(i.name)>-1)return null;if(i.type.isTop)break}return e(t)}}function _H(n,e){var t;let{source:i}=n,s=i[i.length-1]!="$";return s?new RegExp(`(?:${i})${s?"$":""}`,(t=n.flags)!==null&&t!==void 0?t:n.ignoreCase?"i":""):n}const kH=Fo.define(),CH=Ve.baseTheme({".cm-tooltip.cm-tooltip-autocomplete":{"& > ul":{fontFamily:"monospace",whiteSpace:"nowrap",overflow:"hidden auto",maxWidth_fallback:"700px",maxWidth:"min(700px, 95vw)",minWidth:"250px",maxHeight:"10em",height:"100%",listStyle:"none",margin:0,padding:0,"& > li, & > completion-section":{padding:"1px 3px",lineHeight:1.2},"& > li":{overflowX:"hidden",textOverflow:"ellipsis",cursor:"pointer"},"& > completion-section":{display:"list-item",borderBottom:"1px solid silver",paddingLeft:"0.5em",opacity:.7}}},"&light .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#17c",color:"white"},"&light .cm-tooltip-autocomplete-disabled ul li[aria-selected]":{background:"#777"},"&dark .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#347",color:"white"},"&dark .cm-tooltip-autocomplete-disabled ul li[aria-selected]":{background:"#444"},".cm-completionListIncompleteTop:before, .cm-completionListIncompleteBottom:after":{content:'"···"',opacity:.5,display:"block",textAlign:"center"},".cm-tooltip.cm-completionInfo":{position:"absolute",padding:"3px 9px",width:"max-content",maxWidth:"400px",boxSizing:"border-box",whiteSpace:"pre-line"},".cm-completionInfo.cm-completionInfo-left":{right:"100%"},".cm-completionInfo.cm-completionInfo-right":{left:"100%"},".cm-completionInfo.cm-completionInfo-left-narrow":{right:"30px"},".cm-completionInfo.cm-completionInfo-right-narrow":{left:"30px"},"&light .cm-snippetField":{backgroundColor:"#00000022"},"&dark .cm-snippetField":{backgroundColor:"#ffffff22"},".cm-snippetFieldPosition":{verticalAlign:"text-top",width:0,height:"1.15em",display:"inline-block",margin:"0 -0.7px -.7em",borderLeft:"1.4px dotted #888"},".cm-completionMatchedText":{textDecoration:"underline"},".cm-completionDetail":{marginLeft:"0.5em",fontStyle:"italic"},".cm-completionIcon":{fontSize:"90%",width:".8em",display:"inline-block",textAlign:"center",paddingRight:".6em",opacity:"0.6",boxSizing:"content-box"},".cm-completionIcon-function, .cm-completionIcon-method":{"&:after":{content:"'ƒ'"}},".cm-completionIcon-class":{"&:after":{content:"'○'"}},".cm-completionIcon-interface":{"&:after":{content:"'◌'"}},".cm-completionIcon-variable":{"&:after":{content:"'𝑥'"}},".cm-completionIcon-constant":{"&:after":{content:"'𝐶'"}},".cm-completionIcon-type":{"&:after":{content:"'𝑡'"}},".cm-completionIcon-enum":{"&:after":{content:"'∪'"}},".cm-completionIcon-property":{"&:after":{content:"'□'"}},".cm-completionIcon-keyword":{"&:after":{content:"'🔑︎'"}},".cm-completionIcon-namespace":{"&:after":{content:"'▢'"}},".cm-completionIcon-text":{"&:after":{content:"'abc'",fontSize:"50%",verticalAlign:"middle"}}});class EH{constructor(e,t,i,s){this.field=e,this.line=t,this.from=i,this.to=s}}class nv{constructor(e,t,i){this.field=e,this.from=t,this.to=i}map(e){let t=e.mapPos(this.from,-1,Ri.TrackDel),i=e.mapPos(this.to,1,Ri.TrackDel);return t==null||i==null?null:new nv(this.field,t,i)}}class sv{constructor(e,t){this.lines=e,this.fieldPositions=t}instantiate(e,t){let i=[],s=[t],r=e.doc.lineAt(t),o=/^\s*/.exec(r.text)[0];for(let l of this.lines){if(i.length){let h=o,u=/^\t*/.exec(l)[0].length;for(let c=0;c<u;c++)h+=e.facet(jM);s.push(t+h.length-u),l=h+l.slice(u)}i.push(l),t+=l.length+1}let a=this.fieldPositions.map(l=>new nv(l.field,s[l.line]+l.from,s[l.line]+l.to));return{text:i,ranges:a}}static parse(e){let t=[],i=[],s=[],r;for(let o of e.split(/\r\n?|\n/)){for(;r=/[#$]\{(?:(\d+)(?::([^{}]*))?|((?:\\[{}]|[^{}])*))\}/.exec(o);){let a=r[1]?+r[1]:null,l=r[2]||r[3]||"",h=-1,u=l.replace(/\\[{}]/g,c=>c[1]);for(let c=0;c<t.length;c++)(a!=null?t[c].seq==a:u&&t[c].name==u)&&(h=c);if(h<0){let c=0;for(;c<t.length&&(a==null||t[c].seq!=null&&t[c].seq<a);)c++;t.splice(c,0,{seq:a,name:u}),h=c;for(let f of s)f.field>=h&&f.field++}for(let c of s)if(c.line==i.length&&c.from>r.index){let f=r[2]?3+(r[1]||"").length:2;c.from-=f,c.to-=f}s.push(new EH(h,i.length,r.index,r.index+u.length)),o=o.slice(0,r.index)+l+o.slice(r.index+r[0].length)}o=o.replace(/\\([{}])/g,(a,l,h)=>{for(let u of s)u.line==i.length&&u.from>h&&(u.from--,u.to--);return l}),i.push(o)}return new sv(i,s)}}let AH=Ft.widget({widget:new class extends lp{toDOM(){let n=document.createElement("span");return n.className="cm-snippetFieldPosition",n}ignoreEvent(){return!1}}}),PH=Ft.mark({class:"cm-snippetField"});class yl{constructor(e,t){this.ranges=e,this.active=t,this.deco=Ft.set(e.map(i=>(i.from==i.to?AH:PH).range(i.from,i.to)),!0)}map(e){let t=[];for(let i of this.ranges){let s=i.map(e);if(!s)return null;t.push(s)}return new yl(t,this.active)}selectionInsideField(e){return e.ranges.every(t=>this.ranges.some(i=>i.field==this.active&&i.from<=t.from&&i.to>=t.to))}}const Qu=jt.define({map(n,e){return n&&n.map(e)}}),DH=jt.define(),cu=ml.define({create(){return null},update(n,e){for(let t of e.effects){if(t.is(Qu))return t.value;if(t.is(DH)&&n)return new yl(n.ranges,t.value)}return n&&e.docChanged&&(n=n.map(e.changes)),n&&e.selection&&!n.selectionInsideField(e.selection)&&(n=null),n},provide:n=>Ve.decorations.from(n,e=>e?e.deco:Ft.none)});function rv(n,e){return ke.create(n.filter(t=>t.field==e).map(t=>ke.range(t.from,t.to)))}function MH(n){let e=sv.parse(n);return(t,i,s,r)=>{let{text:o,ranges:a}=e.instantiate(t.state,s),{main:l}=t.state.selection,h={changes:{from:s,to:r==l.from?l.to:r,insert:Ke.of(o)},scrollIntoView:!0,annotations:i?[kH.of(i),En.userEvent.of("input.complete")]:void 0};if(a.length&&(h.selection=rv(a,0)),a.some(u=>u.field>0)){let u=new yl(a,0),c=h.effects=[Qu.of(u)];t.state.field(cu,!1)===void 0&&c.push(jt.appendConfig.of([cu,QH,BH,CH]))}t.dispatch(t.state.update(h))}}function HM(n){return({state:e,dispatch:t})=>{let i=e.field(cu,!1);if(!i||n<0&&i.active==0)return!1;let s=i.active+n,r=n>0&&!i.ranges.some(o=>o.field==s+n);return t(e.update({selection:rv(i.ranges,s),effects:Qu.of(r?null:new yl(i.ranges,s)),scrollIntoView:!0})),!0}}const IH=({state:n,dispatch:e})=>n.field(cu,!1)?(e(n.update({effects:Qu.of(null)})),!0):!1,RH=HM(1),LH=HM(-1),$H=[{key:"Tab",run:RH,shift:LH},{key:"Escape",run:IH}],Uw=Qe.define({combine(n){return n.length?n[0]:$H}}),QH=ku.highest(vb.compute([Uw],n=>n.facet(Uw)));function Fi(n,e){return{...e,apply:MH(n)}}const BH=Ve.domEventHandlers({mousedown(n,e){let t=e.state.field(cu,!1),i;if(!t||(i=e.posAtCoords({x:n.clientX,y:n.clientY}))==null)return!1;let s=t.ranges.find(r=>r.from<=i&&r.to>=i);return!s||s.field==t.active?!1:(e.dispatch({selection:rv(t.ranges,s.field),effects:Qu.of(t.ranges.some(r=>r.field>s.field)?new yl(t.ranges,s.field):null),scrollIntoView:!0}),!0)}}),WM=new class extends Mo{};WM.startSide=1;WM.endSide=-1;class Ef{static create(e,t,i,s,r){let o=s+(s<<8)+e+(t<<4)|0;return new Ef(e,t,i,o,r,[],[])}constructor(e,t,i,s,r,o,a){this.type=e,this.value=t,this.from=i,this.hash=s,this.end=r,this.children=o,this.positions=a,this.hashProp=[[qe.contextHash,s]]}addChild(e,t){e.prop(qe.contextHash)!=this.hash&&(e=new tt(e.type,e.children,e.positions,e.length,this.hashProp)),this.children.push(e),this.positions.push(t)}toTree(e,t=this.end){let i=this.children.length-1;return i>=0&&(t=Math.max(t,this.positions[i]+this.children[i].length+this.from)),new tt(e.types[this.type],this.children,this.positions,t-this.from).balance({makeTree:(s,r,o)=>new tt(Yt.none,s,r,o,this.hashProp)})}}var ue;(function(n){n[n.Document=1]="Document",n[n.CodeBlock=2]="CodeBlock",n[n.FencedCode=3]="FencedCode",n[n.Blockquote=4]="Blockquote",n[n.HorizontalRule=5]="HorizontalRule",n[n.BulletList=6]="BulletList",n[n.OrderedList=7]="OrderedList",n[n.ListItem=8]="ListItem",n[n.ATXHeading1=9]="ATXHeading1",n[n.ATXHeading2=10]="ATXHeading2",n[n.ATXHeading3=11]="ATXHeading3",n[n.ATXHeading4=12]="ATXHeading4",n[n.ATXHeading5=13]="ATXHeading5",n[n.ATXHeading6=14]="ATXHeading6",n[n.SetextHeading1=15]="SetextHeading1",n[n.SetextHeading2=16]="SetextHeading2",n[n.HTMLBlock=17]="HTMLBlock",n[n.LinkReference=18]="LinkReference",n[n.Paragraph=19]="Paragraph",n[n.CommentBlock=20]="CommentBlock",n[n.ProcessingInstructionBlock=21]="ProcessingInstructionBlock",n[n.Escape=22]="Escape",n[n.Entity=23]="Entity",n[n.HardBreak=24]="HardBreak",n[n.Emphasis=25]="Emphasis",n[n.StrongEmphasis=26]="StrongEmphasis",n[n.Link=27]="Link",n[n.Image=28]="Image",n[n.InlineCode=29]="InlineCode",n[n.HTMLTag=30]="HTMLTag",n[n.Comment=31]="Comment",n[n.ProcessingInstruction=32]="ProcessingInstruction",n[n.Autolink=33]="Autolink",n[n.HeaderMark=34]="HeaderMark",n[n.QuoteMark=35]="QuoteMark",n[n.ListMark=36]="ListMark",n[n.LinkMark=37]="LinkMark",n[n.EmphasisMark=38]="EmphasisMark",n[n.CodeMark=39]="CodeMark",n[n.CodeText=40]="CodeText",n[n.CodeInfo=41]="CodeInfo",n[n.LinkTitle=42]="LinkTitle",n[n.LinkLabel=43]="LinkLabel",n[n.URL=44]="URL"})(ue||(ue={}));class NH{constructor(e,t){this.start=e,this.content=t,this.marks=[],this.parsers=[]}}class FH{constructor(){this.text="",this.baseIndent=0,this.basePos=0,this.depth=0,this.markers=[],this.pos=0,this.indent=0,this.next=-1}forward(){this.basePos>this.pos&&this.forwardInner()}forwardInner(){let e=this.skipSpace(this.basePos);this.indent=this.countIndent(e,this.pos,this.indent),this.pos=e,this.next=e==this.text.length?-1:this.text.charCodeAt(e)}skipSpace(e){return Lh(this.text,e)}reset(e){for(this.text=e,this.baseIndent=this.basePos=this.pos=this.indent=0,this.forwardInner(),this.depth=1;this.markers.length;)this.markers.pop()}moveBase(e){this.basePos=e,this.baseIndent=this.countIndent(e,this.pos,this.indent)}moveBaseColumn(e){this.baseIndent=e,this.basePos=this.findColumn(e)}addMarker(e){this.markers.push(e)}countIndent(e,t=0,i=0){for(let s=t;s<e;s++)i+=this.text.charCodeAt(s)==9?4-i%4:1;return i}findColumn(e){let t=0;for(let i=0;t<this.text.length&&i<e;t++)i+=this.text.charCodeAt(t)==9?4-i%4:1;return t}scrub(){if(!this.baseIndent)return this.text;let e="";for(let t=0;t<this.basePos;t++)e+=" ";return e+this.text.slice(this.basePos)}}function qw(n,e,t){if(t.pos==t.text.length||n!=e.block&&t.indent>=e.stack[t.depth+1].value+t.baseIndent)return!0;if(t.indent>=t.baseIndent+4)return!1;let i=(n.type==ue.OrderedList?lv:av)(t,e,!1);return i>0&&(n.type!=ue.BulletList||ov(t,e,!1)<0)&&t.text.charCodeAt(t.pos+i-1)==n.value}const ZM={[ue.Blockquote](n,e,t){return t.next!=62?!1:(t.markers.push(Xe(ue.QuoteMark,e.lineStart+t.pos,e.lineStart+t.pos+1)),t.moveBase(t.pos+(Rn(t.text.charCodeAt(t.pos+1))?2:1)),n.end=e.lineStart+t.text.length,!0)},[ue.ListItem](n,e,t){return t.indent<t.baseIndent+n.value&&t.next>-1?!1:(t.moveBaseColumn(t.baseIndent+n.value),!0)},[ue.OrderedList]:qw,[ue.BulletList]:qw,[ue.Document](){return!0}};function Rn(n){return n==32||n==9||n==10||n==13}function Lh(n,e=0){for(;e<n.length&&Rn(n.charCodeAt(e));)e++;return e}function zw(n,e,t){for(;e>t&&Rn(n.charCodeAt(e-1));)e--;return e}function YM(n){if(n.next!=96&&n.next!=126)return-1;let e=n.pos+1;for(;e<n.text.length&&n.text.charCodeAt(e)==n.next;)e++;if(e<n.pos+3)return-1;if(n.next==96){for(let t=e;t<n.text.length;t++)if(n.text.charCodeAt(t)==96)return-1}return e}function GM(n){return n.next!=62?-1:n.text.charCodeAt(n.pos+1)==32?2:1}function ov(n,e,t){if(n.next!=42&&n.next!=45&&n.next!=95)return-1;let i=1;for(let s=n.pos+1;s<n.text.length;s++){let r=n.text.charCodeAt(s);if(r==n.next)i++;else if(!Rn(r))return-1}return t&&n.next==45&&eI(n)>-1&&n.depth==e.stack.length&&e.parser.leafBlockParsers.indexOf(sI.SetextHeading)>-1||i<3?-1:1}function KM(n,e){for(let t=n.stack.length-1;t>=0;t--)if(n.stack[t].type==e)return!0;return!1}function av(n,e,t){return(n.next==45||n.next==43||n.next==42)&&(n.pos==n.text.length-1||Rn(n.text.charCodeAt(n.pos+1)))&&(!t||KM(e,ue.BulletList)||n.skipSpace(n.pos+2)<n.text.length)?1:-1}function lv(n,e,t){let i=n.pos,s=n.next;for(;s>=48&&s<=57;){i++;if(i==n.text.length)return-1;s=n.text.charCodeAt(i)}return i==n.pos||i>n.pos+9||s!=46&&s!=41||i<n.text.length-1&&!Rn(n.text.charCodeAt(i+1))||t&&!KM(e,ue.OrderedList)&&(n.skipSpace(i+1)==n.text.length||i>n.pos+1||n.next!=49)?-1:i+1-n.pos}function JM(n){if(n.next!=35)return-1;let e=n.pos+1;for(;e<n.text.length&&n.text.charCodeAt(e)==35;)e++;if(e<n.text.length&&n.text.charCodeAt(e)!=32)return-1;let t=e-n.pos;return t>6?-1:t}function eI(n){if(n.next!=45&&n.next!=61||n.indent>=n.baseIndent+4)return-1;let e=n.pos+1;for(;e<n.text.length&&n.text.charCodeAt(e)==n.next;)e++;let t=e;for(;e<n.text.length&&Rn(n.text.charCodeAt(e));)e++;return e==n.text.length?t:-1}const JO=/^[ \t]*$/,tI=/-->/,iI=/\?>/,ey=[[/^<(?:script|pre|style)(?:\s|>|$)/i,/<\/(?:script|pre|style)>/i],[/^\s*<!--/,tI],[/^\s*<\?/,iI],[/^\s*<![A-Z]/,/>/],[/^\s*<!\[CDATA\[/,/\]\]>/],[/^\s*<\/?(?:address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h1|h2|h3|h4|h5|h6|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|nav|noframes|ol|optgroup|option|p|param|section|source|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul)(?:\s|\/?>|$)/i,JO],[/^\s*(?:<\/[a-z][\w-]*\s*>|<[a-z][\w-]*(\s+[a-z:_][\w-.]*(?:\s*=\s*(?:[^\s"'=<>`]+|'[^']*'|"[^"]*"))?)*\s*>)\s*$/i,JO]];function nI(n,e,t){if(n.next!=60)return-1;let i=n.text.slice(n.pos);for(let s=0,r=ey.length-(t?1:0);s<r;s++)if(ey[s][0].test(i))return s;return-1}function jw(n,e){let t=n.countIndent(e,n.pos,n.indent),i=n.countIndent(n.skipSpace(e),e,t);return i>=t+5?t+1:i}function oo(n,e,t){let i=n.length-1;i>=0&&n[i].to==e&&n[i].type==ue.CodeText?n[i].to=t:n.push(Xe(ue.CodeText,e,t))}const Wc={LinkReference:void 0,IndentedCode(n,e){let t=e.baseIndent+4;if(e.indent<t)return!1;let i=e.findColumn(t),s=n.lineStart+i,r=n.lineStart+e.text.length,o=[],a=[];for(oo(o,s,r);n.nextLine()&&e.depth>=n.stack.length;)if(e.pos==e.text.length){oo(a,n.lineStart-1,n.lineStart);for(let l of e.markers)a.push(l)}else{if(e.indent<t)break;{if(a.length){for(let h of a)h.type==ue.CodeText?oo(o,h.from,h.to):o.push(h);a=[]}oo(o,n.lineStart-1,n.lineStart);for(let h of e.markers)o.push(h);r=n.lineStart+e.text.length;let l=n.lineStart+e.findColumn(e.baseIndent+4);l<r&&oo(o,l,r)}}return a.length&&(a=a.filter(l=>l.type!=ue.CodeText),a.length&&(e.markers=a.concat(e.markers))),n.addNode(n.buffer.writeElements(o,-s).finish(ue.CodeBlock,r-s),s),!0},FencedCode(n,e){let t=YM(e);if(t<0)return!1;let i=n.lineStart+e.pos,s=e.next,r=t-e.pos,o=e.skipSpace(t),a=zw(e.text,e.text.length,o),l=[Xe(ue.CodeMark,i,i+r)];o<a&&l.push(Xe(ue.CodeInfo,n.lineStart+o,n.lineStart+a));for(let h=!0;n.nextLine()&&e.depth>=n.stack.length;h=!1){let u=e.pos;if(e.indent-e.baseIndent<4)for(;u<e.text.length&&e.text.charCodeAt(u)==s;)u++;if(u-e.pos>=r&&e.skipSpace(u)==e.text.length){for(let c of e.markers)l.push(c);l.push(Xe(ue.CodeMark,n.lineStart+e.pos,n.lineStart+u)),n.nextLine();break}else{h||oo(l,n.lineStart-1,n.lineStart);for(let p of e.markers)l.push(p);let c=n.lineStart+e.basePos,f=n.lineStart+e.text.length;c<f&&oo(l,c,f)}}return n.addNode(n.buffer.writeElements(l,-i).finish(ue.FencedCode,n.prevLineEnd()-i),i),!0},Blockquote(n,e){let t=GM(e);return t<0?!1:(n.startContext(ue.Blockquote,e.pos),n.addNode(ue.QuoteMark,n.lineStart+e.pos,n.lineStart+e.pos+1),e.moveBase(e.pos+t),null)},HorizontalRule(n,e){if(ov(e,n,!1)<0)return!1;let t=n.lineStart+e.pos;return n.nextLine(),n.addNode(ue.HorizontalRule,t),!0},BulletList(n,e){let t=av(e,n,!1);if(t<0)return!1;n.block.type!=ue.BulletList&&n.startContext(ue.BulletList,e.basePos,e.next);let i=jw(e,e.pos+1);return n.startContext(ue.ListItem,e.basePos,i-e.baseIndent),n.addNode(ue.ListMark,n.lineStart+e.pos,n.lineStart+e.pos+t),e.moveBaseColumn(i),null},OrderedList(n,e){let t=lv(e,n,!1);if(t<0)return!1;n.block.type!=ue.OrderedList&&n.startContext(ue.OrderedList,e.basePos,e.text.charCodeAt(e.pos+t-1));let i=jw(e,e.pos+t);return n.startContext(ue.ListItem,e.basePos,i-e.baseIndent),n.addNode(ue.ListMark,n.lineStart+e.pos,n.lineStart+e.pos+t),e.moveBaseColumn(i),null},ATXHeading(n,e){let t=JM(e);if(t<0)return!1;let i=e.pos,s=n.lineStart+i,r=zw(e.text,e.text.length,i),o=r;for(;o>i&&e.text.charCodeAt(o-1)==e.next;)o--;(o==r||o==i||!Rn(e.text.charCodeAt(o-1)))&&(o=e.text.length);let a=n.buffer.write(ue.HeaderMark,0,t).writeElements(n.parser.parseInline(e.text.slice(i+t+1,o),s+t+1),-s);o<e.text.length&&a.write(ue.HeaderMark,o-i,r-i);let l=a.finish(ue.ATXHeading1-1+t,e.text.length-i);return n.nextLine(),n.addNode(l,s),!0},HTMLBlock(n,e){let t=nI(e,n,!1);if(t<0)return!1;let i=n.lineStart+e.pos,s=ey[t][1],r=[],o=s!=JO;for(;!s.test(e.text)&&n.nextLine();){if(e.depth<n.stack.length){o=!1;break}for(let h of e.markers)r.push(h)}o&&n.nextLine();let a=s==tI?ue.CommentBlock:s==iI?ue.ProcessingInstructionBlock:ue.HTMLBlock,l=n.prevLineEnd();return n.addNode(n.buffer.writeElements(r,-i).finish(a,l-i),i),!0},SetextHeading:void 0};class VH{constructor(e){this.stage=0,this.elts=[],this.pos=0,this.start=e.start,this.advance(e.content)}nextLine(e,t,i){if(this.stage==-1)return!1;let s=i.content+`
`+t.scrub(),r=this.advance(s);return r>-1&&r<s.length?this.complete(e,i,r):!1}finish(e,t){return(this.stage==2||this.stage==3)&&Lh(t.content,this.pos)==t.content.length?this.complete(e,t,t.content.length):!1}complete(e,t,i){return e.addLeafElement(t,Xe(ue.LinkReference,this.start,this.start+i,this.elts)),!0}nextStage(e){return e?(this.pos=e.to-this.start,this.elts.push(e),this.stage++,!0):(e===!1&&(this.stage=-1),!1)}advance(e){for(;;){if(this.stage==-1)return-1;if(this.stage==0){if(!this.nextStage(fI(e,this.pos,this.start,!0)))return-1;if(e.charCodeAt(this.pos)!=58)return this.stage=-1;this.elts.push(Xe(ue.LinkMark,this.pos+this.start,this.pos+this.start+1)),this.pos++}else if(this.stage==1){if(!this.nextStage(cI(e,Lh(e,this.pos),this.start)))return-1}else if(this.stage==2){let t=Lh(e,this.pos),i=0;if(t>this.pos){let s=dI(e,t,this.start);if(s){let r=yg(e,s.to-this.start);r>0&&(this.nextStage(s),i=r)}}return i||(i=yg(e,this.pos)),i>0&&i<e.length?i:-1}else return yg(e,this.pos)}}}function yg(n,e){for(;e<n.length;e++){let t=n.charCodeAt(e);if(t==10)break;if(!Rn(t))return-1}return e}class UH{nextLine(e,t,i){let s=t.depth<e.stack.length?-1:eI(t),r=t.next;if(s<0)return!1;let o=Xe(ue.HeaderMark,e.lineStart+t.pos,e.lineStart+s);return e.nextLine(),e.addLeafElement(i,Xe(r==61?ue.SetextHeading1:ue.SetextHeading2,i.start,e.prevLineEnd(),[...e.parser.parseInline(i.content,i.start),o])),!0}finish(){return!1}}const sI={LinkReference(n,e){return e.content.charCodeAt(0)==91?new VH(e):null},SetextHeading(){return new UH}},qH=[(n,e)=>JM(e)>=0,(n,e)=>YM(e)>=0,(n,e)=>GM(e)>=0,(n,e)=>av(e,n,!0)>=0,(n,e)=>lv(e,n,!0)>=0,(n,e)=>ov(e,n,!0)>=0,(n,e)=>nI(e,n,!0)>=0],zH={text:"",end:0};class jH{constructor(e,t,i,s){this.parser=e,this.input=t,this.ranges=s,this.line=new FH,this.atEnd=!1,this.reusePlaceholders=new Map,this.stoppedAt=null,this.rangeI=0,this.to=s[s.length-1].to,this.lineStart=this.absoluteLineStart=this.absoluteLineEnd=s[0].from,this.block=Ef.create(ue.Document,0,this.lineStart,0,0),this.stack=[this.block],this.fragments=i.length?new ZH(i,t):null,this.readLine()}get parsedPos(){return this.absoluteLineStart}advance(){if(this.stoppedAt!=null&&this.absoluteLineStart>this.stoppedAt)return this.finish();let{line:e}=this;for(;;){for(let i=0;;){let s=e.depth<this.stack.length?this.stack[this.stack.length-1]:null;for(;i<e.markers.length&&(!s||e.markers[i].from<s.end);){let r=e.markers[i++];this.addNode(r.type,r.from,r.to)}if(!s)break;this.finishContext()}if(e.pos<e.text.length)break;if(!this.nextLine())return this.finish()}if(this.fragments&&this.reuseFragment(e.basePos))return null;e:for(;;){for(let i of this.parser.blockParsers)if(i){let s=i(this,e);if(s!=!1){if(s==!0)return null;e.forward();continue e}}break}let t=new NH(this.lineStart+e.pos,e.text.slice(e.pos));for(let i of this.parser.leafBlockParsers)if(i){let s=i(this,t);s&&t.parsers.push(s)}e:for(;this.nextLine()&&e.pos!=e.text.length;){if(e.indent<e.baseIndent+4){for(let i of this.parser.endLeafBlock)if(i(this,e,t))break e}for(let i of t.parsers)if(i.nextLine(this,e,t))return null;t.content+=`
`+e.scrub();for(let i of e.markers)t.marks.push(i)}return this.finishLeaf(t),null}stopAt(e){if(this.stoppedAt!=null&&this.stoppedAt<e)throw new RangeError("Can't move stoppedAt forward");this.stoppedAt=e}reuseFragment(e){if(!this.fragments.moveTo(this.absoluteLineStart+e,this.absoluteLineStart)||!this.fragments.matches(this.block.hash))return!1;let t=this.fragments.takeNodes(this);return t?(this.absoluteLineStart+=t,this.lineStart=pI(this.absoluteLineStart,this.ranges),this.moveRangeI(),this.absoluteLineStart<this.to?(this.lineStart++,this.absoluteLineStart++,this.readLine()):(this.atEnd=!0,this.readLine()),!0):!1}get depth(){return this.stack.length}parentType(e=this.depth-1){return this.parser.nodeSet.types[this.stack[e].type]}nextLine(){return this.lineStart+=this.line.text.length,this.absoluteLineEnd>=this.to?(this.absoluteLineStart=this.absoluteLineEnd,this.atEnd=!0,this.readLine(),!1):(this.lineStart++,this.absoluteLineStart=this.absoluteLineEnd+1,this.moveRangeI(),this.readLine(),!0)}peekLine(){return this.scanLine(this.absoluteLineEnd+1).text}moveRangeI(){for(;this.rangeI<this.ranges.length-1&&this.absoluteLineStart>=this.ranges[this.rangeI].to;)this.rangeI++,this.absoluteLineStart=Math.max(this.absoluteLineStart,this.ranges[this.rangeI].from)}scanLine(e){let t=zH;if(t.end=e,e>=this.to)t.text="";else if(t.text=this.lineChunkAt(e),t.end+=t.text.length,this.ranges.length>1){let i=this.absoluteLineStart,s=this.rangeI;for(;this.ranges[s].to<t.end;){s++;let r=this.ranges[s].from,o=this.lineChunkAt(r);t.end=r+o.length,t.text=t.text.slice(0,this.ranges[s-1].to-i)+o,i=t.end-t.text.length}}return t}readLine(){let{line:e}=this,{text:t,end:i}=this.scanLine(this.absoluteLineStart);for(this.absoluteLineEnd=i,e.reset(t);e.depth<this.stack.length;e.depth++){let s=this.stack[e.depth],r=this.parser.skipContextMarkup[s.type];if(!r)throw new Error("Unhandled block context "+ue[s.type]);if(!r(s,this,e))break;e.forward()}}lineChunkAt(e){let t=this.input.chunk(e),i;if(this.input.lineChunks)i=t==`
`?"":t;else{let s=t.indexOf(`
`);i=s<0?t:t.slice(0,s)}return e+i.length>this.to?i.slice(0,this.to-e):i}prevLineEnd(){return this.atEnd?this.lineStart:this.lineStart-1}startContext(e,t,i=0){this.block=Ef.create(e,i,this.lineStart+t,this.block.hash,this.lineStart+this.line.text.length),this.stack.push(this.block)}startComposite(e,t,i=0){this.startContext(this.parser.getNodeType(e),t,i)}addNode(e,t,i){typeof e=="number"&&(e=new tt(this.parser.nodeSet.types[e],nl,nl,(i??this.prevLineEnd())-t)),this.block.addChild(e,t-this.block.from)}addElement(e){this.block.addChild(e.toTree(this.parser.nodeSet),e.from-this.block.from)}addLeafElement(e,t){this.addNode(this.buffer.writeElements(ny(t.children,e.marks),-t.from).finish(t.type,t.to-t.from),t.from)}finishContext(){let e=this.stack.pop(),t=this.stack[this.stack.length-1];t.addChild(e.toTree(this.parser.nodeSet),e.from-t.from),this.block=t}finish(){for(;this.stack.length>1;)this.finishContext();return this.addGaps(this.block.toTree(this.parser.nodeSet,this.lineStart))}addGaps(e){return this.ranges.length>1?rI(this.ranges,0,e.topNode,this.ranges[0].from,this.reusePlaceholders):e}finishLeaf(e){for(let i of e.parsers)if(i.finish(this,e))return;let t=ny(this.parser.parseInline(e.content,e.start),e.marks);this.addNode(this.buffer.writeElements(t,-e.start).finish(ue.Paragraph,e.content.length),e.start)}elt(e,t,i,s){return typeof e=="string"?Xe(this.parser.getNodeType(e),t,i,s):new lI(e,t)}get buffer(){return new aI(this.parser.nodeSet)}}function rI(n,e,t,i,s){let r=n[e].to,o=[],a=[],l=t.from+i;function h(u,c){for(;c?u>=r:u>r;){let f=n[e+1].from-r;i+=f,u+=f,e++,r=n[e].to}}for(let u=t.firstChild;u;u=u.nextSibling){h(u.from+i,!0);let c=u.from+i,f,p=s.get(u.tree);p?f=p:u.to+i>r?(f=rI(n,e,u,i,s),h(u.to+i,!1)):f=u.toTree(),o.push(f),a.push(c-l)}return h(t.to+i,!1),new tt(t.type,o,a,t.to+i-l,t.tree?t.tree.propValues:void 0)}class Cp extends ev{constructor(e,t,i,s,r,o,a,l,h){super(),this.nodeSet=e,this.blockParsers=t,this.leafBlockParsers=i,this.blockNames=s,this.endLeafBlock=r,this.skipContextMarkup=o,this.inlineParsers=a,this.inlineNames=l,this.wrappers=h,this.nodeTypes=Object.create(null);for(let u of e.types)this.nodeTypes[u.name]=u.id}createParse(e,t,i){let s=new jH(this,e,t,i);for(let r of this.wrappers)s=r(s,e,t,i);return s}configure(e){let t=ty(e);if(!t)return this;let{nodeSet:i,skipContextMarkup:s}=this,r=this.blockParsers.slice(),o=this.leafBlockParsers.slice(),a=this.blockNames.slice(),l=this.inlineParsers.slice(),h=this.inlineNames.slice(),u=this.endLeafBlock.slice(),c=this.wrappers;if(Zl(t.defineNodes)){s=Object.assign({},s);let f=i.types.slice(),p;for(let b of t.defineNodes){let{name:y,block:_,composite:T,style:w}=typeof b=="string"?{name:b}:b;if(f.some(k=>k.name==y))continue;T&&(s[f.length]=(k,A,M)=>T(A,M,k.value));let v=f.length,S=T?["Block","BlockContext"]:_?v>=ue.ATXHeading1&&v<=ue.SetextHeading2?["Block","LeafBlock","Heading"]:["Block","LeafBlock"]:void 0;f.push(Yt.define({id:v,name:y,props:S&&[[qe.group,S]]})),w&&(p||(p={}),Array.isArray(w)||w instanceof Un?p[y]=w:Object.assign(p,w))}i=new Lu(f),p&&(i=i.extend(Ol(p)))}if(Zl(t.props)&&(i=i.extend(...t.props)),Zl(t.remove))for(let f of t.remove){let p=this.blockNames.indexOf(f),b=this.inlineNames.indexOf(f);p>-1&&(r[p]=o[p]=void 0),b>-1&&(l[b]=void 0)}if(Zl(t.parseBlock))for(let f of t.parseBlock){let p=a.indexOf(f.name);if(p>-1)r[p]=f.parse,o[p]=f.leaf;else{let b=f.before?Zc(a,f.before):f.after?Zc(a,f.after)+1:a.length-1;r.splice(b,0,f.parse),o.splice(b,0,f.leaf),a.splice(b,0,f.name)}f.endLeaf&&u.push(f.endLeaf)}if(Zl(t.parseInline))for(let f of t.parseInline){let p=h.indexOf(f.name);if(p>-1)l[p]=f.parse;else{let b=f.before?Zc(h,f.before):f.after?Zc(h,f.after)+1:h.length-1;l.splice(b,0,f.parse),h.splice(b,0,f.name)}}return t.wrap&&(c=c.concat(t.wrap)),new Cp(i,r,o,a,u,s,l,h,c)}getNodeType(e){let t=this.nodeTypes[e];if(t==null)throw new RangeError(`Unknown node type '${e}'`);return t}parseInline(e,t){let i=new HH(this,e,t);e:for(let s=t;s<i.end;){let r=i.char(s);for(let o of this.inlineParsers)if(o){let a=o(i,r,s);if(a>=0){s=a;continue e}}s++}return i.resolveMarkers(0)}}function Zl(n){return n!=null&&n.length>0}function ty(n){if(!Array.isArray(n))return n;if(n.length==0)return null;let e=ty(n[0]);if(n.length==1)return e;let t=ty(n.slice(1));if(!t||!e)return e||t;let i=(o,a)=>(o||nl).concat(a||nl),s=e.wrap,r=t.wrap;return{props:i(e.props,t.props),defineNodes:i(e.defineNodes,t.defineNodes),parseBlock:i(e.parseBlock,t.parseBlock),parseInline:i(e.parseInline,t.parseInline),remove:i(e.remove,t.remove),wrap:s?r?(o,a,l,h)=>s(r(o,a,l,h),a,l,h):s:r}}function Zc(n,e){let t=n.indexOf(e);if(t<0)throw new RangeError(`Position specified relative to unknown parser ${e}`);return t}let oI=[Yt.none];for(let n=1,e;e=ue[n];n++)oI[n]=Yt.define({id:n,name:e,props:n>=ue.Escape?[]:[[qe.group,n in ZM?["Block","BlockContext"]:["Block","LeafBlock"]]],top:e=="Document"});const nl=[];let aI=class{constructor(e){this.nodeSet=e,this.content=[],this.nodes=[]}write(e,t,i,s=0){return this.content.push(e,t,i,4+s*4),this}writeElements(e,t=0){for(let i of e)i.writeTo(this,t);return this}finish(e,t){return tt.build({buffer:this.content,nodeSet:this.nodeSet,reused:this.nodes,topID:e,length:t})}},du=class{constructor(e,t,i,s=nl){this.type=e,this.from=t,this.to=i,this.children=s}writeTo(e,t){let i=e.content.length;e.writeElements(this.children,t),e.content.push(this.type,this.from+t,this.to+t,e.content.length+4-i)}toTree(e){return new aI(e).writeElements(this.children,-this.from).finish(this.type,this.to-this.from)}};class lI{constructor(e,t){this.tree=e,this.from=t}get to(){return this.from+this.tree.length}get type(){return this.tree.type.id}get children(){return nl}writeTo(e,t){e.nodes.push(this.tree),e.content.push(e.nodes.length-1,this.from+t,this.to+t,-1)}toTree(){return this.tree}}function Xe(n,e,t,i){return new du(n,e,t,i)}const hI={resolve:"Emphasis",mark:"EmphasisMark"},uI={resolve:"Emphasis",mark:"EmphasisMark"},sa={},iy={};class vn{constructor(e,t,i,s){this.type=e,this.from=t,this.to=i,this.side=s}}const Xw="!\"#$%&'()*+,-./:;<=>?@[\\]^_`{|}~";let fu=/[!"#$%&'()*+,\-.\/:;<=>?@\[\\\]^_`{|}~\xA1\u2010-\u2027]/;try{fu=new RegExp("[\\p{S}|\\p{P}]","u")}catch{}const bg={Escape(n,e,t){if(e!=92||t==n.end-1)return-1;let i=n.char(t+1);for(let s=0;s<Xw.length;s++)if(Xw.charCodeAt(s)==i)return n.append(Xe(ue.Escape,t,t+2));return-1},Entity(n,e,t){if(e!=38)return-1;let i=/^(?:#\d+|#x[a-f\d]+|\w+);/i.exec(n.slice(t+1,t+31));return i?n.append(Xe(ue.Entity,t,t+1+i[0].length)):-1},InlineCode(n,e,t){if(e!=96||t&&n.char(t-1)==96)return-1;let i=t+1;for(;i<n.end&&n.char(i)==96;)i++;let s=i-t,r=0;for(;i<n.end;i++)if(n.char(i)==96){if(r++,r==s&&n.char(i+1)!=96)return n.append(Xe(ue.InlineCode,t,i+1,[Xe(ue.CodeMark,t,t+s),Xe(ue.CodeMark,i+1-s,i+1)]))}else r=0;return-1},HTMLTag(n,e,t){if(e!=60||t==n.end-1)return-1;let i=n.slice(t+1,n.end),s=/^(?:[a-z][-\w+.]+:[^\s>]+|[a-z\d.!#$%&'*+/=?^_`{|}~-]+@[a-z\d](?:[a-z\d-]{0,61}[a-z\d])?(?:\.[a-z\d](?:[a-z\d-]{0,61}[a-z\d])?)*)>/i.exec(i);if(s)return n.append(Xe(ue.Autolink,t,t+1+s[0].length,[Xe(ue.LinkMark,t,t+1),Xe(ue.URL,t+1,t+s[0].length),Xe(ue.LinkMark,t+s[0].length,t+1+s[0].length)]));let r=/^!--[^>](?:-[^-]|[^-])*?-->/i.exec(i);if(r)return n.append(Xe(ue.Comment,t,t+1+r[0].length));let o=/^\?[^]*?\?>/.exec(i);if(o)return n.append(Xe(ue.ProcessingInstruction,t,t+1+o[0].length));let a=/^(?:![A-Z][^]*?>|!\[CDATA\[[^]*?\]\]>|\/\s*[a-zA-Z][\w-]*\s*>|\s*[a-zA-Z][\w-]*(\s+[a-zA-Z:_][\w-.:]*(?:\s*=\s*(?:[^\s"'=<>`]+|'[^']*'|"[^"]*"))?)*\s*(\/\s*)?>)/.exec(i);return a?n.append(Xe(ue.HTMLTag,t,t+1+a[0].length)):-1},Emphasis(n,e,t){if(e!=95&&e!=42)return-1;let i=t+1;for(;n.char(i)==e;)i++;let s=n.slice(t-1,t),r=n.slice(i,i+1),o=fu.test(s),a=fu.test(r),l=/\s|^$/.test(s),h=/\s|^$/.test(r),u=!h&&(!a||l||o),c=!l&&(!o||h||a),f=u&&(e==42||!c||o),p=c&&(e==42||!u||a);return n.append(new vn(e==95?hI:uI,t,i,(f?1:0)|(p?2:0)))},HardBreak(n,e,t){if(e==92&&n.char(t+1)==10)return n.append(Xe(ue.HardBreak,t,t+2));if(e==32){let i=t+1;for(;n.char(i)==32;)i++;if(n.char(i)==10&&i>=t+2)return n.append(Xe(ue.HardBreak,t,i+1))}return-1},Link(n,e,t){return e==91?n.append(new vn(sa,t,t+1,1)):-1},Image(n,e,t){return e==33&&n.char(t+1)==91?n.append(new vn(iy,t,t+2,1)):-1},LinkEnd(n,e,t){if(e!=93)return-1;for(let i=n.parts.length-1;i>=0;i--){let s=n.parts[i];if(s instanceof vn&&(s.type==sa||s.type==iy)){if(!s.side||n.skipSpace(s.to)==t&&!/[(\[]/.test(n.slice(t+1,t+2)))return n.parts[i]=null,-1;let r=n.takeContent(i),o=n.parts[i]=XH(n,r,s.type==sa?ue.Link:ue.Image,s.from,t+1);if(s.type==sa)for(let a=0;a<i;a++){let l=n.parts[a];l instanceof vn&&l.type==sa&&(l.side=0)}return o.to}}return-1}};function XH(n,e,t,i,s){let{text:r}=n,o=n.char(s),a=s;if(e.unshift(Xe(ue.LinkMark,i,i+(t==ue.Image?2:1))),e.push(Xe(ue.LinkMark,s-1,s)),o==40){let l=n.skipSpace(s+1),h=cI(r,l-n.offset,n.offset),u;h&&(l=n.skipSpace(h.to),l!=h.to&&(u=dI(r,l-n.offset,n.offset),u&&(l=n.skipSpace(u.to)))),n.char(l)==41&&(e.push(Xe(ue.LinkMark,s,s+1)),a=l+1,h&&e.push(h),u&&e.push(u),e.push(Xe(ue.LinkMark,l,a)))}else if(o==91){let l=fI(r,s-n.offset,n.offset,!1);l&&(e.push(l),a=l.to)}return Xe(t,i,a,e)}function cI(n,e,t){if(n.charCodeAt(e)==60){for(let s=e+1;s<n.length;s++){let r=n.charCodeAt(s);if(r==62)return Xe(ue.URL,e+t,s+1+t);if(r==60||r==10)return!1}return null}else{let s=0,r=e;for(let o=!1;r<n.length;r++){let a=n.charCodeAt(r);if(Rn(a))break;if(o)o=!1;else if(a==40)s++;else if(a==41){if(!s)break;s--}else a==92&&(o=!0)}return r>e?Xe(ue.URL,e+t,r+t):r==n.length?null:!1}}function dI(n,e,t){let i=n.charCodeAt(e);if(i!=39&&i!=34&&i!=40)return!1;let s=i==40?41:i;for(let r=e+1,o=!1;r<n.length;r++){let a=n.charCodeAt(r);if(o)o=!1;else{if(a==s)return Xe(ue.LinkTitle,e+t,r+1+t);a==92&&(o=!0)}}return null}function fI(n,e,t,i){for(let s=!1,r=e+1,o=Math.min(n.length,r+999);r<o;r++){let a=n.charCodeAt(r);if(s)s=!1;else{if(a==93)return i?!1:Xe(ue.LinkLabel,e+t,r+1+t);if(i&&!Rn(a)&&(i=!1),a==91)return!1;a==92&&(s=!0)}}return null}class HH{constructor(e,t,i){this.parser=e,this.text=t,this.offset=i,this.parts=[]}char(e){return e>=this.end?-1:this.text.charCodeAt(e-this.offset)}get end(){return this.offset+this.text.length}slice(e,t){return this.text.slice(e-this.offset,t-this.offset)}append(e){return this.parts.push(e),e.to}addDelimiter(e,t,i,s,r){return this.append(new vn(e,t,i,(s?1:0)|(r?2:0)))}get hasOpenLink(){for(let e=this.parts.length-1;e>=0;e--){let t=this.parts[e];if(t instanceof vn&&(t.type==sa||t.type==iy))return!0}return!1}addElement(e){return this.append(e)}resolveMarkers(e){for(let i=e;i<this.parts.length;i++){let s=this.parts[i];if(!(s instanceof vn&&s.type.resolve&&s.side&2))continue;let r=s.type==hI||s.type==uI,o=s.to-s.from,a,l=i-1;for(;l>=e;l--){let y=this.parts[l];if(y instanceof vn&&y.side&1&&y.type==s.type&&!(r&&(s.side&1||y.side&2)&&(y.to-y.from+o)%3==0&&((y.to-y.from)%3||o%3))){a=y;break}}if(!a)continue;let h=s.type.resolve,u=[],c=a.from,f=s.to;if(r){let y=Math.min(2,a.to-a.from,o);c=a.to-y,f=s.from+y,h=y==1?"Emphasis":"StrongEmphasis"}a.type.mark&&u.push(this.elt(a.type.mark,c,a.to));for(let y=l+1;y<i;y++)this.parts[y]instanceof du&&u.push(this.parts[y]),this.parts[y]=null;s.type.mark&&u.push(this.elt(s.type.mark,s.from,f));let p=this.elt(h,c,f,u);this.parts[l]=r&&a.from!=c?new vn(a.type,a.from,c,a.side):null,(this.parts[i]=r&&s.to!=f?new vn(s.type,f,s.to,s.side):null)?this.parts.splice(i,0,p):this.parts[i]=p}let t=[];for(let i=e;i<this.parts.length;i++){let s=this.parts[i];s instanceof du&&t.push(s)}return t}findOpeningDelimiter(e){for(let t=this.parts.length-1;t>=0;t--){let i=this.parts[t];if(i instanceof vn&&i.type==e)return t}return null}takeContent(e){let t=this.resolveMarkers(e);return this.parts.length=e,t}skipSpace(e){return Lh(this.text,e-this.offset)+this.offset}elt(e,t,i,s){return typeof e=="string"?Xe(this.parser.getNodeType(e),t,i,s):new lI(e,t)}}function ny(n,e){if(!e.length)return n;if(!n.length)return e;let t=n.slice(),i=0;for(let s of e){for(;i<t.length&&t[i].to<s.to;)i++;if(i<t.length&&t[i].from<s.from){let r=t[i];r instanceof du&&(t[i]=new du(r.type,r.from,r.to,ny(r.children,[s])))}else t.splice(i++,0,s)}return t}const WH=[ue.CodeBlock,ue.ListItem,ue.OrderedList,ue.BulletList];let ZH=class{constructor(e,t){this.fragments=e,this.input=t,this.i=0,this.fragment=null,this.fragmentEnd=-1,this.cursor=null,e.length&&(this.fragment=e[this.i++])}nextFragment(){this.fragment=this.i<this.fragments.length?this.fragments[this.i++]:null,this.cursor=null,this.fragmentEnd=-1}moveTo(e,t){for(;this.fragment&&this.fragment.to<=e;)this.nextFragment();if(!this.fragment||this.fragment.from>(e?e-1:0))return!1;if(this.fragmentEnd<0){let r=this.fragment.to;for(;r>0&&this.input.read(r-1,r)!=`
`;)r--;this.fragmentEnd=r?r-1:0}let i=this.cursor;i||(i=this.cursor=this.fragment.tree.cursor(),i.firstChild());let s=e+this.fragment.offset;for(;i.to<=s;)if(!i.parent())return!1;for(;;){if(i.from>=s)return this.fragment.from<=t;if(!i.childAfter(s))return!1}}matches(e){let t=this.cursor.tree;return t&&t.prop(qe.contextHash)==e}takeNodes(e){let t=this.cursor,i=this.fragment.offset,s=this.fragmentEnd-(this.fragment.openEnd?1:0),r=e.absoluteLineStart,o=r,a=e.block.children.length,l=o,h=a;for(;;){if(t.to-i>s){if(t.type.isAnonymous&&t.firstChild())continue;break}let u=pI(t.from-i,e.ranges);if(t.to-i<=e.ranges[e.rangeI].to)e.addNode(t.tree,u);else{let c=new tt(e.parser.nodeSet.types[ue.Paragraph],[],[],0,e.block.hashProp);e.reusePlaceholders.set(c,t.tree),e.addNode(c,u)}if(t.type.is("Block")&&(WH.indexOf(t.type.id)<0?(o=t.to-i,a=e.block.children.length):(o=l,a=h,l=t.to-i,h=e.block.children.length)),!t.nextSibling())break}for(;e.block.children.length>a;)e.block.children.pop(),e.block.positions.pop();return o-r}};function pI(n,e){let t=n;for(let i=1;i<e.length;i++){let s=e[i-1].to,r=e[i].from;s<n&&(t-=r-s)}return t}const YH=Ol({"Blockquote/...":j.quote,HorizontalRule:j.contentSeparator,"ATXHeading1/... SetextHeading1/...":j.heading1,"ATXHeading2/... SetextHeading2/...":j.heading2,"ATXHeading3/...":j.heading3,"ATXHeading4/...":j.heading4,"ATXHeading5/...":j.heading5,"ATXHeading6/...":j.heading6,"Comment CommentBlock":j.comment,Escape:j.escape,Entity:j.character,"Emphasis/...":j.emphasis,"StrongEmphasis/...":j.strong,"Link/... Image/...":j.link,"OrderedList/... BulletList/...":j.list,"BlockQuote/...":j.quote,"InlineCode CodeText":j.monospace,"URL Autolink":j.url,"HeaderMark HardBreak QuoteMark ListMark LinkMark EmphasisMark CodeMark":j.processingInstruction,"CodeInfo LinkLabel":j.labelName,LinkTitle:j.string,Paragraph:j.content}),GH=new Cp(new Lu(oI).extend(YH),Object.keys(Wc).map(n=>Wc[n]),Object.keys(Wc).map(n=>sI[n]),Object.keys(Wc),qH,ZM,Object.keys(bg).map(n=>bg[n]),Object.keys(bg),[]);function KH(n,e,t){let i=[];for(let s=n.firstChild,r=e;;s=s.nextSibling){let o=s?s.from:t;if(o>r&&i.push({from:r,to:o}),!s)break;r=s.to}return i}function JH(n){let{codeParser:e,htmlParser:t}=n;return{wrap:VM((s,r)=>{let o=s.type.id;if(e&&(o==ue.CodeBlock||o==ue.FencedCode)){let a="";if(o==ue.FencedCode){let h=s.node.getChild(ue.CodeInfo);h&&(a=r.read(h.from,h.to))}let l=e(a);if(l)return{parser:l,overlay:h=>h.type.id==ue.CodeText}}else if(t&&(o==ue.HTMLBlock||o==ue.HTMLTag||o==ue.CommentBlock))return{parser:t,overlay:KH(s.node,s.from,s.to)};return null})}}const eW={resolve:"Strikethrough",mark:"StrikethroughMark"},tW={defineNodes:[{name:"Strikethrough",style:{"Strikethrough/...":j.strikethrough}},{name:"StrikethroughMark",style:j.processingInstruction}],parseInline:[{name:"Strikethrough",parse(n,e,t){if(e!=126||n.char(t+1)!=126||n.char(t+2)==126)return-1;let i=n.slice(t-1,t),s=n.slice(t+2,t+3),r=/\s|^$/.test(i),o=/\s|^$/.test(s),a=fu.test(i),l=fu.test(s);return n.addDelimiter(eW,t,t+2,!o&&(!l||r||a),!r&&(!a||o||l))},after:"Emphasis"}]};function $h(n,e,t=0,i,s=0){let r=0,o=!0,a=-1,l=-1,h=!1,u=()=>{i.push(n.elt("TableCell",s+a,s+l,n.parser.parseInline(e.slice(a,l),s+a)))};for(let c=t;c<e.length;c++){let f=e.charCodeAt(c);f==124&&!h?((!o||a>-1)&&r++,o=!1,i&&(a>-1&&u(),i.push(n.elt("TableDelimiter",c+s,c+s+1))),a=l=-1):(h||f!=32&&f!=9)&&(a<0&&(a=c),l=c+1),h=!h&&f==92}return a>-1&&(r++,i&&u()),r}function Hw(n,e){for(let t=e;t<n.length;t++){let i=n.charCodeAt(t);if(i==124)return!0;i==92&&t++}return!1}const mI=/^\|?(\s*:?-+:?\s*\|)+(\s*:?-+:?\s*)?$/;class Ww{constructor(){this.rows=null}nextLine(e,t,i){if(this.rows==null){this.rows=!1;let s;if((t.next==45||t.next==58||t.next==124)&&mI.test(s=t.text.slice(t.pos))){let r=[];$h(e,i.content,0,r,i.start)==$h(e,s,t.pos)&&(this.rows=[e.elt("TableHeader",i.start,i.start+i.content.length,r),e.elt("TableDelimiter",e.lineStart+t.pos,e.lineStart+t.text.length)])}}else if(this.rows){let s=[];$h(e,t.text,t.pos,s,e.lineStart),this.rows.push(e.elt("TableRow",e.lineStart+t.pos,e.lineStart+t.text.length,s))}return!1}finish(e,t){return this.rows?(e.addLeafElement(t,e.elt("Table",t.start,t.start+t.content.length,this.rows)),!0):!1}}const iW={defineNodes:[{name:"Table",block:!0},{name:"TableHeader",style:{"TableHeader/...":j.heading}},"TableRow",{name:"TableCell",style:j.content},{name:"TableDelimiter",style:j.processingInstruction}],parseBlock:[{name:"Table",leaf(n,e){return Hw(e.content,0)?new Ww:null},endLeaf(n,e,t){if(t.parsers.some(s=>s instanceof Ww)||!Hw(e.text,e.basePos))return!1;let i=n.peekLine();return mI.test(i)&&$h(n,e.text,e.basePos)==$h(n,i,e.basePos)},before:"SetextHeading"}]};class nW{nextLine(){return!1}finish(e,t){return e.addLeafElement(t,e.elt("Task",t.start,t.start+t.content.length,[e.elt("TaskMarker",t.start,t.start+3),...e.parser.parseInline(t.content.slice(3),t.start+3)])),!0}}const sW={defineNodes:[{name:"Task",block:!0,style:j.list},{name:"TaskMarker",style:j.atom}],parseBlock:[{name:"TaskList",leaf(n,e){return/^\[[ xX]\][ \t]/.test(e.content)&&n.parentType().name=="ListItem"?new nW:null},after:"SetextHeading"}]},Zw=/(www\.)|(https?:\/\/)|([\w.+-]{1,100}@)|(mailto:|xmpp:)/gy,Yw=/[\w-]+(\.[\w-]+)+(\/[^\s<]*)?/gy,rW=/[\w-]+\.[\w-]+($|\/)/,Gw=/[\w.+-]+@[\w-]+(\.[\w.-]+)+/gy,Kw=/\/[a-zA-Z\d@.]+/gy;function Jw(n,e,t,i){let s=0;for(let r=e;r<t;r++)n[r]==i&&s++;return s}function oW(n,e){Yw.lastIndex=e;let t=Yw.exec(n);if(!t||rW.exec(t[0])[0].indexOf("_")>-1)return-1;let i=e+t[0].length;for(;;){let s=n[i-1],r;if(/[?!.,:*_~]/.test(s)||s==")"&&Jw(n,e,i,")")>Jw(n,e,i,"("))i--;else if(s==";"&&(r=/&(?:#\d+|#x[a-f\d]+|\w+);$/.exec(n.slice(e,i))))i=e+r.index;else break}return i}function e_(n,e){Gw.lastIndex=e;let t=Gw.exec(n);if(!t)return-1;let i=t[0][t[0].length-1];return i=="_"||i=="-"?-1:e+t[0].length-(i=="."?1:0)}const aW={parseInline:[{name:"Autolink",parse(n,e,t){let i=t-n.offset;if(i&&/\w/.test(n.text[i-1]))return-1;Zw.lastIndex=i;let s=Zw.exec(n.text),r=-1;if(!s)return-1;if(s[1]||s[2]){if(r=oW(n.text,i+s[0].length),r>-1&&n.hasOpenLink){let o=/([^\[\]]|\[[^\]]*\])*/.exec(n.text.slice(i,r));r=i+o[0].length}}else s[3]?r=e_(n.text,i):(r=e_(n.text,i+s[0].length),r>-1&&s[0]=="xmpp:"&&(Kw.lastIndex=r,s=Kw.exec(n.text),s&&(r=s.index+s[0].length)));return r<0?-1:(n.addElement(n.elt("URL",t,r+n.offset)),r+n.offset)}}]},lW=[iW,sW,tW,aW];function gI(n,e,t){return(i,s,r)=>{if(s!=n||i.char(r+1)==n)return-1;let o=[i.elt(t,r,r+1)];for(let a=r+1;a<i.end;a++){let l=i.char(a);if(l==n)return i.addElement(i.elt(e,r,a+1,o.concat(i.elt(t,a,a+1))));if(l==92&&o.push(i.elt("Escape",a,a+++2)),Rn(l))break}return-1}}const hW={defineNodes:[{name:"Superscript",style:j.special(j.content)},{name:"SuperscriptMark",style:j.processingInstruction}],parseInline:[{name:"Superscript",parse:gI(94,"Superscript","SuperscriptMark")}]},uW={defineNodes:[{name:"Subscript",style:j.special(j.content)},{name:"SubscriptMark",style:j.processingInstruction}],parseInline:[{name:"Subscript",parse:gI(126,"Subscript","SubscriptMark")}]},cW={defineNodes:[{name:"Emoji",style:j.character}],parseInline:[{name:"Emoji",parse(n,e,t){let i;return e!=58||!(i=/^[a-zA-Z_0-9]+:/.exec(n.slice(t+1,n.end)))?-1:n.addElement(n.elt("Emoji",t,t+1+i[0].length))}}]};var t_={};class Af{constructor(e,t,i,s,r,o,a,l,h,u=0,c){this.p=e,this.stack=t,this.state=i,this.reducePos=s,this.pos=r,this.score=o,this.buffer=a,this.bufferBase=l,this.curContext=h,this.lookAhead=u,this.parent=c}toString(){return`[${this.stack.filter((e,t)=>t%3==0).concat(this.state)}]@${this.pos}${this.score?"!"+this.score:""}`}static start(e,t,i=0){let s=e.parser.context;return new Af(e,[],t,i,i,0,[],0,s?new i_(s,s.start):null,0,null)}get context(){return this.curContext?this.curContext.context:null}pushState(e,t){this.stack.push(this.state,t,this.bufferBase+this.buffer.length),this.state=e}reduce(e){var t;let i=e>>19,s=e&65535,{parser:r}=this.p,o=this.reducePos<this.pos-25;o&&this.setLookAhead(this.pos);let a=r.dynamicPrecedence(s);if(a&&(this.score+=a),i==0){this.pushState(r.getGoto(this.state,s,!0),this.reducePos),s<r.minRepeatTerm&&this.storeNode(s,this.reducePos,this.reducePos,o?8:4,!0),this.reduceContext(s,this.reducePos);return}let l=this.stack.length-(i-1)*3-(e&262144?6:0),h=l?this.stack[l-2]:this.p.ranges[0].from,u=this.reducePos-h;u>=2e3&&!(!((t=this.p.parser.nodeSet.types[s])===null||t===void 0)&&t.isAnonymous)&&(h==this.p.lastBigReductionStart?(this.p.bigReductionCount++,this.p.lastBigReductionSize=u):this.p.lastBigReductionSize<u&&(this.p.bigReductionCount=1,this.p.lastBigReductionStart=h,this.p.lastBigReductionSize=u));let c=l?this.stack[l-1]:0,f=this.bufferBase+this.buffer.length-c;if(s<r.minRepeatTerm||e&131072){let p=r.stateFlag(this.state,1)?this.pos:this.reducePos;this.storeNode(s,h,p,f+4,!0)}if(e&262144)this.state=this.stack[l];else{let p=this.stack[l-3];this.state=r.getGoto(p,s,!0)}for(;this.stack.length>l;)this.stack.pop();this.reduceContext(s,h)}storeNode(e,t,i,s=4,r=!1){if(e==0&&(!this.stack.length||this.stack[this.stack.length-1]<this.buffer.length+this.bufferBase)){let o=this,a=this.buffer.length;if(a==0&&o.parent&&(a=o.bufferBase-o.parent.bufferBase,o=o.parent),a>0&&o.buffer[a-4]==0&&o.buffer[a-1]>-1){if(t==i)return;if(o.buffer[a-2]>=t){o.buffer[a-2]=i;return}}}if(!r||this.pos==i)this.buffer.push(e,t,i,s);else{let o=this.buffer.length;if(o>0&&this.buffer[o-4]!=0){let a=!1;for(let l=o;l>0&&this.buffer[l-2]>i;l-=4)if(this.buffer[l-1]>=0){a=!0;break}if(a)for(;o>0&&this.buffer[o-2]>i;)this.buffer[o]=this.buffer[o-4],this.buffer[o+1]=this.buffer[o-3],this.buffer[o+2]=this.buffer[o-2],this.buffer[o+3]=this.buffer[o-1],o-=4,s>4&&(s-=4)}this.buffer[o]=e,this.buffer[o+1]=t,this.buffer[o+2]=i,this.buffer[o+3]=s}}shift(e,t,i,s){if(e&131072)this.pushState(e&65535,this.pos);else if((e&262144)==0){let r=e,{parser:o}=this.p;(s>this.pos||t<=o.maxNode)&&(this.pos=s,o.stateFlag(r,1)||(this.reducePos=s)),this.pushState(r,i),this.shiftContext(t,i),t<=o.maxNode&&this.buffer.push(t,i,s,4)}else this.pos=s,this.shiftContext(t,i),t<=this.p.parser.maxNode&&this.buffer.push(t,i,s,4)}apply(e,t,i,s){e&65536?this.reduce(e):this.shift(e,t,i,s)}useNode(e,t){let i=this.p.reused.length-1;(i<0||this.p.reused[i]!=e)&&(this.p.reused.push(e),i++);let s=this.pos;this.reducePos=this.pos=s+e.length,this.pushState(t,s),this.buffer.push(i,s,this.reducePos,-1),this.curContext&&this.updateContext(this.curContext.tracker.reuse(this.curContext.context,e,this,this.p.stream.reset(this.pos-e.length)))}split(){let e=this,t=e.buffer.length;for(;t>0&&e.buffer[t-2]>e.reducePos;)t-=4;let i=e.buffer.slice(t),s=e.bufferBase+t;for(;e&&s==e.bufferBase;)e=e.parent;return new Af(this.p,this.stack.slice(),this.state,this.reducePos,this.pos,this.score,i,s,this.curContext,this.lookAhead,e)}recoverByDelete(e,t){let i=e<=this.p.parser.maxNode;i&&this.storeNode(e,this.pos,t,4),this.storeNode(0,this.pos,t,i?8:4),this.pos=this.reducePos=t,this.score-=190}canShift(e){for(let t=new dW(this);;){let i=this.p.parser.stateSlot(t.state,4)||this.p.parser.hasAction(t.state,e);if(i==0)return!1;if((i&65536)==0)return!0;t.reduce(i)}}recoverByInsert(e){if(this.stack.length>=300)return[];let t=this.p.parser.nextStates(this.state);if(t.length>8||this.stack.length>=120){let s=[];for(let r=0,o;r<t.length;r+=2)(o=t[r+1])!=this.state&&this.p.parser.hasAction(o,e)&&s.push(t[r],o);if(this.stack.length<120)for(let r=0;s.length<8&&r<t.length;r+=2){let o=t[r+1];s.some((a,l)=>l&1&&a==o)||s.push(t[r],o)}t=s}let i=[];for(let s=0;s<t.length&&i.length<4;s+=2){let r=t[s+1];if(r==this.state)continue;let o=this.split();o.pushState(r,this.pos),o.storeNode(0,o.pos,o.pos,4,!0),o.shiftContext(t[s],this.pos),o.reducePos=this.pos,o.score-=200,i.push(o)}return i}forceReduce(){let{parser:e}=this.p,t=e.stateSlot(this.state,5);if((t&65536)==0)return!1;if(!e.validAction(this.state,t)){let i=t>>19,s=t&65535,r=this.stack.length-i*3;if(r<0||e.getGoto(this.stack[r],s,!1)<0){let o=this.findForcedReduction();if(o==null)return!1;t=o}this.storeNode(0,this.pos,this.pos,4,!0),this.score-=100}return this.reducePos=this.pos,this.reduce(t),!0}findForcedReduction(){let{parser:e}=this.p,t=[],i=(s,r)=>{if(!t.includes(s))return t.push(s),e.allActions(s,o=>{if(!(o&393216))if(o&65536){let a=(o>>19)-r;if(a>1){let l=o&65535,h=this.stack.length-a*3;if(h>=0&&e.getGoto(this.stack[h],l,!1)>=0)return a<<19|65536|l}}else{let a=i(o,r+1);if(a!=null)return a}})};return i(this.state,0)}forceAll(){for(;!this.p.parser.stateFlag(this.state,2);)if(!this.forceReduce()){this.storeNode(0,this.pos,this.pos,4,!0);break}return this}get deadEnd(){if(this.stack.length!=3)return!1;let{parser:e}=this.p;return e.data[e.stateSlot(this.state,1)]==65535&&!e.stateSlot(this.state,4)}restart(){this.storeNode(0,this.pos,this.pos,4,!0),this.state=this.stack[0],this.stack.length=0}sameState(e){if(this.state!=e.state||this.stack.length!=e.stack.length)return!1;for(let t=0;t<this.stack.length;t+=3)if(this.stack[t]!=e.stack[t])return!1;return!0}get parser(){return this.p.parser}dialectEnabled(e){return this.p.parser.dialect.flags[e]}shiftContext(e,t){this.curContext&&this.updateContext(this.curContext.tracker.shift(this.curContext.context,e,this,this.p.stream.reset(t)))}reduceContext(e,t){this.curContext&&this.updateContext(this.curContext.tracker.reduce(this.curContext.context,e,this,this.p.stream.reset(t)))}emitContext(){let e=this.buffer.length-1;(e<0||this.buffer[e]!=-3)&&this.buffer.push(this.curContext.hash,this.pos,this.pos,-3)}emitLookAhead(){let e=this.buffer.length-1;(e<0||this.buffer[e]!=-4)&&this.buffer.push(this.lookAhead,this.pos,this.pos,-4)}updateContext(e){if(e!=this.curContext.context){let t=new i_(this.curContext.tracker,e);t.hash!=this.curContext.hash&&this.emitContext(),this.curContext=t}}setLookAhead(e){e>this.lookAhead&&(this.emitLookAhead(),this.lookAhead=e)}close(){this.curContext&&this.curContext.tracker.strict&&this.emitContext(),this.lookAhead>0&&this.emitLookAhead()}}class i_{constructor(e,t){this.tracker=e,this.context=t,this.hash=e.strict?e.hash(t):0}}class dW{constructor(e){this.start=e,this.state=e.state,this.stack=e.stack,this.base=this.stack.length}reduce(e){let t=e&65535,i=e>>19;i==0?(this.stack==this.start.stack&&(this.stack=this.stack.slice()),this.stack.push(this.state,0,0),this.base+=3):this.base-=(i-1)*3;let s=this.start.p.parser.getGoto(this.stack[this.base-3],t,!0);this.state=s}}class Pf{constructor(e,t,i){this.stack=e,this.pos=t,this.index=i,this.buffer=e.buffer,this.index==0&&this.maybeNext()}static create(e,t=e.bufferBase+e.buffer.length){return new Pf(e,t,t-e.bufferBase)}maybeNext(){let e=this.stack.parent;e!=null&&(this.index=this.stack.bufferBase-e.bufferBase,this.stack=e,this.buffer=e.buffer)}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}next(){this.index-=4,this.pos-=4,this.index==0&&this.maybeNext()}fork(){return new Pf(this.stack,this.pos,this.index)}}function fh(n,e=Uint16Array){if(typeof n!="string")return n;let t=null;for(let i=0,s=0;i<n.length;){let r=0;for(;;){let o=n.charCodeAt(i++),a=!1;if(o==126){r=65535;break}o>=92&&o--,o>=34&&o--;let l=o-32;if(l>=46&&(l-=46,a=!0),r+=l,a)break;r*=46}t?t[s++]=r:t=new e(r)}return t}class bd{constructor(){this.start=-1,this.value=-1,this.end=-1,this.extended=-1,this.lookAhead=0,this.mask=0,this.context=0}}const n_=new bd;class fW{constructor(e,t){this.input=e,this.ranges=t,this.chunk="",this.chunkOff=0,this.chunk2="",this.chunk2Pos=0,this.next=-1,this.token=n_,this.rangeIndex=0,this.pos=this.chunkPos=t[0].from,this.range=t[0],this.end=t[t.length-1].to,this.readNext()}resolveOffset(e,t){let i=this.range,s=this.rangeIndex,r=this.pos+e;for(;r<i.from;){if(!s)return null;let o=this.ranges[--s];r-=i.from-o.to,i=o}for(;t<0?r>i.to:r>=i.to;){if(s==this.ranges.length-1)return null;let o=this.ranges[++s];r+=o.from-i.to,i=o}return r}clipPos(e){if(e>=this.range.from&&e<this.range.to)return e;for(let t of this.ranges)if(t.to>e)return Math.max(e,t.from);return this.end}peek(e){let t=this.chunkOff+e,i,s;if(t>=0&&t<this.chunk.length)i=this.pos+e,s=this.chunk.charCodeAt(t);else{let r=this.resolveOffset(e,1);if(r==null)return-1;if(i=r,i>=this.chunk2Pos&&i<this.chunk2Pos+this.chunk2.length)s=this.chunk2.charCodeAt(i-this.chunk2Pos);else{let o=this.rangeIndex,a=this.range;for(;a.to<=i;)a=this.ranges[++o];this.chunk2=this.input.chunk(this.chunk2Pos=i),i+this.chunk2.length>a.to&&(this.chunk2=this.chunk2.slice(0,a.to-i)),s=this.chunk2.charCodeAt(0)}}return i>=this.token.lookAhead&&(this.token.lookAhead=i+1),s}acceptToken(e,t=0){let i=t?this.resolveOffset(t,-1):this.pos;if(i==null||i<this.token.start)throw new RangeError("Token end out of bounds");this.token.value=e,this.token.end=i}acceptTokenTo(e,t){this.token.value=e,this.token.end=t}getChunk(){if(this.pos>=this.chunk2Pos&&this.pos<this.chunk2Pos+this.chunk2.length){let{chunk:e,chunkPos:t}=this;this.chunk=this.chunk2,this.chunkPos=this.chunk2Pos,this.chunk2=e,this.chunk2Pos=t,this.chunkOff=this.pos-this.chunkPos}else{this.chunk2=this.chunk,this.chunk2Pos=this.chunkPos;let e=this.input.chunk(this.pos),t=this.pos+e.length;this.chunk=t>this.range.to?e.slice(0,this.range.to-this.pos):e,this.chunkPos=this.pos,this.chunkOff=0}}readNext(){return this.chunkOff>=this.chunk.length&&(this.getChunk(),this.chunkOff==this.chunk.length)?this.next=-1:this.next=this.chunk.charCodeAt(this.chunkOff)}advance(e=1){for(this.chunkOff+=e;this.pos+e>=this.range.to;){if(this.rangeIndex==this.ranges.length-1)return this.setDone();e-=this.range.to-this.pos,this.range=this.ranges[++this.rangeIndex],this.pos=this.range.from}return this.pos+=e,this.pos>=this.token.lookAhead&&(this.token.lookAhead=this.pos+1),this.readNext()}setDone(){return this.pos=this.chunkPos=this.end,this.range=this.ranges[this.rangeIndex=this.ranges.length-1],this.chunk="",this.next=-1}reset(e,t){if(t?(this.token=t,t.start=e,t.lookAhead=e+1,t.value=t.extended=-1):this.token=n_,this.pos!=e){if(this.pos=e,e==this.end)return this.setDone(),this;for(;e<this.range.from;)this.range=this.ranges[--this.rangeIndex];for(;e>=this.range.to;)this.range=this.ranges[++this.rangeIndex];e>=this.chunkPos&&e<this.chunkPos+this.chunk.length?this.chunkOff=e-this.chunkPos:(this.chunk="",this.chunkOff=0),this.readNext()}return this}read(e,t){if(e>=this.chunkPos&&t<=this.chunkPos+this.chunk.length)return this.chunk.slice(e-this.chunkPos,t-this.chunkPos);if(e>=this.chunk2Pos&&t<=this.chunk2Pos+this.chunk2.length)return this.chunk2.slice(e-this.chunk2Pos,t-this.chunk2Pos);if(e>=this.range.from&&t<=this.range.to)return this.input.read(e,t);let i="";for(let s of this.ranges){if(s.from>=t)break;s.to>e&&(i+=this.input.read(Math.max(s.from,e),Math.min(s.to,t)))}return i}}class Ia{constructor(e,t){this.data=e,this.id=t}token(e,t){let{parser:i}=t.p;OI(this.data,e,t,this.id,i.data,i.tokenPrecTable)}}Ia.prototype.contextual=Ia.prototype.fallback=Ia.prototype.extend=!1;class Df{constructor(e,t,i){this.precTable=t,this.elseToken=i,this.data=typeof e=="string"?fh(e):e}token(e,t){let i=e.pos,s=0;for(;;){let r=e.next<0,o=e.resolveOffset(1,1);if(OI(this.data,e,t,0,this.data,this.precTable),e.token.value>-1)break;if(this.elseToken==null)return;if(r||s++,o==null)break;e.reset(o,e.token)}s&&(e.reset(i,e.token),e.acceptToken(this.elseToken,s))}}Df.prototype.contextual=Ia.prototype.fallback=Ia.prototype.extend=!1;class fn{constructor(e,t={}){this.token=e,this.contextual=!!t.contextual,this.fallback=!!t.fallback,this.extend=!!t.extend}}function OI(n,e,t,i,s,r){let o=0,a=1<<i,{dialect:l}=t.p.parser;e:for(;(a&n[o])!=0;){let h=n[o+1];for(let p=o+3;p<h;p+=2)if((n[p+1]&a)>0){let b=n[p];if(l.allows(b)&&(e.token.value==-1||e.token.value==b||pW(b,e.token.value,s,r))){e.acceptToken(b);break}}let u=e.next,c=0,f=n[o+2];if(e.next<0&&f>c&&n[h+f*3-3]==65535){o=n[h+f*3-1];continue e}for(;c<f;){let p=c+f>>1,b=h+p+(p<<1),y=n[b],_=n[b+1]||65536;if(u<y)f=p;else if(u>=_)c=p+1;else{o=n[b+2],e.advance();continue e}}break}}function s_(n,e,t){for(let i=e,s;(s=n[i])!=65535;i++)if(s==t)return i-e;return-1}function pW(n,e,t,i){let s=s_(t,i,e);return s<0||s_(t,i,n)<s}const Ji=typeof process<"u"&&t_&&/\bparse\b/.test(t_.LOG);let vg=null;function r_(n,e,t){let i=n.cursor(ft.IncludeAnonymous);for(i.moveTo(e);;)if(!(t<0?i.childBefore(e):i.childAfter(e)))for(;;){if((t<0?i.to<e:i.from>e)&&!i.type.isError)return t<0?Math.max(0,Math.min(i.to-1,e-25)):Math.min(n.length,Math.max(i.from+1,e+25));if(t<0?i.prevSibling():i.nextSibling())break;if(!i.parent())return t<0?0:n.length}}class mW{constructor(e,t){this.fragments=e,this.nodeSet=t,this.i=0,this.fragment=null,this.safeFrom=-1,this.safeTo=-1,this.trees=[],this.start=[],this.index=[],this.nextFragment()}nextFragment(){let e=this.fragment=this.i==this.fragments.length?null:this.fragments[this.i++];if(e){for(this.safeFrom=e.openStart?r_(e.tree,e.from+e.offset,1)-e.offset:e.from,this.safeTo=e.openEnd?r_(e.tree,e.to+e.offset,-1)-e.offset:e.to;this.trees.length;)this.trees.pop(),this.start.pop(),this.index.pop();this.trees.push(e.tree),this.start.push(-e.offset),this.index.push(0),this.nextStart=this.safeFrom}else this.nextStart=1e9}nodeAt(e){if(e<this.nextStart)return null;for(;this.fragment&&this.safeTo<=e;)this.nextFragment();if(!this.fragment)return null;for(;;){let t=this.trees.length-1;if(t<0)return this.nextFragment(),null;let i=this.trees[t],s=this.index[t];if(s==i.children.length){this.trees.pop(),this.start.pop(),this.index.pop();continue}let r=i.children[s],o=this.start[t]+i.positions[s];if(o>e)return this.nextStart=o,null;if(r instanceof tt){if(o==e){if(o<this.safeFrom)return null;let a=o+r.length;if(a<=this.safeTo){let l=r.prop(qe.lookAhead);if(!l||a+l<this.fragment.to)return r}}this.index[t]++,o+r.length>=Math.max(this.safeFrom,e)&&(this.trees.push(r),this.start.push(o),this.index.push(0))}else this.index[t]++,this.nextStart=o+r.length}}}class gW{constructor(e,t){this.stream=t,this.tokens=[],this.mainToken=null,this.actions=[],this.tokens=e.tokenizers.map(i=>new bd)}getActions(e){let t=0,i=null,{parser:s}=e.p,{tokenizers:r}=s,o=s.stateSlot(e.state,3),a=e.curContext?e.curContext.hash:0,l=0;for(let h=0;h<r.length;h++){if((1<<h&o)==0)continue;let u=r[h],c=this.tokens[h];if(!(i&&!u.fallback)&&((u.contextual||c.start!=e.pos||c.mask!=o||c.context!=a)&&(this.updateCachedToken(c,u,e),c.mask=o,c.context=a),c.lookAhead>c.end+25&&(l=Math.max(c.lookAhead,l)),c.value!=0)){let f=t;if(c.extended>-1&&(t=this.addActions(e,c.extended,c.end,t)),t=this.addActions(e,c.value,c.end,t),!u.extend&&(i=c,t>f))break}}for(;this.actions.length>t;)this.actions.pop();return l&&e.setLookAhead(l),!i&&e.pos==this.stream.end&&(i=new bd,i.value=e.p.parser.eofTerm,i.start=i.end=e.pos,t=this.addActions(e,i.value,i.end,t)),this.mainToken=i,this.actions}getMainToken(e){if(this.mainToken)return this.mainToken;let t=new bd,{pos:i,p:s}=e;return t.start=i,t.end=Math.min(i+1,s.stream.end),t.value=i==s.stream.end?s.parser.eofTerm:0,t}updateCachedToken(e,t,i){let s=this.stream.clipPos(i.pos);if(t.token(this.stream.reset(s,e),i),e.value>-1){let{parser:r}=i.p;for(let o=0;o<r.specialized.length;o++)if(r.specialized[o]==e.value){let a=r.specializers[o](this.stream.read(e.start,e.end),i);if(a>=0&&i.p.parser.dialect.allows(a>>1)){(a&1)==0?e.value=a>>1:e.extended=a>>1;break}}}else e.value=0,e.end=this.stream.clipPos(s+1)}putAction(e,t,i,s){for(let r=0;r<s;r+=3)if(this.actions[r]==e)return s;return this.actions[s++]=e,this.actions[s++]=t,this.actions[s++]=i,s}addActions(e,t,i,s){let{state:r}=e,{parser:o}=e.p,{data:a}=o;for(let l=0;l<2;l++)for(let h=o.stateSlot(r,l?2:1);;h+=3){if(a[h]==65535)if(a[h+1]==1)h=Ys(a,h+2);else{s==0&&a[h+1]==2&&(s=this.putAction(Ys(a,h+2),t,i,s));break}a[h]==t&&(s=this.putAction(Ys(a,h+1),t,i,s))}return s}}class OW{constructor(e,t,i,s){this.parser=e,this.input=t,this.ranges=s,this.recovering=0,this.nextStackID=9812,this.minStackPos=0,this.reused=[],this.stoppedAt=null,this.lastBigReductionStart=-1,this.lastBigReductionSize=0,this.bigReductionCount=0,this.stream=new fW(t,s),this.tokens=new gW(e,this.stream),this.topTerm=e.top[1];let{from:r}=s[0];this.stacks=[Af.start(this,e.top[0],r)],this.fragments=i.length&&this.stream.end-r>e.bufferLength*4?new mW(i,e.nodeSet):null}get parsedPos(){return this.minStackPos}advance(){let e=this.stacks,t=this.minStackPos,i=this.stacks=[],s,r;if(this.bigReductionCount>300&&e.length==1){let[o]=e;for(;o.forceReduce()&&o.stack.length&&o.stack[o.stack.length-2]>=this.lastBigReductionStart;);this.bigReductionCount=this.lastBigReductionSize=0}for(let o=0;o<e.length;o++){let a=e[o];for(;;){if(this.tokens.mainToken=null,a.pos>t)i.push(a);else{if(this.advanceStack(a,i,e))continue;{s||(s=[],r=[]),s.push(a);let l=this.tokens.getMainToken(a);r.push(l.value,l.end)}}break}}if(!i.length){let o=s&&bW(s);if(o)return Ji&&console.log("Finish with "+this.stackID(o)),this.stackToTree(o);if(this.parser.strict)throw Ji&&s&&console.log("Stuck with token "+(this.tokens.mainToken?this.parser.getName(this.tokens.mainToken.value):"none")),new SyntaxError("No parse at "+t);this.recovering||(this.recovering=5)}if(this.recovering&&s){let o=this.stoppedAt!=null&&s[0].pos>this.stoppedAt?s[0]:this.runRecovery(s,r,i);if(o)return Ji&&console.log("Force-finish "+this.stackID(o)),this.stackToTree(o.forceAll())}if(this.recovering){let o=this.recovering==1?1:this.recovering*3;if(i.length>o)for(i.sort((a,l)=>l.score-a.score);i.length>o;)i.pop();i.some(a=>a.reducePos>t)&&this.recovering--}else if(i.length>1){e:for(let o=0;o<i.length-1;o++){let a=i[o];for(let l=o+1;l<i.length;l++){let h=i[l];if(a.sameState(h)||a.buffer.length>500&&h.buffer.length>500)if((a.score-h.score||a.buffer.length-h.buffer.length)>0)i.splice(l--,1);else{i.splice(o--,1);continue e}}}i.length>12&&i.splice(12,i.length-12)}this.minStackPos=i[0].pos;for(let o=1;o<i.length;o++)i[o].pos<this.minStackPos&&(this.minStackPos=i[o].pos);return null}stopAt(e){if(this.stoppedAt!=null&&this.stoppedAt<e)throw new RangeError("Can't move stoppedAt forward");this.stoppedAt=e}advanceStack(e,t,i){let s=e.pos,{parser:r}=this,o=Ji?this.stackID(e)+" -> ":"";if(this.stoppedAt!=null&&s>this.stoppedAt)return e.forceReduce()?e:null;if(this.fragments){let h=e.curContext&&e.curContext.tracker.strict,u=h?e.curContext.hash:0;for(let c=this.fragments.nodeAt(s);c;){let f=this.parser.nodeSet.types[c.type.id]==c.type?r.getGoto(e.state,c.type.id):-1;if(f>-1&&c.length&&(!h||(c.prop(qe.contextHash)||0)==u))return e.useNode(c,f),Ji&&console.log(o+this.stackID(e)+` (via reuse of ${r.getName(c.type.id)})`),!0;if(!(c instanceof tt)||c.children.length==0||c.positions[0]>0)break;let p=c.children[0];if(p instanceof tt&&c.positions[0]==0)c=p;else break}}let a=r.stateSlot(e.state,4);if(a>0)return e.reduce(a),Ji&&console.log(o+this.stackID(e)+` (via always-reduce ${r.getName(a&65535)})`),!0;if(e.stack.length>=8400)for(;e.stack.length>6e3&&e.forceReduce(););let l=this.tokens.getActions(e);for(let h=0;h<l.length;){let u=l[h++],c=l[h++],f=l[h++],p=h==l.length||!i,b=p?e:e.split(),y=this.tokens.mainToken;if(b.apply(u,c,y?y.start:b.pos,f),Ji&&console.log(o+this.stackID(b)+` (via ${(u&65536)==0?"shift":`reduce of ${r.getName(u&65535)}`} for ${r.getName(c)} @ ${s}${b==e?"":", split"})`),p)return!0;b.pos>s?t.push(b):i.push(b)}return!1}advanceFully(e,t){let i=e.pos;for(;;){if(!this.advanceStack(e,null,null))return!1;if(e.pos>i)return o_(e,t),!0}}runRecovery(e,t,i){let s=null,r=!1;for(let o=0;o<e.length;o++){let a=e[o],l=t[o<<1],h=t[(o<<1)+1],u=Ji?this.stackID(a)+" -> ":"";if(a.deadEnd&&(r||(r=!0,a.restart(),Ji&&console.log(u+this.stackID(a)+" (restarted)"),this.advanceFully(a,i))))continue;let c=a.split(),f=u;for(let p=0;c.forceReduce()&&p<10&&(Ji&&console.log(f+this.stackID(c)+" (via force-reduce)"),!this.advanceFully(c,i));p++)Ji&&(f=this.stackID(c)+" -> ");for(let p of a.recoverByInsert(l))Ji&&console.log(u+this.stackID(p)+" (via recover-insert)"),this.advanceFully(p,i);this.stream.end>a.pos?(h==a.pos&&(h++,l=0),a.recoverByDelete(l,h),Ji&&console.log(u+this.stackID(a)+` (via recover-delete ${this.parser.getName(l)})`),o_(a,i)):(!s||s.score<a.score)&&(s=a)}return s}stackToTree(e){return e.close(),tt.build({buffer:Pf.create(e),nodeSet:this.parser.nodeSet,topID:this.topTerm,maxBufferLength:this.parser.bufferLength,reused:this.reused,start:this.ranges[0].from,length:e.pos-this.ranges[0].from,minRepeatType:this.parser.minRepeatTerm})}stackID(e){let t=(vg||(vg=new WeakMap)).get(e);return t||vg.set(e,t=String.fromCodePoint(this.nextStackID++)),t+e}}function o_(n,e){for(let t=0;t<e.length;t++){let i=e[t];if(i.pos==n.pos&&i.sameState(n)){e[t].score<n.score&&(e[t]=n);return}}e.push(n)}class yW{constructor(e,t,i){this.source=e,this.flags=t,this.disabled=i}allows(e){return!this.disabled||this.disabled[e]==0}}const Sg=n=>n;class yI{constructor(e){this.start=e.start,this.shift=e.shift||Sg,this.reduce=e.reduce||Sg,this.reuse=e.reuse||Sg,this.hash=e.hash||(()=>0),this.strict=e.strict!==!1}}class sl extends ev{constructor(e){if(super(),this.wrappers=[],e.version!=14)throw new RangeError(`Parser version (${e.version}) doesn't match runtime version (14)`);let t=e.nodeNames.split(" ");this.minRepeatTerm=t.length;for(let a=0;a<e.repeatNodeCount;a++)t.push("");let i=Object.keys(e.topRules).map(a=>e.topRules[a][1]),s=[];for(let a=0;a<t.length;a++)s.push([]);function r(a,l,h){s[a].push([l,l.deserialize(String(h))])}if(e.nodeProps)for(let a of e.nodeProps){let l=a[0];typeof l=="string"&&(l=qe[l]);for(let h=1;h<a.length;){let u=a[h++];if(u>=0)r(u,l,a[h++]);else{let c=a[h+-u];for(let f=-u;f>0;f--)r(a[h++],l,c);h++}}}this.nodeSet=new Lu(t.map((a,l)=>Yt.define({name:l>=this.minRepeatTerm?void 0:a,id:l,props:s[l],top:i.indexOf(l)>-1,error:l==0,skipped:e.skippedNodes&&e.skippedNodes.indexOf(l)>-1}))),e.propSources&&(this.nodeSet=this.nodeSet.extend(...e.propSources)),this.strict=!1,this.bufferLength=$M;let o=fh(e.tokenData);this.context=e.context,this.specializerSpecs=e.specialized||[],this.specialized=new Uint16Array(this.specializerSpecs.length);for(let a=0;a<this.specializerSpecs.length;a++)this.specialized[a]=this.specializerSpecs[a].term;this.specializers=this.specializerSpecs.map(a_),this.states=fh(e.states,Uint32Array),this.data=fh(e.stateData),this.goto=fh(e.goto),this.maxTerm=e.maxTerm,this.tokenizers=e.tokenizers.map(a=>typeof a=="number"?new Ia(o,a):a),this.topRules=e.topRules,this.dialects=e.dialects||{},this.dynamicPrecedences=e.dynamicPrecedences||null,this.tokenPrecTable=e.tokenPrec,this.termNames=e.termNames||null,this.maxNode=this.nodeSet.types.length-1,this.dialect=this.parseDialect(),this.top=this.topRules[Object.keys(this.topRules)[0]]}createParse(e,t,i){let s=new OW(this,e,t,i);for(let r of this.wrappers)s=r(s,e,t,i);return s}getGoto(e,t,i=!1){let s=this.goto;if(t>=s[0])return-1;for(let r=s[t+1];;){let o=s[r++],a=o&1,l=s[r++];if(a&&i)return l;for(let h=r+(o>>1);r<h;r++)if(s[r]==e)return l;if(a)return-1}}hasAction(e,t){let i=this.data;for(let s=0;s<2;s++)for(let r=this.stateSlot(e,s?2:1),o;;r+=3){if((o=i[r])==65535)if(i[r+1]==1)o=i[r=Ys(i,r+2)];else{if(i[r+1]==2)return Ys(i,r+2);break}if(o==t||o==0)return Ys(i,r+1)}return 0}stateSlot(e,t){return this.states[e*6+t]}stateFlag(e,t){return(this.stateSlot(e,0)&t)>0}validAction(e,t){return!!this.allActions(e,i=>i==t?!0:null)}allActions(e,t){let i=this.stateSlot(e,4),s=i?t(i):void 0;for(let r=this.stateSlot(e,1);s==null;r+=3){if(this.data[r]==65535)if(this.data[r+1]==1)r=Ys(this.data,r+2);else break;s=t(Ys(this.data,r+1))}return s}nextStates(e){let t=[];for(let i=this.stateSlot(e,1);;i+=3){if(this.data[i]==65535)if(this.data[i+1]==1)i=Ys(this.data,i+2);else break;if((this.data[i+2]&1)==0){let s=this.data[i+1];t.some((r,o)=>o&1&&r==s)||t.push(this.data[i],s)}}return t}configure(e){let t=Object.assign(Object.create(sl.prototype),this);if(e.props&&(t.nodeSet=this.nodeSet.extend(...e.props)),e.top){let i=this.topRules[e.top];if(!i)throw new RangeError(`Invalid top rule name ${e.top}`);t.top=i}return e.tokenizers&&(t.tokenizers=this.tokenizers.map(i=>{let s=e.tokenizers.find(r=>r.from==i);return s?s.to:i})),e.specializers&&(t.specializers=this.specializers.slice(),t.specializerSpecs=this.specializerSpecs.map((i,s)=>{let r=e.specializers.find(a=>a.from==i.external);if(!r)return i;let o=Object.assign(Object.assign({},i),{external:r.to});return t.specializers[s]=a_(o),o})),e.contextTracker&&(t.context=e.contextTracker),e.dialect&&(t.dialect=this.parseDialect(e.dialect)),e.strict!=null&&(t.strict=e.strict),e.wrap&&(t.wrappers=t.wrappers.concat(e.wrap)),e.bufferLength!=null&&(t.bufferLength=e.bufferLength),t}hasWrappers(){return this.wrappers.length>0}getName(e){return this.termNames?this.termNames[e]:String(e<=this.maxNode&&this.nodeSet.types[e].name||e)}get eofTerm(){return this.maxNode+1}get topNode(){return this.nodeSet.types[this.top[1]]}dynamicPrecedence(e){let t=this.dynamicPrecedences;return t==null?0:t[e]||0}parseDialect(e){let t=Object.keys(this.dialects),i=t.map(()=>!1);if(e)for(let r of e.split(" ")){let o=t.indexOf(r);o>=0&&(i[o]=!0)}let s=null;for(let r=0;r<t.length;r++)if(!i[r])for(let o=this.dialects[t[r]],a;(a=this.data[o++])!=65535;)(s||(s=new Uint8Array(this.maxTerm+1)))[a]=1;return new yW(e,i,s)}static deserialize(e){return new sl(e)}}function Ys(n,e){return n[e]|n[e+1]<<16}function bW(n){let e=null;for(let t of n){let i=t.p.stoppedAt;(t.pos==t.p.stream.end||i!=null&&t.pos>i)&&t.p.parser.stateFlag(t.state,2)&&(!e||e.score<t.score)&&(e=t)}return e}function a_(n){if(n.external){let e=n.extend?1:0;return(t,i)=>n.external(t,i)<<1|e}return n.get}const vW=55,SW=1,xW=56,TW=2,wW=57,_W=3,l_=4,kW=5,hv=6,bI=7,vI=8,SI=9,xI=10,CW=11,EW=12,AW=13,xg=58,PW=14,DW=15,h_=59,TI=21,MW=23,wI=24,IW=25,sy=27,_I=28,RW=29,LW=32,$W=35,QW=37,BW=38,NW=0,FW=1,VW={area:!0,base:!0,br:!0,col:!0,command:!0,embed:!0,frame:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0,menuitem:!0},UW={dd:!0,li:!0,optgroup:!0,option:!0,p:!0,rp:!0,rt:!0,tbody:!0,td:!0,tfoot:!0,th:!0,tr:!0},u_={dd:{dd:!0,dt:!0},dt:{dd:!0,dt:!0},li:{li:!0},option:{option:!0,optgroup:!0},optgroup:{optgroup:!0},p:{address:!0,article:!0,aside:!0,blockquote:!0,dir:!0,div:!0,dl:!0,fieldset:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,menu:!0,nav:!0,ol:!0,p:!0,pre:!0,section:!0,table:!0,ul:!0},rp:{rp:!0,rt:!0},rt:{rp:!0,rt:!0},tbody:{tbody:!0,tfoot:!0},td:{td:!0,th:!0},tfoot:{tbody:!0},th:{td:!0,th:!0},thead:{tbody:!0,tfoot:!0},tr:{tr:!0}};function qW(n){return n==45||n==46||n==58||n>=65&&n<=90||n==95||n>=97&&n<=122||n>=161}let c_=null,d_=null,f_=0;function ry(n,e){let t=n.pos+e;if(f_==t&&d_==n)return c_;let i=n.peek(e),s="";for(;qW(i);)s+=String.fromCharCode(i),i=n.peek(++e);return d_=n,f_=t,c_=s?s.toLowerCase():i==zW||i==jW?void 0:null}const kI=60,Mf=62,uv=47,zW=63,jW=33,XW=45;function p_(n,e){this.name=n,this.parent=e}const HW=[hv,xI,bI,vI,SI],WW=new yI({start:null,shift(n,e,t,i){return HW.indexOf(e)>-1?new p_(ry(i,1)||"",n):n},reduce(n,e){return e==TI&&n?n.parent:n},reuse(n,e,t,i){let s=e.type.id;return s==hv||s==QW?new p_(ry(i,1)||"",n):n},strict:!1}),ZW=new fn((n,e)=>{if(n.next!=kI){n.next<0&&e.context&&n.acceptToken(xg);return}n.advance();let t=n.next==uv;t&&n.advance();let i=ry(n,0);if(i===void 0)return;if(!i)return n.acceptToken(t?DW:PW);let s=e.context?e.context.name:null;if(t){if(i==s)return n.acceptToken(CW);if(s&&UW[s])return n.acceptToken(xg,-2);if(e.dialectEnabled(NW))return n.acceptToken(EW);for(let r=e.context;r;r=r.parent)if(r.name==i)return;n.acceptToken(AW)}else{if(i=="script")return n.acceptToken(bI);if(i=="style")return n.acceptToken(vI);if(i=="textarea")return n.acceptToken(SI);if(VW.hasOwnProperty(i))return n.acceptToken(xI);s&&u_[s]&&u_[s][i]?n.acceptToken(xg,-1):n.acceptToken(hv)}},{contextual:!0}),YW=new fn(n=>{for(let e=0,t=0;;t++){if(n.next<0){t&&n.acceptToken(h_);break}if(n.next==XW)e++;else if(n.next==Mf&&e>=2){t>=3&&n.acceptToken(h_,-2);break}else e=0;n.advance()}});function GW(n){for(;n;n=n.parent)if(n.name=="svg"||n.name=="math")return!0;return!1}const KW=new fn((n,e)=>{if(n.next==uv&&n.peek(1)==Mf){let t=e.dialectEnabled(FW)||GW(e.context);n.acceptToken(t?kW:l_,2)}else n.next==Mf&&n.acceptToken(l_,1)});function cv(n,e,t){let i=2+n.length;return new fn(s=>{for(let r=0,o=0,a=0;;a++){if(s.next<0){a&&s.acceptToken(e);break}if(r==0&&s.next==kI||r==1&&s.next==uv||r>=2&&r<i&&s.next==n.charCodeAt(r-2))r++,o++;else if(r==i&&s.next==Mf){a>o?s.acceptToken(e,-o):s.acceptToken(t,-(o-2));break}else if((s.next==10||s.next==13)&&a){s.acceptToken(e,1);break}else r=o=0;s.advance()}})}const JW=cv("script",vW,SW),eZ=cv("style",xW,TW),tZ=cv("textarea",wW,_W),iZ=Ol({"Text RawText IncompleteTag IncompleteCloseTag":j.content,"StartTag StartCloseTag SelfClosingEndTag EndTag":j.angleBracket,TagName:j.tagName,"MismatchedCloseTag/TagName":[j.tagName,j.invalid],AttributeName:j.attributeName,"AttributeValue UnquotedAttributeValue":j.attributeValue,Is:j.definitionOperator,"EntityReference CharacterReference":j.character,Comment:j.blockComment,ProcessingInst:j.processingInstruction,DoctypeDecl:j.documentMeta}),nZ=sl.deserialize({version:14,states:",xOVO!rOOO!ZQ#tO'#CrO!`Q#tO'#C{O!eQ#tO'#DOO!jQ#tO'#DRO!oQ#tO'#DTO!tOaO'#CqO#PObO'#CqO#[OdO'#CqO$kO!rO'#CqOOO`'#Cq'#CqO$rO$fO'#DUO$zQ#tO'#DWO%PQ#tO'#DXOOO`'#Dl'#DlOOO`'#DZ'#DZQVO!rOOO%UQ&rO,59^O%aQ&rO,59gO%lQ&rO,59jO%wQ&rO,59mO&SQ&rO,59oOOOa'#D_'#D_O&_OaO'#CyO&jOaO,59]OOOb'#D`'#D`O&rObO'#C|O&}ObO,59]OOOd'#Da'#DaO'VOdO'#DPO'bOdO,59]OOO`'#Db'#DbO'jO!rO,59]O'qQ#tO'#DSOOO`,59],59]OOOp'#Dc'#DcO'vO$fO,59pOOO`,59p,59pO(OQ#|O,59rO(TQ#|O,59sOOO`-E7X-E7XO(YQ&rO'#CtOOQW'#D['#D[O(hQ&rO1G.xOOOa1G.x1G.xOOO`1G/Z1G/ZO(sQ&rO1G/ROOOb1G/R1G/RO)OQ&rO1G/UOOOd1G/U1G/UO)ZQ&rO1G/XOOO`1G/X1G/XO)fQ&rO1G/ZOOOa-E7]-E7]O)qQ#tO'#CzOOO`1G.w1G.wOOOb-E7^-E7^O)vQ#tO'#C}OOOd-E7_-E7_O){Q#tO'#DQOOO`-E7`-E7`O*QQ#|O,59nOOOp-E7a-E7aOOO`1G/[1G/[OOO`1G/^1G/^OOO`1G/_1G/_O*VQ,UO,59`OOQW-E7Y-E7YOOOa7+$d7+$dOOO`7+$u7+$uOOOb7+$m7+$mOOOd7+$p7+$pOOO`7+$s7+$sO*bQ#|O,59fO*gQ#|O,59iO*lQ#|O,59lOOO`1G/Y1G/YO*qO7[O'#CwO+SOMhO'#CwOOQW1G.z1G.zOOO`1G/Q1G/QOOO`1G/T1G/TOOO`1G/W1G/WOOOO'#D]'#D]O+eO7[O,59cOOQW,59c,59cOOOO'#D^'#D^O+vOMhO,59cOOOO-E7Z-E7ZOOQW1G.}1G.}OOOO-E7[-E7[",stateData:",c~O!_OS~OUSOVPOWQOXROYTO[]O][O^^O_^Oa^Ob^Oc^Od^Oy^O|_O!eZO~OgaO~OgbO~OgcO~OgdO~OgeO~O!XfOPmP![mP~O!YiOQpP![pP~O!ZlORsP![sP~OUSOVPOWQOXROYTOZqO[]O][O^^O_^Oa^Ob^Oc^Od^Oy^O!eZO~O![rO~P#gO!]sO!fuO~OgvO~OgwO~OS|OT}OiyO~OS!POT}OiyO~OS!ROT}OiyO~OS!TOT}OiyO~OS}OT}OiyO~O!XfOPmX![mX~OP!WO![!XO~O!YiOQpX![pX~OQ!ZO![!XO~O!ZlORsX![sX~OR!]O![!XO~O![!XO~P#gOg!_O~O!]sO!f!aO~OS!bO~OS!cO~Oj!dOShXThXihX~OS!fOT!gOiyO~OS!hOT!gOiyO~OS!iOT!gOiyO~OS!jOT!gOiyO~OS!gOT!gOiyO~Og!kO~Og!lO~Og!mO~OS!nO~Ol!qO!a!oO!c!pO~OS!rO~OS!sO~OS!tO~Ob!uOc!uOd!uO!a!wO!b!uO~Ob!xOc!xOd!xO!c!wO!d!xO~Ob!uOc!uOd!uO!a!{O!b!uO~Ob!xOc!xOd!xO!c!{O!d!xO~OT~cbd!ey|!e~",goto:"%q!aPPPPPPPPPPPPPPPPPPPPP!b!hP!nPP!zP!}#Q#T#Z#^#a#g#j#m#s#y!bP!b!bP$P$V$m$s$y%P%V%]%cPPPPPPPP%iX^OX`pXUOX`pezabcde{!O!Q!S!UR!q!dRhUR!XhXVOX`pRkVR!XkXWOX`pRnWR!XnXXOX`pQrXR!XpXYOX`pQ`ORx`Q{aQ!ObQ!QcQ!SdQ!UeZ!e{!O!Q!S!UQ!v!oR!z!vQ!y!pR!|!yQgUR!VgQjVR!YjQmWR![mQpXR!^pQtZR!`tS_O`ToXp",nodeNames:"⚠ StartCloseTag StartCloseTag StartCloseTag EndTag SelfClosingEndTag StartTag StartTag StartTag StartTag StartTag StartCloseTag StartCloseTag StartCloseTag IncompleteTag IncompleteCloseTag Document Text EntityReference CharacterReference InvalidEntity Element OpenTag TagName Attribute AttributeName Is AttributeValue UnquotedAttributeValue ScriptText CloseTag OpenTag StyleText CloseTag OpenTag TextareaText CloseTag OpenTag CloseTag SelfClosingTag Comment ProcessingInst MismatchedCloseTag CloseTag DoctypeDecl",maxTerm:68,context:WW,nodeProps:[["closedBy",-10,1,2,3,7,8,9,10,11,12,13,"EndTag",6,"EndTag SelfClosingEndTag",-4,22,31,34,37,"CloseTag"],["openedBy",4,"StartTag StartCloseTag",5,"StartTag",-4,30,33,36,38,"OpenTag"],["group",-10,14,15,18,19,20,21,40,41,42,43,"Entity",17,"Entity TextContent",-3,29,32,35,"TextContent Entity"],["isolate",-11,22,30,31,33,34,36,37,38,39,42,43,"ltr",-3,27,28,40,""]],propSources:[iZ],skippedNodes:[0],repeatNodeCount:9,tokenData:"!<p!aR!YOX$qXY,QYZ,QZ[$q[]&X]^,Q^p$qpq,Qqr-_rs3_sv-_vw3}wxHYx}-_}!OH{!O!P-_!P!Q$q!Q![-_![!]Mz!]!^-_!^!_!$S!_!`!;x!`!a&X!a!c-_!c!}Mz!}#R-_#R#SMz#S#T1k#T#oMz#o#s-_#s$f$q$f%W-_%W%oMz%o%p-_%p&aMz&a&b-_&b1pMz1p4U-_4U4dMz4d4e-_4e$ISMz$IS$I`-_$I`$IbMz$Ib$Kh-_$Kh%#tMz%#t&/x-_&/x&EtMz&Et&FV-_&FV;'SMz;'S;:j!#|;:j;=`3X<%l?&r-_?&r?AhMz?Ah?BY$q?BY?MnMz?MnO$q!Z$|caPlW!b`!dpOX$qXZ&XZ[$q[^&X^p$qpq&Xqr$qrs&}sv$qvw+Pwx(tx!^$q!^!_*V!_!a&X!a#S$q#S#T&X#T;'S$q;'S;=`+z<%lO$q!R&bXaP!b`!dpOr&Xrs&}sv&Xwx(tx!^&X!^!_*V!_;'S&X;'S;=`*y<%lO&Xq'UVaP!dpOv&}wx'kx!^&}!^!_(V!_;'S&};'S;=`(n<%lO&}P'pTaPOv'kw!^'k!_;'S'k;'S;=`(P<%lO'kP(SP;=`<%l'kp([S!dpOv(Vx;'S(V;'S;=`(h<%lO(Vp(kP;=`<%l(Vq(qP;=`<%l&}a({WaP!b`Or(trs'ksv(tw!^(t!^!_)e!_;'S(t;'S;=`*P<%lO(t`)jT!b`Or)esv)ew;'S)e;'S;=`)y<%lO)e`)|P;=`<%l)ea*SP;=`<%l(t!Q*^V!b`!dpOr*Vrs(Vsv*Vwx)ex;'S*V;'S;=`*s<%lO*V!Q*vP;=`<%l*V!R*|P;=`<%l&XW+UYlWOX+PZ[+P^p+Pqr+Psw+Px!^+P!a#S+P#T;'S+P;'S;=`+t<%lO+PW+wP;=`<%l+P!Z+}P;=`<%l$q!a,]`aP!b`!dp!_^OX&XXY,QYZ,QZ]&X]^,Q^p&Xpq,Qqr&Xrs&}sv&Xwx(tx!^&X!^!_*V!_;'S&X;'S;=`*y<%lO&X!_-ljiSaPlW!b`!dpOX$qXZ&XZ[$q[^&X^p$qpq&Xqr-_rs&}sv-_vw/^wx(tx!P-_!P!Q$q!Q!^-_!^!_*V!_!a&X!a#S-_#S#T1k#T#s-_#s$f$q$f;'S-_;'S;=`3X<%l?Ah-_?Ah?BY$q?BY?Mn-_?MnO$q[/ebiSlWOX+PZ[+P^p+Pqr/^sw/^x!P/^!P!Q+P!Q!^/^!a#S/^#S#T0m#T#s/^#s$f+P$f;'S/^;'S;=`1e<%l?Ah/^?Ah?BY+P?BY?Mn/^?MnO+PS0rXiSqr0msw0mx!P0m!Q!^0m!a#s0m$f;'S0m;'S;=`1_<%l?Ah0m?BY?Mn0mS1bP;=`<%l0m[1hP;=`<%l/^!V1vciSaP!b`!dpOq&Xqr1krs&}sv1kvw0mwx(tx!P1k!P!Q&X!Q!^1k!^!_*V!_!a&X!a#s1k#s$f&X$f;'S1k;'S;=`3R<%l?Ah1k?Ah?BY&X?BY?Mn1k?MnO&X!V3UP;=`<%l1k!_3[P;=`<%l-_!Z3hV!ahaP!dpOv&}wx'kx!^&}!^!_(V!_;'S&};'S;=`(n<%lO&}!_4WiiSlWd!ROX5uXZ7SZ[5u[^7S^p5uqr8trs7Sst>]tw8twx7Sx!P8t!P!Q5u!Q!]8t!]!^/^!^!a7S!a#S8t#S#T;{#T#s8t#s$f5u$f;'S8t;'S;=`>V<%l?Ah8t?Ah?BY5u?BY?Mn8t?MnO5u!Z5zblWOX5uXZ7SZ[5u[^7S^p5uqr5urs7Sst+Ptw5uwx7Sx!]5u!]!^7w!^!a7S!a#S5u#S#T7S#T;'S5u;'S;=`8n<%lO5u!R7VVOp7Sqs7St!]7S!]!^7l!^;'S7S;'S;=`7q<%lO7S!R7qOb!R!R7tP;=`<%l7S!Z8OYlWb!ROX+PZ[+P^p+Pqr+Psw+Px!^+P!a#S+P#T;'S+P;'S;=`+t<%lO+P!Z8qP;=`<%l5u!_8{iiSlWOX5uXZ7SZ[5u[^7S^p5uqr8trs7Sst/^tw8twx7Sx!P8t!P!Q5u!Q!]8t!]!^:j!^!a7S!a#S8t#S#T;{#T#s8t#s$f5u$f;'S8t;'S;=`>V<%l?Ah8t?Ah?BY5u?BY?Mn8t?MnO5u!_:sbiSlWb!ROX+PZ[+P^p+Pqr/^sw/^x!P/^!P!Q+P!Q!^/^!a#S/^#S#T0m#T#s/^#s$f+P$f;'S/^;'S;=`1e<%l?Ah/^?Ah?BY+P?BY?Mn/^?MnO+P!V<QciSOp7Sqr;{rs7Sst0mtw;{wx7Sx!P;{!P!Q7S!Q!];{!]!^=]!^!a7S!a#s;{#s$f7S$f;'S;{;'S;=`>P<%l?Ah;{?Ah?BY7S?BY?Mn;{?MnO7S!V=dXiSb!Rqr0msw0mx!P0m!Q!^0m!a#s0m$f;'S0m;'S;=`1_<%l?Ah0m?BY?Mn0m!V>SP;=`<%l;{!_>YP;=`<%l8t!_>dhiSlWOX@OXZAYZ[@O[^AY^p@OqrBwrsAYswBwwxAYx!PBw!P!Q@O!Q!]Bw!]!^/^!^!aAY!a#SBw#S#TE{#T#sBw#s$f@O$f;'SBw;'S;=`HS<%l?AhBw?Ah?BY@O?BY?MnBw?MnO@O!Z@TalWOX@OXZAYZ[@O[^AY^p@Oqr@OrsAYsw@OwxAYx!]@O!]!^Az!^!aAY!a#S@O#S#TAY#T;'S@O;'S;=`Bq<%lO@O!RA]UOpAYq!]AY!]!^Ao!^;'SAY;'S;=`At<%lOAY!RAtOc!R!RAwP;=`<%lAY!ZBRYlWc!ROX+PZ[+P^p+Pqr+Psw+Px!^+P!a#S+P#T;'S+P;'S;=`+t<%lO+P!ZBtP;=`<%l@O!_COhiSlWOX@OXZAYZ[@O[^AY^p@OqrBwrsAYswBwwxAYx!PBw!P!Q@O!Q!]Bw!]!^Dj!^!aAY!a#SBw#S#TE{#T#sBw#s$f@O$f;'SBw;'S;=`HS<%l?AhBw?Ah?BY@O?BY?MnBw?MnO@O!_DsbiSlWc!ROX+PZ[+P^p+Pqr/^sw/^x!P/^!P!Q+P!Q!^/^!a#S/^#S#T0m#T#s/^#s$f+P$f;'S/^;'S;=`1e<%l?Ah/^?Ah?BY+P?BY?Mn/^?MnO+P!VFQbiSOpAYqrE{rsAYswE{wxAYx!PE{!P!QAY!Q!]E{!]!^GY!^!aAY!a#sE{#s$fAY$f;'SE{;'S;=`G|<%l?AhE{?Ah?BYAY?BY?MnE{?MnOAY!VGaXiSc!Rqr0msw0mx!P0m!Q!^0m!a#s0m$f;'S0m;'S;=`1_<%l?Ah0m?BY?Mn0m!VHPP;=`<%lE{!_HVP;=`<%lBw!ZHcW!cxaP!b`Or(trs'ksv(tw!^(t!^!_)e!_;'S(t;'S;=`*P<%lO(t!aIYliSaPlW!b`!dpOX$qXZ&XZ[$q[^&X^p$qpq&Xqr-_rs&}sv-_vw/^wx(tx}-_}!OKQ!O!P-_!P!Q$q!Q!^-_!^!_*V!_!a&X!a#S-_#S#T1k#T#s-_#s$f$q$f;'S-_;'S;=`3X<%l?Ah-_?Ah?BY$q?BY?Mn-_?MnO$q!aK_kiSaPlW!b`!dpOX$qXZ&XZ[$q[^&X^p$qpq&Xqr-_rs&}sv-_vw/^wx(tx!P-_!P!Q$q!Q!^-_!^!_*V!_!`&X!`!aMS!a#S-_#S#T1k#T#s-_#s$f$q$f;'S-_;'S;=`3X<%l?Ah-_?Ah?BY$q?BY?Mn-_?MnO$q!TM_XaP!b`!dp!fQOr&Xrs&}sv&Xwx(tx!^&X!^!_*V!_;'S&X;'S;=`*y<%lO&X!aNZ!ZiSgQaPlW!b`!dpOX$qXZ&XZ[$q[^&X^p$qpq&Xqr-_rs&}sv-_vw/^wx(tx}-_}!OMz!O!PMz!P!Q$q!Q![Mz![!]Mz!]!^-_!^!_*V!_!a&X!a!c-_!c!}Mz!}#R-_#R#SMz#S#T1k#T#oMz#o#s-_#s$f$q$f$}-_$}%OMz%O%W-_%W%oMz%o%p-_%p&aMz&a&b-_&b1pMz1p4UMz4U4dMz4d4e-_4e$ISMz$IS$I`-_$I`$IbMz$Ib$Je-_$Je$JgMz$Jg$Kh-_$Kh%#tMz%#t&/x-_&/x&EtMz&Et&FV-_&FV;'SMz;'S;:j!#|;:j;=`3X<%l?&r-_?&r?AhMz?Ah?BY$q?BY?MnMz?MnO$q!a!$PP;=`<%lMz!R!$ZY!b`!dpOq*Vqr!$yrs(Vsv*Vwx)ex!a*V!a!b!4t!b;'S*V;'S;=`*s<%lO*V!R!%Q]!b`!dpOr*Vrs(Vsv*Vwx)ex}*V}!O!%y!O!f*V!f!g!']!g#W*V#W#X!0`#X;'S*V;'S;=`*s<%lO*V!R!&QX!b`!dpOr*Vrs(Vsv*Vwx)ex}*V}!O!&m!O;'S*V;'S;=`*s<%lO*V!R!&vV!b`!dp!ePOr*Vrs(Vsv*Vwx)ex;'S*V;'S;=`*s<%lO*V!R!'dX!b`!dpOr*Vrs(Vsv*Vwx)ex!q*V!q!r!(P!r;'S*V;'S;=`*s<%lO*V!R!(WX!b`!dpOr*Vrs(Vsv*Vwx)ex!e*V!e!f!(s!f;'S*V;'S;=`*s<%lO*V!R!(zX!b`!dpOr*Vrs(Vsv*Vwx)ex!v*V!v!w!)g!w;'S*V;'S;=`*s<%lO*V!R!)nX!b`!dpOr*Vrs(Vsv*Vwx)ex!{*V!{!|!*Z!|;'S*V;'S;=`*s<%lO*V!R!*bX!b`!dpOr*Vrs(Vsv*Vwx)ex!r*V!r!s!*}!s;'S*V;'S;=`*s<%lO*V!R!+UX!b`!dpOr*Vrs(Vsv*Vwx)ex!g*V!g!h!+q!h;'S*V;'S;=`*s<%lO*V!R!+xY!b`!dpOr!+qrs!,hsv!+qvw!-Swx!.[x!`!+q!`!a!/j!a;'S!+q;'S;=`!0Y<%lO!+qq!,mV!dpOv!,hvx!-Sx!`!,h!`!a!-q!a;'S!,h;'S;=`!.U<%lO!,hP!-VTO!`!-S!`!a!-f!a;'S!-S;'S;=`!-k<%lO!-SP!-kO|PP!-nP;=`<%l!-Sq!-xS!dp|POv(Vx;'S(V;'S;=`(h<%lO(Vq!.XP;=`<%l!,ha!.aX!b`Or!.[rs!-Ssv!.[vw!-Sw!`!.[!`!a!.|!a;'S!.[;'S;=`!/d<%lO!.[a!/TT!b`|POr)esv)ew;'S)e;'S;=`)y<%lO)ea!/gP;=`<%l!.[!R!/sV!b`!dp|POr*Vrs(Vsv*Vwx)ex;'S*V;'S;=`*s<%lO*V!R!0]P;=`<%l!+q!R!0gX!b`!dpOr*Vrs(Vsv*Vwx)ex#c*V#c#d!1S#d;'S*V;'S;=`*s<%lO*V!R!1ZX!b`!dpOr*Vrs(Vsv*Vwx)ex#V*V#V#W!1v#W;'S*V;'S;=`*s<%lO*V!R!1}X!b`!dpOr*Vrs(Vsv*Vwx)ex#h*V#h#i!2j#i;'S*V;'S;=`*s<%lO*V!R!2qX!b`!dpOr*Vrs(Vsv*Vwx)ex#m*V#m#n!3^#n;'S*V;'S;=`*s<%lO*V!R!3eX!b`!dpOr*Vrs(Vsv*Vwx)ex#d*V#d#e!4Q#e;'S*V;'S;=`*s<%lO*V!R!4XX!b`!dpOr*Vrs(Vsv*Vwx)ex#X*V#X#Y!+q#Y;'S*V;'S;=`*s<%lO*V!R!4{Y!b`!dpOr!4trs!5ksv!4tvw!6Vwx!8]x!a!4t!a!b!:]!b;'S!4t;'S;=`!;r<%lO!4tq!5pV!dpOv!5kvx!6Vx!a!5k!a!b!7W!b;'S!5k;'S;=`!8V<%lO!5kP!6YTO!a!6V!a!b!6i!b;'S!6V;'S;=`!7Q<%lO!6VP!6lTO!`!6V!`!a!6{!a;'S!6V;'S;=`!7Q<%lO!6VP!7QOyPP!7TP;=`<%l!6Vq!7]V!dpOv!5kvx!6Vx!`!5k!`!a!7r!a;'S!5k;'S;=`!8V<%lO!5kq!7yS!dpyPOv(Vx;'S(V;'S;=`(h<%lO(Vq!8YP;=`<%l!5ka!8bX!b`Or!8]rs!6Vsv!8]vw!6Vw!a!8]!a!b!8}!b;'S!8];'S;=`!:V<%lO!8]a!9SX!b`Or!8]rs!6Vsv!8]vw!6Vw!`!8]!`!a!9o!a;'S!8];'S;=`!:V<%lO!8]a!9vT!b`yPOr)esv)ew;'S)e;'S;=`)y<%lO)ea!:YP;=`<%l!8]!R!:dY!b`!dpOr!4trs!5ksv!4tvw!6Vwx!8]x!`!4t!`!a!;S!a;'S!4t;'S;=`!;r<%lO!4t!R!;]V!b`!dpyPOr*Vrs(Vsv*Vwx)ex;'S*V;'S;=`*s<%lO*V!R!;uP;=`<%l!4t!V!<TXjSaP!b`!dpOr&Xrs&}sv&Xwx(tx!^&X!^!_*V!_;'S&X;'S;=`*y<%lO&X",tokenizers:[JW,eZ,tZ,KW,ZW,YW,0,1,2,3,4,5],topRules:{Document:[0,16]},dialects:{noMatch:0,selfClosing:515},tokenPrec:517});function CI(n,e){let t=Object.create(null);for(let i of n.getChildren(wI)){let s=i.getChild(IW),r=i.getChild(sy)||i.getChild(_I);s&&(t[e.read(s.from,s.to)]=r?r.type.id==sy?e.read(r.from+1,r.to-1):e.read(r.from,r.to):"")}return t}function m_(n,e){let t=n.getChild(MW);return t?e.read(t.from,t.to):" "}function Tg(n,e,t){let i;for(let s of t)if(!s.attrs||s.attrs(i||(i=CI(n.node.parent.firstChild,e))))return{parser:s.parser};return null}function EI(n=[],e=[]){let t=[],i=[],s=[],r=[];for(let a of n)(a.tag=="script"?t:a.tag=="style"?i:a.tag=="textarea"?s:r).push(a);let o=e.length?Object.create(null):null;for(let a of e)(o[a.name]||(o[a.name]=[])).push(a);return VM((a,l)=>{let h=a.type.id;if(h==RW)return Tg(a,l,t);if(h==LW)return Tg(a,l,i);if(h==$W)return Tg(a,l,s);if(h==TI&&r.length){let u=a.node,c=u.firstChild,f=c&&m_(c,l),p;if(f){for(let b of r)if(b.tag==f&&(!b.attrs||b.attrs(p||(p=CI(c,l))))){let y=u.lastChild,_=y.type.id==BW?y.from:u.to;if(_>c.to)return{parser:b.parser,overlay:[{from:c.to,to:_}]}}}}if(o&&h==wI){let u=a.node,c;if(c=u.firstChild){let f=o[l.read(c.from,c.to)];if(f)for(let p of f){if(p.tagName&&p.tagName!=m_(u.parent,l))continue;let b=u.lastChild;if(b.type.id==sy){let y=b.from+1,_=b.lastChild,T=b.to-(_&&_.isError?0:1);if(T>y)return{parser:p.parser,overlay:[{from:y,to:T}]}}else if(b.type.id==_I)return{parser:p.parser,overlay:[{from:b.from,to:b.to}]}}}}return null})}const sZ=122,g_=1,rZ=123,oZ=124,AI=2,aZ=125,lZ=3,hZ=4,PI=[9,10,11,12,13,32,133,160,5760,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8232,8233,8239,8287,12288],uZ=58,cZ=40,DI=95,dZ=91,vd=45,fZ=46,pZ=35,mZ=37,gZ=38,OZ=92,yZ=10,bZ=42;function pu(n){return n>=65&&n<=90||n>=97&&n<=122||n>=161}function dv(n){return n>=48&&n<=57}function O_(n){return dv(n)||n>=97&&n<=102||n>=65&&n<=70}const MI=(n,e,t)=>(i,s)=>{for(let r=!1,o=0,a=0;;a++){let{next:l}=i;if(pu(l)||l==vd||l==DI||r&&dv(l))!r&&(l!=vd||a>0)&&(r=!0),o===a&&l==vd&&o++,i.advance();else if(l==OZ&&i.peek(1)!=yZ){if(i.advance(),O_(i.next)){do i.advance();while(O_(i.next));i.next==32&&i.advance()}else i.next>-1&&i.advance();r=!0}else{r&&i.acceptToken(o==2&&s.canShift(AI)?e:l==cZ?t:n);break}}},vZ=new fn(MI(rZ,AI,oZ)),SZ=new fn(MI(aZ,lZ,hZ)),xZ=new fn(n=>{if(PI.includes(n.peek(-1))){let{next:e}=n;(pu(e)||e==DI||e==pZ||e==fZ||e==bZ||e==dZ||e==uZ&&pu(n.peek(1))||e==vd||e==gZ)&&n.acceptToken(sZ)}}),TZ=new fn(n=>{if(!PI.includes(n.peek(-1))){let{next:e}=n;if(e==mZ&&(n.advance(),n.acceptToken(g_)),pu(e)){do n.advance();while(pu(n.next)||dv(n.next));n.acceptToken(g_)}}}),wZ=Ol({"AtKeyword import charset namespace keyframes media supports":j.definitionKeyword,"from to selector":j.keyword,NamespaceName:j.namespace,KeyframeName:j.labelName,KeyframeRangeName:j.operatorKeyword,TagName:j.tagName,ClassName:j.className,PseudoClassName:j.constant(j.className),IdName:j.labelName,"FeatureName PropertyName":j.propertyName,AttributeName:j.attributeName,NumberLiteral:j.number,KeywordQuery:j.keyword,UnaryQueryOp:j.operatorKeyword,"CallTag ValueName":j.atom,VariableName:j.variableName,Callee:j.operatorKeyword,Unit:j.unit,"UniversalSelector NestingSelector":j.definitionOperator,"MatchOp CompareOp":j.compareOperator,"ChildOp SiblingOp, LogicOp":j.logicOperator,BinOp:j.arithmeticOperator,Important:j.modifier,Comment:j.blockComment,ColorLiteral:j.color,"ParenthesizedContent StringLiteral":j.string,":":j.punctuation,"PseudoOp #":j.derefOperator,"; ,":j.separator,"( )":j.paren,"[ ]":j.squareBracket,"{ }":j.brace}),_Z={__proto__:null,lang:38,"nth-child":38,"nth-last-child":38,"nth-of-type":38,"nth-last-of-type":38,dir:38,"host-context":38,if:84,url:124,"url-prefix":124,domain:124,regexp:124},kZ={__proto__:null,or:98,and:98,not:106,only:106,layer:170},CZ={__proto__:null,selector:112,layer:166},EZ={__proto__:null,"@import":162,"@media":174,"@charset":178,"@namespace":182,"@keyframes":188,"@supports":200,"@scope":204},AZ={__proto__:null,to:207},PZ=sl.deserialize({version:14,states:"EbQYQdOOO#qQdOOP#xO`OOOOQP'#Cf'#CfOOQP'#Ce'#CeO#}QdO'#ChO$nQaO'#CcO$xQdO'#CkO%TQdO'#DpO%YQdO'#DrO%_QdO'#DuO%_QdO'#DxOOQP'#FV'#FVO&eQhO'#EhOOQS'#FU'#FUOOQS'#Ek'#EkQYQdOOO&lQdO'#EOO&PQhO'#EUO&lQdO'#EWO'aQdO'#EYO'lQdO'#E]O'tQhO'#EcO(VQdO'#EeO(bQaO'#CfO)VQ`O'#D{O)[Q`O'#F`O)gQdO'#F`QOQ`OOP)qO&jO'#CaPOOO)C@t)C@tOOQP'#Cj'#CjOOQP,59S,59SO#}QdO,59SO)|QdO,59VO%TQdO,5:[O%YQdO,5:^O%_QdO,5:aO%_QdO,5:cO%_QdO,5:dO%_QdO'#ErO*XQ`O,58}O*aQdO'#DzOOQS,58},58}OOQP'#Cn'#CnOOQO'#Dn'#DnOOQP,59V,59VO*hQ`O,59VO*mQ`O,59VOOQP'#Dq'#DqOOQP,5:[,5:[OOQO'#Ds'#DsO*rQpO,5:^O+]QaO,5:aO+sQaO,5:dOOQW'#DZ'#DZO,ZQhO'#DdO,xQhO'#FaO'tQhO'#DbO-WQ`O'#DhOOQW'#F['#F[O-]Q`O,5;SO-eQ`O'#DeOOQS-E8i-E8iOOQ['#Cs'#CsO-jQdO'#CtO.QQdO'#CzO.hQdO'#C}O/OQ!pO'#DPO1RQ!jO,5:jOOQO'#DU'#DUO*mQ`O'#DTO1cQ!nO'#FXO3`Q`O'#DVO3eQ`O'#DkOOQ['#FX'#FXO-`Q`O,5:pO3jQ!bO,5:rOOQS'#E['#E[O3rQ`O,5:tO3wQdO,5:tOOQO'#E_'#E_O4PQ`O,5:wO4UQhO,5:}O%_QdO'#DgOOQS,5;P,5;PO-eQ`O,5;PO4^QdO,5;PO4fQdO,5:gO4vQdO'#EtO5TQ`O,5;zO5TQ`O,5;zPOOO'#Ej'#EjP5`O&jO,58{POOO,58{,58{OOQP1G.n1G.nOOQP1G.q1G.qO*hQ`O1G.qO*mQ`O1G.qOOQP1G/v1G/vO5kQpO1G/xO5sQaO1G/{O6ZQaO1G/}O6qQaO1G0OO7XQaO,5;^OOQO-E8p-E8pOOQS1G.i1G.iO7cQ`O,5:fO7hQdO'#DoO7oQdO'#CrOOQP1G/x1G/xO&lQdO1G/xO7vQ!jO'#DZO8UQ!bO,59vO8^QhO,5:OOOQO'#F]'#F]O8XQ!bO,59zO'tQhO,59xO8fQhO'#EvO8sQ`O,5;{O9OQhO,59|O9uQhO'#DiOOQW,5:S,5:SOOQS1G0n1G0nOOQW,5:P,5:PO9|Q!fO'#FYOOQS'#FY'#FYOOQS'#Em'#EmO;^QdO,59`OOQ[,59`,59`O;tQdO,59fOOQ[,59f,59fO<[QdO,59iOOQ[,59i,59iOOQ[,59k,59kO&lQdO,59mO<rQhO'#EQOOQW'#EQ'#EQO=WQ`O1G0UO1[QhO1G0UOOQ[,59o,59oO'tQhO'#DXOOQ[,59q,59qO=]Q#tO,5:VOOQS1G0[1G0[OOQS1G0^1G0^OOQS1G0`1G0`O=hQ`O1G0`O=mQdO'#E`OOQS1G0c1G0cOOQS1G0i1G0iO=xQaO,5:RO-`Q`O1G0kOOQS1G0k1G0kO-eQ`O1G0kO>PQ!fO1G0ROOQO1G0R1G0ROOQO,5;`,5;`O>gQdO,5;`OOQO-E8r-E8rO>tQ`O1G1fPOOO-E8h-E8hPOOO1G.g1G.gOOQP7+$]7+$]OOQP7+%d7+%dO&lQdO7+%dOOQS1G0Q1G0QO?PQaO'#F_O?ZQ`O,5:ZO?`Q!fO'#ElO@^QdO'#FWO@hQ`O,59^O@mQ!bO7+%dO&lQdO1G/bO@uQhO1G/fOOQW1G/j1G/jOOQW1G/d1G/dOAWQhO,5;bOOQO-E8t-E8tOAfQhO'#DZOAtQhO'#F^OBPQ`O'#F^OBUQ`O,5:TOOQS-E8k-E8kOOQ[1G.z1G.zOOQ[1G/Q1G/QOOQ[1G/T1G/TOOQ[1G/X1G/XOBZQdO,5:lOOQS7+%p7+%pOB`Q`O7+%pOBeQhO'#DYOBmQ`O,59sO'tQhO,59sOOQ[1G/q1G/qOBuQ`O1G/qOOQS7+%z7+%zOBzQbO'#DPOOQO'#Eb'#EbOCYQ`O'#EaOOQO'#Ea'#EaOCeQ`O'#EwOCmQdO,5:zOOQS,5:z,5:zOOQ[1G/m1G/mOOQS7+&V7+&VO-`Q`O7+&VOCxQ!fO'#EsO&lQdO'#EsOEPQdO7+%mOOQO7+%m7+%mOOQO1G0z1G0zOEdQ!bO<<IOOElQdO'#EqOEvQ`O,5;yOOQP1G/u1G/uOOQS-E8j-E8jOFOQdO'#EpOFYQ`O,5;rOOQ]1G.x1G.xOOQP<<IO<<IOOFbQdO7+$|OOQO'#D]'#D]OFiQ!bO7+%QOFqQhO'#EoOF{Q`O,5;xO&lQdO,5;xOOQW1G/o1G/oOOQO'#ES'#ESOGTQ`O1G0WOOQS<<I[<<I[O&lQdO,59tOGnQhO1G/_OOQ[1G/_1G/_OGuQ`O1G/_OOQW-E8l-E8lOOQ[7+%]7+%]OOQO,5:{,5:{O=pQdO'#ExOCeQ`O,5;cOOQS,5;c,5;cOOQS-E8u-E8uOOQS1G0f1G0fOOQS<<Iq<<IqOG}Q!fO,5;_OOQS-E8q-E8qOOQO<<IX<<IXOOQPAN>jAN>jOIUQaO,5;]OOQO-E8o-E8oOI`QdO,5;[OOQO-E8n-E8nOOQW<<Hh<<HhOOQW<<Hl<<HlOIjQhO<<HlOI{QhO,5;ZOJWQ`O,5;ZOOQO-E8m-E8mOJ]QdO1G1dOBZQdO'#EuOJgQ`O7+%rOOQW7+%r7+%rOJoQ!bO1G/`OOQ[7+$y7+$yOJzQhO7+$yPKRQ`O'#EnOOQO,5;d,5;dOOQO-E8v-E8vOOQS1G0}1G0}OKWQ`OAN>WO&lQdO1G0uOK]Q`O7+'OOOQO,5;a,5;aOOQO-E8s-E8sOOQW<<I^<<I^OOQ[<<He<<HePOQW,5;Y,5;YOOQWG23rG23rOKeQdO7+&a",stateData:"Kx~O#sOS#tQQ~OW[OZ[O]TO`VOaVOi]OjWOmXO!jYO!mZO!saO!ybO!{cO!}dO#QeO#WfO#YgO#oRO~OQiOW[OZ[O]TO`VOaVOi]OjWOmXO!jYO!mZO!saO!ybO!{cO!}dO#QeO#WfO#YgO#ohO~O#m$SP~P!dO#tmO~O#ooO~O]qO`rOarOjsOmtO!juO!mwO#nvO~OpzO!^xO~P$SOc!QO#o|O#p}O~O#o!RO~O#o!TO~OW[OZ[O]TO`VOaVOjWOmXO!jYO!mZO#oRO~OS!]Oe!YO!V![O!Y!`O#q!XOp$TP~Ok$TP~P&POQ!jOe!cOm!dOp!eOr!mOt!mOz!kO!`!lO#o!bO#p!hO#}!fO~Ot!qO!`!lO#o!pO~Ot!sO#o!sO~OS!]Oe!YO!V![O!Y!`O#q!XO~Oe!vOpzO#Z!xO~O]YX`YX`!pXaYXjYXmYXpYX!^YX!jYX!mYX#nYX~O`!zO~Ok!{O#m$SXo$SX~O#m$SXo$SX~P!dO#u#OO#v#OO#w#QO~Oc#UO#o|O#p}O~OpzO!^xO~Oo$SP~P!dOe#`O~Oe#aO~Ol#bO!h#cO~O]qO`rOarOjsOmtO~Op!ia!^!ia!j!ia!m!ia#n!iad!ia~P*zOp!la!^!la!j!la!m!la#n!lad!la~P*zOR#gOS!]Oe!YOr#gOt#gO!V![O!Y!`O#q#dO#}!fO~O!R#iO!^#jOk$TXp$TX~Oe#mO~Ok#oOpzO~Oe!vO~O]#rO`#rOd#uOi#rOj#rOk#rO~P&lO]#rO`#rOi#rOj#rOk#rOl#wO~P&lO]#rO`#rOi#rOj#rOk#rOo#yO~P&lOP#zOSsXesXksXvsX!VsX!YsX!usX!wsX#qsX!TsXQsX]sX`sXdsXisXjsXmsXpsXrsXtsXzsX!`sX#osX#psX#}sXlsXosX!^sX!qsX#msX~Ov#{O!u#|O!w#}Ok$TP~P'tOe#aOS#{Xk#{Xv#{X!V#{X!Y#{X!u#{X!w#{X#q#{XQ#{X]#{X`#{Xd#{Xi#{Xj#{Xm#{Xp#{Xr#{Xt#{Xz#{X!`#{X#o#{X#p#{X#}#{Xl#{Xo#{X!^#{X!q#{X#m#{X~Oe$RO~Oe$TO~Ok$VOv#{O~Ok$WO~Ot$XO!`!lO~Op$YO~OpzO!R#iO~OpzO#Z$`O~O!q$bOk!oa#m!oao!oa~P&lOk#hX#m#hXo#hX~P!dOk!{O#m$Sao$Sa~O#u#OO#v#OO#w$hO~Ol$jO!h$kO~Op!ii!^!ii!j!ii!m!ii#n!iid!ii~P*zOp!ki!^!ki!j!ki!m!ki#n!kid!ki~P*zOp!li!^!li!j!li!m!li#n!lid!li~P*zOp#fa!^#fa~P$SOo$lO~Od$RP~P%_Od#zP~P&lO`!PXd}X!R}X!T!PX~O`$sO!T$tO~Od$uO!R#iO~Ok#jXp#jX!^#jX~P'tO!^#jOk$Tap$Ta~O!R#iOk!Uap!Ua!^!Uad!Ua`!Ua~OS!]Oe!YO!V![O!Y!`O#q$yO~Od$QP~P9dOv#{OQ#|X]#|X`#|Xd#|Xe#|Xi#|Xj#|Xk#|Xm#|Xp#|Xr#|Xt#|Xz#|X!`#|X#o#|X#p#|X#}#|Xl#|Xo#|X~O]#rO`#rOd%OOi#rOj#rOk#rO~P&lO]#rO`#rOi#rOj#rOk#rOl%PO~P&lO]#rO`#rOi#rOj#rOk#rOo%QO~P&lOe%SOS!tXk!tX!V!tX!Y!tX#q!tX~Ok%TO~Od%YOt%ZO!a%ZO~Ok%[O~Oo%cO#o%^O#}%]O~Od%dO~P$SOv#{O!^%hO!q%jOk!oi#m!oio!oi~P&lOk#ha#m#hao#ha~P!dOk!{O#m$Sio$Si~O!^%mOd$RX~P$SOd%oO~Ov#{OQ#`Xd#`Xe#`Xm#`Xp#`Xr#`Xt#`Xz#`X!^#`X!`#`X#o#`X#p#`X#}#`X~O!^%qOd#zX~P&lOd%sO~Ol%tOv#{O~OR#gOr#gOt#gO#q%vO#}!fO~O!R#iOk#jap#ja!^#ja~O`!PXd}X!R}X!^}X~O!R#iO!^%xOd$QX~O`%zO~Od%{O~O#o%|O~Ok&OO~O`&PO!R#iO~Od&ROk&QO~Od&UO~OP#zOpsX!^sXdsX~O#}%]Op#TX!^#TX~OpzO!^&WO~Oo&[O#o%^O#}%]O~Ov#{OQ#gXe#gXk#gXm#gXp#gXr#gXt#gXz#gX!^#gX!`#gX!q#gX#m#gX#o#gX#p#gX#}#gXo#gX~O!^%hO!q&`Ok!oq#m!oqo!oq~P&lOl&aOv#{O~Od#eX!^#eX~P%_O!^%mOd$Ra~Od#dX!^#dX~P&lO!^%qOd#za~Od&fO~P&lOd&gO!T&hO~Od#cX!^#cX~P9dO!^%xOd$Qa~O]&mOd&oO~OS#bae#ba!V#ba!Y#ba#q#ba~Od&qO~PG]Od&qOk&rO~Ov#{OQ#gae#gak#gam#gap#gar#gat#gaz#ga!^#ga!`#ga!q#ga#m#ga#o#ga#p#ga#}#gao#ga~Od#ea!^#ea~P$SOd#da!^#da~P&lOR#gOr#gOt#gO#q%vO#}%]O~O!R#iOd#ca!^#ca~O`&xO~O!^%xOd$Qi~P&lO]&mOd&|O~Ov#{Od|ik|i~Od&}O~PG]Ok'OO~Od'PO~O!^%xOd$Qq~Od#cq!^#cq~P&lO#s!a#t#}]#}v!m~",goto:"2h$UPPPPP$VP$YP$c$uP$cP%X$cPP%_PPP%e%o%oPPPPP%oPP%oP&]P%oP%o'W%oP't'w'}'}(^'}P'}P'}P'}'}P(m'}(yP(|PP)p)v$c)|$c*SP$cP$c$cP*Y*{+YP$YP+aP+dP$YP$YP$YP+j$YP+m+p+s+z$YP$YPP$YP,P,V,f,|-[-b-l-r-x.O.U.`.f.l.rPPPPPPPPPPP.x/R/w/z0|P1U1u2O2R2U2[RnQ_^OP`kz!{$dq[OPYZ`kuvwxz!v!{#`$d%mqSOPYZ`kuvwxz!v!{#`$d%mQpTR#RqQ!OVR#SrQ#S!QS$Q!i!jR$i#U!V!mac!c!d!e!z#a#c#t#v#x#{$a$k$p$s%h%i%q%u%z&P&d&l&x'Q!U!mac!c!d!e!z#a#c#t#v#x#{$a$k$p$s%h%i%q%u%z&P&d&l&x'QU#g!Y$t&hU%`$Y%b&WR&V%_!V!iac!c!d!e!z#a#c#t#v#x#{$a$k$p$s%h%i%q%u%z&P&d&l&x'QR$S!kQ%W$RR&S%Xk!^]bf!Y![!g#i#j#m$P$R%X%xQ#e!YQ${#mQ%w$tQ&j%xR&w&hQ!ygQ#p!`Q$^!xR%f$`R#n!]!U!mac!c!d!e!z#a#c#t#v#x#{$a$k$p$s%h%i%q%u%z&P&d&l&x'QQ!qdR$X!rQ!PVR#TrQ#S!PR$i#TQ!SWR#VsQ!UXR#WtQ{UQ!wgQ#^yQ#o!_Q$U!nQ$[!uQ$_!yQ%e$^Q&Y%aQ&]%fR&v&XSjPzQ!}kQ$c!{R%k$dZiPkz!{$dR$P!gQ%}%SR&z&mR!rdR!teR$Z!tS%a$Y%bR&t&WV%_$Y%b&WQ#PmR$g#PQ`OSkPzU!a`k$dR$d!{Q$p#aY%p$p%u&d&l'QQ%u$sQ&d%qQ&l%zR'Q&xQ#t!cQ#v!dQ#x!eV$}#t#v#xQ%X$RR&T%XQ%y$zS&k%y&yR&y&lQ%r$pR&e%rQ%n$mR&c%nQyUR#]yQ%i$aR&_%iQ!|jS$e!|$fR$f!}Q&n%}R&{&nQ#k!ZR$x#kQ%b$YR&Z%bQ&X%aR&u&X__OP`kz!{$d^UOP`kz!{$dQ!VYQ!WZQ#XuQ#YvQ#ZwQ#[xQ$]!vQ$m#`R&b%mR$q#aQ!gaQ!oc[#q!c!d!e#t#v#xQ$a!zd$o#a$p$s%q%u%z&d&l&x'QQ$r#cQ%R#{S%g$a%iQ%l$kQ&^%hR&p&P]#s!c!d!e#t#v#xW!Z]b!g$PQ!ufQ#f!YQ#l![Q$v#iQ$w#jQ$z#mS%V$R%XR&i%xQ#h!YQ%w$tR&w&hR$|#mR$n#`QlPR#_zQ!_]Q!nbQ$O!gR%U$P",nodeNames:"⚠ Unit VariableName VariableName QueryCallee Comment StyleSheet RuleSet UniversalSelector TagSelector TagName NestingSelector ClassSelector . ClassName PseudoClassSelector : :: PseudoClassName PseudoClassName ) ( ArgList ValueName ParenthesizedValue AtKeyword # ; ] [ BracketedValue } { BracedValue ColorLiteral NumberLiteral StringLiteral BinaryExpression BinOp CallExpression Callee IfExpression if ArgList IfBranch KeywordQuery FeatureQuery FeatureName BinaryQuery LogicOp ComparisonQuery CompareOp UnaryQuery UnaryQueryOp ParenthesizedQuery SelectorQuery selector ParenthesizedSelector CallQuery ArgList , CallLiteral CallTag ParenthesizedContent PseudoClassName ArgList IdSelector IdName AttributeSelector AttributeName MatchOp ChildSelector ChildOp DescendantSelector SiblingSelector SiblingOp Block Declaration PropertyName Important ImportStatement import Layer layer LayerName layer MediaStatement media CharsetStatement charset NamespaceStatement namespace NamespaceName KeyframesStatement keyframes KeyframeName KeyframeList KeyframeSelector KeyframeRangeName SupportsStatement supports ScopeStatement scope to AtRule Styles",maxTerm:143,nodeProps:[["isolate",-2,5,36,""],["openedBy",20,"(",28,"[",31,"{"],["closedBy",21,")",29,"]",32,"}"]],propSources:[wZ],skippedNodes:[0,5,106],repeatNodeCount:15,tokenData:"JQ~R!YOX$qX^%i^p$qpq%iqr({rs-ust/itu6Wuv$qvw7Qwx7cxy9Qyz9cz{9h{|:R|}>t}!O?V!O!P?t!P!Q@]!Q![AU![!]BP!]!^B{!^!_C^!_!`DY!`!aDm!a!b$q!b!cEn!c!}$q!}#OG{#O#P$q#P#QH^#Q#R6W#R#o$q#o#pHo#p#q6W#q#rIQ#r#sIc#s#y$q#y#z%i#z$f$q$f$g%i$g#BY$q#BY#BZ%i#BZ$IS$q$IS$I_%i$I_$I|$q$I|$JO%i$JO$JT$q$JT$JU%i$JU$KV$q$KV$KW%i$KW&FU$q&FU&FV%i&FV;'S$q;'S;=`Iz<%lO$q`$tSOy%Qz;'S%Q;'S;=`%c<%lO%Q`%VS!a`Oy%Qz;'S%Q;'S;=`%c<%lO%Q`%fP;=`<%l%Q~%nh#s~OX%QX^'Y^p%Qpq'Yqy%Qz#y%Q#y#z'Y#z$f%Q$f$g'Y$g#BY%Q#BY#BZ'Y#BZ$IS%Q$IS$I_'Y$I_$I|%Q$I|$JO'Y$JO$JT%Q$JT$JU'Y$JU$KV%Q$KV$KW'Y$KW&FU%Q&FU&FV'Y&FV;'S%Q;'S;=`%c<%lO%Q~'ah#s~!a`OX%QX^'Y^p%Qpq'Yqy%Qz#y%Q#y#z'Y#z$f%Q$f$g'Y$g#BY%Q#BY#BZ'Y#BZ$IS%Q$IS$I_'Y$I_$I|%Q$I|$JO'Y$JO$JT%Q$JT$JU'Y$JU$KV%Q$KV$KW'Y$KW&FU%Q&FU&FV'Y&FV;'S%Q;'S;=`%c<%lO%Qj)OUOy%Qz#]%Q#]#^)b#^;'S%Q;'S;=`%c<%lO%Qj)gU!a`Oy%Qz#a%Q#a#b)y#b;'S%Q;'S;=`%c<%lO%Qj*OU!a`Oy%Qz#d%Q#d#e*b#e;'S%Q;'S;=`%c<%lO%Qj*gU!a`Oy%Qz#c%Q#c#d*y#d;'S%Q;'S;=`%c<%lO%Qj+OU!a`Oy%Qz#f%Q#f#g+b#g;'S%Q;'S;=`%c<%lO%Qj+gU!a`Oy%Qz#h%Q#h#i+y#i;'S%Q;'S;=`%c<%lO%Qj,OU!a`Oy%Qz#T%Q#T#U,b#U;'S%Q;'S;=`%c<%lO%Qj,gU!a`Oy%Qz#b%Q#b#c,y#c;'S%Q;'S;=`%c<%lO%Qj-OU!a`Oy%Qz#h%Q#h#i-b#i;'S%Q;'S;=`%c<%lO%Qj-iS!qY!a`Oy%Qz;'S%Q;'S;=`%c<%lO%Q~-xWOY-uZr-urs.bs#O-u#O#P.g#P;'S-u;'S;=`/c<%lO-u~.gOt~~.jRO;'S-u;'S;=`.s;=`O-u~.vXOY-uZr-urs.bs#O-u#O#P.g#P;'S-u;'S;=`/c;=`<%l-u<%lO-u~/fP;=`<%l-uj/nYjYOy%Qz!Q%Q!Q![0^![!c%Q!c!i0^!i#T%Q#T#Z0^#Z;'S%Q;'S;=`%c<%lO%Qj0cY!a`Oy%Qz!Q%Q!Q![1R![!c%Q!c!i1R!i#T%Q#T#Z1R#Z;'S%Q;'S;=`%c<%lO%Qj1WY!a`Oy%Qz!Q%Q!Q![1v![!c%Q!c!i1v!i#T%Q#T#Z1v#Z;'S%Q;'S;=`%c<%lO%Qj1}YrY!a`Oy%Qz!Q%Q!Q![2m![!c%Q!c!i2m!i#T%Q#T#Z2m#Z;'S%Q;'S;=`%c<%lO%Qj2tYrY!a`Oy%Qz!Q%Q!Q![3d![!c%Q!c!i3d!i#T%Q#T#Z3d#Z;'S%Q;'S;=`%c<%lO%Qj3iY!a`Oy%Qz!Q%Q!Q![4X![!c%Q!c!i4X!i#T%Q#T#Z4X#Z;'S%Q;'S;=`%c<%lO%Qj4`YrY!a`Oy%Qz!Q%Q!Q![5O![!c%Q!c!i5O!i#T%Q#T#Z5O#Z;'S%Q;'S;=`%c<%lO%Qj5TY!a`Oy%Qz!Q%Q!Q![5s![!c%Q!c!i5s!i#T%Q#T#Z5s#Z;'S%Q;'S;=`%c<%lO%Qj5zSrY!a`Oy%Qz;'S%Q;'S;=`%c<%lO%Qd6ZUOy%Qz!_%Q!_!`6m!`;'S%Q;'S;=`%c<%lO%Qd6tS!hS!a`Oy%Qz;'S%Q;'S;=`%c<%lO%Qb7VSZQOy%Qz;'S%Q;'S;=`%c<%lO%Q~7fWOY7cZw7cwx.bx#O7c#O#P8O#P;'S7c;'S;=`8z<%lO7c~8RRO;'S7c;'S;=`8[;=`O7c~8_XOY7cZw7cwx.bx#O7c#O#P8O#P;'S7c;'S;=`8z;=`<%l7c<%lO7c~8}P;=`<%l7cj9VSeYOy%Qz;'S%Q;'S;=`%c<%lO%Q~9hOd~n9oUWQvWOy%Qz!_%Q!_!`6m!`;'S%Q;'S;=`%c<%lO%Qj:YWvW!mQOy%Qz!O%Q!O!P:r!P!Q%Q!Q![=w![;'S%Q;'S;=`%c<%lO%Qj:wU!a`Oy%Qz!Q%Q!Q![;Z![;'S%Q;'S;=`%c<%lO%Qj;bY!a`#}YOy%Qz!Q%Q!Q![;Z![!g%Q!g!h<Q!h#X%Q#X#Y<Q#Y;'S%Q;'S;=`%c<%lO%Qj<VY!a`Oy%Qz{%Q{|<u|}%Q}!O<u!O!Q%Q!Q![=^![;'S%Q;'S;=`%c<%lO%Qj<zU!a`Oy%Qz!Q%Q!Q![=^![;'S%Q;'S;=`%c<%lO%Qj=eU!a`#}YOy%Qz!Q%Q!Q![=^![;'S%Q;'S;=`%c<%lO%Qj>O[!a`#}YOy%Qz!O%Q!O!P;Z!P!Q%Q!Q![=w![!g%Q!g!h<Q!h#X%Q#X#Y<Q#Y;'S%Q;'S;=`%c<%lO%Qj>yS!^YOy%Qz;'S%Q;'S;=`%c<%lO%Qj?[WvWOy%Qz!O%Q!O!P:r!P!Q%Q!Q![=w![;'S%Q;'S;=`%c<%lO%Qj?yU]YOy%Qz!Q%Q!Q![;Z![;'S%Q;'S;=`%c<%lO%Q~@bTvWOy%Qz{@q{;'S%Q;'S;=`%c<%lO%Q~@xS!a`#t~Oy%Qz;'S%Q;'S;=`%c<%lO%QjAZ[#}YOy%Qz!O%Q!O!P;Z!P!Q%Q!Q![=w![!g%Q!g!h<Q!h#X%Q#X#Y<Q#Y;'S%Q;'S;=`%c<%lO%QjBUU`YOy%Qz![%Q![!]Bh!];'S%Q;'S;=`%c<%lO%QbBoSaQ!a`Oy%Qz;'S%Q;'S;=`%c<%lO%QjCQSkYOy%Qz;'S%Q;'S;=`%c<%lO%QhCcU!TWOy%Qz!_%Q!_!`Cu!`;'S%Q;'S;=`%c<%lO%QhC|S!TW!a`Oy%Qz;'S%Q;'S;=`%c<%lO%QlDaS!TW!hSOy%Qz;'S%Q;'S;=`%c<%lO%QjDtV!jQ!TWOy%Qz!_%Q!_!`Cu!`!aEZ!a;'S%Q;'S;=`%c<%lO%QbEbS!jQ!a`Oy%Qz;'S%Q;'S;=`%c<%lO%QjEqYOy%Qz}%Q}!OFa!O!c%Q!c!}GO!}#T%Q#T#oGO#o;'S%Q;'S;=`%c<%lO%QjFfW!a`Oy%Qz!c%Q!c!}GO!}#T%Q#T#oGO#o;'S%Q;'S;=`%c<%lO%QjGV[iY!a`Oy%Qz}%Q}!OGO!O!Q%Q!Q![GO![!c%Q!c!}GO!}#T%Q#T#oGO#o;'S%Q;'S;=`%c<%lO%QjHQSmYOy%Qz;'S%Q;'S;=`%c<%lO%QnHcSl^Oy%Qz;'S%Q;'S;=`%c<%lO%QjHtSpYOy%Qz;'S%Q;'S;=`%c<%lO%QjIVSoYOy%Qz;'S%Q;'S;=`%c<%lO%QfIhU!mQOy%Qz!_%Q!_!`6m!`;'S%Q;'S;=`%c<%lO%Q`I}P;=`<%l$q",tokenizers:[xZ,TZ,vZ,SZ,1,2,3,4,new Df("m~RRYZ[z{a~~g~aO#v~~dP!P!Qg~lO#w~~",28,129)],topRules:{StyleSheet:[0,6],Styles:[1,105]},specialized:[{term:124,get:n=>_Z[n]||-1},{term:125,get:n=>kZ[n]||-1},{term:4,get:n=>CZ[n]||-1},{term:25,get:n=>EZ[n]||-1},{term:123,get:n=>AZ[n]||-1}],tokenPrec:1963});let wg=null;function _g(){if(!wg&&typeof document=="object"&&document.body){let{style:n}=document.body,e=[],t=new Set;for(let i in n)i!="cssText"&&i!="cssFloat"&&typeof n[i]=="string"&&(/[A-Z]/.test(i)&&(i=i.replace(/[A-Z]/g,s=>"-"+s.toLowerCase())),t.has(i)||(e.push(i),t.add(i)));wg=e.sort().map(i=>({type:"property",label:i,apply:i+": "}))}return wg||[]}const y_=["active","after","any-link","autofill","backdrop","before","checked","cue","default","defined","disabled","empty","enabled","file-selector-button","first","first-child","first-letter","first-line","first-of-type","focus","focus-visible","focus-within","fullscreen","has","host","host-context","hover","in-range","indeterminate","invalid","is","lang","last-child","last-of-type","left","link","marker","modal","not","nth-child","nth-last-child","nth-last-of-type","nth-of-type","only-child","only-of-type","optional","out-of-range","part","placeholder","placeholder-shown","read-only","read-write","required","right","root","scope","selection","slotted","target","target-text","valid","visited","where"].map(n=>({type:"class",label:n})),b_=["above","absolute","activeborder","additive","activecaption","after-white-space","ahead","alias","all","all-scroll","alphabetic","alternate","always","antialiased","appworkspace","asterisks","attr","auto","auto-flow","avoid","avoid-column","avoid-page","avoid-region","axis-pan","background","backwards","baseline","below","bidi-override","blink","block","block-axis","bold","bolder","border","border-box","both","bottom","break","break-all","break-word","bullets","button","button-bevel","buttonface","buttonhighlight","buttonshadow","buttontext","calc","capitalize","caps-lock-indicator","caption","captiontext","caret","cell","center","checkbox","circle","cjk-decimal","clear","clip","close-quote","col-resize","collapse","color","color-burn","color-dodge","column","column-reverse","compact","condensed","contain","content","contents","content-box","context-menu","continuous","copy","counter","counters","cover","crop","cross","crosshair","currentcolor","cursive","cyclic","darken","dashed","decimal","decimal-leading-zero","default","default-button","dense","destination-atop","destination-in","destination-out","destination-over","difference","disc","discard","disclosure-closed","disclosure-open","document","dot-dash","dot-dot-dash","dotted","double","down","e-resize","ease","ease-in","ease-in-out","ease-out","element","ellipse","ellipsis","embed","end","ethiopic-abegede-gez","ethiopic-halehame-aa-er","ethiopic-halehame-gez","ew-resize","exclusion","expanded","extends","extra-condensed","extra-expanded","fantasy","fast","fill","fill-box","fixed","flat","flex","flex-end","flex-start","footnotes","forwards","from","geometricPrecision","graytext","grid","groove","hand","hard-light","help","hidden","hide","higher","highlight","highlighttext","horizontal","hsl","hsla","hue","icon","ignore","inactiveborder","inactivecaption","inactivecaptiontext","infinite","infobackground","infotext","inherit","initial","inline","inline-axis","inline-block","inline-flex","inline-grid","inline-table","inset","inside","intrinsic","invert","italic","justify","keep-all","landscape","large","larger","left","level","lighter","lighten","line-through","linear","linear-gradient","lines","list-item","listbox","listitem","local","logical","loud","lower","lower-hexadecimal","lower-latin","lower-norwegian","lowercase","ltr","luminosity","manipulation","match","matrix","matrix3d","medium","menu","menutext","message-box","middle","min-intrinsic","mix","monospace","move","multiple","multiple_mask_images","multiply","n-resize","narrower","ne-resize","nesw-resize","no-close-quote","no-drop","no-open-quote","no-repeat","none","normal","not-allowed","nowrap","ns-resize","numbers","numeric","nw-resize","nwse-resize","oblique","opacity","open-quote","optimizeLegibility","optimizeSpeed","outset","outside","outside-shape","overlay","overline","padding","padding-box","painted","page","paused","perspective","pinch-zoom","plus-darker","plus-lighter","pointer","polygon","portrait","pre","pre-line","pre-wrap","preserve-3d","progress","push-button","radial-gradient","radio","read-only","read-write","read-write-plaintext-only","rectangle","region","relative","repeat","repeating-linear-gradient","repeating-radial-gradient","repeat-x","repeat-y","reset","reverse","rgb","rgba","ridge","right","rotate","rotate3d","rotateX","rotateY","rotateZ","round","row","row-resize","row-reverse","rtl","run-in","running","s-resize","sans-serif","saturation","scale","scale3d","scaleX","scaleY","scaleZ","screen","scroll","scrollbar","scroll-position","se-resize","self-start","self-end","semi-condensed","semi-expanded","separate","serif","show","single","skew","skewX","skewY","skip-white-space","slide","slider-horizontal","slider-vertical","sliderthumb-horizontal","sliderthumb-vertical","slow","small","small-caps","small-caption","smaller","soft-light","solid","source-atop","source-in","source-out","source-over","space","space-around","space-between","space-evenly","spell-out","square","start","static","status-bar","stretch","stroke","stroke-box","sub","subpixel-antialiased","svg_masks","super","sw-resize","symbolic","symbols","system-ui","table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row","table-row-group","text","text-bottom","text-top","textarea","textfield","thick","thin","threeddarkshadow","threedface","threedhighlight","threedlightshadow","threedshadow","to","top","transform","translate","translate3d","translateX","translateY","translateZ","transparent","ultra-condensed","ultra-expanded","underline","unidirectional-pan","unset","up","upper-latin","uppercase","url","var","vertical","vertical-text","view-box","visible","visibleFill","visiblePainted","visibleStroke","visual","w-resize","wait","wave","wider","window","windowframe","windowtext","words","wrap","wrap-reverse","x-large","x-small","xor","xx-large","xx-small"].map(n=>({type:"keyword",label:n})).concat(["aliceblue","antiquewhite","aqua","aquamarine","azure","beige","bisque","black","blanchedalmond","blue","blueviolet","brown","burlywood","cadetblue","chartreuse","chocolate","coral","cornflowerblue","cornsilk","crimson","cyan","darkblue","darkcyan","darkgoldenrod","darkgray","darkgreen","darkkhaki","darkmagenta","darkolivegreen","darkorange","darkorchid","darkred","darksalmon","darkseagreen","darkslateblue","darkslategray","darkturquoise","darkviolet","deeppink","deepskyblue","dimgray","dodgerblue","firebrick","floralwhite","forestgreen","fuchsia","gainsboro","ghostwhite","gold","goldenrod","gray","grey","green","greenyellow","honeydew","hotpink","indianred","indigo","ivory","khaki","lavender","lavenderblush","lawngreen","lemonchiffon","lightblue","lightcoral","lightcyan","lightgoldenrodyellow","lightgray","lightgreen","lightpink","lightsalmon","lightseagreen","lightskyblue","lightslategray","lightsteelblue","lightyellow","lime","limegreen","linen","magenta","maroon","mediumaquamarine","mediumblue","mediumorchid","mediumpurple","mediumseagreen","mediumslateblue","mediumspringgreen","mediumturquoise","mediumvioletred","midnightblue","mintcream","mistyrose","moccasin","navajowhite","navy","oldlace","olive","olivedrab","orange","orangered","orchid","palegoldenrod","palegreen","paleturquoise","palevioletred","papayawhip","peachpuff","peru","pink","plum","powderblue","purple","rebeccapurple","red","rosybrown","royalblue","saddlebrown","salmon","sandybrown","seagreen","seashell","sienna","silver","skyblue","slateblue","slategray","snow","springgreen","steelblue","tan","teal","thistle","tomato","turquoise","violet","wheat","white","whitesmoke","yellow","yellowgreen"].map(n=>({type:"constant",label:n}))),DZ=["a","abbr","address","article","aside","b","bdi","bdo","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","dd","del","details","dfn","dialog","div","dl","dt","em","figcaption","figure","footer","form","header","hgroup","h1","h2","h3","h4","h5","h6","hr","html","i","iframe","img","input","ins","kbd","label","legend","li","main","meter","nav","ol","output","p","pre","ruby","section","select","small","source","span","strong","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","tr","u","ul"].map(n=>({type:"type",label:n})),MZ=["@charset","@color-profile","@container","@counter-style","@font-face","@font-feature-values","@font-palette-values","@import","@keyframes","@layer","@media","@namespace","@page","@position-try","@property","@scope","@starting-style","@supports","@view-transition"].map(n=>({type:"keyword",label:n})),Ws=/^(\w[\w-]*|-\w[\w-]*|)$/,IZ=/^-(-[\w-]*)?$/;function RZ(n,e){var t;if((n.name=="("||n.type.isError)&&(n=n.parent||n),n.name!="ArgList")return!1;let i=(t=n.parent)===null||t===void 0?void 0:t.firstChild;return i?.name!="Callee"?!1:e.sliceString(i.from,i.to)=="var"}const v_=new FM,LZ=["Declaration"];function $Z(n){for(let e=n;;){if(e.type.isTop)return e;if(!(e=e.parent))return n}}function II(n,e,t){if(e.to-e.from>4096){let i=v_.get(e);if(i)return i;let s=[],r=new Set,o=e.cursor(ft.IncludeAnonymous);if(o.firstChild())do for(let a of II(n,o.node,t))r.has(a.label)||(r.add(a.label),s.push(a));while(o.nextSibling());return v_.set(e,s),s}else{let i=[],s=new Set;return e.cursor().iterate(r=>{var o;if(t(r)&&r.matchContext(LZ)&&((o=r.node.nextSibling)===null||o===void 0?void 0:o.name)==":"){let a=n.sliceString(r.from,r.to);s.has(a)||(s.add(a),i.push({label:a,type:"variable"}))}}),i}}const QZ=n=>e=>{let{state:t,pos:i}=e,s=ui(t).resolveInner(i,-1),r=s.type.isError&&s.from==s.to-1&&t.doc.sliceString(s.from,s.to)=="-";if(s.name=="PropertyName"||(r||s.name=="TagName")&&/^(Block|Styles)$/.test(s.resolve(s.to).name))return{from:s.from,options:_g(),validFor:Ws};if(s.name=="ValueName")return{from:s.from,options:b_,validFor:Ws};if(s.name=="PseudoClassName")return{from:s.from,options:y_,validFor:Ws};if(n(s)||(e.explicit||r)&&RZ(s,t.doc))return{from:n(s)||r?s.from:i,options:II(t.doc,$Z(s),n),validFor:IZ};if(s.name=="TagName"){for(let{parent:l}=s;l;l=l.parent)if(l.name=="Block")return{from:s.from,options:_g(),validFor:Ws};return{from:s.from,options:DZ,validFor:Ws}}if(s.name=="AtKeyword")return{from:s.from,options:MZ,validFor:Ws};if(!e.explicit)return null;let o=s.resolve(i),a=o.childBefore(i);return a&&a.name==":"&&o.name=="PseudoClassSelector"?{from:i,options:y_,validFor:Ws}:a&&a.name==":"&&o.name=="Declaration"||o.name=="ArgList"?{from:i,options:b_,validFor:Ws}:o.name=="Block"||o.name=="Styles"?{from:i,options:_g(),validFor:Ws}:null},BZ=QZ(n=>n.name=="VariableName"),If=el.define({name:"css",parser:PZ.configure({props:[_p.add({Declaration:yd()}),$u.add({"Block KeyframeList":XM})]}),languageData:{commentTokens:{block:{open:"/*",close:"*/"}},indentOnInput:/^\s*\}$/,wordChars:"-"}});function NZ(){return new uu(If,If.data.of({autocomplete:BZ}))}const FZ=316,VZ=317,S_=1,UZ=2,qZ=3,zZ=4,jZ=318,XZ=320,HZ=321,WZ=5,ZZ=6,YZ=0,oy=[9,10,11,12,13,32,133,160,5760,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8232,8233,8239,8287,12288],RI=125,GZ=59,ay=47,KZ=42,JZ=43,eY=45,tY=60,iY=44,nY=63,sY=46,rY=91,oY=new yI({start:!1,shift(n,e){return e==WZ||e==ZZ||e==XZ?n:e==HZ},strict:!1}),aY=new fn((n,e)=>{let{next:t}=n;(t==RI||t==-1||e.context)&&n.acceptToken(jZ)},{contextual:!0,fallback:!0}),lY=new fn((n,e)=>{let{next:t}=n,i;oy.indexOf(t)>-1||t==ay&&((i=n.peek(1))==ay||i==KZ)||t!=RI&&t!=GZ&&t!=-1&&!e.context&&n.acceptToken(FZ)},{contextual:!0}),hY=new fn((n,e)=>{n.next==rY&&!e.context&&n.acceptToken(VZ)},{contextual:!0}),uY=new fn((n,e)=>{let{next:t}=n;if(t==JZ||t==eY){if(n.advance(),t==n.next){n.advance();let i=!e.context&&e.canShift(S_);n.acceptToken(i?S_:UZ)}}else t==nY&&n.peek(1)==sY&&(n.advance(),n.advance(),(n.next<48||n.next>57)&&n.acceptToken(qZ))},{contextual:!0});function kg(n,e){return n>=65&&n<=90||n>=97&&n<=122||n==95||n>=192||!e&&n>=48&&n<=57}const cY=new fn((n,e)=>{if(n.next!=tY||!e.dialectEnabled(YZ)||(n.advance(),n.next==ay))return;let t=0;for(;oy.indexOf(n.next)>-1;)n.advance(),t++;if(kg(n.next,!0)){for(n.advance(),t++;kg(n.next,!1);)n.advance(),t++;for(;oy.indexOf(n.next)>-1;)n.advance(),t++;if(n.next==iY)return;for(let i=0;;i++){if(i==7){if(!kg(n.next,!0))return;break}if(n.next!="extends".charCodeAt(i))break;n.advance(),t++}}n.acceptToken(zZ,-t)}),dY=Ol({"get set async static":j.modifier,"for while do if else switch try catch finally return throw break continue default case defer":j.controlKeyword,"in of await yield void typeof delete instanceof as satisfies":j.operatorKeyword,"let var const using function class extends":j.definitionKeyword,"import export from":j.moduleKeyword,"with debugger new":j.keyword,TemplateString:j.special(j.string),super:j.atom,BooleanLiteral:j.bool,this:j.self,null:j.null,Star:j.modifier,VariableName:j.variableName,"CallExpression/VariableName TaggedTemplateExpression/VariableName":j.function(j.variableName),VariableDefinition:j.definition(j.variableName),Label:j.labelName,PropertyName:j.propertyName,PrivatePropertyName:j.special(j.propertyName),"CallExpression/MemberExpression/PropertyName":j.function(j.propertyName),"FunctionDeclaration/VariableDefinition":j.function(j.definition(j.variableName)),"ClassDeclaration/VariableDefinition":j.definition(j.className),"NewExpression/VariableName":j.className,PropertyDefinition:j.definition(j.propertyName),PrivatePropertyDefinition:j.definition(j.special(j.propertyName)),UpdateOp:j.updateOperator,"LineComment Hashbang":j.lineComment,BlockComment:j.blockComment,Number:j.number,String:j.string,Escape:j.escape,ArithOp:j.arithmeticOperator,LogicOp:j.logicOperator,BitOp:j.bitwiseOperator,CompareOp:j.compareOperator,RegExp:j.regexp,Equals:j.definitionOperator,Arrow:j.function(j.punctuation),": Spread":j.punctuation,"( )":j.paren,"[ ]":j.squareBracket,"{ }":j.brace,"InterpolationStart InterpolationEnd":j.special(j.brace),".":j.derefOperator,", ;":j.separator,"@":j.meta,TypeName:j.typeName,TypeDefinition:j.definition(j.typeName),"type enum interface implements namespace module declare":j.definitionKeyword,"abstract global Privacy readonly override":j.modifier,"is keyof unique infer asserts":j.operatorKeyword,JSXAttributeValue:j.attributeValue,JSXText:j.content,"JSXStartTag JSXStartCloseTag JSXSelfCloseEndTag JSXEndTag":j.angleBracket,"JSXIdentifier JSXNameSpacedName":j.tagName,"JSXAttribute/JSXIdentifier JSXAttribute/JSXNameSpacedName":j.attributeName,"JSXBuiltin/JSXIdentifier":j.standard(j.tagName)}),fY={__proto__:null,export:20,as:25,from:33,default:36,async:41,function:42,in:52,out:55,const:56,extends:60,this:64,true:72,false:72,null:84,void:88,typeof:92,super:108,new:142,delete:154,yield:163,await:167,class:172,public:235,private:235,protected:235,readonly:237,instanceof:256,satisfies:259,import:292,keyof:349,unique:353,infer:359,asserts:395,is:397,abstract:417,implements:419,type:421,let:424,var:426,using:429,interface:435,enum:439,namespace:445,module:447,declare:451,global:455,defer:471,for:476,of:485,while:488,with:492,do:496,if:500,else:502,switch:506,case:512,try:518,catch:522,finally:526,return:530,throw:534,break:538,continue:542,debugger:546},pY={__proto__:null,async:129,get:131,set:133,declare:195,public:197,private:197,protected:197,static:199,abstract:201,override:203,readonly:209,accessor:211,new:401},mY={__proto__:null,"<":193},gY=sl.deserialize({version:14,states:"$F|Q%TQlOOO%[QlOOO'_QpOOP(lO`OOO*zQ!0MxO'#CiO+RO#tO'#CjO+aO&jO'#CjO+oO#@ItO'#DaO.QQlO'#DgO.bQlO'#DrO%[QlO'#DzO0fQlO'#ESOOQ!0Lf'#E['#E[O1PQ`O'#EXOOQO'#Ep'#EpOOQO'#Il'#IlO1XQ`O'#GsO1dQ`O'#EoO1iQ`O'#EoO3hQ!0MxO'#JrO6[Q!0MxO'#JsO6uQ`O'#F]O6zQ,UO'#FtOOQ!0Lf'#Ff'#FfO7VO7dO'#FfO9XQMhO'#F|O9`Q`O'#F{OOQ!0Lf'#Js'#JsOOQ!0Lb'#Jr'#JrO9eQ`O'#GwOOQ['#K_'#K_O9pQ`O'#IYO9uQ!0LrO'#IZOOQ['#J`'#J`OOQ['#I_'#I_Q`QlOOQ`QlOOO9}Q!L^O'#DvO:UQlO'#EOO:]QlO'#EQO9kQ`O'#GsO:dQMhO'#CoO:rQ`O'#EnO:}Q`O'#EyO;hQMhO'#FeO;xQ`O'#GsOOQO'#K`'#K`O;}Q`O'#K`O<]Q`O'#G{O<]Q`O'#G|O<]Q`O'#HOO9kQ`O'#HRO=SQ`O'#HUO>kQ`O'#CeO>{Q`O'#HcO?TQ`O'#HiO?TQ`O'#HkO`QlO'#HmO?TQ`O'#HoO?TQ`O'#HrO?YQ`O'#HxO?_Q!0LsO'#IOO%[QlO'#IQO?jQ!0LsO'#ISO?uQ!0LsO'#IUO9uQ!0LrO'#IWO@QQ!0MxO'#CiOASQpO'#DlQOQ`OOO%[QlO'#EQOAjQ`O'#ETO:dQMhO'#EnOAuQ`O'#EnOBQQ!bO'#FeOOQ['#Cg'#CgOOQ!0Lb'#Dq'#DqOOQ!0Lb'#Jv'#JvO%[QlO'#JvOOQO'#Jy'#JyOOQO'#Ih'#IhOCQQpO'#EgOOQ!0Lb'#Ef'#EfOOQ!0Lb'#J}'#J}OC|Q!0MSO'#EgODWQpO'#EWOOQO'#Jx'#JxODlQpO'#JyOEyQpO'#EWODWQpO'#EgPFWO&2DjO'#CbPOOO)CD})CD}OOOO'#I`'#I`OFcO#tO,59UOOQ!0Lh,59U,59UOOOO'#Ia'#IaOFqO&jO,59UOGPQ!L^O'#DcOOOO'#Ic'#IcOGWO#@ItO,59{OOQ!0Lf,59{,59{OGfQlO'#IdOGyQ`O'#JtOIxQ!fO'#JtO+}QlO'#JtOJPQ`O,5:ROJgQ`O'#EpOJtQ`O'#KTOKPQ`O'#KSOKPQ`O'#KSOKXQ`O,5;^OK^Q`O'#KROOQ!0Ln,5:^,5:^OKeQlO,5:^OMcQ!0MxO,5:fONSQ`O,5:nONmQ!0LrO'#KQONtQ`O'#KPO9eQ`O'#KPO! YQ`O'#KPO! bQ`O,5;]O! gQ`O'#KPO!#lQ!fO'#JsOOQ!0Lh'#Ci'#CiO%[QlO'#ESO!$[Q!fO,5:sOOQS'#Jz'#JzOOQO-E<j-E<jO9kQ`O,5=_O!$rQ`O,5=_O!$wQlO,5;ZO!&zQMhO'#EkO!(eQ`O,5;ZO!(jQlO'#DyO!(tQpO,5;dO!(|QpO,5;dO%[QlO,5;dOOQ['#FT'#FTOOQ['#FV'#FVO%[QlO,5;eO%[QlO,5;eO%[QlO,5;eO%[QlO,5;eO%[QlO,5;eO%[QlO,5;eO%[QlO,5;eO%[QlO,5;eO%[QlO,5;eO%[QlO,5;eOOQ['#FZ'#FZO!)[QlO,5;tOOQ!0Lf,5;y,5;yOOQ!0Lf,5;z,5;zOOQ!0Lf,5;|,5;|O%[QlO'#IpO!+_Q!0LrO,5<iO%[QlO,5;eO!&zQMhO,5;eO!+|QMhO,5;eO!-nQMhO'#E^O%[QlO,5;wOOQ!0Lf,5;{,5;{O!-uQ,UO'#FjO!.rQ,UO'#KXO!.^Q,UO'#KXO!.yQ,UO'#KXOOQO'#KX'#KXO!/_Q,UO,5<SOOOW,5<`,5<`O!/pQlO'#FvOOOW'#Io'#IoO7VO7dO,5<QO!/wQ,UO'#FxOOQ!0Lf,5<Q,5<QO!0hQ$IUO'#CyOOQ!0Lh'#C}'#C}O!0{O#@ItO'#DRO!1iQMjO,5<eO!1pQ`O,5<hO!3YQ(CWO'#GXO!3jQ`O'#GYO!3oQ`O'#GYO!5_Q(CWO'#G^O!6dQpO'#GbOOQO'#Gn'#GnO!,TQMhO'#GmOOQO'#Gp'#GpO!,TQMhO'#GoO!7VQ$IUO'#JlOOQ!0Lh'#Jl'#JlO!7aQ`O'#JkO!7oQ`O'#JjO!7wQ`O'#CuOOQ!0Lh'#C{'#C{O!8YQ`O'#C}OOQ!0Lh'#DV'#DVOOQ!0Lh'#DX'#DXO!8_Q`O,5<eO1SQ`O'#DZO!,TQMhO'#GPO!,TQMhO'#GRO!8gQ`O'#GTO!8lQ`O'#GUO!3oQ`O'#G[O!,TQMhO'#GaO<]Q`O'#JkO!8qQ`O'#EqO!9`Q`O,5<gOOQ!0Lb'#Cr'#CrO!9hQ`O'#ErO!:bQpO'#EsOOQ!0Lb'#KR'#KRO!:iQ!0LrO'#KaO9uQ!0LrO,5=cO`QlO,5>tOOQ['#Jh'#JhOOQ[,5>u,5>uOOQ[-E<]-E<]O!<hQ!0MxO,5:bO!:]QpO,5:`O!?RQ!0MxO,5:jO%[QlO,5:jO!AiQ!0MxO,5:lOOQO,5@z,5@zO!BYQMhO,5=_O!BhQ!0LrO'#JiO9`Q`O'#JiO!ByQ!0LrO,59ZO!CUQpO,59ZO!C^QMhO,59ZO:dQMhO,59ZO!CiQ`O,5;ZO!CqQ`O'#HbO!DVQ`O'#KdO%[QlO,5;}O!:]QpO,5<PO!D_Q`O,5=zO!DdQ`O,5=zO!DiQ`O,5=zO!DwQ`O,5=zO9uQ!0LrO,5=zO<]Q`O,5=jOOQO'#Cy'#CyO!EOQpO,5=gO!EWQMhO,5=hO!EcQ`O,5=jO!EhQ!bO,5=mO!EpQ`O'#K`O?YQ`O'#HWO9kQ`O'#HYO!EuQ`O'#HYO:dQMhO'#H[O!EzQ`O'#H[OOQ[,5=p,5=pO!FPQ`O'#H]O!FbQ`O'#CoO!FgQ`O,59PO!FqQ`O,59PO!HvQlO,59POOQ[,59P,59PO!IWQ!0LrO,59PO%[QlO,59PO!KcQlO'#HeOOQ['#Hf'#HfOOQ['#Hg'#HgO`QlO,5=}O!KyQ`O,5=}O`QlO,5>TO`QlO,5>VO!LOQ`O,5>XO`QlO,5>ZO!LTQ`O,5>^O!LYQlO,5>dOOQ[,5>j,5>jO%[QlO,5>jO9uQ!0LrO,5>lOOQ[,5>n,5>nO#!dQ`O,5>nOOQ[,5>p,5>pO#!dQ`O,5>pOOQ[,5>r,5>rO##QQpO'#D_O%[QlO'#JvO##sQpO'#JvO##}QpO'#DmO#$`QpO'#DmO#&qQlO'#DmO#&xQ`O'#JuO#'QQ`O,5:WO#'VQ`O'#EtO#'eQ`O'#KUO#'mQ`O,5;_O#'rQpO'#DmO#(PQpO'#EVOOQ!0Lf,5:o,5:oO%[QlO,5:oO#(WQ`O,5:oO?YQ`O,5;YO!CUQpO,5;YO!C^QMhO,5;YO:dQMhO,5;YO#(`Q`O,5@bO#(eQ07dO,5:sOOQO-E<f-E<fO#)kQ!0MSO,5;RODWQpO,5:rO#)uQpO,5:rODWQpO,5;RO!ByQ!0LrO,5:rOOQ!0Lb'#Ej'#EjOOQO,5;R,5;RO%[QlO,5;RO#*SQ!0LrO,5;RO#*_Q!0LrO,5;RO!CUQpO,5:rOOQO,5;X,5;XO#*mQ!0LrO,5;RPOOO'#I^'#I^P#+RO&2DjO,58|POOO,58|,58|OOOO-E<^-E<^OOQ!0Lh1G.p1G.pOOOO-E<_-E<_OOOO,59},59}O#+^Q!bO,59}OOOO-E<a-E<aOOQ!0Lf1G/g1G/gO#+cQ!fO,5?OO+}QlO,5?OOOQO,5?U,5?UO#+mQlO'#IdOOQO-E<b-E<bO#+zQ`O,5@`O#,SQ!fO,5@`O#,ZQ`O,5@nOOQ!0Lf1G/m1G/mO%[QlO,5@oO#,cQ`O'#IjOOQO-E<h-E<hO#,ZQ`O,5@nOOQ!0Lb1G0x1G0xOOQ!0Ln1G/x1G/xOOQ!0Ln1G0Y1G0YO%[QlO,5@lO#,wQ!0LrO,5@lO#-YQ!0LrO,5@lO#-aQ`O,5@kO9eQ`O,5@kO#-iQ`O,5@kO#-wQ`O'#ImO#-aQ`O,5@kOOQ!0Lb1G0w1G0wO!(tQpO,5:uO!)PQpO,5:uOOQS,5:w,5:wO#.iQdO,5:wO#.qQMhO1G2yO9kQ`O1G2yOOQ!0Lf1G0u1G0uO#/PQ!0MxO1G0uO#0UQ!0MvO,5;VOOQ!0Lh'#GW'#GWO#0rQ!0MzO'#JlO!$wQlO1G0uO#2}Q!fO'#JwO%[QlO'#JwO#3XQ`O,5:eOOQ!0Lh'#D_'#D_OOQ!0Lf1G1O1G1OO%[QlO1G1OOOQ!0Lf1G1f1G1fO#3^Q`O1G1OO#5rQ!0MxO1G1PO#5yQ!0MxO1G1PO#8aQ!0MxO1G1PO#8hQ!0MxO1G1PO#;OQ!0MxO1G1PO#=fQ!0MxO1G1PO#=mQ!0MxO1G1PO#=tQ!0MxO1G1PO#@[Q!0MxO1G1PO#@cQ!0MxO1G1PO#BpQ?MtO'#CiO#DkQ?MtO1G1`O#DrQ?MtO'#JsO#EVQ!0MxO,5?[OOQ!0Lb-E<n-E<nO#GdQ!0MxO1G1PO#HaQ!0MzO1G1POOQ!0Lf1G1P1G1PO#IdQMjO'#J|O#InQ`O,5:xO#IsQ!0MxO1G1cO#JgQ,UO,5<WO#JoQ,UO,5<XO#JwQ,UO'#FoO#K`Q`O'#FnOOQO'#KY'#KYOOQO'#In'#InO#KeQ,UO1G1nOOQ!0Lf1G1n1G1nOOOW1G1y1G1yO#KvQ?MtO'#JrO#LQQ`O,5<bO!)[QlO,5<bOOOW-E<m-E<mOOQ!0Lf1G1l1G1lO#LVQpO'#KXOOQ!0Lf,5<d,5<dO#L_QpO,5<dO#LdQMhO'#DTOOOO'#Ib'#IbO#LkO#@ItO,59mOOQ!0Lh,59m,59mO%[QlO1G2PO!8lQ`O'#IrO#LvQ`O,5<zOOQ!0Lh,5<w,5<wO!,TQMhO'#IuO#MdQMjO,5=XO!,TQMhO'#IwO#NVQMjO,5=ZO!&zQMhO,5=]OOQO1G2S1G2SO#NaQ!dO'#CrO#NtQ(CWO'#ErO$ |QpO'#GbO$!dQ!dO,5<sO$!kQ`O'#K[O9eQ`O'#K[O$!yQ`O,5<uO$#aQ!dO'#C{O!,TQMhO,5<tO$#kQ`O'#GZO$$PQ`O,5<tO$$UQ!dO'#GWO$$cQ!dO'#K]O$$mQ`O'#K]O!&zQMhO'#K]O$$rQ`O,5<xO$$wQlO'#JvO$%RQpO'#GcO#$`QpO'#GcO$%dQ`O'#GgO!3oQ`O'#GkO$%iQ!0LrO'#ItO$%tQpO,5<|OOQ!0Lp,5<|,5<|O$%{QpO'#GcO$&YQpO'#GdO$&kQpO'#GdO$&pQMjO,5=XO$'QQMjO,5=ZOOQ!0Lh,5=^,5=^O!,TQMhO,5@VO!,TQMhO,5@VO$'bQ`O'#IyO$'vQ`O,5@UO$(OQ`O,59aOOQ!0Lh,59i,59iO$(TQ`O,5@VO$)TQ$IYO,59uOOQ!0Lh'#Jp'#JpO$)vQMjO,5<kO$*iQMjO,5<mO@zQ`O,5<oOOQ!0Lh,5<p,5<pO$*sQ`O,5<vO$*xQMjO,5<{O$+YQ`O'#KPO!$wQlO1G2RO$+_Q`O1G2RO9eQ`O'#KSO9eQ`O'#EtO%[QlO'#EtO9eQ`O'#I{O$+dQ!0LrO,5@{OOQ[1G2}1G2}OOQ[1G4`1G4`OOQ!0Lf1G/|1G/|OOQ!0Lf1G/z1G/zO$-fQ!0MxO1G0UOOQ[1G2y1G2yO!&zQMhO1G2yO%[QlO1G2yO#.tQ`O1G2yO$/jQMhO'#EkOOQ!0Lb,5@T,5@TO$/wQ!0LrO,5@TOOQ[1G.u1G.uO!ByQ!0LrO1G.uO!CUQpO1G.uO!C^QMhO1G.uO$0YQ`O1G0uO$0_Q`O'#CiO$0jQ`O'#KeO$0rQ`O,5=|O$0wQ`O'#KeO$0|Q`O'#KeO$1[Q`O'#JRO$1jQ`O,5AOO$1rQ!fO1G1iOOQ!0Lf1G1k1G1kO9kQ`O1G3fO@zQ`O1G3fO$1yQ`O1G3fO$2OQ`O1G3fO!DiQ`O1G3fO9uQ!0LrO1G3fOOQ[1G3f1G3fO!EcQ`O1G3UO!&zQMhO1G3RO$2TQ`O1G3ROOQ[1G3S1G3SO!&zQMhO1G3SO$2YQ`O1G3SO$2bQpO'#HQOOQ[1G3U1G3UO!6_QpO'#I}O!EhQ!bO1G3XOOQ[1G3X1G3XOOQ[,5=r,5=rO$2jQMhO,5=tO9kQ`O,5=tO$%dQ`O,5=vO9`Q`O,5=vO!CUQpO,5=vO!C^QMhO,5=vO:dQMhO,5=vO$2xQ`O'#KcO$3TQ`O,5=wOOQ[1G.k1G.kO$3YQ!0LrO1G.kO@zQ`O1G.kO$3eQ`O1G.kO9uQ!0LrO1G.kO$5mQ!fO,5AQO$5zQ`O,5AQO9eQ`O,5AQO$6VQlO,5>PO$6^Q`O,5>POOQ[1G3i1G3iO`QlO1G3iOOQ[1G3o1G3oOOQ[1G3q1G3qO?TQ`O1G3sO$6cQlO1G3uO$:gQlO'#HtOOQ[1G3x1G3xO$:tQ`O'#HzO?YQ`O'#H|OOQ[1G4O1G4OO$:|QlO1G4OO9uQ!0LrO1G4UOOQ[1G4W1G4WOOQ!0Lb'#G_'#G_O9uQ!0LrO1G4YO9uQ!0LrO1G4[O$?TQ`O,5@bO!)[QlO,5;`O9eQ`O,5;`O?YQ`O,5:XO!)[QlO,5:XO!CUQpO,5:XO$?YQ?MtO,5:XOOQO,5;`,5;`O$?dQpO'#IeO$?zQ`O,5@aOOQ!0Lf1G/r1G/rO$@SQpO'#IkO$@^Q`O,5@pOOQ!0Lb1G0y1G0yO#$`QpO,5:XOOQO'#Ig'#IgO$@fQpO,5:qOOQ!0Ln,5:q,5:qO#(ZQ`O1G0ZOOQ!0Lf1G0Z1G0ZO%[QlO1G0ZOOQ!0Lf1G0t1G0tO?YQ`O1G0tO!CUQpO1G0tO!C^QMhO1G0tOOQ!0Lb1G5|1G5|O!ByQ!0LrO1G0^OOQO1G0m1G0mO%[QlO1G0mO$@mQ!0LrO1G0mO$@xQ!0LrO1G0mO!CUQpO1G0^ODWQpO1G0^O$AWQ!0LrO1G0mOOQO1G0^1G0^O$AlQ!0MxO1G0mPOOO-E<[-E<[POOO1G.h1G.hOOOO1G/i1G/iO$AvQ!bO,5<iO$BOQ!fO1G4jOOQO1G4p1G4pO%[QlO,5?OO$BYQ`O1G5zO$BbQ`O1G6YO$BjQ!fO1G6ZO9eQ`O,5?UO$BtQ!0MxO1G6WO%[QlO1G6WO$CUQ!0LrO1G6WO$CgQ`O1G6VO$CgQ`O1G6VO9eQ`O1G6VO$CoQ`O,5?XO9eQ`O,5?XOOQO,5?X,5?XO$DTQ`O,5?XO$+YQ`O,5?XOOQO-E<k-E<kOOQS1G0a1G0aOOQS1G0c1G0cO#.lQ`O1G0cOOQ[7+(e7+(eO!&zQMhO7+(eO%[QlO7+(eO$DcQ`O7+(eO$DnQMhO7+(eO$D|Q!0MzO,5=XO$GXQ!0MzO,5=ZO$IdQ!0MzO,5=XO$KuQ!0MzO,5=ZO$NWQ!0MzO,59uO%!]Q!0MzO,5<kO%$hQ!0MzO,5<mO%&sQ!0MzO,5<{OOQ!0Lf7+&a7+&aO%)UQ!0MxO7+&aO%)xQlO'#IfO%*VQ`O,5@cO%*_Q!fO,5@cOOQ!0Lf1G0P1G0PO%*iQ`O7+&jOOQ!0Lf7+&j7+&jO%*nQ?MtO,5:fO%[QlO7+&zO%*xQ?MtO,5:bO%+VQ?MtO,5:jO%+aQ?MtO,5:lO%+kQMhO'#IiO%+uQ`O,5@hOOQ!0Lh1G0d1G0dOOQO1G1r1G1rOOQO1G1s1G1sO%+}Q!jO,5<ZO!)[QlO,5<YOOQO-E<l-E<lOOQ!0Lf7+'Y7+'YOOOW7+'e7+'eOOOW1G1|1G1|O%,YQ`O1G1|OOQ!0Lf1G2O1G2OOOOO,59o,59oO%,_Q!dO,59oOOOO-E<`-E<`OOQ!0Lh1G/X1G/XO%,fQ!0MxO7+'kOOQ!0Lh,5?^,5?^O%-YQMhO1G2fP%-aQ`O'#IrPOQ!0Lh-E<p-E<pO%-}QMjO,5?aOOQ!0Lh-E<s-E<sO%.pQMjO,5?cOOQ!0Lh-E<u-E<uO%.zQ!dO1G2wO%/RQ!dO'#CrO%/iQMhO'#KSO$$wQlO'#JvOOQ!0Lh1G2_1G2_O%/sQ`O'#IqO%0[Q`O,5@vO%0[Q`O,5@vO%0dQ`O,5@vO%0oQ`O,5@vOOQO1G2a1G2aO%0}QMjO1G2`O$+YQ`O'#K[O!,TQMhO1G2`O%1_Q(CWO'#IsO%1lQ`O,5@wO!&zQMhO,5@wO%1tQ!dO,5@wOOQ!0Lh1G2d1G2dO%4UQ!fO'#CiO%4`Q`O,5=POOQ!0Lb,5<},5<}O%4hQpO,5<}OOQ!0Lb,5=O,5=OOCwQ`O,5<}O%4sQpO,5<}OOQ!0Lb,5=R,5=RO$+YQ`O,5=VOOQO,5?`,5?`OOQO-E<r-E<rOOQ!0Lp1G2h1G2hO#$`QpO,5<}O$$wQlO,5=PO%5RQ`O,5=OO%5^QpO,5=OO!,TQMhO'#IuO%6WQMjO1G2sO!,TQMhO'#IwO%6yQMjO1G2uO%7TQMjO1G5qO%7_QMjO1G5qOOQO,5?e,5?eOOQO-E<w-E<wOOQO1G.{1G.{O!,TQMhO1G5qO!,TQMhO1G5qO!:]QpO,59wO%[QlO,59wOOQ!0Lh,5<j,5<jO%7lQ`O1G2ZO!,TQMhO1G2bO%7qQ!0MxO7+'mOOQ!0Lf7+'m7+'mO!$wQlO7+'mO%8eQ`O,5;`OOQ!0Lb,5?g,5?gOOQ!0Lb-E<y-E<yO%8jQ!dO'#K^O#(ZQ`O7+(eO4UQ!fO7+(eO$DfQ`O7+(eO%8tQ!0MvO'#CiO%9XQ!0MvO,5=SO%9lQ`O,5=SO%9tQ`O,5=SOOQ!0Lb1G5o1G5oOOQ[7+$a7+$aO!ByQ!0LrO7+$aO!CUQpO7+$aO!$wQlO7+&aO%9yQ`O'#JQO%:bQ`O,5APOOQO1G3h1G3hO9kQ`O,5APO%:bQ`O,5APO%:jQ`O,5APOOQO,5?m,5?mOOQO-E=P-E=POOQ!0Lf7+'T7+'TO%:oQ`O7+)QO9uQ!0LrO7+)QO9kQ`O7+)QO@zQ`O7+)QO%:tQ`O7+)QOOQ[7+)Q7+)QOOQ[7+(p7+(pO%:yQ!0MvO7+(mO!&zQMhO7+(mO!E^Q`O7+(nOOQ[7+(n7+(nO!&zQMhO7+(nO%;TQ`O'#KbO%;`Q`O,5=lOOQO,5?i,5?iOOQO-E<{-E<{OOQ[7+(s7+(sO%<rQpO'#HZOOQ[1G3`1G3`O!&zQMhO1G3`O%[QlO1G3`O%<yQ`O1G3`O%=UQMhO1G3`O9uQ!0LrO1G3bO$%dQ`O1G3bO9`Q`O1G3bO!CUQpO1G3bO!C^QMhO1G3bO%=dQ`O'#JPO%=xQ`O,5@}O%>QQpO,5@}OOQ!0Lb1G3c1G3cOOQ[7+$V7+$VO@zQ`O7+$VO9uQ!0LrO7+$VO%>]Q`O7+$VO%[QlO1G6lO%[QlO1G6mO%>bQ!0LrO1G6lO%>lQlO1G3kO%>sQ`O1G3kO%>xQlO1G3kOOQ[7+)T7+)TO9uQ!0LrO7+)_O`QlO7+)aOOQ['#Kh'#KhOOQ['#JS'#JSO%?PQlO,5>`OOQ[,5>`,5>`O%[QlO'#HuO%?^Q`O'#HwOOQ[,5>f,5>fO9eQ`O,5>fOOQ[,5>h,5>hOOQ[7+)j7+)jOOQ[7+)p7+)pOOQ[7+)t7+)tOOQ[7+)v7+)vO%?cQpO1G5|O%?}Q?MtO1G0zO%@XQ`O1G0zOOQO1G/s1G/sO%@dQ?MtO1G/sO?YQ`O1G/sO!)[QlO'#DmOOQO,5?P,5?POOQO-E<c-E<cOOQO,5?V,5?VOOQO-E<i-E<iO!CUQpO1G/sOOQO-E<e-E<eOOQ!0Ln1G0]1G0]OOQ!0Lf7+%u7+%uO#(ZQ`O7+%uOOQ!0Lf7+&`7+&`O?YQ`O7+&`O!CUQpO7+&`OOQO7+%x7+%xO$AlQ!0MxO7+&XOOQO7+&X7+&XO%[QlO7+&XO%@nQ!0LrO7+&XO!ByQ!0LrO7+%xO!CUQpO7+%xO%@yQ!0LrO7+&XO%AXQ!0MxO7++rO%[QlO7++rO%AiQ`O7++qO%AiQ`O7++qOOQO1G4s1G4sO9eQ`O1G4sO%AqQ`O1G4sOOQS7+%}7+%}O#(ZQ`O<<LPO4UQ!fO<<LPO%BPQ`O<<LPOOQ[<<LP<<LPO!&zQMhO<<LPO%[QlO<<LPO%BXQ`O<<LPO%BdQ!0MzO,5?aO%DoQ!0MzO,5?cO%FzQ!0MzO1G2`O%I]Q!0MzO1G2sO%KhQ!0MzO1G2uO%MsQ!fO,5?QO%[QlO,5?QOOQO-E<d-E<dO%M}Q`O1G5}OOQ!0Lf<<JU<<JUO%NVQ?MtO1G0uO&!^Q?MtO1G1PO&!eQ?MtO1G1PO&$fQ?MtO1G1PO&$mQ?MtO1G1PO&&nQ?MtO1G1PO&(oQ?MtO1G1PO&(vQ?MtO1G1PO&(}Q?MtO1G1PO&+OQ?MtO1G1PO&+VQ?MtO1G1PO&+^Q!0MxO<<JfO&-UQ?MtO1G1PO&.RQ?MvO1G1PO&/UQ?MvO'#JlO&1[Q?MtO1G1cO&1iQ?MtO1G0UO&1sQMjO,5?TOOQO-E<g-E<gO!)[QlO'#FqOOQO'#KZ'#KZOOQO1G1u1G1uO&1}Q`O1G1tO&2SQ?MtO,5?[OOOW7+'h7+'hOOOO1G/Z1G/ZO&2^Q!dO1G4xOOQ!0Lh7+(Q7+(QP!&zQMhO,5?^O!,TQMhO7+(cO&2eQ`O,5?]O9eQ`O,5?]O$+YQ`O,5?]OOQO-E<o-E<oO&2sQ`O1G6bO&2sQ`O1G6bO&2{Q`O1G6bO&3WQMjO7+'zO&3hQ!dO,5?_O&3rQ`O,5?_O!&zQMhO,5?_OOQO-E<q-E<qO&3wQ!dO1G6cO&4RQ`O1G6cO&4ZQ`O1G2kO!&zQMhO1G2kOOQ!0Lb1G2i1G2iOOQ!0Lb1G2j1G2jO%4hQpO1G2iO!CUQpO1G2iOCwQ`O1G2iOOQ!0Lb1G2q1G2qO&4`QpO1G2iO&4nQ`O1G2kO$+YQ`O1G2jOCwQ`O1G2jO$$wQlO1G2kO&4vQ`O1G2jO&5jQMjO,5?aOOQ!0Lh-E<t-E<tO&6]QMjO,5?cOOQ!0Lh-E<v-E<vO!,TQMhO7++]O&6gQMjO7++]O&6qQMjO7++]OOQ!0Lh1G/c1G/cO&7OQ`O1G/cOOQ!0Lh7+'u7+'uO&7TQMjO7+'|O&7eQ!0MxO<<KXOOQ!0Lf<<KX<<KXO&8XQ`O1G0zO!&zQMhO'#IzO&8^Q`O,5@xO&:`Q!fO<<LPO!&zQMhO1G2nO&:gQ!0LrO1G2nOOQ[<<G{<<G{O!ByQ!0LrO<<G{O&:xQ!0MxO<<I{OOQ!0Lf<<I{<<I{OOQO,5?l,5?lO&;lQ`O,5?lO&;qQ`O,5?lOOQO-E=O-E=OO&<PQ`O1G6kO&<PQ`O1G6kO9kQ`O1G6kO@zQ`O<<LlOOQ[<<Ll<<LlO&<XQ`O<<LlO9uQ!0LrO<<LlO9kQ`O<<LlOOQ[<<LX<<LXO%:yQ!0MvO<<LXOOQ[<<LY<<LYO!E^Q`O<<LYO&<^QpO'#I|O&<iQ`O,5@|O!)[QlO,5@|OOQ[1G3W1G3WOOQO'#JO'#JOO9uQ!0LrO'#JOO&<qQpO,5=uOOQ[,5=u,5=uO&<xQpO'#EgO&=PQpO'#GeO&=UQ`O7+(zO&=ZQ`O7+(zOOQ[7+(z7+(zO!&zQMhO7+(zO%[QlO7+(zO&=cQ`O7+(zOOQ[7+(|7+(|O9uQ!0LrO7+(|O$%dQ`O7+(|O9`Q`O7+(|O!CUQpO7+(|O&=nQ`O,5?kOOQO-E<}-E<}OOQO'#H^'#H^O&=yQ`O1G6iO9uQ!0LrO<<GqOOQ[<<Gq<<GqO@zQ`O<<GqO&>RQ`O7+,WO&>WQ`O7+,XO%[QlO7+,WO%[QlO7+,XOOQ[7+)V7+)VO&>]Q`O7+)VO&>bQlO7+)VO&>iQ`O7+)VOOQ[<<Ly<<LyOOQ[<<L{<<L{OOQ[-E=Q-E=QOOQ[1G3z1G3zO&>nQ`O,5>aOOQ[,5>c,5>cO&>sQ`O1G4QO9eQ`O7+&fO!)[QlO7+&fOOQO7+%_7+%_O&>xQ?MtO1G6ZO?YQ`O7+%_OOQ!0Lf<<Ia<<IaOOQ!0Lf<<Iz<<IzO?YQ`O<<IzOOQO<<Is<<IsO$AlQ!0MxO<<IsO%[QlO<<IsOOQO<<Id<<IdO!ByQ!0LrO<<IdO&?SQ!0LrO<<IsO&?_Q!0MxO<= ^O&?oQ`O<= ]OOQO7+*_7+*_O9eQ`O7+*_OOQ[ANAkANAkO&?wQ!fOANAkO!&zQMhOANAkO#(ZQ`OANAkO4UQ!fOANAkO&@OQ`OANAkO%[QlOANAkO&@WQ!0MzO7+'zO&BiQ!0MzO,5?aO&DtQ!0MzO,5?cO&GPQ!0MzO7+'|O&IbQ!fO1G4lO&IlQ?MtO7+&aO&KpQ?MvO,5=XO&MwQ?MvO,5=ZO&NXQ?MvO,5=XO&NiQ?MvO,5=ZO&NyQ?MvO,59uO'#PQ?MvO,5<kO'%SQ?MvO,5<mO''hQ?MvO,5<{O')^Q?MtO7+'kO')kQ?MtO7+'mO')xQ`O,5<]OOQO7+'`7+'`OOQ!0Lh7+*d7+*dO')}QMjO<<K}OOQO1G4w1G4wO'*UQ`O1G4wO'*aQ`O1G4wO'*oQ`O7++|O'*oQ`O7++|O!&zQMhO1G4yO'*wQ!dO1G4yO'+RQ`O7++}O'+ZQ`O7+(VO'+fQ!dO7+(VOOQ!0Lb7+(T7+(TOOQ!0Lb7+(U7+(UO!CUQpO7+(TOCwQ`O7+(TO'+pQ`O7+(VO!&zQMhO7+(VO$+YQ`O7+(UO'+uQ`O7+(VOCwQ`O7+(UO'+}QMjO<<NwO!,TQMhO<<NwOOQ!0Lh7+$}7+$}O',XQ!dO,5?fOOQO-E<x-E<xO',cQ!0MvO7+(YO!&zQMhO7+(YOOQ[AN=gAN=gO9kQ`O1G5WOOQO1G5W1G5WO',sQ`O1G5WO',xQ`O7+,VO',xQ`O7+,VO9uQ!0LrOANBWO@zQ`OANBWOOQ[ANBWANBWO'-QQ`OANBWOOQ[ANAsANAsOOQ[ANAtANAtO'-VQ`O,5?hOOQO-E<z-E<zO'-bQ?MtO1G6hOOQO,5?j,5?jOOQO-E<|-E<|OOQ[1G3a1G3aO'-lQ`O,5=POOQ[<<Lf<<LfO!&zQMhO<<LfO&=UQ`O<<LfO'-qQ`O<<LfO%[QlO<<LfOOQ[<<Lh<<LhO9uQ!0LrO<<LhO$%dQ`O<<LhO9`Q`O<<LhO'-yQpO1G5VO'.UQ`O7+,TOOQ[AN=]AN=]O9uQ!0LrOAN=]OOQ[<= r<= rOOQ[<= s<= sO'.^Q`O<= rO'.cQ`O<= sOOQ[<<Lq<<LqO'.hQ`O<<LqO'.mQlO<<LqOOQ[1G3{1G3{O?YQ`O7+)lO'.tQ`O<<JQO'/PQ?MtO<<JQOOQO<<Hy<<HyOOQ!0LfAN?fAN?fOOQOAN?_AN?_O$AlQ!0MxOAN?_OOQOAN?OAN?OO%[QlOAN?_OOQO<<My<<MyOOQ[G27VG27VO!&zQMhOG27VO#(ZQ`OG27VO'/ZQ!fOG27VO4UQ!fOG27VO'/bQ`OG27VO'/jQ?MtO<<JfO'/wQ?MvO1G2`O'1mQ?MvO,5?aO'3pQ?MvO,5?cO'5sQ?MvO1G2sO'7vQ?MvO1G2uO'9yQ?MtO<<KXO':WQ?MtO<<I{OOQO1G1w1G1wO!,TQMhOANAiOOQO7+*c7+*cO':eQ`O7+*cO':pQ`O<= hO':xQ!dO7+*eOOQ!0Lb<<Kq<<KqO$+YQ`O<<KqOCwQ`O<<KqO';SQ`O<<KqO!&zQMhO<<KqOOQ!0Lb<<Ko<<KoO!CUQpO<<KoO';_Q!dO<<KqOOQ!0Lb<<Kp<<KpO';iQ`O<<KqO!&zQMhO<<KqO$+YQ`O<<KpO';nQMjOANDcO';xQ!0MvO<<KtOOQO7+*r7+*rO9kQ`O7+*rO'<YQ`O<= qOOQ[G27rG27rO9uQ!0LrOG27rO@zQ`OG27rO!)[QlO1G5SO'<bQ`O7+,SO'<jQ`O1G2kO&=UQ`OANBQOOQ[ANBQANBQO!&zQMhOANBQO'<oQ`OANBQOOQ[ANBSANBSO9uQ!0LrOANBSO$%dQ`OANBSOOQO'#H_'#H_OOQO7+*q7+*qOOQ[G22wG22wOOQ[ANE^ANE^OOQ[ANE_ANE_OOQ[ANB]ANB]O'<wQ`OANB]OOQ[<<MW<<MWO!)[QlOAN?lOOQOG24yG24yO$AlQ!0MxOG24yO#(ZQ`OLD,qOOQ[LD,qLD,qO!&zQMhOLD,qO'<|Q!fOLD,qO'=TQ?MvO7+'zO'>yQ?MvO,5?aO'@|Q?MvO,5?cO'CPQ?MvO7+'|O'DuQMjOG27TOOQO<<M}<<M}OOQ!0LbANA]ANA]O$+YQ`OANA]OCwQ`OANA]O'EVQ!dOANA]OOQ!0LbANAZANAZO'E^Q`OANA]O!&zQMhOANA]O'EiQ!dOANA]OOQ!0LbANA[ANA[OOQO<<N^<<N^OOQ[LD-^LD-^O9uQ!0LrOLD-^O'EsQ?MtO7+*nOOQO'#Gf'#GfOOQ[G27lG27lO&=UQ`OG27lO!&zQMhOG27lOOQ[G27nG27nO9uQ!0LrOG27nOOQ[G27wG27wO'E}Q?MtOG25WOOQOLD*eLD*eOOQ[!$(!]!$(!]O#(ZQ`O!$(!]O!&zQMhO!$(!]O'FXQ!0MzOG27TOOQ!0LbG26wG26wO$+YQ`OG26wO'HjQ`OG26wOCwQ`OG26wO'HuQ!dOG26wO!&zQMhOG26wOOQ[!$(!x!$(!xOOQ[LD-WLD-WO&=UQ`OLD-WOOQ[LD-YLD-YOOQ[!)9Ew!)9EwO#(ZQ`O!)9EwOOQ!0LbLD,cLD,cO$+YQ`OLD,cOCwQ`OLD,cO'H|Q`OLD,cO'IXQ!dOLD,cOOQ[!$(!r!$(!rOOQ[!.K;c!.K;cO'I`Q?MvOG27TOOQ!0Lb!$( }!$( }O$+YQ`O!$( }OCwQ`O!$( }O'KUQ`O!$( }OOQ!0Lb!)9Ei!)9EiO$+YQ`O!)9EiOCwQ`O!)9EiOOQ!0Lb!.K;T!.K;TO$+YQ`O!.K;TOOQ!0Lb!4/0o!4/0oO!)[QlO'#DzO1PQ`O'#EXO'KaQ!fO'#JrO'KhQ!L^O'#DvO'KoQlO'#EOO'KvQ!fO'#CiO'N^Q!fO'#CiO!)[QlO'#EQO'NnQlO,5;ZO!)[QlO,5;eO!)[QlO,5;eO!)[QlO,5;eO!)[QlO,5;eO!)[QlO,5;eO!)[QlO,5;eO!)[QlO,5;eO!)[QlO,5;eO!)[QlO,5;eO!)[QlO,5;eO!)[QlO'#IpO(!qQ`O,5<iO!)[QlO,5;eO(!yQMhO,5;eO($dQMhO,5;eO!)[QlO,5;wO!&zQMhO'#GmO(!yQMhO'#GmO!&zQMhO'#GoO(!yQMhO'#GoO1SQ`O'#DZO1SQ`O'#DZO!&zQMhO'#GPO(!yQMhO'#GPO!&zQMhO'#GRO(!yQMhO'#GRO!&zQMhO'#GaO(!yQMhO'#GaO!)[QlO,5:jO($kQpO'#D_O($uQpO'#JvO!)[QlO,5@oO'NnQlO1G0uO(%PQ?MtO'#CiO!)[QlO1G2PO!&zQMhO'#IuO(!yQMhO'#IuO!&zQMhO'#IwO(!yQMhO'#IwO(%ZQ!dO'#CrO!&zQMhO,5<tO(!yQMhO,5<tO'NnQlO1G2RO!)[QlO7+&zO!&zQMhO1G2`O(!yQMhO1G2`O!&zQMhO'#IuO(!yQMhO'#IuO!&zQMhO'#IwO(!yQMhO'#IwO!&zQMhO1G2bO(!yQMhO1G2bO'NnQlO7+'mO'NnQlO7+&aO!&zQMhOANAiO(!yQMhOANAiO(%nQ`O'#EoO(%sQ`O'#EoO(%{Q`O'#F]O(&QQ`O'#EyO(&VQ`O'#KTO(&bQ`O'#KRO(&mQ`O,5;ZO(&rQMjO,5<eO(&yQ`O'#GYO('OQ`O'#GYO('TQ`O,5<eO(']Q`O,5<gO('eQ`O,5;ZO('mQ?MtO1G1`O('tQ`O,5<tO('yQ`O,5<tO((OQ`O,5<vO((TQ`O,5<vO((YQ`O1G2RO((_Q`O1G0uO((dQMjO<<K}O((kQMjO<<K}O((rQMhO'#F|O9`Q`O'#F{OAuQ`O'#EnO!)[QlO,5;tO!3oQ`O'#GYO!3oQ`O'#GYO!3oQ`O'#G[O!3oQ`O'#G[O!,TQMhO7+(cO!,TQMhO7+(cO%.zQ!dO1G2wO%.zQ!dO1G2wO!&zQMhO,5=]O!&zQMhO,5=]",stateData:"()x~O'|OS'}OSTOS(ORQ~OPYOQYOSfOY!VOaqOdzOeyOl!POpkOrYOskOtkOzkO|YO!OYO!SWO!WkO!XkO!_XO!iuO!lZO!oYO!pYO!qYO!svO!uwO!xxO!|]O$W|O$niO%h}O%j!QO%l!OO%m!OO%n!OO%q!RO%s!SO%v!TO%w!TO%y!UO&W!WO&^!XO&`!YO&b!ZO&d![O&g!]O&m!^O&s!_O&u!`O&w!aO&y!bO&{!cO(TSO(VTO(YUO(aVO(o[O~OWtO~P`OPYOQYOSfOd!jOe!iOpkOrYOskOtkOzkO|YO!OYO!SWO!WkO!XkO!_!eO!iuO!lZO!oYO!pYO!qYO!svO!u!gO!x!hO$W!kO$niO(T!dO(VTO(YUO(aVO(o[O~Oa!wOs!nO!S!oO!b!yO!c!vO!d!vO!|<VO#T!pO#U!pO#V!xO#W!pO#X!pO#[!zO#]!zO(U!lO(VTO(YUO(e!mO(o!sO~O(O!{O~OP]XR]X[]Xa]Xj]Xr]X!Q]X!S]X!]]X!l]X!p]X#R]X#S]X#`]X#kfX#n]X#o]X#p]X#q]X#r]X#s]X#t]X#u]X#v]X#x]X#z]X#{]X$Q]X'z]X(a]X(r]X(y]X(z]X~O!g%RX~P(qO_!}O(V#PO(W!}O(X#PO~O_#QO(X#PO(Y#PO(Z#QO~Ox#SO!U#TO(b#TO(c#VO~OPYOQYOSfOd!jOe!iOpkOrYOskOtkOzkO|YO!OYO!SWO!WkO!XkO!_!eO!iuO!lZO!oYO!pYO!qYO!svO!u!gO!x!hO$W!kO$niO(T<ZO(VTO(YUO(aVO(o[O~O![#ZO!]#WO!Y(hP!Y(vP~P+}O!^#cO~P`OPYOQYOSfOd!jOe!iOrYOskOtkOzkO|YO!OYO!SWO!WkO!XkO!_!eO!iuO!lZO!oYO!pYO!qYO!svO!u!gO!x!hO$W!kO$niO(VTO(YUO(aVO(o[O~Op#mO![#iO!|]O#i#lO#j#iO(T<[O!k(sP~P.iO!l#oO(T#nO~O!x#sO!|]O%h#tO~O#k#uO~O!g#vO#k#uO~OP$[OR#zO[$cOj$ROr$aO!Q#yO!S#{O!]$_O!l#xO!p$[O#R$RO#n$OO#o$PO#p$PO#q$PO#r$QO#s$RO#t$RO#u$bO#v$SO#x$UO#z$WO#{$XO(aVO(r$YO(y#|O(z#}O~Oa(fX'z(fX'w(fX!k(fX!Y(fX!_(fX%i(fX!g(fX~P1qO#S$dO#`$eO$Q$eOP(gXR(gX[(gXj(gXr(gX!Q(gX!S(gX!](gX!l(gX!p(gX#R(gX#n(gX#o(gX#p(gX#q(gX#r(gX#s(gX#t(gX#u(gX#v(gX#x(gX#z(gX#{(gX(a(gX(r(gX(y(gX(z(gX!_(gX%i(gX~Oa(gX'z(gX'w(gX!Y(gX!k(gXv(gX!g(gX~P4UO#`$eO~O$]$hO$_$gO$f$mO~OSfO!_$nO$i$oO$k$qO~Oh%VOj%dOk%dOp%WOr%XOs$tOt$tOz%YO|%ZO!O%]O!S${O!_$|O!i%bO!l$xO#j%cO$W%`O$t%^O$v%_O$y%aO(T$sO(VTO(YUO(a$uO(y$}O(z%POg(^P~Ol%[O~P7eO!l%eO~O!S%hO!_%iO(T%gO~O!g%mO~Oa%nO'z%nO~O!Q%rO~P%[O(U!lO~P%[O%n%vO~P%[Oh%VO!l%eO(T%gO(U!lO~Oe%}O!l%eO(T%gO~Oj$RO~O!_&PO(T%gO(U!lO(VTO(YUO`)WP~O!Q&SO!l&RO%j&VO&T&WO~P;SO!x#sO~O%s&YO!S)SX!_)SX(T)SX~O(T&ZO~Ol!PO!u&`O%j!QO%l!OO%m!OO%n!OO%q!RO%s!SO%v!TO%w!TO~Od&eOe&dO!x&bO%h&cO%{&aO~P<bOd&hOeyOl!PO!_&gO!u&`O!xxO!|]O%h}O%l!OO%m!OO%n!OO%q!RO%s!SO%v!TO%w!TO%y!UO~Ob&kO#`&nO%j&iO(U!lO~P=gO!l&oO!u&sO~O!l#oO~O!_XO~Oa%nO'x&{O'z%nO~Oa%nO'x'OO'z%nO~Oa%nO'x'QO'z%nO~O'w]X!Y]Xv]X!k]X&[]X!_]X%i]X!g]X~P(qO!b'_O!c'WO!d'WO(U!lO(VTO(YUO~Os'UO!S'TO!['XO(e'SO!^(iP!^(xP~P@nOn'bO!_'`O(T%gO~Oe'gO!l%eO(T%gO~O!Q&SO!l&RO~Os!nO!S!oO!|<VO#T!pO#U!pO#W!pO#X!pO(U!lO(VTO(YUO(e!mO(o!sO~O!b'mO!c'lO!d'lO#V!pO#['nO#]'nO~PBYOa%nOh%VO!g#vO!l%eO'z%nO(r'pO~O!p'tO#`'rO~PChOs!nO!S!oO(VTO(YUO(e!mO(o!sO~O!_XOs(mX!S(mX!b(mX!c(mX!d(mX!|(mX#T(mX#U(mX#V(mX#W(mX#X(mX#[(mX#](mX(U(mX(V(mX(Y(mX(e(mX(o(mX~O!c'lO!d'lO(U!lO~PDWO(P'xO(Q'xO(R'zO~O_!}O(V'|O(W!}O(X'|O~O_#QO(X'|O(Y'|O(Z#QO~Ov(OO~P%[Ox#SO!U#TO(b#TO(c(RO~O![(TO!Y'WX!Y'^X!]'WX!]'^X~P+}O!](VO!Y(hX~OP$[OR#zO[$cOj$ROr$aO!Q#yO!S#{O!](VO!l#xO!p$[O#R$RO#n$OO#o$PO#p$PO#q$PO#r$QO#s$RO#t$RO#u$bO#v$SO#x$UO#z$WO#{$XO(aVO(r$YO(y#|O(z#}O~O!Y(hX~PHRO!Y([O~O!Y(uX!](uX!g(uX!k(uX(r(uX~O#`(uX#k#dX!^(uX~PJUO#`(]O!Y(wX!](wX~O!](^O!Y(vX~O!Y(aO~O#`$eO~PJUO!^(bO~P`OR#zO!Q#yO!S#{O!l#xO(aVOP!na[!naj!nar!na!]!na!p!na#R!na#n!na#o!na#p!na#q!na#r!na#s!na#t!na#u!na#v!na#x!na#z!na#{!na(r!na(y!na(z!na~Oa!na'z!na'w!na!Y!na!k!nav!na!_!na%i!na!g!na~PKlO!k(cO~O!g#vO#`(dO(r'pO!](tXa(tX'z(tX~O!k(tX~PNXO!S%hO!_%iO!|]O#i(iO#j(hO(T%gO~O!](jO!k(sX~O!k(lO~O!S%hO!_%iO#j(hO(T%gO~OP(gXR(gX[(gXj(gXr(gX!Q(gX!S(gX!](gX!l(gX!p(gX#R(gX#n(gX#o(gX#p(gX#q(gX#r(gX#s(gX#t(gX#u(gX#v(gX#x(gX#z(gX#{(gX(a(gX(r(gX(y(gX(z(gX~O!g#vO!k(gX~P! uOR(nO!Q(mO!l#xO#S$dO!|!{a!S!{a~O!x!{a%h!{a!_!{a#i!{a#j!{a(T!{a~P!#vO!x(rO~OPYOQYOSfOd!jOe!iOpkOrYOskOtkOzkO|YO!OYO!SWO!WkO!XkO!_XO!iuO!lZO!oYO!pYO!qYO!svO!u!gO!x!hO$W!kO$niO(T!dO(VTO(YUO(aVO(o[O~Oh%VOp%WOr%XOs$tOt$tOz%YO|%ZO!O<sO!S${O!_$|O!i>VO!l$xO#j<yO$W%`O$t<uO$v<wO$y%aO(T(vO(VTO(YUO(a$uO(y$}O(z%PO~O#k(xO~O![(zO!k(kP~P%[O(e(|O(o[O~O!S)OO!l#xO(e(|O(o[O~OP<UOQ<UOSfOd>ROe!iOpkOr<UOskOtkOzkO|<UO!O<UO!SWO!WkO!XkO!_!eO!i<XO!lZO!o<UO!p<UO!q<UO!s<YO!u<]O!x!hO$W!kO$n>PO(T)]O(VTO(YUO(aVO(o[O~O!]$_Oa$qa'z$qa'w$qa!k$qa!Y$qa!_$qa%i$qa!g$qa~Ol)dO~P!&zOh%VOp%WOr%XOs$tOt$tOz%YO|%ZO!O%]O!S${O!_$|O!i%bO!l$xO#j%cO$W%`O$t%^O$v%_O$y%aO(T(vO(VTO(YUO(a$uO(y$}O(z%PO~Og(pP~P!,TO!Q)iO!g)hO!_$^X$Z$^X$]$^X$_$^X$f$^X~O!g)hO!_({X$Z({X$]({X$_({X$f({X~O!Q)iO~P!.^O!Q)iO!_({X$Z({X$]({X$_({X$f({X~O!_)kO$Z)oO$])jO$_)jO$f)pO~O![)sO~P!)[O$]$hO$_$gO$f)wO~On$zX!Q$zX#S$zX'y$zX(y$zX(z$zX~OgmXg$zXnmX!]mX#`mX~P!0SOx)yO(b)zO(c)|O~On*VO!Q*OO'y*PO(y$}O(z%PO~Og)}O~P!1WOg*WO~Oh%VOr%XOs$tOt$tOz%YO|%ZO!O<sO!S*YO!_*ZO!i>VO!l$xO#j<yO$W%`O$t<uO$v<wO$y%aO(VTO(YUO(a$uO(y$}O(z%PO~Op*`O![*^O(T*XO!k)OP~P!1uO#k*aO~O!l*bO~Oh%VOp%WOr%XOs$tOt$tOz%YO|%ZO!O<sO!S${O!_$|O!i>VO!l$xO#j<yO$W%`O$t<uO$v<wO$y%aO(T*dO(VTO(YUO(a$uO(y$}O(z%PO~O![*gO!Y)PP~P!3tOr*sOs!nO!S*iO!b*qO!c*kO!d*kO!l*bO#[*rO%`*mO(U!lO(VTO(YUO(e!mO~O!^*pO~P!5iO#S$dOn(`X!Q(`X'y(`X(y(`X(z(`X!](`X#`(`X~Og(`X$O(`X~P!6kOn*xO#`*wOg(_X!](_X~O!]*yOg(^X~Oj%dOk%dOl%dO(T&ZOg(^P~Os*|O~Og)}O(T&ZO~O!l+SO~O(T(vO~Op+WO!S%hO![#iO!_%iO!|]O#i#lO#j#iO(T%gO!k(sP~O!g#vO#k+XO~O!S%hO![+ZO!](^O!_%iO(T%gO!Y(vP~Os'[O!S+]O![+[O(VTO(YUO(e(|O~O!^(xP~P!9|O!]+^Oa)TX'z)TX~OP$[OR#zO[$cOj$ROr$aO!Q#yO!S#{O!l#xO!p$[O#R$RO#n$OO#o$PO#p$PO#q$PO#r$QO#s$RO#t$RO#u$bO#v$SO#x$UO#z$WO#{$XO(aVO(r$YO(y#|O(z#}O~Oa!ja!]!ja'z!ja'w!ja!Y!ja!k!jav!ja!_!ja%i!ja!g!ja~P!:tOR#zO!Q#yO!S#{O!l#xO(aVOP!ra[!raj!rar!ra!]!ra!p!ra#R!ra#n!ra#o!ra#p!ra#q!ra#r!ra#s!ra#t!ra#u!ra#v!ra#x!ra#z!ra#{!ra(r!ra(y!ra(z!ra~Oa!ra'z!ra'w!ra!Y!ra!k!rav!ra!_!ra%i!ra!g!ra~P!=[OR#zO!Q#yO!S#{O!l#xO(aVOP!ta[!taj!tar!ta!]!ta!p!ta#R!ta#n!ta#o!ta#p!ta#q!ta#r!ta#s!ta#t!ta#u!ta#v!ta#x!ta#z!ta#{!ta(r!ta(y!ta(z!ta~Oa!ta'z!ta'w!ta!Y!ta!k!tav!ta!_!ta%i!ta!g!ta~P!?rOh%VOn+gO!_'`O%i+fO~O!g+iOa(]X!_(]X'z(]X!](]X~Oa%nO!_XO'z%nO~Oh%VO!l%eO~Oh%VO!l%eO(T%gO~O!g#vO#k(xO~Ob+tO%j+uO(T+qO(VTO(YUO!^)XP~O!]+vO`)WX~O[+zO~O`+{O~O!_&PO(T%gO(U!lO`)WP~O%j,OO~P;SOh%VO#`,SO~Oh%VOn,VO!_$|O~O!_,XO~O!Q,ZO!_XO~O%n%vO~O!x,`O~Oe,eO~Ob,fO(T#nO(VTO(YUO!^)VP~Oe%}O~O%j!QO(T&ZO~P=gO[,kO`,jO~OPYOQYOSfOdzOeyOpkOrYOskOtkOzkO|YO!OYO!SWO!WkO!XkO!iuO!lZO!oYO!pYO!qYO!svO!xxO!|]O$niO%h}O(VTO(YUO(aVO(o[O~O!_!eO!u!gO$W!kO(T!dO~P!FyO`,jOa%nO'z%nO~OPYOQYOSfOd!jOe!iOpkOrYOskOtkOzkO|YO!OYO!SWO!WkO!XkO!_!eO!iuO!lZO!oYO!pYO!qYO!svO!x!hO$W!kO$niO(T!dO(VTO(YUO(aVO(o[O~Oa,pOl!OO!uwO%l!OO%m!OO%n!OO~P!IcO!l&oO~O&^,vO~O!_,xO~O&o,zO&q,{OP&laQ&laS&laY&laa&lad&lae&lal&lap&lar&las&lat&laz&la|&la!O&la!S&la!W&la!X&la!_&la!i&la!l&la!o&la!p&la!q&la!s&la!u&la!x&la!|&la$W&la$n&la%h&la%j&la%l&la%m&la%n&la%q&la%s&la%v&la%w&la%y&la&W&la&^&la&`&la&b&la&d&la&g&la&m&la&s&la&u&la&w&la&y&la&{&la'w&la(T&la(V&la(Y&la(a&la(o&la!^&la&e&lab&la&j&la~O(T-QO~Oh!eX!]!RX!^!RX!g!RX!g!eX!l!eX#`!RX~O!]!eX!^!eX~P#!iO!g-VO#`-UOh(jX!]#hX!^#hX!g(jX!l(jX~O!](jX!^(jX~P##[Oh%VO!g-XO!l%eO!]!aX!^!aX~Os!nO!S!oO(VTO(YUO(e!mO~OP<UOQ<UOSfOd>ROe!iOpkOr<UOskOtkOzkO|<UO!O<UO!SWO!WkO!XkO!_!eO!i<XO!lZO!o<UO!p<UO!q<UO!s<YO!u<]O!x!hO$W!kO$n>PO(VTO(YUO(aVO(o[O~O(T=QO~P#$qO!]-]O!^(iX~O!^-_O~O!g-VO#`-UO!]#hX!^#hX~O!]-`O!^(xX~O!^-bO~O!c-cO!d-cO(U!lO~P#$`O!^-fO~P'_On-iO!_'`O~O!Y-nO~Os!{a!b!{a!c!{a!d!{a#T!{a#U!{a#V!{a#W!{a#X!{a#[!{a#]!{a(U!{a(V!{a(Y!{a(e!{a(o!{a~P!#vO!p-sO#`-qO~PChO!c-uO!d-uO(U!lO~PDWOa%nO#`-qO'z%nO~Oa%nO!g#vO#`-qO'z%nO~Oa%nO!g#vO!p-sO#`-qO'z%nO(r'pO~O(P'xO(Q'xO(R-zO~Ov-{O~O!Y'Wa!]'Wa~P!:tO![.PO!Y'WX!]'WX~P%[O!](VO!Y(ha~O!Y(ha~PHRO!](^O!Y(va~O!S%hO![.TO!_%iO(T%gO!Y'^X!]'^X~O#`.VO!](ta!k(taa(ta'z(ta~O!g#vO~P#,wO!](jO!k(sa~O!S%hO!_%iO#j.ZO(T%gO~Op.`O!S%hO![.]O!_%iO!|]O#i._O#j.]O(T%gO!]'aX!k'aX~OR.dO!l#xO~Oh%VOn.gO!_'`O%i.fO~Oa#ci!]#ci'z#ci'w#ci!Y#ci!k#civ#ci!_#ci%i#ci!g#ci~P!:tOn>]O!Q*OO'y*PO(y$}O(z%PO~O#k#_aa#_a#`#_a'z#_a!]#_a!k#_a!_#_a!Y#_a~P#/sO#k(`XP(`XR(`X[(`Xa(`Xj(`Xr(`X!S(`X!l(`X!p(`X#R(`X#n(`X#o(`X#p(`X#q(`X#r(`X#s(`X#t(`X#u(`X#v(`X#x(`X#z(`X#{(`X'z(`X(a(`X(r(`X!k(`X!Y(`X'w(`Xv(`X!_(`X%i(`X!g(`X~P!6kO!].tO!k(kX~P!:tO!k.wO~O!Y.yO~OP$[OR#zO!Q#yO!S#{O!l#xO!p$[O(aVO[#mia#mij#mir#mi!]#mi#R#mi#o#mi#p#mi#q#mi#r#mi#s#mi#t#mi#u#mi#v#mi#x#mi#z#mi#{#mi'z#mi(r#mi(y#mi(z#mi'w#mi!Y#mi!k#miv#mi!_#mi%i#mi!g#mi~O#n#mi~P#3cO#n$OO~P#3cOP$[OR#zOr$aO!Q#yO!S#{O!l#xO!p$[O#n$OO#o$PO#p$PO#q$PO(aVO[#mia#mij#mi!]#mi#R#mi#s#mi#t#mi#u#mi#v#mi#x#mi#z#mi#{#mi'z#mi(r#mi(y#mi(z#mi'w#mi!Y#mi!k#miv#mi!_#mi%i#mi!g#mi~O#r#mi~P#6QO#r$QO~P#6QOP$[OR#zO[$cOj$ROr$aO!Q#yO!S#{O!l#xO!p$[O#R$RO#n$OO#o$PO#p$PO#q$PO#r$QO#s$RO#t$RO#u$bO(aVOa#mi!]#mi#x#mi#z#mi#{#mi'z#mi(r#mi(y#mi(z#mi'w#mi!Y#mi!k#miv#mi!_#mi%i#mi!g#mi~O#v#mi~P#8oOP$[OR#zO[$cOj$ROr$aO!Q#yO!S#{O!l#xO!p$[O#R$RO#n$OO#o$PO#p$PO#q$PO#r$QO#s$RO#t$RO#u$bO#v$SO(aVO(z#}Oa#mi!]#mi#z#mi#{#mi'z#mi(r#mi(y#mi'w#mi!Y#mi!k#miv#mi!_#mi%i#mi!g#mi~O#x$UO~P#;VO#x#mi~P#;VO#v$SO~P#8oOP$[OR#zO[$cOj$ROr$aO!Q#yO!S#{O!l#xO!p$[O#R$RO#n$OO#o$PO#p$PO#q$PO#r$QO#s$RO#t$RO#u$bO#v$SO#x$UO(aVO(y#|O(z#}Oa#mi!]#mi#{#mi'z#mi(r#mi'w#mi!Y#mi!k#miv#mi!_#mi%i#mi!g#mi~O#z#mi~P#={O#z$WO~P#={OP]XR]X[]Xj]Xr]X!Q]X!S]X!l]X!p]X#R]X#S]X#`]X#kfX#n]X#o]X#p]X#q]X#r]X#s]X#t]X#u]X#v]X#x]X#z]X#{]X$Q]X(a]X(r]X(y]X(z]X!]]X!^]X~O$O]X~P#@jOP$[OR#zO[<mOj<bOr<kO!Q#yO!S#{O!l#xO!p$[O#R<bO#n<_O#o<`O#p<`O#q<`O#r<aO#s<bO#t<bO#u<lO#v<cO#x<eO#z<gO#{<hO(aVO(r$YO(y#|O(z#}O~O$O.{O~P#BwO#S$dO#`<nO$Q<nO$O(gX!^(gX~P! uOa'da!]'da'z'da'w'da!k'da!Y'dav'da!_'da%i'da!g'da~P!:tO[#mia#mij#mir#mi!]#mi#R#mi#r#mi#s#mi#t#mi#u#mi#v#mi#x#mi#z#mi#{#mi'z#mi(r#mi'w#mi!Y#mi!k#miv#mi!_#mi%i#mi!g#mi~OP$[OR#zO!Q#yO!S#{O!l#xO!p$[O#n$OO#o$PO#p$PO#q$PO(aVO(y#mi(z#mi~P#EyOn>]O!Q*OO'y*PO(y$}O(z%POP#miR#mi!S#mi!l#mi!p#mi#n#mi#o#mi#p#mi#q#mi(a#mi~P#EyO!]/POg(pX~P!1WOg/RO~Oa$Pi!]$Pi'z$Pi'w$Pi!Y$Pi!k$Piv$Pi!_$Pi%i$Pi!g$Pi~P!:tO$]/SO$_/SO~O$]/TO$_/TO~O!g)hO#`/UO!_$cX$Z$cX$]$cX$_$cX$f$cX~O![/VO~O!_)kO$Z/XO$])jO$_)jO$f/YO~O!]<iO!^(fX~P#BwO!^/ZO~O!g)hO$f({X~O$f/]O~Ov/^O~P!&zOx)yO(b)zO(c/aO~O!S/dO~O(y$}On%aa!Q%aa'y%aa(z%aa!]%aa#`%aa~Og%aa$O%aa~P#L{O(z%POn%ca!Q%ca'y%ca(y%ca!]%ca#`%ca~Og%ca$O%ca~P#MnO!]fX!gfX!kfX!k$zX(rfX~P!0SOp%WO![/mO!](^O(T/lO!Y(vP!Y)PP~P!1uOr*sO!b*qO!c*kO!d*kO!l*bO#[*rO%`*mO(U!lO(VTO(YUO~Os<}O!S/nO![+[O!^*pO(e<|O!^(xP~P$ [O!k/oO~P#/sO!]/pO!g#vO(r'pO!k)OX~O!k/uO~OnoX!QoX'yoX(yoX(zoX~O!g#vO!koX~P$#OOp/wO!S%hO![*^O!_%iO(T%gO!k)OP~O#k/xO~O!Y$zX!]$zX!g%RX~P!0SO!]/yO!Y)PX~P#/sO!g/{O~O!Y/}O~OpkO(T0OO~P.iOh%VOr0TO!g#vO!l%eO(r'pO~O!g+iO~Oa%nO!]0XO'z%nO~O!^0ZO~P!5iO!c0[O!d0[O(U!lO~P#$`Os!nO!S0]O(VTO(YUO(e!mO~O#[0_O~Og%aa!]%aa#`%aa$O%aa~P!1WOg%ca!]%ca#`%ca$O%ca~P!1WOj%dOk%dOl%dO(T&ZOg'mX!]'mX~O!]*yOg(^a~Og0hO~On0jO#`0iOg(_a!](_a~OR0kO!Q0kO!S0lO#S$dOn}a'y}a(y}a(z}a!]}a#`}a~Og}a$O}a~P$(cO!Q*OO'y*POn$sa(y$sa(z$sa!]$sa#`$sa~Og$sa$O$sa~P$)_O!Q*OO'y*POn$ua(y$ua(z$ua!]$ua#`$ua~Og$ua$O$ua~P$*QO#k0oO~Og%Ta!]%Ta#`%Ta$O%Ta~P!1WO!g#vO~O#k0rO~O!]+^Oa)Ta'z)Ta~OR#zO!Q#yO!S#{O!l#xO(aVOP!ri[!rij!rir!ri!]!ri!p!ri#R!ri#n!ri#o!ri#p!ri#q!ri#r!ri#s!ri#t!ri#u!ri#v!ri#x!ri#z!ri#{!ri(r!ri(y!ri(z!ri~Oa!ri'z!ri'w!ri!Y!ri!k!riv!ri!_!ri%i!ri!g!ri~P$+oOh%VOr%XOs$tOt$tOz%YO|%ZO!O<sO!S${O!_$|O!i>VO!l$xO#j<yO$W%`O$t<uO$v<wO$y%aO(VTO(YUO(a$uO(y$}O(z%PO~Op0{O%]0|O(T0zO~P$.VO!g+iOa(]a!_(]a'z(]a!](]a~O#k1SO~O[]X!]fX!^fX~O!]1TO!^)XX~O!^1VO~O[1WO~Ob1YO(T+qO(VTO(YUO~O!_&PO(T%gO`'uX!]'uX~O!]+vO`)Wa~O!k1]O~P!:tO[1`O~O`1aO~O#`1fO~On1iO!_$|O~O(e(|O!^)UP~Oh%VOn1rO!_1oO%i1qO~O[1|O!]1zO!^)VX~O!^1}O~O`2POa%nO'z%nO~O(T#nO(VTO(YUO~O#S$dO#`$eO$Q$eOP(gXR(gX[(gXr(gX!Q(gX!S(gX!](gX!l(gX!p(gX#R(gX#n(gX#o(gX#p(gX#q(gX#r(gX#s(gX#t(gX#u(gX#v(gX#x(gX#z(gX#{(gX(a(gX(r(gX(y(gX(z(gX~Oj2SO&[2TOa(gX~P$3pOj2SO#`$eO&[2TO~Oa2VO~P%[Oa2XO~O&e2[OP&ciQ&ciS&ciY&cia&cid&cie&cil&cip&cir&cis&cit&ciz&ci|&ci!O&ci!S&ci!W&ci!X&ci!_&ci!i&ci!l&ci!o&ci!p&ci!q&ci!s&ci!u&ci!x&ci!|&ci$W&ci$n&ci%h&ci%j&ci%l&ci%m&ci%n&ci%q&ci%s&ci%v&ci%w&ci%y&ci&W&ci&^&ci&`&ci&b&ci&d&ci&g&ci&m&ci&s&ci&u&ci&w&ci&y&ci&{&ci'w&ci(T&ci(V&ci(Y&ci(a&ci(o&ci!^&cib&ci&j&ci~Ob2bO!^2`O&j2aO~P`O!_XO!l2dO~O&q,{OP&liQ&liS&liY&lia&lid&lie&lil&lip&lir&lis&lit&liz&li|&li!O&li!S&li!W&li!X&li!_&li!i&li!l&li!o&li!p&li!q&li!s&li!u&li!x&li!|&li$W&li$n&li%h&li%j&li%l&li%m&li%n&li%q&li%s&li%v&li%w&li%y&li&W&li&^&li&`&li&b&li&d&li&g&li&m&li&s&li&u&li&w&li&y&li&{&li'w&li(T&li(V&li(Y&li(a&li(o&li!^&li&e&lib&li&j&li~O!Y2jO~O!]!aa!^!aa~P#BwOs!nO!S!oO![2pO(e!mO!]'XX!^'XX~P@nO!]-]O!^(ia~O!]'_X!^'_X~P!9|O!]-`O!^(xa~O!^2wO~P'_Oa%nO#`3QO'z%nO~Oa%nO!g#vO#`3QO'z%nO~Oa%nO!g#vO!p3UO#`3QO'z%nO(r'pO~Oa%nO'z%nO~P!:tO!]$_Ov$qa~O!Y'Wi!]'Wi~P!:tO!](VO!Y(hi~O!](^O!Y(vi~O!Y(wi!](wi~P!:tO!](ti!k(tia(ti'z(ti~P!:tO#`3WO!](ti!k(tia(ti'z(ti~O!](jO!k(si~O!S%hO!_%iO!|]O#i3]O#j3[O(T%gO~O!S%hO!_%iO#j3[O(T%gO~On3dO!_'`O%i3cO~Oh%VOn3dO!_'`O%i3cO~O#k%aaP%aaR%aa[%aaa%aaj%aar%aa!S%aa!l%aa!p%aa#R%aa#n%aa#o%aa#p%aa#q%aa#r%aa#s%aa#t%aa#u%aa#v%aa#x%aa#z%aa#{%aa'z%aa(a%aa(r%aa!k%aa!Y%aa'w%aav%aa!_%aa%i%aa!g%aa~P#L{O#k%caP%caR%ca[%caa%caj%car%ca!S%ca!l%ca!p%ca#R%ca#n%ca#o%ca#p%ca#q%ca#r%ca#s%ca#t%ca#u%ca#v%ca#x%ca#z%ca#{%ca'z%ca(a%ca(r%ca!k%ca!Y%ca'w%cav%ca!_%ca%i%ca!g%ca~P#MnO#k%aaP%aaR%aa[%aaa%aaj%aar%aa!S%aa!]%aa!l%aa!p%aa#R%aa#n%aa#o%aa#p%aa#q%aa#r%aa#s%aa#t%aa#u%aa#v%aa#x%aa#z%aa#{%aa'z%aa(a%aa(r%aa!k%aa!Y%aa'w%aa#`%aav%aa!_%aa%i%aa!g%aa~P#/sO#k%caP%caR%ca[%caa%caj%car%ca!S%ca!]%ca!l%ca!p%ca#R%ca#n%ca#o%ca#p%ca#q%ca#r%ca#s%ca#t%ca#u%ca#v%ca#x%ca#z%ca#{%ca'z%ca(a%ca(r%ca!k%ca!Y%ca'w%ca#`%cav%ca!_%ca%i%ca!g%ca~P#/sO#k}aP}a[}aa}aj}ar}a!l}a!p}a#R}a#n}a#o}a#p}a#q}a#r}a#s}a#t}a#u}a#v}a#x}a#z}a#{}a'z}a(a}a(r}a!k}a!Y}a'w}av}a!_}a%i}a!g}a~P$(cO#k$saP$saR$sa[$saa$saj$sar$sa!S$sa!l$sa!p$sa#R$sa#n$sa#o$sa#p$sa#q$sa#r$sa#s$sa#t$sa#u$sa#v$sa#x$sa#z$sa#{$sa'z$sa(a$sa(r$sa!k$sa!Y$sa'w$sav$sa!_$sa%i$sa!g$sa~P$)_O#k$uaP$uaR$ua[$uaa$uaj$uar$ua!S$ua!l$ua!p$ua#R$ua#n$ua#o$ua#p$ua#q$ua#r$ua#s$ua#t$ua#u$ua#v$ua#x$ua#z$ua#{$ua'z$ua(a$ua(r$ua!k$ua!Y$ua'w$uav$ua!_$ua%i$ua!g$ua~P$*QO#k%TaP%TaR%Ta[%Taa%Taj%Tar%Ta!S%Ta!]%Ta!l%Ta!p%Ta#R%Ta#n%Ta#o%Ta#p%Ta#q%Ta#r%Ta#s%Ta#t%Ta#u%Ta#v%Ta#x%Ta#z%Ta#{%Ta'z%Ta(a%Ta(r%Ta!k%Ta!Y%Ta'w%Ta#`%Tav%Ta!_%Ta%i%Ta!g%Ta~P#/sOa#cq!]#cq'z#cq'w#cq!Y#cq!k#cqv#cq!_#cq%i#cq!g#cq~P!:tO![3lO!]'YX!k'YX~P%[O!].tO!k(ka~O!].tO!k(ka~P!:tO!Y3oO~O$O!na!^!na~PKlO$O!ja!]!ja!^!ja~P#BwO$O!ra!^!ra~P!=[O$O!ta!^!ta~P!?rOg']X!]']X~P!,TO!]/POg(pa~OSfO!_4TO$d4UO~O!^4YO~Ov4ZO~P#/sOa$mq!]$mq'z$mq'w$mq!Y$mq!k$mqv$mq!_$mq%i$mq!g$mq~P!:tO!Y4]O~P!&zO!S4^O~O!Q*OO'y*PO(z%POn'ia(y'ia!]'ia#`'ia~Og'ia$O'ia~P%-fO!Q*OO'y*POn'ka(y'ka(z'ka!]'ka#`'ka~Og'ka$O'ka~P%.XO(r$YO~P#/sO!YfX!Y$zX!]fX!]$zX!g%RX#`fX~P!0SOp%WO(T=WO~P!1uOp4bO!S%hO![4aO!_%iO(T%gO!]'eX!k'eX~O!]/pO!k)Oa~O!]/pO!g#vO!k)Oa~O!]/pO!g#vO(r'pO!k)Oa~Og$|i!]$|i#`$|i$O$|i~P!1WO![4jO!Y'gX!]'gX~P!3tO!]/yO!Y)Pa~O!]/yO!Y)Pa~P#/sOP]XR]X[]Xj]Xr]X!Q]X!S]X!Y]X!]]X!l]X!p]X#R]X#S]X#`]X#kfX#n]X#o]X#p]X#q]X#r]X#s]X#t]X#u]X#v]X#x]X#z]X#{]X$Q]X(a]X(r]X(y]X(z]X~Oj%YX!g%YX~P%2OOj4oO!g#vO~Oh%VO!g#vO!l%eO~Oh%VOr4tO!l%eO(r'pO~Or4yO!g#vO(r'pO~Os!nO!S4zO(VTO(YUO(e!mO~O(y$}On%ai!Q%ai'y%ai(z%ai!]%ai#`%ai~Og%ai$O%ai~P%5oO(z%POn%ci!Q%ci'y%ci(y%ci!]%ci#`%ci~Og%ci$O%ci~P%6bOg(_i!](_i~P!1WO#`5QOg(_i!](_i~P!1WO!k5VO~Oa$oq!]$oq'z$oq'w$oq!Y$oq!k$oqv$oq!_$oq%i$oq!g$oq~P!:tO!Y5ZO~O!]5[O!_)QX~P#/sOa$zX!_$zX%^]X'z$zX!]$zX~P!0SO%^5_OaoX!_oX'zoX!]oX~P$#OOp5`O(T#nO~O%^5_O~Ob5fO%j5gO(T+qO(VTO(YUO!]'tX!^'tX~O!]1TO!^)Xa~O[5kO~O`5lO~O[5pO~Oa%nO'z%nO~P#/sO!]5uO#`5wO!^)UX~O!^5xO~Or6OOs!nO!S*iO!b!yO!c!vO!d!vO!|<VO#T!pO#U!pO#V!pO#W!pO#X!pO#[5}O#]!zO(U!lO(VTO(YUO(e!mO(o!sO~O!^5|O~P%;eOn6TO!_1oO%i6SO~Oh%VOn6TO!_1oO%i6SO~Ob6[O(T#nO(VTO(YUO!]'sX!^'sX~O!]1zO!^)Va~O(VTO(YUO(e6^O~O`6bO~Oj6eO&[6fO~PNXO!k6gO~P%[Oa6iO~Oa6iO~P%[Ob2bO!^6nO&j2aO~P`O!g6pO~O!g6rOh(ji!](ji!^(ji!g(ji!l(jir(ji(r(ji~O!]#hi!^#hi~P#BwO#`6sO!]#hi!^#hi~O!]!ai!^!ai~P#BwOa%nO#`6|O'z%nO~Oa%nO!g#vO#`6|O'z%nO~O!](tq!k(tqa(tq'z(tq~P!:tO!](jO!k(sq~O!S%hO!_%iO#j7TO(T%gO~O!_'`O%i7WO~On7[O!_'`O%i7WO~O#k'iaP'iaR'ia['iaa'iaj'iar'ia!S'ia!l'ia!p'ia#R'ia#n'ia#o'ia#p'ia#q'ia#r'ia#s'ia#t'ia#u'ia#v'ia#x'ia#z'ia#{'ia'z'ia(a'ia(r'ia!k'ia!Y'ia'w'iav'ia!_'ia%i'ia!g'ia~P%-fO#k'kaP'kaR'ka['kaa'kaj'kar'ka!S'ka!l'ka!p'ka#R'ka#n'ka#o'ka#p'ka#q'ka#r'ka#s'ka#t'ka#u'ka#v'ka#x'ka#z'ka#{'ka'z'ka(a'ka(r'ka!k'ka!Y'ka'w'kav'ka!_'ka%i'ka!g'ka~P%.XO#k$|iP$|iR$|i[$|ia$|ij$|ir$|i!S$|i!]$|i!l$|i!p$|i#R$|i#n$|i#o$|i#p$|i#q$|i#r$|i#s$|i#t$|i#u$|i#v$|i#x$|i#z$|i#{$|i'z$|i(a$|i(r$|i!k$|i!Y$|i'w$|i#`$|iv$|i!_$|i%i$|i!g$|i~P#/sO#k%aiP%aiR%ai[%aia%aij%air%ai!S%ai!l%ai!p%ai#R%ai#n%ai#o%ai#p%ai#q%ai#r%ai#s%ai#t%ai#u%ai#v%ai#x%ai#z%ai#{%ai'z%ai(a%ai(r%ai!k%ai!Y%ai'w%aiv%ai!_%ai%i%ai!g%ai~P%5oO#k%ciP%ciR%ci[%cia%cij%cir%ci!S%ci!l%ci!p%ci#R%ci#n%ci#o%ci#p%ci#q%ci#r%ci#s%ci#t%ci#u%ci#v%ci#x%ci#z%ci#{%ci'z%ci(a%ci(r%ci!k%ci!Y%ci'w%civ%ci!_%ci%i%ci!g%ci~P%6bO!]'Ya!k'Ya~P!:tO!].tO!k(ki~O$O#ci!]#ci!^#ci~P#BwOP$[OR#zO!Q#yO!S#{O!l#xO!p$[O(aVO[#mij#mir#mi#R#mi#o#mi#p#mi#q#mi#r#mi#s#mi#t#mi#u#mi#v#mi#x#mi#z#mi#{#mi$O#mi(r#mi(y#mi(z#mi!]#mi!^#mi~O#n#mi~P%NdO#n<_O~P%NdOP$[OR#zOr<kO!Q#yO!S#{O!l#xO!p$[O#n<_O#o<`O#p<`O#q<`O(aVO[#mij#mi#R#mi#s#mi#t#mi#u#mi#v#mi#x#mi#z#mi#{#mi$O#mi(r#mi(y#mi(z#mi!]#mi!^#mi~O#r#mi~P&!lO#r<aO~P&!lOP$[OR#zO[<mOj<bOr<kO!Q#yO!S#{O!l#xO!p$[O#R<bO#n<_O#o<`O#p<`O#q<`O#r<aO#s<bO#t<bO#u<lO(aVO#x#mi#z#mi#{#mi$O#mi(r#mi(y#mi(z#mi!]#mi!^#mi~O#v#mi~P&$tOP$[OR#zO[<mOj<bOr<kO!Q#yO!S#{O!l#xO!p$[O#R<bO#n<_O#o<`O#p<`O#q<`O#r<aO#s<bO#t<bO#u<lO#v<cO(aVO(z#}O#z#mi#{#mi$O#mi(r#mi(y#mi!]#mi!^#mi~O#x<eO~P&&uO#x#mi~P&&uO#v<cO~P&$tOP$[OR#zO[<mOj<bOr<kO!Q#yO!S#{O!l#xO!p$[O#R<bO#n<_O#o<`O#p<`O#q<`O#r<aO#s<bO#t<bO#u<lO#v<cO#x<eO(aVO(y#|O(z#}O#{#mi$O#mi(r#mi!]#mi!^#mi~O#z#mi~P&)UO#z<gO~P&)UOa#|y!]#|y'z#|y'w#|y!Y#|y!k#|yv#|y!_#|y%i#|y!g#|y~P!:tO[#mij#mir#mi#R#mi#r#mi#s#mi#t#mi#u#mi#v#mi#x#mi#z#mi#{#mi$O#mi(r#mi!]#mi!^#mi~OP$[OR#zO!Q#yO!S#{O!l#xO!p$[O#n<_O#o<`O#p<`O#q<`O(aVO(y#mi(z#mi~P&,QOn>^O!Q*OO'y*PO(y$}O(z%POP#miR#mi!S#mi!l#mi!p#mi#n#mi#o#mi#p#mi#q#mi(a#mi~P&,QO#S$dOP(`XR(`X[(`Xj(`Xn(`Xr(`X!Q(`X!S(`X!l(`X!p(`X#R(`X#n(`X#o(`X#p(`X#q(`X#r(`X#s(`X#t(`X#u(`X#v(`X#x(`X#z(`X#{(`X$O(`X'y(`X(a(`X(r(`X(y(`X(z(`X!](`X!^(`X~O$O$Pi!]$Pi!^$Pi~P#BwO$O!ri!^!ri~P$+oOg']a!]']a~P!1WO!^7nO~O!]'da!^'da~P#BwO!Y7oO~P#/sO!g#vO(r'pO!]'ea!k'ea~O!]/pO!k)Oi~O!]/pO!g#vO!k)Oi~Og$|q!]$|q#`$|q$O$|q~P!1WO!Y'ga!]'ga~P#/sO!g7vO~O!]/yO!Y)Pi~P#/sO!]/yO!Y)Pi~O!Y7yO~Oh%VOr8OO!l%eO(r'pO~Oj8QO!g#vO~Or8TO!g#vO(r'pO~O!Q*OO'y*PO(z%POn'ja(y'ja!]'ja#`'ja~Og'ja$O'ja~P&5RO!Q*OO'y*POn'la(y'la(z'la!]'la#`'la~Og'la$O'la~P&5tOg(_q!](_q~P!1WO#`8VOg(_q!](_q~P!1WO!Y8WO~Og%Oq!]%Oq#`%Oq$O%Oq~P!1WOa$oy!]$oy'z$oy'w$oy!Y$oy!k$oyv$oy!_$oy%i$oy!g$oy~P!:tO!g6rO~O!]5[O!_)Qa~O!_'`OP$TaR$Ta[$Taj$Tar$Ta!Q$Ta!S$Ta!]$Ta!l$Ta!p$Ta#R$Ta#n$Ta#o$Ta#p$Ta#q$Ta#r$Ta#s$Ta#t$Ta#u$Ta#v$Ta#x$Ta#z$Ta#{$Ta(a$Ta(r$Ta(y$Ta(z$Ta~O%i7WO~P&8fO%^8[Oa%[i!_%[i'z%[i!]%[i~Oa#cy!]#cy'z#cy'w#cy!Y#cy!k#cyv#cy!_#cy%i#cy!g#cy~P!:tO[8^O~Ob8`O(T+qO(VTO(YUO~O!]1TO!^)Xi~O`8dO~O(e(|O!]'pX!^'pX~O!]5uO!^)Ua~O!^8nO~P%;eO(o!sO~P$&YO#[8oO~O!_1oO~O!_1oO%i8qO~On8tO!_1oO%i8qO~O[8yO!]'sa!^'sa~O!]1zO!^)Vi~O!k8}O~O!k9OO~O!k9RO~O!k9RO~P%[Oa9TO~O!g9UO~O!k9VO~O!](wi!^(wi~P#BwOa%nO#`9_O'z%nO~O!](ty!k(tya(ty'z(ty~P!:tO!](jO!k(sy~O%i9bO~P&8fO!_'`O%i9bO~O#k$|qP$|qR$|q[$|qa$|qj$|qr$|q!S$|q!]$|q!l$|q!p$|q#R$|q#n$|q#o$|q#p$|q#q$|q#r$|q#s$|q#t$|q#u$|q#v$|q#x$|q#z$|q#{$|q'z$|q(a$|q(r$|q!k$|q!Y$|q'w$|q#`$|qv$|q!_$|q%i$|q!g$|q~P#/sO#k'jaP'jaR'ja['jaa'jaj'jar'ja!S'ja!l'ja!p'ja#R'ja#n'ja#o'ja#p'ja#q'ja#r'ja#s'ja#t'ja#u'ja#v'ja#x'ja#z'ja#{'ja'z'ja(a'ja(r'ja!k'ja!Y'ja'w'jav'ja!_'ja%i'ja!g'ja~P&5RO#k'laP'laR'la['laa'laj'lar'la!S'la!l'la!p'la#R'la#n'la#o'la#p'la#q'la#r'la#s'la#t'la#u'la#v'la#x'la#z'la#{'la'z'la(a'la(r'la!k'la!Y'la'w'lav'la!_'la%i'la!g'la~P&5tO#k%OqP%OqR%Oq[%Oqa%Oqj%Oqr%Oq!S%Oq!]%Oq!l%Oq!p%Oq#R%Oq#n%Oq#o%Oq#p%Oq#q%Oq#r%Oq#s%Oq#t%Oq#u%Oq#v%Oq#x%Oq#z%Oq#{%Oq'z%Oq(a%Oq(r%Oq!k%Oq!Y%Oq'w%Oq#`%Oqv%Oq!_%Oq%i%Oq!g%Oq~P#/sO!]'Yi!k'Yi~P!:tO$O#cq!]#cq!^#cq~P#BwO(y$}OP%aaR%aa[%aaj%aar%aa!S%aa!l%aa!p%aa#R%aa#n%aa#o%aa#p%aa#q%aa#r%aa#s%aa#t%aa#u%aa#v%aa#x%aa#z%aa#{%aa$O%aa(a%aa(r%aa!]%aa!^%aa~On%aa!Q%aa'y%aa(z%aa~P&IyO(z%POP%caR%ca[%caj%car%ca!S%ca!l%ca!p%ca#R%ca#n%ca#o%ca#p%ca#q%ca#r%ca#s%ca#t%ca#u%ca#v%ca#x%ca#z%ca#{%ca$O%ca(a%ca(r%ca!]%ca!^%ca~On%ca!Q%ca'y%ca(y%ca~P&LQOn>^O!Q*OO'y*PO(z%PO~P&IyOn>^O!Q*OO'y*PO(y$}O~P&LQOR0kO!Q0kO!S0lO#S$dOP}a[}aj}an}ar}a!l}a!p}a#R}a#n}a#o}a#p}a#q}a#r}a#s}a#t}a#u}a#v}a#x}a#z}a#{}a$O}a'y}a(a}a(r}a(y}a(z}a!]}a!^}a~O!Q*OO'y*POP$saR$sa[$saj$san$sar$sa!S$sa!l$sa!p$sa#R$sa#n$sa#o$sa#p$sa#q$sa#r$sa#s$sa#t$sa#u$sa#v$sa#x$sa#z$sa#{$sa$O$sa(a$sa(r$sa(y$sa(z$sa!]$sa!^$sa~O!Q*OO'y*POP$uaR$ua[$uaj$uan$uar$ua!S$ua!l$ua!p$ua#R$ua#n$ua#o$ua#p$ua#q$ua#r$ua#s$ua#t$ua#u$ua#v$ua#x$ua#z$ua#{$ua$O$ua(a$ua(r$ua(y$ua(z$ua!]$ua!^$ua~On>^O!Q*OO'y*PO(y$}O(z%PO~OP%TaR%Ta[%Taj%Tar%Ta!S%Ta!l%Ta!p%Ta#R%Ta#n%Ta#o%Ta#p%Ta#q%Ta#r%Ta#s%Ta#t%Ta#u%Ta#v%Ta#x%Ta#z%Ta#{%Ta$O%Ta(a%Ta(r%Ta!]%Ta!^%Ta~P''VO$O$mq!]$mq!^$mq~P#BwO$O$oq!]$oq!^$oq~P#BwO!^9oO~O$O9pO~P!1WO!g#vO!]'ei!k'ei~O!g#vO(r'pO!]'ei!k'ei~O!]/pO!k)Oq~O!Y'gi!]'gi~P#/sO!]/yO!Y)Pq~Or9wO!g#vO(r'pO~O[9yO!Y9xO~P#/sO!Y9xO~Oj:PO!g#vO~Og(_y!](_y~P!1WO!]'na!_'na~P#/sOa%[q!_%[q'z%[q!]%[q~P#/sO[:UO~O!]1TO!^)Xq~O`:YO~O#`:ZO!]'pa!^'pa~O!]5uO!^)Ui~P#BwO!S:]O~O!_1oO%i:`O~O(VTO(YUO(e:eO~O!]1zO!^)Vq~O!k:hO~O!k:iO~O!k:jO~O!k:jO~P%[O#`:mO!]#hy!^#hy~O!]#hy!^#hy~P#BwO%i:rO~P&8fO!_'`O%i:rO~O$O#|y!]#|y!^#|y~P#BwOP$|iR$|i[$|ij$|ir$|i!S$|i!l$|i!p$|i#R$|i#n$|i#o$|i#p$|i#q$|i#r$|i#s$|i#t$|i#u$|i#v$|i#x$|i#z$|i#{$|i$O$|i(a$|i(r$|i!]$|i!^$|i~P''VO!Q*OO'y*PO(z%POP'iaR'ia['iaj'ian'iar'ia!S'ia!l'ia!p'ia#R'ia#n'ia#o'ia#p'ia#q'ia#r'ia#s'ia#t'ia#u'ia#v'ia#x'ia#z'ia#{'ia$O'ia(a'ia(r'ia(y'ia!]'ia!^'ia~O!Q*OO'y*POP'kaR'ka['kaj'kan'kar'ka!S'ka!l'ka!p'ka#R'ka#n'ka#o'ka#p'ka#q'ka#r'ka#s'ka#t'ka#u'ka#v'ka#x'ka#z'ka#{'ka$O'ka(a'ka(r'ka(y'ka(z'ka!]'ka!^'ka~O(y$}OP%aiR%ai[%aij%ain%air%ai!Q%ai!S%ai!l%ai!p%ai#R%ai#n%ai#o%ai#p%ai#q%ai#r%ai#s%ai#t%ai#u%ai#v%ai#x%ai#z%ai#{%ai$O%ai'y%ai(a%ai(r%ai(z%ai!]%ai!^%ai~O(z%POP%ciR%ci[%cij%cin%cir%ci!Q%ci!S%ci!l%ci!p%ci#R%ci#n%ci#o%ci#p%ci#q%ci#r%ci#s%ci#t%ci#u%ci#v%ci#x%ci#z%ci#{%ci$O%ci'y%ci(a%ci(r%ci(y%ci!]%ci!^%ci~O$O$oy!]$oy!^$oy~P#BwO$O#cy!]#cy!^#cy~P#BwO!g#vO!]'eq!k'eq~O!]/pO!k)Oy~O!Y'gq!]'gq~P#/sOr:|O!g#vO(r'pO~O[;QO!Y;PO~P#/sO!Y;PO~Og(_!R!](_!R~P!1WOa%[y!_%[y'z%[y!]%[y~P#/sO!]1TO!^)Xy~O!]5uO!^)Uq~O(T;XO~O!_1oO%i;[O~O!k;_O~O%i;dO~P&8fOP$|qR$|q[$|qj$|qr$|q!S$|q!l$|q!p$|q#R$|q#n$|q#o$|q#p$|q#q$|q#r$|q#s$|q#t$|q#u$|q#v$|q#x$|q#z$|q#{$|q$O$|q(a$|q(r$|q!]$|q!^$|q~P''VO!Q*OO'y*PO(z%POP'jaR'ja['jaj'jan'jar'ja!S'ja!l'ja!p'ja#R'ja#n'ja#o'ja#p'ja#q'ja#r'ja#s'ja#t'ja#u'ja#v'ja#x'ja#z'ja#{'ja$O'ja(a'ja(r'ja(y'ja!]'ja!^'ja~O!Q*OO'y*POP'laR'la['laj'lan'lar'la!S'la!l'la!p'la#R'la#n'la#o'la#p'la#q'la#r'la#s'la#t'la#u'la#v'la#x'la#z'la#{'la$O'la(a'la(r'la(y'la(z'la!]'la!^'la~OP%OqR%Oq[%Oqj%Oqr%Oq!S%Oq!l%Oq!p%Oq#R%Oq#n%Oq#o%Oq#p%Oq#q%Oq#r%Oq#s%Oq#t%Oq#u%Oq#v%Oq#x%Oq#z%Oq#{%Oq$O%Oq(a%Oq(r%Oq!]%Oq!^%Oq~P''VOg%e!Z!]%e!Z#`%e!Z$O%e!Z~P!1WO!Y;hO~P#/sOr;iO!g#vO(r'pO~O[;kO!Y;hO~P#/sO!]'pq!^'pq~P#BwO!]#h!Z!^#h!Z~P#BwO#k%e!ZP%e!ZR%e!Z[%e!Za%e!Zj%e!Zr%e!Z!S%e!Z!]%e!Z!l%e!Z!p%e!Z#R%e!Z#n%e!Z#o%e!Z#p%e!Z#q%e!Z#r%e!Z#s%e!Z#t%e!Z#u%e!Z#v%e!Z#x%e!Z#z%e!Z#{%e!Z'z%e!Z(a%e!Z(r%e!Z!k%e!Z!Y%e!Z'w%e!Z#`%e!Zv%e!Z!_%e!Z%i%e!Z!g%e!Z~P#/sOr;tO!g#vO(r'pO~O!Y;uO~P#/sOr;|O!g#vO(r'pO~O!Y;}O~P#/sOP%e!ZR%e!Z[%e!Zj%e!Zr%e!Z!S%e!Z!l%e!Z!p%e!Z#R%e!Z#n%e!Z#o%e!Z#p%e!Z#q%e!Z#r%e!Z#s%e!Z#t%e!Z#u%e!Z#v%e!Z#x%e!Z#z%e!Z#{%e!Z$O%e!Z(a%e!Z(r%e!Z!]%e!Z!^%e!Z~P''VOr<QO!g#vO(r'pO~Ov(fX~P1qO!Q%rO~P!)[O(U!lO~P!)[O!YfX!]fX#`fX~P%2OOP]XR]X[]Xj]Xr]X!Q]X!S]X!]]X!]fX!l]X!p]X#R]X#S]X#`]X#`fX#kfX#n]X#o]X#p]X#q]X#r]X#s]X#t]X#u]X#v]X#x]X#z]X#{]X$Q]X(a]X(r]X(y]X(z]X~O!gfX!k]X!kfX(rfX~P'LTOP<UOQ<UOSfOd>ROe!iOpkOr<UOskOtkOzkO|<UO!O<UO!SWO!WkO!XkO!_XO!i<XO!lZO!o<UO!p<UO!q<UO!s<YO!u<]O!x!hO$W!kO$n>PO(T)]O(VTO(YUO(aVO(o[O~O!]<iO!^$qa~Oh%VOp%WOr%XOs$tOt$tOz%YO|%ZO!O<tO!S${O!_$|O!i>WO!l$xO#j<zO$W%`O$t<vO$v<xO$y%aO(T(vO(VTO(YUO(a$uO(y$}O(z%PO~Ol)dO~P(!yOr!eX(r!eX~P#!iOr(jX(r(jX~P##[O!^]X!^fX~P'LTO!YfX!Y$zX!]fX!]$zX#`fX~P!0SO#k<^O~O!g#vO#k<^O~O#`<nO~Oj<bO~O#`=OO!](wX!^(wX~O#`<nO!](uX!^(uX~O#k=PO~Og=RO~P!1WO#k=XO~O#k=YO~Og=RO(T&ZO~O!g#vO#k=ZO~O!g#vO#k=PO~O$O=[O~P#BwO#k=]O~O#k=^O~O#k=cO~O#k=dO~O#k=eO~O#k=fO~O$O=gO~P!1WO$O=hO~P!1WOl=sO~P7eOk#S#T#U#W#X#[#i#j#u$n$t$v$y%]%^%h%i%j%q%s%v%w%y%{~(OT#o!X'|(U#ps#n#qr!Q'}$]'}(T$_(e~",goto:"$9Y)]PPPPPP)^PP)aP)rP+W/]PPPP6mPP7TPP=QPPP@tPA^PA^PPPA^PCfPA^PA^PA^PCjPCoPD^PIWPPPI[PPPPI[L_PPPLeMVPI[PI[PP! eI[PPPI[PI[P!#lI[P!'S!(X!(bP!)U!)Y!)U!,gPPPPPPP!-W!(XPP!-h!/YP!2iI[I[!2n!5z!:h!:h!>gPPP!>oI[PPPPPPPPP!BOP!C]PPI[!DnPI[PI[I[I[I[I[PI[!FQP!I[P!LbP!Lf!Lp!Lt!LtP!IXP!Lx!LxP#!OP#!SI[PI[#!Y#%_CjA^PA^PA^A^P#&lA^A^#)OA^#+vA^#.SA^A^#.r#1W#1W#1]#1f#1W#1qPP#1WPA^#2ZA^#6YA^A^6mPPP#:_PPP#:x#:xP#:xP#;`#:xPP#;fP#;]P#;]#;y#;]#<e#<k#<n)aP#<q)aP#<z#<z#<zP)aP)aP)aP)aPP)aP#=Q#=TP#=T)aP#=XP#=[P)aP)aP)aP)aP)aP)a)aPP#=b#=h#=s#=y#>P#>V#>]#>k#>q#>{#?R#?]#?c#?s#?y#@k#@}#AT#AZ#Ai#BO#Cs#DR#DY#Et#FS#Gt#HS#HY#H`#Hf#Hp#Hv#H|#IW#Ij#IpPPPPPPPPPPP#IvPPPPPPP#Jk#Mx$ b$ i$ qPPP$']P$'f$*_$0x$0{$1O$1}$2Q$2X$2aP$2g$2jP$3W$3[$4S$5b$5g$5}PP$6S$6Y$6^$6a$6e$6i$7e$7|$8e$8i$8l$8o$8y$8|$9Q$9UR!|RoqOXst!Z#d%m&r&t&u&w,s,x2[2_Y!vQ'`-e1o5{Q%tvQ%|yQ&T|Q&j!VS'W!e-]Q'f!iS'l!r!yU*k$|*Z*oQ+o%}S+|&V&WQ,d&dQ-c'_Q-m'gQ-u'mQ0[*qQ1b,OQ1y,eR<{<Y%SdOPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$_$a$e%m%t&R&k&n&r&t&u&w&{'T'b'r(T(V(](d(x(z)O)}*i+X+],p,s,x-i-q.P.V.t.{/n0]0l0r1S1r2S2T2V2X2[2_2a3Q3W3l4z6T6e6f6i6|8t9T9_S#q]<V!r)_$Z$n'X)s-U-X/V2p4T5w6s:Z:m<U<X<Y<]<^<_<`<a<b<c<d<e<f<g<h<i<k<n<{=O=P=R=Z=[=e=f>SU+P%]<s<tQ+t&PQ,f&gQ,m&oQ0x+gQ0}+iQ1Y+uQ2R,kQ3`.gQ5`0|Q5f1TQ6[1zQ7Y3dQ8`5gR9e7['QkOPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$Z$_$a$e$n%m%t&R&k&n&o&r&t&u&w&{'T'X'b'r(T(V(](d(x(z)O)s)}*i+X+]+g,p,s,x-U-X-i-q.P.V.g.t.{/V/n0]0l0r1S1r2S2T2V2X2[2_2a2p3Q3W3d3l4T4z5w6T6e6f6i6s6|7[8t9T9_:Z:m<U<X<Y<]<^<_<`<a<b<c<d<e<f<g<h<i<k<n<{=O=P=R=Z=[=e=f>S!S!nQ!r!v!y!z$|'W'_'`'l'm'n*k*o*q*r-]-c-e-u0[0_1o5{5}%[$ti#v$b$c$d$x${%O%Q%^%_%c)y*R*T*V*Y*a*g*w*x+f+i,S,V.f/P/d/m/x/y/{0`0b0i0j0o1f1i1q3c4^4_4j4o5Q5[5_6S7W7v8Q8V8[8q9b9p9y:P:`:r;Q;[;d;k<l<m<o<p<q<r<u<v<w<x<y<z=S=T=U=V=X=Y=]=^=_=`=a=b=c=d=g=h>P>X>Y>]>^Q&X|Q'U!eS'[%i-`Q+t&PQ,P&WQ,f&gQ0n+SQ1Y+uQ1_+{Q2Q,jQ2R,kQ5f1TQ5o1aQ6[1zQ6_1|Q6`2PQ8`5gQ8c5lQ8|6bQ:X8dQ:f8yQ;V:YR<}*ZrnOXst!V!Z#d%m&i&r&t&u&w,s,x2[2_R,h&k&z^OPXYstuvwz!Z!`!g!j!o#S#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$Z$_$a$e$n%m%t&R&k&n&o&r&t&u&w&{'T'b'r(V(](d(x(z)O)s)}*i+X+]+g,p,s,x-U-X-i-q.P.V.g.t.{/V/n0]0l0r1S1r2S2T2V2X2[2_2a2p3Q3W3d3l4T4z5w6T6e6f6i6s6|7[8t9T9_:Z:m<U<X<Y<]<^<_<`<a<b<c<d<e<f<g<h<i<k<n<{=O=P=R=Z=[=e=f>R>S[#]WZ#W#Z'X(T!b%jm#h#i#l$x%e%h(^(h(i(j*Y*^*b+Z+[+^,o-V.T.Z.[.]._/m/p2d3[3]4a6r7TQ%wxQ%{yW&Q|&V&W,OQ&_!TQ'c!hQ'e!iQ(q#sS+n%|%}Q+r&PQ,_&bQ,c&dS-l'f'gQ.i(rQ1R+oQ1X+uQ1Z+vQ1^+zQ1t,`S1x,d,eQ2|-mQ5e1TQ5i1WQ5n1`Q6Z1yQ8_5gQ8b5kQ8f5pQ:T8^R;T:U!U$zi$d%O%Q%^%_%c*R*T*a*w*x/P/x0`0b0i0j0o4_5Q8V9p>P>X>Y!^%yy!i!u%{%|%}'V'e'f'g'k'u*j+n+o-Y-l-m-t0R0U1R2u2|3T4r4s4v7}9{Q+h%wQ,T&[Q,W&]Q,b&dQ.h(qQ1s,_U1w,c,d,eQ3e.iQ6U1tS6Y1x1yQ8x6Z#f>T#v$b$c$x${)y*V*Y*g+f+i,S,V.f/d/m/y/{1f1i1q3c4^4j4o5[5_6S7W7v8Q8[8q9b9y:P:`:r;Q;[;d;k<o<q<u<w<y=S=U=X=]=_=a=c=g>]>^o>U<l<m<p<r<v<x<z=T=V=Y=^=`=b=d=hW%Ti%V*y>PS&[!Q&iQ&]!RQ&^!SU*}%[%d=sR,R&Y%]%Si#v$b$c$d$x${%O%Q%^%_%c)y*R*T*V*Y*a*g*w*x+f+i,S,V.f/P/d/m/x/y/{0`0b0i0j0o1f1i1q3c4^4_4j4o5Q5[5_6S7W7v8Q8V8[8q9b9p9y:P:`:r;Q;[;d;k<l<m<o<p<q<r<u<v<w<x<y<z=S=T=U=V=X=Y=]=^=_=`=a=b=c=d=g=h>P>X>Y>]>^T)z$u){V+P%]<s<tW'[!e%i*Z-`S(}#y#zQ+c%rQ+y&SS.b(m(nQ1j,XQ5T0kR8i5u'QkOPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$Z$_$a$e$n%m%t&R&k&n&o&r&t&u&w&{'T'X'b'r(T(V(](d(x(z)O)s)}*i+X+]+g,p,s,x-U-X-i-q.P.V.g.t.{/V/n0]0l0r1S1r2S2T2V2X2[2_2a2p3Q3W3d3l4T4z5w6T6e6f6i6s6|7[8t9T9_:Z:m<U<X<Y<]<^<_<`<a<b<c<d<e<f<g<h<i<k<n<{=O=P=R=Z=[=e=f>S$i$^c#Y#e%q%s%u(S(Y(t(y)R)S)T)U)V)W)X)Y)Z)[)^)`)b)g)q+d+x-Z-x-}.S.U.s.v.z.|.}/O/b0p2k2n3O3V3k3p3q3r3s3t3u3v3w3x3y3z3{3|4P4Q4X5X5c6u6{7Q7a7b7k7l8k9X9]9g9m9n:o;W;`<W=vT#TV#U'RkOPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$Z$_$a$e$n%m%t&R&k&n&o&r&t&u&w&{'T'X'b'r(T(V(](d(x(z)O)s)}*i+X+]+g,p,s,x-U-X-i-q.P.V.g.t.{/V/n0]0l0r1S1r2S2T2V2X2[2_2a2p3Q3W3d3l4T4z5w6T6e6f6i6s6|7[8t9T9_:Z:m<U<X<Y<]<^<_<`<a<b<c<d<e<f<g<h<i<k<n<{=O=P=R=Z=[=e=f>SQ'Y!eR2q-]!W!nQ!e!r!v!y!z$|'W'_'`'l'm'n*Z*k*o*q*r-]-c-e-u0[0_1o5{5}R1l,ZnqOXst!Z#d%m&r&t&u&w,s,x2[2_Q&y!^Q'v!xS(s#u<^Q+l%zQ,]&_Q,^&aQ-j'dQ-w'oS.r(x=PS0q+X=ZQ1P+mQ1n,[Q2c,zQ2e,{Q2m-WQ2z-kQ2}-oS5Y0r=eQ5a1QS5d1S=fQ6t2oQ6x2{Q6}3SQ8]5bQ9Y6vQ9Z6yQ9^7OR:l9V$d$]c#Y#e%s%u(S(Y(t(y)R)S)T)U)V)W)X)Y)Z)[)^)`)b)g)q+d+x-Z-x-}.S.U.s.v.z.}/O/b0p2k2n3O3V3k3p3q3r3s3t3u3v3w3x3y3z3{3|4P4Q4X5X5c6u6{7Q7a7b7k7l8k9X9]9g9m9n:o;W;`<W=vS(o#p'iQ)P#zS+b%q.|S.c(n(pR3^.d'QkOPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$Z$_$a$e$n%m%t&R&k&n&o&r&t&u&w&{'T'X'b'r(T(V(](d(x(z)O)s)}*i+X+]+g,p,s,x-U-X-i-q.P.V.g.t.{/V/n0]0l0r1S1r2S2T2V2X2[2_2a2p3Q3W3d3l4T4z5w6T6e6f6i6s6|7[8t9T9_:Z:m<U<X<Y<]<^<_<`<a<b<c<d<e<f<g<h<i<k<n<{=O=P=R=Z=[=e=f>SS#q]<VQ&t!XQ&u!YQ&w![Q&x!]R2Z,vQ'a!hQ+e%wQ-h'cS.e(q+hQ2x-gW3b.h.i0w0yQ6w2yW7U3_3a3e5^U9a7V7X7ZU:q9c9d9fS;b:p:sQ;p;cR;x;qU!wQ'`-eT5y1o5{!Q_OXZ`st!V!Z#d#h%e%m&i&k&r&t&u&w(j,s,x.[2[2_]!pQ!r'`-e1o5{T#q]<V%^{OPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$_$a$e%m%t&R&k&n&o&r&t&u&w&{'T'b'r(T(V(](d(x(z)O)}*i+X+]+g,p,s,x-i-q.P.V.g.t.{/n0]0l0r1S1r2S2T2V2X2[2_2a3Q3W3d3l4z6T6e6f6i6|7[8t9T9_S(}#y#zS.b(m(n!s=l$Z$n'X)s-U-X/V2p4T5w6s:Z:m<U<X<Y<]<^<_<`<a<b<c<d<e<f<g<h<i<k<n<{=O=P=R=Z=[=e=f>SU$fd)_,mS(p#p'iU*v%R(w4OU0m+O.n7gQ5^0xQ7V3`Q9d7YR:s9em!tQ!r!v!y!z'`'l'm'n-e-u1o5{5}Q't!uS(f#g2US-s'k'wQ/s*]Q0R*jQ3U-vQ4f/tQ4r0TQ4s0UQ4x0^Q7r4`S7}4t4vS8R4y4{Q9r7sQ9v7yQ9{8OQ:Q8TS:{9w9xS;g:|;PS;s;h;iS;{;t;uS<P;|;}R<S<QQ#wbQ's!uS(e#g2US(g#m+WQ+Y%fQ+j%xQ+p&OU-r'k't'wQ.W(fU/r*]*`/wQ0S*jQ0V*lQ1O+kQ1u,aS3R-s-vQ3Z.`S4e/s/tQ4n0PS4q0R0^Q4u0WQ6W1vQ7P3US7q4`4bQ7u4fU7|4r4x4{Q8P4wQ8v6XS9q7r7sQ9u7yQ9}8RQ:O8SQ:c8wQ:y9rS:z9v9xQ;S:QQ;^:dS;f:{;PS;r;g;hS;z;s;uS<O;{;}Q<R<PQ<T<SQ=o=jQ={=tR=|=uV!wQ'`-e%^aOPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$_$a$e%m%t&R&k&n&o&r&t&u&w&{'T'b'r(T(V(](d(x(z)O)}*i+X+]+g,p,s,x-i-q.P.V.g.t.{/n0]0l0r1S1r2S2T2V2X2[2_2a3Q3W3d3l4z6T6e6f6i6|7[8t9T9_S#wz!j!r=i$Z$n'X)s-U-X/V2p4T5w6s:Z:m<U<X<Y<]<^<_<`<a<b<c<d<e<f<g<h<i<k<n<{=O=P=R=Z=[=e=f>SR=o>R%^bOPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$_$a$e%m%t&R&k&n&o&r&t&u&w&{'T'b'r(T(V(](d(x(z)O)}*i+X+]+g,p,s,x-i-q.P.V.g.t.{/n0]0l0r1S1r2S2T2V2X2[2_2a3Q3W3d3l4z6T6e6f6i6|7[8t9T9_Q%fj!^%xy!i!u%{%|%}'V'e'f'g'k'u*j+n+o-Y-l-m-t0R0U1R2u2|3T4r4s4v7}9{S&Oz!jQ+k%yQ,a&dW1v,b,c,d,eU6X1w1x1yS8w6Y6ZQ:d8x!r=j$Z$n'X)s-U-X/V2p4T5w6s:Z:m<U<X<Y<]<^<_<`<a<b<c<d<e<f<g<h<i<k<n<{=O=P=R=Z=[=e=f>SQ=t>QR=u>R%QeOPXYstuvw!Z!`!g!o#S#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$_$a$e%m%t&R&k&n&r&t&u&w&{'T'b'r(V(](d(x(z)O)}*i+X+]+g,p,s,x-i-q.P.V.g.t.{/n0]0l0r1S1r2S2T2V2X2[2_2a3Q3W3d3l4z6T6e6f6i6|7[8t9T9_Y#bWZ#W#Z(T!b%jm#h#i#l$x%e%h(^(h(i(j*Y*^*b+Z+[+^,o-V.T.Z.[.]._/m/p2d3[3]4a6r7TQ,n&o!p=k$Z$n)s-U-X/V2p4T5w6s:Z:m<U<X<Y<]<^<_<`<a<b<c<d<e<f<g<h<i<k<n<{=O=P=R=Z=[=e=f>SR=n'XU']!e%i*ZR2s-`%SdOPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$_$a$e%m%t&R&k&n&r&t&u&w&{'T'b'r(T(V(](d(x(z)O)}*i+X+],p,s,x-i-q.P.V.t.{/n0]0l0r1S1r2S2T2V2X2[2_2a3Q3W3l4z6T6e6f6i6|8t9T9_!r)_$Z$n'X)s-U-X/V2p4T5w6s:Z:m<U<X<Y<]<^<_<`<a<b<c<d<e<f<g<h<i<k<n<{=O=P=R=Z=[=e=f>SQ,m&oQ0x+gQ3`.gQ7Y3dR9e7[!b$Tc#Y%q(S(Y(t(y)Z)[)`)g+x-x-}.S.U.s.v/b0p3O3V3k3{5X5c6{7Q7a9]:o<W!P<d)^)q-Z.|2k2n3p3y3z4P4X6u7b7k7l8k9X9g9m9n;W;`=v!f$Vc#Y%q(S(Y(t(y)W)X)Z)[)`)g+x-x-}.S.U.s.v/b0p3O3V3k3{5X5c6{7Q7a9]:o<W!T<f)^)q-Z.|2k2n3p3v3w3y3z4P4X6u7b7k7l8k9X9g9m9n;W;`=v!^$Zc#Y%q(S(Y(t(y)`)g+x-x-}.S.U.s.v/b0p3O3V3k3{5X5c6{7Q7a9]:o<WQ4_/kz>S)^)q-Z.|2k2n3p4P4X6u7b7k7l8k9X9g9m9n;W;`=vQ>X>ZR>Y>['QkOPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$Z$_$a$e$n%m%t&R&k&n&o&r&t&u&w&{'T'X'b'r(T(V(](d(x(z)O)s)}*i+X+]+g,p,s,x-U-X-i-q.P.V.g.t.{/V/n0]0l0r1S1r2S2T2V2X2[2_2a2p3Q3W3d3l4T4z5w6T6e6f6i6s6|7[8t9T9_:Z:m<U<X<Y<]<^<_<`<a<b<c<d<e<f<g<h<i<k<n<{=O=P=R=Z=[=e=f>SS$oh$pR4U/U'XgOPWXYZhstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$Z$_$a$e$n$p%m%t&R&k&n&o&r&t&u&w&{'T'X'b'r(T(V(](d(x(z)O)s)}*i+X+]+g,p,s,x-U-X-i-q.P.V.g.t.{/U/V/n0]0l0r1S1r2S2T2V2X2[2_2a2p3Q3W3d3l4T4z5w6T6e6f6i6s6|7[8t9T9_:Z:m<U<X<Y<]<^<_<`<a<b<c<d<e<f<g<h<i<k<n<{=O=P=R=Z=[=e=f>ST$kf$qQ$ifS)j$l)nR)v$qT$jf$qT)l$l)n'XhOPWXYZhstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$Z$_$a$e$n$p%m%t&R&k&n&o&r&t&u&w&{'T'X'b'r(T(V(](d(x(z)O)s)}*i+X+]+g,p,s,x-U-X-i-q.P.V.g.t.{/U/V/n0]0l0r1S1r2S2T2V2X2[2_2a2p3Q3W3d3l4T4z5w6T6e6f6i6s6|7[8t9T9_:Z:m<U<X<Y<]<^<_<`<a<b<c<d<e<f<g<h<i<k<n<{=O=P=R=Z=[=e=f>ST$oh$pQ$rhR)u$p%^jOPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$_$a$e%m%t&R&k&n&o&r&t&u&w&{'T'b'r(T(V(](d(x(z)O)}*i+X+]+g,p,s,x-i-q.P.V.g.t.{/n0]0l0r1S1r2S2T2V2X2[2_2a3Q3W3d3l4z6T6e6f6i6|7[8t9T9_!s>Q$Z$n'X)s-U-X/V2p4T5w6s:Z:m<U<X<Y<]<^<_<`<a<b<c<d<e<f<g<h<i<k<n<{=O=P=R=Z=[=e=f>S#glOPXZst!Z!`!o#S#d#o#{$n%m&k&n&o&r&t&u&w&{'T'b)O)s*i+]+g,p,s,x-i.g/V/n0]0l1r2S2T2V2X2[2_2a3d4T4z6T6e6f6i7[8t9T!U%Ri$d%O%Q%^%_%c*R*T*a*w*x/P/x0`0b0i0j0o4_5Q8V9p>P>X>Y#f(w#v$b$c$x${)y*V*Y*g+f+i,S,V.f/d/m/y/{1f1i1q3c4^4j4o5[5_6S7W7v8Q8[8q9b9y:P:`:r;Q;[;d;k<o<q<u<w<y=S=U=X=]=_=a=c=g>]>^Q+T%aQ/c*Oo4O<l<m<p<r<v<x<z=T=V=Y=^=`=b=d=h!U$yi$d%O%Q%^%_%c*R*T*a*w*x/P/x0`0b0i0j0o4_5Q8V9p>P>X>YQ*c$zU*l$|*Z*oQ+U%bQ0W*m#f=q#v$b$c$x${)y*V*Y*g+f+i,S,V.f/d/m/y/{1f1i1q3c4^4j4o5[5_6S7W7v8Q8[8q9b9y:P:`:r;Q;[;d;k<o<q<u<w<y=S=U=X=]=_=a=c=g>]>^n=r<l<m<p<r<v<x<z=T=V=Y=^=`=b=d=hQ=w>TQ=x>UQ=y>VR=z>W!U%Ri$d%O%Q%^%_%c*R*T*a*w*x/P/x0`0b0i0j0o4_5Q8V9p>P>X>Y#f(w#v$b$c$x${)y*V*Y*g+f+i,S,V.f/d/m/y/{1f1i1q3c4^4j4o5[5_6S7W7v8Q8[8q9b9y:P:`:r;Q;[;d;k<o<q<u<w<y=S=U=X=]=_=a=c=g>]>^o4O<l<m<p<r<v<x<z=T=V=Y=^=`=b=d=hnoOXst!Z#d%m&r&t&u&w,s,x2[2_S*f${*YQ-R'OQ-S'QR4i/y%[%Si#v$b$c$d$x${%O%Q%^%_%c)y*R*T*V*Y*a*g*w*x+f+i,S,V.f/P/d/m/x/y/{0`0b0i0j0o1f1i1q3c4^4_4j4o5Q5[5_6S7W7v8Q8V8[8q9b9p9y:P:`:r;Q;[;d;k<l<m<o<p<q<r<u<v<w<x<y<z=S=T=U=V=X=Y=]=^=_=`=a=b=c=d=g=h>P>X>Y>]>^Q,U&]Q1h,WQ5s1gR8h5tV*n$|*Z*oU*n$|*Z*oT5z1o5{S0P*i/nQ4w0]T8S4z:]Q+j%xQ0V*lQ1O+kQ1u,aQ6W1vQ8v6XQ:c8wR;^:d!U%Oi$d%O%Q%^%_%c*R*T*a*w*x/P/x0`0b0i0j0o4_5Q8V9p>P>X>Yx*R$v)e*S*u+V/v0d0e4R4g5R5S5W7p8U:R:x=p=}>OS0`*t0a#f<o#v$b$c$x${)y*V*Y*g+f+i,S,V.f/d/m/y/{1f1i1q3c4^4j4o5[5_6S7W7v8Q8[8q9b9y:P:`:r;Q;[;d;k<o<q<u<w<y=S=U=X=]=_=a=c=g>]>^n<p<l<m<p<r<v<x<z=T=V=Y=^=`=b=d=h!d=S(u)c*[*e.j.m.q/_/k/|0v1e3h4[4h4l5r7]7`7w7z8X8Z9t9|:S:};R;e;j;v>Z>[`=T3}7c7f7j9h:t:w;yS=_.l3iT=`7e9k!U%Qi$d%O%Q%^%_%c*R*T*a*w*x/P/x0`0b0i0j0o4_5Q8V9p>P>X>Y|*T$v)e*U*t+V/g/v0d0e4R4g4|5R5S5W7p8U:R:x=p=}>OS0b*u0c#f<q#v$b$c$x${)y*V*Y*g+f+i,S,V.f/d/m/y/{1f1i1q3c4^4j4o5[5_6S7W7v8Q8[8q9b9y:P:`:r;Q;[;d;k<o<q<u<w<y=S=U=X=]=_=a=c=g>]>^n<r<l<m<p<r<v<x<z=T=V=Y=^=`=b=d=h!h=U(u)c*[*e.k.l.q/_/k/|0v1e3f3h4[4h4l5r7]7^7`7w7z8X8Z9t9|:S:};R;e;j;v>Z>[d=V3}7d7e7j9h9i:t:u:w;yS=a.m3jT=b7f9lrnOXst!V!Z#d%m&i&r&t&u&w,s,x2[2_Q&f!UR,p&ornOXst!V!Z#d%m&i&r&t&u&w,s,x2[2_R&f!UQ,Y&^R1d,RsnOXst!V!Z#d%m&i&r&t&u&w,s,x2[2_Q1p,_S6R1s1tU8p6P6Q6US:_8r8sS;Y:^:aQ;m;ZR;w;nQ&m!VR,i&iR6_1|R:f8yW&Q|&V&W,OR1Z+vQ&r!WR,s&sR,y&xT2],x2_R,}&yQ,|&yR2f,}Q'y!{R-y'ySsOtQ#dXT%ps#dQ#OTR'{#OQ#RUR'}#RQ){$uR/`){Q#UVR(Q#UQ#XWU(W#X(X.QQ(X#YR.Q(YQ-^'YR2r-^Q.u(yS3m.u3nR3n.vQ-e'`R2v-eY!rQ'`-e1o5{R'j!rQ/Q)eR4S/QU#_W%h*YU(_#_(`.RQ(`#`R.R(ZQ-a']R2t-at`OXst!V!Z#d%m&i&k&r&t&u&w,s,x2[2_S#hZ%eU#r`#h.[R.[(jQ(k#jQ.X(gW.a(k.X3X7RQ3X.YR7R3YQ)n$lR/W)nQ$phR)t$pQ$`cU)a$`-|<jQ-|<WR<j)qQ/q*]W4c/q4d7t9sU4d/r/s/tS7t4e4fR9s7u$e*Q$v(u)c)e*[*e*t*u+Q+R+V.l.m.o.p.q/_/g/i/k/v/|0d0e0v1e3f3g3h3}4R4[4g4h4l4|5O5R5S5W5r7]7^7_7`7e7f7h7i7j7p7w7z8U8X8Z9h9i9j9t9|:R:S:t:u:v:w:x:};R;e;j;v;y=p=}>O>Z>[Q/z*eU4k/z4m7xQ4m/|R7x4lS*o$|*ZR0Y*ox*S$v)e*t*u+V/v0d0e4R4g5R5S5W7p8U:R:x=p=}>O!d.j(u)c*[*e.l.m.q/_/k/|0v1e3h4[4h4l5r7]7`7w7z8X8Z9t9|:S:};R;e;j;v>Z>[U/h*S.j7ca7c3}7e7f7j9h:t:w;yQ0a*tQ3i.lU4}0a3i9kR9k7e|*U$v)e*t*u+V/g/v0d0e4R4g4|5R5S5W7p8U:R:x=p=}>O!h.k(u)c*[*e.l.m.q/_/k/|0v1e3f3h4[4h4l5r7]7^7`7w7z8X8Z9t9|:S:};R;e;j;v>Z>[U/j*U.k7de7d3}7e7f7j9h9i:t:u:w;yQ0c*uQ3j.mU5P0c3j9lR9l7fQ*z%UR0g*zQ5]0vR8Y5]Q+_%kR0u+_Q5v1jS8j5v:[R:[8kQ,[&_R1m,[Q5{1oR8m5{Q1{,fS6]1{8zR8z6_Q1U+rW5h1U5j8a:VQ5j1XQ8a5iR:V8bQ+w&QR1[+wQ2_,xR6m2_YrOXst#dQ&v!ZQ+a%mQ,r&rQ,t&tQ,u&uQ,w&wQ2Y,sS2],x2_R6l2[Q%opQ&z!_Q&}!aQ'P!bQ'R!cQ'q!uQ+`%lQ+l%zQ,Q&XQ,h&mQ-P&|W-p'k's't'wQ-w'oQ0X*nQ1P+mQ1c,PS2O,i,lQ2g-OQ2h-RQ2i-SQ2}-oW3P-r-s-v-xQ5a1QQ5m1_Q5q1eQ6V1uQ6a2QQ6k2ZU6z3O3R3UQ6}3SQ8]5bQ8e5oQ8g5rQ8l5zQ8u6WQ8{6`S9[6{7PQ9^7OQ:W8cQ:b8vQ:g8|Q:n9]Q;U:XQ;]:cQ;a:oQ;l;VR;o;^Q%zyQ'd!iQ'o!uU+m%{%|%}Q-W'VU-k'e'f'gS-o'k'uQ0Q*jS1Q+n+oQ2o-YS2{-l-mQ3S-tS4p0R0UQ5b1RQ6v2uQ6y2|Q7O3TU7{4r4s4vQ9z7}R;O9{S$wi>PR*{%VU%Ui%V>PR0f*yQ$viS(u#v+iS)c$b$cQ)e$dQ*[$xS*e${*YQ*t%OQ*u%QQ+Q%^Q+R%_Q+V%cQ.l<oQ.m<qQ.o<uQ.p<wQ.q<yQ/_)yQ/g*RQ/i*TQ/k*VQ/v*aS/|*g/mQ0d*wQ0e*xl0v+f,V.f1i1q3c6S7W8q9b:`:r;[;dQ1e,SQ3f=SQ3g=UQ3h=XS3}<l<mQ4R/PS4[/d4^Q4g/xQ4h/yQ4l/{Q4|0`Q5O0bQ5R0iQ5S0jQ5W0oQ5r1fQ7]=]Q7^=_Q7_=aQ7`=cQ7e<pQ7f<rQ7h<vQ7i<xQ7j<zQ7p4_Q7w4jQ7z4oQ8U5QQ8X5[Q8Z5_Q9h=YQ9i=TQ9j=VQ9t7vQ9|8QQ:R8VQ:S8[Q:t=^Q:u=`Q:v=bQ:w=dQ:x9pQ:}9yQ;R:PQ;e=gQ;j;QQ;v;kQ;y=hQ=p>PQ=}>XQ>O>YQ>Z>]R>[>^Q+O%]Q.n<sR7g<tnpOXst!Z#d%m&r&t&u&w,s,x2[2_Q!fPS#fZ#oQ&|!`W'h!o*i0]4zQ(P#SQ)Q#{Q)r$nS,l&k&nQ,q&oQ-O&{S-T'T/nQ-g'bQ.x)OQ/[)sQ0s+]Q0y+gQ2W,pQ2y-iQ3a.gQ4W/VQ5U0lQ6Q1rQ6c2SQ6d2TQ6h2VQ6j2XQ6o2aQ7Z3dQ7m4TQ8s6TQ9P6eQ9Q6fQ9S6iQ9f7[Q:a8tR:k9T#[cOPXZst!Z!`!o#d#o#{%m&k&n&o&r&t&u&w&{'T'b)O*i+]+g,p,s,x-i.g/n0]0l1r2S2T2V2X2[2_2a3d4z6T6e6f6i7[8t9TQ#YWQ#eYQ%quQ%svS%uw!gS(S#W(VQ(Y#ZQ(t#uQ(y#xQ)R$OQ)S$PQ)T$QQ)U$RQ)V$SQ)W$TQ)X$UQ)Y$VQ)Z$WQ)[$XQ)^$ZQ)`$_Q)b$aQ)g$eW)q$n)s/V4TQ+d%tQ+x&RS-Z'X2pQ-x'rS-}(T.PQ.S(]Q.U(dQ.s(xQ.v(zQ.z<UQ.|<XQ.}<YQ/O<]Q/b)}Q0p+XQ2k-UQ2n-XQ3O-qQ3V.VQ3k.tQ3p<^Q3q<_Q3r<`Q3s<aQ3t<bQ3u<cQ3v<dQ3w<eQ3x<fQ3y<gQ3z<hQ3{.{Q3|<kQ4P<nQ4Q<{Q4X<iQ5X0rQ5c1SQ6u=OQ6{3QQ7Q3WQ7a3lQ7b=PQ7k=RQ7l=ZQ8k5wQ9X6sQ9]6|Q9g=[Q9m=eQ9n=fQ:o9_Q;W:ZQ;`:mQ<W#SR=v>SR#[WR'Z!el!tQ!r!v!y!z'`'l'm'n-e-u1o5{5}S'V!e-]U*j$|*Z*oS-Y'W'_S0U*k*qQ0^*rQ2u-cQ4v0[R4{0_R({#xQ!fQT-d'`-e]!qQ!r'`-e1o5{Q#p]R'i<VR)f$dY!uQ'`-e1o5{Q'k!rS'u!v!yS'w!z5}S-t'l'mQ-v'nR3T-uT#kZ%eS#jZ%eS%km,oU(g#h#i#lS.Y(h(iQ.^(jQ0t+^Q3Y.ZU3Z.[.]._S7S3[3]R9`7Td#^W#W#Z%h(T(^*Y+Z.T/mr#gZm#h#i#l%e(h(i(j+^.Z.[.]._3[3]7TS*]$x*bQ/t*^Q2U,oQ2l-VQ4`/pQ6q2dQ7s4aQ9W6rT=m'X+[V#aW%h*YU#`W%h*YS(U#W(^U(Z#Z+Z/mS-['X+[T.O(T.TV'^!e%i*ZQ$lfR)x$qT)m$l)nR4V/UT*_$x*bT*h${*YQ0w+fQ1g,VQ3_.fQ5t1iQ6P1qQ7X3cQ8r6SQ9c7WQ:^8qQ:p9bQ;Z:`Q;c:rQ;n;[R;q;dnqOXst!Z#d%m&r&t&u&w,s,x2[2_Q&l!VR,h&itmOXst!U!V!Z#d%m&i&r&t&u&w,s,x2[2_R,o&oT%lm,oR1k,XR,g&gQ&U|S+}&V&WR1^,OR+s&PT&p!W&sT&q!W&sT2^,x2_",nodeNames:"⚠ ArithOp ArithOp ?. JSXStartTag LineComment BlockComment Script Hashbang ExportDeclaration export Star as VariableName String Escape from ; default FunctionDeclaration async function VariableDefinition > < TypeParamList in out const TypeDefinition extends ThisType this LiteralType ArithOp Number BooleanLiteral TemplateType InterpolationEnd Interpolation InterpolationStart NullType null VoidType void TypeofType typeof MemberExpression . PropertyName [ TemplateString Escape Interpolation super RegExp ] ArrayExpression Spread , } { ObjectExpression Property async get set PropertyDefinition Block : NewTarget new NewExpression ) ( ArgList UnaryExpression delete LogicOp BitOp YieldExpression yield AwaitExpression await ParenthesizedExpression ClassExpression class ClassBody MethodDeclaration Decorator @ MemberExpression PrivatePropertyName CallExpression TypeArgList CompareOp < declare Privacy static abstract override PrivatePropertyDefinition PropertyDeclaration readonly accessor Optional TypeAnnotation Equals StaticBlock FunctionExpression ArrowFunction ParamList ParamList ArrayPattern ObjectPattern PatternProperty Privacy readonly Arrow MemberExpression BinaryExpression ArithOp ArithOp ArithOp ArithOp BitOp CompareOp instanceof satisfies CompareOp BitOp BitOp BitOp LogicOp LogicOp ConditionalExpression LogicOp LogicOp AssignmentExpression UpdateOp PostfixExpression CallExpression InstantiationExpression TaggedTemplateExpression DynamicImport import ImportMeta JSXElement JSXSelfCloseEndTag JSXSelfClosingTag JSXIdentifier JSXBuiltin JSXIdentifier JSXNamespacedName JSXMemberExpression JSXSpreadAttribute JSXAttribute JSXAttributeValue JSXEscape JSXEndTag JSXOpenTag JSXFragmentTag JSXText JSXEscape JSXStartCloseTag JSXCloseTag PrefixCast < ArrowFunction TypeParamList SequenceExpression InstantiationExpression KeyofType keyof UniqueType unique ImportType InferredType infer TypeName ParenthesizedType FunctionSignature ParamList NewSignature IndexedType TupleType Label ArrayType ReadonlyType ObjectType MethodType PropertyType IndexSignature PropertyDefinition CallSignature TypePredicate asserts is NewSignature new UnionType LogicOp IntersectionType LogicOp ConditionalType ParameterizedType ClassDeclaration abstract implements type VariableDeclaration let var using TypeAliasDeclaration InterfaceDeclaration interface EnumDeclaration enum EnumBody NamespaceDeclaration namespace module AmbientDeclaration declare GlobalDeclaration global ClassDeclaration ClassBody AmbientFunctionDeclaration ExportGroup VariableName VariableName ImportDeclaration defer ImportGroup ForStatement for ForSpec ForInSpec ForOfSpec of WhileStatement while WithStatement with DoStatement do IfStatement if else SwitchStatement switch SwitchBody CaseLabel case DefaultLabel TryStatement try CatchClause catch FinallyClause finally ReturnStatement return ThrowStatement throw BreakStatement break ContinueStatement continue DebuggerStatement debugger LabeledStatement ExpressionStatement SingleExpression SingleClassItem",maxTerm:380,context:oY,nodeProps:[["isolate",-8,5,6,14,37,39,51,53,55,""],["group",-26,9,17,19,68,207,211,215,216,218,221,224,234,237,243,245,247,249,252,258,264,266,268,270,272,274,275,"Statement",-34,13,14,32,35,36,42,51,54,55,57,62,70,72,76,80,82,84,85,110,111,120,121,136,139,141,142,143,144,145,147,148,167,169,171,"Expression",-23,31,33,37,41,43,45,173,175,177,178,180,181,182,184,185,186,188,189,190,201,203,205,206,"Type",-3,88,103,109,"ClassItem"],["openedBy",23,"<",38,"InterpolationStart",56,"[",60,"{",73,"(",160,"JSXStartCloseTag"],["closedBy",-2,24,168,">",40,"InterpolationEnd",50,"]",61,"}",74,")",165,"JSXEndTag"]],propSources:[dY],skippedNodes:[0,5,6,278],repeatNodeCount:37,tokenData:"$Fq07[R!bOX%ZXY+gYZ-yZ[+g[]%Z]^.c^p%Zpq+gqr/mrs3cst:_tuEruvJSvwLkwx! Yxy!'iyz!(sz{!)}{|!,q|}!.O}!O!,q!O!P!/Y!P!Q!9j!Q!R#:O!R![#<_![!]#I_!]!^#Jk!^!_#Ku!_!`$![!`!a$$v!a!b$*T!b!c$,r!c!}Er!}#O$-|#O#P$/W#P#Q$4o#Q#R$5y#R#SEr#S#T$7W#T#o$8b#o#p$<r#p#q$=h#q#r$>x#r#s$@U#s$f%Z$f$g+g$g#BYEr#BY#BZ$A`#BZ$ISEr$IS$I_$A`$I_$I|Er$I|$I}$Dk$I}$JO$Dk$JO$JTEr$JT$JU$A`$JU$KVEr$KV$KW$A`$KW&FUEr&FU&FV$A`&FV;'SEr;'S;=`I|<%l?HTEr?HT?HU$A`?HUOEr(n%d_$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z&j&hT$i&jO!^&c!_#o&c#p;'S&c;'S;=`&w<%lO&c&j&zP;=`<%l&c'|'U]$i&j(Z!bOY&}YZ&cZw&}wx&cx!^&}!^!_'}!_#O&}#O#P&c#P#o&}#o#p'}#p;'S&};'S;=`(l<%lO&}!b(SU(Z!bOY'}Zw'}x#O'}#P;'S'};'S;=`(f<%lO'}!b(iP;=`<%l'}'|(oP;=`<%l&}'[(y]$i&j(WpOY(rYZ&cZr(rrs&cs!^(r!^!_)r!_#O(r#O#P&c#P#o(r#o#p)r#p;'S(r;'S;=`*a<%lO(rp)wU(WpOY)rZr)rs#O)r#P;'S)r;'S;=`*Z<%lO)rp*^P;=`<%l)r'[*dP;=`<%l(r#S*nX(Wp(Z!bOY*gZr*grs'}sw*gwx)rx#O*g#P;'S*g;'S;=`+Z<%lO*g#S+^P;=`<%l*g(n+dP;=`<%l%Z07[+rq$i&j(Wp(Z!b'|0/lOX%ZXY+gYZ&cZ[+g[p%Zpq+gqr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p$f%Z$f$g+g$g#BY%Z#BY#BZ+g#BZ$IS%Z$IS$I_+g$I_$JT%Z$JT$JU+g$JU$KV%Z$KV$KW+g$KW&FU%Z&FU&FV+g&FV;'S%Z;'S;=`+a<%l?HT%Z?HT?HU+g?HUO%Z07[.ST(X#S$i&j'}0/lO!^&c!_#o&c#p;'S&c;'S;=`&w<%lO&c07[.n_$i&j(Wp(Z!b'}0/lOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z)3p/x`$i&j!p),Q(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`0z!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(KW1V`#v(Ch$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`2X!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(KW2d_#v(Ch$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'At3l_(V':f$i&j(Z!bOY4kYZ5qZr4krs7nsw4kwx5qx!^4k!^!_8p!_#O4k#O#P5q#P#o4k#o#p8p#p;'S4k;'S;=`:X<%lO4k(^4r_$i&j(Z!bOY4kYZ5qZr4krs7nsw4kwx5qx!^4k!^!_8p!_#O4k#O#P5q#P#o4k#o#p8p#p;'S4k;'S;=`:X<%lO4k&z5vX$i&jOr5qrs6cs!^5q!^!_6y!_#o5q#o#p6y#p;'S5q;'S;=`7h<%lO5q&z6jT$d`$i&jO!^&c!_#o&c#p;'S&c;'S;=`&w<%lO&c`6|TOr6yrs7]s;'S6y;'S;=`7b<%lO6y`7bO$d``7eP;=`<%l6y&z7kP;=`<%l5q(^7w]$d`$i&j(Z!bOY&}YZ&cZw&}wx&cx!^&}!^!_'}!_#O&}#O#P&c#P#o&}#o#p'}#p;'S&};'S;=`(l<%lO&}!r8uZ(Z!bOY8pYZ6yZr8prs9hsw8pwx6yx#O8p#O#P6y#P;'S8p;'S;=`:R<%lO8p!r9oU$d`(Z!bOY'}Zw'}x#O'}#P;'S'};'S;=`(f<%lO'}!r:UP;=`<%l8p(^:[P;=`<%l4k%9[:hh$i&j(Wp(Z!bOY%ZYZ&cZq%Zqr<Srs&}st%ZtuCruw%Zwx(rx!^%Z!^!_*g!_!c%Z!c!}Cr!}#O%Z#O#P&c#P#R%Z#R#SCr#S#T%Z#T#oCr#o#p*g#p$g%Z$g;'SCr;'S;=`El<%lOCr(r<__WS$i&j(Wp(Z!bOY<SYZ&cZr<Srs=^sw<Swx@nx!^<S!^!_Bm!_#O<S#O#P>`#P#o<S#o#pBm#p;'S<S;'S;=`Cl<%lO<S(Q=g]WS$i&j(Z!bOY=^YZ&cZw=^wx>`x!^=^!^!_?q!_#O=^#O#P>`#P#o=^#o#p?q#p;'S=^;'S;=`@h<%lO=^&n>gXWS$i&jOY>`YZ&cZ!^>`!^!_?S!_#o>`#o#p?S#p;'S>`;'S;=`?k<%lO>`S?XSWSOY?SZ;'S?S;'S;=`?e<%lO?SS?hP;=`<%l?S&n?nP;=`<%l>`!f?xWWS(Z!bOY?qZw?qwx?Sx#O?q#O#P?S#P;'S?q;'S;=`@b<%lO?q!f@eP;=`<%l?q(Q@kP;=`<%l=^'`@w]WS$i&j(WpOY@nYZ&cZr@nrs>`s!^@n!^!_Ap!_#O@n#O#P>`#P#o@n#o#pAp#p;'S@n;'S;=`Bg<%lO@ntAwWWS(WpOYApZrAprs?Ss#OAp#O#P?S#P;'SAp;'S;=`Ba<%lOAptBdP;=`<%lAp'`BjP;=`<%l@n#WBvYWS(Wp(Z!bOYBmZrBmrs?qswBmwxApx#OBm#O#P?S#P;'SBm;'S;=`Cf<%lOBm#WCiP;=`<%lBm(rCoP;=`<%l<S%9[C}i$i&j(o%1l(Wp(Z!bOY%ZYZ&cZr%Zrs&}st%ZtuCruw%Zwx(rx!Q%Z!Q![Cr![!^%Z!^!_*g!_!c%Z!c!}Cr!}#O%Z#O#P&c#P#R%Z#R#SCr#S#T%Z#T#oCr#o#p*g#p$g%Z$g;'SCr;'S;=`El<%lOCr%9[EoP;=`<%lCr07[FRk$i&j(Wp(Z!b$]#t(T,2j(e$I[OY%ZYZ&cZr%Zrs&}st%ZtuEruw%Zwx(rx}%Z}!OGv!O!Q%Z!Q![Er![!^%Z!^!_*g!_!c%Z!c!}Er!}#O%Z#O#P&c#P#R%Z#R#SEr#S#T%Z#T#oEr#o#p*g#p$g%Z$g;'SEr;'S;=`I|<%lOEr+dHRk$i&j(Wp(Z!b$]#tOY%ZYZ&cZr%Zrs&}st%ZtuGvuw%Zwx(rx}%Z}!OGv!O!Q%Z!Q![Gv![!^%Z!^!_*g!_!c%Z!c!}Gv!}#O%Z#O#P&c#P#R%Z#R#SGv#S#T%Z#T#oGv#o#p*g#p$g%Z$g;'SGv;'S;=`Iv<%lOGv+dIyP;=`<%lGv07[JPP;=`<%lEr(KWJ_`$i&j(Wp(Z!b#p(ChOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(KWKl_$i&j$Q(Ch(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z,#xLva(z+JY$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sv%ZvwM{wx(rx!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(KWNW`$i&j#z(Ch(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'At! c_(Y';W$i&j(WpOY!!bYZ!#hZr!!brs!#hsw!!bwx!$xx!^!!b!^!_!%z!_#O!!b#O#P!#h#P#o!!b#o#p!%z#p;'S!!b;'S;=`!'c<%lO!!b'l!!i_$i&j(WpOY!!bYZ!#hZr!!brs!#hsw!!bwx!$xx!^!!b!^!_!%z!_#O!!b#O#P!#h#P#o!!b#o#p!%z#p;'S!!b;'S;=`!'c<%lO!!b&z!#mX$i&jOw!#hwx6cx!^!#h!^!_!$Y!_#o!#h#o#p!$Y#p;'S!#h;'S;=`!$r<%lO!#h`!$]TOw!$Ywx7]x;'S!$Y;'S;=`!$l<%lO!$Y`!$oP;=`<%l!$Y&z!$uP;=`<%l!#h'l!%R]$d`$i&j(WpOY(rYZ&cZr(rrs&cs!^(r!^!_)r!_#O(r#O#P&c#P#o(r#o#p)r#p;'S(r;'S;=`*a<%lO(r!Q!&PZ(WpOY!%zYZ!$YZr!%zrs!$Ysw!%zwx!&rx#O!%z#O#P!$Y#P;'S!%z;'S;=`!']<%lO!%z!Q!&yU$d`(WpOY)rZr)rs#O)r#P;'S)r;'S;=`*Z<%lO)r!Q!'`P;=`<%l!%z'l!'fP;=`<%l!!b/5|!'t_!l/.^$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z#&U!)O_!k!Lf$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z-!n!*[b$i&j(Wp(Z!b(U%&f#q(ChOY%ZYZ&cZr%Zrs&}sw%Zwx(rxz%Zz{!+d{!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(KW!+o`$i&j(Wp(Z!b#n(ChOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z+;x!,|`$i&j(Wp(Z!br+4YOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z,$U!.Z_!]+Jf$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z07[!/ec$i&j(Wp(Z!b!Q.2^OY%ZYZ&cZr%Zrs&}sw%Zwx(rx!O%Z!O!P!0p!P!Q%Z!Q![!3Y![!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z#%|!0ya$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!O%Z!O!P!2O!P!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z#%|!2Z_![!L^$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad!3eg$i&j(Wp(Z!bs'9tOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q![!3Y![!^%Z!^!_*g!_!g%Z!g!h!4|!h#O%Z#O#P&c#P#R%Z#R#S!3Y#S#X%Z#X#Y!4|#Y#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad!5Vg$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx{%Z{|!6n|}%Z}!O!6n!O!Q%Z!Q![!8S![!^%Z!^!_*g!_#O%Z#O#P&c#P#R%Z#R#S!8S#S#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad!6wc$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q![!8S![!^%Z!^!_*g!_#O%Z#O#P&c#P#R%Z#R#S!8S#S#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad!8_c$i&j(Wp(Z!bs'9tOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q![!8S![!^%Z!^!_*g!_#O%Z#O#P&c#P#R%Z#R#S!8S#S#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z07[!9uf$i&j(Wp(Z!b#o(ChOY!;ZYZ&cZr!;Zrs!<nsw!;Zwx!Lcxz!;Zz{#-}{!P!;Z!P!Q#/d!Q!^!;Z!^!_#(i!_!`#7S!`!a#8i!a!}!;Z!}#O#,f#O#P!Dy#P#o!;Z#o#p#(i#p;'S!;Z;'S;=`#-w<%lO!;Z?O!;fb$i&j(Wp(Z!b!X7`OY!;ZYZ&cZr!;Zrs!<nsw!;Zwx!Lcx!P!;Z!P!Q#&`!Q!^!;Z!^!_#(i!_!}!;Z!}#O#,f#O#P!Dy#P#o!;Z#o#p#(i#p;'S!;Z;'S;=`#-w<%lO!;Z>^!<w`$i&j(Z!b!X7`OY!<nYZ&cZw!<nwx!=yx!P!<n!P!Q!Eq!Q!^!<n!^!_!Gr!_!}!<n!}#O!KS#O#P!Dy#P#o!<n#o#p!Gr#p;'S!<n;'S;=`!L]<%lO!<n<z!>Q^$i&j!X7`OY!=yYZ&cZ!P!=y!P!Q!>|!Q!^!=y!^!_!@c!_!}!=y!}#O!CW#O#P!Dy#P#o!=y#o#p!@c#p;'S!=y;'S;=`!Ek<%lO!=y<z!?Td$i&j!X7`O!^&c!_#W&c#W#X!>|#X#Z&c#Z#[!>|#[#]&c#]#^!>|#^#a&c#a#b!>|#b#g&c#g#h!>|#h#i&c#i#j!>|#j#k!>|#k#m&c#m#n!>|#n#o&c#p;'S&c;'S;=`&w<%lO&c7`!@hX!X7`OY!@cZ!P!@c!P!Q!AT!Q!}!@c!}#O!Ar#O#P!Bq#P;'S!@c;'S;=`!CQ<%lO!@c7`!AYW!X7`#W#X!AT#Z#[!AT#]#^!AT#a#b!AT#g#h!AT#i#j!AT#j#k!AT#m#n!AT7`!AuVOY!ArZ#O!Ar#O#P!B[#P#Q!@c#Q;'S!Ar;'S;=`!Bk<%lO!Ar7`!B_SOY!ArZ;'S!Ar;'S;=`!Bk<%lO!Ar7`!BnP;=`<%l!Ar7`!BtSOY!@cZ;'S!@c;'S;=`!CQ<%lO!@c7`!CTP;=`<%l!@c<z!C][$i&jOY!CWYZ&cZ!^!CW!^!_!Ar!_#O!CW#O#P!DR#P#Q!=y#Q#o!CW#o#p!Ar#p;'S!CW;'S;=`!Ds<%lO!CW<z!DWX$i&jOY!CWYZ&cZ!^!CW!^!_!Ar!_#o!CW#o#p!Ar#p;'S!CW;'S;=`!Ds<%lO!CW<z!DvP;=`<%l!CW<z!EOX$i&jOY!=yYZ&cZ!^!=y!^!_!@c!_#o!=y#o#p!@c#p;'S!=y;'S;=`!Ek<%lO!=y<z!EnP;=`<%l!=y>^!Ezl$i&j(Z!b!X7`OY&}YZ&cZw&}wx&cx!^&}!^!_'}!_#O&}#O#P&c#P#W&}#W#X!Eq#X#Z&}#Z#[!Eq#[#]&}#]#^!Eq#^#a&}#a#b!Eq#b#g&}#g#h!Eq#h#i&}#i#j!Eq#j#k!Eq#k#m&}#m#n!Eq#n#o&}#o#p'}#p;'S&};'S;=`(l<%lO&}8r!GyZ(Z!b!X7`OY!GrZw!Grwx!@cx!P!Gr!P!Q!Hl!Q!}!Gr!}#O!JU#O#P!Bq#P;'S!Gr;'S;=`!J|<%lO!Gr8r!Hse(Z!b!X7`OY'}Zw'}x#O'}#P#W'}#W#X!Hl#X#Z'}#Z#[!Hl#[#]'}#]#^!Hl#^#a'}#a#b!Hl#b#g'}#g#h!Hl#h#i'}#i#j!Hl#j#k!Hl#k#m'}#m#n!Hl#n;'S'};'S;=`(f<%lO'}8r!JZX(Z!bOY!JUZw!JUwx!Arx#O!JU#O#P!B[#P#Q!Gr#Q;'S!JU;'S;=`!Jv<%lO!JU8r!JyP;=`<%l!JU8r!KPP;=`<%l!Gr>^!KZ^$i&j(Z!bOY!KSYZ&cZw!KSwx!CWx!^!KS!^!_!JU!_#O!KS#O#P!DR#P#Q!<n#Q#o!KS#o#p!JU#p;'S!KS;'S;=`!LV<%lO!KS>^!LYP;=`<%l!KS>^!L`P;=`<%l!<n=l!Ll`$i&j(Wp!X7`OY!LcYZ&cZr!Lcrs!=ys!P!Lc!P!Q!Mn!Q!^!Lc!^!_# o!_!}!Lc!}#O#%P#O#P!Dy#P#o!Lc#o#p# o#p;'S!Lc;'S;=`#&Y<%lO!Lc=l!Mwl$i&j(Wp!X7`OY(rYZ&cZr(rrs&cs!^(r!^!_)r!_#O(r#O#P&c#P#W(r#W#X!Mn#X#Z(r#Z#[!Mn#[#](r#]#^!Mn#^#a(r#a#b!Mn#b#g(r#g#h!Mn#h#i(r#i#j!Mn#j#k!Mn#k#m(r#m#n!Mn#n#o(r#o#p)r#p;'S(r;'S;=`*a<%lO(r8Q# vZ(Wp!X7`OY# oZr# ors!@cs!P# o!P!Q#!i!Q!}# o!}#O#$R#O#P!Bq#P;'S# o;'S;=`#$y<%lO# o8Q#!pe(Wp!X7`OY)rZr)rs#O)r#P#W)r#W#X#!i#X#Z)r#Z#[#!i#[#])r#]#^#!i#^#a)r#a#b#!i#b#g)r#g#h#!i#h#i)r#i#j#!i#j#k#!i#k#m)r#m#n#!i#n;'S)r;'S;=`*Z<%lO)r8Q#$WX(WpOY#$RZr#$Rrs!Ars#O#$R#O#P!B[#P#Q# o#Q;'S#$R;'S;=`#$s<%lO#$R8Q#$vP;=`<%l#$R8Q#$|P;=`<%l# o=l#%W^$i&j(WpOY#%PYZ&cZr#%Prs!CWs!^#%P!^!_#$R!_#O#%P#O#P!DR#P#Q!Lc#Q#o#%P#o#p#$R#p;'S#%P;'S;=`#&S<%lO#%P=l#&VP;=`<%l#%P=l#&]P;=`<%l!Lc?O#&kn$i&j(Wp(Z!b!X7`OY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#W%Z#W#X#&`#X#Z%Z#Z#[#&`#[#]%Z#]#^#&`#^#a%Z#a#b#&`#b#g%Z#g#h#&`#h#i%Z#i#j#&`#j#k#&`#k#m%Z#m#n#&`#n#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z9d#(r](Wp(Z!b!X7`OY#(iZr#(irs!Grsw#(iwx# ox!P#(i!P!Q#)k!Q!}#(i!}#O#+`#O#P!Bq#P;'S#(i;'S;=`#,`<%lO#(i9d#)th(Wp(Z!b!X7`OY*gZr*grs'}sw*gwx)rx#O*g#P#W*g#W#X#)k#X#Z*g#Z#[#)k#[#]*g#]#^#)k#^#a*g#a#b#)k#b#g*g#g#h#)k#h#i*g#i#j#)k#j#k#)k#k#m*g#m#n#)k#n;'S*g;'S;=`+Z<%lO*g9d#+gZ(Wp(Z!bOY#+`Zr#+`rs!JUsw#+`wx#$Rx#O#+`#O#P!B[#P#Q#(i#Q;'S#+`;'S;=`#,Y<%lO#+`9d#,]P;=`<%l#+`9d#,cP;=`<%l#(i?O#,o`$i&j(Wp(Z!bOY#,fYZ&cZr#,frs!KSsw#,fwx#%Px!^#,f!^!_#+`!_#O#,f#O#P!DR#P#Q!;Z#Q#o#,f#o#p#+`#p;'S#,f;'S;=`#-q<%lO#,f?O#-tP;=`<%l#,f?O#-zP;=`<%l!;Z07[#.[b$i&j(Wp(Z!b(O0/l!X7`OY!;ZYZ&cZr!;Zrs!<nsw!;Zwx!Lcx!P!;Z!P!Q#&`!Q!^!;Z!^!_#(i!_!}!;Z!}#O#,f#O#P!Dy#P#o!;Z#o#p#(i#p;'S!;Z;'S;=`#-w<%lO!;Z07[#/o_$i&j(Wp(Z!bT0/lOY#/dYZ&cZr#/drs#0nsw#/dwx#4Ox!^#/d!^!_#5}!_#O#/d#O#P#1p#P#o#/d#o#p#5}#p;'S#/d;'S;=`#6|<%lO#/d06j#0w]$i&j(Z!bT0/lOY#0nYZ&cZw#0nwx#1px!^#0n!^!_#3R!_#O#0n#O#P#1p#P#o#0n#o#p#3R#p;'S#0n;'S;=`#3x<%lO#0n05W#1wX$i&jT0/lOY#1pYZ&cZ!^#1p!^!_#2d!_#o#1p#o#p#2d#p;'S#1p;'S;=`#2{<%lO#1p0/l#2iST0/lOY#2dZ;'S#2d;'S;=`#2u<%lO#2d0/l#2xP;=`<%l#2d05W#3OP;=`<%l#1p01O#3YW(Z!bT0/lOY#3RZw#3Rwx#2dx#O#3R#O#P#2d#P;'S#3R;'S;=`#3r<%lO#3R01O#3uP;=`<%l#3R06j#3{P;=`<%l#0n05x#4X]$i&j(WpT0/lOY#4OYZ&cZr#4Ors#1ps!^#4O!^!_#5Q!_#O#4O#O#P#1p#P#o#4O#o#p#5Q#p;'S#4O;'S;=`#5w<%lO#4O00^#5XW(WpT0/lOY#5QZr#5Qrs#2ds#O#5Q#O#P#2d#P;'S#5Q;'S;=`#5q<%lO#5Q00^#5tP;=`<%l#5Q05x#5zP;=`<%l#4O01p#6WY(Wp(Z!bT0/lOY#5}Zr#5}rs#3Rsw#5}wx#5Qx#O#5}#O#P#2d#P;'S#5};'S;=`#6v<%lO#5}01p#6yP;=`<%l#5}07[#7PP;=`<%l#/d)3h#7ab$i&j$Q(Ch(Wp(Z!b!X7`OY!;ZYZ&cZr!;Zrs!<nsw!;Zwx!Lcx!P!;Z!P!Q#&`!Q!^!;Z!^!_#(i!_!}!;Z!}#O#,f#O#P!Dy#P#o!;Z#o#p#(i#p;'S!;Z;'S;=`#-w<%lO!;ZAt#8vb$Z#t$i&j(Wp(Z!b!X7`OY!;ZYZ&cZr!;Zrs!<nsw!;Zwx!Lcx!P!;Z!P!Q#&`!Q!^!;Z!^!_#(i!_!}!;Z!}#O#,f#O#P!Dy#P#o!;Z#o#p#(i#p;'S!;Z;'S;=`#-w<%lO!;Z'Ad#:Zp$i&j(Wp(Z!bs'9tOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!O%Z!O!P!3Y!P!Q%Z!Q![#<_![!^%Z!^!_*g!_!g%Z!g!h!4|!h#O%Z#O#P&c#P#R%Z#R#S#<_#S#U%Z#U#V#?i#V#X%Z#X#Y!4|#Y#b%Z#b#c#>_#c#d#Bq#d#l%Z#l#m#Es#m#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad#<jk$i&j(Wp(Z!bs'9tOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!O%Z!O!P!3Y!P!Q%Z!Q![#<_![!^%Z!^!_*g!_!g%Z!g!h!4|!h#O%Z#O#P&c#P#R%Z#R#S#<_#S#X%Z#X#Y!4|#Y#b%Z#b#c#>_#c#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad#>j_$i&j(Wp(Z!bs'9tOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad#?rd$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q!R#AQ!R!S#AQ!S!^%Z!^!_*g!_#O%Z#O#P&c#P#R%Z#R#S#AQ#S#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad#A]f$i&j(Wp(Z!bs'9tOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q!R#AQ!R!S#AQ!S!^%Z!^!_*g!_#O%Z#O#P&c#P#R%Z#R#S#AQ#S#b%Z#b#c#>_#c#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad#Bzc$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q!Y#DV!Y!^%Z!^!_*g!_#O%Z#O#P&c#P#R%Z#R#S#DV#S#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad#Dbe$i&j(Wp(Z!bs'9tOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q!Y#DV!Y!^%Z!^!_*g!_#O%Z#O#P&c#P#R%Z#R#S#DV#S#b%Z#b#c#>_#c#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad#E|g$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q![#Ge![!^%Z!^!_*g!_!c%Z!c!i#Ge!i#O%Z#O#P&c#P#R%Z#R#S#Ge#S#T%Z#T#Z#Ge#Z#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad#Gpi$i&j(Wp(Z!bs'9tOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q![#Ge![!^%Z!^!_*g!_!c%Z!c!i#Ge!i#O%Z#O#P&c#P#R%Z#R#S#Ge#S#T%Z#T#Z#Ge#Z#b%Z#b#c#>_#c#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z*)x#Il_!g$b$i&j$O)Lv(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z)[#Jv_al$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z04f#LS^h#)`#R-<U(Wp(Z!b$n7`OY*gZr*grs'}sw*gwx)rx!P*g!P!Q#MO!Q!^*g!^!_#Mt!_!`$ f!`#O*g#P;'S*g;'S;=`+Z<%lO*g(n#MXX$k&j(Wp(Z!bOY*gZr*grs'}sw*gwx)rx#O*g#P;'S*g;'S;=`+Z<%lO*g(El#M}Z#r(Ch(Wp(Z!bOY*gZr*grs'}sw*gwx)rx!_*g!_!`#Np!`#O*g#P;'S*g;'S;=`+Z<%lO*g(El#NyX$Q(Ch(Wp(Z!bOY*gZr*grs'}sw*gwx)rx#O*g#P;'S*g;'S;=`+Z<%lO*g(El$ oX#s(Ch(Wp(Z!bOY*gZr*grs'}sw*gwx)rx#O*g#P;'S*g;'S;=`+Z<%lO*g*)x$!ga#`*!Y$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`0z!`!a$#l!a#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(K[$#w_#k(Cl$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z*)x$%Vag!*r#s(Ch$f#|$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`$&[!`!a$'f!a#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(KW$&g_#s(Ch$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(KW$'qa#r(Ch$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Ka!`!a$(v!a#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(KW$)R`#r(Ch$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(Kd$*`a(r(Ct$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!a%Z!a!b$+e!b#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(KW$+p`$i&j#{(Ch(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z%#`$,}_!|$Ip$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z04f$.X_!S0,v$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(n$/]Z$i&jO!^$0O!^!_$0f!_#i$0O#i#j$0k#j#l$0O#l#m$2^#m#o$0O#o#p$0f#p;'S$0O;'S;=`$4i<%lO$0O(n$0VT_#S$i&jO!^&c!_#o&c#p;'S&c;'S;=`&w<%lO&c#S$0kO_#S(n$0p[$i&jO!Q&c!Q![$1f![!^&c!_!c&c!c!i$1f!i#T&c#T#Z$1f#Z#o&c#o#p$3|#p;'S&c;'S;=`&w<%lO&c(n$1kZ$i&jO!Q&c!Q![$2^![!^&c!_!c&c!c!i$2^!i#T&c#T#Z$2^#Z#o&c#p;'S&c;'S;=`&w<%lO&c(n$2cZ$i&jO!Q&c!Q![$3U![!^&c!_!c&c!c!i$3U!i#T&c#T#Z$3U#Z#o&c#p;'S&c;'S;=`&w<%lO&c(n$3ZZ$i&jO!Q&c!Q![$0O![!^&c!_!c&c!c!i$0O!i#T&c#T#Z$0O#Z#o&c#p;'S&c;'S;=`&w<%lO&c#S$4PR!Q![$4Y!c!i$4Y#T#Z$4Y#S$4]S!Q![$4Y!c!i$4Y#T#Z$4Y#q#r$0f(n$4lP;=`<%l$0O#1[$4z_!Y#)l$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(KW$6U`#x(Ch$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z+;p$7c_$i&j(Wp(Z!b(a+4QOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z07[$8qk$i&j(Wp(Z!b(T,2j$_#t(e$I[OY%ZYZ&cZr%Zrs&}st%Ztu$8buw%Zwx(rx}%Z}!O$:f!O!Q%Z!Q![$8b![!^%Z!^!_*g!_!c%Z!c!}$8b!}#O%Z#O#P&c#P#R%Z#R#S$8b#S#T%Z#T#o$8b#o#p*g#p$g%Z$g;'S$8b;'S;=`$<l<%lO$8b+d$:qk$i&j(Wp(Z!b$_#tOY%ZYZ&cZr%Zrs&}st%Ztu$:fuw%Zwx(rx}%Z}!O$:f!O!Q%Z!Q![$:f![!^%Z!^!_*g!_!c%Z!c!}$:f!}#O%Z#O#P&c#P#R%Z#R#S$:f#S#T%Z#T#o$:f#o#p*g#p$g%Z$g;'S$:f;'S;=`$<f<%lO$:f+d$<iP;=`<%l$:f07[$<oP;=`<%l$8b#Jf$<{X!_#Hb(Wp(Z!bOY*gZr*grs'}sw*gwx)rx#O*g#P;'S*g;'S;=`+Z<%lO*g,#x$=sa(y+JY$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p#q$+e#q;'S%Z;'S;=`+a<%lO%Z)>v$?V_!^(CdvBr$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z?O$@a_!q7`$i&j(Wp(Z!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z07[$Aq|$i&j(Wp(Z!b'|0/l$]#t(T,2j(e$I[OX%ZXY+gYZ&cZ[+g[p%Zpq+gqr%Zrs&}st%ZtuEruw%Zwx(rx}%Z}!OGv!O!Q%Z!Q![Er![!^%Z!^!_*g!_!c%Z!c!}Er!}#O%Z#O#P&c#P#R%Z#R#SEr#S#T%Z#T#oEr#o#p*g#p$f%Z$f$g+g$g#BYEr#BY#BZ$A`#BZ$ISEr$IS$I_$A`$I_$JTEr$JT$JU$A`$JU$KVEr$KV$KW$A`$KW&FUEr&FU&FV$A`&FV;'SEr;'S;=`I|<%l?HTEr?HT?HU$A`?HUOEr07[$D|k$i&j(Wp(Z!b'}0/l$]#t(T,2j(e$I[OY%ZYZ&cZr%Zrs&}st%ZtuEruw%Zwx(rx}%Z}!OGv!O!Q%Z!Q![Er![!^%Z!^!_*g!_!c%Z!c!}Er!}#O%Z#O#P&c#P#R%Z#R#SEr#S#T%Z#T#oEr#o#p*g#p$g%Z$g;'SEr;'S;=`I|<%lOEr",tokenizers:[lY,hY,uY,cY,2,3,4,5,6,7,8,9,10,11,12,13,14,aY,new Df("$S~RRtu[#O#Pg#S#T#|~_P#o#pb~gOx~~jVO#i!P#i#j!U#j#l!P#l#m!q#m;'S!P;'S;=`#v<%lO!P~!UO!U~~!XS!Q![!e!c!i!e#T#Z!e#o#p#Z~!hR!Q![!q!c!i!q#T#Z!q~!tR!Q![!}!c!i!}#T#Z!}~#QR!Q![!P!c!i!P#T#Z!P~#^R!Q![#g!c!i#g#T#Z#g~#jS!Q![#g!c!i#g#T#Z#g#q#r!P~#yP;=`<%l!P~$RO(c~~",141,340),new Df("j~RQYZXz{^~^O(Q~~aP!P!Qd~iO(R~~",25,323)],topRules:{Script:[0,7],SingleExpression:[1,276],SingleClassItem:[2,277]},dialects:{jsx:0,ts:15175},dynamicPrecedences:{80:1,82:1,94:1,169:1,199:1},specialized:[{term:327,get:n=>fY[n]||-1},{term:343,get:n=>pY[n]||-1},{term:95,get:n=>mY[n]||-1}],tokenPrec:15201}),LI=[Fi("function ${name}(${params}) {\n	${}\n}",{label:"function",detail:"definition",type:"keyword"}),Fi("for (let ${index} = 0; ${index} < ${bound}; ${index}++) {\n	${}\n}",{label:"for",detail:"loop",type:"keyword"}),Fi("for (let ${name} of ${collection}) {\n	${}\n}",{label:"for",detail:"of loop",type:"keyword"}),Fi("do {\n	${}\n} while (${})",{label:"do",detail:"loop",type:"keyword"}),Fi("while (${}) {\n	${}\n}",{label:"while",detail:"loop",type:"keyword"}),Fi(`try {
	\${}
} catch (\${error}) {
	\${}
}`,{label:"try",detail:"/ catch block",type:"keyword"}),Fi("if (${}) {\n	${}\n}",{label:"if",detail:"block",type:"keyword"}),Fi(`if (\${}) {
	\${}
} else {
	\${}
}`,{label:"if",detail:"/ else block",type:"keyword"}),Fi(`class \${name} {
	constructor(\${params}) {
		\${}
	}
}`,{label:"class",detail:"definition",type:"keyword"}),Fi('import {${names}} from "${module}"\n${}',{label:"import",detail:"named",type:"keyword"}),Fi('import ${name} from "${module}"\n${}',{label:"import",detail:"default",type:"keyword"})],OY=LI.concat([Fi("interface ${name} {\n	${}\n}",{label:"interface",detail:"definition",type:"keyword"}),Fi("type ${name} = ${type}",{label:"type",detail:"definition",type:"keyword"}),Fi("enum ${name} {\n	${}\n}",{label:"enum",detail:"definition",type:"keyword"})]),x_=new FM,$I=new Set(["Script","Block","FunctionExpression","FunctionDeclaration","ArrowFunction","MethodDeclaration","ForStatement"]);function Yl(n){return(e,t)=>{let i=e.node.getChild("VariableDefinition");return i&&t(i,n),!0}}const yY=["FunctionDeclaration"],bY={FunctionDeclaration:Yl("function"),ClassDeclaration:Yl("class"),ClassExpression:()=>!0,EnumDeclaration:Yl("constant"),TypeAliasDeclaration:Yl("type"),NamespaceDeclaration:Yl("namespace"),VariableDefinition(n,e){n.matchContext(yY)||e(n,"variable")},TypeDefinition(n,e){e(n,"type")},__proto__:null};function QI(n,e){let t=x_.get(e);if(t)return t;let i=[],s=!0;function r(o,a){let l=n.sliceString(o.from,o.to);i.push({label:l,type:a})}return e.cursor(ft.IncludeAnonymous).iterate(o=>{if(s)s=!1;else if(o.name){let a=bY[o.name];if(a&&a(o,r)||$I.has(o.name))return!1}else if(o.to-o.from>8192){for(let a of QI(n,o.node))i.push(a);return!1}}),x_.set(e,i),i}const T_=/^[\w$\xa1-\uffff][\w$\d\xa1-\uffff]*$/,BI=["TemplateString","String","RegExp","LineComment","BlockComment","VariableDefinition","TypeDefinition","Label","PropertyDefinition","PropertyName","PrivatePropertyDefinition","PrivatePropertyName","JSXText","JSXAttributeValue","JSXOpenTag","JSXCloseTag","JSXSelfClosingTag",".","?."];function vY(n){let e=ui(n.state).resolveInner(n.pos,-1);if(BI.indexOf(e.name)>-1)return null;let t=e.name=="VariableName"||e.to-e.from<20&&T_.test(n.state.sliceDoc(e.from,e.to));if(!t&&!n.explicit)return null;let i=[];for(let s=e;s;s=s.parent)$I.has(s.name)&&(i=i.concat(QI(n.state.doc,s)));return{options:i,from:t?e.from:n.pos,validFor:T_}}const Cs=el.define({name:"javascript",parser:gY.configure({props:[_p.add({IfStatement:yd({except:/^\s*({|else\b)/}),TryStatement:yd({except:/^\s*({|catch\b|finally\b)/}),LabeledStatement:cH,SwitchBody:n=>{let e=n.textAfter,t=/^\s*\}/.test(e),i=/^\s*(case|default)\b/.test(e);return n.baseIndent+(t?0:i?1:2)*n.unit},Block:hH({closing:"}"}),ArrowFunction:n=>n.baseIndent+n.unit,"TemplateString BlockComment":()=>null,"Statement Property":yd({except:/^\s*{/}),JSXElement(n){let e=/^\s*<\//.test(n.textAfter);return n.lineIndent(n.node.from)+(e?0:n.unit)},JSXEscape(n){let e=/\s*\}/.test(n.textAfter);return n.lineIndent(n.node.from)+(e?0:n.unit)},"JSXOpenTag JSXSelfClosingTag"(n){return n.column(n.node.from)+n.unit}}),$u.add({"Block ClassBody SwitchBody EnumBody ObjectExpression ArrayExpression ObjectType":XM,BlockComment(n){return{from:n.from+2,to:n.to-2}}})]}),languageData:{closeBrackets:{brackets:["(","[","{","'",'"',"`"]},commentTokens:{line:"//",block:{open:"/*",close:"*/"}},indentOnInput:/^\s*(?:case |default:|\{|\}|<\/)$/,wordChars:"$"}}),NI={test:n=>/^JSX/.test(n.name),facet:tv({commentTokens:{block:{open:"{/*",close:"*/}"}}})},FI=Cs.configure({dialect:"ts"},"typescript"),VI=Cs.configure({dialect:"jsx",props:[iv.add(n=>n.isTop?[NI]:void 0)]}),UI=Cs.configure({dialect:"jsx ts",props:[iv.add(n=>n.isTop?[NI]:void 0)]},"typescript");let qI=n=>({label:n,type:"keyword"});const zI="break case const continue default delete export extends false finally in instanceof let new return static super switch this throw true typeof var yield".split(" ").map(qI),SY=zI.concat(["declare","implements","private","protected","public"].map(qI));function xY(n={}){let e=n.jsx?n.typescript?UI:VI:n.typescript?FI:Cs,t=n.typescript?OY.concat(SY):LI.concat(zI);return new uu(e,[Cs.data.of({autocomplete:wH(BI,TH(t))}),Cs.data.of({autocomplete:vY}),n.jsx?_Y:[]])}function TY(n){for(;;){if(n.name=="JSXOpenTag"||n.name=="JSXSelfClosingTag"||n.name=="JSXFragmentTag")return n;if(n.name=="JSXEscape"||!n.parent)return null;n=n.parent}}function w_(n,e,t=n.length){for(let i=e?.firstChild;i;i=i.nextSibling)if(i.name=="JSXIdentifier"||i.name=="JSXBuiltin"||i.name=="JSXNamespacedName"||i.name=="JSXMemberExpression")return n.sliceString(i.from,Math.min(i.to,t));return""}const wY=typeof navigator=="object"&&/Android\b/.test(navigator.userAgent),_Y=Ve.inputHandler.of((n,e,t,i,s)=>{if((wY?n.composing:n.compositionStarted)||n.state.readOnly||e!=t||i!=">"&&i!="/"||!Cs.isActiveAt(n.state,e,-1))return!1;let r=s(),{state:o}=r,a=o.changeByRange(l=>{var h;let{head:u}=l,c=ui(o).resolveInner(u-1,-1),f;if(c.name=="JSXStartTag"&&(c=c.parent),!(o.doc.sliceString(u-1,u)!=i||c.name=="JSXAttributeValue"&&c.to>u)){if(i==">"&&c.name=="JSXFragmentTag")return{range:l,changes:{from:u,insert:"</>"}};if(i=="/"&&c.name=="JSXStartCloseTag"){let p=c.parent,b=p.parent;if(b&&p.from==u-2&&((f=w_(o.doc,b.firstChild,u))||((h=b.firstChild)===null||h===void 0?void 0:h.name)=="JSXFragmentTag")){let y=`${f}>`;return{range:ke.cursor(u+y.length,-1),changes:{from:u,insert:y}}}}else if(i==">"){let p=TY(c);if(p&&p.name=="JSXOpenTag"&&!/^\/?>|^<\//.test(o.doc.sliceString(u,u+2))&&(f=w_(o.doc,p,u)))return{range:l,changes:{from:u,insert:`</${f}>`}}}}return{range:l}});return a.changes.empty?!1:(n.dispatch([r,o.update(a,{userEvent:"input.complete",scrollIntoView:!0})]),!0)}),Gl=["_blank","_self","_top","_parent"],Cg=["ascii","utf-8","utf-16","latin1","latin1"],Eg=["get","post","put","delete"],Ag=["application/x-www-form-urlencoded","multipart/form-data","text/plain"],en=["true","false"],we={},kY={a:{attrs:{href:null,ping:null,type:null,media:null,target:Gl,hreflang:null}},abbr:we,address:we,area:{attrs:{alt:null,coords:null,href:null,target:null,ping:null,media:null,hreflang:null,type:null,shape:["default","rect","circle","poly"]}},article:we,aside:we,audio:{attrs:{src:null,mediagroup:null,crossorigin:["anonymous","use-credentials"],preload:["none","metadata","auto"],autoplay:["autoplay"],loop:["loop"],controls:["controls"]}},b:we,base:{attrs:{href:null,target:Gl}},bdi:we,bdo:we,blockquote:{attrs:{cite:null}},body:we,br:we,button:{attrs:{form:null,formaction:null,name:null,value:null,autofocus:["autofocus"],disabled:["autofocus"],formenctype:Ag,formmethod:Eg,formnovalidate:["novalidate"],formtarget:Gl,type:["submit","reset","button"]}},canvas:{attrs:{width:null,height:null}},caption:we,center:we,cite:we,code:we,col:{attrs:{span:null}},colgroup:{attrs:{span:null}},command:{attrs:{type:["command","checkbox","radio"],label:null,icon:null,radiogroup:null,command:null,title:null,disabled:["disabled"],checked:["checked"]}},data:{attrs:{value:null}},datagrid:{attrs:{disabled:["disabled"],multiple:["multiple"]}},datalist:{attrs:{data:null}},dd:we,del:{attrs:{cite:null,datetime:null}},details:{attrs:{open:["open"]}},dfn:we,div:we,dl:we,dt:we,em:we,embed:{attrs:{src:null,type:null,width:null,height:null}},eventsource:{attrs:{src:null}},fieldset:{attrs:{disabled:["disabled"],form:null,name:null}},figcaption:we,figure:we,footer:we,form:{attrs:{action:null,name:null,"accept-charset":Cg,autocomplete:["on","off"],enctype:Ag,method:Eg,novalidate:["novalidate"],target:Gl}},h1:we,h2:we,h3:we,h4:we,h5:we,h6:we,head:{children:["title","base","link","style","meta","script","noscript","command"]},header:we,hgroup:we,hr:we,html:{attrs:{manifest:null}},i:we,iframe:{attrs:{src:null,srcdoc:null,name:null,width:null,height:null,sandbox:["allow-top-navigation","allow-same-origin","allow-forms","allow-scripts"],seamless:["seamless"]}},img:{attrs:{alt:null,src:null,ismap:null,usemap:null,width:null,height:null,crossorigin:["anonymous","use-credentials"]}},input:{attrs:{alt:null,dirname:null,form:null,formaction:null,height:null,list:null,max:null,maxlength:null,min:null,name:null,pattern:null,placeholder:null,size:null,src:null,step:null,value:null,width:null,accept:["audio/*","video/*","image/*"],autocomplete:["on","off"],autofocus:["autofocus"],checked:["checked"],disabled:["disabled"],formenctype:Ag,formmethod:Eg,formnovalidate:["novalidate"],formtarget:Gl,multiple:["multiple"],readonly:["readonly"],required:["required"],type:["hidden","text","search","tel","url","email","password","datetime","date","month","week","time","datetime-local","number","range","color","checkbox","radio","file","submit","image","reset","button"]}},ins:{attrs:{cite:null,datetime:null}},kbd:we,keygen:{attrs:{challenge:null,form:null,name:null,autofocus:["autofocus"],disabled:["disabled"],keytype:["RSA"]}},label:{attrs:{for:null,form:null}},legend:we,li:{attrs:{value:null}},link:{attrs:{href:null,type:null,hreflang:null,media:null,sizes:["all","16x16","16x16 32x32","16x16 32x32 64x64"]}},map:{attrs:{name:null}},mark:we,menu:{attrs:{label:null,type:["list","context","toolbar"]}},meta:{attrs:{content:null,charset:Cg,name:["viewport","application-name","author","description","generator","keywords"],"http-equiv":["content-language","content-type","default-style","refresh"]}},meter:{attrs:{value:null,min:null,low:null,high:null,max:null,optimum:null}},nav:we,noscript:we,object:{attrs:{data:null,type:null,name:null,usemap:null,form:null,width:null,height:null,typemustmatch:["typemustmatch"]}},ol:{attrs:{reversed:["reversed"],start:null,type:["1","a","A","i","I"]},children:["li","script","template","ul","ol"]},optgroup:{attrs:{disabled:["disabled"],label:null}},option:{attrs:{disabled:["disabled"],label:null,selected:["selected"],value:null}},output:{attrs:{for:null,form:null,name:null}},p:we,param:{attrs:{name:null,value:null}},pre:we,progress:{attrs:{value:null,max:null}},q:{attrs:{cite:null}},rp:we,rt:we,ruby:we,samp:we,script:{attrs:{type:["text/javascript"],src:null,async:["async"],defer:["defer"],charset:Cg}},section:we,select:{attrs:{form:null,name:null,size:null,autofocus:["autofocus"],disabled:["disabled"],multiple:["multiple"]}},slot:{attrs:{name:null}},small:we,source:{attrs:{src:null,type:null,media:null}},span:we,strong:we,style:{attrs:{type:["text/css"],media:null,scoped:null}},sub:we,summary:we,sup:we,table:we,tbody:we,td:{attrs:{colspan:null,rowspan:null,headers:null}},template:we,textarea:{attrs:{dirname:null,form:null,maxlength:null,name:null,placeholder:null,rows:null,cols:null,autofocus:["autofocus"],disabled:["disabled"],readonly:["readonly"],required:["required"],wrap:["soft","hard"]}},tfoot:we,th:{attrs:{colspan:null,rowspan:null,headers:null,scope:["row","col","rowgroup","colgroup"]}},thead:we,time:{attrs:{datetime:null}},title:we,tr:we,track:{attrs:{src:null,label:null,default:null,kind:["subtitles","captions","descriptions","chapters","metadata"],srclang:null}},ul:{children:["li","script","template","ul","ol"]},var:we,video:{attrs:{src:null,poster:null,width:null,height:null,crossorigin:["anonymous","use-credentials"],preload:["auto","metadata","none"],autoplay:["autoplay"],mediagroup:["movie"],muted:["muted"],controls:["controls"]}},wbr:we},jI={accesskey:null,class:null,contenteditable:en,contextmenu:null,dir:["ltr","rtl","auto"],draggable:["true","false","auto"],dropzone:["copy","move","link","string:","file:"],hidden:["hidden"],id:null,inert:["inert"],itemid:null,itemprop:null,itemref:null,itemscope:["itemscope"],itemtype:null,lang:["ar","bn","de","en-GB","en-US","es","fr","hi","id","ja","pa","pt","ru","tr","zh"],spellcheck:en,autocorrect:en,autocapitalize:en,style:null,tabindex:null,title:null,translate:["yes","no"],rel:["stylesheet","alternate","author","bookmark","help","license","next","nofollow","noreferrer","prefetch","prev","search","tag"],role:"alert application article banner button cell checkbox complementary contentinfo dialog document feed figure form grid gridcell heading img list listbox listitem main navigation region row rowgroup search switch tab table tabpanel textbox timer".split(" "),"aria-activedescendant":null,"aria-atomic":en,"aria-autocomplete":["inline","list","both","none"],"aria-busy":en,"aria-checked":["true","false","mixed","undefined"],"aria-controls":null,"aria-describedby":null,"aria-disabled":en,"aria-dropeffect":null,"aria-expanded":["true","false","undefined"],"aria-flowto":null,"aria-grabbed":["true","false","undefined"],"aria-haspopup":en,"aria-hidden":en,"aria-invalid":["true","false","grammar","spelling"],"aria-label":null,"aria-labelledby":null,"aria-level":null,"aria-live":["off","polite","assertive"],"aria-multiline":en,"aria-multiselectable":en,"aria-owns":null,"aria-posinset":null,"aria-pressed":["true","false","mixed","undefined"],"aria-readonly":en,"aria-relevant":null,"aria-required":en,"aria-selected":["true","false","undefined"],"aria-setsize":null,"aria-sort":["ascending","descending","none","other"],"aria-valuemax":null,"aria-valuemin":null,"aria-valuenow":null,"aria-valuetext":null},XI="beforeunload copy cut dragstart dragover dragleave dragenter dragend drag paste focus blur change click load mousedown mouseenter mouseleave mouseup keydown keyup resize scroll unload".split(" ").map(n=>"on"+n);for(let n of XI)jI[n]=null;class mu{constructor(e,t){this.tags={...kY,...e},this.globalAttrs={...jI,...t},this.allTags=Object.keys(this.tags),this.globalAttrNames=Object.keys(this.globalAttrs)}}mu.default=new mu;function rl(n,e,t=n.length){if(!e)return"";let i=e.firstChild,s=i&&i.getChild("TagName");return s?n.sliceString(s.from,Math.min(s.to,t)):""}function ol(n,e=!1){for(;n;n=n.parent)if(n.name=="Element")if(e)e=!1;else return n;return null}function HI(n,e,t){let i=t.tags[rl(n,ol(e))];return i?.children||t.allTags}function fv(n,e){let t=[];for(let i=ol(e);i&&!i.type.isTop;i=ol(i.parent)){let s=rl(n,i);if(s&&i.lastChild.name=="CloseTag")break;s&&t.indexOf(s)<0&&(e.name=="EndTag"||e.from>=i.firstChild.to)&&t.push(s)}return t}const WI=/^[:\-\.\w\u00b7-\uffff]*$/;function __(n,e,t,i,s){let r=/\s*>/.test(n.sliceDoc(s,s+5))?"":">",o=ol(t,t.name=="StartTag"||t.name=="TagName");return{from:i,to:s,options:HI(n.doc,o,e).map(a=>({label:a,type:"type"})).concat(fv(n.doc,t).map((a,l)=>({label:"/"+a,apply:"/"+a+r,type:"type",boost:99-l}))),validFor:/^\/?[:\-\.\w\u00b7-\uffff]*$/}}function k_(n,e,t,i){let s=/\s*>/.test(n.sliceDoc(i,i+5))?"":">";return{from:t,to:i,options:fv(n.doc,e).map((r,o)=>({label:r,apply:r+s,type:"type",boost:99-o})),validFor:WI}}function CY(n,e,t,i){let s=[],r=0;for(let o of HI(n.doc,t,e))s.push({label:"<"+o,type:"type"});for(let o of fv(n.doc,t))s.push({label:"</"+o+">",type:"type",boost:99-r++});return{from:i,to:i,options:s,validFor:/^<\/?[:\-\.\w\u00b7-\uffff]*$/}}function EY(n,e,t,i,s){let r=ol(t),o=r?e.tags[rl(n.doc,r)]:null,a=o&&o.attrs?Object.keys(o.attrs):[],l=o&&o.globalAttrs===!1?a:a.length?a.concat(e.globalAttrNames):e.globalAttrNames;return{from:i,to:s,options:l.map(h=>({label:h,type:"property"})),validFor:WI}}function AY(n,e,t,i,s){var r;let o=(r=t.parent)===null||r===void 0?void 0:r.getChild("AttributeName"),a=[],l;if(o){let h=n.sliceDoc(o.from,o.to),u=e.globalAttrs[h];if(!u){let c=ol(t),f=c?e.tags[rl(n.doc,c)]:null;u=f?.attrs&&f.attrs[h]}if(u){let c=n.sliceDoc(i,s).toLowerCase(),f='"',p='"';/^['"]/.test(c)?(l=c[0]=='"'?/^[^"]*$/:/^[^']*$/,f="",p=n.sliceDoc(s,s+1)==c[0]?"":c[0],c=c.slice(1),i++):l=/^[^\s<>='"]*$/;for(let b of u)a.push({label:b,apply:f+b+p,type:"constant"})}}return{from:i,to:s,options:a,validFor:l}}function ZI(n,e){let{state:t,pos:i}=e,s=ui(t).resolveInner(i,-1),r=s.resolve(i);for(let o=i,a;r==s&&(a=s.childBefore(o));){let l=a.lastChild;if(!l||!l.type.isError||l.from<l.to)break;r=s=a,o=l.from}return s.name=="TagName"?s.parent&&/CloseTag$/.test(s.parent.name)?k_(t,s,s.from,i):__(t,n,s,s.from,i):s.name=="StartTag"||s.name=="IncompleteTag"?__(t,n,s,i,i):s.name=="StartCloseTag"||s.name=="IncompleteCloseTag"?k_(t,s,i,i):s.name=="OpenTag"||s.name=="SelfClosingTag"||s.name=="AttributeName"?EY(t,n,s,s.name=="AttributeName"?s.from:i,i):s.name=="Is"||s.name=="AttributeValue"||s.name=="UnquotedAttributeValue"?AY(t,n,s,s.name=="Is"?i:s.from,i):e.explicit&&(r.name=="Element"||r.name=="Text"||r.name=="Document")?CY(t,n,s,i):null}function PY(n){return ZI(mu.default,n)}function DY(n){let{extraTags:e,extraGlobalAttributes:t}=n,i=t||e?new mu(e,t):mu.default;return s=>ZI(i,s)}const MY=Cs.parser.configure({top:"SingleExpression"}),YI=[{tag:"script",attrs:n=>n.type=="text/typescript"||n.lang=="ts",parser:FI.parser},{tag:"script",attrs:n=>n.type=="text/babel"||n.type=="text/jsx",parser:VI.parser},{tag:"script",attrs:n=>n.type=="text/typescript-jsx",parser:UI.parser},{tag:"script",attrs(n){return/^(importmap|speculationrules|application\/(.+\+)?json)$/i.test(n.type)},parser:MY},{tag:"script",attrs(n){return!n.type||/^(?:text|application)\/(?:x-)?(?:java|ecma)script$|^module$|^$/i.test(n.type)},parser:Cs.parser},{tag:"style",attrs(n){return(!n.lang||n.lang=="css")&&(!n.type||/^(text\/)?(x-)?(stylesheet|css)$/i.test(n.type))},parser:If.parser}],GI=[{name:"style",parser:If.parser.configure({top:"Styles"})}].concat(XI.map(n=>({name:n,parser:Cs.parser}))),KI=el.define({name:"html",parser:nZ.configure({props:[_p.add({Element(n){let e=/^(\s*)(<\/)?/.exec(n.textAfter);return n.node.to<=n.pos+e[0].length?n.continue():n.lineIndent(n.node.from)+(e[2]?0:n.unit)},"OpenTag CloseTag SelfClosingTag"(n){return n.column(n.node.from)+n.unit},Document(n){if(n.pos+/\s*/.exec(n.textAfter)[0].length<n.node.to)return n.continue();let e=null,t;for(let i=n.node;;){let s=i.lastChild;if(!s||s.name!="Element"||s.to!=i.to)break;e=i=s}return e&&!((t=e.lastChild)&&(t.name=="CloseTag"||t.name=="SelfClosingTag"))?n.lineIndent(e.from)+n.unit:null}}),$u.add({Element(n){let e=n.firstChild,t=n.lastChild;return!e||e.name!="OpenTag"?null:{from:e.to,to:t.name=="CloseTag"?t.from:n.to}}}),OH.add({"OpenTag CloseTag":n=>n.getChild("TagName")})]}),languageData:{commentTokens:{block:{open:"<!--",close:"-->"}},indentOnInput:/^\s*<\/\w+\W$/,wordChars:"-_"}}),Sd=KI.configure({wrap:EI(YI,GI)});function IY(n={}){let e="",t;n.matchClosingTags===!1&&(e="noMatch"),n.selfClosingTags===!0&&(e=(e?e+" ":"")+"selfClosing"),(n.nestedLanguages&&n.nestedLanguages.length||n.nestedAttributes&&n.nestedAttributes.length)&&(t=EI((n.nestedLanguages||[]).concat(YI),(n.nestedAttributes||[]).concat(GI)));let i=t?KI.configure({wrap:t,dialect:e}):e?Sd.configure({dialect:e}):Sd;return new uu(i,[Sd.data.of({autocomplete:DY(n)}),n.autoCloseTags!==!1?RY:[],xY().support,NZ().support])}const C_=new Set("area base br col command embed frame hr img input keygen link meta param source track wbr menuitem".split(" ")),RY=Ve.inputHandler.of((n,e,t,i,s)=>{if(n.composing||n.state.readOnly||e!=t||i!=">"&&i!="/"||!Sd.isActiveAt(n.state,e,-1))return!1;let r=s(),{state:o}=r,a=o.changeByRange(l=>{var h,u,c;let f=o.doc.sliceString(l.from-1,l.to)==i,{head:p}=l,b=ui(o).resolveInner(p,-1),y;if(f&&i==">"&&b.name=="EndTag"){let _=b.parent;if(((u=(h=_.parent)===null||h===void 0?void 0:h.lastChild)===null||u===void 0?void 0:u.name)!="CloseTag"&&(y=rl(o.doc,_.parent,p))&&!C_.has(y)){let T=p+(o.doc.sliceString(p,p+1)===">"?1:0),w=`</${y}>`;return{range:l,changes:{from:p,to:T,insert:w}}}}else if(f&&i=="/"&&b.name=="IncompleteCloseTag"){let _=b.parent;if(b.from==p-2&&((c=_.lastChild)===null||c===void 0?void 0:c.name)!="CloseTag"&&(y=rl(o.doc,_,p))&&!C_.has(y)){let T=p+(o.doc.sliceString(p,p+1)===">"?1:0),w=`${y}>`;return{range:ke.cursor(p+w.length,-1),changes:{from:p,to:T,insert:w}}}}return{range:l}});return a.changes.empty?!1:(n.dispatch([r,o.update(a,{userEvent:"input.complete",scrollIntoView:!0})]),!0)}),JI=tv({commentTokens:{block:{open:"<!--",close:"-->"}}}),eR=new qe,tR=GH.configure({props:[$u.add(n=>!n.is("Block")||n.is("Document")||ly(n)!=null||LY(n)?void 0:(e,t)=>({from:t.doc.lineAt(e.from).to,to:e.to})),eR.add(ly),_p.add({Document:()=>null}),vo.add({Document:JI})]});function ly(n){let e=/^(?:ATX|Setext)Heading(\d)$/.exec(n.name);return e?+e[1]:void 0}function LY(n){return n.name=="OrderedList"||n.name=="BulletList"}function $Y(n,e){let t=n;for(;;){let i=t.nextSibling,s;if(!i||(s=ly(i.type))!=null&&s<=e)break;t=i}return t.to}const QY=dH.of((n,e,t)=>{for(let i=ui(n).resolveInner(t,-1);i&&!(i.from<e);i=i.parent){let s=i.type.prop(eR);if(s==null)continue;let r=$Y(i,s);if(r>t)return{from:t,to:r}}return null});function pv(n){return new kn(JI,n,[],"markdown")}const BY=pv(tR),NY=tR.configure([lW,uW,hW,cW,{props:[$u.add({Table:(n,e)=>({from:e.doc.lineAt(n.from).to,to:n.to})})]}]),Rf=pv(NY);function FY(n,e){return t=>{if(t&&n){let i=null;if(t=/\S*/.exec(t)[0],typeof n=="function"?i=n(t):i=Cf.matchLanguageName(n,t,!0),i instanceof Cf)return i.support?i.support.language.parser:hu.getSkippingParser(i.load());if(i)return i.parser}return e?e.parser:null}}class Pg{constructor(e,t,i,s,r,o,a){this.node=e,this.from=t,this.to=i,this.spaceBefore=s,this.spaceAfter=r,this.type=o,this.item=a}blank(e,t=!0){let i=this.spaceBefore+(this.node.name=="Blockquote"?">":"");if(e!=null){for(;i.length<e;)i+=" ";return i}else{for(let s=this.to-this.from-i.length-this.spaceAfter.length;s>0;s--)i+=" ";return i+(t?this.spaceAfter:"")}}marker(e,t){let i=this.node.name=="OrderedList"?String(+nR(this.item,e)[2]+t):"";return this.spaceBefore+i+this.type+this.spaceAfter}}function iR(n,e){let t=[],i=[];for(let s=n;s;s=s.parent){if(s.name=="FencedCode")return i;(s.name=="ListItem"||s.name=="Blockquote")&&t.push(s)}for(let s=t.length-1;s>=0;s--){let r=t[s],o,a=e.lineAt(r.from),l=r.from-a.from;if(r.name=="Blockquote"&&(o=/^ *>( ?)/.exec(a.text.slice(l))))i.push(new Pg(r,l,l+o[0].length,"",o[1],">",null));else if(r.name=="ListItem"&&r.parent.name=="OrderedList"&&(o=/^( *)\d+([.)])( *)/.exec(a.text.slice(l)))){let h=o[3],u=o[0].length;h.length>=4&&(h=h.slice(0,h.length-4),u-=4),i.push(new Pg(r.parent,l,l+u,o[1],h,o[2],r))}else if(r.name=="ListItem"&&r.parent.name=="BulletList"&&(o=/^( *)([-+*])( {1,4}\[[ xX]\])?( +)/.exec(a.text.slice(l)))){let h=o[4],u=o[0].length;h.length>4&&(h=h.slice(0,h.length-4),u-=4);let c=o[2];o[3]&&(c+=o[3].replace(/[xX]/," ")),i.push(new Pg(r.parent,l,l+u,o[1],h,c,r))}}return i}function nR(n,e){return/^(\s*)(\d+)(?=[.)])/.exec(e.sliceString(n.from,n.from+10))}function Dg(n,e,t,i=0){for(let s=-1,r=n;;){if(r.name=="ListItem"){let a=nR(r,e),l=+a[2];if(s>=0){if(l!=s+1)return;t.push({from:r.from+a[1].length,to:r.from+a[0].length,insert:String(s+2+i)})}s=l}let o=r.nextSibling;if(!o)break;r=o}}function mv(n,e){let t=/^[ \t]*/.exec(n)[0].length;if(!t||e.facet(jM)!="	")return n;let i=Xh(n,4,t),s="";for(let r=i;r>0;)r>=4?(s+="	",r-=4):(s+=" ",r--);return s+n.slice(t)}const VY=({state:n,dispatch:e})=>{let t=ui(n),{doc:i}=n,s=null,r=n.changeByRange(o=>{if(!o.empty||!Rf.isActiveAt(n,o.from,-1)&&!Rf.isActiveAt(n,o.from,1))return s={range:o};let a=o.from,l=i.lineAt(a),h=iR(t.resolveInner(a,-1),i);for(;h.length&&h[h.length-1].from>a-l.from;)h.pop();if(!h.length)return s={range:o};let u=h[h.length-1];if(u.to-u.spaceAfter.length>a-l.from)return s={range:o};let c=a>=u.to-u.spaceAfter.length&&!/\S/.test(l.text.slice(u.to));if(u.item&&c){let _=u.node.firstChild,T=u.node.getChild("ListItem","ListItem");if(_.to>=a||T&&T.to<a||l.from>0&&!/[^\s>]/.test(i.lineAt(l.from-1).text)){let w=h.length>1?h[h.length-2]:null,v,S="";w&&w.item?(v=l.from+w.from,S=w.marker(i,1)):v=l.from+(w?w.to:0);let k=[{from:v,to:a,insert:S}];return u.node.name=="OrderedList"&&Dg(u.item,i,k,-2),w&&w.node.name=="OrderedList"&&Dg(w.item,i,k),{range:ke.cursor(v+S.length),changes:k}}else{let w=A_(h,n,l);return{range:ke.cursor(a+w.length+1),changes:{from:l.from,insert:w+n.lineBreak}}}}if(u.node.name=="Blockquote"&&c&&l.from){let _=i.lineAt(l.from-1),T=/>\s*$/.exec(_.text);if(T&&T.index==u.from){let w=n.changes([{from:_.from+T.index,to:_.to},{from:l.from+u.from,to:l.to}]);return{range:o.map(w),changes:w}}}let f=[];u.node.name=="OrderedList"&&Dg(u.item,i,f);let p=u.item&&u.item.from<l.from,b="";if(!p||/^[\s\d.)\-+*>]*/.exec(l.text)[0].length>=u.to)for(let _=0,T=h.length-1;_<=T;_++)b+=_==T&&!p?h[_].marker(i,1):h[_].blank(_<T?Xh(l.text,4,h[_+1].from)-b.length:null);let y=a;for(;y>l.from&&/\s/.test(l.text.charAt(y-l.from-1));)y--;return b=mv(b,n),UY(u.node,n.doc)&&(b=A_(h,n,l)+n.lineBreak+b),f.push({from:y,to:a,insert:n.lineBreak+b}),{range:ke.cursor(y+b.length+1),changes:f}});return s?!1:(e(n.update(r,{scrollIntoView:!0,userEvent:"input"})),!0)};function E_(n){return n.name=="QuoteMark"||n.name=="ListMark"}function UY(n,e){if(n.name!="OrderedList"&&n.name!="BulletList")return!1;let t=n.firstChild,i=n.getChild("ListItem","ListItem");if(!i)return!1;let s=e.lineAt(t.to),r=e.lineAt(i.from),o=/^[\s>]*$/.test(s.text);return s.number+(o?0:1)<r.number}function A_(n,e,t){let i="";for(let s=0,r=n.length-2;s<=r;s++)i+=n[s].blank(s<r?Xh(t.text,4,n[s+1].from)-i.length:null,s<r);return mv(i,e)}function qY(n,e){let t=n.resolveInner(e,-1),i=e;E_(t)&&(i=t.from,t=t.parent);for(let s;s=t.childBefore(i);)if(E_(s))i=s.from;else if(s.name=="OrderedList"||s.name=="BulletList")t=s.lastChild,i=t.to;else break;return t}const zY=({state:n,dispatch:e})=>{let t=ui(n),i=null,s=n.changeByRange(r=>{let o=r.from,{doc:a}=n;if(r.empty&&Rf.isActiveAt(n,r.from)){let l=a.lineAt(o),h=iR(qY(t,o),a);if(h.length){let u=h[h.length-1],c=u.to-u.spaceAfter.length+(u.spaceAfter?1:0);if(o-l.from>c&&!/\S/.test(l.text.slice(c,o-l.from)))return{range:ke.cursor(l.from+c),changes:{from:l.from+c,to:o}};if(o-l.from==c&&(!u.item||l.from<=u.item.from||!/\S/.test(l.text.slice(0,u.to)))){let f=l.from+u.from;if(u.item&&u.node.from<u.item.from&&/\S/.test(l.text.slice(u.from,u.to))){let p=u.blank(Xh(l.text,4,u.to)-Xh(l.text,4,u.from));return f==l.from&&(p=mv(p,n)),{range:ke.cursor(f+p.length),changes:{from:f,to:l.from+u.to,insert:p}}}if(f<o)return{range:ke.cursor(f),changes:{from:f,to:o}}}}}return i={range:r}});return i?!1:(e(n.update(s,{scrollIntoView:!0,userEvent:"delete"})),!0)},jY=[{key:"Enter",run:VY},{key:"Backspace",run:zY}],sR=IY({matchClosingTags:!1});function XY(n={}){let{codeLanguages:e,defaultCodeLanguage:t,addKeymap:i=!0,base:{parser:s}=BY,completeHTMLTags:r=!0,pasteURLAsLink:o=!0,htmlTagLanguage:a=sR}=n;if(!(s instanceof Cp))throw new RangeError("Base parser provided to `markdown` should be a Markdown parser");let l=n.extensions?[n.extensions]:[],h=[a.support,QY],u;o&&h.push(YY),t instanceof uu?(h.push(t.support),u=t.language):t&&(u=t);let c=e||u?FY(e,u):void 0;l.push(JH({codeParser:c,htmlParser:a.language.parser})),i&&h.push(ku.high(vb.of(jY)));let f=pv(s.configure(l));return r&&h.push(f.data.of({autocomplete:HY})),new uu(f,h)}function HY(n){let{state:e,pos:t}=n,i=/<[:\-\.\w\u00b7-\uffff]*$/.exec(e.sliceDoc(t-25,t));if(!i)return null;let s=ui(e).resolveInner(t,-1);for(;s&&!s.type.isTop;){if(s.name=="CodeBlock"||s.name=="FencedCode"||s.name=="ProcessingInstructionBlock"||s.name=="CommentBlock"||s.name=="Link"||s.name=="Image")return null;s=s.parent}return{from:t-i[0].length,to:t,options:WY(),validFor:/^<[:\-\.\w\u00b7-\uffff]*$/}}let Mg=null;function WY(){if(Mg)return Mg;let n=PY(new SH(Zt.create({extensions:sR}),0,!0));return Mg=n?n.options:[]}const ZY=/code|horizontalrule|html|link|comment|processing|escape|entity|image|mark|url/i,YY=Ve.domEventHandlers({paste:(n,e)=>{var t;let{main:i}=e.state.selection;if(i.empty)return!1;let s=(t=n.clipboardData)===null||t===void 0?void 0:t.getData("text/plain");if(!s||!/^(https?:\/\/|mailto:|xmpp:|www\.)/.test(s)||(/^www\./.test(s)&&(s="https://"+s),!Rf.isActiveAt(e.state,i.from,1)))return!1;let r=ui(e.state),o=!1;return r.iterate({from:i.from,to:i.to,enter:a=>{(a.from>i.from||ZY.test(a.name))&&(o=!0)},leave:a=>{a.to<i.to&&(o=!0)}}),o?!1:(e.dispatch({changes:[{from:i.from,insert:"["},{from:i.to,insert:`](${s})`}],userEvent:"input.paste",scrollIntoView:!0}),!0)}});class GY extends No{static targets=["textarea"];connect(){if(console.log("CodeEditor controller connected"),this.element.classList.contains("codemirror-initialized")){console.log("CodeEditorは既に設定済みです");return}this.initializeCodeMirror(),window.codeEditorInstances||(window.codeEditorInstances=new Map),this.boundInsertHandler=this.handleInsertText.bind(this),this.element.addEventListener("code-editor:insert-text",this.boundInsertHandler)}async initializeCodeMirror(){this.element.classList.add("codemirror-initializing");const e=this.textareaTarget||this.element.querySelector("textarea");if(!e){console.error("Textarea not found in CodeEditor controller");return}console.log("Found textarea:",e.id||"(no id)");try{const t=kp.define([{tag:j.heading,color:"#4fc3f7",fontWeight:"bold"},{tag:j.heading1,color:"#4fc3f7",fontWeight:"bold"},{tag:j.heading2,color:"#4fc3f7",fontWeight:"bold"},{tag:j.heading3,color:"#4fc3f7",fontWeight:"bold"},{tag:j.heading4,color:"#4fc3f7",fontWeight:"bold"},{tag:j.heading5,color:"#4fc3f7",fontWeight:"bold"},{tag:j.heading6,color:"#4fc3f7",fontWeight:"bold"},{tag:j.strong,color:"#81c784",fontWeight:"bold"},{tag:j.emphasis,color:"#ffb74d",fontStyle:"italic"},{tag:j.strikethrough,textDecoration:"line-through",color:"#ef5350"},{tag:j.link,color:"#64b5f6",textDecoration:"underline"},{tag:j.url,color:"#64b5f6",textDecoration:"underline"},{tag:j.quote,color:"#a5d6a7",fontStyle:"italic"},{tag:j.list,color:"#ce93d8"},{tag:j.code,color:"#ff8a65",backgroundColor:"rgba(255, 255, 255, 0.1)",padding:"2px 4px",borderRadius:"3px"},{tag:j.keyword,color:"#8e44ad",fontWeight:"bold"},{tag:j.atom,color:"#d35400"},{tag:j.number,color:"#e74c3c"},{tag:j.definition,color:"#2c3e50"},{tag:j.variableName,color:"#27ae60"},{tag:j.typeName,color:"#3498db"},{tag:j.propertyName,color:"#16a085"},{tag:j.operator,color:"#95a5a6"},{tag:j.comment,color:"#95a5a6",fontStyle:"italic"},{tag:j.string,color:"#27ae60"},{tag:j.meta,color:"#34495e"},{tag:j.tagName,color:"#e74c3c"},{tag:j.attributeName,color:"#3498db"}]),i=Zt.create({doc:e.value,extensions:[BX,XY({codeLanguages:["javascript","python","ruby","html","css","sql"],addKeymap:!0}),pH(t),Ve.lineWrapping,Ve.theme({"&":{fontSize:"14px",fontFamily:'Monaco, "Lucida Console", monospace'},".cm-content":{padding:"16px",minHeight:"300px"},".cm-focused":{outline:"2px solid #0d6efd"},".cm-editor":{border:"1px solid #ced4da",borderRadius:"0.375rem"}}),Ve.updateListener.of(s=>{s.docChanged&&(e.value=s.state.doc.toString(),e.dispatchEvent(new Event("input",{bubbles:!0})))})]});this.editor=new Ve({state:i,parent:e.parentNode}),e.style.display="none",this.editor&&this.editor.dom?(console.log("CodeMirror 6 successfully initialized with static imports"),this.element.classList.remove("codemirror-initializing"),this.element.classList.add("codemirror-initialized"),this.dispatch("initialized",{detail:{editor:this.editor}})):console.error("CodeMirror 6 editor creation failed")}catch(t){console.error("CodeMirror initialization error (static import):",t);try{const i=window.CodeMirror||(window.loadCodeMirror?await window.loadCodeMirror():null);if(!i)throw new Error("Fallback CodeMirror not available");const{EditorView:s,EditorState:r,basicSetup:o,markdown:a,HighlightStyle:l,tags:h,syntaxHighlighting:u}=i,c=l&&l.define?l.define([]):null,f=r.create({doc:e.value,extensions:[o,a({addKeymap:!0}),...c?[u(c)]:[]]});this.editor=new s({state:f,parent:e.parentNode}),e.style.display="none",this.element.classList.remove("codemirror-initializing"),this.element.classList.add("codemirror-initialized"),this.dispatch("initialized",{detail:{editor:this.editor}})}catch(i){console.error("Fallback CodeMirror initialization also failed:",i)}}}insertText(e){if(console.log("=== CodeEditor insertText called ==="),console.log("Text to insert:",e),console.log("Editor available:",!!this.editor),this.editor&&this.editor.state){const t=this.editor.state.selection.main.head;console.log("Current cursor position:",t);const i=this.editor.state.update({changes:{from:t,insert:e}});this.editor.dispatch(i),this.editor.focus(),console.log("Text insertion completed successfully")}else console.warn("CodeMirror 6 editor not available for text insertion")}handleInsertText(e){console.log("=== CodeEditor received insert-text event ===");const t=e.detail.text;t&&(console.log("Inserting text via event:",t),this.insertText(t),this.dispatch("text-inserted",{detail:{text:t}}))}disconnect(){this.resizeHandler&&window.removeEventListener("resize",this.resizeHandler),this.orientationHandler&&window.removeEventListener("orientationchange",this.orientationHandler),this.element.removeEventListener("code-editor:insert-text",this.handleInsertText.bind(this)),this.boundInsertHandler&&this.element.removeEventListener("code-editor:insert-text",this.boundInsertHandler),window.codeEditorInstances&&window.codeEditorInstances.delete(this.element)}}class KY extends No{static targets=["video"];connect(){console.log("VideoPlayer controller connected"),console.log("hasVideoTarget:",this.hasVideoTarget),console.log("videoTargets length:",this.videoTargets?this.videoTargets.length:"undefined"),console.log("All targets:",this.element.querySelectorAll('[data-video-player-target="video"]')),document.readyState==="loading"?document.addEventListener("DOMContentLoaded",()=>{console.log("DOMContentLoaded - calling initializePlayer"),this.initializePlayer()}):(console.log("Document already ready - calling initializePlayer"),this.initializePlayer())}disconnect(){this.player&&(this.player.dispose(),this.player=null)}initializePlayer(){console.log("initializePlayer called"),console.log("hasVideoTarget:",this.hasVideoTarget),console.log("videoTargets:",this.videoTargets);const e=this.element.querySelector('[data-video-player-target="video"]');if(console.log("Video element found:",e),!e){console.error("Video target element not found in controller element:",this.element);return}if(this.hasVideoTarget){console.log("Using hasVideoTarget path");const t=this.videoTarget;console.log("Video target:",t),console.log("Video target ID:",t.id),this.setupPlayer(t)}else console.log("Using direct query selector path"),console.log("Direct video element:",e),console.log("Direct video element ID:",e.id),this.setupPlayer(e)}setupPlayer(e){if(typeof Y>"u"){console.error("Video.js library is not available");return}if(e.classList.contains("vjs-tech")){console.log("Video.js player already initialized for this element");return}this.player&&(console.log("Disposing existing player"),this.player.dispose(),this.player=null),e.classList.contains("video-js")||e.classList.add("video-js","vjs-default-skin");const t={fluid:!0,responsive:!0,controls:!0,playbackRates:[.5,1,1.25,1.5,2,4],language:"ja"};try{console.log("Attempting to initialize Video.js player with element:",e.id),this.player=Y(e,t,()=>{console.log("Video.js player is ready")}),console.log("Player created successfully:",this.player)}catch(i){console.error("Failed to initialize Video.js player:",i)}}}var ph={exports:{}},JY=ph.exports,P_;function eG(){return P_||(P_=1,(function(n,e){(function(t,i){i(e)})(JY,(function(t){var i=typeof window<"u"&&window.flatpickr!==void 0?window.flatpickr:{l10ns:{}},s={weekdays:{shorthand:["日","月","火","水","木","金","土"],longhand:["日曜日","月曜日","火曜日","水曜日","木曜日","金曜日","土曜日"]},months:{shorthand:["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月"],longhand:["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月"]},time_24hr:!0,rangeSeparator:" から ",monthAriaLabel:"月",amPM:["午前","午後"],yearAriaLabel:"年",hourAriaLabel:"時間",minuteAriaLabel:"分"};i.l10ns.ja=s;var r=i.l10ns;t.Japanese=s,t.default=r,Object.defineProperty(t,"__esModule",{value:!0})}))})(ph,ph.exports)),ph.exports}var tG=eG();class iG extends No{static targets=["input"];static values={mode:String,dateFormat:String,locale:String};connect(){console.log("Flatpickr controller connected"),this.initializeFlatpickr()}initializeFlatpickr(){const e={mode:this.modeValue||"single",dateFormat:this.dateFormatValue||"Y/m/d",allowInput:!1,clickOpens:!0,locale:this.localeValue==="ja"?tG.Japanese:"default"};this.modeValue==="range"&&(e.mode="range",e.dateFormat="Y/m/d",e.separator=" 〜 "),this.flatpickr=Bt(this.inputTarget,e),console.log("Flatpickr initialized with options:",e)}disconnect(){this.flatpickr&&this.flatpickr.destroy()}}window.videojs=Y;window.flatpickr=Bt;window.startPasskeyAuthentication=HL;window.startPasskeyRegistration=WL;console.log("Passkey functions loaded globally:",{auth:!!window.startPasskeyAuthentication,reg:!!window.startPasskeyRegistration});window.ActiveStorage||(window.ActiveStorage=c5,_y(),console.log("ActiveStorage initialized"));async function rR(){return window.videojs?(console.log("Video.js already available:",!!window.videojs),window.videojs):(console.warn("Video.js not found on window object"),null)}window.loadVideoJS=rR;console.log("Pre-loading Video.js...");rR().then(()=>{console.log("Video.js pre-loaded successfully, window.videojs available:",!!window.videojs)}).catch(n=>{console.warn("Video.js pre-loading failed:",n)});const Ep=U$.start();window.Stimulus=Ep;Ep.register("code-editor",GY);Ep.register("video-player",KY);Ep.register("flatpickr",iG);console.log("Application loaded with esbuild (CodeMirror dynamic)");window.checkActiveStorageStatus=function(){const n={available:typeof window.ActiveStorage<"u",directUpload:typeof window.ActiveStorage?.DirectUpload=="function",started:window.ActiveStorage?.started||!1};return console.log("ActiveStorage Status:",n),n};document.addEventListener("turbo:before-fetch-request",n=>{const e=document.querySelector('meta[name="csrf-token"]').getAttribute("content");e&&(n.detail.fetchOptions.headers["X-CSRF-Token"]=e)});console.log("ActiveStorage initialized and ready");
//# sourceMappingURL=application-B2ts6Hq6.js.map
