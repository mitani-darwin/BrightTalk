<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CodeMirror Integration Test</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/codemirror@5.65.16/lib/codemirror.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/codemirror@5.65.16/addon/fold/foldgutter.css">
</head>
<body>
    <div class="container mt-4">
        <h1>CodeMirror Integration Test</h1>
        <div class="mb-3">
            <label for="testTextarea" class="form-label">Content</label>
            <div data-controller="code-editor">
                <textarea 
                    id="testTextarea" 
                    class="form-control" 
                    data-code-editor-target="textarea"
                    placeholder="Type your content here..."
                    rows="10">
# Sample Markdown Content

This is a **test** of CodeMirror integration.

```javascript
function hello() {
    console.log("Hello, CodeMirror!");
}
```

- List item 1
- List item 2
- List item 3
                </textarea>
            </div>
        </div>
        <div id="status" class="alert alert-info">Loading...</div>
    </div>

    <script src="app/assets/builds/application.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const status = document.getElementById('status');
            
            setTimeout(() => {
                if (window.CodeMirror) {
                    status.className = 'alert alert-success';
                    status.textContent = 'CodeMirror is loaded and available!';
                    
                    // Check if the controller initialized properly
                    const textarea = document.getElementById('testTextarea');
                    const editorContainer = textarea.closest('[data-controller="code-editor"]');
                    
                    if (editorContainer && editorContainer.querySelector('.CodeMirror')) {
                        status.textContent += ' Editor is initialized successfully!';
                    } else {
                        status.className = 'alert alert-warning';
                        status.textContent += ' But editor controller may not be working properly.';
                    }
                } else {
                    status.className = 'alert alert-danger';
                    status.textContent = 'CodeMirror is not loaded!';
                }
            }, 2000);
        });
    </script>
</body>
</html>